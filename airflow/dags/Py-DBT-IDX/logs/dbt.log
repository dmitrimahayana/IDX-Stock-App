

============================== 16:18:35.662604 | e39c4583-6abe-4c5b-b410-f5110b2bc485 ==============================
[0m16:18:35.662604 [info ] [MainThread]: Running with dbt=1.6.1
[0m16:18:35.670126 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'D:\\00 Project\\00 My Project\\IdeaProjects\\Py-DBT-IDX', 'debug': 'False', 'version_check': 'True', 'log_path': 'D:\\00 Project\\00 My Project\\IdeaProjects\\Py-DBT-IDX\\logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt snapshot', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'False'}
[0m16:18:35.779757 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `source-paths` config has been renamed to `model-paths`. Please update your
`dbt_project.yml` configuration to reflect this change.
[0m16:18:35.781747 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `data-paths` config has been renamed to `seed-paths`. Please update your
`dbt_project.yml` configuration to reflect this change.
[0m16:18:35.863187 [info ] [MainThread]: Registered adapter: postgres=1.6.1
[0m16:18:35.874707 [debug] [MainThread]: checksum: efe19d9f5b93d1a98cc804fbfcdb6b3aced98b974af664946fee1cde8837deb7, vars: {}, profile: , target: , version: 1.6.1
[0m16:18:35.875707 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m16:18:36.720343 [warn ] [MainThread]: [[33mWARNING[0m]: Did not find matching node for patch with name 'dim_customers' in the 'models' section of file 'models\marts\core\core.yml'
[0m16:18:36.722321 [warn ] [MainThread]: [[33mWARNING[0m]: Did not find matching node for patch with name 'fct_orders' in the 'models' section of file 'models\marts\core\core.yml'
[0m16:18:36.797252 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_idx.not_null_dim_customers_customer_id.dd91cd1c8d' (models\marts\core\core.yml) depends on a node named 'dim_customers' in package '' which was not found
[0m16:18:36.833485 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.dbt_idx.marts.core
[0m16:18:36.875621 [info ] [MainThread]: Found 4 tests, 3 sources, 0 exposures, 0 metrics, 349 macros, 0 groups, 0 semantic models
[0m16:18:36.879076 [info ] [MainThread]: 
[0m16:18:36.880112 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m16:18:36.882086 [debug] [MainThread]: Command end result
[0m16:18:36.900811 [debug] [MainThread]: Command `dbt snapshot` succeeded at 16:18:36.899812 after 1.28 seconds
[0m16:18:36.901816 [debug] [MainThread]: Flushing usage events


============================== 16:42:46.186929 | bd6eefb1-ddc2-4391-b84d-3e84c46f9043 ==============================
[0m16:42:46.186929 [info ] [MainThread]: Running with dbt=1.6.1
[0m16:42:46.191531 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'D:\\00 Project\\00 My Project\\IdeaProjects\\Py-DBT-IDX', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': 'D:\\00 Project\\00 My Project\\IdeaProjects\\Py-DBT-IDX\\logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt snapshot', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'False'}
[0m16:42:46.321441 [info ] [MainThread]: Registered adapter: postgres=1.6.1
[0m16:42:46.333340 [debug] [MainThread]: checksum: efe19d9f5b93d1a98cc804fbfcdb6b3aced98b974af664946fee1cde8837deb7, vars: {}, profile: , target: , version: 1.6.1
[0m16:42:46.341868 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m16:42:47.166414 [warn ] [MainThread]: [[33mWARNING[0m]: Did not find matching node for patch with name 'dim_customers' in the 'models' section of file 'models\marts\core\core.yml'
[0m16:42:47.213577 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_idx.not_null_dim_customers_customer_id.dd91cd1c8d' (models\marts\core\core.yml) depends on a node named 'dim_customers' in package '' which was not found
[0m16:42:47.335476 [info ] [MainThread]: Found 5 models, 1 snapshot, 4 tests, 3 sources, 0 exposures, 0 metrics, 349 macros, 0 groups, 0 semantic models
[0m16:42:47.337505 [info ] [MainThread]: 
[0m16:42:47.339483 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m16:42:47.342982 [debug] [ThreadPool]: Acquiring new postgres connection 'list_IDX-Stock'
[0m16:42:47.353500 [debug] [ThreadPool]: Using postgres connection "list_IDX-Stock"
[0m16:42:47.353500 [debug] [ThreadPool]: On list_IDX-Stock: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "connection_name": "list_IDX-Stock"} */

    select distinct nspname from pg_namespace
  
[0m16:42:47.354506 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:42:47.407741 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.0 seconds
[0m16:42:47.409760 [debug] [ThreadPool]: On list_IDX-Stock: Close
[0m16:42:47.412243 [debug] [ThreadPool]: Acquiring new postgres connection 'list_IDX-Stock_snapshots'
[0m16:42:47.420264 [debug] [ThreadPool]: Using postgres connection "list_IDX-Stock_snapshots"
[0m16:42:47.421772 [debug] [ThreadPool]: On list_IDX-Stock_snapshots: BEGIN
[0m16:42:47.421772 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:42:47.445811 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m16:42:47.446809 [debug] [ThreadPool]: Using postgres connection "list_IDX-Stock_snapshots"
[0m16:42:47.446809 [debug] [ThreadPool]: On list_IDX-Stock_snapshots: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "connection_name": "list_IDX-Stock_snapshots"} */
select
      'IDX-Stock' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'snapshots'
    union all
    select
      'IDX-Stock' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'snapshots'
    union all
    select
      'IDX-Stock' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'snapshots'
  
[0m16:42:47.454252 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.0 seconds
[0m16:42:47.456287 [debug] [ThreadPool]: On list_IDX-Stock_snapshots: ROLLBACK
[0m16:42:47.458253 [debug] [ThreadPool]: On list_IDX-Stock_snapshots: Close
[0m16:42:47.460250 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_IDX-Stock_snapshots, now list_IDX-Stock_warehouse)
[0m16:42:47.463765 [debug] [ThreadPool]: Using postgres connection "list_IDX-Stock_warehouse"
[0m16:42:47.464765 [debug] [ThreadPool]: On list_IDX-Stock_warehouse: BEGIN
[0m16:42:47.465793 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:42:47.487007 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m16:42:47.488002 [debug] [ThreadPool]: Using postgres connection "list_IDX-Stock_warehouse"
[0m16:42:47.488002 [debug] [ThreadPool]: On list_IDX-Stock_warehouse: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "connection_name": "list_IDX-Stock_warehouse"} */
select
      'IDX-Stock' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'warehouse'
    union all
    select
      'IDX-Stock' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'warehouse'
    union all
    select
      'IDX-Stock' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'warehouse'
  
[0m16:42:47.494533 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.0 seconds
[0m16:42:47.497552 [debug] [ThreadPool]: On list_IDX-Stock_warehouse: ROLLBACK
[0m16:42:47.499518 [debug] [ThreadPool]: On list_IDX-Stock_warehouse: Close
[0m16:42:47.510087 [debug] [MainThread]: Using postgres connection "master"
[0m16:42:47.510087 [debug] [MainThread]: On master: BEGIN
[0m16:42:47.510087 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:42:47.538928 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m16:42:47.539925 [debug] [MainThread]: Using postgres connection "master"
[0m16:42:47.541446 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m16:42:47.554041 [debug] [MainThread]: SQL status: SELECT 0 in 0.0 seconds
[0m16:42:47.557084 [debug] [MainThread]: On master: ROLLBACK
[0m16:42:47.560043 [debug] [MainThread]: Using postgres connection "master"
[0m16:42:47.560043 [debug] [MainThread]: On master: BEGIN
[0m16:42:47.565596 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m16:42:47.566574 [debug] [MainThread]: On master: COMMIT
[0m16:42:47.567614 [debug] [MainThread]: Using postgres connection "master"
[0m16:42:47.568561 [debug] [MainThread]: On master: COMMIT
[0m16:42:47.570561 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m16:42:47.572102 [debug] [MainThread]: On master: Close
[0m16:42:47.573109 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:42:47.575632 [info ] [MainThread]: 
[0m16:42:47.582747 [debug] [Thread-1 (]: Began running node snapshot.dbt_idx.customers_snapshot
[0m16:42:47.583687 [info ] [Thread-1 (]: 1 of 1 START snapshot snapshots.customers_snapshot ............................. [RUN]
[0m16:42:47.586686 [debug] [Thread-1 (]: Acquiring new postgres connection 'snapshot.dbt_idx.customers_snapshot'
[0m16:42:47.587683 [debug] [Thread-1 (]: Began compiling node snapshot.dbt_idx.customers_snapshot
[0m16:42:47.600318 [debug] [Thread-1 (]: Timing info for snapshot.dbt_idx.customers_snapshot (compile): 16:42:47.589250 => 16:42:47.600318
[0m16:42:47.601945 [debug] [Thread-1 (]: Began executing node snapshot.dbt_idx.customers_snapshot
[0m16:42:47.675781 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.dbt_idx.customers_snapshot"
[0m16:42:47.684538 [debug] [Thread-1 (]: Using postgres connection "snapshot.dbt_idx.customers_snapshot"
[0m16:42:47.685537 [debug] [Thread-1 (]: On snapshot.dbt_idx.customers_snapshot: BEGIN
[0m16:42:47.685537 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m16:42:47.711407 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m16:42:47.712419 [debug] [Thread-1 (]: Using postgres connection "snapshot.dbt_idx.customers_snapshot"
[0m16:42:47.713453 [debug] [Thread-1 (]: On snapshot.dbt_idx.customers_snapshot: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "snapshot.dbt_idx.customers_snapshot"} */

      
  
    

  create  table "IDX-Stock"."snapshots"."customers_snapshot"
  
  
    as
  
  (
    

    select *,
        md5(coalesce(cast(customer_id as varchar ), '')
         || '|' || coalesce(cast(datetime_updated as varchar ), '')
        ) as dbt_scd_id,
        datetime_updated as dbt_updated_at,
        datetime_updated as dbt_valid_from,
        nullif(datetime_updated, datetime_updated) as dbt_valid_to
    from (
        



select *
from "IDX-Stock"."warehouse"."customers"

    ) sbq



  );
  
  
[0m16:42:47.735685 [debug] [Thread-1 (]: SQL status: SELECT 100 in 0.0 seconds
[0m16:42:47.755627 [debug] [Thread-1 (]: On snapshot.dbt_idx.customers_snapshot: COMMIT
[0m16:42:47.756638 [debug] [Thread-1 (]: Using postgres connection "snapshot.dbt_idx.customers_snapshot"
[0m16:42:47.757636 [debug] [Thread-1 (]: On snapshot.dbt_idx.customers_snapshot: COMMIT
[0m16:42:47.762113 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m16:42:47.765121 [debug] [Thread-1 (]: Timing info for snapshot.dbt_idx.customers_snapshot (execute): 16:42:47.602845 => 16:42:47.765121
[0m16:42:47.766161 [debug] [Thread-1 (]: On snapshot.dbt_idx.customers_snapshot: Close
[0m16:42:47.769124 [info ] [Thread-1 (]: 1 of 1 OK snapshotted snapshots.customers_snapshot ............................. [[32msuccess[0m in 0.18s]
[0m16:42:47.771692 [debug] [Thread-1 (]: Finished running node snapshot.dbt_idx.customers_snapshot
[0m16:42:47.775718 [debug] [MainThread]: Using postgres connection "master"
[0m16:42:47.776711 [debug] [MainThread]: On master: BEGIN
[0m16:42:47.778708 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:42:47.809577 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m16:42:47.810590 [debug] [MainThread]: On master: COMMIT
[0m16:42:47.811582 [debug] [MainThread]: Using postgres connection "master"
[0m16:42:47.812111 [debug] [MainThread]: On master: COMMIT
[0m16:42:47.814130 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m16:42:47.816118 [debug] [MainThread]: On master: Close
[0m16:42:47.817126 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:42:47.818124 [debug] [MainThread]: Connection 'list_IDX-Stock' was properly closed.
[0m16:42:47.819636 [debug] [MainThread]: Connection 'list_IDX-Stock_warehouse' was properly closed.
[0m16:42:47.821649 [debug] [MainThread]: Connection 'snapshot.dbt_idx.customers_snapshot' was properly closed.
[0m16:42:47.821649 [info ] [MainThread]: 
[0m16:42:47.823836 [info ] [MainThread]: Finished running 1 snapshot in 0 hours 0 minutes and 0.48 seconds (0.48s).
[0m16:42:47.825861 [debug] [MainThread]: Command end result
[0m16:42:47.858071 [info ] [MainThread]: 
[0m16:42:47.859544 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:42:47.861544 [info ] [MainThread]: 
[0m16:42:47.863682 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m16:42:47.865678 [debug] [MainThread]: Command `dbt snapshot` succeeded at 16:42:47.865678 after 1.72 seconds
[0m16:42:47.866643 [debug] [MainThread]: Flushing usage events


============================== 16:43:33.612940 | 8539b76c-44c6-4a70-9f1e-76e585adc040 ==============================
[0m16:43:33.612940 [info ] [MainThread]: Running with dbt=1.6.1
[0m16:43:33.617970 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'D:\\00 Project\\00 My Project\\IdeaProjects\\Py-DBT-IDX', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': 'D:\\00 Project\\00 My Project\\IdeaProjects\\Py-DBT-IDX\\logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt snapshot', 'send_anonymous_usage_stats': 'False'}
[0m16:43:33.747406 [info ] [MainThread]: Registered adapter: postgres=1.6.1
[0m16:43:33.758988 [debug] [MainThread]: checksum: efe19d9f5b93d1a98cc804fbfcdb6b3aced98b974af664946fee1cde8837deb7, vars: {}, profile: , target: , version: 1.6.1
[0m16:43:33.899543 [debug] [MainThread]: Partial parsing enabled: 1 files deleted, 1 files added, 0 files changed.
[0m16:43:33.900517 [debug] [MainThread]: Partial parsing: added file: dbt_idx://models\marts\core\dim_customers.sql
[0m16:43:33.901514 [debug] [MainThread]: Partial parsing: deleted file: dbt_idx://models\marts\core\dim_customer.sql
[0m16:43:33.990026 [info ] [MainThread]: Found 5 models, 1 snapshot, 4 tests, 3 sources, 0 exposures, 0 metrics, 349 macros, 0 groups, 0 semantic models
[0m16:43:33.993544 [info ] [MainThread]: 
[0m16:43:33.995547 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m16:43:33.998580 [debug] [ThreadPool]: Acquiring new postgres connection 'list_IDX-Stock'
[0m16:43:34.013695 [debug] [ThreadPool]: Using postgres connection "list_IDX-Stock"
[0m16:43:34.014660 [debug] [ThreadPool]: On list_IDX-Stock: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "connection_name": "list_IDX-Stock"} */

    select distinct nspname from pg_namespace
  
[0m16:43:34.014660 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:43:34.045863 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.0 seconds
[0m16:43:34.047862 [debug] [ThreadPool]: On list_IDX-Stock: Close
[0m16:43:34.052360 [debug] [ThreadPool]: Acquiring new postgres connection 'list_IDX-Stock_snapshots'
[0m16:43:34.060359 [debug] [ThreadPool]: Using postgres connection "list_IDX-Stock_snapshots"
[0m16:43:34.061365 [debug] [ThreadPool]: On list_IDX-Stock_snapshots: BEGIN
[0m16:43:34.061365 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:43:34.081292 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m16:43:34.082343 [debug] [ThreadPool]: Using postgres connection "list_IDX-Stock_snapshots"
[0m16:43:34.083325 [debug] [ThreadPool]: On list_IDX-Stock_snapshots: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "connection_name": "list_IDX-Stock_snapshots"} */
select
      'IDX-Stock' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'snapshots'
    union all
    select
      'IDX-Stock' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'snapshots'
    union all
    select
      'IDX-Stock' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'snapshots'
  
[0m16:43:34.089302 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.0 seconds
[0m16:43:34.091298 [debug] [ThreadPool]: On list_IDX-Stock_snapshots: ROLLBACK
[0m16:43:34.093816 [debug] [ThreadPool]: On list_IDX-Stock_snapshots: Close
[0m16:43:34.096818 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_IDX-Stock_snapshots, now list_IDX-Stock_warehouse)
[0m16:43:34.102363 [debug] [ThreadPool]: Using postgres connection "list_IDX-Stock_warehouse"
[0m16:43:34.103361 [debug] [ThreadPool]: On list_IDX-Stock_warehouse: BEGIN
[0m16:43:34.104324 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:43:34.126454 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m16:43:34.126454 [debug] [ThreadPool]: Using postgres connection "list_IDX-Stock_warehouse"
[0m16:43:34.127756 [debug] [ThreadPool]: On list_IDX-Stock_warehouse: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "connection_name": "list_IDX-Stock_warehouse"} */
select
      'IDX-Stock' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'warehouse'
    union all
    select
      'IDX-Stock' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'warehouse'
    union all
    select
      'IDX-Stock' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'warehouse'
  
[0m16:43:34.133302 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.0 seconds
[0m16:43:34.135326 [debug] [ThreadPool]: On list_IDX-Stock_warehouse: ROLLBACK
[0m16:43:34.137296 [debug] [ThreadPool]: On list_IDX-Stock_warehouse: Close
[0m16:43:34.145363 [debug] [MainThread]: Using postgres connection "master"
[0m16:43:34.147338 [debug] [MainThread]: On master: BEGIN
[0m16:43:34.147338 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:43:34.169165 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m16:43:34.170161 [debug] [MainThread]: Using postgres connection "master"
[0m16:43:34.170161 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m16:43:34.175709 [debug] [MainThread]: SQL status: SELECT 0 in 0.0 seconds
[0m16:43:34.178716 [debug] [MainThread]: On master: ROLLBACK
[0m16:43:34.181215 [debug] [MainThread]: Using postgres connection "master"
[0m16:43:34.181215 [debug] [MainThread]: On master: BEGIN
[0m16:43:34.185220 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m16:43:34.185220 [debug] [MainThread]: On master: COMMIT
[0m16:43:34.186227 [debug] [MainThread]: Using postgres connection "master"
[0m16:43:34.187231 [debug] [MainThread]: On master: COMMIT
[0m16:43:34.189225 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m16:43:34.189225 [debug] [MainThread]: On master: Close
[0m16:43:34.191233 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:43:34.193355 [info ] [MainThread]: 
[0m16:43:34.198354 [debug] [Thread-1 (]: Began running node snapshot.dbt_idx.customers_snapshot
[0m16:43:34.199355 [info ] [Thread-1 (]: 1 of 1 START snapshot snapshots.customers_snapshot ............................. [RUN]
[0m16:43:34.200356 [debug] [Thread-1 (]: Acquiring new postgres connection 'snapshot.dbt_idx.customers_snapshot'
[0m16:43:34.201402 [debug] [Thread-1 (]: Began compiling node snapshot.dbt_idx.customers_snapshot
[0m16:43:34.211563 [debug] [Thread-1 (]: Timing info for snapshot.dbt_idx.customers_snapshot (compile): 16:43:34.201402 => 16:43:34.211563
[0m16:43:34.213029 [debug] [Thread-1 (]: Began executing node snapshot.dbt_idx.customers_snapshot
[0m16:43:34.257513 [debug] [Thread-1 (]: Using postgres connection "snapshot.dbt_idx.customers_snapshot"
[0m16:43:34.258556 [debug] [Thread-1 (]: On snapshot.dbt_idx.customers_snapshot: BEGIN
[0m16:43:34.259538 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m16:43:34.281269 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m16:43:34.282199 [debug] [Thread-1 (]: Using postgres connection "snapshot.dbt_idx.customers_snapshot"
[0m16:43:34.282199 [debug] [Thread-1 (]: On snapshot.dbt_idx.customers_snapshot: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "snapshot.dbt_idx.customers_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "IDX-Stock".INFORMATION_SCHEMA.columns
      where table_name = 'customers_snapshot'
        
        and table_schema = 'snapshots'
        
      order by ordinal_position

  
[0m16:43:34.298369 [debug] [Thread-1 (]: SQL status: SELECT 10 in 0.0 seconds
[0m16:43:34.325748 [debug] [Thread-1 (]: Using postgres connection "snapshot.dbt_idx.customers_snapshot"
[0m16:43:34.326748 [debug] [Thread-1 (]: On snapshot.dbt_idx.customers_snapshot: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "snapshot.dbt_idx.customers_snapshot"} */

        
  
    

  create temporary table "customers_snapshot__dbt_tmp164334313157"
  
  
    as
  
  (
    with snapshot_query as (

        



select *
from "IDX-Stock"."warehouse"."customers"


    ),

    snapshotted_data as (

        select *,
            customer_id as dbt_unique_key

        from "IDX-Stock"."snapshots"."customers_snapshot"
        where dbt_valid_to is null

    ),

    insertions_source_data as (

        select
            *,
            customer_id as dbt_unique_key,
            datetime_updated as dbt_updated_at,
            datetime_updated as dbt_valid_from,
            nullif(datetime_updated, datetime_updated) as dbt_valid_to,
            md5(coalesce(cast(customer_id as varchar ), '')
         || '|' || coalesce(cast(datetime_updated as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select
            *,
            customer_id as dbt_unique_key,
            datetime_updated as dbt_updated_at,
            datetime_updated as dbt_valid_from,
            datetime_updated as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where snapshotted_data.dbt_unique_key is null
           or (
                snapshotted_data.dbt_unique_key is not null
            and (
                (snapshotted_data.dbt_valid_from < source_data.datetime_updated)
            )
        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where (
            (snapshotted_data.dbt_valid_from < source_data.datetime_updated)
        )
    )

    select * from insertions
    union all
    select * from updates

  );
  
    
[0m16:43:34.333336 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.0 seconds
[0m16:43:34.337337 [debug] [Thread-1 (]: Using postgres connection "snapshot.dbt_idx.customers_snapshot"
[0m16:43:34.338352 [debug] [Thread-1 (]: On snapshot.dbt_idx.customers_snapshot: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "snapshot.dbt_idx.customers_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'customers_snapshot__dbt_tmp164334313157'
        
      order by ordinal_position

  
[0m16:43:34.343926 [debug] [Thread-1 (]: SQL status: SELECT 12 in 0.0 seconds
[0m16:43:34.347925 [debug] [Thread-1 (]: Using postgres connection "snapshot.dbt_idx.customers_snapshot"
[0m16:43:34.348924 [debug] [Thread-1 (]: On snapshot.dbt_idx.customers_snapshot: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "snapshot.dbt_idx.customers_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "IDX-Stock".INFORMATION_SCHEMA.columns
      where table_name = 'customers_snapshot'
        
        and table_schema = 'snapshots'
        
      order by ordinal_position

  
[0m16:43:34.352437 [debug] [Thread-1 (]: SQL status: SELECT 10 in 0.0 seconds
[0m16:43:34.356467 [debug] [Thread-1 (]: Using postgres connection "snapshot.dbt_idx.customers_snapshot"
[0m16:43:34.357465 [debug] [Thread-1 (]: On snapshot.dbt_idx.customers_snapshot: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "snapshot.dbt_idx.customers_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'customers_snapshot__dbt_tmp164334313157'
        
      order by ordinal_position

  
[0m16:43:34.361465 [debug] [Thread-1 (]: SQL status: SELECT 12 in 0.0 seconds
[0m16:43:34.366819 [debug] [Thread-1 (]: Using postgres connection "snapshot.dbt_idx.customers_snapshot"
[0m16:43:34.367818 [debug] [Thread-1 (]: On snapshot.dbt_idx.customers_snapshot: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "snapshot.dbt_idx.customers_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "IDX-Stock".INFORMATION_SCHEMA.columns
      where table_name = 'customers_snapshot'
        
        and table_schema = 'snapshots'
        
      order by ordinal_position

  
[0m16:43:34.371625 [debug] [Thread-1 (]: SQL status: SELECT 10 in 0.0 seconds
[0m16:43:34.379692 [debug] [Thread-1 (]: Using postgres connection "snapshot.dbt_idx.customers_snapshot"
[0m16:43:34.379692 [debug] [Thread-1 (]: On snapshot.dbt_idx.customers_snapshot: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "snapshot.dbt_idx.customers_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'customers_snapshot__dbt_tmp164334313157'
        
      order by ordinal_position

  
[0m16:43:34.385218 [debug] [Thread-1 (]: SQL status: SELECT 12 in 0.0 seconds
[0m16:43:34.391800 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.dbt_idx.customers_snapshot"
[0m16:43:34.408801 [debug] [Thread-1 (]: Using postgres connection "snapshot.dbt_idx.customers_snapshot"
[0m16:43:34.409800 [debug] [Thread-1 (]: On snapshot.dbt_idx.customers_snapshot: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "snapshot.dbt_idx.customers_snapshot"} */

      update "IDX-Stock"."snapshots"."customers_snapshot"
    set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to
    from "customers_snapshot__dbt_tmp164334313157" as DBT_INTERNAL_SOURCE
    where DBT_INTERNAL_SOURCE.dbt_scd_id::text = "IDX-Stock"."snapshots"."customers_snapshot".dbt_scd_id::text
      and DBT_INTERNAL_SOURCE.dbt_change_type::text in ('update'::text, 'delete'::text)
      and "IDX-Stock"."snapshots"."customers_snapshot".dbt_valid_to is null;

    insert into "IDX-Stock"."snapshots"."customers_snapshot" ("customer_id", "zipcode", "city", "state_code", "datetime_created", "datetime_updated", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id")
    select DBT_INTERNAL_SOURCE."customer_id",DBT_INTERNAL_SOURCE."zipcode",DBT_INTERNAL_SOURCE."city",DBT_INTERNAL_SOURCE."state_code",DBT_INTERNAL_SOURCE."datetime_created",DBT_INTERNAL_SOURCE."datetime_updated",DBT_INTERNAL_SOURCE."dbt_updated_at",DBT_INTERNAL_SOURCE."dbt_valid_from",DBT_INTERNAL_SOURCE."dbt_valid_to",DBT_INTERNAL_SOURCE."dbt_scd_id"
    from "customers_snapshot__dbt_tmp164334313157" as DBT_INTERNAL_SOURCE
    where DBT_INTERNAL_SOURCE.dbt_change_type::text = 'insert'::text;

  
[0m16:43:34.413912 [debug] [Thread-1 (]: SQL status: INSERT 0 0 in 0.0 seconds
[0m16:43:34.429157 [debug] [Thread-1 (]: On snapshot.dbt_idx.customers_snapshot: COMMIT
[0m16:43:34.430135 [debug] [Thread-1 (]: Using postgres connection "snapshot.dbt_idx.customers_snapshot"
[0m16:43:34.430135 [debug] [Thread-1 (]: On snapshot.dbt_idx.customers_snapshot: COMMIT
[0m16:43:34.435152 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m16:43:34.439187 [debug] [Thread-1 (]: Timing info for snapshot.dbt_idx.customers_snapshot (execute): 16:43:34.213029 => 16:43:34.438183
[0m16:43:34.439187 [debug] [Thread-1 (]: On snapshot.dbt_idx.customers_snapshot: Close
[0m16:43:34.442698 [info ] [Thread-1 (]: 1 of 1 OK snapshotted snapshots.customers_snapshot ............................. [[32msuccess[0m in 0.24s]
[0m16:43:34.444699 [debug] [Thread-1 (]: Finished running node snapshot.dbt_idx.customers_snapshot
[0m16:43:34.449704 [debug] [MainThread]: Using postgres connection "master"
[0m16:43:34.451210 [debug] [MainThread]: On master: BEGIN
[0m16:43:34.452224 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:43:34.475978 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m16:43:34.476972 [debug] [MainThread]: On master: COMMIT
[0m16:43:34.476972 [debug] [MainThread]: Using postgres connection "master"
[0m16:43:34.477973 [debug] [MainThread]: On master: COMMIT
[0m16:43:34.479986 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m16:43:34.481493 [debug] [MainThread]: On master: Close
[0m16:43:34.482500 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:43:34.484503 [debug] [MainThread]: Connection 'list_IDX-Stock' was properly closed.
[0m16:43:34.485501 [debug] [MainThread]: Connection 'list_IDX-Stock_warehouse' was properly closed.
[0m16:43:34.486528 [debug] [MainThread]: Connection 'snapshot.dbt_idx.customers_snapshot' was properly closed.
[0m16:43:34.487537 [info ] [MainThread]: 
[0m16:43:34.488509 [info ] [MainThread]: Finished running 1 snapshot in 0 hours 0 minutes and 0.49 seconds (0.49s).
[0m16:43:34.490505 [debug] [MainThread]: Command end result
[0m16:43:34.522845 [info ] [MainThread]: 
[0m16:43:34.524852 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:43:34.525852 [info ] [MainThread]: 
[0m16:43:34.527372 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m16:43:34.529414 [debug] [MainThread]: Command `dbt snapshot` succeeded at 16:43:34.528443 after 0.95 seconds
[0m16:43:34.529414 [debug] [MainThread]: Flushing usage events


============================== 16:44:51.252803 | 1fb805ca-13d1-446e-9f23-23da5712aacd ==============================
[0m16:44:51.252803 [info ] [MainThread]: Running with dbt=1.6.1
[0m16:44:51.257769 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'D:\\00 Project\\00 My Project\\IdeaProjects\\Py-DBT-IDX\\logs', 'version_check': 'True', 'profiles_dir': 'D:\\00 Project\\00 My Project\\IdeaProjects\\Py-DBT-IDX', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt snapshot', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'False'}
[0m16:44:51.392046 [info ] [MainThread]: Registered adapter: postgres=1.6.1
[0m16:44:51.404077 [debug] [MainThread]: checksum: efe19d9f5b93d1a98cc804fbfcdb6b3aced98b974af664946fee1cde8837deb7, vars: {}, profile: , target: , version: 1.6.1
[0m16:44:51.549993 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:44:51.550993 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:44:51.597077 [info ] [MainThread]: Found 5 models, 1 snapshot, 4 tests, 3 sources, 0 exposures, 0 metrics, 349 macros, 0 groups, 0 semantic models
[0m16:44:51.600092 [info ] [MainThread]: 
[0m16:44:51.601062 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m16:44:51.604583 [debug] [ThreadPool]: Acquiring new postgres connection 'list_IDX-Stock'
[0m16:44:51.617185 [debug] [ThreadPool]: Using postgres connection "list_IDX-Stock"
[0m16:44:51.618142 [debug] [ThreadPool]: On list_IDX-Stock: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "connection_name": "list_IDX-Stock"} */

    select distinct nspname from pg_namespace
  
[0m16:44:51.619161 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:44:51.652293 [debug] [ThreadPool]: SQL status: SELECT 9 in 0.0 seconds
[0m16:44:51.654292 [debug] [ThreadPool]: On list_IDX-Stock: Close
[0m16:44:51.658309 [debug] [ThreadPool]: Acquiring new postgres connection 'list_IDX-Stock_snapshots'
[0m16:44:51.665876 [debug] [ThreadPool]: Using postgres connection "list_IDX-Stock_snapshots"
[0m16:44:51.666843 [debug] [ThreadPool]: On list_IDX-Stock_snapshots: BEGIN
[0m16:44:51.667848 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:44:51.694528 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m16:44:51.696137 [debug] [ThreadPool]: Using postgres connection "list_IDX-Stock_snapshots"
[0m16:44:51.696137 [debug] [ThreadPool]: On list_IDX-Stock_snapshots: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "connection_name": "list_IDX-Stock_snapshots"} */
select
      'IDX-Stock' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'snapshots'
    union all
    select
      'IDX-Stock' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'snapshots'
    union all
    select
      'IDX-Stock' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'snapshots'
  
[0m16:44:51.702156 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.0 seconds
[0m16:44:51.704155 [debug] [ThreadPool]: On list_IDX-Stock_snapshots: ROLLBACK
[0m16:44:51.707169 [debug] [ThreadPool]: On list_IDX-Stock_snapshots: Close
[0m16:44:51.709170 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_IDX-Stock_snapshots, now list_IDX-Stock_warehouse)
[0m16:44:51.714310 [debug] [ThreadPool]: Using postgres connection "list_IDX-Stock_warehouse"
[0m16:44:51.715311 [debug] [ThreadPool]: On list_IDX-Stock_warehouse: BEGIN
[0m16:44:51.716321 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:44:51.740212 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m16:44:51.741219 [debug] [ThreadPool]: Using postgres connection "list_IDX-Stock_warehouse"
[0m16:44:51.741729 [debug] [ThreadPool]: On list_IDX-Stock_warehouse: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "connection_name": "list_IDX-Stock_warehouse"} */
select
      'IDX-Stock' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'warehouse'
    union all
    select
      'IDX-Stock' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'warehouse'
    union all
    select
      'IDX-Stock' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'warehouse'
  
[0m16:44:51.746808 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.0 seconds
[0m16:44:51.749280 [debug] [ThreadPool]: On list_IDX-Stock_warehouse: ROLLBACK
[0m16:44:51.752646 [debug] [ThreadPool]: On list_IDX-Stock_warehouse: Close
[0m16:44:51.762171 [debug] [MainThread]: Using postgres connection "master"
[0m16:44:51.763206 [debug] [MainThread]: On master: BEGIN
[0m16:44:51.764171 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:44:51.787730 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m16:44:51.787730 [debug] [MainThread]: Using postgres connection "master"
[0m16:44:51.789257 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m16:44:51.794748 [debug] [MainThread]: SQL status: SELECT 0 in 0.0 seconds
[0m16:44:51.797259 [debug] [MainThread]: On master: ROLLBACK
[0m16:44:51.799292 [debug] [MainThread]: Using postgres connection "master"
[0m16:44:51.800260 [debug] [MainThread]: On master: BEGIN
[0m16:44:51.804776 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m16:44:51.805782 [debug] [MainThread]: On master: COMMIT
[0m16:44:51.806781 [debug] [MainThread]: Using postgres connection "master"
[0m16:44:51.807778 [debug] [MainThread]: On master: COMMIT
[0m16:44:51.809784 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m16:44:51.811340 [debug] [MainThread]: On master: Close
[0m16:44:51.813290 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:44:51.814291 [info ] [MainThread]: 
[0m16:44:51.820292 [debug] [Thread-1 (]: Began running node snapshot.dbt_idx.customers_snapshot
[0m16:44:51.821332 [info ] [Thread-1 (]: 1 of 1 START snapshot snapshots.customers_snapshot ............................. [RUN]
[0m16:44:51.823476 [debug] [Thread-1 (]: Acquiring new postgres connection 'snapshot.dbt_idx.customers_snapshot'
[0m16:44:51.824437 [debug] [Thread-1 (]: Began compiling node snapshot.dbt_idx.customers_snapshot
[0m16:44:51.832070 [debug] [Thread-1 (]: Timing info for snapshot.dbt_idx.customers_snapshot (compile): 16:44:51.824437 => 16:44:51.832070
[0m16:44:51.833114 [debug] [Thread-1 (]: Began executing node snapshot.dbt_idx.customers_snapshot
[0m16:44:51.889101 [debug] [Thread-1 (]: Using postgres connection "snapshot.dbt_idx.customers_snapshot"
[0m16:44:51.890066 [debug] [Thread-1 (]: On snapshot.dbt_idx.customers_snapshot: BEGIN
[0m16:44:51.890066 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m16:44:51.911359 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m16:44:51.912370 [debug] [Thread-1 (]: Using postgres connection "snapshot.dbt_idx.customers_snapshot"
[0m16:44:51.913370 [debug] [Thread-1 (]: On snapshot.dbt_idx.customers_snapshot: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "snapshot.dbt_idx.customers_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "IDX-Stock".INFORMATION_SCHEMA.columns
      where table_name = 'customers_snapshot'
        
        and table_schema = 'snapshots'
        
      order by ordinal_position

  
[0m16:44:51.921961 [debug] [Thread-1 (]: SQL status: SELECT 10 in 0.0 seconds
[0m16:44:51.951026 [debug] [Thread-1 (]: Using postgres connection "snapshot.dbt_idx.customers_snapshot"
[0m16:44:51.952518 [debug] [Thread-1 (]: On snapshot.dbt_idx.customers_snapshot: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "snapshot.dbt_idx.customers_snapshot"} */

        
  
    

  create temporary table "customers_snapshot__dbt_tmp164451938473"
  
  
    as
  
  (
    with snapshot_query as (

        



select *
from "IDX-Stock"."warehouse"."customers"


    ),

    snapshotted_data as (

        select *,
            customer_id as dbt_unique_key

        from "IDX-Stock"."snapshots"."customers_snapshot"
        where dbt_valid_to is null

    ),

    insertions_source_data as (

        select
            *,
            customer_id as dbt_unique_key,
            datetime_updated as dbt_updated_at,
            datetime_updated as dbt_valid_from,
            nullif(datetime_updated, datetime_updated) as dbt_valid_to,
            md5(coalesce(cast(customer_id as varchar ), '')
         || '|' || coalesce(cast(datetime_updated as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select
            *,
            customer_id as dbt_unique_key,
            datetime_updated as dbt_updated_at,
            datetime_updated as dbt_valid_from,
            datetime_updated as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where snapshotted_data.dbt_unique_key is null
           or (
                snapshotted_data.dbt_unique_key is not null
            and (
                (snapshotted_data.dbt_valid_from < source_data.datetime_updated)
            )
        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where (
            (snapshotted_data.dbt_valid_from < source_data.datetime_updated)
        )
    )

    select * from insertions
    union all
    select * from updates

  );
  
    
[0m16:44:51.958535 [debug] [Thread-1 (]: SQL status: SELECT 10 in 0.0 seconds
[0m16:44:51.962099 [debug] [Thread-1 (]: Using postgres connection "snapshot.dbt_idx.customers_snapshot"
[0m16:44:51.963066 [debug] [Thread-1 (]: On snapshot.dbt_idx.customers_snapshot: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "snapshot.dbt_idx.customers_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'customers_snapshot__dbt_tmp164451938473'
        
      order by ordinal_position

  
[0m16:44:51.968432 [debug] [Thread-1 (]: SQL status: SELECT 12 in 0.0 seconds
[0m16:44:51.972939 [debug] [Thread-1 (]: Using postgres connection "snapshot.dbt_idx.customers_snapshot"
[0m16:44:51.973953 [debug] [Thread-1 (]: On snapshot.dbt_idx.customers_snapshot: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "snapshot.dbt_idx.customers_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "IDX-Stock".INFORMATION_SCHEMA.columns
      where table_name = 'customers_snapshot'
        
        and table_schema = 'snapshots'
        
      order by ordinal_position

  
[0m16:44:51.978982 [debug] [Thread-1 (]: SQL status: SELECT 10 in 0.0 seconds
[0m16:44:51.984464 [debug] [Thread-1 (]: Using postgres connection "snapshot.dbt_idx.customers_snapshot"
[0m16:44:51.985479 [debug] [Thread-1 (]: On snapshot.dbt_idx.customers_snapshot: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "snapshot.dbt_idx.customers_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'customers_snapshot__dbt_tmp164451938473'
        
      order by ordinal_position

  
[0m16:44:51.989479 [debug] [Thread-1 (]: SQL status: SELECT 12 in 0.0 seconds
[0m16:44:51.994000 [debug] [Thread-1 (]: Using postgres connection "snapshot.dbt_idx.customers_snapshot"
[0m16:44:51.994000 [debug] [Thread-1 (]: On snapshot.dbt_idx.customers_snapshot: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "snapshot.dbt_idx.customers_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "IDX-Stock".INFORMATION_SCHEMA.columns
      where table_name = 'customers_snapshot'
        
        and table_schema = 'snapshots'
        
      order by ordinal_position

  
[0m16:44:52.001064 [debug] [Thread-1 (]: SQL status: SELECT 10 in 0.0 seconds
[0m16:44:52.011075 [debug] [Thread-1 (]: Using postgres connection "snapshot.dbt_idx.customers_snapshot"
[0m16:44:52.011587 [debug] [Thread-1 (]: On snapshot.dbt_idx.customers_snapshot: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "snapshot.dbt_idx.customers_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'customers_snapshot__dbt_tmp164451938473'
        
      order by ordinal_position

  
[0m16:44:52.017107 [debug] [Thread-1 (]: SQL status: SELECT 12 in 0.0 seconds
[0m16:44:52.023466 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.dbt_idx.customers_snapshot"
[0m16:44:52.038990 [debug] [Thread-1 (]: Using postgres connection "snapshot.dbt_idx.customers_snapshot"
[0m16:44:52.040025 [debug] [Thread-1 (]: On snapshot.dbt_idx.customers_snapshot: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "snapshot.dbt_idx.customers_snapshot"} */

      update "IDX-Stock"."snapshots"."customers_snapshot"
    set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to
    from "customers_snapshot__dbt_tmp164451938473" as DBT_INTERNAL_SOURCE
    where DBT_INTERNAL_SOURCE.dbt_scd_id::text = "IDX-Stock"."snapshots"."customers_snapshot".dbt_scd_id::text
      and DBT_INTERNAL_SOURCE.dbt_change_type::text in ('update'::text, 'delete'::text)
      and "IDX-Stock"."snapshots"."customers_snapshot".dbt_valid_to is null;

    insert into "IDX-Stock"."snapshots"."customers_snapshot" ("customer_id", "zipcode", "city", "state_code", "datetime_created", "datetime_updated", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id")
    select DBT_INTERNAL_SOURCE."customer_id",DBT_INTERNAL_SOURCE."zipcode",DBT_INTERNAL_SOURCE."city",DBT_INTERNAL_SOURCE."state_code",DBT_INTERNAL_SOURCE."datetime_created",DBT_INTERNAL_SOURCE."datetime_updated",DBT_INTERNAL_SOURCE."dbt_updated_at",DBT_INTERNAL_SOURCE."dbt_valid_from",DBT_INTERNAL_SOURCE."dbt_valid_to",DBT_INTERNAL_SOURCE."dbt_scd_id"
    from "customers_snapshot__dbt_tmp164451938473" as DBT_INTERNAL_SOURCE
    where DBT_INTERNAL_SOURCE.dbt_change_type::text = 'insert'::text;

  
[0m16:44:52.043254 [debug] [Thread-1 (]: SQL status: INSERT 0 5 in 0.0 seconds
[0m16:44:52.059801 [debug] [Thread-1 (]: On snapshot.dbt_idx.customers_snapshot: COMMIT
[0m16:44:52.061312 [debug] [Thread-1 (]: Using postgres connection "snapshot.dbt_idx.customers_snapshot"
[0m16:44:52.062334 [debug] [Thread-1 (]: On snapshot.dbt_idx.customers_snapshot: COMMIT
[0m16:44:52.066321 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m16:44:52.071322 [debug] [Thread-1 (]: Timing info for snapshot.dbt_idx.customers_snapshot (execute): 16:44:51.835076 => 16:44:52.070347
[0m16:44:52.071833 [debug] [Thread-1 (]: On snapshot.dbt_idx.customers_snapshot: Close
[0m16:44:52.073843 [info ] [Thread-1 (]: 1 of 1 OK snapshotted snapshots.customers_snapshot ............................. [[32msuccess[0m in 0.25s]
[0m16:44:52.076840 [debug] [Thread-1 (]: Finished running node snapshot.dbt_idx.customers_snapshot
[0m16:44:52.079850 [debug] [MainThread]: Using postgres connection "master"
[0m16:44:52.079850 [debug] [MainThread]: On master: BEGIN
[0m16:44:52.081357 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:44:52.113378 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m16:44:52.115264 [debug] [MainThread]: On master: COMMIT
[0m16:44:52.116813 [debug] [MainThread]: Using postgres connection "master"
[0m16:44:52.117818 [debug] [MainThread]: On master: COMMIT
[0m16:44:52.119836 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m16:44:52.122367 [debug] [MainThread]: On master: Close
[0m16:44:52.124354 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:44:52.125355 [debug] [MainThread]: Connection 'list_IDX-Stock' was properly closed.
[0m16:44:52.126358 [debug] [MainThread]: Connection 'list_IDX-Stock_warehouse' was properly closed.
[0m16:44:52.126358 [debug] [MainThread]: Connection 'snapshot.dbt_idx.customers_snapshot' was properly closed.
[0m16:44:52.127353 [info ] [MainThread]: 
[0m16:44:52.128027 [info ] [MainThread]: Finished running 1 snapshot in 0 hours 0 minutes and 0.53 seconds (0.53s).
[0m16:44:52.129039 [debug] [MainThread]: Command end result
[0m16:44:52.153571 [info ] [MainThread]: 
[0m16:44:52.154569 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:44:52.155572 [info ] [MainThread]: 
[0m16:44:52.157551 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m16:44:52.158553 [debug] [MainThread]: Command `dbt snapshot` succeeded at 16:44:52.158553 after 0.94 seconds
[0m16:44:52.159571 [debug] [MainThread]: Flushing usage events


============================== 17:58:58.638310 | 21bf611a-c955-48cb-9cf0-5a0fd150a031 ==============================
[0m17:58:58.638310 [info ] [MainThread]: Running with dbt=1.6.1
[0m17:58:58.643312 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'D:\\00 Project\\00 My Project\\IdeaProjects\\Py-DBT-IDX\\logs', 'profiles_dir': 'D:\\00 Project\\00 My Project\\IdeaProjects\\Py-DBT-IDX', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt snapshot', 'send_anonymous_usage_stats': 'False'}
[0m17:58:58.797992 [info ] [MainThread]: Registered adapter: postgres=1.6.1
[0m17:58:58.810563 [debug] [MainThread]: checksum: efe19d9f5b93d1a98cc804fbfcdb6b3aced98b974af664946fee1cde8837deb7, vars: {}, profile: , target: , version: 1.6.1
[0m17:58:58.973765 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 4 files added, 1 files changed.
[0m17:58:58.974767 [debug] [MainThread]: Partial parsing: added file: dbt_idx://models\marts\marketing\customer_orders_status.sql
[0m17:58:58.976281 [debug] [MainThread]: Partial parsing: added file: dbt_idx://tests\assert_customer_dimension_has_no_row_loss.sql.sql
[0m17:58:58.977288 [debug] [MainThread]: Partial parsing: added file: dbt_idx://models\staging\stg_eltool.yml
[0m17:58:58.977288 [debug] [MainThread]: Partial parsing: added file: dbt_idx://models\marts\marketing\marketing.yml
[0m17:58:58.978287 [debug] [MainThread]: Partial parsing: updated file: dbt_idx://models\marts\core\dim_customers.sql
[0m17:58:59.135212 [info ] [MainThread]: Found 6 models, 1 snapshot, 9 tests, 3 sources, 0 exposures, 0 metrics, 349 macros, 0 groups, 0 semantic models
[0m17:58:59.137660 [info ] [MainThread]: 
[0m17:58:59.139666 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m17:58:59.141622 [debug] [ThreadPool]: Acquiring new postgres connection 'list_IDX-Stock'
[0m17:58:59.153140 [debug] [ThreadPool]: Using postgres connection "list_IDX-Stock"
[0m17:58:59.154143 [debug] [ThreadPool]: On list_IDX-Stock: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "connection_name": "list_IDX-Stock"} */

    select distinct nspname from pg_namespace
  
[0m17:58:59.155141 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:58:59.200895 [debug] [ThreadPool]: SQL status: SELECT 11 in 0.0 seconds
[0m17:58:59.202943 [debug] [ThreadPool]: On list_IDX-Stock: Close
[0m17:58:59.206409 [debug] [ThreadPool]: Acquiring new postgres connection 'list_IDX-Stock_warehouse'
[0m17:58:59.219016 [debug] [ThreadPool]: Using postgres connection "list_IDX-Stock_warehouse"
[0m17:58:59.219016 [debug] [ThreadPool]: On list_IDX-Stock_warehouse: BEGIN
[0m17:58:59.220091 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:58:59.246116 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m17:58:59.248209 [debug] [ThreadPool]: Using postgres connection "list_IDX-Stock_warehouse"
[0m17:58:59.249155 [debug] [ThreadPool]: On list_IDX-Stock_warehouse: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "connection_name": "list_IDX-Stock_warehouse"} */
select
      'IDX-Stock' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'warehouse'
    union all
    select
      'IDX-Stock' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'warehouse'
    union all
    select
      'IDX-Stock' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'warehouse'
  
[0m17:58:59.257726 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.0 seconds
[0m17:58:59.259735 [debug] [ThreadPool]: On list_IDX-Stock_warehouse: ROLLBACK
[0m17:58:59.262763 [debug] [ThreadPool]: On list_IDX-Stock_warehouse: Close
[0m17:58:59.264730 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_IDX-Stock_warehouse, now list_IDX-Stock_snapshots)
[0m17:58:59.269283 [debug] [ThreadPool]: Using postgres connection "list_IDX-Stock_snapshots"
[0m17:58:59.270307 [debug] [ThreadPool]: On list_IDX-Stock_snapshots: BEGIN
[0m17:58:59.271285 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:58:59.296933 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m17:58:59.297943 [debug] [ThreadPool]: Using postgres connection "list_IDX-Stock_snapshots"
[0m17:58:59.298921 [debug] [ThreadPool]: On list_IDX-Stock_snapshots: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "connection_name": "list_IDX-Stock_snapshots"} */
select
      'IDX-Stock' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'snapshots'
    union all
    select
      'IDX-Stock' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'snapshots'
    union all
    select
      'IDX-Stock' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'snapshots'
  
[0m17:58:59.304217 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.0 seconds
[0m17:58:59.305868 [debug] [ThreadPool]: On list_IDX-Stock_snapshots: ROLLBACK
[0m17:58:59.308804 [debug] [ThreadPool]: On list_IDX-Stock_snapshots: Close
[0m17:58:59.317365 [debug] [MainThread]: Using postgres connection "master"
[0m17:58:59.318366 [debug] [MainThread]: On master: BEGIN
[0m17:58:59.319368 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:58:59.342240 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m17:58:59.343273 [debug] [MainThread]: Using postgres connection "master"
[0m17:58:59.344266 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m17:58:59.352068 [debug] [MainThread]: SQL status: SELECT 0 in 0.0 seconds
[0m17:58:59.354117 [debug] [MainThread]: On master: ROLLBACK
[0m17:58:59.356103 [debug] [MainThread]: Using postgres connection "master"
[0m17:58:59.357365 [debug] [MainThread]: On master: BEGIN
[0m17:58:59.361348 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m17:58:59.362366 [debug] [MainThread]: On master: COMMIT
[0m17:58:59.363375 [debug] [MainThread]: Using postgres connection "master"
[0m17:58:59.363375 [debug] [MainThread]: On master: COMMIT
[0m17:58:59.365925 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m17:58:59.365925 [debug] [MainThread]: On master: Close
[0m17:58:59.367883 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:58:59.369902 [info ] [MainThread]: 
[0m17:58:59.374882 [debug] [Thread-1 (]: Began running node snapshot.dbt_idx.customers_snapshot
[0m17:58:59.375883 [info ] [Thread-1 (]: 1 of 1 START snapshot snapshots.customers_snapshot ............................. [RUN]
[0m17:58:59.376982 [debug] [Thread-1 (]: Acquiring new postgres connection 'snapshot.dbt_idx.customers_snapshot'
[0m17:58:59.377983 [debug] [Thread-1 (]: Began compiling node snapshot.dbt_idx.customers_snapshot
[0m17:58:59.387502 [debug] [Thread-1 (]: Timing info for snapshot.dbt_idx.customers_snapshot (compile): 17:58:59.378989 => 17:58:59.387502
[0m17:58:59.388507 [debug] [Thread-1 (]: Began executing node snapshot.dbt_idx.customers_snapshot
[0m17:58:59.438222 [debug] [Thread-1 (]: Using postgres connection "snapshot.dbt_idx.customers_snapshot"
[0m17:58:59.439246 [debug] [Thread-1 (]: On snapshot.dbt_idx.customers_snapshot: BEGIN
[0m17:58:59.440255 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m17:58:59.462976 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m17:58:59.463951 [debug] [Thread-1 (]: Using postgres connection "snapshot.dbt_idx.customers_snapshot"
[0m17:58:59.464966 [debug] [Thread-1 (]: On snapshot.dbt_idx.customers_snapshot: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "snapshot.dbt_idx.customers_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "IDX-Stock".INFORMATION_SCHEMA.columns
      where table_name = 'customers_snapshot'
        
        and table_schema = 'snapshots'
        
      order by ordinal_position

  
[0m17:58:59.489131 [debug] [Thread-1 (]: SQL status: SELECT 10 in 0.0 seconds
[0m17:58:59.519019 [debug] [Thread-1 (]: Using postgres connection "snapshot.dbt_idx.customers_snapshot"
[0m17:58:59.520024 [debug] [Thread-1 (]: On snapshot.dbt_idx.customers_snapshot: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "snapshot.dbt_idx.customers_snapshot"} */

        
  
    

  create temporary table "customers_snapshot__dbt_tmp175859505971"
  
  
    as
  
  (
    with snapshot_query as (

        



select *
from "IDX-Stock"."warehouse"."customers"


    ),

    snapshotted_data as (

        select *,
            customer_id as dbt_unique_key

        from "IDX-Stock"."snapshots"."customers_snapshot"
        where dbt_valid_to is null

    ),

    insertions_source_data as (

        select
            *,
            customer_id as dbt_unique_key,
            datetime_updated as dbt_updated_at,
            datetime_updated as dbt_valid_from,
            nullif(datetime_updated, datetime_updated) as dbt_valid_to,
            md5(coalesce(cast(customer_id as varchar ), '')
         || '|' || coalesce(cast(datetime_updated as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select
            *,
            customer_id as dbt_unique_key,
            datetime_updated as dbt_updated_at,
            datetime_updated as dbt_valid_from,
            datetime_updated as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where snapshotted_data.dbt_unique_key is null
           or (
                snapshotted_data.dbt_unique_key is not null
            and (
                (snapshotted_data.dbt_valid_from < source_data.datetime_updated)
            )
        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where (
            (snapshotted_data.dbt_valid_from < source_data.datetime_updated)
        )
    )

    select * from insertions
    union all
    select * from updates

  );
  
    
[0m17:58:59.532673 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.0 seconds
[0m17:58:59.536277 [debug] [Thread-1 (]: Using postgres connection "snapshot.dbt_idx.customers_snapshot"
[0m17:58:59.537224 [debug] [Thread-1 (]: On snapshot.dbt_idx.customers_snapshot: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "snapshot.dbt_idx.customers_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'customers_snapshot__dbt_tmp175859505971'
        
      order by ordinal_position

  
[0m17:58:59.541883 [debug] [Thread-1 (]: SQL status: SELECT 12 in 0.0 seconds
[0m17:58:59.545876 [debug] [Thread-1 (]: Using postgres connection "snapshot.dbt_idx.customers_snapshot"
[0m17:58:59.546382 [debug] [Thread-1 (]: On snapshot.dbt_idx.customers_snapshot: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "snapshot.dbt_idx.customers_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "IDX-Stock".INFORMATION_SCHEMA.columns
      where table_name = 'customers_snapshot'
        
        and table_schema = 'snapshots'
        
      order by ordinal_position

  
[0m17:58:59.550394 [debug] [Thread-1 (]: SQL status: SELECT 10 in 0.0 seconds
[0m17:58:59.556907 [debug] [Thread-1 (]: Using postgres connection "snapshot.dbt_idx.customers_snapshot"
[0m17:58:59.557908 [debug] [Thread-1 (]: On snapshot.dbt_idx.customers_snapshot: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "snapshot.dbt_idx.customers_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'customers_snapshot__dbt_tmp175859505971'
        
      order by ordinal_position

  
[0m17:58:59.562907 [debug] [Thread-1 (]: SQL status: SELECT 12 in 0.0 seconds
[0m17:58:59.566411 [debug] [Thread-1 (]: Using postgres connection "snapshot.dbt_idx.customers_snapshot"
[0m17:58:59.566411 [debug] [Thread-1 (]: On snapshot.dbt_idx.customers_snapshot: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "snapshot.dbt_idx.customers_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "IDX-Stock".INFORMATION_SCHEMA.columns
      where table_name = 'customers_snapshot'
        
        and table_schema = 'snapshots'
        
      order by ordinal_position

  
[0m17:58:59.571425 [debug] [Thread-1 (]: SQL status: SELECT 10 in 0.0 seconds
[0m17:58:59.579942 [debug] [Thread-1 (]: Using postgres connection "snapshot.dbt_idx.customers_snapshot"
[0m17:58:59.581942 [debug] [Thread-1 (]: On snapshot.dbt_idx.customers_snapshot: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "snapshot.dbt_idx.customers_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'customers_snapshot__dbt_tmp175859505971'
        
      order by ordinal_position

  
[0m17:58:59.586464 [debug] [Thread-1 (]: SQL status: SELECT 12 in 0.0 seconds
[0m17:58:59.596487 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.dbt_idx.customers_snapshot"
[0m17:58:59.611028 [debug] [Thread-1 (]: Using postgres connection "snapshot.dbt_idx.customers_snapshot"
[0m17:58:59.612052 [debug] [Thread-1 (]: On snapshot.dbt_idx.customers_snapshot: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "snapshot.dbt_idx.customers_snapshot"} */

      update "IDX-Stock"."snapshots"."customers_snapshot"
    set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to
    from "customers_snapshot__dbt_tmp175859505971" as DBT_INTERNAL_SOURCE
    where DBT_INTERNAL_SOURCE.dbt_scd_id::text = "IDX-Stock"."snapshots"."customers_snapshot".dbt_scd_id::text
      and DBT_INTERNAL_SOURCE.dbt_change_type::text in ('update'::text, 'delete'::text)
      and "IDX-Stock"."snapshots"."customers_snapshot".dbt_valid_to is null;

    insert into "IDX-Stock"."snapshots"."customers_snapshot" ("customer_id", "zipcode", "city", "state_code", "datetime_created", "datetime_updated", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id")
    select DBT_INTERNAL_SOURCE."customer_id",DBT_INTERNAL_SOURCE."zipcode",DBT_INTERNAL_SOURCE."city",DBT_INTERNAL_SOURCE."state_code",DBT_INTERNAL_SOURCE."datetime_created",DBT_INTERNAL_SOURCE."datetime_updated",DBT_INTERNAL_SOURCE."dbt_updated_at",DBT_INTERNAL_SOURCE."dbt_valid_from",DBT_INTERNAL_SOURCE."dbt_valid_to",DBT_INTERNAL_SOURCE."dbt_scd_id"
    from "customers_snapshot__dbt_tmp175859505971" as DBT_INTERNAL_SOURCE
    where DBT_INTERNAL_SOURCE.dbt_change_type::text = 'insert'::text;

  
[0m17:58:59.616024 [debug] [Thread-1 (]: SQL status: INSERT 0 0 in 0.0 seconds
[0m17:58:59.634688 [debug] [Thread-1 (]: On snapshot.dbt_idx.customers_snapshot: COMMIT
[0m17:58:59.636198 [debug] [Thread-1 (]: Using postgres connection "snapshot.dbt_idx.customers_snapshot"
[0m17:58:59.637723 [debug] [Thread-1 (]: On snapshot.dbt_idx.customers_snapshot: COMMIT
[0m17:58:59.640748 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m17:58:59.644748 [debug] [Thread-1 (]: Timing info for snapshot.dbt_idx.customers_snapshot (execute): 17:58:59.389507 => 17:58:59.644748
[0m17:58:59.645749 [debug] [Thread-1 (]: On snapshot.dbt_idx.customers_snapshot: Close
[0m17:58:59.649242 [info ] [Thread-1 (]: 1 of 1 OK snapshotted snapshots.customers_snapshot ............................. [[32msuccess[0m in 0.27s]
[0m17:58:59.652226 [debug] [Thread-1 (]: Finished running node snapshot.dbt_idx.customers_snapshot
[0m17:58:59.655752 [debug] [MainThread]: Using postgres connection "master"
[0m17:58:59.656761 [debug] [MainThread]: On master: BEGIN
[0m17:58:59.657759 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:58:59.684353 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m17:58:59.685922 [debug] [MainThread]: On master: COMMIT
[0m17:58:59.686871 [debug] [MainThread]: Using postgres connection "master"
[0m17:58:59.686871 [debug] [MainThread]: On master: COMMIT
[0m17:58:59.689885 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m17:58:59.690869 [debug] [MainThread]: On master: Close
[0m17:58:59.691892 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:58:59.692870 [debug] [MainThread]: Connection 'list_IDX-Stock' was properly closed.
[0m17:58:59.694397 [debug] [MainThread]: Connection 'list_IDX-Stock_snapshots' was properly closed.
[0m17:58:59.695914 [debug] [MainThread]: Connection 'snapshot.dbt_idx.customers_snapshot' was properly closed.
[0m17:58:59.696920 [info ] [MainThread]: 
[0m17:58:59.698921 [info ] [MainThread]: Finished running 1 snapshot in 0 hours 0 minutes and 0.56 seconds (0.56s).
[0m17:58:59.699944 [debug] [MainThread]: Command end result
[0m17:58:59.728228 [info ] [MainThread]: 
[0m17:58:59.730220 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:58:59.731234 [info ] [MainThread]: 
[0m17:58:59.733781 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m17:58:59.734769 [debug] [MainThread]: Command `dbt snapshot` succeeded at 17:58:59.734769 after 1.14 seconds
[0m17:58:59.736315 [debug] [MainThread]: Flushing usage events


============================== 17:59:15.631738 | b724f3e8-cca3-49e4-a68c-82e980ea9fbd ==============================
[0m17:59:15.631738 [info ] [MainThread]: Running with dbt=1.6.1
[0m17:59:15.638860 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'D:\\00 Project\\00 My Project\\IdeaProjects\\Py-DBT-IDX\\logs', 'debug': 'False', 'profiles_dir': 'D:\\00 Project\\00 My Project\\IdeaProjects\\Py-DBT-IDX', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'False'}
[0m17:59:15.810646 [info ] [MainThread]: Registered adapter: postgres=1.6.1
[0m17:59:15.827952 [debug] [MainThread]: checksum: efe19d9f5b93d1a98cc804fbfcdb6b3aced98b974af664946fee1cde8837deb7, vars: {}, profile: , target: , version: 1.6.1
[0m17:59:16.014622 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:59:16.016133 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:59:16.073848 [info ] [MainThread]: Found 6 models, 1 snapshot, 9 tests, 3 sources, 0 exposures, 0 metrics, 349 macros, 0 groups, 0 semantic models
[0m17:59:16.077325 [info ] [MainThread]: 
[0m17:59:16.079331 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m17:59:16.083368 [debug] [ThreadPool]: Acquiring new postgres connection 'list_IDX-Stock'
[0m17:59:16.097524 [debug] [ThreadPool]: Using postgres connection "list_IDX-Stock"
[0m17:59:16.098544 [debug] [ThreadPool]: On list_IDX-Stock: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "connection_name": "list_IDX-Stock"} */

    select distinct nspname from pg_namespace
  
[0m17:59:16.101527 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:59:16.138968 [debug] [ThreadPool]: SQL status: SELECT 13 in 0.0 seconds
[0m17:59:16.141009 [debug] [ThreadPool]: On list_IDX-Stock: Close
[0m17:59:16.145376 [debug] [ThreadPool]: Acquiring new postgres connection 'list_IDX-Stock_snapshots'
[0m17:59:16.154769 [debug] [ThreadPool]: Using postgres connection "list_IDX-Stock_snapshots"
[0m17:59:16.155769 [debug] [ThreadPool]: On list_IDX-Stock_snapshots: BEGIN
[0m17:59:16.156867 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:59:16.186133 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m17:59:16.188140 [debug] [ThreadPool]: Using postgres connection "list_IDX-Stock_snapshots"
[0m17:59:16.189142 [debug] [ThreadPool]: On list_IDX-Stock_snapshots: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "connection_name": "list_IDX-Stock_snapshots"} */
select
      'IDX-Stock' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'snapshots'
    union all
    select
      'IDX-Stock' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'snapshots'
    union all
    select
      'IDX-Stock' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'snapshots'
  
[0m17:59:16.194138 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.0 seconds
[0m17:59:16.195722 [debug] [ThreadPool]: On list_IDX-Stock_snapshots: ROLLBACK
[0m17:59:16.199279 [debug] [ThreadPool]: On list_IDX-Stock_snapshots: Close
[0m17:59:16.202301 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_IDX-Stock_snapshots, now list_IDX-Stock_warehouse)
[0m17:59:16.205817 [debug] [ThreadPool]: Using postgres connection "list_IDX-Stock_warehouse"
[0m17:59:16.206860 [debug] [ThreadPool]: On list_IDX-Stock_warehouse: BEGIN
[0m17:59:16.207857 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:59:16.233221 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m17:59:16.234752 [debug] [ThreadPool]: Using postgres connection "list_IDX-Stock_warehouse"
[0m17:59:16.234752 [debug] [ThreadPool]: On list_IDX-Stock_warehouse: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "connection_name": "list_IDX-Stock_warehouse"} */
select
      'IDX-Stock' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'warehouse'
    union all
    select
      'IDX-Stock' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'warehouse'
    union all
    select
      'IDX-Stock' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'warehouse'
  
[0m17:59:16.240835 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.0 seconds
[0m17:59:16.242845 [debug] [ThreadPool]: On list_IDX-Stock_warehouse: ROLLBACK
[0m17:59:16.246335 [debug] [ThreadPool]: On list_IDX-Stock_warehouse: Close
[0m17:59:16.258963 [debug] [MainThread]: Using postgres connection "master"
[0m17:59:16.261000 [debug] [MainThread]: On master: BEGIN
[0m17:59:16.261976 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:59:16.289680 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m17:59:16.292221 [debug] [MainThread]: Using postgres connection "master"
[0m17:59:16.294766 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m17:59:16.305816 [debug] [MainThread]: SQL status: SELECT 0 in 0.0 seconds
[0m17:59:16.308360 [debug] [MainThread]: On master: ROLLBACK
[0m17:59:16.311852 [debug] [MainThread]: Using postgres connection "master"
[0m17:59:16.312843 [debug] [MainThread]: On master: BEGIN
[0m17:59:16.316805 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m17:59:16.318809 [debug] [MainThread]: On master: COMMIT
[0m17:59:16.319811 [debug] [MainThread]: Using postgres connection "master"
[0m17:59:16.321828 [debug] [MainThread]: On master: COMMIT
[0m17:59:16.324810 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m17:59:16.325841 [debug] [MainThread]: On master: Close
[0m17:59:16.328064 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:59:16.329593 [info ] [MainThread]: 
[0m17:59:16.336106 [debug] [Thread-1 (]: Began running node model.dbt_idx.stg_eltool__customers
[0m17:59:16.337472 [info ] [Thread-1 (]: 1 of 6 START sql view model warehouse.stg_eltool__customers .................... [RUN]
[0m17:59:16.339472 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.dbt_idx.stg_eltool__customers'
[0m17:59:16.341488 [debug] [Thread-1 (]: Began compiling node model.dbt_idx.stg_eltool__customers
[0m17:59:16.354524 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_idx.stg_eltool__customers"
[0m17:59:16.362582 [debug] [Thread-1 (]: Timing info for model.dbt_idx.stg_eltool__customers (compile): 17:59:16.342472 => 17:59:16.361069
[0m17:59:16.364597 [debug] [Thread-1 (]: Began executing node model.dbt_idx.stg_eltool__customers
[0m17:59:16.413400 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_idx.stg_eltool__customers"
[0m17:59:16.420111 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__customers"
[0m17:59:16.422111 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__customers: BEGIN
[0m17:59:16.423111 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m17:59:16.451935 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m17:59:16.453446 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__customers"
[0m17:59:16.454484 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__customers: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__customers"} */

  create view "IDX-Stock"."warehouse"."stg_eltool__customers__dbt_tmp"
    
    
  as (
    with source as (select *
                from "IDX-Stock"."snapshots"."customers_snapshot"),
     renamed as (select customer_id,
                        zipcode,
                        city,
                        state_code,
                        datetime_created::TIMESTAMP AS datetime_created,
                        datetime_updated::TIMESTAMP AS datetime_updated,
                        dbt_valid_from,
                        dbt_valid_to
                 from source)
select *
from renamed
  );
[0m17:59:16.468540 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m17:59:16.478716 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__customers"
[0m17:59:16.479716 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__customers: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__customers"} */
alter table "IDX-Stock"."warehouse"."stg_eltool__customers__dbt_tmp" rename to "stg_eltool__customers"
[0m17:59:16.483716 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m17:59:16.501266 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__customers: COMMIT
[0m17:59:16.502267 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__customers"
[0m17:59:16.502267 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__customers: COMMIT
[0m17:59:16.506819 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m17:59:16.517335 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__customers"
[0m17:59:16.518347 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__customers: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__customers"} */
drop view if exists "IDX-Stock"."warehouse"."stg_eltool__customers__dbt_backup" cascade
[0m17:59:16.521862 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m17:59:16.524896 [debug] [Thread-1 (]: Timing info for model.dbt_idx.stg_eltool__customers (execute): 17:59:16.364597 => 17:59:16.523884
[0m17:59:16.524896 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__customers: Close
[0m17:59:16.527398 [info ] [Thread-1 (]: 1 of 6 OK created sql view model warehouse.stg_eltool__customers ............... [[32mCREATE VIEW[0m in 0.19s]
[0m17:59:16.530413 [debug] [Thread-1 (]: Finished running node model.dbt_idx.stg_eltool__customers
[0m17:59:16.532405 [debug] [Thread-1 (]: Began running node model.dbt_idx.stg_eltool__orders
[0m17:59:16.534420 [info ] [Thread-1 (]: 2 of 6 START sql view model warehouse.stg_eltool__orders ....................... [RUN]
[0m17:59:16.536954 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_idx.stg_eltool__customers, now model.dbt_idx.stg_eltool__orders)
[0m17:59:16.537971 [debug] [Thread-1 (]: Began compiling node model.dbt_idx.stg_eltool__orders
[0m17:59:16.544491 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_idx.stg_eltool__orders"
[0m17:59:16.557152 [debug] [Thread-1 (]: Timing info for model.dbt_idx.stg_eltool__orders (compile): 17:59:16.538954 => 17:59:16.556135
[0m17:59:16.558151 [debug] [Thread-1 (]: Began executing node model.dbt_idx.stg_eltool__orders
[0m17:59:16.569239 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_idx.stg_eltool__orders"
[0m17:59:16.579832 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__orders"
[0m17:59:16.580834 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__orders: BEGIN
[0m17:59:16.583859 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:59:16.613629 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m17:59:16.614671 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__orders"
[0m17:59:16.615799 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__orders: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__orders"} */

  create view "IDX-Stock"."warehouse"."stg_eltool__orders__dbt_tmp"
    
    
  as (
    with source as (select *
                from "IDX-Stock"."warehouse"."orders"),
     renamed as (select order_id,
                        cust_id AS customer_id,
                        order_status,
                        order_purchase_timestamp::TIMESTAMP,
                        order_approved_at::TIMESTAMP,
                        order_delivered_carrier_date::TIMESTAMP,
                        order_delivered_customer_date::TIMESTAMP,
                        order_estimated_delivery_date::TIMESTAMP
                 from source)
select *
from renamed
  );
[0m17:59:16.620742 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m17:59:16.624761 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__orders"
[0m17:59:16.625745 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__orders: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__orders"} */
alter table "IDX-Stock"."warehouse"."stg_eltool__orders__dbt_tmp" rename to "stg_eltool__orders"
[0m17:59:16.629309 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m17:59:16.632315 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__orders: COMMIT
[0m17:59:16.633326 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__orders"
[0m17:59:16.634334 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__orders: COMMIT
[0m17:59:16.637889 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m17:59:16.642918 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__orders"
[0m17:59:16.642918 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__orders: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__orders"} */
drop view if exists "IDX-Stock"."warehouse"."stg_eltool__orders__dbt_backup" cascade
[0m17:59:16.647008 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m17:59:16.649017 [debug] [Thread-1 (]: Timing info for model.dbt_idx.stg_eltool__orders (execute): 17:59:16.559150 => 17:59:16.649017
[0m17:59:16.650022 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__orders: Close
[0m17:59:16.653035 [info ] [Thread-1 (]: 2 of 6 OK created sql view model warehouse.stg_eltool__orders .................. [[32mCREATE VIEW[0m in 0.12s]
[0m17:59:16.656089 [debug] [Thread-1 (]: Finished running node model.dbt_idx.stg_eltool__orders
[0m17:59:16.658100 [debug] [Thread-1 (]: Began running node model.dbt_idx.stg_eltool__state
[0m17:59:16.660691 [info ] [Thread-1 (]: 3 of 6 START sql view model warehouse.stg_eltool__state ........................ [RUN]
[0m17:59:16.662619 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_idx.stg_eltool__orders, now model.dbt_idx.stg_eltool__state)
[0m17:59:16.663619 [debug] [Thread-1 (]: Began compiling node model.dbt_idx.stg_eltool__state
[0m17:59:16.669162 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_idx.stg_eltool__state"
[0m17:59:16.674716 [debug] [Thread-1 (]: Timing info for model.dbt_idx.stg_eltool__state (compile): 17:59:16.663619 => 17:59:16.674716
[0m17:59:16.675716 [debug] [Thread-1 (]: Began executing node model.dbt_idx.stg_eltool__state
[0m17:59:16.684578 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_idx.stg_eltool__state"
[0m17:59:16.691097 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__state"
[0m17:59:16.693091 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__state: BEGIN
[0m17:59:16.693091 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:59:16.722634 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m17:59:16.723636 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__state"
[0m17:59:16.724634 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__state: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__state"} */

  create view "IDX-Stock"."warehouse"."stg_eltool__state__dbt_tmp"
    
    
  as (
    with source as (select *
                from "IDX-Stock"."warehouse"."state"),
     renamed as (select state_identifier::INT AS state_id,
                         state_code::VARCHAR(2) AS state_code,
                         st_name::VARCHAR(30) AS state_name
                 from source)
select *
from renamed
  );
[0m17:59:16.729180 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m17:59:16.733165 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__state"
[0m17:59:16.734194 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__state: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__state"} */
alter table "IDX-Stock"."warehouse"."stg_eltool__state__dbt_tmp" rename to "stg_eltool__state"
[0m17:59:16.736711 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m17:59:16.740221 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__state: COMMIT
[0m17:59:16.741223 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__state"
[0m17:59:16.742221 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__state: COMMIT
[0m17:59:16.746269 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m17:59:16.750283 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__state"
[0m17:59:16.751279 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__state: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__state"} */
drop view if exists "IDX-Stock"."warehouse"."stg_eltool__state__dbt_backup" cascade
[0m17:59:16.754287 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m17:59:16.758850 [debug] [Thread-1 (]: Timing info for model.dbt_idx.stg_eltool__state (execute): 17:59:16.677067 => 17:59:16.757850
[0m17:59:16.759853 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__state: Close
[0m17:59:16.763439 [info ] [Thread-1 (]: 3 of 6 OK created sql view model warehouse.stg_eltool__state ................... [[32mCREATE VIEW[0m in 0.10s]
[0m17:59:16.766498 [debug] [Thread-1 (]: Finished running node model.dbt_idx.stg_eltool__state
[0m17:59:16.768513 [debug] [Thread-1 (]: Began running node model.dbt_idx.fct_orders
[0m17:59:16.770767 [info ] [Thread-1 (]: 4 of 6 START sql table model warehouse.fct_orders .............................. [RUN]
[0m17:59:16.773288 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_idx.stg_eltool__state, now model.dbt_idx.fct_orders)
[0m17:59:16.774799 [debug] [Thread-1 (]: Began compiling node model.dbt_idx.fct_orders
[0m17:59:16.779564 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_idx.fct_orders"
[0m17:59:16.786197 [debug] [Thread-1 (]: Timing info for model.dbt_idx.fct_orders (compile): 17:59:16.774799 => 17:59:16.784577
[0m17:59:16.787097 [debug] [Thread-1 (]: Began executing node model.dbt_idx.fct_orders
[0m17:59:16.821201 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_idx.fct_orders"
[0m17:59:16.826733 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.fct_orders"
[0m17:59:16.827918 [debug] [Thread-1 (]: On model.dbt_idx.fct_orders: BEGIN
[0m17:59:16.828932 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:59:16.854847 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m17:59:16.856339 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.fct_orders"
[0m17:59:16.857347 [debug] [Thread-1 (]: On model.dbt_idx.fct_orders: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.fct_orders"} */

  
    

  create  table "IDX-Stock"."warehouse"."fct_orders__dbt_tmp"
  
  
    as
  
  (
    with orders as (
    select *
    from "IDX-Stock"."warehouse"."stg_eltool__orders"
)
select * from orders
  );
  
[0m17:59:16.870925 [debug] [Thread-1 (]: SQL status: SELECT 999 in 0.0 seconds
[0m17:59:16.878714 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.fct_orders"
[0m17:59:16.879715 [debug] [Thread-1 (]: On model.dbt_idx.fct_orders: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.fct_orders"} */
alter table "IDX-Stock"."warehouse"."fct_orders__dbt_tmp" rename to "fct_orders"
[0m17:59:16.883721 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m17:59:16.894464 [debug] [Thread-1 (]: On model.dbt_idx.fct_orders: COMMIT
[0m17:59:16.896984 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.fct_orders"
[0m17:59:16.898996 [debug] [Thread-1 (]: On model.dbt_idx.fct_orders: COMMIT
[0m17:59:16.903996 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m17:59:16.912681 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.fct_orders"
[0m17:59:16.913672 [debug] [Thread-1 (]: On model.dbt_idx.fct_orders: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.fct_orders"} */
drop table if exists "IDX-Stock"."warehouse"."fct_orders__dbt_backup" cascade
[0m17:59:16.916818 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m17:59:16.919831 [debug] [Thread-1 (]: Timing info for model.dbt_idx.fct_orders (execute): 17:59:16.788096 => 17:59:16.919831
[0m17:59:16.920826 [debug] [Thread-1 (]: On model.dbt_idx.fct_orders: Close
[0m17:59:16.923829 [info ] [Thread-1 (]: 4 of 6 OK created sql table model warehouse.fct_orders ......................... [[32mSELECT 999[0m in 0.15s]
[0m17:59:16.925829 [debug] [Thread-1 (]: Finished running node model.dbt_idx.fct_orders
[0m17:59:16.927369 [debug] [Thread-1 (]: Began running node model.dbt_idx.dim_customers
[0m17:59:16.928361 [info ] [Thread-1 (]: 5 of 6 START sql table model warehouse.dim_customers ........................... [RUN]
[0m17:59:16.930362 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_idx.fct_orders, now model.dbt_idx.dim_customers)
[0m17:59:16.931364 [debug] [Thread-1 (]: Began compiling node model.dbt_idx.dim_customers
[0m17:59:16.935908 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_idx.dim_customers"
[0m17:59:16.940916 [debug] [Thread-1 (]: Timing info for model.dbt_idx.dim_customers (compile): 17:59:16.932364 => 17:59:16.939920
[0m17:59:16.942425 [debug] [Thread-1 (]: Began executing node model.dbt_idx.dim_customers
[0m17:59:16.950098 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_idx.dim_customers"
[0m17:59:16.957152 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.dim_customers"
[0m17:59:16.959171 [debug] [Thread-1 (]: On model.dbt_idx.dim_customers: BEGIN
[0m17:59:16.960175 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:59:16.992825 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m17:59:16.994332 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.dim_customers"
[0m17:59:16.995938 [debug] [Thread-1 (]: On model.dbt_idx.dim_customers: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.dim_customers"} */

  
    

  create  table "IDX-Stock"."warehouse"."dim_customers__dbt_tmp"
  
  
    as
  
  (
    -- noinspection SqlDialectInspectionForFile

with customers as (
    select *
    from "IDX-Stock"."warehouse"."stg_eltool__customers"
    ),
     state as (
         select *
         from "IDX-Stock"."warehouse"."stg_eltool__state"
     )
select c.customer_id,
       c.zipcode,
       c.city,
       c.state_code,
       s.state_name,
       c.datetime_created,
       c.datetime_updated,
       c.dbt_valid_from::TIMESTAMP as valid_from,
        CASE WHEN c.dbt_valid_to IS NULL
            THEN '9999-12-31'::TIMESTAMP
            ELSE c.dbt_valid_to::TIMESTAMP
        END as valid_to
from customers c
    join state s on c.state_code = s.state_code
  );
  
[0m17:59:17.002857 [debug] [Thread-1 (]: SQL status: SELECT 105 in 0.0 seconds
[0m17:59:17.006364 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.dim_customers"
[0m17:59:17.007371 [debug] [Thread-1 (]: On model.dbt_idx.dim_customers: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.dim_customers"} */
alter table "IDX-Stock"."warehouse"."dim_customers__dbt_tmp" rename to "dim_customers"
[0m17:59:17.010925 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m17:59:17.013928 [debug] [Thread-1 (]: On model.dbt_idx.dim_customers: COMMIT
[0m17:59:17.014927 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.dim_customers"
[0m17:59:17.016455 [debug] [Thread-1 (]: On model.dbt_idx.dim_customers: COMMIT
[0m17:59:17.020492 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m17:59:17.023486 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.dim_customers"
[0m17:59:17.024487 [debug] [Thread-1 (]: On model.dbt_idx.dim_customers: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.dim_customers"} */
drop table if exists "IDX-Stock"."warehouse"."dim_customers__dbt_backup" cascade
[0m17:59:17.027605 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m17:59:17.030163 [debug] [Thread-1 (]: Timing info for model.dbt_idx.dim_customers (execute): 17:59:16.943435 => 17:59:17.030163
[0m17:59:17.032122 [debug] [Thread-1 (]: On model.dbt_idx.dim_customers: Close
[0m17:59:17.034127 [info ] [Thread-1 (]: 5 of 6 OK created sql table model warehouse.dim_customers ...................... [[32mSELECT 105[0m in 0.10s]
[0m17:59:17.036132 [debug] [Thread-1 (]: Finished running node model.dbt_idx.dim_customers
[0m17:59:17.038375 [debug] [Thread-1 (]: Began running node model.dbt_idx.customer_orders_status
[0m17:59:17.039375 [info ] [Thread-1 (]: 6 of 6 START sql view model warehouse.customer_orders_status ................... [RUN]
[0m17:59:17.041381 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_idx.dim_customers, now model.dbt_idx.customer_orders_status)
[0m17:59:17.042376 [debug] [Thread-1 (]: Began compiling node model.dbt_idx.customer_orders_status
[0m17:59:17.046476 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_idx.customer_orders_status"
[0m17:59:17.051732 [debug] [Thread-1 (]: Timing info for model.dbt_idx.customer_orders_status (compile): 17:59:17.043397 => 17:59:17.051732
[0m17:59:17.052731 [debug] [Thread-1 (]: Began executing node model.dbt_idx.customer_orders_status
[0m17:59:17.059778 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_idx.customer_orders_status"
[0m17:59:17.065789 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.customer_orders_status"
[0m17:59:17.067822 [debug] [Thread-1 (]: On model.dbt_idx.customer_orders_status: BEGIN
[0m17:59:17.068824 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:59:17.100691 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m17:59:17.101705 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.customer_orders_status"
[0m17:59:17.102694 [debug] [Thread-1 (]: On model.dbt_idx.customer_orders_status: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.customer_orders_status"} */

  create view "IDX-Stock"."warehouse"."customer_orders_status__dbt_tmp"
    
    
  as (
    with orders as (select *
                from "IDX-Stock"."warehouse"."fct_orders"),
     customers as (select *
                   from "IDX-Stock"."warehouse"."dim_customers")
select o.order_id,
       o.customer_id,
       o.order_status,
       o.order_purchase_timestamp,
       o.order_approved_at,
       o.order_delivered_carrier_date,
       o.order_delivered_customer_date,
       o.order_estimated_delivery_date,
       c.zipcode    as customer_zipcode,
       c.city       as customer_city,
       c.state_code as customer_state_code,
       c.state_name as customer_state_name
from orders o
    join customers c on o.customer_id = c.customer_id
    and o.order_purchase_timestamp >= c.valid_from
    and o.order_purchase_timestamp <= c.valid_to
  );
[0m17:59:17.107877 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m17:59:17.114767 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.customer_orders_status"
[0m17:59:17.115774 [debug] [Thread-1 (]: On model.dbt_idx.customer_orders_status: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.customer_orders_status"} */
alter table "IDX-Stock"."warehouse"."customer_orders_status__dbt_tmp" rename to "customer_orders_status"
[0m17:59:17.118201 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m17:59:17.122201 [debug] [Thread-1 (]: On model.dbt_idx.customer_orders_status: COMMIT
[0m17:59:17.123199 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.customer_orders_status"
[0m17:59:17.124219 [debug] [Thread-1 (]: On model.dbt_idx.customer_orders_status: COMMIT
[0m17:59:17.129289 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m17:59:17.134636 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.customer_orders_status"
[0m17:59:17.136207 [debug] [Thread-1 (]: On model.dbt_idx.customer_orders_status: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.customer_orders_status"} */
drop view if exists "IDX-Stock"."warehouse"."customer_orders_status__dbt_backup" cascade
[0m17:59:17.139185 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m17:59:17.142176 [debug] [Thread-1 (]: Timing info for model.dbt_idx.customer_orders_status (execute): 17:59:17.054240 => 17:59:17.142176
[0m17:59:17.144177 [debug] [Thread-1 (]: On model.dbt_idx.customer_orders_status: Close
[0m17:59:17.146696 [info ] [Thread-1 (]: 6 of 6 OK created sql view model warehouse.customer_orders_status .............. [[32mCREATE VIEW[0m in 0.10s]
[0m17:59:17.149984 [debug] [Thread-1 (]: Finished running node model.dbt_idx.customer_orders_status
[0m17:59:17.153986 [debug] [MainThread]: Using postgres connection "master"
[0m17:59:17.155990 [debug] [MainThread]: On master: BEGIN
[0m17:59:17.157081 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:59:17.189859 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m17:59:17.191858 [debug] [MainThread]: On master: COMMIT
[0m17:59:17.192863 [debug] [MainThread]: Using postgres connection "master"
[0m17:59:17.193875 [debug] [MainThread]: On master: COMMIT
[0m17:59:17.195700 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m17:59:17.196707 [debug] [MainThread]: On master: Close
[0m17:59:17.198708 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:59:17.201266 [debug] [MainThread]: Connection 'list_IDX-Stock' was properly closed.
[0m17:59:17.203265 [debug] [MainThread]: Connection 'list_IDX-Stock_warehouse' was properly closed.
[0m17:59:17.204264 [debug] [MainThread]: Connection 'model.dbt_idx.customer_orders_status' was properly closed.
[0m17:59:17.205831 [info ] [MainThread]: 
[0m17:59:17.207785 [info ] [MainThread]: Finished running 4 view models, 2 table models in 0 hours 0 minutes and 1.13 seconds (1.13s).
[0m17:59:17.209782 [debug] [MainThread]: Command end result
[0m17:59:17.240886 [info ] [MainThread]: 
[0m17:59:17.242899 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:59:17.243894 [info ] [MainThread]: 
[0m17:59:17.246422 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 TOTAL=6
[0m17:59:17.248536 [debug] [MainThread]: Command `dbt run` succeeded at 17:59:17.248536 after 1.66 seconds
[0m17:59:17.250577 [debug] [MainThread]: Flushing usage events


============================== 18:04:14.148088 | d37ed150-dade-42b7-8d9e-ea7f556a911c ==============================
[0m18:04:14.148088 [info ] [MainThread]: Running with dbt=1.6.1
[0m18:04:14.153492 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'D:\\00 Project\\00 My Project\\IdeaProjects\\Py-DBT-IDX', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': 'D:\\00 Project\\00 My Project\\IdeaProjects\\Py-DBT-IDX\\logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'False'}
[0m18:04:14.291041 [info ] [MainThread]: Registered adapter: postgres=1.6.1
[0m18:04:14.300656 [debug] [MainThread]: checksum: efe19d9f5b93d1a98cc804fbfcdb6b3aced98b974af664946fee1cde8837deb7, vars: {}, profile: , target: , version: 1.6.1
[0m18:04:14.330305 [error] [MainThread]: Encountered an error:
Parsing Error
  The schema file at models\staging\stg_eltool.yml is invalid because the value of 'models' is not a list
[0m18:04:14.332313 [debug] [MainThread]: Command `dbt run` failed at 18:04:14.331311 after 0.22 seconds
[0m18:04:14.333309 [debug] [MainThread]: Flushing usage events


============================== 18:04:26.515256 | dc025216-ed3f-4bc1-900b-c81b449d05d0 ==============================
[0m18:04:26.515256 [info ] [MainThread]: Running with dbt=1.6.1
[0m18:04:26.521285 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'D:\\00 Project\\00 My Project\\IdeaProjects\\Py-DBT-IDX\\logs', 'debug': 'False', 'profiles_dir': 'D:\\00 Project\\00 My Project\\IdeaProjects\\Py-DBT-IDX', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'False'}
[0m18:04:26.657828 [info ] [MainThread]: Registered adapter: postgres=1.6.1
[0m18:04:26.668345 [debug] [MainThread]: checksum: efe19d9f5b93d1a98cc804fbfcdb6b3aced98b974af664946fee1cde8837deb7, vars: {}, profile: , target: , version: 1.6.1
[0m18:04:26.813919 [debug] [MainThread]: Partial parsing enabled: 1 files deleted, 1 files added, 2 files changed.
[0m18:04:26.815427 [debug] [MainThread]: Partial parsing: added file: dbt_idx://models\marts\core\fact_orders.sql
[0m18:04:26.815427 [debug] [MainThread]: Partial parsing: updated file: dbt_idx://models\marts\core\core.yml
[0m18:04:26.816433 [debug] [MainThread]: Partial parsing: updated file: dbt_idx://models\staging\stg_eltool.yml
[0m18:04:26.817440 [debug] [MainThread]: Partial parsing: deleted file: dbt_idx://models\marts\core\fct_orders.sql
[0m18:04:26.895136 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.dbt_idx.customer_orders_status' (models\marts\marketing\customer_orders_status.sql) depends on a node named 'fct_orders' which was not found
[0m18:04:26.897139 [debug] [MainThread]: Command `dbt run` failed at 18:04:26.896092 after 0.43 seconds
[0m18:04:26.897139 [debug] [MainThread]: Flushing usage events


============================== 18:04:56.315504 | dec835f7-2566-4566-a7ca-1ca5d2467f06 ==============================
[0m18:04:56.315504 [info ] [MainThread]: Running with dbt=1.6.1
[0m18:04:56.321504 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'D:\\00 Project\\00 My Project\\IdeaProjects\\Py-DBT-IDX', 'version_check': 'True', 'debug': 'False', 'log_path': 'D:\\00 Project\\00 My Project\\IdeaProjects\\Py-DBT-IDX\\logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'False'}
[0m18:04:56.475799 [info ] [MainThread]: Registered adapter: postgres=1.6.1
[0m18:04:56.492458 [debug] [MainThread]: checksum: efe19d9f5b93d1a98cc804fbfcdb6b3aced98b974af664946fee1cde8837deb7, vars: {}, profile: , target: , version: 1.6.1
[0m18:04:56.677143 [debug] [MainThread]: Partial parsing enabled: 1 files deleted, 1 files added, 3 files changed.
[0m18:04:56.678112 [debug] [MainThread]: Partial parsing: added file: dbt_idx://models\marts\core\fact_orders.sql
[0m18:04:56.679161 [debug] [MainThread]: Partial parsing: updated file: dbt_idx://models\marts\core\core.yml
[0m18:04:56.680113 [debug] [MainThread]: Partial parsing: updated file: dbt_idx://models\staging\stg_eltool.yml
[0m18:04:56.681112 [debug] [MainThread]: Partial parsing: deleted file: dbt_idx://models\marts\core\fct_orders.sql
[0m18:04:56.682127 [debug] [MainThread]: Partial parsing: updated file: dbt_idx://models\marts\marketing\customer_orders_status.sql
[0m18:04:56.880344 [info ] [MainThread]: Found 1 snapshot, 8 tests, 6 models, 3 sources, 0 exposures, 0 metrics, 349 macros, 0 groups, 0 semantic models
[0m18:04:56.883346 [info ] [MainThread]: 
[0m18:04:56.886400 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m18:04:56.890419 [debug] [ThreadPool]: Acquiring new postgres connection 'list_IDX-Stock'
[0m18:04:56.917135 [debug] [ThreadPool]: Using postgres connection "list_IDX-Stock"
[0m18:04:56.918155 [debug] [ThreadPool]: On list_IDX-Stock: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "connection_name": "list_IDX-Stock"} */

    select distinct nspname from pg_namespace
  
[0m18:04:56.919885 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:04:56.957102 [debug] [ThreadPool]: SQL status: SELECT 13 in 0.0 seconds
[0m18:04:56.960127 [debug] [ThreadPool]: On list_IDX-Stock: Close
[0m18:04:56.964619 [debug] [ThreadPool]: Acquiring new postgres connection 'list_IDX-Stock_warehouse'
[0m18:04:56.974674 [debug] [ThreadPool]: Using postgres connection "list_IDX-Stock_warehouse"
[0m18:04:56.975184 [debug] [ThreadPool]: On list_IDX-Stock_warehouse: BEGIN
[0m18:04:56.976192 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:04:57.000285 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m18:04:57.001281 [debug] [ThreadPool]: Using postgres connection "list_IDX-Stock_warehouse"
[0m18:04:57.002275 [debug] [ThreadPool]: On list_IDX-Stock_warehouse: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "connection_name": "list_IDX-Stock_warehouse"} */
select
      'IDX-Stock' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'warehouse'
    union all
    select
      'IDX-Stock' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'warehouse'
    union all
    select
      'IDX-Stock' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'warehouse'
  
[0m18:04:57.007798 [debug] [ThreadPool]: SQL status: SELECT 9 in 0.0 seconds
[0m18:04:57.009797 [debug] [ThreadPool]: On list_IDX-Stock_warehouse: ROLLBACK
[0m18:04:57.012324 [debug] [ThreadPool]: On list_IDX-Stock_warehouse: Close
[0m18:04:57.014924 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_IDX-Stock_warehouse, now list_IDX-Stock_snapshots)
[0m18:04:57.020872 [debug] [ThreadPool]: Using postgres connection "list_IDX-Stock_snapshots"
[0m18:04:57.021872 [debug] [ThreadPool]: On list_IDX-Stock_snapshots: BEGIN
[0m18:04:57.022872 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:04:57.046084 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m18:04:57.048073 [debug] [ThreadPool]: Using postgres connection "list_IDX-Stock_snapshots"
[0m18:04:57.048073 [debug] [ThreadPool]: On list_IDX-Stock_snapshots: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "connection_name": "list_IDX-Stock_snapshots"} */
select
      'IDX-Stock' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'snapshots'
    union all
    select
      'IDX-Stock' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'snapshots'
    union all
    select
      'IDX-Stock' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'snapshots'
  
[0m18:04:57.053088 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.0 seconds
[0m18:04:57.054646 [debug] [ThreadPool]: On list_IDX-Stock_snapshots: ROLLBACK
[0m18:04:57.057176 [debug] [ThreadPool]: On list_IDX-Stock_snapshots: Close
[0m18:04:57.069697 [debug] [MainThread]: Using postgres connection "master"
[0m18:04:57.070695 [debug] [MainThread]: On master: BEGIN
[0m18:04:57.071697 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:04:57.096791 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m18:04:57.097796 [debug] [MainThread]: Using postgres connection "master"
[0m18:04:57.098855 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m18:04:57.107573 [debug] [MainThread]: SQL status: SELECT 5 in 0.0 seconds
[0m18:04:57.111606 [debug] [MainThread]: On master: ROLLBACK
[0m18:04:57.113578 [debug] [MainThread]: Using postgres connection "master"
[0m18:04:57.114603 [debug] [MainThread]: On master: BEGIN
[0m18:04:57.117662 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m18:04:57.118703 [debug] [MainThread]: On master: COMMIT
[0m18:04:57.119673 [debug] [MainThread]: Using postgres connection "master"
[0m18:04:57.120675 [debug] [MainThread]: On master: COMMIT
[0m18:04:57.123678 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m18:04:57.124731 [debug] [MainThread]: On master: Close
[0m18:04:57.128008 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:04:57.129008 [info ] [MainThread]: 
[0m18:04:57.136705 [debug] [Thread-1 (]: Began running node model.dbt_idx.stg_eltool__customers
[0m18:04:57.137733 [info ] [Thread-1 (]: 1 of 6 START sql view model warehouse.stg_eltool__customers .................... [RUN]
[0m18:04:57.139702 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.dbt_idx.stg_eltool__customers'
[0m18:04:57.140719 [debug] [Thread-1 (]: Began compiling node model.dbt_idx.stg_eltool__customers
[0m18:04:57.148319 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_idx.stg_eltool__customers"
[0m18:04:57.156359 [debug] [Thread-1 (]: Timing info for model.dbt_idx.stg_eltool__customers (compile): 18:04:57.141712 => 18:04:57.156359
[0m18:04:57.157368 [debug] [Thread-1 (]: Began executing node model.dbt_idx.stg_eltool__customers
[0m18:04:57.206211 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_idx.stg_eltool__customers"
[0m18:04:57.213245 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__customers"
[0m18:04:57.214821 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__customers: BEGIN
[0m18:04:57.215761 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m18:04:57.244618 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m18:04:57.246762 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__customers"
[0m18:04:57.247763 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__customers: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__customers"} */

  create view "IDX-Stock"."warehouse"."stg_eltool__customers__dbt_tmp"
    
    
  as (
    with source as (select *
                from "IDX-Stock"."snapshots"."customers_snapshot"),
     renamed as (select customer_id,
                        zipcode,
                        city,
                        state_code,
                        datetime_created::TIMESTAMP AS datetime_created,
                        datetime_updated::TIMESTAMP AS datetime_updated,
                        dbt_valid_from,
                        dbt_valid_to
                 from source)
select *
from renamed
  );
[0m18:04:57.259313 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m18:04:57.271890 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__customers"
[0m18:04:57.272906 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__customers: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__customers"} */
alter table "IDX-Stock"."warehouse"."stg_eltool__customers" rename to "stg_eltool__customers__dbt_backup"
[0m18:04:57.276057 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:04:57.281053 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__customers"
[0m18:04:57.282559 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__customers: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__customers"} */
alter table "IDX-Stock"."warehouse"."stg_eltool__customers__dbt_tmp" rename to "stg_eltool__customers"
[0m18:04:57.286094 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:04:57.307103 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__customers: COMMIT
[0m18:04:57.308132 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__customers"
[0m18:04:57.309111 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__customers: COMMIT
[0m18:04:57.313133 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m18:04:57.326776 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__customers"
[0m18:04:57.327743 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__customers: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__customers"} */
drop view if exists "IDX-Stock"."warehouse"."stg_eltool__customers__dbt_backup" cascade
[0m18:04:57.331779 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m18:04:57.334778 [debug] [Thread-1 (]: Timing info for model.dbt_idx.stg_eltool__customers (execute): 18:04:57.158565 => 18:04:57.333754
[0m18:04:57.335332 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__customers: Close
[0m18:04:57.337341 [info ] [Thread-1 (]: 1 of 6 OK created sql view model warehouse.stg_eltool__customers ............... [[32mCREATE VIEW[0m in 0.20s]
[0m18:04:57.339854 [debug] [Thread-1 (]: Finished running node model.dbt_idx.stg_eltool__customers
[0m18:04:57.341896 [debug] [Thread-1 (]: Began running node model.dbt_idx.stg_eltool__orders
[0m18:04:57.343865 [info ] [Thread-1 (]: 2 of 6 START sql view model warehouse.stg_eltool__orders ....................... [RUN]
[0m18:04:57.346317 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_idx.stg_eltool__customers, now model.dbt_idx.stg_eltool__orders)
[0m18:04:57.347299 [debug] [Thread-1 (]: Began compiling node model.dbt_idx.stg_eltool__orders
[0m18:04:57.351301 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_idx.stg_eltool__orders"
[0m18:04:57.363404 [debug] [Thread-1 (]: Timing info for model.dbt_idx.stg_eltool__orders (compile): 18:04:57.348310 => 18:04:57.363404
[0m18:04:57.365047 [debug] [Thread-1 (]: Began executing node model.dbt_idx.stg_eltool__orders
[0m18:04:57.370989 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_idx.stg_eltool__orders"
[0m18:04:57.385496 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__orders"
[0m18:04:57.386598 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__orders: BEGIN
[0m18:04:57.387268 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:04:57.411098 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m18:04:57.412097 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__orders"
[0m18:04:57.412097 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__orders: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__orders"} */

  create view "IDX-Stock"."warehouse"."stg_eltool__orders__dbt_tmp"
    
    
  as (
    with source as (select *
                from "IDX-Stock"."warehouse"."orders"),
     renamed as (select order_id,
                        cust_id AS customer_id,
                        order_status,
                        order_purchase_timestamp::TIMESTAMP,
                        order_approved_at::TIMESTAMP,
                        order_delivered_carrier_date::TIMESTAMP,
                        order_delivered_customer_date::TIMESTAMP,
                        order_estimated_delivery_date::TIMESTAMP
                 from source)
select *
from renamed
  );
[0m18:04:57.417651 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m18:04:57.423208 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__orders"
[0m18:04:57.423208 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__orders: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__orders"} */
alter table "IDX-Stock"."warehouse"."stg_eltool__orders" rename to "stg_eltool__orders__dbt_backup"
[0m18:04:57.426786 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:04:57.431758 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__orders"
[0m18:04:57.432793 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__orders: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__orders"} */
alter table "IDX-Stock"."warehouse"."stg_eltool__orders__dbt_tmp" rename to "stg_eltool__orders"
[0m18:04:57.436008 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:04:57.439044 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__orders: COMMIT
[0m18:04:57.440050 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__orders"
[0m18:04:57.441325 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__orders: COMMIT
[0m18:04:57.446864 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m18:04:57.450873 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__orders"
[0m18:04:57.450873 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__orders: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__orders"} */
drop view if exists "IDX-Stock"."warehouse"."stg_eltool__orders__dbt_backup" cascade
[0m18:04:57.456450 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m18:04:57.458457 [debug] [Thread-1 (]: Timing info for model.dbt_idx.stg_eltool__orders (execute): 18:04:57.365986 => 18:04:57.458457
[0m18:04:57.459478 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__orders: Close
[0m18:04:57.462009 [info ] [Thread-1 (]: 2 of 6 OK created sql view model warehouse.stg_eltool__orders .................. [[32mCREATE VIEW[0m in 0.12s]
[0m18:04:57.463993 [debug] [Thread-1 (]: Finished running node model.dbt_idx.stg_eltool__orders
[0m18:04:57.465501 [debug] [Thread-1 (]: Began running node model.dbt_idx.stg_eltool__state
[0m18:04:57.467524 [info ] [Thread-1 (]: 3 of 6 START sql view model warehouse.stg_eltool__state ........................ [RUN]
[0m18:04:57.469523 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_idx.stg_eltool__orders, now model.dbt_idx.stg_eltool__state)
[0m18:04:57.470523 [debug] [Thread-1 (]: Began compiling node model.dbt_idx.stg_eltool__state
[0m18:04:57.473522 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_idx.stg_eltool__state"
[0m18:04:57.481962 [debug] [Thread-1 (]: Timing info for model.dbt_idx.stg_eltool__state (compile): 18:04:57.470523 => 18:04:57.480998
[0m18:04:57.482467 [debug] [Thread-1 (]: Began executing node model.dbt_idx.stg_eltool__state
[0m18:04:57.490005 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_idx.stg_eltool__state"
[0m18:04:57.498577 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__state"
[0m18:04:57.499593 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__state: BEGIN
[0m18:04:57.501103 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:04:57.526138 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m18:04:57.527114 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__state"
[0m18:04:57.528117 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__state: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__state"} */

  create view "IDX-Stock"."warehouse"."stg_eltool__state__dbt_tmp"
    
    
  as (
    with source as (select *
                from "IDX-Stock"."warehouse"."state"),
     renamed as (select state_identifier::INT AS state_id,
                         state_code::VARCHAR(2) AS state_code,
                         st_name::VARCHAR(30) AS state_name
                 from source)
select *
from renamed
  );
[0m18:04:57.533115 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m18:04:57.539631 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__state"
[0m18:04:57.540638 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__state: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__state"} */
alter table "IDX-Stock"."warehouse"."stg_eltool__state" rename to "stg_eltool__state__dbt_backup"
[0m18:04:57.543890 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:04:57.548082 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__state"
[0m18:04:57.549042 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__state: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__state"} */
alter table "IDX-Stock"."warehouse"."stg_eltool__state__dbt_tmp" rename to "stg_eltool__state"
[0m18:04:57.552044 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:04:57.555622 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__state: COMMIT
[0m18:04:57.556658 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__state"
[0m18:04:57.556658 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__state: COMMIT
[0m18:04:57.560848 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m18:04:57.565859 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__state"
[0m18:04:57.566851 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__state: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__state"} */
drop view if exists "IDX-Stock"."warehouse"."stg_eltool__state__dbt_backup" cascade
[0m18:04:57.572847 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m18:04:57.574854 [debug] [Thread-1 (]: Timing info for model.dbt_idx.stg_eltool__state (execute): 18:04:57.483480 => 18:04:57.574854
[0m18:04:57.576028 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__state: Close
[0m18:04:57.578988 [info ] [Thread-1 (]: 3 of 6 OK created sql view model warehouse.stg_eltool__state ................... [[32mCREATE VIEW[0m in 0.11s]
[0m18:04:57.581992 [debug] [Thread-1 (]: Finished running node model.dbt_idx.stg_eltool__state
[0m18:04:57.582510 [debug] [Thread-1 (]: Began running node model.dbt_idx.fact_orders
[0m18:04:57.583524 [info ] [Thread-1 (]: 4 of 6 START sql table model warehouse.fact_orders ............................. [RUN]
[0m18:04:57.586048 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_idx.stg_eltool__state, now model.dbt_idx.fact_orders)
[0m18:04:57.587058 [debug] [Thread-1 (]: Began compiling node model.dbt_idx.fact_orders
[0m18:04:57.593068 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_idx.fact_orders"
[0m18:04:57.597585 [debug] [Thread-1 (]: Timing info for model.dbt_idx.fact_orders (compile): 18:04:57.588069 => 18:04:57.597585
[0m18:04:57.598581 [debug] [Thread-1 (]: Began executing node model.dbt_idx.fact_orders
[0m18:04:57.638317 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_idx.fact_orders"
[0m18:04:57.643835 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.fact_orders"
[0m18:04:57.644826 [debug] [Thread-1 (]: On model.dbt_idx.fact_orders: BEGIN
[0m18:04:57.645385 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:04:57.671275 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m18:04:57.672302 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.fact_orders"
[0m18:04:57.673302 [debug] [Thread-1 (]: On model.dbt_idx.fact_orders: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.fact_orders"} */

  
    

  create  table "IDX-Stock"."warehouse"."fact_orders__dbt_tmp"
  
  
    as
  
  (
    with orders as (
    select *
    from "IDX-Stock"."warehouse"."stg_eltool__orders"
)
select * from orders
  );
  
[0m18:04:57.683356 [debug] [Thread-1 (]: SQL status: SELECT 999 in 0.0 seconds
[0m18:04:57.686927 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.fact_orders"
[0m18:04:57.687964 [debug] [Thread-1 (]: On model.dbt_idx.fact_orders: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.fact_orders"} */
alter table "IDX-Stock"."warehouse"."fact_orders__dbt_tmp" rename to "fact_orders"
[0m18:04:57.690927 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:04:57.698555 [debug] [Thread-1 (]: On model.dbt_idx.fact_orders: COMMIT
[0m18:04:57.699522 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.fact_orders"
[0m18:04:57.700523 [debug] [Thread-1 (]: On model.dbt_idx.fact_orders: COMMIT
[0m18:04:57.704672 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m18:04:57.711638 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.fact_orders"
[0m18:04:57.712596 [debug] [Thread-1 (]: On model.dbt_idx.fact_orders: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.fact_orders"} */
drop table if exists "IDX-Stock"."warehouse"."fact_orders__dbt_backup" cascade
[0m18:04:57.715717 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m18:04:57.718713 [debug] [Thread-1 (]: Timing info for model.dbt_idx.fact_orders (execute): 18:04:57.599580 => 18:04:57.717731
[0m18:04:57.718713 [debug] [Thread-1 (]: On model.dbt_idx.fact_orders: Close
[0m18:04:57.721715 [info ] [Thread-1 (]: 4 of 6 OK created sql table model warehouse.fact_orders ........................ [[32mSELECT 999[0m in 0.14s]
[0m18:04:57.723711 [debug] [Thread-1 (]: Finished running node model.dbt_idx.fact_orders
[0m18:04:57.725784 [debug] [Thread-1 (]: Began running node model.dbt_idx.dim_customers
[0m18:04:57.726781 [info ] [Thread-1 (]: 5 of 6 START sql table model warehouse.dim_customers ........................... [RUN]
[0m18:04:57.728787 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_idx.fact_orders, now model.dbt_idx.dim_customers)
[0m18:04:57.729814 [debug] [Thread-1 (]: Began compiling node model.dbt_idx.dim_customers
[0m18:04:57.734782 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_idx.dim_customers"
[0m18:04:57.744532 [debug] [Thread-1 (]: Timing info for model.dbt_idx.dim_customers (compile): 18:04:57.730816 => 18:04:57.744532
[0m18:04:57.746706 [debug] [Thread-1 (]: Began executing node model.dbt_idx.dim_customers
[0m18:04:57.754711 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_idx.dim_customers"
[0m18:04:57.764942 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.dim_customers"
[0m18:04:57.765450 [debug] [Thread-1 (]: On model.dbt_idx.dim_customers: BEGIN
[0m18:04:57.767466 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:04:57.794686 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m18:04:57.795928 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.dim_customers"
[0m18:04:57.796939 [debug] [Thread-1 (]: On model.dbt_idx.dim_customers: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.dim_customers"} */

  
    

  create  table "IDX-Stock"."warehouse"."dim_customers__dbt_tmp"
  
  
    as
  
  (
    -- noinspection SqlDialectInspectionForFile

with customers as (
    select *
    from "IDX-Stock"."warehouse"."stg_eltool__customers"
    ),
     state as (
         select *
         from "IDX-Stock"."warehouse"."stg_eltool__state"
     )
select c.customer_id,
       c.zipcode,
       c.city,
       c.state_code,
       s.state_name,
       c.datetime_created,
       c.datetime_updated,
       c.dbt_valid_from::TIMESTAMP as valid_from,
        CASE WHEN c.dbt_valid_to IS NULL
            THEN '9999-12-31'::TIMESTAMP
            ELSE c.dbt_valid_to::TIMESTAMP
        END as valid_to
from customers c
    join state s on c.state_code = s.state_code
  );
  
[0m18:04:57.804881 [debug] [Thread-1 (]: SQL status: SELECT 105 in 0.0 seconds
[0m18:04:57.808891 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.dim_customers"
[0m18:04:57.809889 [debug] [Thread-1 (]: On model.dbt_idx.dim_customers: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.dim_customers"} */
alter table "IDX-Stock"."warehouse"."dim_customers" rename to "dim_customers__dbt_backup"
[0m18:04:57.812889 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:04:57.817468 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.dim_customers"
[0m18:04:57.817994 [debug] [Thread-1 (]: On model.dbt_idx.dim_customers: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.dim_customers"} */
alter table "IDX-Stock"."warehouse"."dim_customers__dbt_tmp" rename to "dim_customers"
[0m18:04:57.822005 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:04:57.826650 [debug] [Thread-1 (]: On model.dbt_idx.dim_customers: COMMIT
[0m18:04:57.827605 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.dim_customers"
[0m18:04:57.828611 [debug] [Thread-1 (]: On model.dbt_idx.dim_customers: COMMIT
[0m18:04:57.833598 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m18:04:57.838452 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.dim_customers"
[0m18:04:57.839522 [debug] [Thread-1 (]: On model.dbt_idx.dim_customers: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.dim_customers"} */
drop table if exists "IDX-Stock"."warehouse"."dim_customers__dbt_backup" cascade
[0m18:04:57.845993 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m18:04:57.847994 [debug] [Thread-1 (]: Timing info for model.dbt_idx.dim_customers (execute): 18:04:57.746706 => 18:04:57.847994
[0m18:04:57.848995 [debug] [Thread-1 (]: On model.dbt_idx.dim_customers: Close
[0m18:04:57.851996 [info ] [Thread-1 (]: 5 of 6 OK created sql table model warehouse.dim_customers ...................... [[32mSELECT 105[0m in 0.12s]
[0m18:04:57.853000 [debug] [Thread-1 (]: Finished running node model.dbt_idx.dim_customers
[0m18:04:57.856080 [debug] [Thread-1 (]: Began running node model.dbt_idx.customer_orders_status
[0m18:04:57.857105 [info ] [Thread-1 (]: 6 of 6 START sql view model warehouse.customer_orders_status ................... [RUN]
[0m18:04:57.859532 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_idx.dim_customers, now model.dbt_idx.customer_orders_status)
[0m18:04:57.860536 [debug] [Thread-1 (]: Began compiling node model.dbt_idx.customer_orders_status
[0m18:04:57.866061 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_idx.customer_orders_status"
[0m18:04:57.874657 [debug] [Thread-1 (]: Timing info for model.dbt_idx.customer_orders_status (compile): 18:04:57.861541 => 18:04:57.874657
[0m18:04:57.875625 [debug] [Thread-1 (]: Began executing node model.dbt_idx.customer_orders_status
[0m18:04:57.886422 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_idx.customer_orders_status"
[0m18:04:57.896042 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.customer_orders_status"
[0m18:04:57.897228 [debug] [Thread-1 (]: On model.dbt_idx.customer_orders_status: BEGIN
[0m18:04:57.897740 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:04:57.920902 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m18:04:57.921894 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.customer_orders_status"
[0m18:04:57.921894 [debug] [Thread-1 (]: On model.dbt_idx.customer_orders_status: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.customer_orders_status"} */

  create view "IDX-Stock"."warehouse"."customer_orders_status__dbt_tmp"
    
    
  as (
    with orders as (select *
                from "IDX-Stock"."warehouse"."fact_orders"),
     customers as (select *
                   from "IDX-Stock"."warehouse"."dim_customers")
select o.order_id,
       o.customer_id,
       o.order_status,
       o.order_purchase_timestamp,
       o.order_approved_at,
       o.order_delivered_carrier_date,
       o.order_delivered_customer_date,
       o.order_estimated_delivery_date,
       c.zipcode    as customer_zipcode,
       c.city       as customer_city,
       c.state_code as customer_state_code,
       c.state_name as customer_state_name
from orders o
    join customers c on o.customer_id = c.customer_id
    and o.order_purchase_timestamp >= c.valid_from
    and o.order_purchase_timestamp <= c.valid_to
  );
[0m18:04:57.927032 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m18:04:57.931076 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.customer_orders_status"
[0m18:04:57.932032 [debug] [Thread-1 (]: On model.dbt_idx.customer_orders_status: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.customer_orders_status"} */
alter table "IDX-Stock"."warehouse"."customer_orders_status__dbt_tmp" rename to "customer_orders_status"
[0m18:04:57.934579 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:04:57.936622 [debug] [Thread-1 (]: On model.dbt_idx.customer_orders_status: COMMIT
[0m18:04:57.937621 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.customer_orders_status"
[0m18:04:57.938588 [debug] [Thread-1 (]: On model.dbt_idx.customer_orders_status: COMMIT
[0m18:04:57.942585 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m18:04:57.946187 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.customer_orders_status"
[0m18:04:57.947164 [debug] [Thread-1 (]: On model.dbt_idx.customer_orders_status: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.customer_orders_status"} */
drop view if exists "IDX-Stock"."warehouse"."customer_orders_status__dbt_backup" cascade
[0m18:04:57.949160 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m18:04:57.951209 [debug] [Thread-1 (]: Timing info for model.dbt_idx.customer_orders_status (execute): 18:04:57.877589 => 18:04:57.951209
[0m18:04:57.952194 [debug] [Thread-1 (]: On model.dbt_idx.customer_orders_status: Close
[0m18:04:57.953172 [info ] [Thread-1 (]: 6 of 6 OK created sql view model warehouse.customer_orders_status .............. [[32mCREATE VIEW[0m in 0.09s]
[0m18:04:57.955687 [debug] [Thread-1 (]: Finished running node model.dbt_idx.customer_orders_status
[0m18:04:57.958353 [debug] [MainThread]: Using postgres connection "master"
[0m18:04:57.959349 [debug] [MainThread]: On master: BEGIN
[0m18:04:57.960348 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:04:57.983431 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m18:04:57.985087 [debug] [MainThread]: On master: COMMIT
[0m18:04:57.985966 [debug] [MainThread]: Using postgres connection "master"
[0m18:04:57.987014 [debug] [MainThread]: On master: COMMIT
[0m18:04:57.988984 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m18:04:57.990000 [debug] [MainThread]: On master: Close
[0m18:04:57.991968 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:04:57.993001 [debug] [MainThread]: Connection 'list_IDX-Stock' was properly closed.
[0m18:04:57.994554 [debug] [MainThread]: Connection 'list_IDX-Stock_snapshots' was properly closed.
[0m18:04:57.995585 [debug] [MainThread]: Connection 'model.dbt_idx.customer_orders_status' was properly closed.
[0m18:04:57.996583 [info ] [MainThread]: 
[0m18:04:57.997563 [info ] [MainThread]: Finished running 4 view models, 2 table models in 0 hours 0 minutes and 1.11 seconds (1.11s).
[0m18:04:58.000596 [debug] [MainThread]: Command end result
[0m18:04:58.029106 [info ] [MainThread]: 
[0m18:04:58.030133 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:04:58.031140 [info ] [MainThread]: 
[0m18:04:58.032106 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 TOTAL=6
[0m18:04:58.034610 [debug] [MainThread]: Command `dbt run` succeeded at 18:04:58.034610 after 1.77 seconds
[0m18:04:58.035620 [debug] [MainThread]: Flushing usage events


============================== 18:10:58.042689 | de7b4f15-2ae7-4644-8e43-75ec25156bf6 ==============================
[0m18:10:58.042689 [info ] [MainThread]: Running with dbt=1.6.1
[0m18:10:58.049132 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'D:\\00 Project\\00 My Project\\IdeaProjects\\Py-DBT-IDX\\logs', 'version_check': 'True', 'profiles_dir': 'D:\\00 Project\\00 My Project\\IdeaProjects\\Py-DBT-IDX', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'False'}
[0m18:10:58.176565 [info ] [MainThread]: Registered adapter: postgres=1.6.1
[0m18:10:58.188656 [debug] [MainThread]: checksum: efe19d9f5b93d1a98cc804fbfcdb6b3aced98b974af664946fee1cde8837deb7, vars: {}, profile: , target: , version: 1.6.1
[0m18:10:58.341373 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 3 files changed.
[0m18:10:58.342398 [debug] [MainThread]: Partial parsing: added file: dbt_idx://models\staging\stg_eltool__customers_snapshots.sql
[0m18:10:58.343400 [debug] [MainThread]: Partial parsing: updated file: dbt_idx://models\staging\stg_eltool.yml
[0m18:10:58.344646 [debug] [MainThread]: Partial parsing: updated file: dbt_idx://models\marts\core\dim_customers.sql
[0m18:10:58.345629 [debug] [MainThread]: Partial parsing: updated file: dbt_idx://models\staging\stg_eltool__customers.sql
[0m18:10:58.460698 [info ] [MainThread]: Found 1 snapshot, 9 tests, 7 models, 3 sources, 0 exposures, 0 metrics, 349 macros, 0 groups, 0 semantic models
[0m18:10:58.463348 [info ] [MainThread]: 
[0m18:10:58.464802 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m18:10:58.467795 [debug] [ThreadPool]: Acquiring new postgres connection 'list_IDX-Stock'
[0m18:10:58.478342 [debug] [ThreadPool]: Using postgres connection "list_IDX-Stock"
[0m18:10:58.478342 [debug] [ThreadPool]: On list_IDX-Stock: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "connection_name": "list_IDX-Stock"} */

    select distinct nspname from pg_namespace
  
[0m18:10:58.479381 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:10:58.512233 [debug] [ThreadPool]: SQL status: SELECT 13 in 0.0 seconds
[0m18:10:58.513868 [debug] [ThreadPool]: On list_IDX-Stock: Close
[0m18:10:58.517756 [debug] [ThreadPool]: Acquiring new postgres connection 'list_IDX-Stock_warehouse'
[0m18:10:58.525372 [debug] [ThreadPool]: Using postgres connection "list_IDX-Stock_warehouse"
[0m18:10:58.525372 [debug] [ThreadPool]: On list_IDX-Stock_warehouse: BEGIN
[0m18:10:58.526376 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:10:58.549109 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m18:10:58.550093 [debug] [ThreadPool]: Using postgres connection "list_IDX-Stock_warehouse"
[0m18:10:58.551059 [debug] [ThreadPool]: On list_IDX-Stock_warehouse: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "connection_name": "list_IDX-Stock_warehouse"} */
select
      'IDX-Stock' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'warehouse'
    union all
    select
      'IDX-Stock' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'warehouse'
    union all
    select
      'IDX-Stock' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'warehouse'
  
[0m18:10:58.555652 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.0 seconds
[0m18:10:58.557630 [debug] [ThreadPool]: On list_IDX-Stock_warehouse: ROLLBACK
[0m18:10:58.559634 [debug] [ThreadPool]: On list_IDX-Stock_warehouse: Close
[0m18:10:58.562657 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_IDX-Stock_warehouse, now list_IDX-Stock_snapshots)
[0m18:10:58.568169 [debug] [ThreadPool]: Using postgres connection "list_IDX-Stock_snapshots"
[0m18:10:58.569174 [debug] [ThreadPool]: On list_IDX-Stock_snapshots: BEGIN
[0m18:10:58.570180 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:10:58.590883 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m18:10:58.591881 [debug] [ThreadPool]: Using postgres connection "list_IDX-Stock_snapshots"
[0m18:10:58.591881 [debug] [ThreadPool]: On list_IDX-Stock_snapshots: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "connection_name": "list_IDX-Stock_snapshots"} */
select
      'IDX-Stock' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'snapshots'
    union all
    select
      'IDX-Stock' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'snapshots'
    union all
    select
      'IDX-Stock' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'snapshots'
  
[0m18:10:58.596434 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.0 seconds
[0m18:10:58.598401 [debug] [ThreadPool]: On list_IDX-Stock_snapshots: ROLLBACK
[0m18:10:58.601159 [debug] [ThreadPool]: On list_IDX-Stock_snapshots: Close
[0m18:10:58.607692 [debug] [MainThread]: Using postgres connection "master"
[0m18:10:58.608692 [debug] [MainThread]: On master: BEGIN
[0m18:10:58.609693 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:10:58.630485 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m18:10:58.631473 [debug] [MainThread]: Using postgres connection "master"
[0m18:10:58.631473 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m18:10:58.638515 [debug] [MainThread]: SQL status: SELECT 5 in 0.0 seconds
[0m18:10:58.641569 [debug] [MainThread]: On master: ROLLBACK
[0m18:10:58.643519 [debug] [MainThread]: Using postgres connection "master"
[0m18:10:58.644871 [debug] [MainThread]: On master: BEGIN
[0m18:10:58.649822 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m18:10:58.649822 [debug] [MainThread]: On master: COMMIT
[0m18:10:58.650817 [debug] [MainThread]: Using postgres connection "master"
[0m18:10:58.651837 [debug] [MainThread]: On master: COMMIT
[0m18:10:58.654354 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m18:10:58.655395 [debug] [MainThread]: On master: Close
[0m18:10:58.656352 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:10:58.658370 [info ] [MainThread]: 
[0m18:10:58.663353 [debug] [Thread-1 (]: Began running node model.dbt_idx.stg_eltool__customers
[0m18:10:58.663893 [info ] [Thread-1 (]: 1 of 7 START sql view model warehouse.stg_eltool__customers .................... [RUN]
[0m18:10:58.664921 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.dbt_idx.stg_eltool__customers'
[0m18:10:58.665927 [debug] [Thread-1 (]: Began compiling node model.dbt_idx.stg_eltool__customers
[0m18:10:58.674487 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_idx.stg_eltool__customers"
[0m18:10:58.687632 [debug] [Thread-1 (]: Timing info for model.dbt_idx.stg_eltool__customers (compile): 18:10:58.666899 => 18:10:58.687632
[0m18:10:58.688631 [debug] [Thread-1 (]: Began executing node model.dbt_idx.stg_eltool__customers
[0m18:10:58.727002 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_idx.stg_eltool__customers"
[0m18:10:58.733581 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__customers"
[0m18:10:58.733581 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__customers: BEGIN
[0m18:10:58.734524 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m18:10:58.756699 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m18:10:58.757723 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__customers"
[0m18:10:58.758717 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__customers: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__customers"} */

  create view "IDX-Stock"."warehouse"."stg_eltool__customers__dbt_tmp"
    
    
  as (
    with source as (select *
                from "IDX-Stock"."warehouse"."customers"),
     renamed as (select customer_id,
                        'This is Dummy' as dummy
                 from source)
select *
from renamed
  );
[0m18:10:58.763706 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m18:10:58.770033 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__customers"
[0m18:10:58.771032 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__customers: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__customers"} */
alter table "IDX-Stock"."warehouse"."stg_eltool__customers" rename to "stg_eltool__customers__dbt_backup"
[0m18:10:58.773672 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:10:58.777724 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__customers"
[0m18:10:58.777724 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__customers: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__customers"} */
alter table "IDX-Stock"."warehouse"."stg_eltool__customers__dbt_tmp" rename to "stg_eltool__customers"
[0m18:10:58.780688 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:10:58.797728 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__customers: COMMIT
[0m18:10:58.798729 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__customers"
[0m18:10:58.798729 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__customers: COMMIT
[0m18:10:58.802403 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m18:10:58.810915 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__customers"
[0m18:10:58.811915 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__customers: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__customers"} */
drop view if exists "IDX-Stock"."warehouse"."stg_eltool__customers__dbt_backup" cascade
[0m18:10:58.817447 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m18:10:58.819484 [debug] [Thread-1 (]: Timing info for model.dbt_idx.stg_eltool__customers (execute): 18:10:58.689631 => 18:10:58.818482
[0m18:10:58.820457 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__customers: Close
[0m18:10:58.822451 [info ] [Thread-1 (]: 1 of 7 OK created sql view model warehouse.stg_eltool__customers ............... [[32mCREATE VIEW[0m in 0.16s]
[0m18:10:58.824000 [debug] [Thread-1 (]: Finished running node model.dbt_idx.stg_eltool__customers
[0m18:10:58.825014 [debug] [Thread-1 (]: Began running node model.dbt_idx.stg_eltool__customers_snapshots
[0m18:10:58.826011 [info ] [Thread-1 (]: 2 of 7 START sql view model warehouse.stg_eltool__customers_snapshots .......... [RUN]
[0m18:10:58.828012 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_idx.stg_eltool__customers, now model.dbt_idx.stg_eltool__customers_snapshots)
[0m18:10:58.829010 [debug] [Thread-1 (]: Began compiling node model.dbt_idx.stg_eltool__customers_snapshots
[0m18:10:58.832011 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_idx.stg_eltool__customers_snapshots"
[0m18:10:58.837537 [debug] [Thread-1 (]: Timing info for model.dbt_idx.stg_eltool__customers_snapshots (compile): 18:10:58.830011 => 18:10:58.836535
[0m18:10:58.838536 [debug] [Thread-1 (]: Began executing node model.dbt_idx.stg_eltool__customers_snapshots
[0m18:10:58.846685 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_idx.stg_eltool__customers_snapshots"
[0m18:10:58.853680 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__customers_snapshots"
[0m18:10:58.854749 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__customers_snapshots: BEGIN
[0m18:10:58.855743 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:10:58.878131 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m18:10:58.879126 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__customers_snapshots"
[0m18:10:58.880127 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__customers_snapshots: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__customers_snapshots"} */

  create view "IDX-Stock"."warehouse"."stg_eltool__customers_snapshots__dbt_tmp"
    
    
  as (
    with source as (select *
                from "IDX-Stock"."snapshots"."customers_snapshot"),
     renamed as (select customer_id,
                        zipcode,
                        city,
                        state_code,
                        datetime_created::TIMESTAMP AS datetime_created,
                        datetime_updated::TIMESTAMP AS datetime_updated,
                        dbt_valid_from,
                        dbt_valid_to
                 from source)
select *
from renamed
  );
[0m18:10:58.883822 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m18:10:58.887729 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__customers_snapshots"
[0m18:10:58.888729 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__customers_snapshots: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__customers_snapshots"} */
alter table "IDX-Stock"."warehouse"."stg_eltool__customers_snapshots__dbt_tmp" rename to "stg_eltool__customers_snapshots"
[0m18:10:58.891730 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:10:58.894301 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__customers_snapshots: COMMIT
[0m18:10:58.895308 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__customers_snapshots"
[0m18:10:58.895308 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__customers_snapshots: COMMIT
[0m18:10:58.899196 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m18:10:58.902223 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__customers_snapshots"
[0m18:10:58.902223 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__customers_snapshots: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__customers_snapshots"} */
drop view if exists "IDX-Stock"."warehouse"."stg_eltool__customers_snapshots__dbt_backup" cascade
[0m18:10:58.905771 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m18:10:58.907808 [debug] [Thread-1 (]: Timing info for model.dbt_idx.stg_eltool__customers_snapshots (execute): 18:10:58.838536 => 18:10:58.906807
[0m18:10:58.907808 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__customers_snapshots: Close
[0m18:10:58.909785 [info ] [Thread-1 (]: 2 of 7 OK created sql view model warehouse.stg_eltool__customers_snapshots ..... [[32mCREATE VIEW[0m in 0.08s]
[0m18:10:58.911805 [debug] [Thread-1 (]: Finished running node model.dbt_idx.stg_eltool__customers_snapshots
[0m18:10:58.913313 [debug] [Thread-1 (]: Began running node model.dbt_idx.stg_eltool__orders
[0m18:10:58.914349 [info ] [Thread-1 (]: 3 of 7 START sql view model warehouse.stg_eltool__orders ....................... [RUN]
[0m18:10:58.915321 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_idx.stg_eltool__customers_snapshots, now model.dbt_idx.stg_eltool__orders)
[0m18:10:58.916321 [debug] [Thread-1 (]: Began compiling node model.dbt_idx.stg_eltool__orders
[0m18:10:58.920321 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_idx.stg_eltool__orders"
[0m18:10:58.933445 [debug] [Thread-1 (]: Timing info for model.dbt_idx.stg_eltool__orders (compile): 18:10:58.917321 => 18:10:58.932442
[0m18:10:58.933988 [debug] [Thread-1 (]: Began executing node model.dbt_idx.stg_eltool__orders
[0m18:10:58.940029 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_idx.stg_eltool__orders"
[0m18:10:58.951005 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__orders"
[0m18:10:58.952016 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__orders: BEGIN
[0m18:10:58.952016 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:10:58.972036 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m18:10:58.973613 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__orders"
[0m18:10:58.974558 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__orders: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__orders"} */

  create view "IDX-Stock"."warehouse"."stg_eltool__orders__dbt_tmp"
    
    
  as (
    with source as (select *
                from "IDX-Stock"."warehouse"."orders"),
     renamed as (select order_id,
                        cust_id AS customer_id,
                        order_status,
                        order_purchase_timestamp::TIMESTAMP,
                        order_approved_at::TIMESTAMP,
                        order_delivered_carrier_date::TIMESTAMP,
                        order_delivered_customer_date::TIMESTAMP,
                        order_estimated_delivery_date::TIMESTAMP
                 from source)
select *
from renamed
  );
[0m18:10:58.978564 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m18:10:58.981564 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__orders"
[0m18:10:58.982570 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__orders: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__orders"} */
alter table "IDX-Stock"."warehouse"."stg_eltool__orders" rename to "stg_eltool__orders__dbt_backup"
[0m18:10:58.984820 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:10:58.988853 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__orders"
[0m18:10:58.989880 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__orders: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__orders"} */
alter table "IDX-Stock"."warehouse"."stg_eltool__orders__dbt_tmp" rename to "stg_eltool__orders"
[0m18:10:58.991851 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:10:58.994954 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__orders: COMMIT
[0m18:10:58.995981 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__orders"
[0m18:10:58.996960 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__orders: COMMIT
[0m18:10:59.000971 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m18:10:59.004553 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__orders"
[0m18:10:59.005518 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__orders: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__orders"} */
drop view if exists "IDX-Stock"."warehouse"."stg_eltool__orders__dbt_backup" cascade
[0m18:10:59.009516 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m18:10:59.011518 [debug] [Thread-1 (]: Timing info for model.dbt_idx.stg_eltool__orders (execute): 18:10:58.935030 => 18:10:59.010518
[0m18:10:59.011518 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__orders: Close
[0m18:10:59.014027 [info ] [Thread-1 (]: 3 of 7 OK created sql view model warehouse.stg_eltool__orders .................. [[32mCREATE VIEW[0m in 0.10s]
[0m18:10:59.016051 [debug] [Thread-1 (]: Finished running node model.dbt_idx.stg_eltool__orders
[0m18:10:59.017040 [debug] [Thread-1 (]: Began running node model.dbt_idx.stg_eltool__state
[0m18:10:59.018041 [info ] [Thread-1 (]: 4 of 7 START sql view model warehouse.stg_eltool__state ........................ [RUN]
[0m18:10:59.019032 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_idx.stg_eltool__orders, now model.dbt_idx.stg_eltool__state)
[0m18:10:59.020035 [debug] [Thread-1 (]: Began compiling node model.dbt_idx.stg_eltool__state
[0m18:10:59.024547 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_idx.stg_eltool__state"
[0m18:10:59.032553 [debug] [Thread-1 (]: Timing info for model.dbt_idx.stg_eltool__state (compile): 18:10:59.021038 => 18:10:59.031591
[0m18:10:59.032553 [debug] [Thread-1 (]: Began executing node model.dbt_idx.stg_eltool__state
[0m18:10:59.039096 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_idx.stg_eltool__state"
[0m18:10:59.045982 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__state"
[0m18:10:59.045982 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__state: BEGIN
[0m18:10:59.046981 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:10:59.071055 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m18:10:59.072054 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__state"
[0m18:10:59.072054 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__state: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__state"} */

  create view "IDX-Stock"."warehouse"."stg_eltool__state__dbt_tmp"
    
    
  as (
    with source as (select *
                from "IDX-Stock"."warehouse"."state"),
     renamed as (select state_identifier::INT AS state_id,
                         state_code::VARCHAR(2) AS state_code,
                         st_name::VARCHAR(30) AS state_name
                 from source)
select *
from renamed
  );
[0m18:10:59.076588 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m18:10:59.081588 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__state"
[0m18:10:59.082599 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__state: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__state"} */
alter table "IDX-Stock"."warehouse"."stg_eltool__state" rename to "stg_eltool__state__dbt_backup"
[0m18:10:59.084888 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:10:59.090880 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__state"
[0m18:10:59.091881 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__state: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__state"} */
alter table "IDX-Stock"."warehouse"."stg_eltool__state__dbt_tmp" rename to "stg_eltool__state"
[0m18:10:59.095014 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:10:59.097013 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__state: COMMIT
[0m18:10:59.098015 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__state"
[0m18:10:59.099014 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__state: COMMIT
[0m18:10:59.101874 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m18:10:59.105423 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__state"
[0m18:10:59.106408 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__state: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__state"} */
drop view if exists "IDX-Stock"."warehouse"."stg_eltool__state__dbt_backup" cascade
[0m18:10:59.110270 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m18:10:59.112308 [debug] [Thread-1 (]: Timing info for model.dbt_idx.stg_eltool__state (execute): 18:10:59.034059 => 18:10:59.112308
[0m18:10:59.113274 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__state: Close
[0m18:10:59.115401 [info ] [Thread-1 (]: 4 of 7 OK created sql view model warehouse.stg_eltool__state ................... [[32mCREATE VIEW[0m in 0.10s]
[0m18:10:59.117404 [debug] [Thread-1 (]: Finished running node model.dbt_idx.stg_eltool__state
[0m18:10:59.119398 [debug] [Thread-1 (]: Began running node model.dbt_idx.fact_orders
[0m18:10:59.120398 [info ] [Thread-1 (]: 5 of 7 START sql table model warehouse.fact_orders ............................. [RUN]
[0m18:10:59.121402 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_idx.stg_eltool__state, now model.dbt_idx.fact_orders)
[0m18:10:59.122399 [debug] [Thread-1 (]: Began compiling node model.dbt_idx.fact_orders
[0m18:10:59.125921 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_idx.fact_orders"
[0m18:10:59.131922 [debug] [Thread-1 (]: Timing info for model.dbt_idx.fact_orders (compile): 18:10:59.123403 => 18:10:59.131922
[0m18:10:59.133517 [debug] [Thread-1 (]: Began executing node model.dbt_idx.fact_orders
[0m18:10:59.162005 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_idx.fact_orders"
[0m18:10:59.169546 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.fact_orders"
[0m18:10:59.170526 [debug] [Thread-1 (]: On model.dbt_idx.fact_orders: BEGIN
[0m18:10:59.171525 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:10:59.195091 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m18:10:59.195091 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.fact_orders"
[0m18:10:59.196126 [debug] [Thread-1 (]: On model.dbt_idx.fact_orders: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.fact_orders"} */

  
    

  create  table "IDX-Stock"."warehouse"."fact_orders__dbt_tmp"
  
  
    as
  
  (
    with orders as (
    select *
    from "IDX-Stock"."warehouse"."stg_eltool__orders"
)
select * from orders
  );
  
[0m18:10:59.203610 [debug] [Thread-1 (]: SQL status: SELECT 999 in 0.0 seconds
[0m18:10:59.207649 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.fact_orders"
[0m18:10:59.208656 [debug] [Thread-1 (]: On model.dbt_idx.fact_orders: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.fact_orders"} */
alter table "IDX-Stock"."warehouse"."fact_orders" rename to "fact_orders__dbt_backup"
[0m18:10:59.211620 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:10:59.215201 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.fact_orders"
[0m18:10:59.216166 [debug] [Thread-1 (]: On model.dbt_idx.fact_orders: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.fact_orders"} */
alter table "IDX-Stock"."warehouse"."fact_orders__dbt_tmp" rename to "fact_orders"
[0m18:10:59.218181 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:10:59.223822 [debug] [Thread-1 (]: On model.dbt_idx.fact_orders: COMMIT
[0m18:10:59.224783 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.fact_orders"
[0m18:10:59.225750 [debug] [Thread-1 (]: On model.dbt_idx.fact_orders: COMMIT
[0m18:10:59.230155 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m18:10:59.235749 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.fact_orders"
[0m18:10:59.235749 [debug] [Thread-1 (]: On model.dbt_idx.fact_orders: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.fact_orders"} */
drop table if exists "IDX-Stock"."warehouse"."fact_orders__dbt_backup" cascade
[0m18:10:59.240745 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m18:10:59.243304 [debug] [Thread-1 (]: Timing info for model.dbt_idx.fact_orders (execute): 18:10:59.134438 => 18:10:59.243304
[0m18:10:59.243304 [debug] [Thread-1 (]: On model.dbt_idx.fact_orders: Close
[0m18:10:59.245335 [info ] [Thread-1 (]: 5 of 7 OK created sql table model warehouse.fact_orders ........................ [[32mSELECT 999[0m in 0.12s]
[0m18:10:59.248314 [debug] [Thread-1 (]: Finished running node model.dbt_idx.fact_orders
[0m18:10:59.249311 [debug] [Thread-1 (]: Began running node model.dbt_idx.dim_customers
[0m18:10:59.250311 [info ] [Thread-1 (]: 6 of 7 START sql table model warehouse.dim_customers ........................... [RUN]
[0m18:10:59.251313 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_idx.fact_orders, now model.dbt_idx.dim_customers)
[0m18:10:59.252313 [debug] [Thread-1 (]: Began compiling node model.dbt_idx.dim_customers
[0m18:10:59.255914 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_idx.dim_customers"
[0m18:10:59.261325 [debug] [Thread-1 (]: Timing info for model.dbt_idx.dim_customers (compile): 18:10:59.253327 => 18:10:59.261325
[0m18:10:59.262329 [debug] [Thread-1 (]: Began executing node model.dbt_idx.dim_customers
[0m18:10:59.268852 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_idx.dim_customers"
[0m18:10:59.275491 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.dim_customers"
[0m18:10:59.276484 [debug] [Thread-1 (]: On model.dbt_idx.dim_customers: BEGIN
[0m18:10:59.277491 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:10:59.301714 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m18:10:59.302714 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.dim_customers"
[0m18:10:59.303725 [debug] [Thread-1 (]: On model.dbt_idx.dim_customers: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.dim_customers"} */

  
    

  create  table "IDX-Stock"."warehouse"."dim_customers__dbt_tmp"
  
  
    as
  
  (
    -- noinspection SqlDialectInspectionForFile

with customers as (
    select *
    from "IDX-Stock"."warehouse"."stg_eltool__customers_snapshots"
    ),
     state as (
         select *
         from "IDX-Stock"."warehouse"."stg_eltool__state"
     )
select c.customer_id,
       c.zipcode,
       c.city,
       c.state_code,
       s.state_name,
       c.datetime_created,
       c.datetime_updated,
       c.dbt_valid_from::TIMESTAMP as valid_from,
        CASE WHEN c.dbt_valid_to IS NULL
            THEN '9999-12-31'::TIMESTAMP
            ELSE c.dbt_valid_to::TIMESTAMP
        END as valid_to
from customers c
    join state s on c.state_code = s.state_code
  );
  
[0m18:10:59.309079 [debug] [Thread-1 (]: SQL status: SELECT 105 in 0.0 seconds
[0m18:10:59.313599 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.dim_customers"
[0m18:10:59.314615 [debug] [Thread-1 (]: On model.dbt_idx.dim_customers: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.dim_customers"} */
alter table "IDX-Stock"."warehouse"."dim_customers" rename to "dim_customers__dbt_backup"
[0m18:10:59.317622 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:10:59.323645 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.dim_customers"
[0m18:10:59.324188 [debug] [Thread-1 (]: On model.dbt_idx.dim_customers: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.dim_customers"} */
alter table "IDX-Stock"."warehouse"."dim_customers__dbt_tmp" rename to "dim_customers"
[0m18:10:59.327196 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:10:59.329195 [debug] [Thread-1 (]: On model.dbt_idx.dim_customers: COMMIT
[0m18:10:59.330230 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.dim_customers"
[0m18:10:59.331231 [debug] [Thread-1 (]: On model.dbt_idx.dim_customers: COMMIT
[0m18:10:59.334734 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m18:10:59.339747 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.dim_customers"
[0m18:10:59.339747 [debug] [Thread-1 (]: On model.dbt_idx.dim_customers: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.dim_customers"} */
drop table if exists "IDX-Stock"."warehouse"."dim_customers__dbt_backup" cascade
[0m18:10:59.344870 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m18:10:59.347872 [debug] [Thread-1 (]: Timing info for model.dbt_idx.dim_customers (execute): 18:10:59.263329 => 18:10:59.346888
[0m18:10:59.348874 [debug] [Thread-1 (]: On model.dbt_idx.dim_customers: Close
[0m18:10:59.351873 [info ] [Thread-1 (]: 6 of 7 OK created sql table model warehouse.dim_customers ...................... [[32mSELECT 105[0m in 0.10s]
[0m18:10:59.355408 [debug] [Thread-1 (]: Finished running node model.dbt_idx.dim_customers
[0m18:10:59.357402 [debug] [Thread-1 (]: Began running node model.dbt_idx.customer_orders_status
[0m18:10:59.359399 [info ] [Thread-1 (]: 7 of 7 START sql view model warehouse.customer_orders_status ................... [RUN]
[0m18:10:59.360416 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_idx.dim_customers, now model.dbt_idx.customer_orders_status)
[0m18:10:59.361464 [debug] [Thread-1 (]: Began compiling node model.dbt_idx.customer_orders_status
[0m18:10:59.364986 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_idx.customer_orders_status"
[0m18:10:59.371999 [debug] [Thread-1 (]: Timing info for model.dbt_idx.customer_orders_status (compile): 18:10:59.361464 => 18:10:59.371999
[0m18:10:59.374551 [debug] [Thread-1 (]: Began executing node model.dbt_idx.customer_orders_status
[0m18:10:59.384647 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_idx.customer_orders_status"
[0m18:10:59.393588 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.customer_orders_status"
[0m18:10:59.394213 [debug] [Thread-1 (]: On model.dbt_idx.customer_orders_status: BEGIN
[0m18:10:59.395205 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:10:59.416948 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m18:10:59.417949 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.customer_orders_status"
[0m18:10:59.418949 [debug] [Thread-1 (]: On model.dbt_idx.customer_orders_status: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.customer_orders_status"} */

  create view "IDX-Stock"."warehouse"."customer_orders_status__dbt_tmp"
    
    
  as (
    with orders as (select *
                from "IDX-Stock"."warehouse"."fact_orders"),
     customers as (select *
                   from "IDX-Stock"."warehouse"."dim_customers")
select o.order_id,
       o.customer_id,
       o.order_status,
       o.order_purchase_timestamp,
       o.order_approved_at,
       o.order_delivered_carrier_date,
       o.order_delivered_customer_date,
       o.order_estimated_delivery_date,
       c.zipcode    as customer_zipcode,
       c.city       as customer_city,
       c.state_code as customer_state_code,
       c.state_name as customer_state_name
from orders o
    join customers c on o.customer_id = c.customer_id
    and o.order_purchase_timestamp >= c.valid_from
    and o.order_purchase_timestamp <= c.valid_to
  );
[0m18:10:59.421983 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m18:10:59.426570 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.customer_orders_status"
[0m18:10:59.426570 [debug] [Thread-1 (]: On model.dbt_idx.customer_orders_status: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.customer_orders_status"} */
alter table "IDX-Stock"."warehouse"."customer_orders_status__dbt_tmp" rename to "customer_orders_status"
[0m18:10:59.429324 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:10:59.431362 [debug] [Thread-1 (]: On model.dbt_idx.customer_orders_status: COMMIT
[0m18:10:59.432360 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.customer_orders_status"
[0m18:10:59.433344 [debug] [Thread-1 (]: On model.dbt_idx.customer_orders_status: COMMIT
[0m18:10:59.437531 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m18:10:59.440569 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.customer_orders_status"
[0m18:10:59.441532 [debug] [Thread-1 (]: On model.dbt_idx.customer_orders_status: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.customer_orders_status"} */
drop view if exists "IDX-Stock"."warehouse"."customer_orders_status__dbt_backup" cascade
[0m18:10:59.443534 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m18:10:59.445653 [debug] [Thread-1 (]: Timing info for model.dbt_idx.customer_orders_status (execute): 18:10:59.376551 => 18:10:59.445653
[0m18:10:59.446625 [debug] [Thread-1 (]: On model.dbt_idx.customer_orders_status: Close
[0m18:10:59.448631 [info ] [Thread-1 (]: 7 of 7 OK created sql view model warehouse.customer_orders_status .............. [[32mCREATE VIEW[0m in 0.09s]
[0m18:10:59.450627 [debug] [Thread-1 (]: Finished running node model.dbt_idx.customer_orders_status
[0m18:10:59.453626 [debug] [MainThread]: Using postgres connection "master"
[0m18:10:59.454131 [debug] [MainThread]: On master: BEGIN
[0m18:10:59.455137 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:10:59.477550 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m18:10:59.478550 [debug] [MainThread]: On master: COMMIT
[0m18:10:59.478550 [debug] [MainThread]: Using postgres connection "master"
[0m18:10:59.479572 [debug] [MainThread]: On master: COMMIT
[0m18:10:59.483505 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m18:10:59.485244 [debug] [MainThread]: On master: Close
[0m18:10:59.488614 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:10:59.490365 [debug] [MainThread]: Connection 'list_IDX-Stock' was properly closed.
[0m18:10:59.492000 [debug] [MainThread]: Connection 'list_IDX-Stock_snapshots' was properly closed.
[0m18:10:59.493642 [debug] [MainThread]: Connection 'model.dbt_idx.customer_orders_status' was properly closed.
[0m18:10:59.495837 [info ] [MainThread]: 
[0m18:10:59.497476 [info ] [MainThread]: Finished running 5 view models, 2 table models in 0 hours 0 minutes and 1.03 seconds (1.03s).
[0m18:10:59.502877 [debug] [MainThread]: Command end result
[0m18:10:59.526763 [info ] [MainThread]: 
[0m18:10:59.527764 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:10:59.528766 [info ] [MainThread]: 
[0m18:10:59.529769 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=0 SKIP=0 TOTAL=7
[0m18:10:59.530782 [debug] [MainThread]: Command `dbt run` succeeded at 18:10:59.530782 after 1.54 seconds
[0m18:10:59.531791 [debug] [MainThread]: Flushing usage events


============================== 18:25:57.102489 | 81a52cd4-841a-4d80-8315-7516142a97ea ==============================
[0m18:25:57.102489 [info ] [MainThread]: Running with dbt=1.6.1
[0m18:25:57.108488 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': 'D:\\00 Project\\00 My Project\\IdeaProjects\\Py-DBT-IDX\\logs', 'profiles_dir': 'D:\\00 Project\\00 My Project\\IdeaProjects\\Py-DBT-IDX', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt test', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'False'}
[0m18:25:57.285414 [info ] [MainThread]: Registered adapter: postgres=1.6.1
[0m18:25:57.301513 [debug] [MainThread]: checksum: efe19d9f5b93d1a98cc804fbfcdb6b3aced98b974af664946fee1cde8837deb7, vars: {}, profile: , target: , version: 1.6.1
[0m18:25:57.524443 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m18:25:57.525470 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m18:25:57.583893 [info ] [MainThread]: Found 1 snapshot, 9 tests, 7 models, 3 sources, 0 exposures, 0 metrics, 349 macros, 0 groups, 0 semantic models
[0m18:25:57.587546 [info ] [MainThread]: 
[0m18:25:57.588547 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m18:25:57.593099 [debug] [ThreadPool]: Acquiring new postgres connection 'list_IDX-Stock_warehouse'
[0m18:25:57.611474 [debug] [ThreadPool]: Using postgres connection "list_IDX-Stock_warehouse"
[0m18:25:57.612604 [debug] [ThreadPool]: On list_IDX-Stock_warehouse: BEGIN
[0m18:25:57.612604 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:25:57.651896 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m18:25:57.652817 [debug] [ThreadPool]: Using postgres connection "list_IDX-Stock_warehouse"
[0m18:25:57.653764 [debug] [ThreadPool]: On list_IDX-Stock_warehouse: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "connection_name": "list_IDX-Stock_warehouse"} */
select
      'IDX-Stock' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'warehouse'
    union all
    select
      'IDX-Stock' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'warehouse'
    union all
    select
      'IDX-Stock' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'warehouse'
  
[0m18:25:57.660762 [debug] [ThreadPool]: SQL status: SELECT 11 in 0.0 seconds
[0m18:25:57.664063 [debug] [ThreadPool]: On list_IDX-Stock_warehouse: ROLLBACK
[0m18:25:57.667054 [debug] [ThreadPool]: On list_IDX-Stock_warehouse: Close
[0m18:25:57.669587 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_IDX-Stock_warehouse, now list_IDX-Stock_snapshots)
[0m18:25:57.677889 [debug] [ThreadPool]: Using postgres connection "list_IDX-Stock_snapshots"
[0m18:25:57.678924 [debug] [ThreadPool]: On list_IDX-Stock_snapshots: BEGIN
[0m18:25:57.680448 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:25:57.706216 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m18:25:57.707217 [debug] [ThreadPool]: Using postgres connection "list_IDX-Stock_snapshots"
[0m18:25:57.708216 [debug] [ThreadPool]: On list_IDX-Stock_snapshots: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "connection_name": "list_IDX-Stock_snapshots"} */
select
      'IDX-Stock' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'snapshots'
    union all
    select
      'IDX-Stock' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'snapshots'
    union all
    select
      'IDX-Stock' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'snapshots'
  
[0m18:25:57.712764 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.0 seconds
[0m18:25:57.714784 [debug] [ThreadPool]: On list_IDX-Stock_snapshots: ROLLBACK
[0m18:25:57.716771 [debug] [ThreadPool]: On list_IDX-Stock_snapshots: Close
[0m18:25:57.724632 [debug] [MainThread]: Using postgres connection "master"
[0m18:25:57.725621 [debug] [MainThread]: On master: BEGIN
[0m18:25:57.726601 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:25:57.752640 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m18:25:57.753639 [debug] [MainThread]: Using postgres connection "master"
[0m18:25:57.754639 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m18:25:57.761785 [debug] [MainThread]: SQL status: SELECT 6 in 0.0 seconds
[0m18:25:57.766356 [debug] [MainThread]: On master: ROLLBACK
[0m18:25:57.768358 [debug] [MainThread]: Using postgres connection "master"
[0m18:25:57.769320 [debug] [MainThread]: On master: BEGIN
[0m18:25:57.774581 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m18:25:57.775582 [debug] [MainThread]: On master: COMMIT
[0m18:25:57.775582 [debug] [MainThread]: Using postgres connection "master"
[0m18:25:57.776613 [debug] [MainThread]: On master: COMMIT
[0m18:25:57.778596 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m18:25:57.780183 [debug] [MainThread]: On master: Close
[0m18:25:57.781743 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:25:57.783722 [info ] [MainThread]: 
[0m18:25:57.791272 [debug] [Thread-1 (]: Began running node test.dbt_idx.accepted_values_customer_orders_status_order_status__delivered__invoiced__shipped__processing__canceled__unavailable.ea8c296d27
[0m18:25:57.792253 [info ] [Thread-1 (]: 1 of 9 START test accepted_values_customer_orders_status_order_status__delivered__invoiced__shipped__processing__canceled__unavailable  [RUN]
[0m18:25:57.795252 [debug] [Thread-1 (]: Acquiring new postgres connection 'test.dbt_idx.accepted_values_customer_orders_status_order_status__delivered__invoiced__shipped__processing__canceled__unavailable.ea8c296d27'
[0m18:25:57.796764 [debug] [Thread-1 (]: Began compiling node test.dbt_idx.accepted_values_customer_orders_status_order_status__delivered__invoiced__shipped__processing__canceled__unavailable.ea8c296d27
[0m18:25:57.832118 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_idx.accepted_values_customer_orders_status_order_status__delivered__invoiced__shipped__processing__canceled__unavailable.ea8c296d27"
[0m18:25:57.837513 [debug] [Thread-1 (]: Timing info for test.dbt_idx.accepted_values_customer_orders_status_order_status__delivered__invoiced__shipped__processing__canceled__unavailable.ea8c296d27 (compile): 18:25:57.797771 => 18:25:57.836549
[0m18:25:57.838513 [debug] [Thread-1 (]: Began executing node test.dbt_idx.accepted_values_customer_orders_status_order_status__delivered__invoiced__shipped__processing__canceled__unavailable.ea8c296d27
[0m18:25:57.859580 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_idx.accepted_values_customer_orders_status_order_status__delivered__invoiced__shipped__processing__canceled__unavailable.ea8c296d27"
[0m18:25:57.865140 [debug] [Thread-1 (]: Using postgres connection "test.dbt_idx.accepted_values_customer_orders_status_order_status__delivered__invoiced__shipped__processing__canceled__unavailable.ea8c296d27"
[0m18:25:57.866103 [debug] [Thread-1 (]: On test.dbt_idx.accepted_values_customer_orders_status_order_status__delivered__invoiced__shipped__processing__canceled__unavailable.ea8c296d27: BEGIN
[0m18:25:57.867102 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m18:25:57.889387 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m18:25:57.890413 [debug] [Thread-1 (]: Using postgres connection "test.dbt_idx.accepted_values_customer_orders_status_order_status__delivered__invoiced__shipped__processing__canceled__unavailable.ea8c296d27"
[0m18:25:57.891620 [debug] [Thread-1 (]: On test.dbt_idx.accepted_values_customer_orders_status_order_status__delivered__invoiced__shipped__processing__canceled__unavailable.ea8c296d27: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "test.dbt_idx.accepted_values_customer_orders_status_order_status__delivered__invoiced__shipped__processing__canceled__unavailable.ea8c296d27"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        order_status as value_field,
        count(*) as n_records

    from "IDX-Stock"."warehouse"."customer_orders_status"
    group by order_status

)

select *
from all_values
where value_field not in (
    'delivered','invoiced','shipped','processing','canceled','unavailable'
)



      
    ) dbt_internal_test
[0m18:25:57.896176 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m18:25:57.899123 [debug] [Thread-1 (]: Timing info for test.dbt_idx.accepted_values_customer_orders_status_order_status__delivered__invoiced__shipped__processing__canceled__unavailable.ea8c296d27 (execute): 18:25:57.838513 => 18:25:57.899123
[0m18:25:57.899123 [debug] [Thread-1 (]: On test.dbt_idx.accepted_values_customer_orders_status_order_status__delivered__invoiced__shipped__processing__canceled__unavailable.ea8c296d27: ROLLBACK
[0m18:25:57.902644 [debug] [Thread-1 (]: On test.dbt_idx.accepted_values_customer_orders_status_order_status__delivered__invoiced__shipped__processing__canceled__unavailable.ea8c296d27: Close
[0m18:25:57.904639 [info ] [Thread-1 (]: 1 of 9 PASS accepted_values_customer_orders_status_order_status__delivered__invoiced__shipped__processing__canceled__unavailable  [[32mPASS[0m in 0.11s]
[0m18:25:57.907673 [debug] [Thread-1 (]: Finished running node test.dbt_idx.accepted_values_customer_orders_status_order_status__delivered__invoiced__shipped__processing__canceled__unavailable.ea8c296d27
[0m18:25:57.908637 [debug] [Thread-1 (]: Began running node test.dbt_idx.assert_customer_dimension_has_no_row_loss.sql
[0m18:25:57.910647 [info ] [Thread-1 (]: 2 of 9 START test assert_customer_dimension_has_no_row_loss.sql ................ [RUN]
[0m18:25:57.912162 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_idx.accepted_values_customer_orders_status_order_status__delivered__invoiced__shipped__processing__canceled__unavailable.ea8c296d27, now test.dbt_idx.assert_customer_dimension_has_no_row_loss.sql)
[0m18:25:57.914170 [debug] [Thread-1 (]: Began compiling node test.dbt_idx.assert_customer_dimension_has_no_row_loss.sql
[0m18:25:57.918749 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_idx.assert_customer_dimension_has_no_row_loss.sql"
[0m18:25:57.925318 [debug] [Thread-1 (]: Timing info for test.dbt_idx.assert_customer_dimension_has_no_row_loss.sql (compile): 18:25:57.914170 => 18:25:57.925318
[0m18:25:57.926320 [debug] [Thread-1 (]: Began executing node test.dbt_idx.assert_customer_dimension_has_no_row_loss.sql
[0m18:25:57.929320 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_idx.assert_customer_dimension_has_no_row_loss.sql"
[0m18:25:57.935338 [debug] [Thread-1 (]: Using postgres connection "test.dbt_idx.assert_customer_dimension_has_no_row_loss.sql"
[0m18:25:57.936338 [debug] [Thread-1 (]: On test.dbt_idx.assert_customer_dimension_has_no_row_loss.sql: BEGIN
[0m18:25:57.936338 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:25:57.968051 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m18:25:57.969051 [debug] [Thread-1 (]: Using postgres connection "test.dbt_idx.assert_customer_dimension_has_no_row_loss.sql"
[0m18:25:57.969051 [debug] [Thread-1 (]: On test.dbt_idx.assert_customer_dimension_has_no_row_loss.sql: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "test.dbt_idx.assert_customer_dimension_has_no_row_loss.sql"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      -- dim_customers must have the same number of rows as its staging counterpart
-- Therefore return records where this isn't true to make the test fail
select *
from (
         select dim_cust.customer_id
         from "IDX-Stock"."warehouse"."dim_customers" dim_cust
            left join "IDX-Stock"."warehouse"."stg_eltool__customers" stg_cust
         on dim_cust.customer_id = stg_cust.customer_id
         where stg_cust.customer_id is null
         UNION ALL
         select stg_cust.customer_id
         from "IDX-Stock"."warehouse"."stg_eltool__customers" stg_cust
             left join "IDX-Stock"."warehouse"."dim_customers" dim_cust
         on stg_cust.customer_id = dim_cust.customer_id
         where dim_cust.customer_id is null
     ) tmp
      
    ) dbt_internal_test
[0m18:25:57.973621 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m18:25:57.975648 [debug] [Thread-1 (]: Timing info for test.dbt_idx.assert_customer_dimension_has_no_row_loss.sql (execute): 18:25:57.927319 => 18:25:57.975648
[0m18:25:57.976653 [debug] [Thread-1 (]: On test.dbt_idx.assert_customer_dimension_has_no_row_loss.sql: ROLLBACK
[0m18:25:57.979617 [debug] [Thread-1 (]: On test.dbt_idx.assert_customer_dimension_has_no_row_loss.sql: Close
[0m18:25:57.981803 [info ] [Thread-1 (]: 2 of 9 PASS assert_customer_dimension_has_no_row_loss.sql ...................... [[32mPASS[0m in 0.07s]
[0m18:25:57.984825 [debug] [Thread-1 (]: Finished running node test.dbt_idx.assert_customer_dimension_has_no_row_loss.sql
[0m18:25:57.985821 [debug] [Thread-1 (]: Began running node test.dbt_idx.not_null_customer_orders_status_customer_id.3915c814eb
[0m18:25:57.986880 [info ] [Thread-1 (]: 3 of 9 START test not_null_customer_orders_status_customer_id .................. [RUN]
[0m18:25:57.988865 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_idx.assert_customer_dimension_has_no_row_loss.sql, now test.dbt_idx.not_null_customer_orders_status_customer_id.3915c814eb)
[0m18:25:57.988865 [debug] [Thread-1 (]: Began compiling node test.dbt_idx.not_null_customer_orders_status_customer_id.3915c814eb
[0m18:25:58.002922 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_idx.not_null_customer_orders_status_customer_id.3915c814eb"
[0m18:25:58.008103 [debug] [Thread-1 (]: Timing info for test.dbt_idx.not_null_customer_orders_status_customer_id.3915c814eb (compile): 18:25:57.990372 => 18:25:58.007121
[0m18:25:58.009085 [debug] [Thread-1 (]: Began executing node test.dbt_idx.not_null_customer_orders_status_customer_id.3915c814eb
[0m18:25:58.011666 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_idx.not_null_customer_orders_status_customer_id.3915c814eb"
[0m18:25:58.016638 [debug] [Thread-1 (]: Using postgres connection "test.dbt_idx.not_null_customer_orders_status_customer_id.3915c814eb"
[0m18:25:58.017669 [debug] [Thread-1 (]: On test.dbt_idx.not_null_customer_orders_status_customer_id.3915c814eb: BEGIN
[0m18:25:58.018672 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:25:58.045277 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m18:25:58.047285 [debug] [Thread-1 (]: Using postgres connection "test.dbt_idx.not_null_customer_orders_status_customer_id.3915c814eb"
[0m18:25:58.048285 [debug] [Thread-1 (]: On test.dbt_idx.not_null_customer_orders_status_customer_id.3915c814eb: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "test.dbt_idx.not_null_customer_orders_status_customer_id.3915c814eb"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select customer_id
from "IDX-Stock"."warehouse"."customer_orders_status"
where customer_id is null



      
    ) dbt_internal_test
[0m18:25:58.053815 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m18:25:58.057417 [debug] [Thread-1 (]: Timing info for test.dbt_idx.not_null_customer_orders_status_customer_id.3915c814eb (execute): 18:25:58.009085 => 18:25:58.056448
[0m18:25:58.058456 [debug] [Thread-1 (]: On test.dbt_idx.not_null_customer_orders_status_customer_id.3915c814eb: ROLLBACK
[0m18:25:58.060766 [debug] [Thread-1 (]: On test.dbt_idx.not_null_customer_orders_status_customer_id.3915c814eb: Close
[0m18:25:58.062667 [info ] [Thread-1 (]: 3 of 9 PASS not_null_customer_orders_status_customer_id ........................ [[32mPASS[0m in 0.07s]
[0m18:25:58.064666 [debug] [Thread-1 (]: Finished running node test.dbt_idx.not_null_customer_orders_status_customer_id.3915c814eb
[0m18:25:58.065668 [debug] [Thread-1 (]: Began running node test.dbt_idx.not_null_stg_eltool__customers_snapshots_customer_id.ea4fc4ca86
[0m18:25:58.066669 [info ] [Thread-1 (]: 4 of 9 START test not_null_stg_eltool__customers_snapshots_customer_id ......... [RUN]
[0m18:25:58.068669 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_idx.not_null_customer_orders_status_customer_id.3915c814eb, now test.dbt_idx.not_null_stg_eltool__customers_snapshots_customer_id.ea4fc4ca86)
[0m18:25:58.069671 [debug] [Thread-1 (]: Began compiling node test.dbt_idx.not_null_stg_eltool__customers_snapshots_customer_id.ea4fc4ca86
[0m18:25:58.076756 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_idx.not_null_stg_eltool__customers_snapshots_customer_id.ea4fc4ca86"
[0m18:25:58.082267 [debug] [Thread-1 (]: Timing info for test.dbt_idx.not_null_stg_eltool__customers_snapshots_customer_id.ea4fc4ca86 (compile): 18:25:58.069671 => 18:25:58.081301
[0m18:25:58.083270 [debug] [Thread-1 (]: Began executing node test.dbt_idx.not_null_stg_eltool__customers_snapshots_customer_id.ea4fc4ca86
[0m18:25:58.086308 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_idx.not_null_stg_eltool__customers_snapshots_customer_id.ea4fc4ca86"
[0m18:25:58.091835 [debug] [Thread-1 (]: Using postgres connection "test.dbt_idx.not_null_stg_eltool__customers_snapshots_customer_id.ea4fc4ca86"
[0m18:25:58.092823 [debug] [Thread-1 (]: On test.dbt_idx.not_null_stg_eltool__customers_snapshots_customer_id.ea4fc4ca86: BEGIN
[0m18:25:58.093814 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:25:58.117629 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m18:25:58.118629 [debug] [Thread-1 (]: Using postgres connection "test.dbt_idx.not_null_stg_eltool__customers_snapshots_customer_id.ea4fc4ca86"
[0m18:25:58.119630 [debug] [Thread-1 (]: On test.dbt_idx.not_null_stg_eltool__customers_snapshots_customer_id.ea4fc4ca86: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "test.dbt_idx.not_null_stg_eltool__customers_snapshots_customer_id.ea4fc4ca86"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select customer_id
from "IDX-Stock"."warehouse"."stg_eltool__customers_snapshots"
where customer_id is null



      
    ) dbt_internal_test
[0m18:25:58.122844 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m18:25:58.124867 [debug] [Thread-1 (]: Timing info for test.dbt_idx.not_null_stg_eltool__customers_snapshots_customer_id.ea4fc4ca86 (execute): 18:25:58.084327 => 18:25:58.124867
[0m18:25:58.125868 [debug] [Thread-1 (]: On test.dbt_idx.not_null_stg_eltool__customers_snapshots_customer_id.ea4fc4ca86: ROLLBACK
[0m18:25:58.127836 [debug] [Thread-1 (]: On test.dbt_idx.not_null_stg_eltool__customers_snapshots_customer_id.ea4fc4ca86: Close
[0m18:25:58.130357 [info ] [Thread-1 (]: 4 of 9 PASS not_null_stg_eltool__customers_snapshots_customer_id ............... [[32mPASS[0m in 0.06s]
[0m18:25:58.131373 [debug] [Thread-1 (]: Finished running node test.dbt_idx.not_null_stg_eltool__customers_snapshots_customer_id.ea4fc4ca86
[0m18:25:58.132372 [debug] [Thread-1 (]: Began running node test.dbt_idx.source_not_null_warehouse_customers_customer_id.ae7452c4c6
[0m18:25:58.133879 [info ] [Thread-1 (]: 5 of 9 START test source_not_null_warehouse_customers_customer_id .............. [RUN]
[0m18:25:58.135888 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_idx.not_null_stg_eltool__customers_snapshots_customer_id.ea4fc4ca86, now test.dbt_idx.source_not_null_warehouse_customers_customer_id.ae7452c4c6)
[0m18:25:58.136888 [debug] [Thread-1 (]: Began compiling node test.dbt_idx.source_not_null_warehouse_customers_customer_id.ae7452c4c6
[0m18:25:58.143502 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_idx.source_not_null_warehouse_customers_customer_id.ae7452c4c6"
[0m18:25:58.148416 [debug] [Thread-1 (]: Timing info for test.dbt_idx.source_not_null_warehouse_customers_customer_id.ae7452c4c6 (compile): 18:25:58.137887 => 18:25:58.148416
[0m18:25:58.149437 [debug] [Thread-1 (]: Began executing node test.dbt_idx.source_not_null_warehouse_customers_customer_id.ae7452c4c6
[0m18:25:58.154480 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_idx.source_not_null_warehouse_customers_customer_id.ae7452c4c6"
[0m18:25:58.160484 [debug] [Thread-1 (]: Using postgres connection "test.dbt_idx.source_not_null_warehouse_customers_customer_id.ae7452c4c6"
[0m18:25:58.162043 [debug] [Thread-1 (]: On test.dbt_idx.source_not_null_warehouse_customers_customer_id.ae7452c4c6: BEGIN
[0m18:25:58.163050 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:25:58.189629 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m18:25:58.191169 [debug] [Thread-1 (]: Using postgres connection "test.dbt_idx.source_not_null_warehouse_customers_customer_id.ae7452c4c6"
[0m18:25:58.192182 [debug] [Thread-1 (]: On test.dbt_idx.source_not_null_warehouse_customers_customer_id.ae7452c4c6: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "test.dbt_idx.source_not_null_warehouse_customers_customer_id.ae7452c4c6"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select customer_id
from "IDX-Stock"."warehouse"."customers"
where customer_id is null



      
    ) dbt_internal_test
[0m18:25:58.196785 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m18:25:58.198765 [debug] [Thread-1 (]: Timing info for test.dbt_idx.source_not_null_warehouse_customers_customer_id.ae7452c4c6 (execute): 18:25:58.150931 => 18:25:58.198765
[0m18:25:58.201313 [debug] [Thread-1 (]: On test.dbt_idx.source_not_null_warehouse_customers_customer_id.ae7452c4c6: ROLLBACK
[0m18:25:58.204319 [debug] [Thread-1 (]: On test.dbt_idx.source_not_null_warehouse_customers_customer_id.ae7452c4c6: Close
[0m18:25:58.207344 [info ] [Thread-1 (]: 5 of 9 PASS source_not_null_warehouse_customers_customer_id .................... [[32mPASS[0m in 0.07s]
[0m18:25:58.210880 [debug] [Thread-1 (]: Finished running node test.dbt_idx.source_not_null_warehouse_customers_customer_id.ae7452c4c6
[0m18:25:58.211906 [debug] [Thread-1 (]: Began running node test.dbt_idx.source_not_null_warehouse_orders_order_id.c85a1f0b76
[0m18:25:58.213920 [info ] [Thread-1 (]: 6 of 9 START test source_not_null_warehouse_orders_order_id .................... [RUN]
[0m18:25:58.215916 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_idx.source_not_null_warehouse_customers_customer_id.ae7452c4c6, now test.dbt_idx.source_not_null_warehouse_orders_order_id.c85a1f0b76)
[0m18:25:58.216915 [debug] [Thread-1 (]: Began compiling node test.dbt_idx.source_not_null_warehouse_orders_order_id.c85a1f0b76
[0m18:25:58.224146 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_idx.source_not_null_warehouse_orders_order_id.c85a1f0b76"
[0m18:25:58.230361 [debug] [Thread-1 (]: Timing info for test.dbt_idx.source_not_null_warehouse_orders_order_id.c85a1f0b76 (compile): 18:25:58.217932 => 18:25:58.229820
[0m18:25:58.231419 [debug] [Thread-1 (]: Began executing node test.dbt_idx.source_not_null_warehouse_orders_order_id.c85a1f0b76
[0m18:25:58.240514 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_idx.source_not_null_warehouse_orders_order_id.c85a1f0b76"
[0m18:25:58.248050 [debug] [Thread-1 (]: Using postgres connection "test.dbt_idx.source_not_null_warehouse_orders_order_id.c85a1f0b76"
[0m18:25:58.249050 [debug] [Thread-1 (]: On test.dbt_idx.source_not_null_warehouse_orders_order_id.c85a1f0b76: BEGIN
[0m18:25:58.251357 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:25:58.277592 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m18:25:58.278571 [debug] [Thread-1 (]: Using postgres connection "test.dbt_idx.source_not_null_warehouse_orders_order_id.c85a1f0b76"
[0m18:25:58.279571 [debug] [Thread-1 (]: On test.dbt_idx.source_not_null_warehouse_orders_order_id.c85a1f0b76: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "test.dbt_idx.source_not_null_warehouse_orders_order_id.c85a1f0b76"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select order_id
from "IDX-Stock"."warehouse"."orders"
where order_id is null



      
    ) dbt_internal_test
[0m18:25:58.283728 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m18:25:58.285731 [debug] [Thread-1 (]: Timing info for test.dbt_idx.source_not_null_warehouse_orders_order_id.c85a1f0b76 (execute): 18:25:58.233977 => 18:25:58.285731
[0m18:25:58.287242 [debug] [Thread-1 (]: On test.dbt_idx.source_not_null_warehouse_orders_order_id.c85a1f0b76: ROLLBACK
[0m18:25:58.289777 [debug] [Thread-1 (]: On test.dbt_idx.source_not_null_warehouse_orders_order_id.c85a1f0b76: Close
[0m18:25:58.293314 [info ] [Thread-1 (]: 6 of 9 PASS source_not_null_warehouse_orders_order_id .......................... [[32mPASS[0m in 0.08s]
[0m18:25:58.295310 [debug] [Thread-1 (]: Finished running node test.dbt_idx.source_not_null_warehouse_orders_order_id.c85a1f0b76
[0m18:25:58.296824 [debug] [Thread-1 (]: Began running node test.dbt_idx.source_relationships_warehouse_orders_cust_id__customer_id__source_warehouse_customers_.d3f9188fc2
[0m18:25:58.297835 [info ] [Thread-1 (]: 7 of 9 START test source_relationships_warehouse_orders_cust_id__customer_id__source_warehouse_customers_  [RUN]
[0m18:25:58.300353 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_idx.source_not_null_warehouse_orders_order_id.c85a1f0b76, now test.dbt_idx.source_relationships_warehouse_orders_cust_id__customer_id__source_warehouse_customers_.d3f9188fc2)
[0m18:25:58.301367 [debug] [Thread-1 (]: Began compiling node test.dbt_idx.source_relationships_warehouse_orders_cust_id__customer_id__source_warehouse_customers_.d3f9188fc2
[0m18:25:58.315085 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_idx.source_relationships_warehouse_orders_cust_id__customer_id__source_warehouse_customers_.d3f9188fc2"
[0m18:25:58.321167 [debug] [Thread-1 (]: Timing info for test.dbt_idx.source_relationships_warehouse_orders_cust_id__customer_id__source_warehouse_customers_.d3f9188fc2 (compile): 18:25:58.302363 => 18:25:58.321167
[0m18:25:58.322181 [debug] [Thread-1 (]: Began executing node test.dbt_idx.source_relationships_warehouse_orders_cust_id__customer_id__source_warehouse_customers_.d3f9188fc2
[0m18:25:58.327716 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_idx.source_relationships_warehouse_orders_cust_id__customer_id__source_warehouse_customers_.d3f9188fc2"
[0m18:25:58.333281 [debug] [Thread-1 (]: Using postgres connection "test.dbt_idx.source_relationships_warehouse_orders_cust_id__customer_id__source_warehouse_customers_.d3f9188fc2"
[0m18:25:58.335247 [debug] [Thread-1 (]: On test.dbt_idx.source_relationships_warehouse_orders_cust_id__customer_id__source_warehouse_customers_.d3f9188fc2: BEGIN
[0m18:25:58.336245 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:25:58.361989 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m18:25:58.363503 [debug] [Thread-1 (]: Using postgres connection "test.dbt_idx.source_relationships_warehouse_orders_cust_id__customer_id__source_warehouse_customers_.d3f9188fc2"
[0m18:25:58.364516 [debug] [Thread-1 (]: On test.dbt_idx.source_relationships_warehouse_orders_cust_id__customer_id__source_warehouse_customers_.d3f9188fc2: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "test.dbt_idx.source_relationships_warehouse_orders_cust_id__customer_id__source_warehouse_customers_.d3f9188fc2"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select cust_id as from_field
    from "IDX-Stock"."warehouse"."orders"
    where cust_id is not null
),

parent as (
    select customer_id as to_field
    from "IDX-Stock"."warehouse"."customers"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m18:25:58.369542 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m18:25:58.373675 [debug] [Thread-1 (]: Timing info for test.dbt_idx.source_relationships_warehouse_orders_cust_id__customer_id__source_warehouse_customers_.d3f9188fc2 (execute): 18:25:58.324208 => 18:25:58.373675
[0m18:25:58.374674 [debug] [Thread-1 (]: On test.dbt_idx.source_relationships_warehouse_orders_cust_id__customer_id__source_warehouse_customers_.d3f9188fc2: ROLLBACK
[0m18:25:58.378437 [debug] [Thread-1 (]: On test.dbt_idx.source_relationships_warehouse_orders_cust_id__customer_id__source_warehouse_customers_.d3f9188fc2: Close
[0m18:25:58.381171 [info ] [Thread-1 (]: 7 of 9 PASS source_relationships_warehouse_orders_cust_id__customer_id__source_warehouse_customers_  [[32mPASS[0m in 0.08s]
[0m18:25:58.384408 [debug] [Thread-1 (]: Finished running node test.dbt_idx.source_relationships_warehouse_orders_cust_id__customer_id__source_warehouse_customers_.d3f9188fc2
[0m18:25:58.386688 [debug] [Thread-1 (]: Began running node test.dbt_idx.source_unique_warehouse_orders_order_id.839fb43d0f
[0m18:25:58.387740 [info ] [Thread-1 (]: 8 of 9 START test source_unique_warehouse_orders_order_id ...................... [RUN]
[0m18:25:58.391277 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_idx.source_relationships_warehouse_orders_cust_id__customer_id__source_warehouse_customers_.d3f9188fc2, now test.dbt_idx.source_unique_warehouse_orders_order_id.839fb43d0f)
[0m18:25:58.392275 [debug] [Thread-1 (]: Began compiling node test.dbt_idx.source_unique_warehouse_orders_order_id.839fb43d0f
[0m18:25:58.403895 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_idx.source_unique_warehouse_orders_order_id.839fb43d0f"
[0m18:25:58.410402 [debug] [Thread-1 (]: Timing info for test.dbt_idx.source_unique_warehouse_orders_order_id.839fb43d0f (compile): 18:25:58.393284 => 18:25:58.408892
[0m18:25:58.411414 [debug] [Thread-1 (]: Began executing node test.dbt_idx.source_unique_warehouse_orders_order_id.839fb43d0f
[0m18:25:58.418491 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_idx.source_unique_warehouse_orders_order_id.839fb43d0f"
[0m18:25:58.425530 [debug] [Thread-1 (]: Using postgres connection "test.dbt_idx.source_unique_warehouse_orders_order_id.839fb43d0f"
[0m18:25:58.426551 [debug] [Thread-1 (]: On test.dbt_idx.source_unique_warehouse_orders_order_id.839fb43d0f: BEGIN
[0m18:25:58.427531 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:25:58.454453 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m18:25:58.454453 [debug] [Thread-1 (]: Using postgres connection "test.dbt_idx.source_unique_warehouse_orders_order_id.839fb43d0f"
[0m18:25:58.455996 [debug] [Thread-1 (]: On test.dbt_idx.source_unique_warehouse_orders_order_id.839fb43d0f: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "test.dbt_idx.source_unique_warehouse_orders_order_id.839fb43d0f"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    order_id as unique_field,
    count(*) as n_records

from "IDX-Stock"."warehouse"."orders"
where order_id is not null
group by order_id
having count(*) > 1



      
    ) dbt_internal_test
[0m18:25:58.460559 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m18:25:58.462749 [debug] [Thread-1 (]: Timing info for test.dbt_idx.source_unique_warehouse_orders_order_id.839fb43d0f (execute): 18:25:58.412413 => 18:25:58.462749
[0m18:25:58.463748 [debug] [Thread-1 (]: On test.dbt_idx.source_unique_warehouse_orders_order_id.839fb43d0f: ROLLBACK
[0m18:25:58.466264 [debug] [Thread-1 (]: On test.dbt_idx.source_unique_warehouse_orders_order_id.839fb43d0f: Close
[0m18:25:58.469271 [info ] [Thread-1 (]: 8 of 9 PASS source_unique_warehouse_orders_order_id ............................ [[32mPASS[0m in 0.08s]
[0m18:25:58.471808 [debug] [Thread-1 (]: Finished running node test.dbt_idx.source_unique_warehouse_orders_order_id.839fb43d0f
[0m18:25:58.473798 [debug] [Thread-1 (]: Began running node test.dbt_idx.unique_customer_orders_status_order_id.b7a45e83ee
[0m18:25:58.474798 [info ] [Thread-1 (]: 9 of 9 START test unique_customer_orders_status_order_id ....................... [RUN]
[0m18:25:58.475799 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_idx.source_unique_warehouse_orders_order_id.839fb43d0f, now test.dbt_idx.unique_customer_orders_status_order_id.b7a45e83ee)
[0m18:25:58.477329 [debug] [Thread-1 (]: Began compiling node test.dbt_idx.unique_customer_orders_status_order_id.b7a45e83ee
[0m18:25:58.484877 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_idx.unique_customer_orders_status_order_id.b7a45e83ee"
[0m18:25:58.490411 [debug] [Thread-1 (]: Timing info for test.dbt_idx.unique_customer_orders_status_order_id.b7a45e83ee (compile): 18:25:58.478367 => 18:25:58.489401
[0m18:25:58.491681 [debug] [Thread-1 (]: Began executing node test.dbt_idx.unique_customer_orders_status_order_id.b7a45e83ee
[0m18:25:58.498201 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_idx.unique_customer_orders_status_order_id.b7a45e83ee"
[0m18:25:58.505255 [debug] [Thread-1 (]: Using postgres connection "test.dbt_idx.unique_customer_orders_status_order_id.b7a45e83ee"
[0m18:25:58.506256 [debug] [Thread-1 (]: On test.dbt_idx.unique_customer_orders_status_order_id.b7a45e83ee: BEGIN
[0m18:25:58.507436 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:25:58.535295 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m18:25:58.537308 [debug] [Thread-1 (]: Using postgres connection "test.dbt_idx.unique_customer_orders_status_order_id.b7a45e83ee"
[0m18:25:58.538331 [debug] [Thread-1 (]: On test.dbt_idx.unique_customer_orders_status_order_id.b7a45e83ee: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "test.dbt_idx.unique_customer_orders_status_order_id.b7a45e83ee"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    order_id as unique_field,
    count(*) as n_records

from "IDX-Stock"."warehouse"."customer_orders_status"
where order_id is not null
group by order_id
having count(*) > 1



      
    ) dbt_internal_test
[0m18:25:58.544845 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m18:25:58.548362 [debug] [Thread-1 (]: Timing info for test.dbt_idx.unique_customer_orders_status_order_id.b7a45e83ee (execute): 18:25:58.492682 => 18:25:58.547363
[0m18:25:58.549366 [debug] [Thread-1 (]: On test.dbt_idx.unique_customer_orders_status_order_id.b7a45e83ee: ROLLBACK
[0m18:25:58.551445 [debug] [Thread-1 (]: On test.dbt_idx.unique_customer_orders_status_order_id.b7a45e83ee: Close
[0m18:25:58.554424 [info ] [Thread-1 (]: 9 of 9 PASS unique_customer_orders_status_order_id ............................. [[32mPASS[0m in 0.08s]
[0m18:25:58.559479 [debug] [Thread-1 (]: Finished running node test.dbt_idx.unique_customer_orders_status_order_id.b7a45e83ee
[0m18:25:58.562271 [debug] [MainThread]: Using postgres connection "master"
[0m18:25:58.564278 [debug] [MainThread]: On master: BEGIN
[0m18:25:58.565278 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:25:58.593499 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m18:25:58.593499 [debug] [MainThread]: On master: COMMIT
[0m18:25:58.595547 [debug] [MainThread]: Using postgres connection "master"
[0m18:25:58.596558 [debug] [MainThread]: On master: COMMIT
[0m18:25:58.599083 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m18:25:58.599083 [debug] [MainThread]: On master: Close
[0m18:25:58.601620 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:25:58.603630 [debug] [MainThread]: Connection 'list_IDX-Stock_snapshots' was properly closed.
[0m18:25:58.604633 [debug] [MainThread]: Connection 'test.dbt_idx.unique_customer_orders_status_order_id.b7a45e83ee' was properly closed.
[0m18:25:58.606629 [info ] [MainThread]: 
[0m18:25:58.608636 [info ] [MainThread]: Finished running 9 tests in 0 hours 0 minutes and 1.02 seconds (1.02s).
[0m18:25:58.614264 [debug] [MainThread]: Command end result
[0m18:25:58.642404 [info ] [MainThread]: 
[0m18:25:58.643400 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:25:58.644410 [info ] [MainThread]: 
[0m18:25:58.645403 [info ] [MainThread]: Done. PASS=9 WARN=0 ERROR=0 SKIP=0 TOTAL=9
[0m18:25:58.647402 [debug] [MainThread]: Command `dbt test` succeeded at 18:25:58.647402 after 1.59 seconds
[0m18:25:58.648403 [debug] [MainThread]: Flushing usage events


============================== 18:26:46.024418 | c9613df2-2c24-4a46-b238-641f2428e11b ==============================
[0m18:26:46.024418 [info ] [MainThread]: Running with dbt=1.6.1
[0m18:26:46.029478 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': 'D:\\00 Project\\00 My Project\\IdeaProjects\\Py-DBT-IDX', 'log_path': 'D:\\00 Project\\00 My Project\\IdeaProjects\\Py-DBT-IDX\\logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt test', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'False'}
[0m18:26:46.164540 [info ] [MainThread]: Registered adapter: postgres=1.6.1
[0m18:26:46.177128 [debug] [MainThread]: checksum: efe19d9f5b93d1a98cc804fbfcdb6b3aced98b974af664946fee1cde8837deb7, vars: {}, profile: , target: , version: 1.6.1
[0m18:26:46.348826 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m18:26:46.350332 [debug] [MainThread]: Partial parsing: updated file: dbt_idx://tests\assert_customer_dimension_has_no_row_loss.sql.sql
[0m18:26:46.389194 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_idx.assert_customer_dimension_has_no_row_loss.sql' (tests\assert_customer_dimension_has_no_row_loss.sql.sql) depends on a node named 'stg_eltool__customers_snapshot' in package '' which was not found
[0m18:26:46.391445 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_idx.assert_customer_dimension_has_no_row_loss.sql' (tests\assert_customer_dimension_has_no_row_loss.sql.sql) depends on a node named 'stg_eltool__customers_snapshot' in package '' which was not found
[0m18:26:46.455245 [info ] [MainThread]: Found 1 snapshot, 8 tests, 7 models, 3 sources, 0 exposures, 0 metrics, 349 macros, 0 groups, 0 semantic models
[0m18:26:46.458211 [info ] [MainThread]: 
[0m18:26:46.460717 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m18:26:46.466733 [debug] [ThreadPool]: Acquiring new postgres connection 'list_IDX-Stock_warehouse'
[0m18:26:46.481342 [debug] [ThreadPool]: Using postgres connection "list_IDX-Stock_warehouse"
[0m18:26:46.482360 [debug] [ThreadPool]: On list_IDX-Stock_warehouse: BEGIN
[0m18:26:46.483390 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:26:46.521366 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m18:26:46.523323 [debug] [ThreadPool]: Using postgres connection "list_IDX-Stock_warehouse"
[0m18:26:46.523323 [debug] [ThreadPool]: On list_IDX-Stock_warehouse: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "connection_name": "list_IDX-Stock_warehouse"} */
select
      'IDX-Stock' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'warehouse'
    union all
    select
      'IDX-Stock' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'warehouse'
    union all
    select
      'IDX-Stock' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'warehouse'
  
[0m18:26:46.528326 [debug] [ThreadPool]: SQL status: SELECT 11 in 0.0 seconds
[0m18:26:46.531553 [debug] [ThreadPool]: On list_IDX-Stock_warehouse: ROLLBACK
[0m18:26:46.534496 [debug] [ThreadPool]: On list_IDX-Stock_warehouse: Close
[0m18:26:46.537012 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_IDX-Stock_warehouse, now list_IDX-Stock_snapshots)
[0m18:26:46.546570 [debug] [ThreadPool]: Using postgres connection "list_IDX-Stock_snapshots"
[0m18:26:46.547536 [debug] [ThreadPool]: On list_IDX-Stock_snapshots: BEGIN
[0m18:26:46.548537 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:26:46.574855 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m18:26:46.575881 [debug] [ThreadPool]: Using postgres connection "list_IDX-Stock_snapshots"
[0m18:26:46.576851 [debug] [ThreadPool]: On list_IDX-Stock_snapshots: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "connection_name": "list_IDX-Stock_snapshots"} */
select
      'IDX-Stock' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'snapshots'
    union all
    select
      'IDX-Stock' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'snapshots'
    union all
    select
      'IDX-Stock' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'snapshots'
  
[0m18:26:46.583454 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.0 seconds
[0m18:26:46.585415 [debug] [ThreadPool]: On list_IDX-Stock_snapshots: ROLLBACK
[0m18:26:46.588438 [debug] [ThreadPool]: On list_IDX-Stock_snapshots: Close
[0m18:26:46.595963 [debug] [MainThread]: Using postgres connection "master"
[0m18:26:46.597004 [debug] [MainThread]: On master: BEGIN
[0m18:26:46.598006 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:26:46.620035 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m18:26:46.621143 [debug] [MainThread]: Using postgres connection "master"
[0m18:26:46.622143 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m18:26:46.629138 [debug] [MainThread]: SQL status: SELECT 6 in 0.0 seconds
[0m18:26:46.631665 [debug] [MainThread]: On master: ROLLBACK
[0m18:26:46.634661 [debug] [MainThread]: Using postgres connection "master"
[0m18:26:46.634661 [debug] [MainThread]: On master: BEGIN
[0m18:26:46.638700 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m18:26:46.640213 [debug] [MainThread]: On master: COMMIT
[0m18:26:46.640312 [debug] [MainThread]: Using postgres connection "master"
[0m18:26:46.641256 [debug] [MainThread]: On master: COMMIT
[0m18:26:46.643273 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m18:26:46.644223 [debug] [MainThread]: On master: Close
[0m18:26:46.646251 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:26:46.647221 [info ] [MainThread]: 
[0m18:26:46.654683 [debug] [Thread-1 (]: Began running node test.dbt_idx.accepted_values_customer_orders_status_order_status__delivered__invoiced__shipped__processing__canceled__unavailable.ea8c296d27
[0m18:26:46.655708 [info ] [Thread-1 (]: 1 of 8 START test accepted_values_customer_orders_status_order_status__delivered__invoiced__shipped__processing__canceled__unavailable  [RUN]
[0m18:26:46.656710 [debug] [Thread-1 (]: Acquiring new postgres connection 'test.dbt_idx.accepted_values_customer_orders_status_order_status__delivered__invoiced__shipped__processing__canceled__unavailable.ea8c296d27'
[0m18:26:46.657708 [debug] [Thread-1 (]: Began compiling node test.dbt_idx.accepted_values_customer_orders_status_order_status__delivered__invoiced__shipped__processing__canceled__unavailable.ea8c296d27
[0m18:26:46.683399 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_idx.accepted_values_customer_orders_status_order_status__delivered__invoiced__shipped__processing__canceled__unavailable.ea8c296d27"
[0m18:26:46.690362 [debug] [Thread-1 (]: Timing info for test.dbt_idx.accepted_values_customer_orders_status_order_status__delivered__invoiced__shipped__processing__canceled__unavailable.ea8c296d27 (compile): 18:26:46.658683 => 18:26:46.690362
[0m18:26:46.691483 [debug] [Thread-1 (]: Began executing node test.dbt_idx.accepted_values_customer_orders_status_order_status__delivered__invoiced__shipped__processing__canceled__unavailable.ea8c296d27
[0m18:26:46.707685 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_idx.accepted_values_customer_orders_status_order_status__delivered__invoiced__shipped__processing__canceled__unavailable.ea8c296d27"
[0m18:26:46.715262 [debug] [Thread-1 (]: Using postgres connection "test.dbt_idx.accepted_values_customer_orders_status_order_status__delivered__invoiced__shipped__processing__canceled__unavailable.ea8c296d27"
[0m18:26:46.716292 [debug] [Thread-1 (]: On test.dbt_idx.accepted_values_customer_orders_status_order_status__delivered__invoiced__shipped__processing__canceled__unavailable.ea8c296d27: BEGIN
[0m18:26:46.717274 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m18:26:46.738875 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m18:26:46.740381 [debug] [Thread-1 (]: Using postgres connection "test.dbt_idx.accepted_values_customer_orders_status_order_status__delivered__invoiced__shipped__processing__canceled__unavailable.ea8c296d27"
[0m18:26:46.740381 [debug] [Thread-1 (]: On test.dbt_idx.accepted_values_customer_orders_status_order_status__delivered__invoiced__shipped__processing__canceled__unavailable.ea8c296d27: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "test.dbt_idx.accepted_values_customer_orders_status_order_status__delivered__invoiced__shipped__processing__canceled__unavailable.ea8c296d27"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        order_status as value_field,
        count(*) as n_records

    from "IDX-Stock"."warehouse"."customer_orders_status"
    group by order_status

)

select *
from all_values
where value_field not in (
    'delivered','invoiced','shipped','processing','canceled','unavailable'
)



      
    ) dbt_internal_test
[0m18:26:46.746389 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m18:26:46.749389 [debug] [Thread-1 (]: Timing info for test.dbt_idx.accepted_values_customer_orders_status_order_status__delivered__invoiced__shipped__processing__canceled__unavailable.ea8c296d27 (execute): 18:26:46.692479 => 18:26:46.748388
[0m18:26:46.749389 [debug] [Thread-1 (]: On test.dbt_idx.accepted_values_customer_orders_status_order_status__delivered__invoiced__shipped__processing__canceled__unavailable.ea8c296d27: ROLLBACK
[0m18:26:46.751906 [debug] [Thread-1 (]: On test.dbt_idx.accepted_values_customer_orders_status_order_status__delivered__invoiced__shipped__processing__canceled__unavailable.ea8c296d27: Close
[0m18:26:46.753904 [info ] [Thread-1 (]: 1 of 8 PASS accepted_values_customer_orders_status_order_status__delivered__invoiced__shipped__processing__canceled__unavailable  [[32mPASS[0m in 0.10s]
[0m18:26:46.755917 [debug] [Thread-1 (]: Finished running node test.dbt_idx.accepted_values_customer_orders_status_order_status__delivered__invoiced__shipped__processing__canceled__unavailable.ea8c296d27
[0m18:26:46.757913 [debug] [Thread-1 (]: Began running node test.dbt_idx.not_null_customer_orders_status_customer_id.3915c814eb
[0m18:26:46.757913 [info ] [Thread-1 (]: 2 of 8 START test not_null_customer_orders_status_customer_id .................. [RUN]
[0m18:26:46.758939 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_idx.accepted_values_customer_orders_status_order_status__delivered__invoiced__shipped__processing__canceled__unavailable.ea8c296d27, now test.dbt_idx.not_null_customer_orders_status_customer_id.3915c814eb)
[0m18:26:46.760471 [debug] [Thread-1 (]: Began compiling node test.dbt_idx.not_null_customer_orders_status_customer_id.3915c814eb
[0m18:26:46.767513 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_idx.not_null_customer_orders_status_customer_id.3915c814eb"
[0m18:26:46.774679 [debug] [Thread-1 (]: Timing info for test.dbt_idx.not_null_customer_orders_status_customer_id.3915c814eb (compile): 18:26:46.760471 => 18:26:46.773683
[0m18:26:46.774679 [debug] [Thread-1 (]: Began executing node test.dbt_idx.not_null_customer_orders_status_customer_id.3915c814eb
[0m18:26:46.778703 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_idx.not_null_customer_orders_status_customer_id.3915c814eb"
[0m18:26:46.786529 [debug] [Thread-1 (]: Using postgres connection "test.dbt_idx.not_null_customer_orders_status_customer_id.3915c814eb"
[0m18:26:46.787562 [debug] [Thread-1 (]: On test.dbt_idx.not_null_customer_orders_status_customer_id.3915c814eb: BEGIN
[0m18:26:46.788564 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:26:46.812581 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m18:26:46.813592 [debug] [Thread-1 (]: Using postgres connection "test.dbt_idx.not_null_customer_orders_status_customer_id.3915c814eb"
[0m18:26:46.814592 [debug] [Thread-1 (]: On test.dbt_idx.not_null_customer_orders_status_customer_id.3915c814eb: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "test.dbt_idx.not_null_customer_orders_status_customer_id.3915c814eb"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select customer_id
from "IDX-Stock"."warehouse"."customer_orders_status"
where customer_id is null



      
    ) dbt_internal_test
[0m18:26:46.818593 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m18:26:46.820136 [debug] [Thread-1 (]: Timing info for test.dbt_idx.not_null_customer_orders_status_customer_id.3915c814eb (execute): 18:26:46.775681 => 18:26:46.820136
[0m18:26:46.821209 [debug] [Thread-1 (]: On test.dbt_idx.not_null_customer_orders_status_customer_id.3915c814eb: ROLLBACK
[0m18:26:46.824039 [debug] [Thread-1 (]: On test.dbt_idx.not_null_customer_orders_status_customer_id.3915c814eb: Close
[0m18:26:46.826054 [info ] [Thread-1 (]: 2 of 8 PASS not_null_customer_orders_status_customer_id ........................ [[32mPASS[0m in 0.07s]
[0m18:26:46.828051 [debug] [Thread-1 (]: Finished running node test.dbt_idx.not_null_customer_orders_status_customer_id.3915c814eb
[0m18:26:46.829072 [debug] [Thread-1 (]: Began running node test.dbt_idx.not_null_stg_eltool__customers_snapshots_customer_id.ea4fc4ca86
[0m18:26:46.830056 [info ] [Thread-1 (]: 3 of 8 START test not_null_stg_eltool__customers_snapshots_customer_id ......... [RUN]
[0m18:26:46.831605 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_idx.not_null_customer_orders_status_customer_id.3915c814eb, now test.dbt_idx.not_null_stg_eltool__customers_snapshots_customer_id.ea4fc4ca86)
[0m18:26:46.832624 [debug] [Thread-1 (]: Began compiling node test.dbt_idx.not_null_stg_eltool__customers_snapshots_customer_id.ea4fc4ca86
[0m18:26:46.836640 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_idx.not_null_stg_eltool__customers_snapshots_customer_id.ea4fc4ca86"
[0m18:26:46.844565 [debug] [Thread-1 (]: Timing info for test.dbt_idx.not_null_stg_eltool__customers_snapshots_customer_id.ea4fc4ca86 (compile): 18:26:46.833625 => 18:26:46.844565
[0m18:26:46.845576 [debug] [Thread-1 (]: Began executing node test.dbt_idx.not_null_stg_eltool__customers_snapshots_customer_id.ea4fc4ca86
[0m18:26:46.848576 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_idx.not_null_stg_eltool__customers_snapshots_customer_id.ea4fc4ca86"
[0m18:26:46.855090 [debug] [Thread-1 (]: Using postgres connection "test.dbt_idx.not_null_stg_eltool__customers_snapshots_customer_id.ea4fc4ca86"
[0m18:26:46.856124 [debug] [Thread-1 (]: On test.dbt_idx.not_null_stg_eltool__customers_snapshots_customer_id.ea4fc4ca86: BEGIN
[0m18:26:46.857126 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:26:46.885195 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m18:26:46.886196 [debug] [Thread-1 (]: Using postgres connection "test.dbt_idx.not_null_stg_eltool__customers_snapshots_customer_id.ea4fc4ca86"
[0m18:26:46.887227 [debug] [Thread-1 (]: On test.dbt_idx.not_null_stg_eltool__customers_snapshots_customer_id.ea4fc4ca86: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "test.dbt_idx.not_null_stg_eltool__customers_snapshots_customer_id.ea4fc4ca86"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select customer_id
from "IDX-Stock"."warehouse"."stg_eltool__customers_snapshots"
where customer_id is null



      
    ) dbt_internal_test
[0m18:26:46.890228 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m18:26:46.893746 [debug] [Thread-1 (]: Timing info for test.dbt_idx.not_null_stg_eltool__customers_snapshots_customer_id.ea4fc4ca86 (execute): 18:26:46.846577 => 18:26:46.893746
[0m18:26:46.894770 [debug] [Thread-1 (]: On test.dbt_idx.not_null_stg_eltool__customers_snapshots_customer_id.ea4fc4ca86: ROLLBACK
[0m18:26:46.896844 [debug] [Thread-1 (]: On test.dbt_idx.not_null_stg_eltool__customers_snapshots_customer_id.ea4fc4ca86: Close
[0m18:26:46.898864 [info ] [Thread-1 (]: 3 of 8 PASS not_null_stg_eltool__customers_snapshots_customer_id ............... [[32mPASS[0m in 0.07s]
[0m18:26:46.901385 [debug] [Thread-1 (]: Finished running node test.dbt_idx.not_null_stg_eltool__customers_snapshots_customer_id.ea4fc4ca86
[0m18:26:46.903386 [debug] [Thread-1 (]: Began running node test.dbt_idx.source_not_null_warehouse_customers_customer_id.ae7452c4c6
[0m18:26:46.904379 [info ] [Thread-1 (]: 4 of 8 START test source_not_null_warehouse_customers_customer_id .............. [RUN]
[0m18:26:46.906380 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_idx.not_null_stg_eltool__customers_snapshots_customer_id.ea4fc4ca86, now test.dbt_idx.source_not_null_warehouse_customers_customer_id.ae7452c4c6)
[0m18:26:46.907414 [debug] [Thread-1 (]: Began compiling node test.dbt_idx.source_not_null_warehouse_customers_customer_id.ae7452c4c6
[0m18:26:46.912011 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_idx.source_not_null_warehouse_customers_customer_id.ae7452c4c6"
[0m18:26:46.918936 [debug] [Thread-1 (]: Timing info for test.dbt_idx.source_not_null_warehouse_customers_customer_id.ae7452c4c6 (compile): 18:26:46.907414 => 18:26:46.918936
[0m18:26:46.920444 [debug] [Thread-1 (]: Began executing node test.dbt_idx.source_not_null_warehouse_customers_customer_id.ae7452c4c6
[0m18:26:46.924453 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_idx.source_not_null_warehouse_customers_customer_id.ae7452c4c6"
[0m18:26:46.930993 [debug] [Thread-1 (]: Using postgres connection "test.dbt_idx.source_not_null_warehouse_customers_customer_id.ae7452c4c6"
[0m18:26:46.932000 [debug] [Thread-1 (]: On test.dbt_idx.source_not_null_warehouse_customers_customer_id.ae7452c4c6: BEGIN
[0m18:26:46.933013 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:26:46.956603 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m18:26:46.957613 [debug] [Thread-1 (]: Using postgres connection "test.dbt_idx.source_not_null_warehouse_customers_customer_id.ae7452c4c6"
[0m18:26:46.958613 [debug] [Thread-1 (]: On test.dbt_idx.source_not_null_warehouse_customers_customer_id.ae7452c4c6: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "test.dbt_idx.source_not_null_warehouse_customers_customer_id.ae7452c4c6"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select customer_id
from "IDX-Stock"."warehouse"."customers"
where customer_id is null



      
    ) dbt_internal_test
[0m18:26:46.961161 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m18:26:46.963167 [debug] [Thread-1 (]: Timing info for test.dbt_idx.source_not_null_warehouse_customers_customer_id.ae7452c4c6 (execute): 18:26:46.921469 => 18:26:46.963167
[0m18:26:46.964196 [debug] [Thread-1 (]: On test.dbt_idx.source_not_null_warehouse_customers_customer_id.ae7452c4c6: ROLLBACK
[0m18:26:46.966199 [debug] [Thread-1 (]: On test.dbt_idx.source_not_null_warehouse_customers_customer_id.ae7452c4c6: Close
[0m18:26:46.968166 [info ] [Thread-1 (]: 4 of 8 PASS source_not_null_warehouse_customers_customer_id .................... [[32mPASS[0m in 0.06s]
[0m18:26:46.970172 [debug] [Thread-1 (]: Finished running node test.dbt_idx.source_not_null_warehouse_customers_customer_id.ae7452c4c6
[0m18:26:46.971647 [debug] [Thread-1 (]: Began running node test.dbt_idx.source_not_null_warehouse_orders_order_id.c85a1f0b76
[0m18:26:46.972652 [info ] [Thread-1 (]: 5 of 8 START test source_not_null_warehouse_orders_order_id .................... [RUN]
[0m18:26:46.973659 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_idx.source_not_null_warehouse_customers_customer_id.ae7452c4c6, now test.dbt_idx.source_not_null_warehouse_orders_order_id.c85a1f0b76)
[0m18:26:46.974689 [debug] [Thread-1 (]: Began compiling node test.dbt_idx.source_not_null_warehouse_orders_order_id.c85a1f0b76
[0m18:26:46.978689 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_idx.source_not_null_warehouse_orders_order_id.c85a1f0b76"
[0m18:26:46.987287 [debug] [Thread-1 (]: Timing info for test.dbt_idx.source_not_null_warehouse_orders_order_id.c85a1f0b76 (compile): 18:26:46.975688 => 18:26:46.987287
[0m18:26:46.988250 [debug] [Thread-1 (]: Began executing node test.dbt_idx.source_not_null_warehouse_orders_order_id.c85a1f0b76
[0m18:26:46.991762 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_idx.source_not_null_warehouse_orders_order_id.c85a1f0b76"
[0m18:26:46.998082 [debug] [Thread-1 (]: Using postgres connection "test.dbt_idx.source_not_null_warehouse_orders_order_id.c85a1f0b76"
[0m18:26:46.999083 [debug] [Thread-1 (]: On test.dbt_idx.source_not_null_warehouse_orders_order_id.c85a1f0b76: BEGIN
[0m18:26:47.000084 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:26:47.024392 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m18:26:47.025396 [debug] [Thread-1 (]: Using postgres connection "test.dbt_idx.source_not_null_warehouse_orders_order_id.c85a1f0b76"
[0m18:26:47.026389 [debug] [Thread-1 (]: On test.dbt_idx.source_not_null_warehouse_orders_order_id.c85a1f0b76: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "test.dbt_idx.source_not_null_warehouse_orders_order_id.c85a1f0b76"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select order_id
from "IDX-Stock"."warehouse"."orders"
where order_id is null



      
    ) dbt_internal_test
[0m18:26:47.028415 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m18:26:47.030904 [debug] [Thread-1 (]: Timing info for test.dbt_idx.source_not_null_warehouse_orders_order_id.c85a1f0b76 (execute): 18:26:46.989249 => 18:26:47.030904
[0m18:26:47.031916 [debug] [Thread-1 (]: On test.dbt_idx.source_not_null_warehouse_orders_order_id.c85a1f0b76: ROLLBACK
[0m18:26:47.033871 [debug] [Thread-1 (]: On test.dbt_idx.source_not_null_warehouse_orders_order_id.c85a1f0b76: Close
[0m18:26:47.035912 [info ] [Thread-1 (]: 5 of 8 PASS source_not_null_warehouse_orders_order_id .......................... [[32mPASS[0m in 0.06s]
[0m18:26:47.037888 [debug] [Thread-1 (]: Finished running node test.dbt_idx.source_not_null_warehouse_orders_order_id.c85a1f0b76
[0m18:26:47.038888 [debug] [Thread-1 (]: Began running node test.dbt_idx.source_relationships_warehouse_orders_cust_id__customer_id__source_warehouse_customers_.d3f9188fc2
[0m18:26:47.038888 [info ] [Thread-1 (]: 6 of 8 START test source_relationships_warehouse_orders_cust_id__customer_id__source_warehouse_customers_  [RUN]
[0m18:26:47.040394 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_idx.source_not_null_warehouse_orders_order_id.c85a1f0b76, now test.dbt_idx.source_relationships_warehouse_orders_cust_id__customer_id__source_warehouse_customers_.d3f9188fc2)
[0m18:26:47.041406 [debug] [Thread-1 (]: Began compiling node test.dbt_idx.source_relationships_warehouse_orders_cust_id__customer_id__source_warehouse_customers_.d3f9188fc2
[0m18:26:47.054919 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_idx.source_relationships_warehouse_orders_cust_id__customer_id__source_warehouse_customers_.d3f9188fc2"
[0m18:26:47.063439 [debug] [Thread-1 (]: Timing info for test.dbt_idx.source_relationships_warehouse_orders_cust_id__customer_id__source_warehouse_customers_.d3f9188fc2 (compile): 18:26:47.042405 => 18:26:47.063439
[0m18:26:47.064469 [debug] [Thread-1 (]: Began executing node test.dbt_idx.source_relationships_warehouse_orders_cust_id__customer_id__source_warehouse_customers_.d3f9188fc2
[0m18:26:47.067439 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_idx.source_relationships_warehouse_orders_cust_id__customer_id__source_warehouse_customers_.d3f9188fc2"
[0m18:26:47.075354 [debug] [Thread-1 (]: Using postgres connection "test.dbt_idx.source_relationships_warehouse_orders_cust_id__customer_id__source_warehouse_customers_.d3f9188fc2"
[0m18:26:47.075354 [debug] [Thread-1 (]: On test.dbt_idx.source_relationships_warehouse_orders_cust_id__customer_id__source_warehouse_customers_.d3f9188fc2: BEGIN
[0m18:26:47.076354 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:26:47.099026 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m18:26:47.099026 [debug] [Thread-1 (]: Using postgres connection "test.dbt_idx.source_relationships_warehouse_orders_cust_id__customer_id__source_warehouse_customers_.d3f9188fc2"
[0m18:26:47.100611 [debug] [Thread-1 (]: On test.dbt_idx.source_relationships_warehouse_orders_cust_id__customer_id__source_warehouse_customers_.d3f9188fc2: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "test.dbt_idx.source_relationships_warehouse_orders_cust_id__customer_id__source_warehouse_customers_.d3f9188fc2"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select cust_id as from_field
    from "IDX-Stock"."warehouse"."orders"
    where cust_id is not null
),

parent as (
    select customer_id as to_field
    from "IDX-Stock"."warehouse"."customers"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m18:26:47.103578 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m18:26:47.106548 [debug] [Thread-1 (]: Timing info for test.dbt_idx.source_relationships_warehouse_orders_cust_id__customer_id__source_warehouse_customers_.d3f9188fc2 (execute): 18:26:47.065472 => 18:26:47.105547
[0m18:26:47.106548 [debug] [Thread-1 (]: On test.dbt_idx.source_relationships_warehouse_orders_cust_id__customer_id__source_warehouse_customers_.d3f9188fc2: ROLLBACK
[0m18:26:47.109556 [debug] [Thread-1 (]: On test.dbt_idx.source_relationships_warehouse_orders_cust_id__customer_id__source_warehouse_customers_.d3f9188fc2: Close
[0m18:26:47.111076 [info ] [Thread-1 (]: 6 of 8 PASS source_relationships_warehouse_orders_cust_id__customer_id__source_warehouse_customers_  [[32mPASS[0m in 0.07s]
[0m18:26:47.113073 [debug] [Thread-1 (]: Finished running node test.dbt_idx.source_relationships_warehouse_orders_cust_id__customer_id__source_warehouse_customers_.d3f9188fc2
[0m18:26:47.115075 [debug] [Thread-1 (]: Began running node test.dbt_idx.source_unique_warehouse_orders_order_id.839fb43d0f
[0m18:26:47.116071 [info ] [Thread-1 (]: 7 of 8 START test source_unique_warehouse_orders_order_id ...................... [RUN]
[0m18:26:47.119073 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_idx.source_relationships_warehouse_orders_cust_id__customer_id__source_warehouse_customers_.d3f9188fc2, now test.dbt_idx.source_unique_warehouse_orders_order_id.839fb43d0f)
[0m18:26:47.120098 [debug] [Thread-1 (]: Began compiling node test.dbt_idx.source_unique_warehouse_orders_order_id.839fb43d0f
[0m18:26:47.129276 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_idx.source_unique_warehouse_orders_order_id.839fb43d0f"
[0m18:26:47.137763 [debug] [Thread-1 (]: Timing info for test.dbt_idx.source_unique_warehouse_orders_order_id.839fb43d0f (compile): 18:26:47.120098 => 18:26:47.136779
[0m18:26:47.138748 [debug] [Thread-1 (]: Began executing node test.dbt_idx.source_unique_warehouse_orders_order_id.839fb43d0f
[0m18:26:47.141271 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_idx.source_unique_warehouse_orders_order_id.839fb43d0f"
[0m18:26:47.149278 [debug] [Thread-1 (]: Using postgres connection "test.dbt_idx.source_unique_warehouse_orders_order_id.839fb43d0f"
[0m18:26:47.150219 [debug] [Thread-1 (]: On test.dbt_idx.source_unique_warehouse_orders_order_id.839fb43d0f: BEGIN
[0m18:26:47.150219 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:26:47.174194 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m18:26:47.175212 [debug] [Thread-1 (]: Using postgres connection "test.dbt_idx.source_unique_warehouse_orders_order_id.839fb43d0f"
[0m18:26:47.176173 [debug] [Thread-1 (]: On test.dbt_idx.source_unique_warehouse_orders_order_id.839fb43d0f: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "test.dbt_idx.source_unique_warehouse_orders_order_id.839fb43d0f"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    order_id as unique_field,
    count(*) as n_records

from "IDX-Stock"."warehouse"."orders"
where order_id is not null
group by order_id
having count(*) > 1



      
    ) dbt_internal_test
[0m18:26:47.180171 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m18:26:47.182367 [debug] [Thread-1 (]: Timing info for test.dbt_idx.source_unique_warehouse_orders_order_id.839fb43d0f (execute): 18:26:47.138748 => 18:26:47.182367
[0m18:26:47.183365 [debug] [Thread-1 (]: On test.dbt_idx.source_unique_warehouse_orders_order_id.839fb43d0f: ROLLBACK
[0m18:26:47.185339 [debug] [Thread-1 (]: On test.dbt_idx.source_unique_warehouse_orders_order_id.839fb43d0f: Close
[0m18:26:47.187367 [info ] [Thread-1 (]: 7 of 8 PASS source_unique_warehouse_orders_order_id ............................ [[32mPASS[0m in 0.07s]
[0m18:26:47.189346 [debug] [Thread-1 (]: Finished running node test.dbt_idx.source_unique_warehouse_orders_order_id.839fb43d0f
[0m18:26:47.190346 [debug] [Thread-1 (]: Began running node test.dbt_idx.unique_customer_orders_status_order_id.b7a45e83ee
[0m18:26:47.191380 [info ] [Thread-1 (]: 8 of 8 START test unique_customer_orders_status_order_id ....................... [RUN]
[0m18:26:47.193398 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_idx.source_unique_warehouse_orders_order_id.839fb43d0f, now test.dbt_idx.unique_customer_orders_status_order_id.b7a45e83ee)
[0m18:26:47.194382 [debug] [Thread-1 (]: Began compiling node test.dbt_idx.unique_customer_orders_status_order_id.b7a45e83ee
[0m18:26:47.198939 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_idx.unique_customer_orders_status_order_id.b7a45e83ee"
[0m18:26:47.207810 [debug] [Thread-1 (]: Timing info for test.dbt_idx.unique_customer_orders_status_order_id.b7a45e83ee (compile): 18:26:47.195893 => 18:26:47.206811
[0m18:26:47.208811 [debug] [Thread-1 (]: Began executing node test.dbt_idx.unique_customer_orders_status_order_id.b7a45e83ee
[0m18:26:47.211397 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_idx.unique_customer_orders_status_order_id.b7a45e83ee"
[0m18:26:47.219382 [debug] [Thread-1 (]: Using postgres connection "test.dbt_idx.unique_customer_orders_status_order_id.b7a45e83ee"
[0m18:26:47.220395 [debug] [Thread-1 (]: On test.dbt_idx.unique_customer_orders_status_order_id.b7a45e83ee: BEGIN
[0m18:26:47.220395 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:26:47.245736 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m18:26:47.246740 [debug] [Thread-1 (]: Using postgres connection "test.dbt_idx.unique_customer_orders_status_order_id.b7a45e83ee"
[0m18:26:47.247765 [debug] [Thread-1 (]: On test.dbt_idx.unique_customer_orders_status_order_id.b7a45e83ee: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "test.dbt_idx.unique_customer_orders_status_order_id.b7a45e83ee"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    order_id as unique_field,
    count(*) as n_records

from "IDX-Stock"."warehouse"."customer_orders_status"
where order_id is not null
group by order_id
having count(*) > 1



      
    ) dbt_internal_test
[0m18:26:47.252272 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m18:26:47.255270 [debug] [Thread-1 (]: Timing info for test.dbt_idx.unique_customer_orders_status_order_id.b7a45e83ee (execute): 18:26:47.208811 => 18:26:47.254272
[0m18:26:47.256271 [debug] [Thread-1 (]: On test.dbt_idx.unique_customer_orders_status_order_id.b7a45e83ee: ROLLBACK
[0m18:26:47.258315 [debug] [Thread-1 (]: On test.dbt_idx.unique_customer_orders_status_order_id.b7a45e83ee: Close
[0m18:26:47.260284 [info ] [Thread-1 (]: 8 of 8 PASS unique_customer_orders_status_order_id ............................. [[32mPASS[0m in 0.07s]
[0m18:26:47.262519 [debug] [Thread-1 (]: Finished running node test.dbt_idx.unique_customer_orders_status_order_id.b7a45e83ee
[0m18:26:47.266948 [debug] [MainThread]: Using postgres connection "master"
[0m18:26:47.266948 [debug] [MainThread]: On master: BEGIN
[0m18:26:47.267964 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:26:47.292535 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m18:26:47.293535 [debug] [MainThread]: On master: COMMIT
[0m18:26:47.293535 [debug] [MainThread]: Using postgres connection "master"
[0m18:26:47.294535 [debug] [MainThread]: On master: COMMIT
[0m18:26:47.297086 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m18:26:47.298119 [debug] [MainThread]: On master: Close
[0m18:26:47.299090 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:26:47.301613 [debug] [MainThread]: Connection 'list_IDX-Stock_snapshots' was properly closed.
[0m18:26:47.301613 [debug] [MainThread]: Connection 'test.dbt_idx.unique_customer_orders_status_order_id.b7a45e83ee' was properly closed.
[0m18:26:47.303625 [info ] [MainThread]: 
[0m18:26:47.304619 [info ] [MainThread]: Finished running 8 tests in 0 hours 0 minutes and 0.84 seconds (0.84s).
[0m18:26:47.306654 [debug] [MainThread]: Command end result
[0m18:26:47.330348 [info ] [MainThread]: 
[0m18:26:47.331641 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:26:47.332649 [info ] [MainThread]: 
[0m18:26:47.334649 [info ] [MainThread]: Done. PASS=8 WARN=0 ERROR=0 SKIP=0 TOTAL=8
[0m18:26:47.335649 [debug] [MainThread]: Command `dbt test` succeeded at 18:26:47.335649 after 1.35 seconds
[0m18:26:47.336658 [debug] [MainThread]: Flushing usage events


============================== 18:27:53.909075 | 04dd2799-ef36-42d7-a29b-ea7fdbb98787 ==============================
[0m18:27:53.909075 [info ] [MainThread]: Running with dbt=1.6.1
[0m18:27:53.915510 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': 'D:\\00 Project\\00 My Project\\IdeaProjects\\Py-DBT-IDX', 'log_path': 'D:\\00 Project\\00 My Project\\IdeaProjects\\Py-DBT-IDX\\logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt test', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'False'}
[0m18:27:54.092853 [info ] [MainThread]: Registered adapter: postgres=1.6.1
[0m18:27:54.104353 [debug] [MainThread]: checksum: efe19d9f5b93d1a98cc804fbfcdb6b3aced98b974af664946fee1cde8837deb7, vars: {}, profile: , target: , version: 1.6.1
[0m18:27:54.292808 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m18:27:54.293808 [debug] [MainThread]: Partial parsing: updated file: dbt_idx://tests\assert_customer_dimension_has_no_row_loss.sql.sql
[0m18:27:54.320357 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_idx.assert_customer_dimension_has_no_row_loss.sql' (tests\assert_customer_dimension_has_no_row_loss.sql.sql) depends on a node named 'stg_eltool__customers_snapshot' in package '' which was not found
[0m18:27:54.322387 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_idx.assert_customer_dimension_has_no_row_loss.sql' (tests\assert_customer_dimension_has_no_row_loss.sql.sql) depends on a node named 'stg_eltool__customers_snapshot' in package '' which was not found
[0m18:27:54.371217 [info ] [MainThread]: Found 1 snapshot, 8 tests, 7 models, 3 sources, 0 exposures, 0 metrics, 349 macros, 0 groups, 0 semantic models
[0m18:27:54.374300 [info ] [MainThread]: 
[0m18:27:54.375320 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m18:27:54.378563 [debug] [ThreadPool]: Acquiring new postgres connection 'list_IDX-Stock_snapshots'
[0m18:27:54.389115 [debug] [ThreadPool]: Using postgres connection "list_IDX-Stock_snapshots"
[0m18:27:54.390149 [debug] [ThreadPool]: On list_IDX-Stock_snapshots: BEGIN
[0m18:27:54.391264 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:27:54.426412 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m18:27:54.428413 [debug] [ThreadPool]: Using postgres connection "list_IDX-Stock_snapshots"
[0m18:27:54.428413 [debug] [ThreadPool]: On list_IDX-Stock_snapshots: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "connection_name": "list_IDX-Stock_snapshots"} */
select
      'IDX-Stock' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'snapshots'
    union all
    select
      'IDX-Stock' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'snapshots'
    union all
    select
      'IDX-Stock' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'snapshots'
  
[0m18:27:54.433932 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.0 seconds
[0m18:27:54.435928 [debug] [ThreadPool]: On list_IDX-Stock_snapshots: ROLLBACK
[0m18:27:54.437939 [debug] [ThreadPool]: On list_IDX-Stock_snapshots: Close
[0m18:27:54.440436 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_IDX-Stock_snapshots, now list_IDX-Stock_warehouse)
[0m18:27:54.444445 [debug] [ThreadPool]: Using postgres connection "list_IDX-Stock_warehouse"
[0m18:27:54.445444 [debug] [ThreadPool]: On list_IDX-Stock_warehouse: BEGIN
[0m18:27:54.446454 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:27:54.467522 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m18:27:54.468538 [debug] [ThreadPool]: Using postgres connection "list_IDX-Stock_warehouse"
[0m18:27:54.468538 [debug] [ThreadPool]: On list_IDX-Stock_warehouse: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "connection_name": "list_IDX-Stock_warehouse"} */
select
      'IDX-Stock' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'warehouse'
    union all
    select
      'IDX-Stock' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'warehouse'
    union all
    select
      'IDX-Stock' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'warehouse'
  
[0m18:27:54.474062 [debug] [ThreadPool]: SQL status: SELECT 11 in 0.0 seconds
[0m18:27:54.476096 [debug] [ThreadPool]: On list_IDX-Stock_warehouse: ROLLBACK
[0m18:27:54.478056 [debug] [ThreadPool]: On list_IDX-Stock_warehouse: Close
[0m18:27:54.489845 [debug] [MainThread]: Using postgres connection "master"
[0m18:27:54.490893 [debug] [MainThread]: On master: BEGIN
[0m18:27:54.491852 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:27:54.517661 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m18:27:54.518629 [debug] [MainThread]: Using postgres connection "master"
[0m18:27:54.518629 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m18:27:54.529170 [debug] [MainThread]: SQL status: SELECT 6 in 0.0 seconds
[0m18:27:54.532682 [debug] [MainThread]: On master: ROLLBACK
[0m18:27:54.535684 [debug] [MainThread]: Using postgres connection "master"
[0m18:27:54.536707 [debug] [MainThread]: On master: BEGIN
[0m18:27:54.541208 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m18:27:54.542212 [debug] [MainThread]: On master: COMMIT
[0m18:27:54.543234 [debug] [MainThread]: Using postgres connection "master"
[0m18:27:54.544226 [debug] [MainThread]: On master: COMMIT
[0m18:27:54.546209 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m18:27:54.547223 [debug] [MainThread]: On master: Close
[0m18:27:54.548229 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:27:54.550215 [info ] [MainThread]: 
[0m18:27:54.556621 [debug] [Thread-1 (]: Began running node test.dbt_idx.accepted_values_customer_orders_status_order_status__delivered__invoiced__shipped__processing__canceled__unavailable.ea8c296d27
[0m18:27:54.556621 [info ] [Thread-1 (]: 1 of 8 START test accepted_values_customer_orders_status_order_status__delivered__invoiced__shipped__processing__canceled__unavailable  [RUN]
[0m18:27:54.559243 [debug] [Thread-1 (]: Acquiring new postgres connection 'test.dbt_idx.accepted_values_customer_orders_status_order_status__delivered__invoiced__shipped__processing__canceled__unavailable.ea8c296d27'
[0m18:27:54.560147 [debug] [Thread-1 (]: Began compiling node test.dbt_idx.accepted_values_customer_orders_status_order_status__delivered__invoiced__shipped__processing__canceled__unavailable.ea8c296d27
[0m18:27:54.580722 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_idx.accepted_values_customer_orders_status_order_status__delivered__invoiced__shipped__processing__canceled__unavailable.ea8c296d27"
[0m18:27:54.590249 [debug] [Thread-1 (]: Timing info for test.dbt_idx.accepted_values_customer_orders_status_order_status__delivered__invoiced__shipped__processing__canceled__unavailable.ea8c296d27 (compile): 18:27:54.560660 => 18:27:54.590249
[0m18:27:54.591176 [debug] [Thread-1 (]: Began executing node test.dbt_idx.accepted_values_customer_orders_status_order_status__delivered__invoiced__shipped__processing__canceled__unavailable.ea8c296d27
[0m18:27:54.606627 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_idx.accepted_values_customer_orders_status_order_status__delivered__invoiced__shipped__processing__canceled__unavailable.ea8c296d27"
[0m18:27:54.613156 [debug] [Thread-1 (]: Using postgres connection "test.dbt_idx.accepted_values_customer_orders_status_order_status__delivered__invoiced__shipped__processing__canceled__unavailable.ea8c296d27"
[0m18:27:54.614168 [debug] [Thread-1 (]: On test.dbt_idx.accepted_values_customer_orders_status_order_status__delivered__invoiced__shipped__processing__canceled__unavailable.ea8c296d27: BEGIN
[0m18:27:54.615167 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m18:27:54.637134 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m18:27:54.638150 [debug] [Thread-1 (]: Using postgres connection "test.dbt_idx.accepted_values_customer_orders_status_order_status__delivered__invoiced__shipped__processing__canceled__unavailable.ea8c296d27"
[0m18:27:54.639114 [debug] [Thread-1 (]: On test.dbt_idx.accepted_values_customer_orders_status_order_status__delivered__invoiced__shipped__processing__canceled__unavailable.ea8c296d27: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "test.dbt_idx.accepted_values_customer_orders_status_order_status__delivered__invoiced__shipped__processing__canceled__unavailable.ea8c296d27"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        order_status as value_field,
        count(*) as n_records

    from "IDX-Stock"."warehouse"."customer_orders_status"
    group by order_status

)

select *
from all_values
where value_field not in (
    'delivered','invoiced','shipped','processing','canceled','unavailable'
)



      
    ) dbt_internal_test
[0m18:27:54.642487 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m18:27:54.645481 [debug] [Thread-1 (]: Timing info for test.dbt_idx.accepted_values_customer_orders_status_order_status__delivered__invoiced__shipped__processing__canceled__unavailable.ea8c296d27 (execute): 18:27:54.592151 => 18:27:54.645481
[0m18:27:54.646481 [debug] [Thread-1 (]: On test.dbt_idx.accepted_values_customer_orders_status_order_status__delivered__invoiced__shipped__processing__canceled__unavailable.ea8c296d27: ROLLBACK
[0m18:27:54.648482 [debug] [Thread-1 (]: On test.dbt_idx.accepted_values_customer_orders_status_order_status__delivered__invoiced__shipped__processing__canceled__unavailable.ea8c296d27: Close
[0m18:27:54.650998 [info ] [Thread-1 (]: 1 of 8 PASS accepted_values_customer_orders_status_order_status__delivered__invoiced__shipped__processing__canceled__unavailable  [[32mPASS[0m in 0.09s]
[0m18:27:54.654044 [debug] [Thread-1 (]: Finished running node test.dbt_idx.accepted_values_customer_orders_status_order_status__delivered__invoiced__shipped__processing__canceled__unavailable.ea8c296d27
[0m18:27:54.656033 [debug] [Thread-1 (]: Began running node test.dbt_idx.not_null_customer_orders_status_customer_id.3915c814eb
[0m18:27:54.657013 [info ] [Thread-1 (]: 2 of 8 START test not_null_customer_orders_status_customer_id .................. [RUN]
[0m18:27:54.659521 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_idx.accepted_values_customer_orders_status_order_status__delivered__invoiced__shipped__processing__canceled__unavailable.ea8c296d27, now test.dbt_idx.not_null_customer_orders_status_customer_id.3915c814eb)
[0m18:27:54.660031 [debug] [Thread-1 (]: Began compiling node test.dbt_idx.not_null_customer_orders_status_customer_id.3915c814eb
[0m18:27:54.672562 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_idx.not_null_customer_orders_status_customer_id.3915c814eb"
[0m18:27:54.681167 [debug] [Thread-1 (]: Timing info for test.dbt_idx.not_null_customer_orders_status_customer_id.3915c814eb (compile): 18:27:54.661043 => 18:27:54.681167
[0m18:27:54.682145 [debug] [Thread-1 (]: Began executing node test.dbt_idx.not_null_customer_orders_status_customer_id.3915c814eb
[0m18:27:54.686151 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_idx.not_null_customer_orders_status_customer_id.3915c814eb"
[0m18:27:54.693172 [debug] [Thread-1 (]: Using postgres connection "test.dbt_idx.not_null_customer_orders_status_customer_id.3915c814eb"
[0m18:27:54.694183 [debug] [Thread-1 (]: On test.dbt_idx.not_null_customer_orders_status_customer_id.3915c814eb: BEGIN
[0m18:27:54.695183 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:27:54.719815 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m18:27:54.720998 [debug] [Thread-1 (]: Using postgres connection "test.dbt_idx.not_null_customer_orders_status_customer_id.3915c814eb"
[0m18:27:54.720998 [debug] [Thread-1 (]: On test.dbt_idx.not_null_customer_orders_status_customer_id.3915c814eb: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "test.dbt_idx.not_null_customer_orders_status_customer_id.3915c814eb"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select customer_id
from "IDX-Stock"."warehouse"."customer_orders_status"
where customer_id is null



      
    ) dbt_internal_test
[0m18:27:54.725027 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m18:27:54.727004 [debug] [Thread-1 (]: Timing info for test.dbt_idx.not_null_customer_orders_status_customer_id.3915c814eb (execute): 18:27:54.683151 => 18:27:54.727004
[0m18:27:54.728004 [debug] [Thread-1 (]: On test.dbt_idx.not_null_customer_orders_status_customer_id.3915c814eb: ROLLBACK
[0m18:27:54.730007 [debug] [Thread-1 (]: On test.dbt_idx.not_null_customer_orders_status_customer_id.3915c814eb: Close
[0m18:27:54.733316 [info ] [Thread-1 (]: 2 of 8 PASS not_null_customer_orders_status_customer_id ........................ [[32mPASS[0m in 0.07s]
[0m18:27:54.735351 [debug] [Thread-1 (]: Finished running node test.dbt_idx.not_null_customer_orders_status_customer_id.3915c814eb
[0m18:27:54.736319 [debug] [Thread-1 (]: Began running node test.dbt_idx.not_null_stg_eltool__customers_snapshots_customer_id.ea4fc4ca86
[0m18:27:54.738311 [info ] [Thread-1 (]: 3 of 8 START test not_null_stg_eltool__customers_snapshots_customer_id ......... [RUN]
[0m18:27:54.739882 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_idx.not_null_customer_orders_status_customer_id.3915c814eb, now test.dbt_idx.not_null_stg_eltool__customers_snapshots_customer_id.ea4fc4ca86)
[0m18:27:54.741890 [debug] [Thread-1 (]: Began compiling node test.dbt_idx.not_null_stg_eltool__customers_snapshots_customer_id.ea4fc4ca86
[0m18:27:54.747891 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_idx.not_null_stg_eltool__customers_snapshots_customer_id.ea4fc4ca86"
[0m18:27:54.754471 [debug] [Thread-1 (]: Timing info for test.dbt_idx.not_null_stg_eltool__customers_snapshots_customer_id.ea4fc4ca86 (compile): 18:27:54.742890 => 18:27:54.754471
[0m18:27:54.755438 [debug] [Thread-1 (]: Began executing node test.dbt_idx.not_null_stg_eltool__customers_snapshots_customer_id.ea4fc4ca86
[0m18:27:54.757472 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_idx.not_null_stg_eltool__customers_snapshots_customer_id.ea4fc4ca86"
[0m18:27:54.764272 [debug] [Thread-1 (]: Using postgres connection "test.dbt_idx.not_null_stg_eltool__customers_snapshots_customer_id.ea4fc4ca86"
[0m18:27:54.765236 [debug] [Thread-1 (]: On test.dbt_idx.not_null_stg_eltool__customers_snapshots_customer_id.ea4fc4ca86: BEGIN
[0m18:27:54.766238 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:27:54.790219 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m18:27:54.791351 [debug] [Thread-1 (]: Using postgres connection "test.dbt_idx.not_null_stg_eltool__customers_snapshots_customer_id.ea4fc4ca86"
[0m18:27:54.792358 [debug] [Thread-1 (]: On test.dbt_idx.not_null_stg_eltool__customers_snapshots_customer_id.ea4fc4ca86: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "test.dbt_idx.not_null_stg_eltool__customers_snapshots_customer_id.ea4fc4ca86"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select customer_id
from "IDX-Stock"."warehouse"."stg_eltool__customers_snapshots"
where customer_id is null



      
    ) dbt_internal_test
[0m18:27:54.795365 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m18:27:54.797357 [debug] [Thread-1 (]: Timing info for test.dbt_idx.not_null_stg_eltool__customers_snapshots_customer_id.ea4fc4ca86 (execute): 18:27:54.756436 => 18:27:54.797357
[0m18:27:54.798372 [debug] [Thread-1 (]: On test.dbt_idx.not_null_stg_eltool__customers_snapshots_customer_id.ea4fc4ca86: ROLLBACK
[0m18:27:54.800917 [debug] [Thread-1 (]: On test.dbt_idx.not_null_stg_eltool__customers_snapshots_customer_id.ea4fc4ca86: Close
[0m18:27:54.802945 [info ] [Thread-1 (]: 3 of 8 PASS not_null_stg_eltool__customers_snapshots_customer_id ............... [[32mPASS[0m in 0.06s]
[0m18:27:54.805947 [debug] [Thread-1 (]: Finished running node test.dbt_idx.not_null_stg_eltool__customers_snapshots_customer_id.ea4fc4ca86
[0m18:27:54.807945 [debug] [Thread-1 (]: Began running node test.dbt_idx.source_not_null_warehouse_customers_customer_id.ae7452c4c6
[0m18:27:54.808946 [info ] [Thread-1 (]: 4 of 8 START test source_not_null_warehouse_customers_customer_id .............. [RUN]
[0m18:27:54.811411 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_idx.not_null_stg_eltool__customers_snapshots_customer_id.ea4fc4ca86, now test.dbt_idx.source_not_null_warehouse_customers_customer_id.ae7452c4c6)
[0m18:27:54.812409 [debug] [Thread-1 (]: Began compiling node test.dbt_idx.source_not_null_warehouse_customers_customer_id.ae7452c4c6
[0m18:27:54.818452 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_idx.source_not_null_warehouse_customers_customer_id.ae7452c4c6"
[0m18:27:54.824957 [debug] [Thread-1 (]: Timing info for test.dbt_idx.source_not_null_warehouse_customers_customer_id.ae7452c4c6 (compile): 18:27:54.813419 => 18:27:54.824957
[0m18:27:54.825946 [debug] [Thread-1 (]: Began executing node test.dbt_idx.source_not_null_warehouse_customers_customer_id.ae7452c4c6
[0m18:27:54.828958 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_idx.source_not_null_warehouse_customers_customer_id.ae7452c4c6"
[0m18:27:54.837035 [debug] [Thread-1 (]: Using postgres connection "test.dbt_idx.source_not_null_warehouse_customers_customer_id.ae7452c4c6"
[0m18:27:54.837035 [debug] [Thread-1 (]: On test.dbt_idx.source_not_null_warehouse_customers_customer_id.ae7452c4c6: BEGIN
[0m18:27:54.838071 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:27:54.859741 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m18:27:54.860245 [debug] [Thread-1 (]: Using postgres connection "test.dbt_idx.source_not_null_warehouse_customers_customer_id.ae7452c4c6"
[0m18:27:54.861255 [debug] [Thread-1 (]: On test.dbt_idx.source_not_null_warehouse_customers_customer_id.ae7452c4c6: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "test.dbt_idx.source_not_null_warehouse_customers_customer_id.ae7452c4c6"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select customer_id
from "IDX-Stock"."warehouse"."customers"
where customer_id is null



      
    ) dbt_internal_test
[0m18:27:54.864298 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m18:27:54.866288 [debug] [Thread-1 (]: Timing info for test.dbt_idx.source_not_null_warehouse_customers_customer_id.ae7452c4c6 (execute): 18:27:54.826959 => 18:27:54.866288
[0m18:27:54.867254 [debug] [Thread-1 (]: On test.dbt_idx.source_not_null_warehouse_customers_customer_id.ae7452c4c6: ROLLBACK
[0m18:27:54.869480 [debug] [Thread-1 (]: On test.dbt_idx.source_not_null_warehouse_customers_customer_id.ae7452c4c6: Close
[0m18:27:54.871018 [info ] [Thread-1 (]: 4 of 8 PASS source_not_null_warehouse_customers_customer_id .................... [[32mPASS[0m in 0.06s]
[0m18:27:54.873022 [debug] [Thread-1 (]: Finished running node test.dbt_idx.source_not_null_warehouse_customers_customer_id.ae7452c4c6
[0m18:27:54.874021 [debug] [Thread-1 (]: Began running node test.dbt_idx.source_not_null_warehouse_orders_order_id.c85a1f0b76
[0m18:27:54.875021 [info ] [Thread-1 (]: 5 of 8 START test source_not_null_warehouse_orders_order_id .................... [RUN]
[0m18:27:54.876019 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_idx.source_not_null_warehouse_customers_customer_id.ae7452c4c6, now test.dbt_idx.source_not_null_warehouse_orders_order_id.c85a1f0b76)
[0m18:27:54.877029 [debug] [Thread-1 (]: Began compiling node test.dbt_idx.source_not_null_warehouse_orders_order_id.c85a1f0b76
[0m18:27:54.881570 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_idx.source_not_null_warehouse_orders_order_id.c85a1f0b76"
[0m18:27:54.887769 [debug] [Thread-1 (]: Timing info for test.dbt_idx.source_not_null_warehouse_orders_order_id.c85a1f0b76 (compile): 18:27:54.878014 => 18:27:54.887769
[0m18:27:54.888769 [debug] [Thread-1 (]: Began executing node test.dbt_idx.source_not_null_warehouse_orders_order_id.c85a1f0b76
[0m18:27:54.893282 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_idx.source_not_null_warehouse_orders_order_id.c85a1f0b76"
[0m18:27:54.901804 [debug] [Thread-1 (]: Using postgres connection "test.dbt_idx.source_not_null_warehouse_orders_order_id.c85a1f0b76"
[0m18:27:54.902798 [debug] [Thread-1 (]: On test.dbt_idx.source_not_null_warehouse_orders_order_id.c85a1f0b76: BEGIN
[0m18:27:54.903813 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:27:54.927065 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m18:27:54.928006 [debug] [Thread-1 (]: Using postgres connection "test.dbt_idx.source_not_null_warehouse_orders_order_id.c85a1f0b76"
[0m18:27:54.929006 [debug] [Thread-1 (]: On test.dbt_idx.source_not_null_warehouse_orders_order_id.c85a1f0b76: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "test.dbt_idx.source_not_null_warehouse_orders_order_id.c85a1f0b76"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select order_id
from "IDX-Stock"."warehouse"."orders"
where order_id is null



      
    ) dbt_internal_test
[0m18:27:54.931200 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m18:27:54.933196 [debug] [Thread-1 (]: Timing info for test.dbt_idx.source_not_null_warehouse_orders_order_id.c85a1f0b76 (execute): 18:27:54.888769 => 18:27:54.933196
[0m18:27:54.934196 [debug] [Thread-1 (]: On test.dbt_idx.source_not_null_warehouse_orders_order_id.c85a1f0b76: ROLLBACK
[0m18:27:54.936208 [debug] [Thread-1 (]: On test.dbt_idx.source_not_null_warehouse_orders_order_id.c85a1f0b76: Close
[0m18:27:54.938216 [info ] [Thread-1 (]: 5 of 8 PASS source_not_null_warehouse_orders_order_id .......................... [[32mPASS[0m in 0.06s]
[0m18:27:54.940700 [debug] [Thread-1 (]: Finished running node test.dbt_idx.source_not_null_warehouse_orders_order_id.c85a1f0b76
[0m18:27:54.941730 [debug] [Thread-1 (]: Began running node test.dbt_idx.source_relationships_warehouse_orders_cust_id__customer_id__source_warehouse_customers_.d3f9188fc2
[0m18:27:54.942736 [info ] [Thread-1 (]: 6 of 8 START test source_relationships_warehouse_orders_cust_id__customer_id__source_warehouse_customers_  [RUN]
[0m18:27:54.944744 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_idx.source_not_null_warehouse_orders_order_id.c85a1f0b76, now test.dbt_idx.source_relationships_warehouse_orders_cust_id__customer_id__source_warehouse_customers_.d3f9188fc2)
[0m18:27:54.945737 [debug] [Thread-1 (]: Began compiling node test.dbt_idx.source_relationships_warehouse_orders_cust_id__customer_id__source_warehouse_customers_.d3f9188fc2
[0m18:27:54.956302 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_idx.source_relationships_warehouse_orders_cust_id__customer_id__source_warehouse_customers_.d3f9188fc2"
[0m18:27:54.963852 [debug] [Thread-1 (]: Timing info for test.dbt_idx.source_relationships_warehouse_orders_cust_id__customer_id__source_warehouse_customers_.d3f9188fc2 (compile): 18:27:54.945737 => 18:27:54.962884
[0m18:27:54.963852 [debug] [Thread-1 (]: Began executing node test.dbt_idx.source_relationships_warehouse_orders_cust_id__customer_id__source_warehouse_customers_.d3f9188fc2
[0m18:27:54.966851 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_idx.source_relationships_warehouse_orders_cust_id__customer_id__source_warehouse_customers_.d3f9188fc2"
[0m18:27:54.972839 [debug] [Thread-1 (]: Using postgres connection "test.dbt_idx.source_relationships_warehouse_orders_cust_id__customer_id__source_warehouse_customers_.d3f9188fc2"
[0m18:27:54.973896 [debug] [Thread-1 (]: On test.dbt_idx.source_relationships_warehouse_orders_cust_id__customer_id__source_warehouse_customers_.d3f9188fc2: BEGIN
[0m18:27:54.974905 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:27:54.999173 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m18:27:55.000214 [debug] [Thread-1 (]: Using postgres connection "test.dbt_idx.source_relationships_warehouse_orders_cust_id__customer_id__source_warehouse_customers_.d3f9188fc2"
[0m18:27:55.001565 [debug] [Thread-1 (]: On test.dbt_idx.source_relationships_warehouse_orders_cust_id__customer_id__source_warehouse_customers_.d3f9188fc2: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "test.dbt_idx.source_relationships_warehouse_orders_cust_id__customer_id__source_warehouse_customers_.d3f9188fc2"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select cust_id as from_field
    from "IDX-Stock"."warehouse"."orders"
    where cust_id is not null
),

parent as (
    select customer_id as to_field
    from "IDX-Stock"."warehouse"."customers"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m18:27:55.004563 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m18:27:55.006518 [debug] [Thread-1 (]: Timing info for test.dbt_idx.source_relationships_warehouse_orders_cust_id__customer_id__source_warehouse_customers_.d3f9188fc2 (execute): 18:27:54.964852 => 18:27:55.006518
[0m18:27:55.007554 [debug] [Thread-1 (]: On test.dbt_idx.source_relationships_warehouse_orders_cust_id__customer_id__source_warehouse_customers_.d3f9188fc2: ROLLBACK
[0m18:27:55.010166 [debug] [Thread-1 (]: On test.dbt_idx.source_relationships_warehouse_orders_cust_id__customer_id__source_warehouse_customers_.d3f9188fc2: Close
[0m18:27:55.012057 [info ] [Thread-1 (]: 6 of 8 PASS source_relationships_warehouse_orders_cust_id__customer_id__source_warehouse_customers_  [[32mPASS[0m in 0.07s]
[0m18:27:55.015052 [debug] [Thread-1 (]: Finished running node test.dbt_idx.source_relationships_warehouse_orders_cust_id__customer_id__source_warehouse_customers_.d3f9188fc2
[0m18:27:55.016050 [debug] [Thread-1 (]: Began running node test.dbt_idx.source_unique_warehouse_orders_order_id.839fb43d0f
[0m18:27:55.017056 [info ] [Thread-1 (]: 7 of 8 START test source_unique_warehouse_orders_order_id ...................... [RUN]
[0m18:27:55.018858 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_idx.source_relationships_warehouse_orders_cust_id__customer_id__source_warehouse_customers_.d3f9188fc2, now test.dbt_idx.source_unique_warehouse_orders_order_id.839fb43d0f)
[0m18:27:55.019919 [debug] [Thread-1 (]: Began compiling node test.dbt_idx.source_unique_warehouse_orders_order_id.839fb43d0f
[0m18:27:55.027908 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_idx.source_unique_warehouse_orders_order_id.839fb43d0f"
[0m18:27:55.035164 [debug] [Thread-1 (]: Timing info for test.dbt_idx.source_unique_warehouse_orders_order_id.839fb43d0f (compile): 18:27:55.019919 => 18:27:55.035164
[0m18:27:55.036219 [debug] [Thread-1 (]: Began executing node test.dbt_idx.source_unique_warehouse_orders_order_id.839fb43d0f
[0m18:27:55.040200 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_idx.source_unique_warehouse_orders_order_id.839fb43d0f"
[0m18:27:55.047454 [debug] [Thread-1 (]: Using postgres connection "test.dbt_idx.source_unique_warehouse_orders_order_id.839fb43d0f"
[0m18:27:55.048453 [debug] [Thread-1 (]: On test.dbt_idx.source_unique_warehouse_orders_order_id.839fb43d0f: BEGIN
[0m18:27:55.050090 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:27:55.076215 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m18:27:55.078213 [debug] [Thread-1 (]: Using postgres connection "test.dbt_idx.source_unique_warehouse_orders_order_id.839fb43d0f"
[0m18:27:55.079212 [debug] [Thread-1 (]: On test.dbt_idx.source_unique_warehouse_orders_order_id.839fb43d0f: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "test.dbt_idx.source_unique_warehouse_orders_order_id.839fb43d0f"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    order_id as unique_field,
    count(*) as n_records

from "IDX-Stock"."warehouse"."orders"
where order_id is not null
group by order_id
having count(*) > 1



      
    ) dbt_internal_test
[0m18:27:55.086464 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m18:27:55.088463 [debug] [Thread-1 (]: Timing info for test.dbt_idx.source_unique_warehouse_orders_order_id.839fb43d0f (execute): 18:27:55.037201 => 18:27:55.088463
[0m18:27:55.088463 [debug] [Thread-1 (]: On test.dbt_idx.source_unique_warehouse_orders_order_id.839fb43d0f: ROLLBACK
[0m18:27:55.091986 [debug] [Thread-1 (]: On test.dbt_idx.source_unique_warehouse_orders_order_id.839fb43d0f: Close
[0m18:27:55.096001 [info ] [Thread-1 (]: 7 of 8 PASS source_unique_warehouse_orders_order_id ............................ [[32mPASS[0m in 0.08s]
[0m18:27:55.099008 [debug] [Thread-1 (]: Finished running node test.dbt_idx.source_unique_warehouse_orders_order_id.839fb43d0f
[0m18:27:55.100005 [debug] [Thread-1 (]: Began running node test.dbt_idx.unique_customer_orders_status_order_id.b7a45e83ee
[0m18:27:55.102155 [info ] [Thread-1 (]: 8 of 8 START test unique_customer_orders_status_order_id ....................... [RUN]
[0m18:27:55.104147 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_idx.source_unique_warehouse_orders_order_id.839fb43d0f, now test.dbt_idx.unique_customer_orders_status_order_id.b7a45e83ee)
[0m18:27:55.105149 [debug] [Thread-1 (]: Began compiling node test.dbt_idx.unique_customer_orders_status_order_id.b7a45e83ee
[0m18:27:55.113987 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_idx.unique_customer_orders_status_order_id.b7a45e83ee"
[0m18:27:55.123996 [debug] [Thread-1 (]: Timing info for test.dbt_idx.unique_customer_orders_status_order_id.b7a45e83ee (compile): 18:27:55.107147 => 18:27:55.123996
[0m18:27:55.125996 [debug] [Thread-1 (]: Began executing node test.dbt_idx.unique_customer_orders_status_order_id.b7a45e83ee
[0m18:27:55.130515 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_idx.unique_customer_orders_status_order_id.b7a45e83ee"
[0m18:27:55.140047 [debug] [Thread-1 (]: Using postgres connection "test.dbt_idx.unique_customer_orders_status_order_id.b7a45e83ee"
[0m18:27:55.142062 [debug] [Thread-1 (]: On test.dbt_idx.unique_customer_orders_status_order_id.b7a45e83ee: BEGIN
[0m18:27:55.143063 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:27:55.173825 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m18:27:55.175823 [debug] [Thread-1 (]: Using postgres connection "test.dbt_idx.unique_customer_orders_status_order_id.b7a45e83ee"
[0m18:27:55.177320 [debug] [Thread-1 (]: On test.dbt_idx.unique_customer_orders_status_order_id.b7a45e83ee: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "test.dbt_idx.unique_customer_orders_status_order_id.b7a45e83ee"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    order_id as unique_field,
    count(*) as n_records

from "IDX-Stock"."warehouse"."customer_orders_status"
where order_id is not null
group by order_id
having count(*) > 1



      
    ) dbt_internal_test
[0m18:27:55.184864 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m18:27:55.188864 [debug] [Thread-1 (]: Timing info for test.dbt_idx.unique_customer_orders_status_order_id.b7a45e83ee (execute): 18:27:55.126997 => 18:27:55.187880
[0m18:27:55.189867 [debug] [Thread-1 (]: On test.dbt_idx.unique_customer_orders_status_order_id.b7a45e83ee: ROLLBACK
[0m18:27:55.193452 [debug] [Thread-1 (]: On test.dbt_idx.unique_customer_orders_status_order_id.b7a45e83ee: Close
[0m18:27:55.195459 [info ] [Thread-1 (]: 8 of 8 PASS unique_customer_orders_status_order_id ............................. [[32mPASS[0m in 0.09s]
[0m18:27:55.198459 [debug] [Thread-1 (]: Finished running node test.dbt_idx.unique_customer_orders_status_order_id.b7a45e83ee
[0m18:27:55.203986 [debug] [MainThread]: Using postgres connection "master"
[0m18:27:55.204997 [debug] [MainThread]: On master: BEGIN
[0m18:27:55.206988 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:27:55.235517 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m18:27:55.236517 [debug] [MainThread]: On master: COMMIT
[0m18:27:55.237522 [debug] [MainThread]: Using postgres connection "master"
[0m18:27:55.238519 [debug] [MainThread]: On master: COMMIT
[0m18:27:55.242044 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m18:27:55.244041 [debug] [MainThread]: On master: Close
[0m18:27:55.245050 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:27:55.247080 [debug] [MainThread]: Connection 'list_IDX-Stock_warehouse' was properly closed.
[0m18:27:55.248063 [debug] [MainThread]: Connection 'test.dbt_idx.unique_customer_orders_status_order_id.b7a45e83ee' was properly closed.
[0m18:27:55.250038 [info ] [MainThread]: 
[0m18:27:55.251352 [info ] [MainThread]: Finished running 8 tests in 0 hours 0 minutes and 0.87 seconds (0.87s).
[0m18:27:55.255394 [debug] [MainThread]: Command end result
[0m18:27:55.281707 [info ] [MainThread]: 
[0m18:27:55.283674 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:27:55.285674 [info ] [MainThread]: 
[0m18:27:55.286672 [info ] [MainThread]: Done. PASS=8 WARN=0 ERROR=0 SKIP=0 TOTAL=8
[0m18:27:55.288343 [debug] [MainThread]: Command `dbt test` succeeded at 18:27:55.287303 after 1.44 seconds
[0m18:27:55.288343 [debug] [MainThread]: Flushing usage events


============================== 18:28:26.931223 | bcabaad3-2f5a-49ee-8ccb-d66e00d247c0 ==============================
[0m18:28:26.931223 [info ] [MainThread]: Running with dbt=1.6.1
[0m18:28:26.936193 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': 'D:\\00 Project\\00 My Project\\IdeaProjects\\Py-DBT-IDX', 'log_path': 'D:\\00 Project\\00 My Project\\IdeaProjects\\Py-DBT-IDX\\logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt test', 'send_anonymous_usage_stats': 'False'}
[0m18:28:27.067813 [info ] [MainThread]: Registered adapter: postgres=1.6.1
[0m18:28:27.078428 [debug] [MainThread]: checksum: efe19d9f5b93d1a98cc804fbfcdb6b3aced98b974af664946fee1cde8837deb7, vars: {}, profile: , target: , version: 1.6.1
[0m18:28:27.227844 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m18:28:27.228817 [debug] [MainThread]: Partial parsing: updated file: dbt_idx://tests\assert_customer_dimension_has_no_row_loss.sql.sql
[0m18:28:27.298996 [info ] [MainThread]: Found 1 snapshot, 9 tests, 7 models, 3 sources, 0 exposures, 0 metrics, 349 macros, 0 groups, 0 semantic models
[0m18:28:27.302380 [info ] [MainThread]: 
[0m18:28:27.304380 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m18:28:27.307381 [debug] [ThreadPool]: Acquiring new postgres connection 'list_IDX-Stock_warehouse'
[0m18:28:27.324426 [debug] [ThreadPool]: Using postgres connection "list_IDX-Stock_warehouse"
[0m18:28:27.324426 [debug] [ThreadPool]: On list_IDX-Stock_warehouse: BEGIN
[0m18:28:27.325425 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:28:27.358826 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m18:28:27.359827 [debug] [ThreadPool]: Using postgres connection "list_IDX-Stock_warehouse"
[0m18:28:27.360332 [debug] [ThreadPool]: On list_IDX-Stock_warehouse: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "connection_name": "list_IDX-Stock_warehouse"} */
select
      'IDX-Stock' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'warehouse'
    union all
    select
      'IDX-Stock' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'warehouse'
    union all
    select
      'IDX-Stock' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'warehouse'
  
[0m18:28:27.366716 [debug] [ThreadPool]: SQL status: SELECT 11 in 0.0 seconds
[0m18:28:27.369388 [debug] [ThreadPool]: On list_IDX-Stock_warehouse: ROLLBACK
[0m18:28:27.372186 [debug] [ThreadPool]: On list_IDX-Stock_warehouse: Close
[0m18:28:27.375093 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_IDX-Stock_warehouse, now list_IDX-Stock_snapshots)
[0m18:28:27.383323 [debug] [ThreadPool]: Using postgres connection "list_IDX-Stock_snapshots"
[0m18:28:27.384326 [debug] [ThreadPool]: On list_IDX-Stock_snapshots: BEGIN
[0m18:28:27.385350 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:28:27.407464 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m18:28:27.408510 [debug] [ThreadPool]: Using postgres connection "list_IDX-Stock_snapshots"
[0m18:28:27.408510 [debug] [ThreadPool]: On list_IDX-Stock_snapshots: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "connection_name": "list_IDX-Stock_snapshots"} */
select
      'IDX-Stock' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'snapshots'
    union all
    select
      'IDX-Stock' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'snapshots'
    union all
    select
      'IDX-Stock' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'snapshots'
  
[0m18:28:27.414069 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.0 seconds
[0m18:28:27.416096 [debug] [ThreadPool]: On list_IDX-Stock_snapshots: ROLLBACK
[0m18:28:27.419083 [debug] [ThreadPool]: On list_IDX-Stock_snapshots: Close
[0m18:28:27.427492 [debug] [MainThread]: Using postgres connection "master"
[0m18:28:27.428545 [debug] [MainThread]: On master: BEGIN
[0m18:28:27.428545 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:28:27.451181 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m18:28:27.452159 [debug] [MainThread]: Using postgres connection "master"
[0m18:28:27.453173 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m18:28:27.459753 [debug] [MainThread]: SQL status: SELECT 6 in 0.0 seconds
[0m18:28:27.463978 [debug] [MainThread]: On master: ROLLBACK
[0m18:28:27.465951 [debug] [MainThread]: Using postgres connection "master"
[0m18:28:27.466962 [debug] [MainThread]: On master: BEGIN
[0m18:28:27.470050 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m18:28:27.471010 [debug] [MainThread]: On master: COMMIT
[0m18:28:27.471997 [debug] [MainThread]: Using postgres connection "master"
[0m18:28:27.472976 [debug] [MainThread]: On master: COMMIT
[0m18:28:27.474994 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m18:28:27.476006 [debug] [MainThread]: On master: Close
[0m18:28:27.477050 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:28:27.478993 [info ] [MainThread]: 
[0m18:28:27.485109 [debug] [Thread-1 (]: Began running node test.dbt_idx.accepted_values_customer_orders_status_order_status__delivered__invoiced__shipped__processing__canceled__unavailable.ea8c296d27
[0m18:28:27.487111 [info ] [Thread-1 (]: 1 of 9 START test accepted_values_customer_orders_status_order_status__delivered__invoiced__shipped__processing__canceled__unavailable  [RUN]
[0m18:28:27.488103 [debug] [Thread-1 (]: Acquiring new postgres connection 'test.dbt_idx.accepted_values_customer_orders_status_order_status__delivered__invoiced__shipped__processing__canceled__unavailable.ea8c296d27'
[0m18:28:27.489644 [debug] [Thread-1 (]: Began compiling node test.dbt_idx.accepted_values_customer_orders_status_order_status__delivered__invoiced__shipped__processing__canceled__unavailable.ea8c296d27
[0m18:28:27.508361 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_idx.accepted_values_customer_orders_status_order_status__delivered__invoiced__shipped__processing__canceled__unavailable.ea8c296d27"
[0m18:28:27.518147 [debug] [Thread-1 (]: Timing info for test.dbt_idx.accepted_values_customer_orders_status_order_status__delivered__invoiced__shipped__processing__canceled__unavailable.ea8c296d27 (compile): 18:28:27.489816 => 18:28:27.518147
[0m18:28:27.519147 [debug] [Thread-1 (]: Began executing node test.dbt_idx.accepted_values_customer_orders_status_order_status__delivered__invoiced__shipped__processing__canceled__unavailable.ea8c296d27
[0m18:28:27.547103 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_idx.accepted_values_customer_orders_status_order_status__delivered__invoiced__shipped__processing__canceled__unavailable.ea8c296d27"
[0m18:28:27.557815 [debug] [Thread-1 (]: Using postgres connection "test.dbt_idx.accepted_values_customer_orders_status_order_status__delivered__invoiced__shipped__processing__canceled__unavailable.ea8c296d27"
[0m18:28:27.560097 [debug] [Thread-1 (]: On test.dbt_idx.accepted_values_customer_orders_status_order_status__delivered__invoiced__shipped__processing__canceled__unavailable.ea8c296d27: BEGIN
[0m18:28:27.561188 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m18:28:27.590847 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m18:28:27.592839 [debug] [Thread-1 (]: Using postgres connection "test.dbt_idx.accepted_values_customer_orders_status_order_status__delivered__invoiced__shipped__processing__canceled__unavailable.ea8c296d27"
[0m18:28:27.594847 [debug] [Thread-1 (]: On test.dbt_idx.accepted_values_customer_orders_status_order_status__delivered__invoiced__shipped__processing__canceled__unavailable.ea8c296d27: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "test.dbt_idx.accepted_values_customer_orders_status_order_status__delivered__invoiced__shipped__processing__canceled__unavailable.ea8c296d27"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        order_status as value_field,
        count(*) as n_records

    from "IDX-Stock"."warehouse"."customer_orders_status"
    group by order_status

)

select *
from all_values
where value_field not in (
    'delivered','invoiced','shipped','processing','canceled','unavailable'
)



      
    ) dbt_internal_test
[0m18:28:27.602079 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m18:28:27.606083 [debug] [Thread-1 (]: Timing info for test.dbt_idx.accepted_values_customer_orders_status_order_status__delivered__invoiced__shipped__processing__canceled__unavailable.ea8c296d27 (execute): 18:28:27.520183 => 18:28:27.606083
[0m18:28:27.608083 [debug] [Thread-1 (]: On test.dbt_idx.accepted_values_customer_orders_status_order_status__delivered__invoiced__shipped__processing__canceled__unavailable.ea8c296d27: ROLLBACK
[0m18:28:27.610082 [debug] [Thread-1 (]: On test.dbt_idx.accepted_values_customer_orders_status_order_status__delivered__invoiced__shipped__processing__canceled__unavailable.ea8c296d27: Close
[0m18:28:27.613468 [info ] [Thread-1 (]: 1 of 9 PASS accepted_values_customer_orders_status_order_status__delivered__invoiced__shipped__processing__canceled__unavailable  [[32mPASS[0m in 0.12s]
[0m18:28:27.615473 [debug] [Thread-1 (]: Finished running node test.dbt_idx.accepted_values_customer_orders_status_order_status__delivered__invoiced__shipped__processing__canceled__unavailable.ea8c296d27
[0m18:28:27.616473 [debug] [Thread-1 (]: Began running node test.dbt_idx.assert_customer_dimension_has_no_row_loss.sql
[0m18:28:27.617506 [info ] [Thread-1 (]: 2 of 9 START test assert_customer_dimension_has_no_row_loss.sql ................ [RUN]
[0m18:28:27.618466 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_idx.accepted_values_customer_orders_status_order_status__delivered__invoiced__shipped__processing__canceled__unavailable.ea8c296d27, now test.dbt_idx.assert_customer_dimension_has_no_row_loss.sql)
[0m18:28:27.620996 [debug] [Thread-1 (]: Began compiling node test.dbt_idx.assert_customer_dimension_has_no_row_loss.sql
[0m18:28:27.626019 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_idx.assert_customer_dimension_has_no_row_loss.sql"
[0m18:28:27.636135 [debug] [Thread-1 (]: Timing info for test.dbt_idx.assert_customer_dimension_has_no_row_loss.sql (compile): 18:28:27.621992 => 18:28:27.635138
[0m18:28:27.637177 [debug] [Thread-1 (]: Began executing node test.dbt_idx.assert_customer_dimension_has_no_row_loss.sql
[0m18:28:27.643667 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_idx.assert_customer_dimension_has_no_row_loss.sql"
[0m18:28:27.654762 [debug] [Thread-1 (]: Using postgres connection "test.dbt_idx.assert_customer_dimension_has_no_row_loss.sql"
[0m18:28:27.655778 [debug] [Thread-1 (]: On test.dbt_idx.assert_customer_dimension_has_no_row_loss.sql: BEGIN
[0m18:28:27.658187 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:28:27.693850 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m18:28:27.694852 [debug] [Thread-1 (]: Using postgres connection "test.dbt_idx.assert_customer_dimension_has_no_row_loss.sql"
[0m18:28:27.695847 [debug] [Thread-1 (]: On test.dbt_idx.assert_customer_dimension_has_no_row_loss.sql: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "test.dbt_idx.assert_customer_dimension_has_no_row_loss.sql"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      -- dim_customers must have the same number of rows as its staging counterpart
-- Therefore return records where this isn't true to make the test fail
select *
from (
         select dim_cust.customer_id
         from "IDX-Stock"."warehouse"."dim_customers" dim_cust
            inner join "IDX-Stock"."warehouse"."stg_eltool__customers_snapshots" stg_cust
         on dim_cust.customer_id = stg_cust.customer_id
         where stg_cust.customer_id is null
         UNION ALL
         select stg_cust.customer_id
         from "IDX-Stock"."warehouse"."stg_eltool__customers_snapshots" stg_cust
             inner join "IDX-Stock"."warehouse"."dim_customers" dim_cust
         on stg_cust.customer_id = dim_cust.customer_id
         where dim_cust.customer_id is null
     ) tmp
      
    ) dbt_internal_test
[0m18:28:27.701454 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m18:28:27.705981 [debug] [Thread-1 (]: Timing info for test.dbt_idx.assert_customer_dimension_has_no_row_loss.sql (execute): 18:28:27.639148 => 18:28:27.704993
[0m18:28:27.707693 [debug] [Thread-1 (]: On test.dbt_idx.assert_customer_dimension_has_no_row_loss.sql: ROLLBACK
[0m18:28:27.712098 [debug] [Thread-1 (]: On test.dbt_idx.assert_customer_dimension_has_no_row_loss.sql: Close
[0m18:28:27.716036 [info ] [Thread-1 (]: 2 of 9 PASS assert_customer_dimension_has_no_row_loss.sql ...................... [[32mPASS[0m in 0.10s]
[0m18:28:27.718923 [debug] [Thread-1 (]: Finished running node test.dbt_idx.assert_customer_dimension_has_no_row_loss.sql
[0m18:28:27.721261 [debug] [Thread-1 (]: Began running node test.dbt_idx.not_null_customer_orders_status_customer_id.3915c814eb
[0m18:28:27.723396 [info ] [Thread-1 (]: 3 of 9 START test not_null_customer_orders_status_customer_id .................. [RUN]
[0m18:28:27.725797 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_idx.assert_customer_dimension_has_no_row_loss.sql, now test.dbt_idx.not_null_customer_orders_status_customer_id.3915c814eb)
[0m18:28:27.726827 [debug] [Thread-1 (]: Began compiling node test.dbt_idx.not_null_customer_orders_status_customer_id.3915c814eb
[0m18:28:27.737328 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_idx.not_null_customer_orders_status_customer_id.3915c814eb"
[0m18:28:27.745901 [debug] [Thread-1 (]: Timing info for test.dbt_idx.not_null_customer_orders_status_customer_id.3915c814eb (compile): 18:28:27.727912 => 18:28:27.744891
[0m18:28:27.746893 [debug] [Thread-1 (]: Began executing node test.dbt_idx.not_null_customer_orders_status_customer_id.3915c814eb
[0m18:28:27.749974 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_idx.not_null_customer_orders_status_customer_id.3915c814eb"
[0m18:28:27.756923 [debug] [Thread-1 (]: Using postgres connection "test.dbt_idx.not_null_customer_orders_status_customer_id.3915c814eb"
[0m18:28:27.758437 [debug] [Thread-1 (]: On test.dbt_idx.not_null_customer_orders_status_customer_id.3915c814eb: BEGIN
[0m18:28:27.759957 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:28:27.784288 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m18:28:27.785313 [debug] [Thread-1 (]: Using postgres connection "test.dbt_idx.not_null_customer_orders_status_customer_id.3915c814eb"
[0m18:28:27.786287 [debug] [Thread-1 (]: On test.dbt_idx.not_null_customer_orders_status_customer_id.3915c814eb: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "test.dbt_idx.not_null_customer_orders_status_customer_id.3915c814eb"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select customer_id
from "IDX-Stock"."warehouse"."customer_orders_status"
where customer_id is null



      
    ) dbt_internal_test
[0m18:28:27.791837 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m18:28:27.794408 [debug] [Thread-1 (]: Timing info for test.dbt_idx.not_null_customer_orders_status_customer_id.3915c814eb (execute): 18:28:27.747892 => 18:28:27.794408
[0m18:28:27.796379 [debug] [Thread-1 (]: On test.dbt_idx.not_null_customer_orders_status_customer_id.3915c814eb: ROLLBACK
[0m18:28:27.798378 [debug] [Thread-1 (]: On test.dbt_idx.not_null_customer_orders_status_customer_id.3915c814eb: Close
[0m18:28:27.801903 [info ] [Thread-1 (]: 3 of 9 PASS not_null_customer_orders_status_customer_id ........................ [[32mPASS[0m in 0.08s]
[0m18:28:27.803912 [debug] [Thread-1 (]: Finished running node test.dbt_idx.not_null_customer_orders_status_customer_id.3915c814eb
[0m18:28:27.805929 [debug] [Thread-1 (]: Began running node test.dbt_idx.not_null_stg_eltool__customers_snapshots_customer_id.ea4fc4ca86
[0m18:28:27.806916 [info ] [Thread-1 (]: 4 of 9 START test not_null_stg_eltool__customers_snapshots_customer_id ......... [RUN]
[0m18:28:27.808916 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_idx.not_null_customer_orders_status_customer_id.3915c814eb, now test.dbt_idx.not_null_stg_eltool__customers_snapshots_customer_id.ea4fc4ca86)
[0m18:28:27.809916 [debug] [Thread-1 (]: Began compiling node test.dbt_idx.not_null_stg_eltool__customers_snapshots_customer_id.ea4fc4ca86
[0m18:28:27.822669 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_idx.not_null_stg_eltool__customers_snapshots_customer_id.ea4fc4ca86"
[0m18:28:27.832697 [debug] [Thread-1 (]: Timing info for test.dbt_idx.not_null_stg_eltool__customers_snapshots_customer_id.ea4fc4ca86 (compile): 18:28:27.811281 => 18:28:27.831688
[0m18:28:27.833702 [debug] [Thread-1 (]: Began executing node test.dbt_idx.not_null_stg_eltool__customers_snapshots_customer_id.ea4fc4ca86
[0m18:28:27.837206 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_idx.not_null_stg_eltool__customers_snapshots_customer_id.ea4fc4ca86"
[0m18:28:27.845747 [debug] [Thread-1 (]: Using postgres connection "test.dbt_idx.not_null_stg_eltool__customers_snapshots_customer_id.ea4fc4ca86"
[0m18:28:27.846735 [debug] [Thread-1 (]: On test.dbt_idx.not_null_stg_eltool__customers_snapshots_customer_id.ea4fc4ca86: BEGIN
[0m18:28:27.847734 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:28:27.871074 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m18:28:27.873074 [debug] [Thread-1 (]: Using postgres connection "test.dbt_idx.not_null_stg_eltool__customers_snapshots_customer_id.ea4fc4ca86"
[0m18:28:27.874072 [debug] [Thread-1 (]: On test.dbt_idx.not_null_stg_eltool__customers_snapshots_customer_id.ea4fc4ca86: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "test.dbt_idx.not_null_stg_eltool__customers_snapshots_customer_id.ea4fc4ca86"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select customer_id
from "IDX-Stock"."warehouse"."stg_eltool__customers_snapshots"
where customer_id is null



      
    ) dbt_internal_test
[0m18:28:27.878078 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m18:28:27.880579 [debug] [Thread-1 (]: Timing info for test.dbt_idx.not_null_stg_eltool__customers_snapshots_customer_id.ea4fc4ca86 (execute): 18:28:27.834700 => 18:28:27.880579
[0m18:28:27.881585 [debug] [Thread-1 (]: On test.dbt_idx.not_null_stg_eltool__customers_snapshots_customer_id.ea4fc4ca86: ROLLBACK
[0m18:28:27.883587 [debug] [Thread-1 (]: On test.dbt_idx.not_null_stg_eltool__customers_snapshots_customer_id.ea4fc4ca86: Close
[0m18:28:27.885590 [info ] [Thread-1 (]: 4 of 9 PASS not_null_stg_eltool__customers_snapshots_customer_id ............... [[32mPASS[0m in 0.08s]
[0m18:28:27.887587 [debug] [Thread-1 (]: Finished running node test.dbt_idx.not_null_stg_eltool__customers_snapshots_customer_id.ea4fc4ca86
[0m18:28:27.888584 [debug] [Thread-1 (]: Began running node test.dbt_idx.source_not_null_warehouse_customers_customer_id.ae7452c4c6
[0m18:28:27.888584 [info ] [Thread-1 (]: 5 of 9 START test source_not_null_warehouse_customers_customer_id .............. [RUN]
[0m18:28:27.890091 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_idx.not_null_stg_eltool__customers_snapshots_customer_id.ea4fc4ca86, now test.dbt_idx.source_not_null_warehouse_customers_customer_id.ae7452c4c6)
[0m18:28:27.891097 [debug] [Thread-1 (]: Began compiling node test.dbt_idx.source_not_null_warehouse_customers_customer_id.ae7452c4c6
[0m18:28:27.896098 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_idx.source_not_null_warehouse_customers_customer_id.ae7452c4c6"
[0m18:28:27.903311 [debug] [Thread-1 (]: Timing info for test.dbt_idx.source_not_null_warehouse_customers_customer_id.ae7452c4c6 (compile): 18:28:27.892096 => 18:28:27.903311
[0m18:28:27.904309 [debug] [Thread-1 (]: Began executing node test.dbt_idx.source_not_null_warehouse_customers_customer_id.ae7452c4c6
[0m18:28:27.908307 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_idx.source_not_null_warehouse_customers_customer_id.ae7452c4c6"
[0m18:28:27.915820 [debug] [Thread-1 (]: Using postgres connection "test.dbt_idx.source_not_null_warehouse_customers_customer_id.ae7452c4c6"
[0m18:28:27.916820 [debug] [Thread-1 (]: On test.dbt_idx.source_not_null_warehouse_customers_customer_id.ae7452c4c6: BEGIN
[0m18:28:27.917821 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:28:27.939931 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m18:28:27.941158 [debug] [Thread-1 (]: Using postgres connection "test.dbt_idx.source_not_null_warehouse_customers_customer_id.ae7452c4c6"
[0m18:28:27.942183 [debug] [Thread-1 (]: On test.dbt_idx.source_not_null_warehouse_customers_customer_id.ae7452c4c6: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "test.dbt_idx.source_not_null_warehouse_customers_customer_id.ae7452c4c6"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select customer_id
from "IDX-Stock"."warehouse"."customers"
where customer_id is null



      
    ) dbt_internal_test
[0m18:28:27.945166 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m18:28:27.947229 [debug] [Thread-1 (]: Timing info for test.dbt_idx.source_not_null_warehouse_customers_customer_id.ae7452c4c6 (execute): 18:28:27.905307 => 18:28:27.946201
[0m18:28:27.947229 [debug] [Thread-1 (]: On test.dbt_idx.source_not_null_warehouse_customers_customer_id.ae7452c4c6: ROLLBACK
[0m18:28:27.949707 [debug] [Thread-1 (]: On test.dbt_idx.source_not_null_warehouse_customers_customer_id.ae7452c4c6: Close
[0m18:28:27.951718 [info ] [Thread-1 (]: 5 of 9 PASS source_not_null_warehouse_customers_customer_id .................... [[32mPASS[0m in 0.06s]
[0m18:28:27.953732 [debug] [Thread-1 (]: Finished running node test.dbt_idx.source_not_null_warehouse_customers_customer_id.ae7452c4c6
[0m18:28:27.954742 [debug] [Thread-1 (]: Began running node test.dbt_idx.source_not_null_warehouse_orders_order_id.c85a1f0b76
[0m18:28:27.955712 [info ] [Thread-1 (]: 6 of 9 START test source_not_null_warehouse_orders_order_id .................... [RUN]
[0m18:28:27.956716 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_idx.source_not_null_warehouse_customers_customer_id.ae7452c4c6, now test.dbt_idx.source_not_null_warehouse_orders_order_id.c85a1f0b76)
[0m18:28:27.957715 [debug] [Thread-1 (]: Began compiling node test.dbt_idx.source_not_null_warehouse_orders_order_id.c85a1f0b76
[0m18:28:27.964334 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_idx.source_not_null_warehouse_orders_order_id.c85a1f0b76"
[0m18:28:27.972838 [debug] [Thread-1 (]: Timing info for test.dbt_idx.source_not_null_warehouse_orders_order_id.c85a1f0b76 (compile): 18:28:27.957715 => 18:28:27.971832
[0m18:28:27.973837 [debug] [Thread-1 (]: Began executing node test.dbt_idx.source_not_null_warehouse_orders_order_id.c85a1f0b76
[0m18:28:27.976838 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_idx.source_not_null_warehouse_orders_order_id.c85a1f0b76"
[0m18:28:27.982933 [debug] [Thread-1 (]: Using postgres connection "test.dbt_idx.source_not_null_warehouse_orders_order_id.c85a1f0b76"
[0m18:28:27.983932 [debug] [Thread-1 (]: On test.dbt_idx.source_not_null_warehouse_orders_order_id.c85a1f0b76: BEGIN
[0m18:28:27.984942 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:28:28.007297 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m18:28:28.008329 [debug] [Thread-1 (]: Using postgres connection "test.dbt_idx.source_not_null_warehouse_orders_order_id.c85a1f0b76"
[0m18:28:28.008329 [debug] [Thread-1 (]: On test.dbt_idx.source_not_null_warehouse_orders_order_id.c85a1f0b76: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "test.dbt_idx.source_not_null_warehouse_orders_order_id.c85a1f0b76"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select order_id
from "IDX-Stock"."warehouse"."orders"
where order_id is null



      
    ) dbt_internal_test
[0m18:28:28.011937 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m18:28:28.013943 [debug] [Thread-1 (]: Timing info for test.dbt_idx.source_not_null_warehouse_orders_order_id.c85a1f0b76 (execute): 18:28:27.973837 => 18:28:28.013943
[0m18:28:28.014924 [debug] [Thread-1 (]: On test.dbt_idx.source_not_null_warehouse_orders_order_id.c85a1f0b76: ROLLBACK
[0m18:28:28.017921 [debug] [Thread-1 (]: On test.dbt_idx.source_not_null_warehouse_orders_order_id.c85a1f0b76: Close
[0m18:28:28.019942 [info ] [Thread-1 (]: 6 of 9 PASS source_not_null_warehouse_orders_order_id .......................... [[32mPASS[0m in 0.06s]
[0m18:28:28.022145 [debug] [Thread-1 (]: Finished running node test.dbt_idx.source_not_null_warehouse_orders_order_id.c85a1f0b76
[0m18:28:28.024148 [debug] [Thread-1 (]: Began running node test.dbt_idx.source_relationships_warehouse_orders_cust_id__customer_id__source_warehouse_customers_.d3f9188fc2
[0m18:28:28.025141 [info ] [Thread-1 (]: 7 of 9 START test source_relationships_warehouse_orders_cust_id__customer_id__source_warehouse_customers_  [RUN]
[0m18:28:28.027157 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_idx.source_not_null_warehouse_orders_order_id.c85a1f0b76, now test.dbt_idx.source_relationships_warehouse_orders_cust_id__customer_id__source_warehouse_customers_.d3f9188fc2)
[0m18:28:28.028143 [debug] [Thread-1 (]: Began compiling node test.dbt_idx.source_relationships_warehouse_orders_cust_id__customer_id__source_warehouse_customers_.d3f9188fc2
[0m18:28:28.040281 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_idx.source_relationships_warehouse_orders_cust_id__customer_id__source_warehouse_customers_.d3f9188fc2"
[0m18:28:28.047708 [debug] [Thread-1 (]: Timing info for test.dbt_idx.source_relationships_warehouse_orders_cust_id__customer_id__source_warehouse_customers_.d3f9188fc2 (compile): 18:28:28.029696 => 18:28:28.046740
[0m18:28:28.048739 [debug] [Thread-1 (]: Began executing node test.dbt_idx.source_relationships_warehouse_orders_cust_id__customer_id__source_warehouse_customers_.d3f9188fc2
[0m18:28:28.051940 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_idx.source_relationships_warehouse_orders_cust_id__customer_id__source_warehouse_customers_.d3f9188fc2"
[0m18:28:28.058921 [debug] [Thread-1 (]: Using postgres connection "test.dbt_idx.source_relationships_warehouse_orders_cust_id__customer_id__source_warehouse_customers_.d3f9188fc2"
[0m18:28:28.058921 [debug] [Thread-1 (]: On test.dbt_idx.source_relationships_warehouse_orders_cust_id__customer_id__source_warehouse_customers_.d3f9188fc2: BEGIN
[0m18:28:28.059941 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:28:28.083038 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m18:28:28.084041 [debug] [Thread-1 (]: Using postgres connection "test.dbt_idx.source_relationships_warehouse_orders_cust_id__customer_id__source_warehouse_customers_.d3f9188fc2"
[0m18:28:28.085039 [debug] [Thread-1 (]: On test.dbt_idx.source_relationships_warehouse_orders_cust_id__customer_id__source_warehouse_customers_.d3f9188fc2: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "test.dbt_idx.source_relationships_warehouse_orders_cust_id__customer_id__source_warehouse_customers_.d3f9188fc2"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select cust_id as from_field
    from "IDX-Stock"."warehouse"."orders"
    where cust_id is not null
),

parent as (
    select customer_id as to_field
    from "IDX-Stock"."warehouse"."customers"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m18:28:28.088040 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m18:28:28.090072 [debug] [Thread-1 (]: Timing info for test.dbt_idx.source_relationships_warehouse_orders_cust_id__customer_id__source_warehouse_customers_.d3f9188fc2 (execute): 18:28:28.049770 => 18:28:28.089073
[0m18:28:28.090608 [debug] [Thread-1 (]: On test.dbt_idx.source_relationships_warehouse_orders_cust_id__customer_id__source_warehouse_customers_.d3f9188fc2: ROLLBACK
[0m18:28:28.093083 [debug] [Thread-1 (]: On test.dbt_idx.source_relationships_warehouse_orders_cust_id__customer_id__source_warehouse_customers_.d3f9188fc2: Close
[0m18:28:28.095098 [info ] [Thread-1 (]: 7 of 9 PASS source_relationships_warehouse_orders_cust_id__customer_id__source_warehouse_customers_  [[32mPASS[0m in 0.07s]
[0m18:28:28.097095 [debug] [Thread-1 (]: Finished running node test.dbt_idx.source_relationships_warehouse_orders_cust_id__customer_id__source_warehouse_customers_.d3f9188fc2
[0m18:28:28.098094 [debug] [Thread-1 (]: Began running node test.dbt_idx.source_unique_warehouse_orders_order_id.839fb43d0f
[0m18:28:28.099095 [info ] [Thread-1 (]: 8 of 9 START test source_unique_warehouse_orders_order_id ...................... [RUN]
[0m18:28:28.100098 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_idx.source_relationships_warehouse_orders_cust_id__customer_id__source_warehouse_customers_.d3f9188fc2, now test.dbt_idx.source_unique_warehouse_orders_order_id.839fb43d0f)
[0m18:28:28.101546 [debug] [Thread-1 (]: Began compiling node test.dbt_idx.source_unique_warehouse_orders_order_id.839fb43d0f
[0m18:28:28.108547 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_idx.source_unique_warehouse_orders_order_id.839fb43d0f"
[0m18:28:28.116265 [debug] [Thread-1 (]: Timing info for test.dbt_idx.source_unique_warehouse_orders_order_id.839fb43d0f (compile): 18:28:28.102565 => 18:28:28.116265
[0m18:28:28.117275 [debug] [Thread-1 (]: Began executing node test.dbt_idx.source_unique_warehouse_orders_order_id.839fb43d0f
[0m18:28:28.119857 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_idx.source_unique_warehouse_orders_order_id.839fb43d0f"
[0m18:28:28.127814 [debug] [Thread-1 (]: Using postgres connection "test.dbt_idx.source_unique_warehouse_orders_order_id.839fb43d0f"
[0m18:28:28.129815 [debug] [Thread-1 (]: On test.dbt_idx.source_unique_warehouse_orders_order_id.839fb43d0f: BEGIN
[0m18:28:28.130320 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:28:28.155824 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m18:28:28.156809 [debug] [Thread-1 (]: Using postgres connection "test.dbt_idx.source_unique_warehouse_orders_order_id.839fb43d0f"
[0m18:28:28.157827 [debug] [Thread-1 (]: On test.dbt_idx.source_unique_warehouse_orders_order_id.839fb43d0f: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "test.dbt_idx.source_unique_warehouse_orders_order_id.839fb43d0f"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    order_id as unique_field,
    count(*) as n_records

from "IDX-Stock"."warehouse"."orders"
where order_id is not null
group by order_id
having count(*) > 1



      
    ) dbt_internal_test
[0m18:28:28.163114 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m18:28:28.165113 [debug] [Thread-1 (]: Timing info for test.dbt_idx.source_unique_warehouse_orders_order_id.839fb43d0f (execute): 18:28:28.117275 => 18:28:28.164113
[0m18:28:28.165113 [debug] [Thread-1 (]: On test.dbt_idx.source_unique_warehouse_orders_order_id.839fb43d0f: ROLLBACK
[0m18:28:28.169127 [debug] [Thread-1 (]: On test.dbt_idx.source_unique_warehouse_orders_order_id.839fb43d0f: Close
[0m18:28:28.172321 [info ] [Thread-1 (]: 8 of 9 PASS source_unique_warehouse_orders_order_id ............................ [[32mPASS[0m in 0.07s]
[0m18:28:28.174327 [debug] [Thread-1 (]: Finished running node test.dbt_idx.source_unique_warehouse_orders_order_id.839fb43d0f
[0m18:28:28.175352 [debug] [Thread-1 (]: Began running node test.dbt_idx.unique_customer_orders_status_order_id.b7a45e83ee
[0m18:28:28.176320 [info ] [Thread-1 (]: 9 of 9 START test unique_customer_orders_status_order_id ....................... [RUN]
[0m18:28:28.177320 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_idx.source_unique_warehouse_orders_order_id.839fb43d0f, now test.dbt_idx.unique_customer_orders_status_order_id.b7a45e83ee)
[0m18:28:28.178355 [debug] [Thread-1 (]: Began compiling node test.dbt_idx.unique_customer_orders_status_order_id.b7a45e83ee
[0m18:28:28.183916 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_idx.unique_customer_orders_status_order_id.b7a45e83ee"
[0m18:28:28.191414 [debug] [Thread-1 (]: Timing info for test.dbt_idx.unique_customer_orders_status_order_id.b7a45e83ee (compile): 18:28:28.178355 => 18:28:28.190408
[0m18:28:28.192419 [debug] [Thread-1 (]: Began executing node test.dbt_idx.unique_customer_orders_status_order_id.b7a45e83ee
[0m18:28:28.195421 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_idx.unique_customer_orders_status_order_id.b7a45e83ee"
[0m18:28:28.201878 [debug] [Thread-1 (]: Using postgres connection "test.dbt_idx.unique_customer_orders_status_order_id.b7a45e83ee"
[0m18:28:28.202882 [debug] [Thread-1 (]: On test.dbt_idx.unique_customer_orders_status_order_id.b7a45e83ee: BEGIN
[0m18:28:28.203878 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:28:28.227750 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m18:28:28.227750 [debug] [Thread-1 (]: Using postgres connection "test.dbt_idx.unique_customer_orders_status_order_id.b7a45e83ee"
[0m18:28:28.228782 [debug] [Thread-1 (]: On test.dbt_idx.unique_customer_orders_status_order_id.b7a45e83ee: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "test.dbt_idx.unique_customer_orders_status_order_id.b7a45e83ee"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    order_id as unique_field,
    count(*) as n_records

from "IDX-Stock"."warehouse"."customer_orders_status"
where order_id is not null
group by order_id
having count(*) > 1



      
    ) dbt_internal_test
[0m18:28:28.233891 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m18:28:28.235917 [debug] [Thread-1 (]: Timing info for test.dbt_idx.unique_customer_orders_status_order_id.b7a45e83ee (execute): 18:28:28.192419 => 18:28:28.235917
[0m18:28:28.236933 [debug] [Thread-1 (]: On test.dbt_idx.unique_customer_orders_status_order_id.b7a45e83ee: ROLLBACK
[0m18:28:28.238891 [debug] [Thread-1 (]: On test.dbt_idx.unique_customer_orders_status_order_id.b7a45e83ee: Close
[0m18:28:28.239901 [info ] [Thread-1 (]: 9 of 9 PASS unique_customer_orders_status_order_id ............................. [[32mPASS[0m in 0.06s]
[0m18:28:28.243315 [debug] [Thread-1 (]: Finished running node test.dbt_idx.unique_customer_orders_status_order_id.b7a45e83ee
[0m18:28:28.245317 [debug] [MainThread]: Using postgres connection "master"
[0m18:28:28.246338 [debug] [MainThread]: On master: BEGIN
[0m18:28:28.247320 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:28:28.269985 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m18:28:28.270936 [debug] [MainThread]: On master: COMMIT
[0m18:28:28.271935 [debug] [MainThread]: Using postgres connection "master"
[0m18:28:28.272934 [debug] [MainThread]: On master: COMMIT
[0m18:28:28.274935 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m18:28:28.274935 [debug] [MainThread]: On master: Close
[0m18:28:28.276941 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:28:28.277937 [debug] [MainThread]: Connection 'list_IDX-Stock_snapshots' was properly closed.
[0m18:28:28.278959 [debug] [MainThread]: Connection 'test.dbt_idx.unique_customer_orders_status_order_id.b7a45e83ee' was properly closed.
[0m18:28:28.279938 [info ] [MainThread]: 
[0m18:28:28.281118 [info ] [MainThread]: Finished running 9 tests in 0 hours 0 minutes and 0.98 seconds (0.98s).
[0m18:28:28.283913 [debug] [MainThread]: Command end result
[0m18:28:28.306981 [info ] [MainThread]: 
[0m18:28:28.307883 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:28:28.308898 [info ] [MainThread]: 
[0m18:28:28.309895 [info ] [MainThread]: Done. PASS=9 WARN=0 ERROR=0 SKIP=0 TOTAL=9
[0m18:28:28.311001 [debug] [MainThread]: Command `dbt test` succeeded at 18:28:28.311001 after 1.42 seconds
[0m18:28:28.312026 [debug] [MainThread]: Flushing usage events


============================== 18:31:12.386344 | 8fc5f248-5d5a-45bf-9211-4dc6a07ea9cc ==============================
[0m18:31:12.386344 [info ] [MainThread]: Running with dbt=1.6.1
[0m18:31:12.392779 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': 'D:\\00 Project\\00 My Project\\IdeaProjects\\Py-DBT-IDX', 'log_path': 'D:\\00 Project\\00 My Project\\IdeaProjects\\Py-DBT-IDX\\logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'False'}
[0m18:31:12.521382 [info ] [MainThread]: Registered adapter: postgres=1.6.1
[0m18:31:12.531900 [debug] [MainThread]: checksum: efe19d9f5b93d1a98cc804fbfcdb6b3aced98b974af664946fee1cde8837deb7, vars: {}, profile: , target: , version: 1.6.1
[0m18:31:12.687067 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m18:31:12.688069 [debug] [MainThread]: Partial parsing: updated file: dbt_idx://tests\assert_customer_dimension_has_no_row_loss.sql.sql
[0m18:31:12.688069 [debug] [MainThread]: Partial parsing: updated file: dbt_idx://models\staging\stg_eltool__customers.sql
[0m18:31:12.791509 [info ] [MainThread]: Found 1 snapshot, 9 tests, 7 models, 3 sources, 0 exposures, 0 metrics, 349 macros, 0 groups, 0 semantic models
[0m18:31:12.794471 [info ] [MainThread]: 
[0m18:31:12.795471 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m18:31:12.798506 [debug] [ThreadPool]: Acquiring new postgres connection 'list_IDX-Stock'
[0m18:31:12.808042 [debug] [ThreadPool]: Using postgres connection "list_IDX-Stock"
[0m18:31:12.809675 [debug] [ThreadPool]: On list_IDX-Stock: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "connection_name": "list_IDX-Stock"} */

    select distinct nspname from pg_namespace
  
[0m18:31:12.810593 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:31:12.840991 [debug] [ThreadPool]: SQL status: SELECT 13 in 0.0 seconds
[0m18:31:12.841999 [debug] [ThreadPool]: On list_IDX-Stock: Close
[0m18:31:12.846005 [debug] [ThreadPool]: Acquiring new postgres connection 'list_IDX-Stock_warehouse'
[0m18:31:12.853525 [debug] [ThreadPool]: Using postgres connection "list_IDX-Stock_warehouse"
[0m18:31:12.854523 [debug] [ThreadPool]: On list_IDX-Stock_warehouse: BEGIN
[0m18:31:12.854523 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:31:12.877504 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m18:31:12.878518 [debug] [ThreadPool]: Using postgres connection "list_IDX-Stock_warehouse"
[0m18:31:12.879495 [debug] [ThreadPool]: On list_IDX-Stock_warehouse: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "connection_name": "list_IDX-Stock_warehouse"} */
select
      'IDX-Stock' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'warehouse'
    union all
    select
      'IDX-Stock' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'warehouse'
    union all
    select
      'IDX-Stock' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'warehouse'
  
[0m18:31:12.883677 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.0 seconds
[0m18:31:12.885677 [debug] [ThreadPool]: On list_IDX-Stock_warehouse: ROLLBACK
[0m18:31:12.887674 [debug] [ThreadPool]: On list_IDX-Stock_warehouse: Close
[0m18:31:12.889182 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_IDX-Stock_warehouse, now list_IDX-Stock_snapshots)
[0m18:31:12.894225 [debug] [ThreadPool]: Using postgres connection "list_IDX-Stock_snapshots"
[0m18:31:12.895227 [debug] [ThreadPool]: On list_IDX-Stock_snapshots: BEGIN
[0m18:31:12.896191 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:31:12.916528 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m18:31:12.917492 [debug] [ThreadPool]: Using postgres connection "list_IDX-Stock_snapshots"
[0m18:31:12.918492 [debug] [ThreadPool]: On list_IDX-Stock_snapshots: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "connection_name": "list_IDX-Stock_snapshots"} */
select
      'IDX-Stock' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'snapshots'
    union all
    select
      'IDX-Stock' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'snapshots'
    union all
    select
      'IDX-Stock' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'snapshots'
  
[0m18:31:12.923236 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.0 seconds
[0m18:31:12.924285 [debug] [ThreadPool]: On list_IDX-Stock_snapshots: ROLLBACK
[0m18:31:12.927193 [debug] [ThreadPool]: On list_IDX-Stock_snapshots: Close
[0m18:31:12.934570 [debug] [MainThread]: Using postgres connection "master"
[0m18:31:12.935571 [debug] [MainThread]: On master: BEGIN
[0m18:31:12.936572 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:31:12.960259 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m18:31:12.960259 [debug] [MainThread]: Using postgres connection "master"
[0m18:31:12.961284 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m18:31:12.971816 [debug] [MainThread]: SQL status: SELECT 6 in 0.0 seconds
[0m18:31:12.975815 [debug] [MainThread]: On master: ROLLBACK
[0m18:31:12.977823 [debug] [MainThread]: Using postgres connection "master"
[0m18:31:12.979489 [debug] [MainThread]: On master: BEGIN
[0m18:31:12.983339 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m18:31:12.984341 [debug] [MainThread]: On master: COMMIT
[0m18:31:12.985341 [debug] [MainThread]: Using postgres connection "master"
[0m18:31:12.986341 [debug] [MainThread]: On master: COMMIT
[0m18:31:12.988000 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m18:31:12.988000 [debug] [MainThread]: On master: Close
[0m18:31:12.990552 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:31:12.991558 [info ] [MainThread]: 
[0m18:31:12.997028 [debug] [Thread-1 (]: Began running node model.dbt_idx.stg_eltool__customers
[0m18:31:12.998042 [info ] [Thread-1 (]: 1 of 7 START sql view model warehouse.stg_eltool__customers .................... [RUN]
[0m18:31:12.999550 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.dbt_idx.stg_eltool__customers'
[0m18:31:13.000569 [debug] [Thread-1 (]: Began compiling node model.dbt_idx.stg_eltool__customers
[0m18:31:13.008556 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_idx.stg_eltool__customers"
[0m18:31:13.017618 [debug] [Thread-1 (]: Timing info for model.dbt_idx.stg_eltool__customers (compile): 18:31:13.001570 => 18:31:13.017618
[0m18:31:13.019214 [debug] [Thread-1 (]: Began executing node model.dbt_idx.stg_eltool__customers
[0m18:31:13.059734 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_idx.stg_eltool__customers"
[0m18:31:13.065776 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__customers"
[0m18:31:13.066745 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__customers: BEGIN
[0m18:31:13.067744 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m18:31:13.087855 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m18:31:13.089453 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__customers"
[0m18:31:13.090374 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__customers: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__customers"} */

  create view "IDX-Stock"."warehouse"."stg_eltool__customers__dbt_tmp"
    
    
  as (
    with source as (select *
                from "IDX-Stock"."warehouse"."customers"),
     renamed as (select
--                      customer_id,
                        'This is Dummy' as dummy
                 from source)
select *
from renamed
  );
[0m18:31:13.095010 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m18:31:13.101545 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__customers"
[0m18:31:13.102545 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__customers: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__customers"} */
alter table "IDX-Stock"."warehouse"."stg_eltool__customers" rename to "stg_eltool__customers__dbt_backup"
[0m18:31:13.104546 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:31:13.108545 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__customers"
[0m18:31:13.110049 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__customers: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__customers"} */
alter table "IDX-Stock"."warehouse"."stg_eltool__customers__dbt_tmp" rename to "stg_eltool__customers"
[0m18:31:13.112059 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:31:13.130080 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__customers: COMMIT
[0m18:31:13.131092 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__customers"
[0m18:31:13.132099 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__customers: COMMIT
[0m18:31:13.135714 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m18:31:13.143918 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__customers"
[0m18:31:13.144919 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__customers: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__customers"} */
drop view if exists "IDX-Stock"."warehouse"."stg_eltool__customers__dbt_backup" cascade
[0m18:31:13.147883 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m18:31:13.151473 [debug] [Thread-1 (]: Timing info for model.dbt_idx.stg_eltool__customers (execute): 18:31:13.020133 => 18:31:13.151473
[0m18:31:13.152436 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__customers: Close
[0m18:31:13.154454 [info ] [Thread-1 (]: 1 of 7 OK created sql view model warehouse.stg_eltool__customers ............... [[32mCREATE VIEW[0m in 0.15s]
[0m18:31:13.156440 [debug] [Thread-1 (]: Finished running node model.dbt_idx.stg_eltool__customers
[0m18:31:13.157435 [debug] [Thread-1 (]: Began running node model.dbt_idx.stg_eltool__customers_snapshots
[0m18:31:13.158435 [info ] [Thread-1 (]: 2 of 7 START sql view model warehouse.stg_eltool__customers_snapshots .......... [RUN]
[0m18:31:13.159471 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_idx.stg_eltool__customers, now model.dbt_idx.stg_eltool__customers_snapshots)
[0m18:31:13.160673 [debug] [Thread-1 (]: Began compiling node model.dbt_idx.stg_eltool__customers_snapshots
[0m18:31:13.163708 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_idx.stg_eltool__customers_snapshots"
[0m18:31:13.171223 [debug] [Thread-1 (]: Timing info for model.dbt_idx.stg_eltool__customers_snapshots (compile): 18:31:13.161686 => 18:31:13.171223
[0m18:31:13.172246 [debug] [Thread-1 (]: Began executing node model.dbt_idx.stg_eltool__customers_snapshots
[0m18:31:13.178245 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_idx.stg_eltool__customers_snapshots"
[0m18:31:13.185473 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__customers_snapshots"
[0m18:31:13.186498 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__customers_snapshots: BEGIN
[0m18:31:13.187442 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:31:13.207334 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m18:31:13.208344 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__customers_snapshots"
[0m18:31:13.209330 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__customers_snapshots: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__customers_snapshots"} */

  create view "IDX-Stock"."warehouse"."stg_eltool__customers_snapshots__dbt_tmp"
    
    
  as (
    with source as (select *
                from "IDX-Stock"."snapshots"."customers_snapshot"),
     renamed as (select customer_id,
                        zipcode,
                        city,
                        state_code,
                        datetime_created::TIMESTAMP AS datetime_created,
                        datetime_updated::TIMESTAMP AS datetime_updated,
                        dbt_valid_from,
                        dbt_valid_to
                 from source)
select *
from renamed
  );
[0m18:31:13.212884 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m18:31:13.216921 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__customers_snapshots"
[0m18:31:13.217921 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__customers_snapshots: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__customers_snapshots"} */
alter table "IDX-Stock"."warehouse"."stg_eltool__customers_snapshots" rename to "stg_eltool__customers_snapshots__dbt_backup"
[0m18:31:13.220436 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:31:13.223469 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__customers_snapshots"
[0m18:31:13.224472 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__customers_snapshots: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__customers_snapshots"} */
alter table "IDX-Stock"."warehouse"."stg_eltool__customers_snapshots__dbt_tmp" rename to "stg_eltool__customers_snapshots"
[0m18:31:13.227436 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:31:13.230012 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__customers_snapshots: COMMIT
[0m18:31:13.230012 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__customers_snapshots"
[0m18:31:13.231021 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__customers_snapshots: COMMIT
[0m18:31:13.235022 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m18:31:13.238053 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__customers_snapshots"
[0m18:31:13.239558 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__customers_snapshots: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__customers_snapshots"} */
drop view if exists "IDX-Stock"."warehouse"."stg_eltool__customers_snapshots__dbt_backup" cascade
[0m18:31:13.243460 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m18:31:13.245496 [debug] [Thread-1 (]: Timing info for model.dbt_idx.stg_eltool__customers_snapshots (execute): 18:31:13.173242 => 18:31:13.245496
[0m18:31:13.246496 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__customers_snapshots: Close
[0m18:31:13.248474 [info ] [Thread-1 (]: 2 of 7 OK created sql view model warehouse.stg_eltool__customers_snapshots ..... [[32mCREATE VIEW[0m in 0.09s]
[0m18:31:13.251017 [debug] [Thread-1 (]: Finished running node model.dbt_idx.stg_eltool__customers_snapshots
[0m18:31:13.252015 [debug] [Thread-1 (]: Began running node model.dbt_idx.stg_eltool__orders
[0m18:31:13.253009 [info ] [Thread-1 (]: 3 of 7 START sql view model warehouse.stg_eltool__orders ....................... [RUN]
[0m18:31:13.254025 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_idx.stg_eltool__customers_snapshots, now model.dbt_idx.stg_eltool__orders)
[0m18:31:13.255041 [debug] [Thread-1 (]: Began compiling node model.dbt_idx.stg_eltool__orders
[0m18:31:13.258040 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_idx.stg_eltool__orders"
[0m18:31:13.269358 [debug] [Thread-1 (]: Timing info for model.dbt_idx.stg_eltool__orders (compile): 18:31:13.255041 => 18:31:13.269358
[0m18:31:13.270497 [debug] [Thread-1 (]: Began executing node model.dbt_idx.stg_eltool__orders
[0m18:31:13.277513 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_idx.stg_eltool__orders"
[0m18:31:13.290389 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__orders"
[0m18:31:13.291402 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__orders: BEGIN
[0m18:31:13.292408 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:31:13.314254 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m18:31:13.315238 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__orders"
[0m18:31:13.316237 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__orders: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__orders"} */

  create view "IDX-Stock"."warehouse"."stg_eltool__orders__dbt_tmp"
    
    
  as (
    with source as (select *
                from "IDX-Stock"."warehouse"."orders"),
     renamed as (select order_id,
                        cust_id AS customer_id,
                        order_status,
                        order_purchase_timestamp::TIMESTAMP,
                        order_approved_at::TIMESTAMP,
                        order_delivered_carrier_date::TIMESTAMP,
                        order_delivered_customer_date::TIMESTAMP,
                        order_estimated_delivery_date::TIMESTAMP
                 from source)
select *
from renamed
  );
[0m18:31:13.320396 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m18:31:13.324385 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__orders"
[0m18:31:13.325403 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__orders: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__orders"} */
alter table "IDX-Stock"."warehouse"."stg_eltool__orders" rename to "stg_eltool__orders__dbt_backup"
[0m18:31:13.327655 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:31:13.331176 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__orders"
[0m18:31:13.332178 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__orders: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__orders"} */
alter table "IDX-Stock"."warehouse"."stg_eltool__orders__dbt_tmp" rename to "stg_eltool__orders"
[0m18:31:13.335178 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:31:13.338179 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__orders: COMMIT
[0m18:31:13.339179 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__orders"
[0m18:31:13.339691 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__orders: COMMIT
[0m18:31:13.344232 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m18:31:13.347235 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__orders"
[0m18:31:13.348235 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__orders: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__orders"} */
drop view if exists "IDX-Stock"."warehouse"."stg_eltool__orders__dbt_backup" cascade
[0m18:31:13.352537 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m18:31:13.354548 [debug] [Thread-1 (]: Timing info for model.dbt_idx.stg_eltool__orders (execute): 18:31:13.271531 => 18:31:13.354548
[0m18:31:13.355547 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__orders: Close
[0m18:31:13.356570 [info ] [Thread-1 (]: 3 of 7 OK created sql view model warehouse.stg_eltool__orders .................. [[32mCREATE VIEW[0m in 0.10s]
[0m18:31:13.358547 [debug] [Thread-1 (]: Finished running node model.dbt_idx.stg_eltool__orders
[0m18:31:13.360743 [debug] [Thread-1 (]: Began running node model.dbt_idx.stg_eltool__state
[0m18:31:13.361750 [info ] [Thread-1 (]: 4 of 7 START sql view model warehouse.stg_eltool__state ........................ [RUN]
[0m18:31:13.363753 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_idx.stg_eltool__orders, now model.dbt_idx.stg_eltool__state)
[0m18:31:13.365752 [debug] [Thread-1 (]: Began compiling node model.dbt_idx.stg_eltool__state
[0m18:31:13.369377 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_idx.stg_eltool__state"
[0m18:31:13.380030 [debug] [Thread-1 (]: Timing info for model.dbt_idx.stg_eltool__state (compile): 18:31:13.366755 => 18:31:13.379405
[0m18:31:13.382579 [debug] [Thread-1 (]: Began executing node model.dbt_idx.stg_eltool__state
[0m18:31:13.388225 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_idx.stg_eltool__state"
[0m18:31:13.394515 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__state"
[0m18:31:13.395514 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__state: BEGIN
[0m18:31:13.397478 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:31:13.420552 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m18:31:13.421588 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__state"
[0m18:31:13.422588 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__state: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__state"} */

  create view "IDX-Stock"."warehouse"."stg_eltool__state__dbt_tmp"
    
    
  as (
    with source as (select *
                from "IDX-Stock"."warehouse"."state"),
     renamed as (select state_identifier::INT AS state_id,
                         state_code::VARCHAR(2) AS state_code,
                         st_name::VARCHAR(30) AS state_name
                 from source)
select *
from renamed
  );
[0m18:31:13.426043 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m18:31:13.429702 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__state"
[0m18:31:13.430607 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__state: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__state"} */
alter table "IDX-Stock"."warehouse"."stg_eltool__state" rename to "stg_eltool__state__dbt_backup"
[0m18:31:13.433507 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:31:13.436554 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__state"
[0m18:31:13.437518 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__state: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__state"} */
alter table "IDX-Stock"."warehouse"."stg_eltool__state__dbt_tmp" rename to "stg_eltool__state"
[0m18:31:13.439520 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:31:13.442300 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__state: COMMIT
[0m18:31:13.446325 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__state"
[0m18:31:13.447309 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__state: COMMIT
[0m18:31:13.451691 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m18:31:13.455735 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__state"
[0m18:31:13.456751 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__state: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__state"} */
drop view if exists "IDX-Stock"."warehouse"."stg_eltool__state__dbt_backup" cascade
[0m18:31:13.461287 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m18:31:13.463340 [debug] [Thread-1 (]: Timing info for model.dbt_idx.stg_eltool__state (execute): 18:31:13.383512 => 18:31:13.463340
[0m18:31:13.464286 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__state: Close
[0m18:31:13.466304 [info ] [Thread-1 (]: 4 of 7 OK created sql view model warehouse.stg_eltool__state ................... [[32mCREATE VIEW[0m in 0.10s]
[0m18:31:13.468287 [debug] [Thread-1 (]: Finished running node model.dbt_idx.stg_eltool__state
[0m18:31:13.469833 [debug] [Thread-1 (]: Began running node model.dbt_idx.fact_orders
[0m18:31:13.470877 [info ] [Thread-1 (]: 5 of 7 START sql table model warehouse.fact_orders ............................. [RUN]
[0m18:31:13.471905 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_idx.stg_eltool__state, now model.dbt_idx.fact_orders)
[0m18:31:13.472878 [debug] [Thread-1 (]: Began compiling node model.dbt_idx.fact_orders
[0m18:31:13.476869 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_idx.fact_orders"
[0m18:31:13.483360 [debug] [Thread-1 (]: Timing info for model.dbt_idx.fact_orders (compile): 18:31:13.473876 => 18:31:13.482355
[0m18:31:13.483360 [debug] [Thread-1 (]: Began executing node model.dbt_idx.fact_orders
[0m18:31:13.510067 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_idx.fact_orders"
[0m18:31:13.516515 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.fact_orders"
[0m18:31:13.517571 [debug] [Thread-1 (]: On model.dbt_idx.fact_orders: BEGIN
[0m18:31:13.518530 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:31:13.540175 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m18:31:13.541681 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.fact_orders"
[0m18:31:13.541774 [debug] [Thread-1 (]: On model.dbt_idx.fact_orders: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.fact_orders"} */

  
    

  create  table "IDX-Stock"."warehouse"."fact_orders__dbt_tmp"
  
  
    as
  
  (
    with orders as (
    select *
    from "IDX-Stock"."warehouse"."stg_eltool__orders"
)
select * from orders
  );
  
[0m18:31:13.549323 [debug] [Thread-1 (]: SQL status: SELECT 999 in 0.0 seconds
[0m18:31:13.553252 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.fact_orders"
[0m18:31:13.554253 [debug] [Thread-1 (]: On model.dbt_idx.fact_orders: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.fact_orders"} */
alter table "IDX-Stock"."warehouse"."fact_orders" rename to "fact_orders__dbt_backup"
[0m18:31:13.557237 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:31:13.561768 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.fact_orders"
[0m18:31:13.562774 [debug] [Thread-1 (]: On model.dbt_idx.fact_orders: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.fact_orders"} */
alter table "IDX-Stock"."warehouse"."fact_orders__dbt_tmp" rename to "fact_orders"
[0m18:31:13.564798 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:31:13.573387 [debug] [Thread-1 (]: On model.dbt_idx.fact_orders: COMMIT
[0m18:31:13.574342 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.fact_orders"
[0m18:31:13.575345 [debug] [Thread-1 (]: On model.dbt_idx.fact_orders: COMMIT
[0m18:31:13.578422 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m18:31:13.585979 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.fact_orders"
[0m18:31:13.586950 [debug] [Thread-1 (]: On model.dbt_idx.fact_orders: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.fact_orders"} */
drop table if exists "IDX-Stock"."warehouse"."fact_orders__dbt_backup" cascade
[0m18:31:13.592465 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m18:31:13.594466 [debug] [Thread-1 (]: Timing info for model.dbt_idx.fact_orders (execute): 18:31:13.484351 => 18:31:13.594466
[0m18:31:13.595466 [debug] [Thread-1 (]: On model.dbt_idx.fact_orders: Close
[0m18:31:13.596490 [info ] [Thread-1 (]: 5 of 7 OK created sql table model warehouse.fact_orders ........................ [[32mSELECT 999[0m in 0.12s]
[0m18:31:13.598474 [debug] [Thread-1 (]: Finished running node model.dbt_idx.fact_orders
[0m18:31:13.599473 [debug] [Thread-1 (]: Began running node model.dbt_idx.dim_customers
[0m18:31:13.600941 [info ] [Thread-1 (]: 6 of 7 START sql table model warehouse.dim_customers ........................... [RUN]
[0m18:31:13.601935 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_idx.fact_orders, now model.dbt_idx.dim_customers)
[0m18:31:13.602975 [debug] [Thread-1 (]: Began compiling node model.dbt_idx.dim_customers
[0m18:31:13.606971 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_idx.dim_customers"
[0m18:31:13.613487 [debug] [Thread-1 (]: Timing info for model.dbt_idx.dim_customers (compile): 18:31:13.603971 => 18:31:13.612487
[0m18:31:13.614472 [debug] [Thread-1 (]: Began executing node model.dbt_idx.dim_customers
[0m18:31:13.619964 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_idx.dim_customers"
[0m18:31:13.628005 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.dim_customers"
[0m18:31:13.628005 [debug] [Thread-1 (]: On model.dbt_idx.dim_customers: BEGIN
[0m18:31:13.629598 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:31:13.653515 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m18:31:13.654487 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.dim_customers"
[0m18:31:13.654487 [debug] [Thread-1 (]: On model.dbt_idx.dim_customers: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.dim_customers"} */

  
    

  create  table "IDX-Stock"."warehouse"."dim_customers__dbt_tmp"
  
  
    as
  
  (
    -- noinspection SqlDialectInspectionForFile

with customers as (
    select *
    from "IDX-Stock"."warehouse"."stg_eltool__customers_snapshots"
    ),
     state as (
         select *
         from "IDX-Stock"."warehouse"."stg_eltool__state"
     )
select c.customer_id,
       c.zipcode,
       c.city,
       c.state_code,
       s.state_name,
       c.datetime_created,
       c.datetime_updated,
       c.dbt_valid_from::TIMESTAMP as valid_from,
        CASE WHEN c.dbt_valid_to IS NULL
            THEN '9999-12-31'::TIMESTAMP
            ELSE c.dbt_valid_to::TIMESTAMP
        END as valid_to
from customers c
    join state s on c.state_code = s.state_code
  );
  
[0m18:31:13.660061 [debug] [Thread-1 (]: SQL status: SELECT 105 in 0.0 seconds
[0m18:31:13.663070 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.dim_customers"
[0m18:31:13.664082 [debug] [Thread-1 (]: On model.dbt_idx.dim_customers: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.dim_customers"} */
alter table "IDX-Stock"."warehouse"."dim_customers" rename to "dim_customers__dbt_backup"
[0m18:31:13.667082 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:31:13.670594 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.dim_customers"
[0m18:31:13.671594 [debug] [Thread-1 (]: On model.dbt_idx.dim_customers: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.dim_customers"} */
alter table "IDX-Stock"."warehouse"."dim_customers__dbt_tmp" rename to "dim_customers"
[0m18:31:13.674594 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:31:13.676595 [debug] [Thread-1 (]: On model.dbt_idx.dim_customers: COMMIT
[0m18:31:13.677606 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.dim_customers"
[0m18:31:13.678594 [debug] [Thread-1 (]: On model.dbt_idx.dim_customers: COMMIT
[0m18:31:13.681364 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m18:31:13.685411 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.dim_customers"
[0m18:31:13.686375 [debug] [Thread-1 (]: On model.dbt_idx.dim_customers: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.dim_customers"} */
drop table if exists "IDX-Stock"."warehouse"."dim_customers__dbt_backup" cascade
[0m18:31:13.690464 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m18:31:13.692484 [debug] [Thread-1 (]: Timing info for model.dbt_idx.dim_customers (execute): 18:31:13.615454 => 18:31:13.692484
[0m18:31:13.693482 [debug] [Thread-1 (]: On model.dbt_idx.dim_customers: Close
[0m18:31:13.696467 [info ] [Thread-1 (]: 6 of 7 OK created sql table model warehouse.dim_customers ...................... [[32mSELECT 105[0m in 0.09s]
[0m18:31:13.698462 [debug] [Thread-1 (]: Finished running node model.dbt_idx.dim_customers
[0m18:31:13.700974 [debug] [Thread-1 (]: Began running node model.dbt_idx.customer_orders_status
[0m18:31:13.701985 [info ] [Thread-1 (]: 7 of 7 START sql view model warehouse.customer_orders_status ................... [RUN]
[0m18:31:13.704019 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_idx.dim_customers, now model.dbt_idx.customer_orders_status)
[0m18:31:13.704997 [debug] [Thread-1 (]: Began compiling node model.dbt_idx.customer_orders_status
[0m18:31:13.708024 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_idx.customer_orders_status"
[0m18:31:13.716551 [debug] [Thread-1 (]: Timing info for model.dbt_idx.customer_orders_status (compile): 18:31:13.704997 => 18:31:13.716551
[0m18:31:13.717551 [debug] [Thread-1 (]: Began executing node model.dbt_idx.customer_orders_status
[0m18:31:13.722175 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_idx.customer_orders_status"
[0m18:31:13.728180 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.customer_orders_status"
[0m18:31:13.729176 [debug] [Thread-1 (]: On model.dbt_idx.customer_orders_status: BEGIN
[0m18:31:13.730380 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:31:13.752389 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m18:31:13.753394 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.customer_orders_status"
[0m18:31:13.754400 [debug] [Thread-1 (]: On model.dbt_idx.customer_orders_status: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.customer_orders_status"} */

  create view "IDX-Stock"."warehouse"."customer_orders_status__dbt_tmp"
    
    
  as (
    with orders as (select *
                from "IDX-Stock"."warehouse"."fact_orders"),
     customers as (select *
                   from "IDX-Stock"."warehouse"."dim_customers")
select o.order_id,
       o.customer_id,
       o.order_status,
       o.order_purchase_timestamp,
       o.order_approved_at,
       o.order_delivered_carrier_date,
       o.order_delivered_customer_date,
       o.order_estimated_delivery_date,
       c.zipcode    as customer_zipcode,
       c.city       as customer_city,
       c.state_code as customer_state_code,
       c.state_name as customer_state_name
from orders o
    join customers c on o.customer_id = c.customer_id
    and o.order_purchase_timestamp >= c.valid_from
    and o.order_purchase_timestamp <= c.valid_to
  );
[0m18:31:13.758418 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m18:31:13.762863 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.customer_orders_status"
[0m18:31:13.763866 [debug] [Thread-1 (]: On model.dbt_idx.customer_orders_status: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.customer_orders_status"} */
alter table "IDX-Stock"."warehouse"."customer_orders_status__dbt_tmp" rename to "customer_orders_status"
[0m18:31:13.766839 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:31:13.770359 [debug] [Thread-1 (]: On model.dbt_idx.customer_orders_status: COMMIT
[0m18:31:13.771363 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.customer_orders_status"
[0m18:31:13.772367 [debug] [Thread-1 (]: On model.dbt_idx.customer_orders_status: COMMIT
[0m18:31:13.776361 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m18:31:13.779361 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.customer_orders_status"
[0m18:31:13.780836 [debug] [Thread-1 (]: On model.dbt_idx.customer_orders_status: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.customer_orders_status"} */
drop view if exists "IDX-Stock"."warehouse"."customer_orders_status__dbt_backup" cascade
[0m18:31:13.783863 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m18:31:13.785373 [debug] [Thread-1 (]: Timing info for model.dbt_idx.customer_orders_status (execute): 18:31:13.717551 => 18:31:13.785373
[0m18:31:13.786385 [debug] [Thread-1 (]: On model.dbt_idx.customer_orders_status: Close
[0m18:31:13.788387 [info ] [Thread-1 (]: 7 of 7 OK created sql view model warehouse.customer_orders_status .............. [[32mCREATE VIEW[0m in 0.08s]
[0m18:31:13.790925 [debug] [Thread-1 (]: Finished running node model.dbt_idx.customer_orders_status
[0m18:31:13.794926 [debug] [MainThread]: Using postgres connection "master"
[0m18:31:13.795917 [debug] [MainThread]: On master: BEGIN
[0m18:31:13.796934 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:31:13.819395 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m18:31:13.820402 [debug] [MainThread]: On master: COMMIT
[0m18:31:13.821403 [debug] [MainThread]: Using postgres connection "master"
[0m18:31:13.822418 [debug] [MainThread]: On master: COMMIT
[0m18:31:13.823404 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m18:31:13.824402 [debug] [MainThread]: On master: Close
[0m18:31:13.826420 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:31:13.827402 [debug] [MainThread]: Connection 'list_IDX-Stock' was properly closed.
[0m18:31:13.828429 [debug] [MainThread]: Connection 'list_IDX-Stock_snapshots' was properly closed.
[0m18:31:13.829404 [debug] [MainThread]: Connection 'model.dbt_idx.customer_orders_status' was properly closed.
[0m18:31:13.830519 [info ] [MainThread]: 
[0m18:31:13.832527 [info ] [MainThread]: Finished running 5 view models, 2 table models in 0 hours 0 minutes and 1.04 seconds (1.04s).
[0m18:31:13.834546 [debug] [MainThread]: Command end result
[0m18:31:13.853762 [info ] [MainThread]: 
[0m18:31:13.854779 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:31:13.855778 [info ] [MainThread]: 
[0m18:31:13.856761 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=0 SKIP=0 TOTAL=7
[0m18:31:13.857762 [debug] [MainThread]: Command `dbt run` succeeded at 18:31:13.857762 after 1.52 seconds
[0m18:31:13.859288 [debug] [MainThread]: Flushing usage events


============================== 18:33:30.437884 | 7f8a3324-c082-41d3-b8e6-46ece989a707 ==============================
[0m18:33:30.437884 [info ] [MainThread]: Running with dbt=1.6.1
[0m18:33:30.443048 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'D:\\00 Project\\00 My Project\\IdeaProjects\\Py-DBT-IDX', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'D:\\00 Project\\00 My Project\\IdeaProjects\\Py-DBT-IDX\\logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt test', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'False'}
[0m18:33:30.574887 [info ] [MainThread]: Registered adapter: postgres=1.6.1
[0m18:33:30.586445 [debug] [MainThread]: checksum: efe19d9f5b93d1a98cc804fbfcdb6b3aced98b974af664946fee1cde8837deb7, vars: {}, profile: , target: , version: 1.6.1
[0m18:33:30.736854 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m18:33:30.737855 [debug] [MainThread]: Partial parsing: updated file: dbt_idx://tests\assert_customer_dimension_has_no_row_loss.sql.sql
[0m18:33:30.805501 [info ] [MainThread]: Found 1 snapshot, 9 tests, 7 models, 3 sources, 0 exposures, 0 metrics, 349 macros, 0 groups, 0 semantic models
[0m18:33:30.807503 [info ] [MainThread]: 
[0m18:33:30.810017 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m18:33:30.817025 [debug] [ThreadPool]: Acquiring new postgres connection 'list_IDX-Stock_warehouse'
[0m18:33:30.827253 [debug] [ThreadPool]: Using postgres connection "list_IDX-Stock_warehouse"
[0m18:33:30.827253 [debug] [ThreadPool]: On list_IDX-Stock_warehouse: BEGIN
[0m18:33:30.829850 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:33:30.864060 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m18:33:30.865076 [debug] [ThreadPool]: Using postgres connection "list_IDX-Stock_warehouse"
[0m18:33:30.866040 [debug] [ThreadPool]: On list_IDX-Stock_warehouse: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "connection_name": "list_IDX-Stock_warehouse"} */
select
      'IDX-Stock' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'warehouse'
    union all
    select
      'IDX-Stock' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'warehouse'
    union all
    select
      'IDX-Stock' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'warehouse'
  
[0m18:33:30.871099 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.0 seconds
[0m18:33:30.873135 [debug] [ThreadPool]: On list_IDX-Stock_warehouse: ROLLBACK
[0m18:33:30.874100 [debug] [ThreadPool]: On list_IDX-Stock_warehouse: Close
[0m18:33:30.877101 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_IDX-Stock_warehouse, now list_IDX-Stock_snapshots)
[0m18:33:30.882344 [debug] [ThreadPool]: Using postgres connection "list_IDX-Stock_snapshots"
[0m18:33:30.883344 [debug] [ThreadPool]: On list_IDX-Stock_snapshots: BEGIN
[0m18:33:30.884311 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:33:30.905700 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m18:33:30.906690 [debug] [ThreadPool]: Using postgres connection "list_IDX-Stock_snapshots"
[0m18:33:30.907710 [debug] [ThreadPool]: On list_IDX-Stock_snapshots: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "connection_name": "list_IDX-Stock_snapshots"} */
select
      'IDX-Stock' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'snapshots'
    union all
    select
      'IDX-Stock' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'snapshots'
    union all
    select
      'IDX-Stock' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'snapshots'
  
[0m18:33:30.912162 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.0 seconds
[0m18:33:30.914180 [debug] [ThreadPool]: On list_IDX-Stock_snapshots: ROLLBACK
[0m18:33:30.916146 [debug] [ThreadPool]: On list_IDX-Stock_snapshots: Close
[0m18:33:30.924721 [debug] [MainThread]: Using postgres connection "master"
[0m18:33:30.925722 [debug] [MainThread]: On master: BEGIN
[0m18:33:30.926686 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:33:30.947235 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m18:33:30.948748 [debug] [MainThread]: Using postgres connection "master"
[0m18:33:30.949755 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m18:33:30.959800 [debug] [MainThread]: SQL status: SELECT 6 in 0.0 seconds
[0m18:33:30.962844 [debug] [MainThread]: On master: ROLLBACK
[0m18:33:30.964807 [debug] [MainThread]: Using postgres connection "master"
[0m18:33:30.965858 [debug] [MainThread]: On master: BEGIN
[0m18:33:30.968807 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m18:33:30.969926 [debug] [MainThread]: On master: COMMIT
[0m18:33:30.970896 [debug] [MainThread]: Using postgres connection "master"
[0m18:33:30.971934 [debug] [MainThread]: On master: COMMIT
[0m18:33:30.973917 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m18:33:30.974909 [debug] [MainThread]: On master: Close
[0m18:33:30.975922 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:33:30.977922 [info ] [MainThread]: 
[0m18:33:30.985048 [debug] [Thread-1 (]: Began running node test.dbt_idx.accepted_values_customer_orders_status_order_status__delivered__invoiced__shipped__processing__canceled__unavailable.ea8c296d27
[0m18:33:30.986048 [info ] [Thread-1 (]: 1 of 9 START test accepted_values_customer_orders_status_order_status__delivered__invoiced__shipped__processing__canceled__unavailable  [RUN]
[0m18:33:30.988081 [debug] [Thread-1 (]: Acquiring new postgres connection 'test.dbt_idx.accepted_values_customer_orders_status_order_status__delivered__invoiced__shipped__processing__canceled__unavailable.ea8c296d27'
[0m18:33:30.988081 [debug] [Thread-1 (]: Began compiling node test.dbt_idx.accepted_values_customer_orders_status_order_status__delivered__invoiced__shipped__processing__canceled__unavailable.ea8c296d27
[0m18:33:31.009710 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_idx.accepted_values_customer_orders_status_order_status__delivered__invoiced__shipped__processing__canceled__unavailable.ea8c296d27"
[0m18:33:31.016969 [debug] [Thread-1 (]: Timing info for test.dbt_idx.accepted_values_customer_orders_status_order_status__delivered__invoiced__shipped__processing__canceled__unavailable.ea8c296d27 (compile): 18:33:30.989076 => 18:33:31.016969
[0m18:33:31.017980 [debug] [Thread-1 (]: Began executing node test.dbt_idx.accepted_values_customer_orders_status_order_status__delivered__invoiced__shipped__processing__canceled__unavailable.ea8c296d27
[0m18:33:31.034017 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_idx.accepted_values_customer_orders_status_order_status__delivered__invoiced__shipped__processing__canceled__unavailable.ea8c296d27"
[0m18:33:31.041679 [debug] [Thread-1 (]: Using postgres connection "test.dbt_idx.accepted_values_customer_orders_status_order_status__delivered__invoiced__shipped__processing__canceled__unavailable.ea8c296d27"
[0m18:33:31.043680 [debug] [Thread-1 (]: On test.dbt_idx.accepted_values_customer_orders_status_order_status__delivered__invoiced__shipped__processing__canceled__unavailable.ea8c296d27: BEGIN
[0m18:33:31.044715 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m18:33:31.066218 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m18:33:31.067249 [debug] [Thread-1 (]: Using postgres connection "test.dbt_idx.accepted_values_customer_orders_status_order_status__delivered__invoiced__shipped__processing__canceled__unavailable.ea8c296d27"
[0m18:33:31.067249 [debug] [Thread-1 (]: On test.dbt_idx.accepted_values_customer_orders_status_order_status__delivered__invoiced__shipped__processing__canceled__unavailable.ea8c296d27: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "test.dbt_idx.accepted_values_customer_orders_status_order_status__delivered__invoiced__shipped__processing__canceled__unavailable.ea8c296d27"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        order_status as value_field,
        count(*) as n_records

    from "IDX-Stock"."warehouse"."customer_orders_status"
    group by order_status

)

select *
from all_values
where value_field not in (
    'delivered','invoiced','shipped','processing','canceled','unavailable'
)



      
    ) dbt_internal_test
[0m18:33:31.072568 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m18:33:31.074597 [debug] [Thread-1 (]: Timing info for test.dbt_idx.accepted_values_customer_orders_status_order_status__delivered__invoiced__shipped__processing__canceled__unavailable.ea8c296d27 (execute): 18:33:31.018980 => 18:33:31.074597
[0m18:33:31.075598 [debug] [Thread-1 (]: On test.dbt_idx.accepted_values_customer_orders_status_order_status__delivered__invoiced__shipped__processing__canceled__unavailable.ea8c296d27: ROLLBACK
[0m18:33:31.077571 [debug] [Thread-1 (]: On test.dbt_idx.accepted_values_customer_orders_status_order_status__delivered__invoiced__shipped__processing__canceled__unavailable.ea8c296d27: Close
[0m18:33:31.080082 [info ] [Thread-1 (]: 1 of 9 PASS accepted_values_customer_orders_status_order_status__delivered__invoiced__shipped__processing__canceled__unavailable  [[32mPASS[0m in 0.09s]
[0m18:33:31.082083 [debug] [Thread-1 (]: Finished running node test.dbt_idx.accepted_values_customer_orders_status_order_status__delivered__invoiced__shipped__processing__canceled__unavailable.ea8c296d27
[0m18:33:31.083084 [debug] [Thread-1 (]: Began running node test.dbt_idx.assert_customer_dimension_has_no_row_loss.sql
[0m18:33:31.084083 [info ] [Thread-1 (]: 2 of 9 START test assert_customer_dimension_has_no_row_loss.sql ................ [RUN]
[0m18:33:31.085084 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_idx.accepted_values_customer_orders_status_order_status__delivered__invoiced__shipped__processing__canceled__unavailable.ea8c296d27, now test.dbt_idx.assert_customer_dimension_has_no_row_loss.sql)
[0m18:33:31.086119 [debug] [Thread-1 (]: Began compiling node test.dbt_idx.assert_customer_dimension_has_no_row_loss.sql
[0m18:33:31.089088 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_idx.assert_customer_dimension_has_no_row_loss.sql"
[0m18:33:31.097422 [debug] [Thread-1 (]: Timing info for test.dbt_idx.assert_customer_dimension_has_no_row_loss.sql (compile): 18:33:31.087084 => 18:33:31.096418
[0m18:33:31.099033 [debug] [Thread-1 (]: Began executing node test.dbt_idx.assert_customer_dimension_has_no_row_loss.sql
[0m18:33:31.101975 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_idx.assert_customer_dimension_has_no_row_loss.sql"
[0m18:33:31.109579 [debug] [Thread-1 (]: Using postgres connection "test.dbt_idx.assert_customer_dimension_has_no_row_loss.sql"
[0m18:33:31.112614 [debug] [Thread-1 (]: On test.dbt_idx.assert_customer_dimension_has_no_row_loss.sql: BEGIN
[0m18:33:31.113625 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:33:31.137735 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m18:33:31.138736 [debug] [Thread-1 (]: Using postgres connection "test.dbt_idx.assert_customer_dimension_has_no_row_loss.sql"
[0m18:33:31.139866 [debug] [Thread-1 (]: On test.dbt_idx.assert_customer_dimension_has_no_row_loss.sql: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "test.dbt_idx.assert_customer_dimension_has_no_row_loss.sql"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      -- dim_customers must have the same number of rows as its staging counterpart
-- Therefore return records where this isn't true to make the test fail
select *
from (
         select stg_cust.customer_id
         from "IDX-Stock"."warehouse"."stg_eltool__customers" stg_cust
             inner join "IDX-Stock"."warehouse"."dim_customers" dim_cust
         on stg_cust.customer_id = dim_cust.customer_id
         where dim_cust.customer_id is null
     ) tmp
      
    ) dbt_internal_test
[0m18:33:31.142871 [debug] [Thread-1 (]: Postgres adapter: Postgres error: column stg_cust.customer_id does not exist
LINE 14:          on stg_cust.customer_id = dim_cust.customer_id
                     ^
HINT:  Perhaps you meant to reference the column "dim_cust.customer_id".

[0m18:33:31.143900 [debug] [Thread-1 (]: On test.dbt_idx.assert_customer_dimension_has_no_row_loss.sql: ROLLBACK
[0m18:33:31.146878 [debug] [Thread-1 (]: Timing info for test.dbt_idx.assert_customer_dimension_has_no_row_loss.sql (execute): 18:33:31.099937 => 18:33:31.146878
[0m18:33:31.147889 [debug] [Thread-1 (]: On test.dbt_idx.assert_customer_dimension_has_no_row_loss.sql: Close
[0m18:33:31.167981 [debug] [Thread-1 (]: Database Error in test assert_customer_dimension_has_no_row_loss.sql (tests\assert_customer_dimension_has_no_row_loss.sql.sql)
  column stg_cust.customer_id does not exist
  LINE 14:          on stg_cust.customer_id = dim_cust.customer_id
                       ^
  HINT:  Perhaps you meant to reference the column "dim_cust.customer_id".
  compiled Code at target\run\dbt_idx\tests\assert_customer_dimension_has_no_row_loss.sql.sql
[0m18:33:31.168982 [error] [Thread-1 (]: 2 of 9 ERROR assert_customer_dimension_has_no_row_loss.sql ..................... [[31mERROR[0m in 0.08s]
[0m18:33:31.170498 [debug] [Thread-1 (]: Finished running node test.dbt_idx.assert_customer_dimension_has_no_row_loss.sql
[0m18:33:31.171535 [debug] [Thread-1 (]: Began running node test.dbt_idx.not_null_customer_orders_status_customer_id.3915c814eb
[0m18:33:31.172534 [info ] [Thread-1 (]: 3 of 9 START test not_null_customer_orders_status_customer_id .................. [RUN]
[0m18:33:31.173500 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_idx.assert_customer_dimension_has_no_row_loss.sql, now test.dbt_idx.not_null_customer_orders_status_customer_id.3915c814eb)
[0m18:33:31.174548 [debug] [Thread-1 (]: Began compiling node test.dbt_idx.not_null_customer_orders_status_customer_id.3915c814eb
[0m18:33:31.183558 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_idx.not_null_customer_orders_status_customer_id.3915c814eb"
[0m18:33:31.194094 [debug] [Thread-1 (]: Timing info for test.dbt_idx.not_null_customer_orders_status_customer_id.3915c814eb (compile): 18:33:31.174548 => 18:33:31.193106
[0m18:33:31.195087 [debug] [Thread-1 (]: Began executing node test.dbt_idx.not_null_customer_orders_status_customer_id.3915c814eb
[0m18:33:31.201090 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_idx.not_null_customer_orders_status_customer_id.3915c814eb"
[0m18:33:31.209089 [debug] [Thread-1 (]: Using postgres connection "test.dbt_idx.not_null_customer_orders_status_customer_id.3915c814eb"
[0m18:33:31.211298 [debug] [Thread-1 (]: On test.dbt_idx.not_null_customer_orders_status_customer_id.3915c814eb: BEGIN
[0m18:33:31.213298 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:33:31.236902 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m18:33:31.237901 [debug] [Thread-1 (]: Using postgres connection "test.dbt_idx.not_null_customer_orders_status_customer_id.3915c814eb"
[0m18:33:31.238912 [debug] [Thread-1 (]: On test.dbt_idx.not_null_customer_orders_status_customer_id.3915c814eb: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "test.dbt_idx.not_null_customer_orders_status_customer_id.3915c814eb"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select customer_id
from "IDX-Stock"."warehouse"."customer_orders_status"
where customer_id is null



      
    ) dbt_internal_test
[0m18:33:31.242576 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m18:33:31.245552 [debug] [Thread-1 (]: Timing info for test.dbt_idx.not_null_customer_orders_status_customer_id.3915c814eb (execute): 18:33:31.196121 => 18:33:31.244553
[0m18:33:31.246561 [debug] [Thread-1 (]: On test.dbt_idx.not_null_customer_orders_status_customer_id.3915c814eb: ROLLBACK
[0m18:33:31.249074 [debug] [Thread-1 (]: On test.dbt_idx.not_null_customer_orders_status_customer_id.3915c814eb: Close
[0m18:33:31.251090 [info ] [Thread-1 (]: 3 of 9 PASS not_null_customer_orders_status_customer_id ........................ [[32mPASS[0m in 0.08s]
[0m18:33:31.254094 [debug] [Thread-1 (]: Finished running node test.dbt_idx.not_null_customer_orders_status_customer_id.3915c814eb
[0m18:33:31.255087 [debug] [Thread-1 (]: Began running node test.dbt_idx.not_null_stg_eltool__customers_snapshots_customer_id.ea4fc4ca86
[0m18:33:31.256107 [info ] [Thread-1 (]: 4 of 9 START test not_null_stg_eltool__customers_snapshots_customer_id ......... [RUN]
[0m18:33:31.257128 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_idx.not_null_customer_orders_status_customer_id.3915c814eb, now test.dbt_idx.not_null_stg_eltool__customers_snapshots_customer_id.ea4fc4ca86)
[0m18:33:31.258134 [debug] [Thread-1 (]: Began compiling node test.dbt_idx.not_null_stg_eltool__customers_snapshots_customer_id.ea4fc4ca86
[0m18:33:31.263470 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_idx.not_null_stg_eltool__customers_snapshots_customer_id.ea4fc4ca86"
[0m18:33:31.273039 [debug] [Thread-1 (]: Timing info for test.dbt_idx.not_null_stg_eltool__customers_snapshots_customer_id.ea4fc4ca86 (compile): 18:33:31.259097 => 18:33:31.273039
[0m18:33:31.274038 [debug] [Thread-1 (]: Began executing node test.dbt_idx.not_null_stg_eltool__customers_snapshots_customer_id.ea4fc4ca86
[0m18:33:31.277036 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_idx.not_null_stg_eltool__customers_snapshots_customer_id.ea4fc4ca86"
[0m18:33:31.283314 [debug] [Thread-1 (]: Using postgres connection "test.dbt_idx.not_null_stg_eltool__customers_snapshots_customer_id.ea4fc4ca86"
[0m18:33:31.284821 [debug] [Thread-1 (]: On test.dbt_idx.not_null_stg_eltool__customers_snapshots_customer_id.ea4fc4ca86: BEGIN
[0m18:33:31.285832 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:33:31.312307 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m18:33:31.314330 [debug] [Thread-1 (]: Using postgres connection "test.dbt_idx.not_null_stg_eltool__customers_snapshots_customer_id.ea4fc4ca86"
[0m18:33:31.316309 [debug] [Thread-1 (]: On test.dbt_idx.not_null_stg_eltool__customers_snapshots_customer_id.ea4fc4ca86: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "test.dbt_idx.not_null_stg_eltool__customers_snapshots_customer_id.ea4fc4ca86"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select customer_id
from "IDX-Stock"."warehouse"."stg_eltool__customers_snapshots"
where customer_id is null



      
    ) dbt_internal_test
[0m18:33:31.320944 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m18:33:31.323957 [debug] [Thread-1 (]: Timing info for test.dbt_idx.not_null_stg_eltool__customers_snapshots_customer_id.ea4fc4ca86 (execute): 18:33:31.275037 => 18:33:31.322921
[0m18:33:31.324925 [debug] [Thread-1 (]: On test.dbt_idx.not_null_stg_eltool__customers_snapshots_customer_id.ea4fc4ca86: ROLLBACK
[0m18:33:31.327919 [debug] [Thread-1 (]: On test.dbt_idx.not_null_stg_eltool__customers_snapshots_customer_id.ea4fc4ca86: Close
[0m18:33:31.328919 [info ] [Thread-1 (]: 4 of 9 PASS not_null_stg_eltool__customers_snapshots_customer_id ............... [[32mPASS[0m in 0.07s]
[0m18:33:31.331369 [debug] [Thread-1 (]: Finished running node test.dbt_idx.not_null_stg_eltool__customers_snapshots_customer_id.ea4fc4ca86
[0m18:33:31.333407 [debug] [Thread-1 (]: Began running node test.dbt_idx.source_not_null_warehouse_customers_customer_id.ae7452c4c6
[0m18:33:31.334413 [info ] [Thread-1 (]: 5 of 9 START test source_not_null_warehouse_customers_customer_id .............. [RUN]
[0m18:33:31.335370 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_idx.not_null_stg_eltool__customers_snapshots_customer_id.ea4fc4ca86, now test.dbt_idx.source_not_null_warehouse_customers_customer_id.ae7452c4c6)
[0m18:33:31.336366 [debug] [Thread-1 (]: Began compiling node test.dbt_idx.source_not_null_warehouse_customers_customer_id.ae7452c4c6
[0m18:33:31.340958 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_idx.source_not_null_warehouse_customers_customer_id.ae7452c4c6"
[0m18:33:31.349006 [debug] [Thread-1 (]: Timing info for test.dbt_idx.source_not_null_warehouse_customers_customer_id.ae7452c4c6 (compile): 18:33:31.336366 => 18:33:31.348041
[0m18:33:31.349551 [debug] [Thread-1 (]: Began executing node test.dbt_idx.source_not_null_warehouse_customers_customer_id.ae7452c4c6
[0m18:33:31.353594 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_idx.source_not_null_warehouse_customers_customer_id.ae7452c4c6"
[0m18:33:31.360138 [debug] [Thread-1 (]: Using postgres connection "test.dbt_idx.source_not_null_warehouse_customers_customer_id.ae7452c4c6"
[0m18:33:31.361705 [debug] [Thread-1 (]: On test.dbt_idx.source_not_null_warehouse_customers_customer_id.ae7452c4c6: BEGIN
[0m18:33:31.362701 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:33:31.384531 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m18:33:31.385562 [debug] [Thread-1 (]: Using postgres connection "test.dbt_idx.source_not_null_warehouse_customers_customer_id.ae7452c4c6"
[0m18:33:31.386529 [debug] [Thread-1 (]: On test.dbt_idx.source_not_null_warehouse_customers_customer_id.ae7452c4c6: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "test.dbt_idx.source_not_null_warehouse_customers_customer_id.ae7452c4c6"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select customer_id
from "IDX-Stock"."warehouse"."customers"
where customer_id is null



      
    ) dbt_internal_test
[0m18:33:31.389142 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m18:33:31.391047 [debug] [Thread-1 (]: Timing info for test.dbt_idx.source_not_null_warehouse_customers_customer_id.ae7452c4c6 (execute): 18:33:31.351587 => 18:33:31.391047
[0m18:33:31.392049 [debug] [Thread-1 (]: On test.dbt_idx.source_not_null_warehouse_customers_customer_id.ae7452c4c6: ROLLBACK
[0m18:33:31.394048 [debug] [Thread-1 (]: On test.dbt_idx.source_not_null_warehouse_customers_customer_id.ae7452c4c6: Close
[0m18:33:31.396065 [info ] [Thread-1 (]: 5 of 9 PASS source_not_null_warehouse_customers_customer_id .................... [[32mPASS[0m in 0.06s]
[0m18:33:31.398044 [debug] [Thread-1 (]: Finished running node test.dbt_idx.source_not_null_warehouse_customers_customer_id.ae7452c4c6
[0m18:33:31.400139 [debug] [Thread-1 (]: Began running node test.dbt_idx.source_not_null_warehouse_orders_order_id.c85a1f0b76
[0m18:33:31.402174 [info ] [Thread-1 (]: 6 of 9 START test source_not_null_warehouse_orders_order_id .................... [RUN]
[0m18:33:31.403138 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_idx.source_not_null_warehouse_customers_customer_id.ae7452c4c6, now test.dbt_idx.source_not_null_warehouse_orders_order_id.c85a1f0b76)
[0m18:33:31.404175 [debug] [Thread-1 (]: Began compiling node test.dbt_idx.source_not_null_warehouse_orders_order_id.c85a1f0b76
[0m18:33:31.410507 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_idx.source_not_null_warehouse_orders_order_id.c85a1f0b76"
[0m18:33:31.417530 [debug] [Thread-1 (]: Timing info for test.dbt_idx.source_not_null_warehouse_orders_order_id.c85a1f0b76 (compile): 18:33:31.404175 => 18:33:31.417530
[0m18:33:31.420045 [debug] [Thread-1 (]: Began executing node test.dbt_idx.source_not_null_warehouse_orders_order_id.c85a1f0b76
[0m18:33:31.423052 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_idx.source_not_null_warehouse_orders_order_id.c85a1f0b76"
[0m18:33:31.429599 [debug] [Thread-1 (]: Using postgres connection "test.dbt_idx.source_not_null_warehouse_orders_order_id.c85a1f0b76"
[0m18:33:31.431641 [debug] [Thread-1 (]: On test.dbt_idx.source_not_null_warehouse_orders_order_id.c85a1f0b76: BEGIN
[0m18:33:31.431641 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:33:31.453828 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m18:33:31.454860 [debug] [Thread-1 (]: Using postgres connection "test.dbt_idx.source_not_null_warehouse_orders_order_id.c85a1f0b76"
[0m18:33:31.455889 [debug] [Thread-1 (]: On test.dbt_idx.source_not_null_warehouse_orders_order_id.c85a1f0b76: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "test.dbt_idx.source_not_null_warehouse_orders_order_id.c85a1f0b76"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select order_id
from "IDX-Stock"."warehouse"."orders"
where order_id is null



      
    ) dbt_internal_test
[0m18:33:31.458825 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m18:33:31.461424 [debug] [Thread-1 (]: Timing info for test.dbt_idx.source_not_null_warehouse_orders_order_id.c85a1f0b76 (execute): 18:33:31.421051 => 18:33:31.460531
[0m18:33:31.462390 [debug] [Thread-1 (]: On test.dbt_idx.source_not_null_warehouse_orders_order_id.c85a1f0b76: ROLLBACK
[0m18:33:31.464393 [debug] [Thread-1 (]: On test.dbt_idx.source_not_null_warehouse_orders_order_id.c85a1f0b76: Close
[0m18:33:31.466392 [info ] [Thread-1 (]: 6 of 9 PASS source_not_null_warehouse_orders_order_id .......................... [[32mPASS[0m in 0.06s]
[0m18:33:31.467394 [debug] [Thread-1 (]: Finished running node test.dbt_idx.source_not_null_warehouse_orders_order_id.c85a1f0b76
[0m18:33:31.469946 [debug] [Thread-1 (]: Began running node test.dbt_idx.source_relationships_warehouse_orders_cust_id__customer_id__source_warehouse_customers_.d3f9188fc2
[0m18:33:31.470956 [info ] [Thread-1 (]: 7 of 9 START test source_relationships_warehouse_orders_cust_id__customer_id__source_warehouse_customers_  [RUN]
[0m18:33:31.472924 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_idx.source_not_null_warehouse_orders_order_id.c85a1f0b76, now test.dbt_idx.source_relationships_warehouse_orders_cust_id__customer_id__source_warehouse_customers_.d3f9188fc2)
[0m18:33:31.473917 [debug] [Thread-1 (]: Began compiling node test.dbt_idx.source_relationships_warehouse_orders_cust_id__customer_id__source_warehouse_customers_.d3f9188fc2
[0m18:33:31.483557 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_idx.source_relationships_warehouse_orders_cust_id__customer_id__source_warehouse_customers_.d3f9188fc2"
[0m18:33:31.489948 [debug] [Thread-1 (]: Timing info for test.dbt_idx.source_relationships_warehouse_orders_cust_id__customer_id__source_warehouse_customers_.d3f9188fc2 (compile): 18:33:31.474936 => 18:33:31.489948
[0m18:33:31.490985 [debug] [Thread-1 (]: Began executing node test.dbt_idx.source_relationships_warehouse_orders_cust_id__customer_id__source_warehouse_customers_.d3f9188fc2
[0m18:33:31.494949 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_idx.source_relationships_warehouse_orders_cust_id__customer_id__source_warehouse_customers_.d3f9188fc2"
[0m18:33:31.501682 [debug] [Thread-1 (]: Using postgres connection "test.dbt_idx.source_relationships_warehouse_orders_cust_id__customer_id__source_warehouse_customers_.d3f9188fc2"
[0m18:33:31.502720 [debug] [Thread-1 (]: On test.dbt_idx.source_relationships_warehouse_orders_cust_id__customer_id__source_warehouse_customers_.d3f9188fc2: BEGIN
[0m18:33:31.503719 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:33:31.526319 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m18:33:31.527331 [debug] [Thread-1 (]: Using postgres connection "test.dbt_idx.source_relationships_warehouse_orders_cust_id__customer_id__source_warehouse_customers_.d3f9188fc2"
[0m18:33:31.528849 [debug] [Thread-1 (]: On test.dbt_idx.source_relationships_warehouse_orders_cust_id__customer_id__source_warehouse_customers_.d3f9188fc2: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "test.dbt_idx.source_relationships_warehouse_orders_cust_id__customer_id__source_warehouse_customers_.d3f9188fc2"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select cust_id as from_field
    from "IDX-Stock"."warehouse"."orders"
    where cust_id is not null
),

parent as (
    select customer_id as to_field
    from "IDX-Stock"."warehouse"."customers"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m18:33:31.532422 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m18:33:31.534452 [debug] [Thread-1 (]: Timing info for test.dbt_idx.source_relationships_warehouse_orders_cust_id__customer_id__source_warehouse_customers_.d3f9188fc2 (execute): 18:33:31.491954 => 18:33:31.534452
[0m18:33:31.535452 [debug] [Thread-1 (]: On test.dbt_idx.source_relationships_warehouse_orders_cust_id__customer_id__source_warehouse_customers_.d3f9188fc2: ROLLBACK
[0m18:33:31.537422 [debug] [Thread-1 (]: On test.dbt_idx.source_relationships_warehouse_orders_cust_id__customer_id__source_warehouse_customers_.d3f9188fc2: Close
[0m18:33:31.540976 [info ] [Thread-1 (]: 7 of 9 PASS source_relationships_warehouse_orders_cust_id__customer_id__source_warehouse_customers_  [[32mPASS[0m in 0.07s]
[0m18:33:31.542983 [debug] [Thread-1 (]: Finished running node test.dbt_idx.source_relationships_warehouse_orders_cust_id__customer_id__source_warehouse_customers_.d3f9188fc2
[0m18:33:31.543971 [debug] [Thread-1 (]: Began running node test.dbt_idx.source_unique_warehouse_orders_order_id.839fb43d0f
[0m18:33:31.545973 [info ] [Thread-1 (]: 8 of 9 START test source_unique_warehouse_orders_order_id ...................... [RUN]
[0m18:33:31.547975 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_idx.source_relationships_warehouse_orders_cust_id__customer_id__source_warehouse_customers_.d3f9188fc2, now test.dbt_idx.source_unique_warehouse_orders_order_id.839fb43d0f)
[0m18:33:31.548978 [debug] [Thread-1 (]: Began compiling node test.dbt_idx.source_unique_warehouse_orders_order_id.839fb43d0f
[0m18:33:31.557625 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_idx.source_unique_warehouse_orders_order_id.839fb43d0f"
[0m18:33:31.564813 [debug] [Thread-1 (]: Timing info for test.dbt_idx.source_unique_warehouse_orders_order_id.839fb43d0f (compile): 18:33:31.550584 => 18:33:31.564813
[0m18:33:31.565813 [debug] [Thread-1 (]: Began executing node test.dbt_idx.source_unique_warehouse_orders_order_id.839fb43d0f
[0m18:33:31.568810 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_idx.source_unique_warehouse_orders_order_id.839fb43d0f"
[0m18:33:31.576258 [debug] [Thread-1 (]: Using postgres connection "test.dbt_idx.source_unique_warehouse_orders_order_id.839fb43d0f"
[0m18:33:31.577298 [debug] [Thread-1 (]: On test.dbt_idx.source_unique_warehouse_orders_order_id.839fb43d0f: BEGIN
[0m18:33:31.577298 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:33:31.602905 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m18:33:31.603904 [debug] [Thread-1 (]: Using postgres connection "test.dbt_idx.source_unique_warehouse_orders_order_id.839fb43d0f"
[0m18:33:31.604908 [debug] [Thread-1 (]: On test.dbt_idx.source_unique_warehouse_orders_order_id.839fb43d0f: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "test.dbt_idx.source_unique_warehouse_orders_order_id.839fb43d0f"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    order_id as unique_field,
    count(*) as n_records

from "IDX-Stock"."warehouse"."orders"
where order_id is not null
group by order_id
having count(*) > 1



      
    ) dbt_internal_test
[0m18:33:31.608903 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m18:33:31.612296 [debug] [Thread-1 (]: Timing info for test.dbt_idx.source_unique_warehouse_orders_order_id.839fb43d0f (execute): 18:33:31.566810 => 18:33:31.611325
[0m18:33:31.613258 [debug] [Thread-1 (]: On test.dbt_idx.source_unique_warehouse_orders_order_id.839fb43d0f: ROLLBACK
[0m18:33:31.615256 [debug] [Thread-1 (]: On test.dbt_idx.source_unique_warehouse_orders_order_id.839fb43d0f: Close
[0m18:33:31.617272 [info ] [Thread-1 (]: 8 of 9 PASS source_unique_warehouse_orders_order_id ............................ [[32mPASS[0m in 0.07s]
[0m18:33:31.619790 [debug] [Thread-1 (]: Finished running node test.dbt_idx.source_unique_warehouse_orders_order_id.839fb43d0f
[0m18:33:31.620790 [debug] [Thread-1 (]: Began running node test.dbt_idx.unique_customer_orders_status_order_id.b7a45e83ee
[0m18:33:31.621788 [info ] [Thread-1 (]: 9 of 9 START test unique_customer_orders_status_order_id ....................... [RUN]
[0m18:33:31.623825 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_idx.source_unique_warehouse_orders_order_id.839fb43d0f, now test.dbt_idx.unique_customer_orders_status_order_id.b7a45e83ee)
[0m18:33:31.623825 [debug] [Thread-1 (]: Began compiling node test.dbt_idx.unique_customer_orders_status_order_id.b7a45e83ee
[0m18:33:31.628826 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_idx.unique_customer_orders_status_order_id.b7a45e83ee"
[0m18:33:31.636380 [debug] [Thread-1 (]: Timing info for test.dbt_idx.unique_customer_orders_status_order_id.b7a45e83ee (compile): 18:33:31.624823 => 18:33:31.635396
[0m18:33:31.637382 [debug] [Thread-1 (]: Began executing node test.dbt_idx.unique_customer_orders_status_order_id.b7a45e83ee
[0m18:33:31.639932 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_idx.unique_customer_orders_status_order_id.b7a45e83ee"
[0m18:33:31.648924 [debug] [Thread-1 (]: Using postgres connection "test.dbt_idx.unique_customer_orders_status_order_id.b7a45e83ee"
[0m18:33:31.650251 [debug] [Thread-1 (]: On test.dbt_idx.unique_customer_orders_status_order_id.b7a45e83ee: BEGIN
[0m18:33:31.651267 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:33:31.677145 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m18:33:31.678146 [debug] [Thread-1 (]: Using postgres connection "test.dbt_idx.unique_customer_orders_status_order_id.b7a45e83ee"
[0m18:33:31.679147 [debug] [Thread-1 (]: On test.dbt_idx.unique_customer_orders_status_order_id.b7a45e83ee: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "test.dbt_idx.unique_customer_orders_status_order_id.b7a45e83ee"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    order_id as unique_field,
    count(*) as n_records

from "IDX-Stock"."warehouse"."customer_orders_status"
where order_id is not null
group by order_id
having count(*) > 1



      
    ) dbt_internal_test
[0m18:33:31.683706 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m18:33:31.685704 [debug] [Thread-1 (]: Timing info for test.dbt_idx.unique_customer_orders_status_order_id.b7a45e83ee (execute): 18:33:31.637382 => 18:33:31.685704
[0m18:33:31.686700 [debug] [Thread-1 (]: On test.dbt_idx.unique_customer_orders_status_order_id.b7a45e83ee: ROLLBACK
[0m18:33:31.689179 [debug] [Thread-1 (]: On test.dbt_idx.unique_customer_orders_status_order_id.b7a45e83ee: Close
[0m18:33:31.692190 [info ] [Thread-1 (]: 9 of 9 PASS unique_customer_orders_status_order_id ............................. [[32mPASS[0m in 0.07s]
[0m18:33:31.694186 [debug] [Thread-1 (]: Finished running node test.dbt_idx.unique_customer_orders_status_order_id.b7a45e83ee
[0m18:33:31.697185 [debug] [MainThread]: Using postgres connection "master"
[0m18:33:31.697185 [debug] [MainThread]: On master: BEGIN
[0m18:33:31.698744 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:33:31.727750 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m18:33:31.728764 [debug] [MainThread]: On master: COMMIT
[0m18:33:31.729270 [debug] [MainThread]: Using postgres connection "master"
[0m18:33:31.730276 [debug] [MainThread]: On master: COMMIT
[0m18:33:31.733283 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m18:33:31.734283 [debug] [MainThread]: On master: Close
[0m18:33:31.736286 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:33:31.737288 [debug] [MainThread]: Connection 'list_IDX-Stock_snapshots' was properly closed.
[0m18:33:31.738795 [debug] [MainThread]: Connection 'test.dbt_idx.unique_customer_orders_status_order_id.b7a45e83ee' was properly closed.
[0m18:33:31.739803 [info ] [MainThread]: 
[0m18:33:31.740802 [info ] [MainThread]: Finished running 9 tests in 0 hours 0 minutes and 0.93 seconds (0.93s).
[0m18:33:31.743807 [debug] [MainThread]: Command end result
[0m18:33:31.764898 [info ] [MainThread]: 
[0m18:33:31.766876 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m18:33:31.767857 [info ] [MainThread]: 
[0m18:33:31.768889 [error] [MainThread]: [33mDatabase Error in test assert_customer_dimension_has_no_row_loss.sql (tests\assert_customer_dimension_has_no_row_loss.sql.sql)[0m
[0m18:33:31.771242 [error] [MainThread]:   column stg_cust.customer_id does not exist
[0m18:33:31.773263 [error] [MainThread]:   LINE 14:          on stg_cust.customer_id = dim_cust.customer_id
[0m18:33:31.774256 [error] [MainThread]:                        ^
[0m18:33:31.775241 [error] [MainThread]:   HINT:  Perhaps you meant to reference the column "dim_cust.customer_id".
[0m18:33:31.776241 [error] [MainThread]:   compiled Code at target\run\dbt_idx\tests\assert_customer_dimension_has_no_row_loss.sql.sql
[0m18:33:31.777240 [info ] [MainThread]: 
[0m18:33:31.778809 [info ] [MainThread]: Done. PASS=8 WARN=0 ERROR=1 SKIP=0 TOTAL=9
[0m18:33:31.779756 [debug] [MainThread]: Command `dbt test` failed at 18:33:31.779756 after 1.39 seconds
[0m18:33:31.780760 [debug] [MainThread]: Flushing usage events


============================== 18:34:28.435726 | e00a6d94-8be6-43e7-897a-ca04684ef5db ==============================
[0m18:34:28.435726 [info ] [MainThread]: Running with dbt=1.6.1
[0m18:34:28.442822 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'D:\\00 Project\\00 My Project\\IdeaProjects\\Py-DBT-IDX', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'D:\\00 Project\\00 My Project\\IdeaProjects\\Py-DBT-IDX\\logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'False'}
[0m18:34:28.668599 [info ] [MainThread]: Registered adapter: postgres=1.6.1
[0m18:34:28.708772 [debug] [MainThread]: checksum: efe19d9f5b93d1a98cc804fbfcdb6b3aced98b974af664946fee1cde8837deb7, vars: {}, profile: , target: , version: 1.6.1
[0m18:34:28.972938 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m18:34:28.974934 [debug] [MainThread]: Partial parsing: updated file: dbt_idx://models\staging\stg_eltool__customers.sql
[0m18:34:29.103229 [info ] [MainThread]: Found 1 snapshot, 9 tests, 7 models, 3 sources, 0 exposures, 0 metrics, 349 macros, 0 groups, 0 semantic models
[0m18:34:29.107261 [info ] [MainThread]: 
[0m18:34:29.109821 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m18:34:29.114342 [debug] [ThreadPool]: Acquiring new postgres connection 'list_IDX-Stock'
[0m18:34:29.138919 [debug] [ThreadPool]: Using postgres connection "list_IDX-Stock"
[0m18:34:29.139930 [debug] [ThreadPool]: On list_IDX-Stock: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "connection_name": "list_IDX-Stock"} */

    select distinct nspname from pg_namespace
  
[0m18:34:29.142351 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:34:29.186843 [debug] [ThreadPool]: SQL status: SELECT 13 in 0.0 seconds
[0m18:34:29.188845 [debug] [ThreadPool]: On list_IDX-Stock: Close
[0m18:34:29.193128 [debug] [ThreadPool]: Acquiring new postgres connection 'list_IDX-Stock_warehouse'
[0m18:34:29.202282 [debug] [ThreadPool]: Using postgres connection "list_IDX-Stock_warehouse"
[0m18:34:29.202282 [debug] [ThreadPool]: On list_IDX-Stock_warehouse: BEGIN
[0m18:34:29.203306 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:34:29.224520 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m18:34:29.225549 [debug] [ThreadPool]: Using postgres connection "list_IDX-Stock_warehouse"
[0m18:34:29.226548 [debug] [ThreadPool]: On list_IDX-Stock_warehouse: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "connection_name": "list_IDX-Stock_warehouse"} */
select
      'IDX-Stock' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'warehouse'
    union all
    select
      'IDX-Stock' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'warehouse'
    union all
    select
      'IDX-Stock' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'warehouse'
  
[0m18:34:29.232113 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.0 seconds
[0m18:34:29.234087 [debug] [ThreadPool]: On list_IDX-Stock_warehouse: ROLLBACK
[0m18:34:29.236081 [debug] [ThreadPool]: On list_IDX-Stock_warehouse: Close
[0m18:34:29.239109 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_IDX-Stock_warehouse, now list_IDX-Stock_snapshots)
[0m18:34:29.245129 [debug] [ThreadPool]: Using postgres connection "list_IDX-Stock_snapshots"
[0m18:34:29.246128 [debug] [ThreadPool]: On list_IDX-Stock_snapshots: BEGIN
[0m18:34:29.247129 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:34:29.269929 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m18:34:29.270926 [debug] [ThreadPool]: Using postgres connection "list_IDX-Stock_snapshots"
[0m18:34:29.270926 [debug] [ThreadPool]: On list_IDX-Stock_snapshots: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "connection_name": "list_IDX-Stock_snapshots"} */
select
      'IDX-Stock' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'snapshots'
    union all
    select
      'IDX-Stock' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'snapshots'
    union all
    select
      'IDX-Stock' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'snapshots'
  
[0m18:34:29.275982 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.0 seconds
[0m18:34:29.276933 [debug] [ThreadPool]: On list_IDX-Stock_snapshots: ROLLBACK
[0m18:34:29.280466 [debug] [ThreadPool]: On list_IDX-Stock_snapshots: Close
[0m18:34:29.287485 [debug] [MainThread]: Using postgres connection "master"
[0m18:34:29.288487 [debug] [MainThread]: On master: BEGIN
[0m18:34:29.289897 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:34:29.313112 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m18:34:29.314793 [debug] [MainThread]: Using postgres connection "master"
[0m18:34:29.315367 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m18:34:29.325898 [debug] [MainThread]: SQL status: SELECT 6 in 0.0 seconds
[0m18:34:29.332934 [debug] [MainThread]: On master: ROLLBACK
[0m18:34:29.335939 [debug] [MainThread]: Using postgres connection "master"
[0m18:34:29.336934 [debug] [MainThread]: On master: BEGIN
[0m18:34:29.342448 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m18:34:29.342448 [debug] [MainThread]: On master: COMMIT
[0m18:34:29.343959 [debug] [MainThread]: Using postgres connection "master"
[0m18:34:29.344984 [debug] [MainThread]: On master: COMMIT
[0m18:34:29.346994 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m18:34:29.348500 [debug] [MainThread]: On master: Close
[0m18:34:29.350513 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:34:29.352511 [info ] [MainThread]: 
[0m18:34:29.358558 [debug] [Thread-1 (]: Began running node model.dbt_idx.stg_eltool__customers
[0m18:34:29.360113 [info ] [Thread-1 (]: 1 of 7 START sql view model warehouse.stg_eltool__customers .................... [RUN]
[0m18:34:29.361084 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.dbt_idx.stg_eltool__customers'
[0m18:34:29.362116 [debug] [Thread-1 (]: Began compiling node model.dbt_idx.stg_eltool__customers
[0m18:34:29.370949 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_idx.stg_eltool__customers"
[0m18:34:29.380445 [debug] [Thread-1 (]: Timing info for model.dbt_idx.stg_eltool__customers (compile): 18:34:29.363139 => 18:34:29.379458
[0m18:34:29.380445 [debug] [Thread-1 (]: Began executing node model.dbt_idx.stg_eltool__customers
[0m18:34:29.421417 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_idx.stg_eltool__customers"
[0m18:34:29.428569 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__customers"
[0m18:34:29.429522 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__customers: BEGIN
[0m18:34:29.430597 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m18:34:29.457824 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m18:34:29.458841 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__customers"
[0m18:34:29.459393 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__customers: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__customers"} */

  create view "IDX-Stock"."warehouse"."stg_eltool__customers__dbt_tmp"
    
    
  as (
    with source as (select *
                from "IDX-Stock"."warehouse"."customers"),
     renamed as (select
                     customer_id,
                    'This is Dummy' as dummy
                 from source
                 where customer_id = 'dummy')
select *
from renamed
  );
[0m18:34:29.463442 [debug] [Thread-1 (]: Postgres adapter: Postgres error: invalid input syntax for type integer: "dummy"
LINE 13:                  where customer_id = 'dummy')
                                              ^

[0m18:34:29.464436 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__customers: ROLLBACK
[0m18:34:29.466985 [debug] [Thread-1 (]: Timing info for model.dbt_idx.stg_eltool__customers (execute): 18:34:29.381966 => 18:34:29.466985
[0m18:34:29.466985 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__customers: Close
[0m18:34:29.484466 [debug] [Thread-1 (]: Database Error in model stg_eltool__customers (models\staging\stg_eltool__customers.sql)
  invalid input syntax for type integer: "dummy"
  LINE 13:                  where customer_id = 'dummy')
                                                ^
  compiled Code at target\run\dbt_idx\models\staging\stg_eltool__customers.sql
[0m18:34:29.485467 [error] [Thread-1 (]: 1 of 7 ERROR creating sql view model warehouse.stg_eltool__customers ........... [[31mERROR[0m in 0.12s]
[0m18:34:29.487468 [debug] [Thread-1 (]: Finished running node model.dbt_idx.stg_eltool__customers
[0m18:34:29.488477 [debug] [Thread-1 (]: Began running node model.dbt_idx.stg_eltool__customers_snapshots
[0m18:34:29.488989 [info ] [Thread-1 (]: 2 of 7 START sql view model warehouse.stg_eltool__customers_snapshots .......... [RUN]
[0m18:34:29.491002 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_idx.stg_eltool__customers, now model.dbt_idx.stg_eltool__customers_snapshots)
[0m18:34:29.492018 [debug] [Thread-1 (]: Began compiling node model.dbt_idx.stg_eltool__customers_snapshots
[0m18:34:29.498562 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_idx.stg_eltool__customers_snapshots"
[0m18:34:29.507538 [debug] [Thread-1 (]: Timing info for model.dbt_idx.stg_eltool__customers_snapshots (compile): 18:34:29.492997 => 18:34:29.507538
[0m18:34:29.508602 [debug] [Thread-1 (]: Began executing node model.dbt_idx.stg_eltool__customers_snapshots
[0m18:34:29.517720 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_idx.stg_eltool__customers_snapshots"
[0m18:34:29.525335 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__customers_snapshots"
[0m18:34:29.527333 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__customers_snapshots: BEGIN
[0m18:34:29.527333 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:34:29.551790 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m18:34:29.552843 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__customers_snapshots"
[0m18:34:29.553822 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__customers_snapshots: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__customers_snapshots"} */

  create view "IDX-Stock"."warehouse"."stg_eltool__customers_snapshots__dbt_tmp"
    
    
  as (
    with source as (select *
                from "IDX-Stock"."snapshots"."customers_snapshot"),
     renamed as (select customer_id,
                        zipcode,
                        city,
                        state_code,
                        datetime_created::TIMESTAMP AS datetime_created,
                        datetime_updated::TIMESTAMP AS datetime_updated,
                        dbt_valid_from,
                        dbt_valid_to
                 from source)
select *
from renamed
  );
[0m18:34:29.560596 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m18:34:29.580106 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__customers_snapshots"
[0m18:34:29.581834 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__customers_snapshots: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__customers_snapshots"} */
alter table "IDX-Stock"."warehouse"."stg_eltool__customers_snapshots" rename to "stg_eltool__customers_snapshots__dbt_backup"
[0m18:34:29.586001 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:34:29.591853 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__customers_snapshots"
[0m18:34:29.592870 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__customers_snapshots: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__customers_snapshots"} */
alter table "IDX-Stock"."warehouse"."stg_eltool__customers_snapshots__dbt_tmp" rename to "stg_eltool__customers_snapshots"
[0m18:34:29.595864 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:34:29.615045 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__customers_snapshots: COMMIT
[0m18:34:29.616031 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__customers_snapshots"
[0m18:34:29.617010 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__customers_snapshots: COMMIT
[0m18:34:29.620581 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m18:34:29.631162 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__customers_snapshots"
[0m18:34:29.632161 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__customers_snapshots: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__customers_snapshots"} */
drop view if exists "IDX-Stock"."warehouse"."stg_eltool__customers_snapshots__dbt_backup" cascade
[0m18:34:29.637170 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m18:34:29.640697 [debug] [Thread-1 (]: Timing info for model.dbt_idx.stg_eltool__customers_snapshots (execute): 18:34:29.509144 => 18:34:29.640697
[0m18:34:29.642227 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__customers_snapshots: Close
[0m18:34:29.645239 [info ] [Thread-1 (]: 2 of 7 OK created sql view model warehouse.stg_eltool__customers_snapshots ..... [[32mCREATE VIEW[0m in 0.15s]
[0m18:34:29.647242 [debug] [Thread-1 (]: Finished running node model.dbt_idx.stg_eltool__customers_snapshots
[0m18:34:29.648832 [debug] [Thread-1 (]: Began running node model.dbt_idx.stg_eltool__orders
[0m18:34:29.649759 [info ] [Thread-1 (]: 3 of 7 START sql view model warehouse.stg_eltool__orders ....................... [RUN]
[0m18:34:29.650730 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_idx.stg_eltool__customers_snapshots, now model.dbt_idx.stg_eltool__orders)
[0m18:34:29.651782 [debug] [Thread-1 (]: Began compiling node model.dbt_idx.stg_eltool__orders
[0m18:34:29.654780 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_idx.stg_eltool__orders"
[0m18:34:29.666330 [debug] [Thread-1 (]: Timing info for model.dbt_idx.stg_eltool__orders (compile): 18:34:29.652755 => 18:34:29.666330
[0m18:34:29.667332 [debug] [Thread-1 (]: Began executing node model.dbt_idx.stg_eltool__orders
[0m18:34:29.676887 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_idx.stg_eltool__orders"
[0m18:34:29.692156 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__orders"
[0m18:34:29.694185 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__orders: BEGIN
[0m18:34:29.695164 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:34:29.725599 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m18:34:29.727166 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__orders"
[0m18:34:29.729342 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__orders: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__orders"} */

  create view "IDX-Stock"."warehouse"."stg_eltool__orders__dbt_tmp"
    
    
  as (
    with source as (select *
                from "IDX-Stock"."warehouse"."orders"),
     renamed as (select order_id,
                        cust_id AS customer_id,
                        order_status,
                        order_purchase_timestamp::TIMESTAMP,
                        order_approved_at::TIMESTAMP,
                        order_delivered_carrier_date::TIMESTAMP,
                        order_delivered_customer_date::TIMESTAMP,
                        order_estimated_delivery_date::TIMESTAMP
                 from source)
select *
from renamed
  );
[0m18:34:29.736580 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m18:34:29.744685 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__orders"
[0m18:34:29.745284 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__orders: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__orders"} */
alter table "IDX-Stock"."warehouse"."stg_eltool__orders" rename to "stg_eltool__orders__dbt_backup"
[0m18:34:29.747559 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:34:29.752773 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__orders"
[0m18:34:29.753452 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__orders: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__orders"} */
alter table "IDX-Stock"."warehouse"."stg_eltool__orders__dbt_tmp" rename to "stg_eltool__orders"
[0m18:34:29.755974 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:34:29.758658 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__orders: COMMIT
[0m18:34:29.760549 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__orders"
[0m18:34:29.761561 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__orders: COMMIT
[0m18:34:29.765545 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m18:34:29.768584 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__orders"
[0m18:34:29.769127 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__orders: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__orders"} */
drop view if exists "IDX-Stock"."warehouse"."stg_eltool__orders__dbt_backup" cascade
[0m18:34:29.774468 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m18:34:29.776482 [debug] [Thread-1 (]: Timing info for model.dbt_idx.stg_eltool__orders (execute): 18:34:29.667332 => 18:34:29.776482
[0m18:34:29.777465 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__orders: Close
[0m18:34:29.778975 [info ] [Thread-1 (]: 3 of 7 OK created sql view model warehouse.stg_eltool__orders .................. [[32mCREATE VIEW[0m in 0.13s]
[0m18:34:29.781989 [debug] [Thread-1 (]: Finished running node model.dbt_idx.stg_eltool__orders
[0m18:34:29.782998 [debug] [Thread-1 (]: Began running node model.dbt_idx.stg_eltool__state
[0m18:34:29.784985 [info ] [Thread-1 (]: 4 of 7 START sql view model warehouse.stg_eltool__state ........................ [RUN]
[0m18:34:29.786983 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_idx.stg_eltool__orders, now model.dbt_idx.stg_eltool__state)
[0m18:34:29.786983 [debug] [Thread-1 (]: Began compiling node model.dbt_idx.stg_eltool__state
[0m18:34:29.790496 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_idx.stg_eltool__state"
[0m18:34:29.797510 [debug] [Thread-1 (]: Timing info for model.dbt_idx.stg_eltool__state (compile): 18:34:29.786983 => 18:34:29.797510
[0m18:34:29.798536 [debug] [Thread-1 (]: Began executing node model.dbt_idx.stg_eltool__state
[0m18:34:29.804674 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_idx.stg_eltool__state"
[0m18:34:29.813916 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__state"
[0m18:34:29.815022 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__state: BEGIN
[0m18:34:29.816019 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:34:29.845832 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m18:34:29.846831 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__state"
[0m18:34:29.847831 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__state: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__state"} */

  create view "IDX-Stock"."warehouse"."stg_eltool__state__dbt_tmp"
    
    
  as (
    with source as (select *
                from "IDX-Stock"."warehouse"."state"),
     renamed as (select state_identifier::INT AS state_id,
                         state_code::VARCHAR(2) AS state_code,
                         st_name::VARCHAR(30) AS state_name
                 from source)
select *
from renamed
  );
[0m18:34:29.851909 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m18:34:29.855940 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__state"
[0m18:34:29.856909 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__state: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__state"} */
alter table "IDX-Stock"."warehouse"."stg_eltool__state" rename to "stg_eltool__state__dbt_backup"
[0m18:34:29.860009 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:34:29.865046 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__state"
[0m18:34:29.866026 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__state: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__state"} */
alter table "IDX-Stock"."warehouse"."stg_eltool__state__dbt_tmp" rename to "stg_eltool__state"
[0m18:34:29.868938 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:34:29.871985 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__state: COMMIT
[0m18:34:29.872973 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__state"
[0m18:34:29.874990 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__state: COMMIT
[0m18:34:29.876950 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m18:34:29.881488 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__state"
[0m18:34:29.882491 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__state: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__state"} */
drop view if exists "IDX-Stock"."warehouse"."stg_eltool__state__dbt_backup" cascade
[0m18:34:29.885857 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m18:34:29.887890 [debug] [Thread-1 (]: Timing info for model.dbt_idx.stg_eltool__state (execute): 18:34:29.799666 => 18:34:29.887890
[0m18:34:29.888901 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__state: Close
[0m18:34:29.891457 [info ] [Thread-1 (]: 4 of 7 OK created sql view model warehouse.stg_eltool__state ................... [[32mCREATE VIEW[0m in 0.10s]
[0m18:34:29.893453 [debug] [Thread-1 (]: Finished running node model.dbt_idx.stg_eltool__state
[0m18:34:29.895454 [debug] [Thread-1 (]: Began running node model.dbt_idx.fact_orders
[0m18:34:29.896453 [info ] [Thread-1 (]: 5 of 7 START sql table model warehouse.fact_orders ............................. [RUN]
[0m18:34:29.898453 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_idx.stg_eltool__state, now model.dbt_idx.fact_orders)
[0m18:34:29.898986 [debug] [Thread-1 (]: Began compiling node model.dbt_idx.fact_orders
[0m18:34:29.901997 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_idx.fact_orders"
[0m18:34:29.909537 [debug] [Thread-1 (]: Timing info for model.dbt_idx.fact_orders (compile): 18:34:29.899998 => 18:34:29.908526
[0m18:34:29.910537 [debug] [Thread-1 (]: Began executing node model.dbt_idx.fact_orders
[0m18:34:29.939690 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_idx.fact_orders"
[0m18:34:29.947203 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.fact_orders"
[0m18:34:29.947203 [debug] [Thread-1 (]: On model.dbt_idx.fact_orders: BEGIN
[0m18:34:29.948802 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:34:29.970809 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m18:34:29.971826 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.fact_orders"
[0m18:34:29.972805 [debug] [Thread-1 (]: On model.dbt_idx.fact_orders: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.fact_orders"} */

  
    

  create  table "IDX-Stock"."warehouse"."fact_orders__dbt_tmp"
  
  
    as
  
  (
    with orders as (
    select *
    from "IDX-Stock"."warehouse"."stg_eltool__orders"
)
select * from orders
  );
  
[0m18:34:29.979335 [debug] [Thread-1 (]: SQL status: SELECT 999 in 0.0 seconds
[0m18:34:29.984378 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.fact_orders"
[0m18:34:29.985348 [debug] [Thread-1 (]: On model.dbt_idx.fact_orders: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.fact_orders"} */
alter table "IDX-Stock"."warehouse"."fact_orders" rename to "fact_orders__dbt_backup"
[0m18:34:29.987362 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:34:29.991910 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.fact_orders"
[0m18:34:29.991910 [debug] [Thread-1 (]: On model.dbt_idx.fact_orders: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.fact_orders"} */
alter table "IDX-Stock"."warehouse"."fact_orders__dbt_tmp" rename to "fact_orders"
[0m18:34:29.994877 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:34:30.000377 [debug] [Thread-1 (]: On model.dbt_idx.fact_orders: COMMIT
[0m18:34:30.001409 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.fact_orders"
[0m18:34:30.002419 [debug] [Thread-1 (]: On model.dbt_idx.fact_orders: COMMIT
[0m18:34:30.006372 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m18:34:30.011981 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.fact_orders"
[0m18:34:30.012945 [debug] [Thread-1 (]: On model.dbt_idx.fact_orders: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.fact_orders"} */
drop table if exists "IDX-Stock"."warehouse"."fact_orders__dbt_backup" cascade
[0m18:34:30.017764 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m18:34:30.020240 [debug] [Thread-1 (]: Timing info for model.dbt_idx.fact_orders (execute): 18:34:29.911562 => 18:34:30.020240
[0m18:34:30.021242 [debug] [Thread-1 (]: On model.dbt_idx.fact_orders: Close
[0m18:34:30.023243 [info ] [Thread-1 (]: 5 of 7 OK created sql table model warehouse.fact_orders ........................ [[32mSELECT 999[0m in 0.13s]
[0m18:34:30.025249 [debug] [Thread-1 (]: Finished running node model.dbt_idx.fact_orders
[0m18:34:30.026262 [debug] [Thread-1 (]: Began running node model.dbt_idx.dim_customers
[0m18:34:30.027267 [info ] [Thread-1 (]: 6 of 7 START sql table model warehouse.dim_customers ........................... [RUN]
[0m18:34:30.028774 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_idx.fact_orders, now model.dbt_idx.dim_customers)
[0m18:34:30.029792 [debug] [Thread-1 (]: Began compiling node model.dbt_idx.dim_customers
[0m18:34:30.033781 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_idx.dim_customers"
[0m18:34:30.040936 [debug] [Thread-1 (]: Timing info for model.dbt_idx.dim_customers (compile): 18:34:30.030782 => 18:34:30.040936
[0m18:34:30.041952 [debug] [Thread-1 (]: Began executing node model.dbt_idx.dim_customers
[0m18:34:30.046971 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_idx.dim_customers"
[0m18:34:30.054530 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.dim_customers"
[0m18:34:30.055524 [debug] [Thread-1 (]: On model.dbt_idx.dim_customers: BEGIN
[0m18:34:30.055524 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:34:30.078594 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m18:34:30.080115 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.dim_customers"
[0m18:34:30.081124 [debug] [Thread-1 (]: On model.dbt_idx.dim_customers: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.dim_customers"} */

  
    

  create  table "IDX-Stock"."warehouse"."dim_customers__dbt_tmp"
  
  
    as
  
  (
    -- noinspection SqlDialectInspectionForFile

with customers as (
    select *
    from "IDX-Stock"."warehouse"."stg_eltool__customers_snapshots"
    ),
     state as (
         select *
         from "IDX-Stock"."warehouse"."stg_eltool__state"
     )
select c.customer_id,
       c.zipcode,
       c.city,
       c.state_code,
       s.state_name,
       c.datetime_created,
       c.datetime_updated,
       c.dbt_valid_from::TIMESTAMP as valid_from,
        CASE WHEN c.dbt_valid_to IS NULL
            THEN '9999-12-31'::TIMESTAMP
            ELSE c.dbt_valid_to::TIMESTAMP
        END as valid_to
from customers c
    join state s on c.state_code = s.state_code
  );
  
[0m18:34:30.087163 [debug] [Thread-1 (]: SQL status: SELECT 105 in 0.0 seconds
[0m18:34:30.092683 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.dim_customers"
[0m18:34:30.093678 [debug] [Thread-1 (]: On model.dbt_idx.dim_customers: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.dim_customers"} */
alter table "IDX-Stock"."warehouse"."dim_customers" rename to "dim_customers__dbt_backup"
[0m18:34:30.096679 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:34:30.102264 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.dim_customers"
[0m18:34:30.103300 [debug] [Thread-1 (]: On model.dbt_idx.dim_customers: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.dim_customers"} */
alter table "IDX-Stock"."warehouse"."dim_customers__dbt_tmp" rename to "dim_customers"
[0m18:34:30.106288 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:34:30.109810 [debug] [Thread-1 (]: On model.dbt_idx.dim_customers: COMMIT
[0m18:34:30.110778 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.dim_customers"
[0m18:34:30.111783 [debug] [Thread-1 (]: On model.dbt_idx.dim_customers: COMMIT
[0m18:34:30.116399 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m18:34:30.119931 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.dim_customers"
[0m18:34:30.121937 [debug] [Thread-1 (]: On model.dbt_idx.dim_customers: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.dim_customers"} */
drop table if exists "IDX-Stock"."warehouse"."dim_customers__dbt_backup" cascade
[0m18:34:30.126932 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m18:34:30.129445 [debug] [Thread-1 (]: Timing info for model.dbt_idx.dim_customers (execute): 18:34:30.041952 => 18:34:30.129445
[0m18:34:30.130478 [debug] [Thread-1 (]: On model.dbt_idx.dim_customers: Close
[0m18:34:30.132459 [info ] [Thread-1 (]: 6 of 7 OK created sql table model warehouse.dim_customers ...................... [[32mSELECT 105[0m in 0.11s]
[0m18:34:30.135489 [debug] [Thread-1 (]: Finished running node model.dbt_idx.dim_customers
[0m18:34:30.136460 [debug] [Thread-1 (]: Began running node model.dbt_idx.customer_orders_status
[0m18:34:30.138981 [info ] [Thread-1 (]: 7 of 7 START sql view model warehouse.customer_orders_status ................... [RUN]
[0m18:34:30.142523 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_idx.dim_customers, now model.dbt_idx.customer_orders_status)
[0m18:34:30.143549 [debug] [Thread-1 (]: Began compiling node model.dbt_idx.customer_orders_status
[0m18:34:30.151671 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_idx.customer_orders_status"
[0m18:34:30.160222 [debug] [Thread-1 (]: Timing info for model.dbt_idx.customer_orders_status (compile): 18:34:30.145538 => 18:34:30.160222
[0m18:34:30.161202 [debug] [Thread-1 (]: Began executing node model.dbt_idx.customer_orders_status
[0m18:34:30.167188 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_idx.customer_orders_status"
[0m18:34:30.174707 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.customer_orders_status"
[0m18:34:30.175708 [debug] [Thread-1 (]: On model.dbt_idx.customer_orders_status: BEGIN
[0m18:34:30.176711 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:34:30.202342 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m18:34:30.203371 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.customer_orders_status"
[0m18:34:30.204376 [debug] [Thread-1 (]: On model.dbt_idx.customer_orders_status: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.customer_orders_status"} */

  create view "IDX-Stock"."warehouse"."customer_orders_status__dbt_tmp"
    
    
  as (
    with orders as (select *
                from "IDX-Stock"."warehouse"."fact_orders"),
     customers as (select *
                   from "IDX-Stock"."warehouse"."dim_customers")
select o.order_id,
       o.customer_id,
       o.order_status,
       o.order_purchase_timestamp,
       o.order_approved_at,
       o.order_delivered_carrier_date,
       o.order_delivered_customer_date,
       o.order_estimated_delivery_date,
       c.zipcode    as customer_zipcode,
       c.city       as customer_city,
       c.state_code as customer_state_code,
       c.state_name as customer_state_name
from orders o
    join customers c on o.customer_id = c.customer_id
    and o.order_purchase_timestamp >= c.valid_from
    and o.order_purchase_timestamp <= c.valid_to
  );
[0m18:34:30.208940 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m18:34:30.212910 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.customer_orders_status"
[0m18:34:30.214429 [debug] [Thread-1 (]: On model.dbt_idx.customer_orders_status: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.customer_orders_status"} */
alter table "IDX-Stock"."warehouse"."customer_orders_status__dbt_tmp" rename to "customer_orders_status"
[0m18:34:30.216458 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:34:30.219018 [debug] [Thread-1 (]: On model.dbt_idx.customer_orders_status: COMMIT
[0m18:34:30.220032 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.customer_orders_status"
[0m18:34:30.221061 [debug] [Thread-1 (]: On model.dbt_idx.customer_orders_status: COMMIT
[0m18:34:30.224414 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m18:34:30.227427 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.customer_orders_status"
[0m18:34:30.229034 [debug] [Thread-1 (]: On model.dbt_idx.customer_orders_status: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.customer_orders_status"} */
drop view if exists "IDX-Stock"."warehouse"."customer_orders_status__dbt_backup" cascade
[0m18:34:30.231990 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m18:34:30.234993 [debug] [Thread-1 (]: Timing info for model.dbt_idx.customer_orders_status (execute): 18:34:30.162194 => 18:34:30.233980
[0m18:34:30.235981 [debug] [Thread-1 (]: On model.dbt_idx.customer_orders_status: Close
[0m18:34:30.236979 [info ] [Thread-1 (]: 7 of 7 OK created sql view model warehouse.customer_orders_status .............. [[32mCREATE VIEW[0m in 0.10s]
[0m18:34:30.240519 [debug] [Thread-1 (]: Finished running node model.dbt_idx.customer_orders_status
[0m18:34:30.243503 [debug] [MainThread]: Using postgres connection "master"
[0m18:34:30.243503 [debug] [MainThread]: On master: BEGIN
[0m18:34:30.244502 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:34:30.267753 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m18:34:30.269233 [debug] [MainThread]: On master: COMMIT
[0m18:34:30.270280 [debug] [MainThread]: Using postgres connection "master"
[0m18:34:30.270280 [debug] [MainThread]: On master: COMMIT
[0m18:34:30.273258 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m18:34:30.274257 [debug] [MainThread]: On master: Close
[0m18:34:30.275262 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:34:30.277261 [debug] [MainThread]: Connection 'list_IDX-Stock' was properly closed.
[0m18:34:30.277261 [debug] [MainThread]: Connection 'list_IDX-Stock_snapshots' was properly closed.
[0m18:34:30.278873 [debug] [MainThread]: Connection 'model.dbt_idx.customer_orders_status' was properly closed.
[0m18:34:30.280780 [info ] [MainThread]: 
[0m18:34:30.281345 [info ] [MainThread]: Finished running 5 view models, 2 table models in 0 hours 0 minutes and 1.17 seconds (1.17s).
[0m18:34:30.284356 [debug] [MainThread]: Command end result
[0m18:34:30.306605 [info ] [MainThread]: 
[0m18:34:30.308573 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m18:34:30.309997 [info ] [MainThread]: 
[0m18:34:30.311000 [error] [MainThread]: [33mDatabase Error in model stg_eltool__customers (models\staging\stg_eltool__customers.sql)[0m
[0m18:34:30.311994 [error] [MainThread]:   invalid input syntax for type integer: "dummy"
[0m18:34:30.312984 [error] [MainThread]:   LINE 13:                  where customer_id = 'dummy')
[0m18:34:30.314497 [error] [MainThread]:                                                 ^
[0m18:34:30.314497 [error] [MainThread]:   compiled Code at target\run\dbt_idx\models\staging\stg_eltool__customers.sql
[0m18:34:30.317052 [info ] [MainThread]: 
[0m18:34:30.317052 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=1 SKIP=0 TOTAL=7
[0m18:34:30.319584 [debug] [MainThread]: Command `dbt run` failed at 18:34:30.318564 after 1.92 seconds
[0m18:34:30.320108 [debug] [MainThread]: Flushing usage events


============================== 18:35:02.999893 | a1a0c423-78f5-41b5-8074-071948cb5248 ==============================
[0m18:35:02.999893 [info ] [MainThread]: Running with dbt=1.6.1
[0m18:35:03.004344 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': 'D:\\00 Project\\00 My Project\\IdeaProjects\\Py-DBT-IDX', 'log_path': 'D:\\00 Project\\00 My Project\\IdeaProjects\\Py-DBT-IDX\\logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'False'}
[0m18:35:03.151616 [info ] [MainThread]: Registered adapter: postgres=1.6.1
[0m18:35:03.164629 [debug] [MainThread]: checksum: efe19d9f5b93d1a98cc804fbfcdb6b3aced98b974af664946fee1cde8837deb7, vars: {}, profile: , target: , version: 1.6.1
[0m18:35:03.328614 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m18:35:03.330772 [debug] [MainThread]: Partial parsing: updated file: dbt_idx://models\staging\stg_eltool__customers.sql
[0m18:35:03.419087 [info ] [MainThread]: Found 1 snapshot, 9 tests, 7 models, 3 sources, 0 exposures, 0 metrics, 349 macros, 0 groups, 0 semantic models
[0m18:35:03.422131 [info ] [MainThread]: 
[0m18:35:03.423094 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m18:35:03.427131 [debug] [ThreadPool]: Acquiring new postgres connection 'list_IDX-Stock'
[0m18:35:03.437704 [debug] [ThreadPool]: Using postgres connection "list_IDX-Stock"
[0m18:35:03.438722 [debug] [ThreadPool]: On list_IDX-Stock: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "connection_name": "list_IDX-Stock"} */

    select distinct nspname from pg_namespace
  
[0m18:35:03.439946 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:35:03.473916 [debug] [ThreadPool]: SQL status: SELECT 13 in 0.0 seconds
[0m18:35:03.476913 [debug] [ThreadPool]: On list_IDX-Stock: Close
[0m18:35:03.480444 [debug] [ThreadPool]: Acquiring new postgres connection 'list_IDX-Stock_warehouse'
[0m18:35:03.487468 [debug] [ThreadPool]: Using postgres connection "list_IDX-Stock_warehouse"
[0m18:35:03.487468 [debug] [ThreadPool]: On list_IDX-Stock_warehouse: BEGIN
[0m18:35:03.488997 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:35:03.509715 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m18:35:03.510729 [debug] [ThreadPool]: Using postgres connection "list_IDX-Stock_warehouse"
[0m18:35:03.511720 [debug] [ThreadPool]: On list_IDX-Stock_warehouse: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "connection_name": "list_IDX-Stock_warehouse"} */
select
      'IDX-Stock' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'warehouse'
    union all
    select
      'IDX-Stock' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'warehouse'
    union all
    select
      'IDX-Stock' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'warehouse'
  
[0m18:35:03.516302 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.0 seconds
[0m18:35:03.517314 [debug] [ThreadPool]: On list_IDX-Stock_warehouse: ROLLBACK
[0m18:35:03.520838 [debug] [ThreadPool]: On list_IDX-Stock_warehouse: Close
[0m18:35:03.522839 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_IDX-Stock_warehouse, now list_IDX-Stock_snapshots)
[0m18:35:03.527838 [debug] [ThreadPool]: Using postgres connection "list_IDX-Stock_snapshots"
[0m18:35:03.529369 [debug] [ThreadPool]: On list_IDX-Stock_snapshots: BEGIN
[0m18:35:03.529369 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:35:03.550837 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m18:35:03.551837 [debug] [ThreadPool]: Using postgres connection "list_IDX-Stock_snapshots"
[0m18:35:03.551837 [debug] [ThreadPool]: On list_IDX-Stock_snapshots: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "connection_name": "list_IDX-Stock_snapshots"} */
select
      'IDX-Stock' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'snapshots'
    union all
    select
      'IDX-Stock' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'snapshots'
    union all
    select
      'IDX-Stock' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'snapshots'
  
[0m18:35:03.556848 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.0 seconds
[0m18:35:03.558446 [debug] [ThreadPool]: On list_IDX-Stock_snapshots: ROLLBACK
[0m18:35:03.560362 [debug] [ThreadPool]: On list_IDX-Stock_snapshots: Close
[0m18:35:03.568363 [debug] [MainThread]: Using postgres connection "master"
[0m18:35:03.569809 [debug] [MainThread]: On master: BEGIN
[0m18:35:03.570800 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:35:03.593099 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m18:35:03.594095 [debug] [MainThread]: Using postgres connection "master"
[0m18:35:03.595096 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m18:35:03.601628 [debug] [MainThread]: SQL status: SELECT 6 in 0.0 seconds
[0m18:35:03.604650 [debug] [MainThread]: On master: ROLLBACK
[0m18:35:03.606614 [debug] [MainThread]: Using postgres connection "master"
[0m18:35:03.607644 [debug] [MainThread]: On master: BEGIN
[0m18:35:03.611800 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m18:35:03.612785 [debug] [MainThread]: On master: COMMIT
[0m18:35:03.613800 [debug] [MainThread]: Using postgres connection "master"
[0m18:35:03.614796 [debug] [MainThread]: On master: COMMIT
[0m18:35:03.616804 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m18:35:03.617799 [debug] [MainThread]: On master: Close
[0m18:35:03.618792 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:35:03.620329 [info ] [MainThread]: 
[0m18:35:03.625320 [debug] [Thread-1 (]: Began running node model.dbt_idx.stg_eltool__customers
[0m18:35:03.626345 [info ] [Thread-1 (]: 1 of 7 START sql view model warehouse.stg_eltool__customers .................... [RUN]
[0m18:35:03.628345 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.dbt_idx.stg_eltool__customers'
[0m18:35:03.628899 [debug] [Thread-1 (]: Began compiling node model.dbt_idx.stg_eltool__customers
[0m18:35:03.636910 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_idx.stg_eltool__customers"
[0m18:35:03.644551 [debug] [Thread-1 (]: Timing info for model.dbt_idx.stg_eltool__customers (compile): 18:35:03.629915 => 18:35:03.644551
[0m18:35:03.645531 [debug] [Thread-1 (]: Began executing node model.dbt_idx.stg_eltool__customers
[0m18:35:03.682053 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_idx.stg_eltool__customers"
[0m18:35:03.688616 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__customers"
[0m18:35:03.689666 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__customers: BEGIN
[0m18:35:03.690624 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m18:35:03.713236 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m18:35:03.714259 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__customers"
[0m18:35:03.715217 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__customers: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__customers"} */

  create view "IDX-Stock"."warehouse"."stg_eltool__customers__dbt_tmp"
    
    
  as (
    with source as (select *
                from "IDX-Stock"."warehouse"."customers"),
     renamed as (select
                     customer_id,
                    'This is Dummy' as dummy
                 from source
                 where dummy = 'not found')
select *
from renamed
  );
[0m18:35:03.717220 [debug] [Thread-1 (]: Postgres adapter: Postgres error: column "dummy" does not exist
LINE 13:                  where dummy = 'not found')
                                ^

[0m18:35:03.717220 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__customers: ROLLBACK
[0m18:35:03.719778 [debug] [Thread-1 (]: Timing info for model.dbt_idx.stg_eltool__customers (execute): 18:35:03.645531 => 18:35:03.719778
[0m18:35:03.721793 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__customers: Close
[0m18:35:03.736033 [debug] [Thread-1 (]: Database Error in model stg_eltool__customers (models\staging\stg_eltool__customers.sql)
  column "dummy" does not exist
  LINE 13:                  where dummy = 'not found')
                                  ^
  compiled Code at target\run\dbt_idx\models\staging\stg_eltool__customers.sql
[0m18:35:03.737032 [error] [Thread-1 (]: 1 of 7 ERROR creating sql view model warehouse.stg_eltool__customers ........... [[31mERROR[0m in 0.11s]
[0m18:35:03.738636 [debug] [Thread-1 (]: Finished running node model.dbt_idx.stg_eltool__customers
[0m18:35:03.739551 [debug] [Thread-1 (]: Began running node model.dbt_idx.stg_eltool__customers_snapshots
[0m18:35:03.740976 [info ] [Thread-1 (]: 2 of 7 START sql view model warehouse.stg_eltool__customers_snapshots .......... [RUN]
[0m18:35:03.741986 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_idx.stg_eltool__customers, now model.dbt_idx.stg_eltool__customers_snapshots)
[0m18:35:03.741986 [debug] [Thread-1 (]: Began compiling node model.dbt_idx.stg_eltool__customers_snapshots
[0m18:35:03.745591 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_idx.stg_eltool__customers_snapshots"
[0m18:35:03.751924 [debug] [Thread-1 (]: Timing info for model.dbt_idx.stg_eltool__customers_snapshots (compile): 18:35:03.743658 => 18:35:03.751924
[0m18:35:03.752926 [debug] [Thread-1 (]: Began executing node model.dbt_idx.stg_eltool__customers_snapshots
[0m18:35:03.759440 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_idx.stg_eltool__customers_snapshots"
[0m18:35:03.766464 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__customers_snapshots"
[0m18:35:03.767438 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__customers_snapshots: BEGIN
[0m18:35:03.768438 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:35:03.792485 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m18:35:03.793501 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__customers_snapshots"
[0m18:35:03.794500 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__customers_snapshots: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__customers_snapshots"} */

  create view "IDX-Stock"."warehouse"."stg_eltool__customers_snapshots__dbt_tmp"
    
    
  as (
    with source as (select *
                from "IDX-Stock"."snapshots"."customers_snapshot"),
     renamed as (select customer_id,
                        zipcode,
                        city,
                        state_code,
                        datetime_created::TIMESTAMP AS datetime_created,
                        datetime_updated::TIMESTAMP AS datetime_updated,
                        dbt_valid_from,
                        dbt_valid_to
                 from source)
select *
from renamed
  );
[0m18:35:03.798998 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m18:35:03.806038 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__customers_snapshots"
[0m18:35:03.807027 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__customers_snapshots: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__customers_snapshots"} */
alter table "IDX-Stock"."warehouse"."stg_eltool__customers_snapshots" rename to "stg_eltool__customers_snapshots__dbt_backup"
[0m18:35:03.809876 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:35:03.813874 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__customers_snapshots"
[0m18:35:03.813874 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__customers_snapshots: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__customers_snapshots"} */
alter table "IDX-Stock"."warehouse"."stg_eltool__customers_snapshots__dbt_tmp" rename to "stg_eltool__customers_snapshots"
[0m18:35:03.816941 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:35:03.836841 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__customers_snapshots: COMMIT
[0m18:35:03.836841 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__customers_snapshots"
[0m18:35:03.838417 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__customers_snapshots: COMMIT
[0m18:35:03.843366 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m18:35:03.856040 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__customers_snapshots"
[0m18:35:03.857037 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__customers_snapshots: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__customers_snapshots"} */
drop view if exists "IDX-Stock"."warehouse"."stg_eltool__customers_snapshots__dbt_backup" cascade
[0m18:35:03.861548 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m18:35:03.863585 [debug] [Thread-1 (]: Timing info for model.dbt_idx.stg_eltool__customers_snapshots (execute): 18:35:03.753921 => 18:35:03.863585
[0m18:35:03.864553 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__customers_snapshots: Close
[0m18:35:03.866561 [info ] [Thread-1 (]: 2 of 7 OK created sql view model warehouse.stg_eltool__customers_snapshots ..... [[32mCREATE VIEW[0m in 0.12s]
[0m18:35:03.868556 [debug] [Thread-1 (]: Finished running node model.dbt_idx.stg_eltool__customers_snapshots
[0m18:35:03.869886 [debug] [Thread-1 (]: Began running node model.dbt_idx.stg_eltool__orders
[0m18:35:03.870914 [info ] [Thread-1 (]: 3 of 7 START sql view model warehouse.stg_eltool__orders ....................... [RUN]
[0m18:35:03.872879 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_idx.stg_eltool__customers_snapshots, now model.dbt_idx.stg_eltool__orders)
[0m18:35:03.873897 [debug] [Thread-1 (]: Began compiling node model.dbt_idx.stg_eltool__orders
[0m18:35:03.876915 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_idx.stg_eltool__orders"
[0m18:35:03.888947 [debug] [Thread-1 (]: Timing info for model.dbt_idx.stg_eltool__orders (compile): 18:35:03.873897 => 18:35:03.888947
[0m18:35:03.890954 [debug] [Thread-1 (]: Began executing node model.dbt_idx.stg_eltool__orders
[0m18:35:03.896989 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_idx.stg_eltool__orders"
[0m18:35:03.908587 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__orders"
[0m18:35:03.908587 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__orders: BEGIN
[0m18:35:03.909592 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:35:03.932326 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m18:35:03.933363 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__orders"
[0m18:35:03.935334 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__orders: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__orders"} */

  create view "IDX-Stock"."warehouse"."stg_eltool__orders__dbt_tmp"
    
    
  as (
    with source as (select *
                from "IDX-Stock"."warehouse"."orders"),
     renamed as (select order_id,
                        cust_id AS customer_id,
                        order_status,
                        order_purchase_timestamp::TIMESTAMP,
                        order_approved_at::TIMESTAMP,
                        order_delivered_carrier_date::TIMESTAMP,
                        order_delivered_customer_date::TIMESTAMP,
                        order_estimated_delivery_date::TIMESTAMP
                 from source)
select *
from renamed
  );
[0m18:35:03.939886 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m18:35:03.944484 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__orders"
[0m18:35:03.944484 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__orders: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__orders"} */
alter table "IDX-Stock"."warehouse"."stg_eltool__orders" rename to "stg_eltool__orders__dbt_backup"
[0m18:35:03.947414 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:35:03.951708 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__orders"
[0m18:35:03.951708 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__orders: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__orders"} */
alter table "IDX-Stock"."warehouse"."stg_eltool__orders__dbt_tmp" rename to "stg_eltool__orders"
[0m18:35:03.954698 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:35:03.957707 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__orders: COMMIT
[0m18:35:03.957707 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__orders"
[0m18:35:03.958709 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__orders: COMMIT
[0m18:35:03.962354 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m18:35:03.966371 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__orders"
[0m18:35:03.966371 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__orders: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__orders"} */
drop view if exists "IDX-Stock"."warehouse"."stg_eltool__orders__dbt_backup" cascade
[0m18:35:03.970910 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m18:35:03.972938 [debug] [Thread-1 (]: Timing info for model.dbt_idx.stg_eltool__orders (execute): 18:35:03.890954 => 18:35:03.972938
[0m18:35:03.973921 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__orders: Close
[0m18:35:03.976909 [info ] [Thread-1 (]: 3 of 7 OK created sql view model warehouse.stg_eltool__orders .................. [[32mCREATE VIEW[0m in 0.10s]
[0m18:35:03.980440 [debug] [Thread-1 (]: Finished running node model.dbt_idx.stg_eltool__orders
[0m18:35:03.981442 [debug] [Thread-1 (]: Began running node model.dbt_idx.stg_eltool__state
[0m18:35:03.982448 [info ] [Thread-1 (]: 4 of 7 START sql view model warehouse.stg_eltool__state ........................ [RUN]
[0m18:35:03.983437 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_idx.stg_eltool__orders, now model.dbt_idx.stg_eltool__state)
[0m18:35:03.984468 [debug] [Thread-1 (]: Began compiling node model.dbt_idx.stg_eltool__state
[0m18:35:03.988442 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_idx.stg_eltool__state"
[0m18:35:03.993980 [debug] [Thread-1 (]: Timing info for model.dbt_idx.stg_eltool__state (compile): 18:35:03.985439 => 18:35:03.993980
[0m18:35:03.994981 [debug] [Thread-1 (]: Began executing node model.dbt_idx.stg_eltool__state
[0m18:35:04.001522 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_idx.stg_eltool__state"
[0m18:35:04.008512 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__state"
[0m18:35:04.010048 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__state: BEGIN
[0m18:35:04.011050 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:35:04.032023 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m18:35:04.033035 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__state"
[0m18:35:04.034052 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__state: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__state"} */

  create view "IDX-Stock"."warehouse"."stg_eltool__state__dbt_tmp"
    
    
  as (
    with source as (select *
                from "IDX-Stock"."warehouse"."state"),
     renamed as (select state_identifier::INT AS state_id,
                         state_code::VARCHAR(2) AS state_code,
                         st_name::VARCHAR(30) AS state_name
                 from source)
select *
from renamed
  );
[0m18:35:04.039602 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m18:35:04.045162 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__state"
[0m18:35:04.047146 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__state: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__state"} */
alter table "IDX-Stock"."warehouse"."stg_eltool__state" rename to "stg_eltool__state__dbt_backup"
[0m18:35:04.050669 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:35:04.056671 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__state"
[0m18:35:04.057678 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__state: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__state"} */
alter table "IDX-Stock"."warehouse"."stg_eltool__state__dbt_tmp" rename to "stg_eltool__state"
[0m18:35:04.060720 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:35:04.063759 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__state: COMMIT
[0m18:35:04.064753 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__state"
[0m18:35:04.065764 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__state: COMMIT
[0m18:35:04.070355 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m18:35:04.074368 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__state"
[0m18:35:04.076366 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__state: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__state"} */
drop view if exists "IDX-Stock"."warehouse"."stg_eltool__state__dbt_backup" cascade
[0m18:35:04.082462 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m18:35:04.084488 [debug] [Thread-1 (]: Timing info for model.dbt_idx.stg_eltool__state (execute): 18:35:03.996006 => 18:35:04.084488
[0m18:35:04.085467 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__state: Close
[0m18:35:04.087456 [info ] [Thread-1 (]: 4 of 7 OK created sql view model warehouse.stg_eltool__state ................... [[32mCREATE VIEW[0m in 0.10s]
[0m18:35:04.090572 [debug] [Thread-1 (]: Finished running node model.dbt_idx.stg_eltool__state
[0m18:35:04.092594 [debug] [Thread-1 (]: Began running node model.dbt_idx.fact_orders
[0m18:35:04.093578 [info ] [Thread-1 (]: 5 of 7 START sql table model warehouse.fact_orders ............................. [RUN]
[0m18:35:04.095575 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_idx.stg_eltool__state, now model.dbt_idx.fact_orders)
[0m18:35:04.096086 [debug] [Thread-1 (]: Began compiling node model.dbt_idx.fact_orders
[0m18:35:04.101171 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_idx.fact_orders"
[0m18:35:04.109825 [debug] [Thread-1 (]: Timing info for model.dbt_idx.fact_orders (compile): 18:35:04.097101 => 18:35:04.109825
[0m18:35:04.110804 [debug] [Thread-1 (]: Began executing node model.dbt_idx.fact_orders
[0m18:35:04.136986 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_idx.fact_orders"
[0m18:35:04.146104 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.fact_orders"
[0m18:35:04.147078 [debug] [Thread-1 (]: On model.dbt_idx.fact_orders: BEGIN
[0m18:35:04.148589 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:35:04.171957 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m18:35:04.173834 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.fact_orders"
[0m18:35:04.174845 [debug] [Thread-1 (]: On model.dbt_idx.fact_orders: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.fact_orders"} */

  
    

  create  table "IDX-Stock"."warehouse"."fact_orders__dbt_tmp"
  
  
    as
  
  (
    with orders as (
    select *
    from "IDX-Stock"."warehouse"."stg_eltool__orders"
)
select * from orders
  );
  
[0m18:35:04.183414 [debug] [Thread-1 (]: SQL status: SELECT 999 in 0.0 seconds
[0m18:35:04.187410 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.fact_orders"
[0m18:35:04.188414 [debug] [Thread-1 (]: On model.dbt_idx.fact_orders: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.fact_orders"} */
alter table "IDX-Stock"."warehouse"."fact_orders" rename to "fact_orders__dbt_backup"
[0m18:35:04.192669 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:35:04.197781 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.fact_orders"
[0m18:35:04.199265 [debug] [Thread-1 (]: On model.dbt_idx.fact_orders: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.fact_orders"} */
alter table "IDX-Stock"."warehouse"."fact_orders__dbt_tmp" rename to "fact_orders"
[0m18:35:04.204286 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:35:04.216936 [debug] [Thread-1 (]: On model.dbt_idx.fact_orders: COMMIT
[0m18:35:04.218488 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.fact_orders"
[0m18:35:04.219503 [debug] [Thread-1 (]: On model.dbt_idx.fact_orders: COMMIT
[0m18:35:04.224526 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m18:35:04.232967 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.fact_orders"
[0m18:35:04.233974 [debug] [Thread-1 (]: On model.dbt_idx.fact_orders: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.fact_orders"} */
drop table if exists "IDX-Stock"."warehouse"."fact_orders__dbt_backup" cascade
[0m18:35:04.238522 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m18:35:04.240995 [debug] [Thread-1 (]: Timing info for model.dbt_idx.fact_orders (execute): 18:35:04.111808 => 18:35:04.240995
[0m18:35:04.241994 [debug] [Thread-1 (]: On model.dbt_idx.fact_orders: Close
[0m18:35:04.244513 [info ] [Thread-1 (]: 5 of 7 OK created sql table model warehouse.fact_orders ........................ [[32mSELECT 999[0m in 0.15s]
[0m18:35:04.246526 [debug] [Thread-1 (]: Finished running node model.dbt_idx.fact_orders
[0m18:35:04.247536 [debug] [Thread-1 (]: Began running node model.dbt_idx.dim_customers
[0m18:35:04.248574 [info ] [Thread-1 (]: 6 of 7 START sql table model warehouse.dim_customers ........................... [RUN]
[0m18:35:04.251018 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_idx.fact_orders, now model.dbt_idx.dim_customers)
[0m18:35:04.252031 [debug] [Thread-1 (]: Began compiling node model.dbt_idx.dim_customers
[0m18:35:04.255049 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_idx.dim_customers"
[0m18:35:04.262617 [debug] [Thread-1 (]: Timing info for model.dbt_idx.dim_customers (compile): 18:35:04.252031 => 18:35:04.261651
[0m18:35:04.263616 [debug] [Thread-1 (]: Began executing node model.dbt_idx.dim_customers
[0m18:35:04.269126 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_idx.dim_customers"
[0m18:35:04.277171 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.dim_customers"
[0m18:35:04.278774 [debug] [Thread-1 (]: On model.dbt_idx.dim_customers: BEGIN
[0m18:35:04.278774 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:35:04.301838 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m18:35:04.302849 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.dim_customers"
[0m18:35:04.302849 [debug] [Thread-1 (]: On model.dbt_idx.dim_customers: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.dim_customers"} */

  
    

  create  table "IDX-Stock"."warehouse"."dim_customers__dbt_tmp"
  
  
    as
  
  (
    -- noinspection SqlDialectInspectionForFile

with customers as (
    select *
    from "IDX-Stock"."warehouse"."stg_eltool__customers_snapshots"
    ),
     state as (
         select *
         from "IDX-Stock"."warehouse"."stg_eltool__state"
     )
select c.customer_id,
       c.zipcode,
       c.city,
       c.state_code,
       s.state_name,
       c.datetime_created,
       c.datetime_updated,
       c.dbt_valid_from::TIMESTAMP as valid_from,
        CASE WHEN c.dbt_valid_to IS NULL
            THEN '9999-12-31'::TIMESTAMP
            ELSE c.dbt_valid_to::TIMESTAMP
        END as valid_to
from customers c
    join state s on c.state_code = s.state_code
  );
  
[0m18:35:04.308378 [debug] [Thread-1 (]: SQL status: SELECT 105 in 0.0 seconds
[0m18:35:04.312390 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.dim_customers"
[0m18:35:04.313389 [debug] [Thread-1 (]: On model.dbt_idx.dim_customers: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.dim_customers"} */
alter table "IDX-Stock"."warehouse"."dim_customers" rename to "dim_customers__dbt_backup"
[0m18:35:04.315393 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:35:04.319905 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.dim_customers"
[0m18:35:04.320911 [debug] [Thread-1 (]: On model.dbt_idx.dim_customers: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.dim_customers"} */
alter table "IDX-Stock"."warehouse"."dim_customers__dbt_tmp" rename to "dim_customers"
[0m18:35:04.322998 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:35:04.326001 [debug] [Thread-1 (]: On model.dbt_idx.dim_customers: COMMIT
[0m18:35:04.327028 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.dim_customers"
[0m18:35:04.327028 [debug] [Thread-1 (]: On model.dbt_idx.dim_customers: COMMIT
[0m18:35:04.331578 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m18:35:04.335612 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.dim_customers"
[0m18:35:04.335612 [debug] [Thread-1 (]: On model.dbt_idx.dim_customers: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.dim_customers"} */
drop table if exists "IDX-Stock"."warehouse"."dim_customers__dbt_backup" cascade
[0m18:35:04.340849 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m18:35:04.344363 [debug] [Thread-1 (]: Timing info for model.dbt_idx.dim_customers (execute): 18:35:04.263616 => 18:35:04.342830
[0m18:35:04.345391 [debug] [Thread-1 (]: On model.dbt_idx.dim_customers: Close
[0m18:35:04.347393 [info ] [Thread-1 (]: 6 of 7 OK created sql table model warehouse.dim_customers ...................... [[32mSELECT 105[0m in 0.10s]
[0m18:35:04.350922 [debug] [Thread-1 (]: Finished running node model.dbt_idx.dim_customers
[0m18:35:04.352916 [debug] [Thread-1 (]: Began running node model.dbt_idx.customer_orders_status
[0m18:35:04.353922 [info ] [Thread-1 (]: 7 of 7 START sql view model warehouse.customer_orders_status ................... [RUN]
[0m18:35:04.354920 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_idx.dim_customers, now model.dbt_idx.customer_orders_status)
[0m18:35:04.355920 [debug] [Thread-1 (]: Began compiling node model.dbt_idx.customer_orders_status
[0m18:35:04.361439 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_idx.customer_orders_status"
[0m18:35:04.367456 [debug] [Thread-1 (]: Timing info for model.dbt_idx.customer_orders_status (compile): 18:35:04.356919 => 18:35:04.367456
[0m18:35:04.368978 [debug] [Thread-1 (]: Began executing node model.dbt_idx.customer_orders_status
[0m18:35:04.374024 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_idx.customer_orders_status"
[0m18:35:04.380527 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.customer_orders_status"
[0m18:35:04.381563 [debug] [Thread-1 (]: On model.dbt_idx.customer_orders_status: BEGIN
[0m18:35:04.382562 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:35:04.403892 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m18:35:04.404923 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.customer_orders_status"
[0m18:35:04.405909 [debug] [Thread-1 (]: On model.dbt_idx.customer_orders_status: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.customer_orders_status"} */

  create view "IDX-Stock"."warehouse"."customer_orders_status__dbt_tmp"
    
    
  as (
    with orders as (select *
                from "IDX-Stock"."warehouse"."fact_orders"),
     customers as (select *
                   from "IDX-Stock"."warehouse"."dim_customers")
select o.order_id,
       o.customer_id,
       o.order_status,
       o.order_purchase_timestamp,
       o.order_approved_at,
       o.order_delivered_carrier_date,
       o.order_delivered_customer_date,
       o.order_estimated_delivery_date,
       c.zipcode    as customer_zipcode,
       c.city       as customer_city,
       c.state_code as customer_state_code,
       c.state_name as customer_state_name
from orders o
    join customers c on o.customer_id = c.customer_id
    and o.order_purchase_timestamp >= c.valid_from
    and o.order_purchase_timestamp <= c.valid_to
  );
[0m18:35:04.410471 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m18:35:04.413470 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.customer_orders_status"
[0m18:35:04.414472 [debug] [Thread-1 (]: On model.dbt_idx.customer_orders_status: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.customer_orders_status"} */
alter table "IDX-Stock"."warehouse"."customer_orders_status__dbt_tmp" rename to "customer_orders_status"
[0m18:35:04.417439 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:35:04.419988 [debug] [Thread-1 (]: On model.dbt_idx.customer_orders_status: COMMIT
[0m18:35:04.420984 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.customer_orders_status"
[0m18:35:04.421997 [debug] [Thread-1 (]: On model.dbt_idx.customer_orders_status: COMMIT
[0m18:35:04.425192 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m18:35:04.429818 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.customer_orders_status"
[0m18:35:04.430868 [debug] [Thread-1 (]: On model.dbt_idx.customer_orders_status: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.customer_orders_status"} */
drop view if exists "IDX-Stock"."warehouse"."customer_orders_status__dbt_backup" cascade
[0m18:35:04.434083 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m18:35:04.436075 [debug] [Thread-1 (]: Timing info for model.dbt_idx.customer_orders_status (execute): 18:35:04.368978 => 18:35:04.435075
[0m18:35:04.436075 [debug] [Thread-1 (]: On model.dbt_idx.customer_orders_status: Close
[0m18:35:04.438765 [info ] [Thread-1 (]: 7 of 7 OK created sql view model warehouse.customer_orders_status .............. [[32mCREATE VIEW[0m in 0.08s]
[0m18:35:04.441657 [debug] [Thread-1 (]: Finished running node model.dbt_idx.customer_orders_status
[0m18:35:04.443658 [debug] [MainThread]: Using postgres connection "master"
[0m18:35:04.444936 [debug] [MainThread]: On master: BEGIN
[0m18:35:04.444936 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:35:04.469793 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m18:35:04.470836 [debug] [MainThread]: On master: COMMIT
[0m18:35:04.471787 [debug] [MainThread]: Using postgres connection "master"
[0m18:35:04.472790 [debug] [MainThread]: On master: COMMIT
[0m18:35:04.475790 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m18:35:04.476790 [debug] [MainThread]: On master: Close
[0m18:35:04.477804 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:35:04.478789 [debug] [MainThread]: Connection 'list_IDX-Stock' was properly closed.
[0m18:35:04.479980 [debug] [MainThread]: Connection 'list_IDX-Stock_snapshots' was properly closed.
[0m18:35:04.481009 [debug] [MainThread]: Connection 'model.dbt_idx.customer_orders_status' was properly closed.
[0m18:35:04.481990 [info ] [MainThread]: 
[0m18:35:04.482983 [info ] [MainThread]: Finished running 5 view models, 2 table models in 0 hours 0 minutes and 1.06 seconds (1.06s).
[0m18:35:04.485985 [debug] [MainThread]: Command end result
[0m18:35:04.511348 [info ] [MainThread]: 
[0m18:35:04.512345 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m18:35:04.513344 [info ] [MainThread]: 
[0m18:35:04.515348 [error] [MainThread]: [33mDatabase Error in model stg_eltool__customers (models\staging\stg_eltool__customers.sql)[0m
[0m18:35:04.517351 [error] [MainThread]:   column "dummy" does not exist
[0m18:35:04.519535 [error] [MainThread]:   LINE 13:                  where dummy = 'not found')
[0m18:35:04.520538 [error] [MainThread]:                                   ^
[0m18:35:04.521533 [error] [MainThread]:   compiled Code at target\run\dbt_idx\models\staging\stg_eltool__customers.sql
[0m18:35:04.523533 [info ] [MainThread]: 
[0m18:35:04.525536 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=1 SKIP=0 TOTAL=7
[0m18:35:04.527538 [debug] [MainThread]: Command `dbt run` failed at 18:35:04.526533 after 1.57 seconds
[0m18:35:04.528536 [debug] [MainThread]: Flushing usage events


============================== 18:35:29.012228 | c85f4319-555b-42d7-967e-62b5462754de ==============================
[0m18:35:29.012228 [info ] [MainThread]: Running with dbt=1.6.1
[0m18:35:29.018720 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'D:\\00 Project\\00 My Project\\IdeaProjects\\Py-DBT-IDX', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'D:\\00 Project\\00 My Project\\IdeaProjects\\Py-DBT-IDX\\logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'False'}
[0m18:35:29.148770 [info ] [MainThread]: Registered adapter: postgres=1.6.1
[0m18:35:29.159590 [debug] [MainThread]: checksum: efe19d9f5b93d1a98cc804fbfcdb6b3aced98b974af664946fee1cde8837deb7, vars: {}, profile: , target: , version: 1.6.1
[0m18:35:29.333287 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m18:35:29.334287 [debug] [MainThread]: Partial parsing: updated file: dbt_idx://models\staging\stg_eltool__customers.sql
[0m18:35:29.429436 [info ] [MainThread]: Found 1 snapshot, 9 tests, 7 models, 3 sources, 0 exposures, 0 metrics, 349 macros, 0 groups, 0 semantic models
[0m18:35:29.433429 [info ] [MainThread]: 
[0m18:35:29.435429 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m18:35:29.438434 [debug] [ThreadPool]: Acquiring new postgres connection 'list_IDX-Stock'
[0m18:35:29.450450 [debug] [ThreadPool]: Using postgres connection "list_IDX-Stock"
[0m18:35:29.451415 [debug] [ThreadPool]: On list_IDX-Stock: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "connection_name": "list_IDX-Stock"} */

    select distinct nspname from pg_namespace
  
[0m18:35:29.452416 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:35:29.500962 [debug] [ThreadPool]: SQL status: SELECT 13 in 0.0 seconds
[0m18:35:29.502960 [debug] [ThreadPool]: On list_IDX-Stock: Close
[0m18:35:29.506960 [debug] [ThreadPool]: Acquiring new postgres connection 'list_IDX-Stock_warehouse'
[0m18:35:29.513500 [debug] [ThreadPool]: Using postgres connection "list_IDX-Stock_warehouse"
[0m18:35:29.514523 [debug] [ThreadPool]: On list_IDX-Stock_warehouse: BEGIN
[0m18:35:29.514523 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:35:29.539611 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m18:35:29.540634 [debug] [ThreadPool]: Using postgres connection "list_IDX-Stock_warehouse"
[0m18:35:29.541623 [debug] [ThreadPool]: On list_IDX-Stock_warehouse: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "connection_name": "list_IDX-Stock_warehouse"} */
select
      'IDX-Stock' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'warehouse'
    union all
    select
      'IDX-Stock' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'warehouse'
    union all
    select
      'IDX-Stock' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'warehouse'
  
[0m18:35:29.546621 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.0 seconds
[0m18:35:29.548652 [debug] [ThreadPool]: On list_IDX-Stock_warehouse: ROLLBACK
[0m18:35:29.551713 [debug] [ThreadPool]: On list_IDX-Stock_warehouse: Close
[0m18:35:29.554713 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_IDX-Stock_warehouse, now list_IDX-Stock_snapshots)
[0m18:35:29.560242 [debug] [ThreadPool]: Using postgres connection "list_IDX-Stock_snapshots"
[0m18:35:29.561249 [debug] [ThreadPool]: On list_IDX-Stock_snapshots: BEGIN
[0m18:35:29.562254 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:35:29.582339 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m18:35:29.583337 [debug] [ThreadPool]: Using postgres connection "list_IDX-Stock_snapshots"
[0m18:35:29.584313 [debug] [ThreadPool]: On list_IDX-Stock_snapshots: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "connection_name": "list_IDX-Stock_snapshots"} */
select
      'IDX-Stock' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'snapshots'
    union all
    select
      'IDX-Stock' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'snapshots'
    union all
    select
      'IDX-Stock' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'snapshots'
  
[0m18:35:29.588297 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.0 seconds
[0m18:35:29.590419 [debug] [ThreadPool]: On list_IDX-Stock_snapshots: ROLLBACK
[0m18:35:29.592389 [debug] [ThreadPool]: On list_IDX-Stock_snapshots: Close
[0m18:35:29.599983 [debug] [MainThread]: Using postgres connection "master"
[0m18:35:29.600983 [debug] [MainThread]: On master: BEGIN
[0m18:35:29.601993 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:35:29.621916 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m18:35:29.622887 [debug] [MainThread]: Using postgres connection "master"
[0m18:35:29.622887 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m18:35:29.630400 [debug] [MainThread]: SQL status: SELECT 6 in 0.0 seconds
[0m18:35:29.633435 [debug] [MainThread]: On master: ROLLBACK
[0m18:35:29.635404 [debug] [MainThread]: Using postgres connection "master"
[0m18:35:29.636434 [debug] [MainThread]: On master: BEGIN
[0m18:35:29.639582 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m18:35:29.640588 [debug] [MainThread]: On master: COMMIT
[0m18:35:29.641581 [debug] [MainThread]: Using postgres connection "master"
[0m18:35:29.641581 [debug] [MainThread]: On master: COMMIT
[0m18:35:29.643564 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m18:35:29.644581 [debug] [MainThread]: On master: Close
[0m18:35:29.646595 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:35:29.647569 [info ] [MainThread]: 
[0m18:35:29.653105 [debug] [Thread-1 (]: Began running node model.dbt_idx.stg_eltool__customers
[0m18:35:29.654089 [info ] [Thread-1 (]: 1 of 7 START sql view model warehouse.stg_eltool__customers .................... [RUN]
[0m18:35:29.655090 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.dbt_idx.stg_eltool__customers'
[0m18:35:29.656124 [debug] [Thread-1 (]: Began compiling node model.dbt_idx.stg_eltool__customers
[0m18:35:29.665289 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_idx.stg_eltool__customers"
[0m18:35:29.672158 [debug] [Thread-1 (]: Timing info for model.dbt_idx.stg_eltool__customers (compile): 18:35:29.657102 => 18:35:29.672158
[0m18:35:29.673156 [debug] [Thread-1 (]: Began executing node model.dbt_idx.stg_eltool__customers
[0m18:35:29.710291 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_idx.stg_eltool__customers"
[0m18:35:29.717043 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__customers"
[0m18:35:29.717043 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__customers: BEGIN
[0m18:35:29.718640 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m18:35:29.738647 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m18:35:29.740156 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__customers"
[0m18:35:29.741137 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__customers: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__customers"} */

  create view "IDX-Stock"."warehouse"."stg_eltool__customers__dbt_tmp"
    
    
  as (
    with source as (select *
                from "IDX-Stock"."warehouse"."customers"),
     renamed as (select
                     customer_id,
                    'This is Dummy' as dummy
                 from source
                 where customer_id = 1234567890)
select *
from renamed
  );
[0m18:35:29.745128 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m18:35:29.753659 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__customers"
[0m18:35:29.754663 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__customers: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__customers"} */
alter table "IDX-Stock"."warehouse"."stg_eltool__customers" rename to "stg_eltool__customers__dbt_backup"
[0m18:35:29.757124 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:35:29.762350 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__customers"
[0m18:35:29.763387 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__customers: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__customers"} */
alter table "IDX-Stock"."warehouse"."stg_eltool__customers__dbt_tmp" rename to "stg_eltool__customers"
[0m18:35:29.765688 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:35:29.783736 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__customers: COMMIT
[0m18:35:29.784736 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__customers"
[0m18:35:29.784736 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__customers: COMMIT
[0m18:35:29.788740 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m18:35:29.797022 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__customers"
[0m18:35:29.798583 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__customers: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__customers"} */
drop view if exists "IDX-Stock"."warehouse"."stg_eltool__customers__dbt_backup" cascade
[0m18:35:29.803534 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m18:35:29.805534 [debug] [Thread-1 (]: Timing info for model.dbt_idx.stg_eltool__customers (execute): 18:35:29.674203 => 18:35:29.804534
[0m18:35:29.805534 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__customers: Close
[0m18:35:29.808551 [info ] [Thread-1 (]: 1 of 7 OK created sql view model warehouse.stg_eltool__customers ............... [[32mCREATE VIEW[0m in 0.15s]
[0m18:35:29.810076 [debug] [Thread-1 (]: Finished running node model.dbt_idx.stg_eltool__customers
[0m18:35:29.811104 [debug] [Thread-1 (]: Began running node model.dbt_idx.stg_eltool__customers_snapshots
[0m18:35:29.812104 [info ] [Thread-1 (]: 2 of 7 START sql view model warehouse.stg_eltool__customers_snapshots .......... [RUN]
[0m18:35:29.814113 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_idx.stg_eltool__customers, now model.dbt_idx.stg_eltool__customers_snapshots)
[0m18:35:29.815067 [debug] [Thread-1 (]: Began compiling node model.dbt_idx.stg_eltool__customers_snapshots
[0m18:35:29.817104 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_idx.stg_eltool__customers_snapshots"
[0m18:35:29.825652 [debug] [Thread-1 (]: Timing info for model.dbt_idx.stg_eltool__customers_snapshots (compile): 18:35:29.815067 => 18:35:29.824690
[0m18:35:29.826651 [debug] [Thread-1 (]: Began executing node model.dbt_idx.stg_eltool__customers_snapshots
[0m18:35:29.832209 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_idx.stg_eltool__customers_snapshots"
[0m18:35:29.838700 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__customers_snapshots"
[0m18:35:29.839711 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__customers_snapshots: BEGIN
[0m18:35:29.840748 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:35:29.862650 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m18:35:29.863649 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__customers_snapshots"
[0m18:35:29.864686 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__customers_snapshots: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__customers_snapshots"} */

  create view "IDX-Stock"."warehouse"."stg_eltool__customers_snapshots__dbt_tmp"
    
    
  as (
    with source as (select *
                from "IDX-Stock"."snapshots"."customers_snapshot"),
     renamed as (select customer_id,
                        zipcode,
                        city,
                        state_code,
                        datetime_created::TIMESTAMP AS datetime_created,
                        datetime_updated::TIMESTAMP AS datetime_updated,
                        dbt_valid_from,
                        dbt_valid_to
                 from source)
select *
from renamed
  );
[0m18:35:29.869563 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m18:35:29.873572 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__customers_snapshots"
[0m18:35:29.874588 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__customers_snapshots: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__customers_snapshots"} */
alter table "IDX-Stock"."warehouse"."stg_eltool__customers_snapshots" rename to "stg_eltool__customers_snapshots__dbt_backup"
[0m18:35:29.876484 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:35:29.881039 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__customers_snapshots"
[0m18:35:29.882043 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__customers_snapshots: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__customers_snapshots"} */
alter table "IDX-Stock"."warehouse"."stg_eltool__customers_snapshots__dbt_tmp" rename to "stg_eltool__customers_snapshots"
[0m18:35:29.884007 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:35:29.886040 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__customers_snapshots: COMMIT
[0m18:35:29.887040 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__customers_snapshots"
[0m18:35:29.887040 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__customers_snapshots: COMMIT
[0m18:35:29.890575 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m18:35:29.894598 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__customers_snapshots"
[0m18:35:29.895575 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__customers_snapshots: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__customers_snapshots"} */
drop view if exists "IDX-Stock"."warehouse"."stg_eltool__customers_snapshots__dbt_backup" cascade
[0m18:35:29.899834 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m18:35:29.901851 [debug] [Thread-1 (]: Timing info for model.dbt_idx.stg_eltool__customers_snapshots (execute): 18:35:29.826651 => 18:35:29.900827
[0m18:35:29.901851 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__customers_snapshots: Close
[0m18:35:29.903826 [info ] [Thread-1 (]: 2 of 7 OK created sql view model warehouse.stg_eltool__customers_snapshots ..... [[32mCREATE VIEW[0m in 0.09s]
[0m18:35:29.905853 [debug] [Thread-1 (]: Finished running node model.dbt_idx.stg_eltool__customers_snapshots
[0m18:35:29.906829 [debug] [Thread-1 (]: Began running node model.dbt_idx.stg_eltool__orders
[0m18:35:29.906829 [info ] [Thread-1 (]: 3 of 7 START sql view model warehouse.stg_eltool__orders ....................... [RUN]
[0m18:35:29.909369 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_idx.stg_eltool__customers_snapshots, now model.dbt_idx.stg_eltool__orders)
[0m18:35:29.910434 [debug] [Thread-1 (]: Began compiling node model.dbt_idx.stg_eltool__orders
[0m18:35:29.914395 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_idx.stg_eltool__orders"
[0m18:35:29.924734 [debug] [Thread-1 (]: Timing info for model.dbt_idx.stg_eltool__orders (compile): 18:35:29.911394 => 18:35:29.924734
[0m18:35:29.926568 [debug] [Thread-1 (]: Began executing node model.dbt_idx.stg_eltool__orders
[0m18:35:29.942959 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_idx.stg_eltool__orders"
[0m18:35:29.956243 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__orders"
[0m18:35:29.957272 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__orders: BEGIN
[0m18:35:29.958240 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:35:30.019598 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m18:35:30.021876 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__orders"
[0m18:35:30.022892 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__orders: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__orders"} */

  create view "IDX-Stock"."warehouse"."stg_eltool__orders__dbt_tmp"
    
    
  as (
    with source as (select *
                from "IDX-Stock"."warehouse"."orders"),
     renamed as (select order_id,
                        cust_id AS customer_id,
                        order_status,
                        order_purchase_timestamp::TIMESTAMP,
                        order_approved_at::TIMESTAMP,
                        order_delivered_carrier_date::TIMESTAMP,
                        order_delivered_customer_date::TIMESTAMP,
                        order_estimated_delivery_date::TIMESTAMP
                 from source)
select *
from renamed
  );
[0m18:35:30.029820 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m18:35:30.038343 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__orders"
[0m18:35:30.040359 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__orders: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__orders"} */
alter table "IDX-Stock"."warehouse"."stg_eltool__orders" rename to "stg_eltool__orders__dbt_backup"
[0m18:35:30.043397 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:35:30.048584 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__orders"
[0m18:35:30.049463 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__orders: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__orders"} */
alter table "IDX-Stock"."warehouse"."stg_eltool__orders__dbt_tmp" rename to "stg_eltool__orders"
[0m18:35:30.054394 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:35:30.060435 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__orders: COMMIT
[0m18:35:30.061568 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__orders"
[0m18:35:30.063353 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__orders: COMMIT
[0m18:35:30.068458 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m18:35:30.072461 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__orders"
[0m18:35:30.073733 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__orders: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__orders"} */
drop view if exists "IDX-Stock"."warehouse"."stg_eltool__orders__dbt_backup" cascade
[0m18:35:30.078332 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m18:35:30.080152 [debug] [Thread-1 (]: Timing info for model.dbt_idx.stg_eltool__orders (execute): 18:35:29.928311 => 18:35:30.080152
[0m18:35:30.081694 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__orders: Close
[0m18:35:30.084707 [info ] [Thread-1 (]: 3 of 7 OK created sql view model warehouse.stg_eltool__orders .................. [[32mCREATE VIEW[0m in 0.18s]
[0m18:35:30.086707 [debug] [Thread-1 (]: Finished running node model.dbt_idx.stg_eltool__orders
[0m18:35:30.087718 [debug] [Thread-1 (]: Began running node model.dbt_idx.stg_eltool__state
[0m18:35:30.089218 [info ] [Thread-1 (]: 4 of 7 START sql view model warehouse.stg_eltool__state ........................ [RUN]
[0m18:35:30.091258 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_idx.stg_eltool__orders, now model.dbt_idx.stg_eltool__state)
[0m18:35:30.092227 [debug] [Thread-1 (]: Began compiling node model.dbt_idx.stg_eltool__state
[0m18:35:30.098256 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_idx.stg_eltool__state"
[0m18:35:30.107207 [debug] [Thread-1 (]: Timing info for model.dbt_idx.stg_eltool__state (compile): 18:35:30.093236 => 18:35:30.107207
[0m18:35:30.108749 [debug] [Thread-1 (]: Began executing node model.dbt_idx.stg_eltool__state
[0m18:35:30.114792 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_idx.stg_eltool__state"
[0m18:35:30.123289 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__state"
[0m18:35:30.124288 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__state: BEGIN
[0m18:35:30.125297 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:35:30.147172 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m18:35:30.148744 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__state"
[0m18:35:30.149709 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__state: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__state"} */

  create view "IDX-Stock"."warehouse"."stg_eltool__state__dbt_tmp"
    
    
  as (
    with source as (select *
                from "IDX-Stock"."warehouse"."state"),
     renamed as (select state_identifier::INT AS state_id,
                         state_code::VARCHAR(2) AS state_code,
                         st_name::VARCHAR(30) AS state_name
                 from source)
select *
from renamed
  );
[0m18:35:30.152720 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m18:35:30.156717 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__state"
[0m18:35:30.157716 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__state: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__state"} */
alter table "IDX-Stock"."warehouse"."stg_eltool__state" rename to "stg_eltool__state__dbt_backup"
[0m18:35:30.160762 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:35:30.164750 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__state"
[0m18:35:30.165750 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__state: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__state"} */
alter table "IDX-Stock"."warehouse"."stg_eltool__state__dbt_tmp" rename to "stg_eltool__state"
[0m18:35:30.168751 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:35:30.171936 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__state: COMMIT
[0m18:35:30.172906 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__state"
[0m18:35:30.173931 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__state: COMMIT
[0m18:35:30.178410 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m18:35:30.181425 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__state"
[0m18:35:30.182425 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__state: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__state"} */
drop view if exists "IDX-Stock"."warehouse"."stg_eltool__state__dbt_backup" cascade
[0m18:35:30.186427 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m18:35:30.188931 [debug] [Thread-1 (]: Timing info for model.dbt_idx.stg_eltool__state (execute): 18:35:30.108749 => 18:35:30.188931
[0m18:35:30.189936 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__state: Close
[0m18:35:30.191954 [info ] [Thread-1 (]: 4 of 7 OK created sql view model warehouse.stg_eltool__state ................... [[32mCREATE VIEW[0m in 0.10s]
[0m18:35:30.193947 [debug] [Thread-1 (]: Finished running node model.dbt_idx.stg_eltool__state
[0m18:35:30.194945 [debug] [Thread-1 (]: Began running node model.dbt_idx.fact_orders
[0m18:35:30.195956 [info ] [Thread-1 (]: 5 of 7 START sql table model warehouse.fact_orders ............................. [RUN]
[0m18:35:30.196943 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_idx.stg_eltool__state, now model.dbt_idx.fact_orders)
[0m18:35:30.196943 [debug] [Thread-1 (]: Began compiling node model.dbt_idx.fact_orders
[0m18:35:30.202497 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_idx.fact_orders"
[0m18:35:30.208533 [debug] [Thread-1 (]: Timing info for model.dbt_idx.fact_orders (compile): 18:35:30.198585 => 18:35:30.208533
[0m18:35:30.209971 [debug] [Thread-1 (]: Began executing node model.dbt_idx.fact_orders
[0m18:35:30.233870 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_idx.fact_orders"
[0m18:35:30.241611 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.fact_orders"
[0m18:35:30.241611 [debug] [Thread-1 (]: On model.dbt_idx.fact_orders: BEGIN
[0m18:35:30.242647 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:35:30.269562 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m18:35:30.270555 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.fact_orders"
[0m18:35:30.271589 [debug] [Thread-1 (]: On model.dbt_idx.fact_orders: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.fact_orders"} */

  
    

  create  table "IDX-Stock"."warehouse"."fact_orders__dbt_tmp"
  
  
    as
  
  (
    with orders as (
    select *
    from "IDX-Stock"."warehouse"."stg_eltool__orders"
)
select * from orders
  );
  
[0m18:35:30.280436 [debug] [Thread-1 (]: SQL status: SELECT 999 in 0.0 seconds
[0m18:35:30.285465 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.fact_orders"
[0m18:35:30.285465 [debug] [Thread-1 (]: On model.dbt_idx.fact_orders: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.fact_orders"} */
alter table "IDX-Stock"."warehouse"."fact_orders" rename to "fact_orders__dbt_backup"
[0m18:35:30.288427 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:35:30.292711 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.fact_orders"
[0m18:35:30.293693 [debug] [Thread-1 (]: On model.dbt_idx.fact_orders: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.fact_orders"} */
alter table "IDX-Stock"."warehouse"."fact_orders__dbt_tmp" rename to "fact_orders"
[0m18:35:30.296661 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:35:30.303245 [debug] [Thread-1 (]: On model.dbt_idx.fact_orders: COMMIT
[0m18:35:30.304282 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.fact_orders"
[0m18:35:30.305281 [debug] [Thread-1 (]: On model.dbt_idx.fact_orders: COMMIT
[0m18:35:30.310801 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m18:35:30.316838 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.fact_orders"
[0m18:35:30.316838 [debug] [Thread-1 (]: On model.dbt_idx.fact_orders: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.fact_orders"} */
drop table if exists "IDX-Stock"."warehouse"."fact_orders__dbt_backup" cascade
[0m18:35:30.323404 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m18:35:30.325896 [debug] [Thread-1 (]: Timing info for model.dbt_idx.fact_orders (execute): 18:35:30.210993 => 18:35:30.325896
[0m18:35:30.326905 [debug] [Thread-1 (]: On model.dbt_idx.fact_orders: Close
[0m18:35:30.329432 [info ] [Thread-1 (]: 5 of 7 OK created sql table model warehouse.fact_orders ........................ [[32mSELECT 999[0m in 0.13s]
[0m18:35:30.332437 [debug] [Thread-1 (]: Finished running node model.dbt_idx.fact_orders
[0m18:35:30.333436 [debug] [Thread-1 (]: Began running node model.dbt_idx.dim_customers
[0m18:35:30.334450 [info ] [Thread-1 (]: 6 of 7 START sql table model warehouse.dim_customers ........................... [RUN]
[0m18:35:30.335435 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_idx.fact_orders, now model.dbt_idx.dim_customers)
[0m18:35:30.336434 [debug] [Thread-1 (]: Began compiling node model.dbt_idx.dim_customers
[0m18:35:30.339996 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_idx.dim_customers"
[0m18:35:30.346998 [debug] [Thread-1 (]: Timing info for model.dbt_idx.dim_customers (compile): 18:35:30.337433 => 18:35:30.346998
[0m18:35:30.348517 [debug] [Thread-1 (]: Began executing node model.dbt_idx.dim_customers
[0m18:35:30.354138 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_idx.dim_customers"
[0m18:35:30.363250 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.dim_customers"
[0m18:35:30.365236 [debug] [Thread-1 (]: On model.dbt_idx.dim_customers: BEGIN
[0m18:35:30.366230 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:35:30.396854 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m18:35:30.396854 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.dim_customers"
[0m18:35:30.398482 [debug] [Thread-1 (]: On model.dbt_idx.dim_customers: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.dim_customers"} */

  
    

  create  table "IDX-Stock"."warehouse"."dim_customers__dbt_tmp"
  
  
    as
  
  (
    -- noinspection SqlDialectInspectionForFile

with customers as (
    select *
    from "IDX-Stock"."warehouse"."stg_eltool__customers_snapshots"
    ),
     state as (
         select *
         from "IDX-Stock"."warehouse"."stg_eltool__state"
     )
select c.customer_id,
       c.zipcode,
       c.city,
       c.state_code,
       s.state_name,
       c.datetime_created,
       c.datetime_updated,
       c.dbt_valid_from::TIMESTAMP as valid_from,
        CASE WHEN c.dbt_valid_to IS NULL
            THEN '9999-12-31'::TIMESTAMP
            ELSE c.dbt_valid_to::TIMESTAMP
        END as valid_to
from customers c
    join state s on c.state_code = s.state_code
  );
  
[0m18:35:30.403393 [debug] [Thread-1 (]: SQL status: SELECT 105 in 0.0 seconds
[0m18:35:30.409826 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.dim_customers"
[0m18:35:30.410815 [debug] [Thread-1 (]: On model.dbt_idx.dim_customers: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.dim_customers"} */
alter table "IDX-Stock"."warehouse"."dim_customers" rename to "dim_customers__dbt_backup"
[0m18:35:30.414396 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:35:30.421508 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.dim_customers"
[0m18:35:30.422525 [debug] [Thread-1 (]: On model.dbt_idx.dim_customers: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.dim_customers"} */
alter table "IDX-Stock"."warehouse"."dim_customers__dbt_tmp" rename to "dim_customers"
[0m18:35:30.425515 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:35:30.430573 [debug] [Thread-1 (]: On model.dbt_idx.dim_customers: COMMIT
[0m18:35:30.431580 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.dim_customers"
[0m18:35:30.431580 [debug] [Thread-1 (]: On model.dbt_idx.dim_customers: COMMIT
[0m18:35:30.436130 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m18:35:30.440690 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.dim_customers"
[0m18:35:30.441689 [debug] [Thread-1 (]: On model.dbt_idx.dim_customers: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.dim_customers"} */
drop table if exists "IDX-Stock"."warehouse"."dim_customers__dbt_backup" cascade
[0m18:35:30.447705 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m18:35:30.451538 [debug] [Thread-1 (]: Timing info for model.dbt_idx.dim_customers (execute): 18:35:30.349543 => 18:35:30.451538
[0m18:35:30.453523 [debug] [Thread-1 (]: On model.dbt_idx.dim_customers: Close
[0m18:35:30.455530 [info ] [Thread-1 (]: 6 of 7 OK created sql table model warehouse.dim_customers ...................... [[32mSELECT 105[0m in 0.12s]
[0m18:35:30.457537 [debug] [Thread-1 (]: Finished running node model.dbt_idx.dim_customers
[0m18:35:30.459847 [debug] [Thread-1 (]: Began running node model.dbt_idx.customer_orders_status
[0m18:35:30.460494 [info ] [Thread-1 (]: 7 of 7 START sql view model warehouse.customer_orders_status ................... [RUN]
[0m18:35:30.461395 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_idx.dim_customers, now model.dbt_idx.customer_orders_status)
[0m18:35:30.462392 [debug] [Thread-1 (]: Began compiling node model.dbt_idx.customer_orders_status
[0m18:35:30.465423 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_idx.customer_orders_status"
[0m18:35:30.471601 [debug] [Thread-1 (]: Timing info for model.dbt_idx.customer_orders_status (compile): 18:35:30.463389 => 18:35:30.471601
[0m18:35:30.472596 [debug] [Thread-1 (]: Began executing node model.dbt_idx.customer_orders_status
[0m18:35:30.477598 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_idx.customer_orders_status"
[0m18:35:30.485332 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.customer_orders_status"
[0m18:35:30.486330 [debug] [Thread-1 (]: On model.dbt_idx.customer_orders_status: BEGIN
[0m18:35:30.486330 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:35:30.508577 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m18:35:30.508577 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.customer_orders_status"
[0m18:35:30.510496 [debug] [Thread-1 (]: On model.dbt_idx.customer_orders_status: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.customer_orders_status"} */

  create view "IDX-Stock"."warehouse"."customer_orders_status__dbt_tmp"
    
    
  as (
    with orders as (select *
                from "IDX-Stock"."warehouse"."fact_orders"),
     customers as (select *
                   from "IDX-Stock"."warehouse"."dim_customers")
select o.order_id,
       o.customer_id,
       o.order_status,
       o.order_purchase_timestamp,
       o.order_approved_at,
       o.order_delivered_carrier_date,
       o.order_delivered_customer_date,
       o.order_estimated_delivery_date,
       c.zipcode    as customer_zipcode,
       c.city       as customer_city,
       c.state_code as customer_state_code,
       c.state_name as customer_state_name
from orders o
    join customers c on o.customer_id = c.customer_id
    and o.order_purchase_timestamp >= c.valid_from
    and o.order_purchase_timestamp <= c.valid_to
  );
[0m18:35:30.514493 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m18:35:30.517527 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.customer_orders_status"
[0m18:35:30.518528 [debug] [Thread-1 (]: On model.dbt_idx.customer_orders_status: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.customer_orders_status"} */
alter table "IDX-Stock"."warehouse"."customer_orders_status__dbt_tmp" rename to "customer_orders_status"
[0m18:35:30.521414 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:35:30.523424 [debug] [Thread-1 (]: On model.dbt_idx.customer_orders_status: COMMIT
[0m18:35:30.524424 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.customer_orders_status"
[0m18:35:30.524424 [debug] [Thread-1 (]: On model.dbt_idx.customer_orders_status: COMMIT
[0m18:35:30.528487 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m18:35:30.532531 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.customer_orders_status"
[0m18:35:30.532531 [debug] [Thread-1 (]: On model.dbt_idx.customer_orders_status: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.customer_orders_status"} */
drop view if exists "IDX-Stock"."warehouse"."customer_orders_status__dbt_backup" cascade
[0m18:35:30.535515 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m18:35:30.537530 [debug] [Thread-1 (]: Timing info for model.dbt_idx.customer_orders_status (execute): 18:35:30.473567 => 18:35:30.536499
[0m18:35:30.537530 [debug] [Thread-1 (]: On model.dbt_idx.customer_orders_status: Close
[0m18:35:30.540083 [info ] [Thread-1 (]: 7 of 7 OK created sql view model warehouse.customer_orders_status .............. [[32mCREATE VIEW[0m in 0.08s]
[0m18:35:30.542118 [debug] [Thread-1 (]: Finished running node model.dbt_idx.customer_orders_status
[0m18:35:30.544079 [debug] [MainThread]: Using postgres connection "master"
[0m18:35:30.545079 [debug] [MainThread]: On master: BEGIN
[0m18:35:30.546093 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:35:30.570278 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m18:35:30.571253 [debug] [MainThread]: On master: COMMIT
[0m18:35:30.572252 [debug] [MainThread]: Using postgres connection "master"
[0m18:35:30.572252 [debug] [MainThread]: On master: COMMIT
[0m18:35:30.574273 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m18:35:30.575320 [debug] [MainThread]: On master: Close
[0m18:35:30.577291 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:35:30.579393 [debug] [MainThread]: Connection 'list_IDX-Stock' was properly closed.
[0m18:35:30.580415 [debug] [MainThread]: Connection 'list_IDX-Stock_snapshots' was properly closed.
[0m18:35:30.581395 [debug] [MainThread]: Connection 'model.dbt_idx.customer_orders_status' was properly closed.
[0m18:35:30.582389 [info ] [MainThread]: 
[0m18:35:30.583414 [info ] [MainThread]: Finished running 5 view models, 2 table models in 0 hours 0 minutes and 1.15 seconds (1.15s).
[0m18:35:30.585396 [debug] [MainThread]: Command end result
[0m18:35:30.606037 [info ] [MainThread]: 
[0m18:35:30.606876 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:35:30.607887 [info ] [MainThread]: 
[0m18:35:30.609400 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=0 SKIP=0 TOTAL=7
[0m18:35:30.610402 [debug] [MainThread]: Command `dbt run` succeeded at 18:35:30.610402 after 1.64 seconds
[0m18:35:30.611423 [debug] [MainThread]: Flushing usage events


============================== 18:36:02.566662 | 2b1a0c7e-1296-45f6-9d0d-318350efcf46 ==============================
[0m18:36:02.566662 [info ] [MainThread]: Running with dbt=1.6.1
[0m18:36:02.571179 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': 'D:\\00 Project\\00 My Project\\IdeaProjects\\Py-DBT-IDX\\logs', 'profiles_dir': 'D:\\00 Project\\00 My Project\\IdeaProjects\\Py-DBT-IDX', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt test', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'False'}
[0m18:36:02.712354 [info ] [MainThread]: Registered adapter: postgres=1.6.1
[0m18:36:02.721856 [debug] [MainThread]: checksum: efe19d9f5b93d1a98cc804fbfcdb6b3aced98b974af664946fee1cde8837deb7, vars: {}, profile: , target: , version: 1.6.1
[0m18:36:02.888245 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m18:36:02.890191 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m18:36:02.936223 [info ] [MainThread]: Found 1 snapshot, 9 tests, 7 models, 3 sources, 0 exposures, 0 metrics, 349 macros, 0 groups, 0 semantic models
[0m18:36:02.938740 [info ] [MainThread]: 
[0m18:36:02.940752 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m18:36:02.946764 [debug] [ThreadPool]: Acquiring new postgres connection 'list_IDX-Stock_snapshots'
[0m18:36:02.957346 [debug] [ThreadPool]: Using postgres connection "list_IDX-Stock_snapshots"
[0m18:36:02.957346 [debug] [ThreadPool]: On list_IDX-Stock_snapshots: BEGIN
[0m18:36:02.958345 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:36:02.992049 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m18:36:02.993051 [debug] [ThreadPool]: Using postgres connection "list_IDX-Stock_snapshots"
[0m18:36:02.993587 [debug] [ThreadPool]: On list_IDX-Stock_snapshots: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "connection_name": "list_IDX-Stock_snapshots"} */
select
      'IDX-Stock' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'snapshots'
    union all
    select
      'IDX-Stock' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'snapshots'
    union all
    select
      'IDX-Stock' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'snapshots'
  
[0m18:36:02.997600 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.0 seconds
[0m18:36:02.999137 [debug] [ThreadPool]: On list_IDX-Stock_snapshots: ROLLBACK
[0m18:36:03.002144 [debug] [ThreadPool]: On list_IDX-Stock_snapshots: Close
[0m18:36:03.004143 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_IDX-Stock_snapshots, now list_IDX-Stock_warehouse)
[0m18:36:03.009654 [debug] [ThreadPool]: Using postgres connection "list_IDX-Stock_warehouse"
[0m18:36:03.011663 [debug] [ThreadPool]: On list_IDX-Stock_warehouse: BEGIN
[0m18:36:03.012675 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:36:03.034770 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m18:36:03.035770 [debug] [ThreadPool]: Using postgres connection "list_IDX-Stock_warehouse"
[0m18:36:03.036768 [debug] [ThreadPool]: On list_IDX-Stock_warehouse: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "connection_name": "list_IDX-Stock_warehouse"} */
select
      'IDX-Stock' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'warehouse'
    union all
    select
      'IDX-Stock' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'warehouse'
    union all
    select
      'IDX-Stock' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'warehouse'
  
[0m18:36:03.041292 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.0 seconds
[0m18:36:03.043311 [debug] [ThreadPool]: On list_IDX-Stock_warehouse: ROLLBACK
[0m18:36:03.045282 [debug] [ThreadPool]: On list_IDX-Stock_warehouse: Close
[0m18:36:03.056837 [debug] [MainThread]: Using postgres connection "master"
[0m18:36:03.056837 [debug] [MainThread]: On master: BEGIN
[0m18:36:03.058342 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:36:03.081321 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m18:36:03.082318 [debug] [MainThread]: Using postgres connection "master"
[0m18:36:03.083318 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m18:36:03.090574 [debug] [MainThread]: SQL status: SELECT 6 in 0.0 seconds
[0m18:36:03.093150 [debug] [MainThread]: On master: ROLLBACK
[0m18:36:03.096087 [debug] [MainThread]: Using postgres connection "master"
[0m18:36:03.096087 [debug] [MainThread]: On master: BEGIN
[0m18:36:03.100635 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m18:36:03.101635 [debug] [MainThread]: On master: COMMIT
[0m18:36:03.101635 [debug] [MainThread]: Using postgres connection "master"
[0m18:36:03.102636 [debug] [MainThread]: On master: COMMIT
[0m18:36:03.104938 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m18:36:03.105926 [debug] [MainThread]: On master: Close
[0m18:36:03.106926 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:36:03.109444 [info ] [MainThread]: 
[0m18:36:03.116441 [debug] [Thread-1 (]: Began running node test.dbt_idx.accepted_values_customer_orders_status_order_status__delivered__invoiced__shipped__processing__canceled__unavailable.ea8c296d27
[0m18:36:03.117444 [info ] [Thread-1 (]: 1 of 9 START test accepted_values_customer_orders_status_order_status__delivered__invoiced__shipped__processing__canceled__unavailable  [RUN]
[0m18:36:03.119571 [debug] [Thread-1 (]: Acquiring new postgres connection 'test.dbt_idx.accepted_values_customer_orders_status_order_status__delivered__invoiced__shipped__processing__canceled__unavailable.ea8c296d27'
[0m18:36:03.120566 [debug] [Thread-1 (]: Began compiling node test.dbt_idx.accepted_values_customer_orders_status_order_status__delivered__invoiced__shipped__processing__canceled__unavailable.ea8c296d27
[0m18:36:03.149722 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_idx.accepted_values_customer_orders_status_order_status__delivered__invoiced__shipped__processing__canceled__unavailable.ea8c296d27"
[0m18:36:03.159291 [debug] [Thread-1 (]: Timing info for test.dbt_idx.accepted_values_customer_orders_status_order_status__delivered__invoiced__shipped__processing__canceled__unavailable.ea8c296d27 (compile): 18:36:03.122581 => 18:36:03.159291
[0m18:36:03.161328 [debug] [Thread-1 (]: Began executing node test.dbt_idx.accepted_values_customer_orders_status_order_status__delivered__invoiced__shipped__processing__canceled__unavailable.ea8c296d27
[0m18:36:03.180883 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_idx.accepted_values_customer_orders_status_order_status__delivered__invoiced__shipped__processing__canceled__unavailable.ea8c296d27"
[0m18:36:03.189406 [debug] [Thread-1 (]: Using postgres connection "test.dbt_idx.accepted_values_customer_orders_status_order_status__delivered__invoiced__shipped__processing__canceled__unavailable.ea8c296d27"
[0m18:36:03.190406 [debug] [Thread-1 (]: On test.dbt_idx.accepted_values_customer_orders_status_order_status__delivered__invoiced__shipped__processing__canceled__unavailable.ea8c296d27: BEGIN
[0m18:36:03.191402 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m18:36:03.221706 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m18:36:03.223669 [debug] [Thread-1 (]: Using postgres connection "test.dbt_idx.accepted_values_customer_orders_status_order_status__delivered__invoiced__shipped__processing__canceled__unavailable.ea8c296d27"
[0m18:36:03.224669 [debug] [Thread-1 (]: On test.dbt_idx.accepted_values_customer_orders_status_order_status__delivered__invoiced__shipped__processing__canceled__unavailable.ea8c296d27: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "test.dbt_idx.accepted_values_customer_orders_status_order_status__delivered__invoiced__shipped__processing__canceled__unavailable.ea8c296d27"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        order_status as value_field,
        count(*) as n_records

    from "IDX-Stock"."warehouse"."customer_orders_status"
    group by order_status

)

select *
from all_values
where value_field not in (
    'delivered','invoiced','shipped','processing','canceled','unavailable'
)



      
    ) dbt_internal_test
[0m18:36:03.229213 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m18:36:03.232244 [debug] [Thread-1 (]: Timing info for test.dbt_idx.accepted_values_customer_orders_status_order_status__delivered__invoiced__shipped__processing__canceled__unavailable.ea8c296d27 (execute): 18:36:03.162298 => 18:36:03.232244
[0m18:36:03.233240 [debug] [Thread-1 (]: On test.dbt_idx.accepted_values_customer_orders_status_order_status__delivered__invoiced__shipped__processing__canceled__unavailable.ea8c296d27: ROLLBACK
[0m18:36:03.236220 [debug] [Thread-1 (]: On test.dbt_idx.accepted_values_customer_orders_status_order_status__delivered__invoiced__shipped__processing__canceled__unavailable.ea8c296d27: Close
[0m18:36:03.238206 [info ] [Thread-1 (]: 1 of 9 PASS accepted_values_customer_orders_status_order_status__delivered__invoiced__shipped__processing__canceled__unavailable  [[32mPASS[0m in 0.12s]
[0m18:36:03.241344 [debug] [Thread-1 (]: Finished running node test.dbt_idx.accepted_values_customer_orders_status_order_status__delivered__invoiced__shipped__processing__canceled__unavailable.ea8c296d27
[0m18:36:03.242310 [debug] [Thread-1 (]: Began running node test.dbt_idx.assert_customer_dimension_has_no_row_loss.sql
[0m18:36:03.243344 [info ] [Thread-1 (]: 2 of 9 START test assert_customer_dimension_has_no_row_loss.sql ................ [RUN]
[0m18:36:03.245308 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_idx.accepted_values_customer_orders_status_order_status__delivered__invoiced__shipped__processing__canceled__unavailable.ea8c296d27, now test.dbt_idx.assert_customer_dimension_has_no_row_loss.sql)
[0m18:36:03.246317 [debug] [Thread-1 (]: Began compiling node test.dbt_idx.assert_customer_dimension_has_no_row_loss.sql
[0m18:36:03.250937 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_idx.assert_customer_dimension_has_no_row_loss.sql"
[0m18:36:03.260461 [debug] [Thread-1 (]: Timing info for test.dbt_idx.assert_customer_dimension_has_no_row_loss.sql (compile): 18:36:03.247307 => 18:36:03.260461
[0m18:36:03.261493 [debug] [Thread-1 (]: Began executing node test.dbt_idx.assert_customer_dimension_has_no_row_loss.sql
[0m18:36:03.264467 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_idx.assert_customer_dimension_has_no_row_loss.sql"
[0m18:36:03.272026 [debug] [Thread-1 (]: Using postgres connection "test.dbt_idx.assert_customer_dimension_has_no_row_loss.sql"
[0m18:36:03.273017 [debug] [Thread-1 (]: On test.dbt_idx.assert_customer_dimension_has_no_row_loss.sql: BEGIN
[0m18:36:03.274016 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:36:03.312495 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m18:36:03.314495 [debug] [Thread-1 (]: Using postgres connection "test.dbt_idx.assert_customer_dimension_has_no_row_loss.sql"
[0m18:36:03.316574 [debug] [Thread-1 (]: On test.dbt_idx.assert_customer_dimension_has_no_row_loss.sql: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "test.dbt_idx.assert_customer_dimension_has_no_row_loss.sql"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      -- dim_customers must have the same number of rows as its staging counterpart
-- Therefore return records where this isn't true to make the test fail
select *
from (
         select stg_cust.customer_id
         from "IDX-Stock"."warehouse"."stg_eltool__customers" stg_cust
             inner join "IDX-Stock"."warehouse"."dim_customers" dim_cust
         on stg_cust.customer_id = dim_cust.customer_id
         where dim_cust.customer_id is null
     ) tmp
      
    ) dbt_internal_test
[0m18:36:03.323696 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m18:36:03.328234 [debug] [Thread-1 (]: Timing info for test.dbt_idx.assert_customer_dimension_has_no_row_loss.sql (execute): 18:36:03.262486 => 18:36:03.327222
[0m18:36:03.330264 [debug] [Thread-1 (]: On test.dbt_idx.assert_customer_dimension_has_no_row_loss.sql: ROLLBACK
[0m18:36:03.332774 [debug] [Thread-1 (]: On test.dbt_idx.assert_customer_dimension_has_no_row_loss.sql: Close
[0m18:36:03.335870 [info ] [Thread-1 (]: 2 of 9 PASS assert_customer_dimension_has_no_row_loss.sql ...................... [[32mPASS[0m in 0.09s]
[0m18:36:03.344021 [debug] [Thread-1 (]: Finished running node test.dbt_idx.assert_customer_dimension_has_no_row_loss.sql
[0m18:36:03.346038 [debug] [Thread-1 (]: Began running node test.dbt_idx.not_null_customer_orders_status_customer_id.3915c814eb
[0m18:36:03.347036 [info ] [Thread-1 (]: 3 of 9 START test not_null_customer_orders_status_customer_id .................. [RUN]
[0m18:36:03.349564 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_idx.assert_customer_dimension_has_no_row_loss.sql, now test.dbt_idx.not_null_customer_orders_status_customer_id.3915c814eb)
[0m18:36:03.352080 [debug] [Thread-1 (]: Began compiling node test.dbt_idx.not_null_customer_orders_status_customer_id.3915c814eb
[0m18:36:03.371908 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_idx.not_null_customer_orders_status_customer_id.3915c814eb"
[0m18:36:03.384367 [debug] [Thread-1 (]: Timing info for test.dbt_idx.not_null_customer_orders_status_customer_id.3915c814eb (compile): 18:36:03.352618 => 18:36:03.383853
[0m18:36:03.385993 [debug] [Thread-1 (]: Began executing node test.dbt_idx.not_null_customer_orders_status_customer_id.3915c814eb
[0m18:36:03.394944 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_idx.not_null_customer_orders_status_customer_id.3915c814eb"
[0m18:36:03.405595 [debug] [Thread-1 (]: Using postgres connection "test.dbt_idx.not_null_customer_orders_status_customer_id.3915c814eb"
[0m18:36:03.406898 [debug] [Thread-1 (]: On test.dbt_idx.not_null_customer_orders_status_customer_id.3915c814eb: BEGIN
[0m18:36:03.409416 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:36:03.431399 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m18:36:03.432434 [debug] [Thread-1 (]: Using postgres connection "test.dbt_idx.not_null_customer_orders_status_customer_id.3915c814eb"
[0m18:36:03.433396 [debug] [Thread-1 (]: On test.dbt_idx.not_null_customer_orders_status_customer_id.3915c814eb: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "test.dbt_idx.not_null_customer_orders_status_customer_id.3915c814eb"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select customer_id
from "IDX-Stock"."warehouse"."customer_orders_status"
where customer_id is null



      
    ) dbt_internal_test
[0m18:36:03.437931 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m18:36:03.440475 [debug] [Thread-1 (]: Timing info for test.dbt_idx.not_null_customer_orders_status_customer_id.3915c814eb (execute): 18:36:03.387615 => 18:36:03.440475
[0m18:36:03.441486 [debug] [Thread-1 (]: On test.dbt_idx.not_null_customer_orders_status_customer_id.3915c814eb: ROLLBACK
[0m18:36:03.444488 [debug] [Thread-1 (]: On test.dbt_idx.not_null_customer_orders_status_customer_id.3915c814eb: Close
[0m18:36:03.446487 [info ] [Thread-1 (]: 3 of 9 PASS not_null_customer_orders_status_customer_id ........................ [[32mPASS[0m in 0.10s]
[0m18:36:03.448987 [debug] [Thread-1 (]: Finished running node test.dbt_idx.not_null_customer_orders_status_customer_id.3915c814eb
[0m18:36:03.449995 [debug] [Thread-1 (]: Began running node test.dbt_idx.not_null_stg_eltool__customers_snapshots_customer_id.ea4fc4ca86
[0m18:36:03.450997 [info ] [Thread-1 (]: 4 of 9 START test not_null_stg_eltool__customers_snapshots_customer_id ......... [RUN]
[0m18:36:03.453009 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_idx.not_null_customer_orders_status_customer_id.3915c814eb, now test.dbt_idx.not_null_stg_eltool__customers_snapshots_customer_id.ea4fc4ca86)
[0m18:36:03.454019 [debug] [Thread-1 (]: Began compiling node test.dbt_idx.not_null_stg_eltool__customers_snapshots_customer_id.ea4fc4ca86
[0m18:36:03.463065 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_idx.not_null_stg_eltool__customers_snapshots_customer_id.ea4fc4ca86"
[0m18:36:03.470627 [debug] [Thread-1 (]: Timing info for test.dbt_idx.not_null_stg_eltool__customers_snapshots_customer_id.ea4fc4ca86 (compile): 18:36:03.455005 => 18:36:03.470627
[0m18:36:03.471624 [debug] [Thread-1 (]: Began executing node test.dbt_idx.not_null_stg_eltool__customers_snapshots_customer_id.ea4fc4ca86
[0m18:36:03.475657 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_idx.not_null_stg_eltool__customers_snapshots_customer_id.ea4fc4ca86"
[0m18:36:03.483680 [debug] [Thread-1 (]: Using postgres connection "test.dbt_idx.not_null_stg_eltool__customers_snapshots_customer_id.ea4fc4ca86"
[0m18:36:03.484715 [debug] [Thread-1 (]: On test.dbt_idx.not_null_stg_eltool__customers_snapshots_customer_id.ea4fc4ca86: BEGIN
[0m18:36:03.485676 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:36:03.509646 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m18:36:03.511658 [debug] [Thread-1 (]: Using postgres connection "test.dbt_idx.not_null_stg_eltool__customers_snapshots_customer_id.ea4fc4ca86"
[0m18:36:03.511658 [debug] [Thread-1 (]: On test.dbt_idx.not_null_stg_eltool__customers_snapshots_customer_id.ea4fc4ca86: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "test.dbt_idx.not_null_stg_eltool__customers_snapshots_customer_id.ea4fc4ca86"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select customer_id
from "IDX-Stock"."warehouse"."stg_eltool__customers_snapshots"
where customer_id is null



      
    ) dbt_internal_test
[0m18:36:03.515649 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m18:36:03.518199 [debug] [Thread-1 (]: Timing info for test.dbt_idx.not_null_stg_eltool__customers_snapshots_customer_id.ea4fc4ca86 (execute): 18:36:03.472679 => 18:36:03.518199
[0m18:36:03.520207 [debug] [Thread-1 (]: On test.dbt_idx.not_null_stg_eltool__customers_snapshots_customer_id.ea4fc4ca86: ROLLBACK
[0m18:36:03.522256 [debug] [Thread-1 (]: On test.dbt_idx.not_null_stg_eltool__customers_snapshots_customer_id.ea4fc4ca86: Close
[0m18:36:03.525772 [info ] [Thread-1 (]: 4 of 9 PASS not_null_stg_eltool__customers_snapshots_customer_id ............... [[32mPASS[0m in 0.07s]
[0m18:36:03.526780 [debug] [Thread-1 (]: Finished running node test.dbt_idx.not_null_stg_eltool__customers_snapshots_customer_id.ea4fc4ca86
[0m18:36:03.528371 [debug] [Thread-1 (]: Began running node test.dbt_idx.source_not_null_warehouse_customers_customer_id.ae7452c4c6
[0m18:36:03.530297 [info ] [Thread-1 (]: 5 of 9 START test source_not_null_warehouse_customers_customer_id .............. [RUN]
[0m18:36:03.531329 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_idx.not_null_stg_eltool__customers_snapshots_customer_id.ea4fc4ca86, now test.dbt_idx.source_not_null_warehouse_customers_customer_id.ae7452c4c6)
[0m18:36:03.532334 [debug] [Thread-1 (]: Began compiling node test.dbt_idx.source_not_null_warehouse_customers_customer_id.ae7452c4c6
[0m18:36:03.537332 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_idx.source_not_null_warehouse_customers_customer_id.ae7452c4c6"
[0m18:36:03.544311 [debug] [Thread-1 (]: Timing info for test.dbt_idx.source_not_null_warehouse_customers_customer_id.ae7452c4c6 (compile): 18:36:03.533335 => 18:36:03.544311
[0m18:36:03.545335 [debug] [Thread-1 (]: Began executing node test.dbt_idx.source_not_null_warehouse_customers_customer_id.ae7452c4c6
[0m18:36:03.549988 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_idx.source_not_null_warehouse_customers_customer_id.ae7452c4c6"
[0m18:36:03.556954 [debug] [Thread-1 (]: Using postgres connection "test.dbt_idx.source_not_null_warehouse_customers_customer_id.ae7452c4c6"
[0m18:36:03.556954 [debug] [Thread-1 (]: On test.dbt_idx.source_not_null_warehouse_customers_customer_id.ae7452c4c6: BEGIN
[0m18:36:03.558548 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:36:03.582253 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m18:36:03.583217 [debug] [Thread-1 (]: Using postgres connection "test.dbt_idx.source_not_null_warehouse_customers_customer_id.ae7452c4c6"
[0m18:36:03.584219 [debug] [Thread-1 (]: On test.dbt_idx.source_not_null_warehouse_customers_customer_id.ae7452c4c6: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "test.dbt_idx.source_not_null_warehouse_customers_customer_id.ae7452c4c6"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select customer_id
from "IDX-Stock"."warehouse"."customers"
where customer_id is null



      
    ) dbt_internal_test
[0m18:36:03.587232 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m18:36:03.589681 [debug] [Thread-1 (]: Timing info for test.dbt_idx.source_not_null_warehouse_customers_customer_id.ae7452c4c6 (execute): 18:36:03.546351 => 18:36:03.589681
[0m18:36:03.590636 [debug] [Thread-1 (]: On test.dbt_idx.source_not_null_warehouse_customers_customer_id.ae7452c4c6: ROLLBACK
[0m18:36:03.593233 [debug] [Thread-1 (]: On test.dbt_idx.source_not_null_warehouse_customers_customer_id.ae7452c4c6: Close
[0m18:36:03.595265 [info ] [Thread-1 (]: 5 of 9 PASS source_not_null_warehouse_customers_customer_id .................... [[32mPASS[0m in 0.06s]
[0m18:36:03.598243 [debug] [Thread-1 (]: Finished running node test.dbt_idx.source_not_null_warehouse_customers_customer_id.ae7452c4c6
[0m18:36:03.599790 [debug] [Thread-1 (]: Began running node test.dbt_idx.source_not_null_warehouse_orders_order_id.c85a1f0b76
[0m18:36:03.600759 [info ] [Thread-1 (]: 6 of 9 START test source_not_null_warehouse_orders_order_id .................... [RUN]
[0m18:36:03.602758 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_idx.source_not_null_warehouse_customers_customer_id.ae7452c4c6, now test.dbt_idx.source_not_null_warehouse_orders_order_id.c85a1f0b76)
[0m18:36:03.603773 [debug] [Thread-1 (]: Began compiling node test.dbt_idx.source_not_null_warehouse_orders_order_id.c85a1f0b76
[0m18:36:03.609275 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_idx.source_not_null_warehouse_orders_order_id.c85a1f0b76"
[0m18:36:03.616860 [debug] [Thread-1 (]: Timing info for test.dbt_idx.source_not_null_warehouse_orders_order_id.c85a1f0b76 (compile): 18:36:03.603773 => 18:36:03.615803
[0m18:36:03.616860 [debug] [Thread-1 (]: Began executing node test.dbt_idx.source_not_null_warehouse_orders_order_id.c85a1f0b76
[0m18:36:03.621406 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_idx.source_not_null_warehouse_orders_order_id.c85a1f0b76"
[0m18:36:03.627452 [debug] [Thread-1 (]: Using postgres connection "test.dbt_idx.source_not_null_warehouse_orders_order_id.c85a1f0b76"
[0m18:36:03.628912 [debug] [Thread-1 (]: On test.dbt_idx.source_not_null_warehouse_orders_order_id.c85a1f0b76: BEGIN
[0m18:36:03.629922 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:36:03.652538 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m18:36:03.653539 [debug] [Thread-1 (]: Using postgres connection "test.dbt_idx.source_not_null_warehouse_orders_order_id.c85a1f0b76"
[0m18:36:03.655058 [debug] [Thread-1 (]: On test.dbt_idx.source_not_null_warehouse_orders_order_id.c85a1f0b76: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "test.dbt_idx.source_not_null_warehouse_orders_order_id.c85a1f0b76"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select order_id
from "IDX-Stock"."warehouse"."orders"
where order_id is null



      
    ) dbt_internal_test
[0m18:36:03.657100 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m18:36:03.660663 [debug] [Thread-1 (]: Timing info for test.dbt_idx.source_not_null_warehouse_orders_order_id.c85a1f0b76 (execute): 18:36:03.618457 => 18:36:03.659623
[0m18:36:03.661624 [debug] [Thread-1 (]: On test.dbt_idx.source_not_null_warehouse_orders_order_id.c85a1f0b76: ROLLBACK
[0m18:36:03.663625 [debug] [Thread-1 (]: On test.dbt_idx.source_not_null_warehouse_orders_order_id.c85a1f0b76: Close
[0m18:36:03.665626 [info ] [Thread-1 (]: 6 of 9 PASS source_not_null_warehouse_orders_order_id .......................... [[32mPASS[0m in 0.06s]
[0m18:36:03.668151 [debug] [Thread-1 (]: Finished running node test.dbt_idx.source_not_null_warehouse_orders_order_id.c85a1f0b76
[0m18:36:03.669158 [debug] [Thread-1 (]: Began running node test.dbt_idx.source_relationships_warehouse_orders_cust_id__customer_id__source_warehouse_customers_.d3f9188fc2
[0m18:36:03.670167 [info ] [Thread-1 (]: 7 of 9 START test source_relationships_warehouse_orders_cust_id__customer_id__source_warehouse_customers_  [RUN]
[0m18:36:03.672206 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_idx.source_not_null_warehouse_orders_order_id.c85a1f0b76, now test.dbt_idx.source_relationships_warehouse_orders_cust_id__customer_id__source_warehouse_customers_.d3f9188fc2)
[0m18:36:03.672206 [debug] [Thread-1 (]: Began compiling node test.dbt_idx.source_relationships_warehouse_orders_cust_id__customer_id__source_warehouse_customers_.d3f9188fc2
[0m18:36:03.684070 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_idx.source_relationships_warehouse_orders_cust_id__customer_id__source_warehouse_customers_.d3f9188fc2"
[0m18:36:03.691612 [debug] [Thread-1 (]: Timing info for test.dbt_idx.source_relationships_warehouse_orders_cust_id__customer_id__source_warehouse_customers_.d3f9188fc2 (compile): 18:36:03.673218 => 18:36:03.690634
[0m18:36:03.691612 [debug] [Thread-1 (]: Began executing node test.dbt_idx.source_relationships_warehouse_orders_cust_id__customer_id__source_warehouse_customers_.d3f9188fc2
[0m18:36:03.696163 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_idx.source_relationships_warehouse_orders_cust_id__customer_id__source_warehouse_customers_.d3f9188fc2"
[0m18:36:03.704718 [debug] [Thread-1 (]: Using postgres connection "test.dbt_idx.source_relationships_warehouse_orders_cust_id__customer_id__source_warehouse_customers_.d3f9188fc2"
[0m18:36:03.705721 [debug] [Thread-1 (]: On test.dbt_idx.source_relationships_warehouse_orders_cust_id__customer_id__source_warehouse_customers_.d3f9188fc2: BEGIN
[0m18:36:03.706719 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:36:03.733257 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m18:36:03.733257 [debug] [Thread-1 (]: Using postgres connection "test.dbt_idx.source_relationships_warehouse_orders_cust_id__customer_id__source_warehouse_customers_.d3f9188fc2"
[0m18:36:03.734762 [debug] [Thread-1 (]: On test.dbt_idx.source_relationships_warehouse_orders_cust_id__customer_id__source_warehouse_customers_.d3f9188fc2: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "test.dbt_idx.source_relationships_warehouse_orders_cust_id__customer_id__source_warehouse_customers_.d3f9188fc2"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select cust_id as from_field
    from "IDX-Stock"."warehouse"."orders"
    where cust_id is not null
),

parent as (
    select customer_id as to_field
    from "IDX-Stock"."warehouse"."customers"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m18:36:03.738343 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m18:36:03.741381 [debug] [Thread-1 (]: Timing info for test.dbt_idx.source_relationships_warehouse_orders_cust_id__customer_id__source_warehouse_customers_.d3f9188fc2 (execute): 18:36:03.693235 => 18:36:03.740350
[0m18:36:03.742349 [debug] [Thread-1 (]: On test.dbt_idx.source_relationships_warehouse_orders_cust_id__customer_id__source_warehouse_customers_.d3f9188fc2: ROLLBACK
[0m18:36:03.744349 [debug] [Thread-1 (]: On test.dbt_idx.source_relationships_warehouse_orders_cust_id__customer_id__source_warehouse_customers_.d3f9188fc2: Close
[0m18:36:03.746348 [info ] [Thread-1 (]: 7 of 9 PASS source_relationships_warehouse_orders_cust_id__customer_id__source_warehouse_customers_  [[32mPASS[0m in 0.08s]
[0m18:36:03.748351 [debug] [Thread-1 (]: Finished running node test.dbt_idx.source_relationships_warehouse_orders_cust_id__customer_id__source_warehouse_customers_.d3f9188fc2
[0m18:36:03.749599 [debug] [Thread-1 (]: Began running node test.dbt_idx.source_unique_warehouse_orders_order_id.839fb43d0f
[0m18:36:03.750570 [info ] [Thread-1 (]: 8 of 9 START test source_unique_warehouse_orders_order_id ...................... [RUN]
[0m18:36:03.751570 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_idx.source_relationships_warehouse_orders_cust_id__customer_id__source_warehouse_customers_.d3f9188fc2, now test.dbt_idx.source_unique_warehouse_orders_order_id.839fb43d0f)
[0m18:36:03.753096 [debug] [Thread-1 (]: Began compiling node test.dbt_idx.source_unique_warehouse_orders_order_id.839fb43d0f
[0m18:36:03.763299 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_idx.source_unique_warehouse_orders_order_id.839fb43d0f"
[0m18:36:03.771546 [debug] [Thread-1 (]: Timing info for test.dbt_idx.source_unique_warehouse_orders_order_id.839fb43d0f (compile): 18:36:03.754122 => 18:36:03.771546
[0m18:36:03.772545 [debug] [Thread-1 (]: Began executing node test.dbt_idx.source_unique_warehouse_orders_order_id.839fb43d0f
[0m18:36:03.776100 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_idx.source_unique_warehouse_orders_order_id.839fb43d0f"
[0m18:36:03.784671 [debug] [Thread-1 (]: Using postgres connection "test.dbt_idx.source_unique_warehouse_orders_order_id.839fb43d0f"
[0m18:36:03.788174 [debug] [Thread-1 (]: On test.dbt_idx.source_unique_warehouse_orders_order_id.839fb43d0f: BEGIN
[0m18:36:03.789183 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:36:03.812397 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m18:36:03.813381 [debug] [Thread-1 (]: Using postgres connection "test.dbt_idx.source_unique_warehouse_orders_order_id.839fb43d0f"
[0m18:36:03.814382 [debug] [Thread-1 (]: On test.dbt_idx.source_unique_warehouse_orders_order_id.839fb43d0f: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "test.dbt_idx.source_unique_warehouse_orders_order_id.839fb43d0f"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    order_id as unique_field,
    count(*) as n_records

from "IDX-Stock"."warehouse"."orders"
where order_id is not null
group by order_id
having count(*) > 1



      
    ) dbt_internal_test
[0m18:36:03.818383 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m18:36:03.819905 [debug] [Thread-1 (]: Timing info for test.dbt_idx.source_unique_warehouse_orders_order_id.839fb43d0f (execute): 18:36:03.772545 => 18:36:03.819905
[0m18:36:03.820915 [debug] [Thread-1 (]: On test.dbt_idx.source_unique_warehouse_orders_order_id.839fb43d0f: ROLLBACK
[0m18:36:03.822917 [debug] [Thread-1 (]: On test.dbt_idx.source_unique_warehouse_orders_order_id.839fb43d0f: Close
[0m18:36:03.825916 [info ] [Thread-1 (]: 8 of 9 PASS source_unique_warehouse_orders_order_id ............................ [[32mPASS[0m in 0.07s]
[0m18:36:03.826913 [debug] [Thread-1 (]: Finished running node test.dbt_idx.source_unique_warehouse_orders_order_id.839fb43d0f
[0m18:36:03.828439 [debug] [Thread-1 (]: Began running node test.dbt_idx.unique_customer_orders_status_order_id.b7a45e83ee
[0m18:36:03.829446 [info ] [Thread-1 (]: 9 of 9 START test unique_customer_orders_status_order_id ....................... [RUN]
[0m18:36:03.831447 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_idx.source_unique_warehouse_orders_order_id.839fb43d0f, now test.dbt_idx.unique_customer_orders_status_order_id.b7a45e83ee)
[0m18:36:03.831447 [debug] [Thread-1 (]: Began compiling node test.dbt_idx.unique_customer_orders_status_order_id.b7a45e83ee
[0m18:36:03.837616 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_idx.unique_customer_orders_status_order_id.b7a45e83ee"
[0m18:36:03.845131 [debug] [Thread-1 (]: Timing info for test.dbt_idx.unique_customer_orders_status_order_id.b7a45e83ee (compile): 18:36:03.832562 => 18:36:03.845131
[0m18:36:03.846174 [debug] [Thread-1 (]: Began executing node test.dbt_idx.unique_customer_orders_status_order_id.b7a45e83ee
[0m18:36:03.851248 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_idx.unique_customer_orders_status_order_id.b7a45e83ee"
[0m18:36:03.858777 [debug] [Thread-1 (]: Using postgres connection "test.dbt_idx.unique_customer_orders_status_order_id.b7a45e83ee"
[0m18:36:03.860786 [debug] [Thread-1 (]: On test.dbt_idx.unique_customer_orders_status_order_id.b7a45e83ee: BEGIN
[0m18:36:03.861791 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:36:03.889501 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m18:36:03.891034 [debug] [Thread-1 (]: Using postgres connection "test.dbt_idx.unique_customer_orders_status_order_id.b7a45e83ee"
[0m18:36:03.892580 [debug] [Thread-1 (]: On test.dbt_idx.unique_customer_orders_status_order_id.b7a45e83ee: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "test.dbt_idx.unique_customer_orders_status_order_id.b7a45e83ee"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    order_id as unique_field,
    count(*) as n_records

from "IDX-Stock"."warehouse"."customer_orders_status"
where order_id is not null
group by order_id
having count(*) > 1



      
    ) dbt_internal_test
[0m18:36:03.897124 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m18:36:03.900650 [debug] [Thread-1 (]: Timing info for test.dbt_idx.unique_customer_orders_status_order_id.b7a45e83ee (execute): 18:36:03.847166 => 18:36:03.900650
[0m18:36:03.901662 [debug] [Thread-1 (]: On test.dbt_idx.unique_customer_orders_status_order_id.b7a45e83ee: ROLLBACK
[0m18:36:03.904665 [debug] [Thread-1 (]: On test.dbt_idx.unique_customer_orders_status_order_id.b7a45e83ee: Close
[0m18:36:03.906665 [info ] [Thread-1 (]: 9 of 9 PASS unique_customer_orders_status_order_id ............................. [[32mPASS[0m in 0.08s]
[0m18:36:03.909196 [debug] [Thread-1 (]: Finished running node test.dbt_idx.unique_customer_orders_status_order_id.b7a45e83ee
[0m18:36:03.913227 [debug] [MainThread]: Using postgres connection "master"
[0m18:36:03.914251 [debug] [MainThread]: On master: BEGIN
[0m18:36:03.915226 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:36:03.937430 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m18:36:03.938431 [debug] [MainThread]: On master: COMMIT
[0m18:36:03.939598 [debug] [MainThread]: Using postgres connection "master"
[0m18:36:03.940618 [debug] [MainThread]: On master: COMMIT
[0m18:36:03.942610 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m18:36:03.943607 [debug] [MainThread]: On master: Close
[0m18:36:03.945608 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:36:03.947606 [debug] [MainThread]: Connection 'list_IDX-Stock_warehouse' was properly closed.
[0m18:36:03.948606 [debug] [MainThread]: Connection 'test.dbt_idx.unique_customer_orders_status_order_id.b7a45e83ee' was properly closed.
[0m18:36:03.950130 [info ] [MainThread]: 
[0m18:36:03.951138 [info ] [MainThread]: Finished running 9 tests in 0 hours 0 minutes and 1.01 seconds (1.01s).
[0m18:36:03.954136 [debug] [MainThread]: Command end result
[0m18:36:03.978297 [info ] [MainThread]: 
[0m18:36:03.980247 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:36:03.982254 [info ] [MainThread]: 
[0m18:36:03.984255 [info ] [MainThread]: Done. PASS=9 WARN=0 ERROR=0 SKIP=0 TOTAL=9
[0m18:36:03.985253 [debug] [MainThread]: Command `dbt test` succeeded at 18:36:03.985253 after 1.47 seconds
[0m18:36:03.987262 [debug] [MainThread]: Flushing usage events


============================== 18:39:15.367768 | d5610f05-9243-47d0-a2bf-a577785a1f20 ==============================
[0m18:39:15.367768 [info ] [MainThread]: Running with dbt=1.6.1
[0m18:39:15.376345 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': 'D:\\00 Project\\00 My Project\\IdeaProjects\\Py-DBT-IDX', 'log_path': 'D:\\00 Project\\00 My Project\\IdeaProjects\\Py-DBT-IDX\\logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt test', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'False'}
[0m18:39:15.577980 [info ] [MainThread]: Registered adapter: postgres=1.6.1
[0m18:39:15.593019 [debug] [MainThread]: checksum: efe19d9f5b93d1a98cc804fbfcdb6b3aced98b974af664946fee1cde8837deb7, vars: {}, profile: , target: , version: 1.6.1
[0m18:39:15.793838 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m18:39:15.794839 [debug] [MainThread]: Partial parsing: updated file: dbt_idx://tests\assert_customer_dimension_has_no_row_loss.sql.sql
[0m18:39:15.893024 [info ] [MainThread]: Found 1 snapshot, 9 tests, 7 models, 3 sources, 0 exposures, 0 metrics, 349 macros, 0 groups, 0 semantic models
[0m18:39:15.899056 [info ] [MainThread]: 
[0m18:39:15.901058 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m18:39:15.905056 [debug] [ThreadPool]: Acquiring new postgres connection 'list_IDX-Stock_warehouse'
[0m18:39:15.925943 [debug] [ThreadPool]: Using postgres connection "list_IDX-Stock_warehouse"
[0m18:39:15.926938 [debug] [ThreadPool]: On list_IDX-Stock_warehouse: BEGIN
[0m18:39:15.927940 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:39:15.973425 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m18:39:15.974454 [debug] [ThreadPool]: Using postgres connection "list_IDX-Stock_warehouse"
[0m18:39:15.975423 [debug] [ThreadPool]: On list_IDX-Stock_warehouse: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "connection_name": "list_IDX-Stock_warehouse"} */
select
      'IDX-Stock' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'warehouse'
    union all
    select
      'IDX-Stock' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'warehouse'
    union all
    select
      'IDX-Stock' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'warehouse'
  
[0m18:39:15.982953 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.0 seconds
[0m18:39:15.985471 [debug] [ThreadPool]: On list_IDX-Stock_warehouse: ROLLBACK
[0m18:39:15.989005 [debug] [ThreadPool]: On list_IDX-Stock_warehouse: Close
[0m18:39:15.992007 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_IDX-Stock_warehouse, now list_IDX-Stock_snapshots)
[0m18:39:16.001521 [debug] [ThreadPool]: Using postgres connection "list_IDX-Stock_snapshots"
[0m18:39:16.002528 [debug] [ThreadPool]: On list_IDX-Stock_snapshots: BEGIN
[0m18:39:16.003531 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:39:16.026156 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m18:39:16.027776 [debug] [ThreadPool]: Using postgres connection "list_IDX-Stock_snapshots"
[0m18:39:16.028685 [debug] [ThreadPool]: On list_IDX-Stock_snapshots: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "connection_name": "list_IDX-Stock_snapshots"} */
select
      'IDX-Stock' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'snapshots'
    union all
    select
      'IDX-Stock' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'snapshots'
    union all
    select
      'IDX-Stock' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'snapshots'
  
[0m18:39:16.033704 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.0 seconds
[0m18:39:16.035697 [debug] [ThreadPool]: On list_IDX-Stock_snapshots: ROLLBACK
[0m18:39:16.038210 [debug] [ThreadPool]: On list_IDX-Stock_snapshots: Close
[0m18:39:16.045750 [debug] [MainThread]: Using postgres connection "master"
[0m18:39:16.045750 [debug] [MainThread]: On master: BEGIN
[0m18:39:16.046751 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:39:16.071886 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m18:39:16.072887 [debug] [MainThread]: Using postgres connection "master"
[0m18:39:16.072887 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m18:39:16.081477 [debug] [MainThread]: SQL status: SELECT 6 in 0.0 seconds
[0m18:39:16.086521 [debug] [MainThread]: On master: ROLLBACK
[0m18:39:16.088052 [debug] [MainThread]: Using postgres connection "master"
[0m18:39:16.090067 [debug] [MainThread]: On master: BEGIN
[0m18:39:16.093064 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m18:39:16.094063 [debug] [MainThread]: On master: COMMIT
[0m18:39:16.095068 [debug] [MainThread]: Using postgres connection "master"
[0m18:39:16.096581 [debug] [MainThread]: On master: COMMIT
[0m18:39:16.098108 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m18:39:16.099123 [debug] [MainThread]: On master: Close
[0m18:39:16.101115 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:39:16.102126 [info ] [MainThread]: 
[0m18:39:16.107628 [debug] [Thread-1 (]: Began running node test.dbt_idx.accepted_values_customer_orders_status_order_status__delivered__invoiced__shipped__processing__canceled__unavailable.ea8c296d27
[0m18:39:16.109639 [info ] [Thread-1 (]: 1 of 9 START test accepted_values_customer_orders_status_order_status__delivered__invoiced__shipped__processing__canceled__unavailable  [RUN]
[0m18:39:16.110635 [debug] [Thread-1 (]: Acquiring new postgres connection 'test.dbt_idx.accepted_values_customer_orders_status_order_status__delivered__invoiced__shipped__processing__canceled__unavailable.ea8c296d27'
[0m18:39:16.111636 [debug] [Thread-1 (]: Began compiling node test.dbt_idx.accepted_values_customer_orders_status_order_status__delivered__invoiced__shipped__processing__canceled__unavailable.ea8c296d27
[0m18:39:16.136242 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_idx.accepted_values_customer_orders_status_order_status__delivered__invoiced__shipped__processing__canceled__unavailable.ea8c296d27"
[0m18:39:16.142797 [debug] [Thread-1 (]: Timing info for test.dbt_idx.accepted_values_customer_orders_status_order_status__delivered__invoiced__shipped__processing__canceled__unavailable.ea8c296d27 (compile): 18:39:16.112634 => 18:39:16.142797
[0m18:39:16.143768 [debug] [Thread-1 (]: Began executing node test.dbt_idx.accepted_values_customer_orders_status_order_status__delivered__invoiced__shipped__processing__canceled__unavailable.ea8c296d27
[0m18:39:16.163859 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_idx.accepted_values_customer_orders_status_order_status__delivered__invoiced__shipped__processing__canceled__unavailable.ea8c296d27"
[0m18:39:16.174079 [debug] [Thread-1 (]: Using postgres connection "test.dbt_idx.accepted_values_customer_orders_status_order_status__delivered__invoiced__shipped__processing__canceled__unavailable.ea8c296d27"
[0m18:39:16.175593 [debug] [Thread-1 (]: On test.dbt_idx.accepted_values_customer_orders_status_order_status__delivered__invoiced__shipped__processing__canceled__unavailable.ea8c296d27: BEGIN
[0m18:39:16.176595 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m18:39:16.199205 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m18:39:16.201203 [debug] [Thread-1 (]: Using postgres connection "test.dbt_idx.accepted_values_customer_orders_status_order_status__delivered__invoiced__shipped__processing__canceled__unavailable.ea8c296d27"
[0m18:39:16.201203 [debug] [Thread-1 (]: On test.dbt_idx.accepted_values_customer_orders_status_order_status__delivered__invoiced__shipped__processing__canceled__unavailable.ea8c296d27: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "test.dbt_idx.accepted_values_customer_orders_status_order_status__delivered__invoiced__shipped__processing__canceled__unavailable.ea8c296d27"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        order_status as value_field,
        count(*) as n_records

    from "IDX-Stock"."warehouse"."customer_orders_status"
    group by order_status

)

select *
from all_values
where value_field not in (
    'delivered','invoiced','shipped','processing','canceled','unavailable'
)



      
    ) dbt_internal_test
[0m18:39:16.206206 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m18:39:16.209245 [debug] [Thread-1 (]: Timing info for test.dbt_idx.accepted_values_customer_orders_status_order_status__delivered__invoiced__shipped__processing__canceled__unavailable.ea8c296d27 (execute): 18:39:16.144768 => 18:39:16.209245
[0m18:39:16.210283 [debug] [Thread-1 (]: On test.dbt_idx.accepted_values_customer_orders_status_order_status__delivered__invoiced__shipped__processing__canceled__unavailable.ea8c296d27: ROLLBACK
[0m18:39:16.212249 [debug] [Thread-1 (]: On test.dbt_idx.accepted_values_customer_orders_status_order_status__delivered__invoiced__shipped__processing__canceled__unavailable.ea8c296d27: Close
[0m18:39:16.214774 [info ] [Thread-1 (]: 1 of 9 PASS accepted_values_customer_orders_status_order_status__delivered__invoiced__shipped__processing__canceled__unavailable  [[32mPASS[0m in 0.10s]
[0m18:39:16.217775 [debug] [Thread-1 (]: Finished running node test.dbt_idx.accepted_values_customer_orders_status_order_status__delivered__invoiced__shipped__processing__canceled__unavailable.ea8c296d27
[0m18:39:16.220987 [debug] [Thread-1 (]: Began running node test.dbt_idx.assert_customer_dimension_has_no_row_loss.sql
[0m18:39:16.222989 [info ] [Thread-1 (]: 2 of 9 START test assert_customer_dimension_has_no_row_loss.sql ................ [RUN]
[0m18:39:16.224011 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_idx.accepted_values_customer_orders_status_order_status__delivered__invoiced__shipped__processing__canceled__unavailable.ea8c296d27, now test.dbt_idx.assert_customer_dimension_has_no_row_loss.sql)
[0m18:39:16.225531 [debug] [Thread-1 (]: Began compiling node test.dbt_idx.assert_customer_dimension_has_no_row_loss.sql
[0m18:39:16.230071 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_idx.assert_customer_dimension_has_no_row_loss.sql"
[0m18:39:16.238121 [debug] [Thread-1 (]: Timing info for test.dbt_idx.assert_customer_dimension_has_no_row_loss.sql (compile): 18:39:16.225531 => 18:39:16.237610
[0m18:39:16.239135 [debug] [Thread-1 (]: Began executing node test.dbt_idx.assert_customer_dimension_has_no_row_loss.sql
[0m18:39:16.242150 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_idx.assert_customer_dimension_has_no_row_loss.sql"
[0m18:39:16.250262 [debug] [Thread-1 (]: Using postgres connection "test.dbt_idx.assert_customer_dimension_has_no_row_loss.sql"
[0m18:39:16.251263 [debug] [Thread-1 (]: On test.dbt_idx.assert_customer_dimension_has_no_row_loss.sql: BEGIN
[0m18:39:16.252289 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:39:16.278427 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m18:39:16.279440 [debug] [Thread-1 (]: Using postgres connection "test.dbt_idx.assert_customer_dimension_has_no_row_loss.sql"
[0m18:39:16.281451 [debug] [Thread-1 (]: On test.dbt_idx.assert_customer_dimension_has_no_row_loss.sql: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "test.dbt_idx.assert_customer_dimension_has_no_row_loss.sql"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      -- dim_customers must have the same number of rows as its staging counterpart
-- Therefore return records where this isn't true to make the test fail
select *
from (
         select dim_cust.customer_id
         from "IDX-Stock"."warehouse"."dim_customers" dim_cust
            left join "IDX-Stock"."warehouse"."stg_eltool__customers" stg_cust on dim_cust.customer_id = stg_cust.customer_id
         where stg_cust.customer_id is null
         UNION ALL
         select stg_cust.customer_id
         from "IDX-Stock"."warehouse"."stg_eltool__customers" stg_cust
             left join "IDX-Stock"."warehouse"."dim_customers" dim_cust on stg_cust.customer_id = dim_cust.customer_id
         where dim_cust.customer_id is null
     ) tmp
      
    ) dbt_internal_test
[0m18:39:16.285995 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m18:39:16.288518 [debug] [Thread-1 (]: Timing info for test.dbt_idx.assert_customer_dimension_has_no_row_loss.sql (execute): 18:39:16.240151 => 18:39:16.288518
[0m18:39:16.290528 [debug] [Thread-1 (]: On test.dbt_idx.assert_customer_dimension_has_no_row_loss.sql: ROLLBACK
[0m18:39:16.293517 [debug] [Thread-1 (]: On test.dbt_idx.assert_customer_dimension_has_no_row_loss.sql: Close
[0m18:39:16.295564 [error] [Thread-1 (]: 2 of 9 FAIL 105 assert_customer_dimension_has_no_row_loss.sql .................. [[31mFAIL 105[0m in 0.07s]
[0m18:39:16.298802 [debug] [Thread-1 (]: Finished running node test.dbt_idx.assert_customer_dimension_has_no_row_loss.sql
[0m18:39:16.300864 [debug] [Thread-1 (]: Began running node test.dbt_idx.not_null_customer_orders_status_customer_id.3915c814eb
[0m18:39:16.301874 [info ] [Thread-1 (]: 3 of 9 START test not_null_customer_orders_status_customer_id .................. [RUN]
[0m18:39:16.304872 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_idx.assert_customer_dimension_has_no_row_loss.sql, now test.dbt_idx.not_null_customer_orders_status_customer_id.3915c814eb)
[0m18:39:16.305887 [debug] [Thread-1 (]: Began compiling node test.dbt_idx.not_null_customer_orders_status_customer_id.3915c814eb
[0m18:39:16.323173 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_idx.not_null_customer_orders_status_customer_id.3915c814eb"
[0m18:39:16.333715 [debug] [Thread-1 (]: Timing info for test.dbt_idx.not_null_customer_orders_status_customer_id.3915c814eb (compile): 18:39:16.306872 => 18:39:16.333715
[0m18:39:16.335230 [debug] [Thread-1 (]: Began executing node test.dbt_idx.not_null_customer_orders_status_customer_id.3915c814eb
[0m18:39:16.341352 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_idx.not_null_customer_orders_status_customer_id.3915c814eb"
[0m18:39:16.350889 [debug] [Thread-1 (]: Using postgres connection "test.dbt_idx.not_null_customer_orders_status_customer_id.3915c814eb"
[0m18:39:16.351894 [debug] [Thread-1 (]: On test.dbt_idx.not_null_customer_orders_status_customer_id.3915c814eb: BEGIN
[0m18:39:16.353409 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:39:16.379193 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m18:39:16.380690 [debug] [Thread-1 (]: Using postgres connection "test.dbt_idx.not_null_customer_orders_status_customer_id.3915c814eb"
[0m18:39:16.381710 [debug] [Thread-1 (]: On test.dbt_idx.not_null_customer_orders_status_customer_id.3915c814eb: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "test.dbt_idx.not_null_customer_orders_status_customer_id.3915c814eb"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select customer_id
from "IDX-Stock"."warehouse"."customer_orders_status"
where customer_id is null



      
    ) dbt_internal_test
[0m18:39:16.385708 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m18:39:16.389253 [debug] [Thread-1 (]: Timing info for test.dbt_idx.not_null_customer_orders_status_customer_id.3915c814eb (execute): 18:39:16.336240 => 18:39:16.389253
[0m18:39:16.390272 [debug] [Thread-1 (]: On test.dbt_idx.not_null_customer_orders_status_customer_id.3915c814eb: ROLLBACK
[0m18:39:16.392833 [debug] [Thread-1 (]: On test.dbt_idx.not_null_customer_orders_status_customer_id.3915c814eb: Close
[0m18:39:16.395350 [info ] [Thread-1 (]: 3 of 9 PASS not_null_customer_orders_status_customer_id ........................ [[32mPASS[0m in 0.09s]
[0m18:39:16.397887 [debug] [Thread-1 (]: Finished running node test.dbt_idx.not_null_customer_orders_status_customer_id.3915c814eb
[0m18:39:16.399934 [debug] [Thread-1 (]: Began running node test.dbt_idx.not_null_stg_eltool__customers_snapshots_customer_id.ea4fc4ca86
[0m18:39:16.401917 [info ] [Thread-1 (]: 4 of 9 START test not_null_stg_eltool__customers_snapshots_customer_id ......... [RUN]
[0m18:39:16.404917 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_idx.not_null_customer_orders_status_customer_id.3915c814eb, now test.dbt_idx.not_null_stg_eltool__customers_snapshots_customer_id.ea4fc4ca86)
[0m18:39:16.406918 [debug] [Thread-1 (]: Began compiling node test.dbt_idx.not_null_stg_eltool__customers_snapshots_customer_id.ea4fc4ca86
[0m18:39:16.413212 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_idx.not_null_stg_eltool__customers_snapshots_customer_id.ea4fc4ca86"
[0m18:39:16.422222 [debug] [Thread-1 (]: Timing info for test.dbt_idx.not_null_stg_eltool__customers_snapshots_customer_id.ea4fc4ca86 (compile): 18:39:16.408201 => 18:39:16.421218
[0m18:39:16.424222 [debug] [Thread-1 (]: Began executing node test.dbt_idx.not_null_stg_eltool__customers_snapshots_customer_id.ea4fc4ca86
[0m18:39:16.435328 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_idx.not_null_stg_eltool__customers_snapshots_customer_id.ea4fc4ca86"
[0m18:39:16.446889 [debug] [Thread-1 (]: Using postgres connection "test.dbt_idx.not_null_stg_eltool__customers_snapshots_customer_id.ea4fc4ca86"
[0m18:39:16.447902 [debug] [Thread-1 (]: On test.dbt_idx.not_null_stg_eltool__customers_snapshots_customer_id.ea4fc4ca86: BEGIN
[0m18:39:16.450440 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:39:16.478798 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m18:39:16.480815 [debug] [Thread-1 (]: Using postgres connection "test.dbt_idx.not_null_stg_eltool__customers_snapshots_customer_id.ea4fc4ca86"
[0m18:39:16.481814 [debug] [Thread-1 (]: On test.dbt_idx.not_null_stg_eltool__customers_snapshots_customer_id.ea4fc4ca86: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "test.dbt_idx.not_null_stg_eltool__customers_snapshots_customer_id.ea4fc4ca86"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select customer_id
from "IDX-Stock"."warehouse"."stg_eltool__customers_snapshots"
where customer_id is null



      
    ) dbt_internal_test
[0m18:39:16.485811 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m18:39:16.488327 [debug] [Thread-1 (]: Timing info for test.dbt_idx.not_null_stg_eltool__customers_snapshots_customer_id.ea4fc4ca86 (execute): 18:39:16.425760 => 18:39:16.488327
[0m18:39:16.490351 [debug] [Thread-1 (]: On test.dbt_idx.not_null_stg_eltool__customers_snapshots_customer_id.ea4fc4ca86: ROLLBACK
[0m18:39:16.492354 [debug] [Thread-1 (]: On test.dbt_idx.not_null_stg_eltool__customers_snapshots_customer_id.ea4fc4ca86: Close
[0m18:39:16.495577 [info ] [Thread-1 (]: 4 of 9 PASS not_null_stg_eltool__customers_snapshots_customer_id ............... [[32mPASS[0m in 0.09s]
[0m18:39:16.498084 [debug] [Thread-1 (]: Finished running node test.dbt_idx.not_null_stg_eltool__customers_snapshots_customer_id.ea4fc4ca86
[0m18:39:16.499097 [debug] [Thread-1 (]: Began running node test.dbt_idx.source_not_null_warehouse_customers_customer_id.ae7452c4c6
[0m18:39:16.501118 [info ] [Thread-1 (]: 5 of 9 START test source_not_null_warehouse_customers_customer_id .............. [RUN]
[0m18:39:16.502108 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_idx.not_null_stg_eltool__customers_snapshots_customer_id.ea4fc4ca86, now test.dbt_idx.source_not_null_warehouse_customers_customer_id.ae7452c4c6)
[0m18:39:16.503621 [debug] [Thread-1 (]: Began compiling node test.dbt_idx.source_not_null_warehouse_customers_customer_id.ae7452c4c6
[0m18:39:16.513232 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_idx.source_not_null_warehouse_customers_customer_id.ae7452c4c6"
[0m18:39:16.522423 [debug] [Thread-1 (]: Timing info for test.dbt_idx.source_not_null_warehouse_customers_customer_id.ae7452c4c6 (compile): 18:39:16.505146 => 18:39:16.520909
[0m18:39:16.523441 [debug] [Thread-1 (]: Began executing node test.dbt_idx.source_not_null_warehouse_customers_customer_id.ae7452c4c6
[0m18:39:16.527468 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_idx.source_not_null_warehouse_customers_customer_id.ae7452c4c6"
[0m18:39:16.536052 [debug] [Thread-1 (]: Using postgres connection "test.dbt_idx.source_not_null_warehouse_customers_customer_id.ae7452c4c6"
[0m18:39:16.538962 [debug] [Thread-1 (]: On test.dbt_idx.source_not_null_warehouse_customers_customer_id.ae7452c4c6: BEGIN
[0m18:39:16.541498 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:39:16.565421 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m18:39:16.566437 [debug] [Thread-1 (]: Using postgres connection "test.dbt_idx.source_not_null_warehouse_customers_customer_id.ae7452c4c6"
[0m18:39:16.568966 [debug] [Thread-1 (]: On test.dbt_idx.source_not_null_warehouse_customers_customer_id.ae7452c4c6: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "test.dbt_idx.source_not_null_warehouse_customers_customer_id.ae7452c4c6"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select customer_id
from "IDX-Stock"."warehouse"."customers"
where customer_id is null



      
    ) dbt_internal_test
[0m18:39:16.571487 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m18:39:16.574501 [debug] [Thread-1 (]: Timing info for test.dbt_idx.source_not_null_warehouse_customers_customer_id.ae7452c4c6 (execute): 18:39:16.523441 => 18:39:16.574501
[0m18:39:16.575503 [debug] [Thread-1 (]: On test.dbt_idx.source_not_null_warehouse_customers_customer_id.ae7452c4c6: ROLLBACK
[0m18:39:16.578010 [debug] [Thread-1 (]: On test.dbt_idx.source_not_null_warehouse_customers_customer_id.ae7452c4c6: Close
[0m18:39:16.579533 [info ] [Thread-1 (]: 5 of 9 PASS source_not_null_warehouse_customers_customer_id .................... [[32mPASS[0m in 0.08s]
[0m18:39:16.583065 [debug] [Thread-1 (]: Finished running node test.dbt_idx.source_not_null_warehouse_customers_customer_id.ae7452c4c6
[0m18:39:16.584064 [debug] [Thread-1 (]: Began running node test.dbt_idx.source_not_null_warehouse_orders_order_id.c85a1f0b76
[0m18:39:16.585181 [info ] [Thread-1 (]: 6 of 9 START test source_not_null_warehouse_orders_order_id .................... [RUN]
[0m18:39:16.586186 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_idx.source_not_null_warehouse_customers_customer_id.ae7452c4c6, now test.dbt_idx.source_not_null_warehouse_orders_order_id.c85a1f0b76)
[0m18:39:16.587695 [debug] [Thread-1 (]: Began compiling node test.dbt_idx.source_not_null_warehouse_orders_order_id.c85a1f0b76
[0m18:39:16.599256 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_idx.source_not_null_warehouse_orders_order_id.c85a1f0b76"
[0m18:39:16.607814 [debug] [Thread-1 (]: Timing info for test.dbt_idx.source_not_null_warehouse_orders_order_id.c85a1f0b76 (compile): 18:39:16.588705 => 18:39:16.606815
[0m18:39:16.608328 [debug] [Thread-1 (]: Began executing node test.dbt_idx.source_not_null_warehouse_orders_order_id.c85a1f0b76
[0m18:39:16.613879 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_idx.source_not_null_warehouse_orders_order_id.c85a1f0b76"
[0m18:39:16.623996 [debug] [Thread-1 (]: Using postgres connection "test.dbt_idx.source_not_null_warehouse_orders_order_id.c85a1f0b76"
[0m18:39:16.625008 [debug] [Thread-1 (]: On test.dbt_idx.source_not_null_warehouse_orders_order_id.c85a1f0b76: BEGIN
[0m18:39:16.626006 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:39:16.647967 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m18:39:16.648893 [debug] [Thread-1 (]: Using postgres connection "test.dbt_idx.source_not_null_warehouse_orders_order_id.c85a1f0b76"
[0m18:39:16.649909 [debug] [Thread-1 (]: On test.dbt_idx.source_not_null_warehouse_orders_order_id.c85a1f0b76: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "test.dbt_idx.source_not_null_warehouse_orders_order_id.c85a1f0b76"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select order_id
from "IDX-Stock"."warehouse"."orders"
where order_id is null



      
    ) dbt_internal_test
[0m18:39:16.653906 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m18:39:16.656433 [debug] [Thread-1 (]: Timing info for test.dbt_idx.source_not_null_warehouse_orders_order_id.c85a1f0b76 (execute): 18:39:16.609345 => 18:39:16.654906
[0m18:39:16.657455 [debug] [Thread-1 (]: On test.dbt_idx.source_not_null_warehouse_orders_order_id.c85a1f0b76: ROLLBACK
[0m18:39:16.659470 [debug] [Thread-1 (]: On test.dbt_idx.source_not_null_warehouse_orders_order_id.c85a1f0b76: Close
[0m18:39:16.661992 [info ] [Thread-1 (]: 6 of 9 PASS source_not_null_warehouse_orders_order_id .......................... [[32mPASS[0m in 0.07s]
[0m18:39:16.664006 [debug] [Thread-1 (]: Finished running node test.dbt_idx.source_not_null_warehouse_orders_order_id.c85a1f0b76
[0m18:39:16.666536 [debug] [Thread-1 (]: Began running node test.dbt_idx.source_relationships_warehouse_orders_cust_id__customer_id__source_warehouse_customers_.d3f9188fc2
[0m18:39:16.668051 [info ] [Thread-1 (]: 7 of 9 START test source_relationships_warehouse_orders_cust_id__customer_id__source_warehouse_customers_  [RUN]
[0m18:39:16.670094 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_idx.source_not_null_warehouse_orders_order_id.c85a1f0b76, now test.dbt_idx.source_relationships_warehouse_orders_cust_id__customer_id__source_warehouse_customers_.d3f9188fc2)
[0m18:39:16.671101 [debug] [Thread-1 (]: Began compiling node test.dbt_idx.source_relationships_warehouse_orders_cust_id__customer_id__source_warehouse_customers_.d3f9188fc2
[0m18:39:16.682658 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_idx.source_relationships_warehouse_orders_cust_id__customer_id__source_warehouse_customers_.d3f9188fc2"
[0m18:39:16.689147 [debug] [Thread-1 (]: Timing info for test.dbt_idx.source_relationships_warehouse_orders_cust_id__customer_id__source_warehouse_customers_.d3f9188fc2 (compile): 18:39:16.672100 => 18:39:16.689147
[0m18:39:16.691136 [debug] [Thread-1 (]: Began executing node test.dbt_idx.source_relationships_warehouse_orders_cust_id__customer_id__source_warehouse_customers_.d3f9188fc2
[0m18:39:16.699677 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_idx.source_relationships_warehouse_orders_cust_id__customer_id__source_warehouse_customers_.d3f9188fc2"
[0m18:39:16.706688 [debug] [Thread-1 (]: Using postgres connection "test.dbt_idx.source_relationships_warehouse_orders_cust_id__customer_id__source_warehouse_customers_.d3f9188fc2"
[0m18:39:16.708209 [debug] [Thread-1 (]: On test.dbt_idx.source_relationships_warehouse_orders_cust_id__customer_id__source_warehouse_customers_.d3f9188fc2: BEGIN
[0m18:39:16.708209 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:39:16.730328 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m18:39:16.731850 [debug] [Thread-1 (]: Using postgres connection "test.dbt_idx.source_relationships_warehouse_orders_cust_id__customer_id__source_warehouse_customers_.d3f9188fc2"
[0m18:39:16.731850 [debug] [Thread-1 (]: On test.dbt_idx.source_relationships_warehouse_orders_cust_id__customer_id__source_warehouse_customers_.d3f9188fc2: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "test.dbt_idx.source_relationships_warehouse_orders_cust_id__customer_id__source_warehouse_customers_.d3f9188fc2"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select cust_id as from_field
    from "IDX-Stock"."warehouse"."orders"
    where cust_id is not null
),

parent as (
    select customer_id as to_field
    from "IDX-Stock"."warehouse"."customers"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m18:39:16.736391 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m18:39:16.738930 [debug] [Thread-1 (]: Timing info for test.dbt_idx.source_relationships_warehouse_orders_cust_id__customer_id__source_warehouse_customers_.d3f9188fc2 (execute): 18:39:16.692131 => 18:39:16.737959
[0m18:39:16.739940 [debug] [Thread-1 (]: On test.dbt_idx.source_relationships_warehouse_orders_cust_id__customer_id__source_warehouse_customers_.d3f9188fc2: ROLLBACK
[0m18:39:16.741957 [debug] [Thread-1 (]: On test.dbt_idx.source_relationships_warehouse_orders_cust_id__customer_id__source_warehouse_customers_.d3f9188fc2: Close
[0m18:39:16.743948 [info ] [Thread-1 (]: 7 of 9 PASS source_relationships_warehouse_orders_cust_id__customer_id__source_warehouse_customers_  [[32mPASS[0m in 0.07s]
[0m18:39:16.746944 [debug] [Thread-1 (]: Finished running node test.dbt_idx.source_relationships_warehouse_orders_cust_id__customer_id__source_warehouse_customers_.d3f9188fc2
[0m18:39:16.748458 [debug] [Thread-1 (]: Began running node test.dbt_idx.source_unique_warehouse_orders_order_id.839fb43d0f
[0m18:39:16.750483 [info ] [Thread-1 (]: 8 of 9 START test source_unique_warehouse_orders_order_id ...................... [RUN]
[0m18:39:16.751507 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_idx.source_relationships_warehouse_orders_cust_id__customer_id__source_warehouse_customers_.d3f9188fc2, now test.dbt_idx.source_unique_warehouse_orders_order_id.839fb43d0f)
[0m18:39:16.752479 [debug] [Thread-1 (]: Began compiling node test.dbt_idx.source_unique_warehouse_orders_order_id.839fb43d0f
[0m18:39:16.760508 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_idx.source_unique_warehouse_orders_order_id.839fb43d0f"
[0m18:39:16.768093 [debug] [Thread-1 (]: Timing info for test.dbt_idx.source_unique_warehouse_orders_order_id.839fb43d0f (compile): 18:39:16.753478 => 18:39:16.768093
[0m18:39:16.769108 [debug] [Thread-1 (]: Began executing node test.dbt_idx.source_unique_warehouse_orders_order_id.839fb43d0f
[0m18:39:16.772120 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_idx.source_unique_warehouse_orders_order_id.839fb43d0f"
[0m18:39:16.780189 [debug] [Thread-1 (]: Using postgres connection "test.dbt_idx.source_unique_warehouse_orders_order_id.839fb43d0f"
[0m18:39:16.781827 [debug] [Thread-1 (]: On test.dbt_idx.source_unique_warehouse_orders_order_id.839fb43d0f: BEGIN
[0m18:39:16.782752 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:39:16.808419 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m18:39:16.809934 [debug] [Thread-1 (]: Using postgres connection "test.dbt_idx.source_unique_warehouse_orders_order_id.839fb43d0f"
[0m18:39:16.811967 [debug] [Thread-1 (]: On test.dbt_idx.source_unique_warehouse_orders_order_id.839fb43d0f: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "test.dbt_idx.source_unique_warehouse_orders_order_id.839fb43d0f"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    order_id as unique_field,
    count(*) as n_records

from "IDX-Stock"."warehouse"."orders"
where order_id is not null
group by order_id
having count(*) > 1



      
    ) dbt_internal_test
[0m18:39:16.817546 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m18:39:16.819485 [debug] [Thread-1 (]: Timing info for test.dbt_idx.source_unique_warehouse_orders_order_id.839fb43d0f (execute): 18:39:16.770123 => 18:39:16.819485
[0m18:39:16.820483 [debug] [Thread-1 (]: On test.dbt_idx.source_unique_warehouse_orders_order_id.839fb43d0f: ROLLBACK
[0m18:39:16.823487 [debug] [Thread-1 (]: On test.dbt_idx.source_unique_warehouse_orders_order_id.839fb43d0f: Close
[0m18:39:16.826488 [info ] [Thread-1 (]: 8 of 9 PASS source_unique_warehouse_orders_order_id ............................ [[32mPASS[0m in 0.07s]
[0m18:39:16.828006 [debug] [Thread-1 (]: Finished running node test.dbt_idx.source_unique_warehouse_orders_order_id.839fb43d0f
[0m18:39:16.830014 [debug] [Thread-1 (]: Began running node test.dbt_idx.unique_customer_orders_status_order_id.b7a45e83ee
[0m18:39:16.831542 [info ] [Thread-1 (]: 9 of 9 START test unique_customer_orders_status_order_id ....................... [RUN]
[0m18:39:16.833550 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_idx.source_unique_warehouse_orders_order_id.839fb43d0f, now test.dbt_idx.unique_customer_orders_status_order_id.b7a45e83ee)
[0m18:39:16.834549 [debug] [Thread-1 (]: Began compiling node test.dbt_idx.unique_customer_orders_status_order_id.b7a45e83ee
[0m18:39:16.842097 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_idx.unique_customer_orders_status_order_id.b7a45e83ee"
[0m18:39:16.851080 [debug] [Thread-1 (]: Timing info for test.dbt_idx.unique_customer_orders_status_order_id.b7a45e83ee (compile): 18:39:16.834549 => 18:39:16.850083
[0m18:39:16.852096 [debug] [Thread-1 (]: Began executing node test.dbt_idx.unique_customer_orders_status_order_id.b7a45e83ee
[0m18:39:16.855605 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_idx.unique_customer_orders_status_order_id.b7a45e83ee"
[0m18:39:16.864147 [debug] [Thread-1 (]: Using postgres connection "test.dbt_idx.unique_customer_orders_status_order_id.b7a45e83ee"
[0m18:39:16.866667 [debug] [Thread-1 (]: On test.dbt_idx.unique_customer_orders_status_order_id.b7a45e83ee: BEGIN
[0m18:39:16.867672 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:39:16.897928 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m18:39:16.899822 [debug] [Thread-1 (]: Using postgres connection "test.dbt_idx.unique_customer_orders_status_order_id.b7a45e83ee"
[0m18:39:16.900827 [debug] [Thread-1 (]: On test.dbt_idx.unique_customer_orders_status_order_id.b7a45e83ee: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "test.dbt_idx.unique_customer_orders_status_order_id.b7a45e83ee"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    order_id as unique_field,
    count(*) as n_records

from "IDX-Stock"."warehouse"."customer_orders_status"
where order_id is not null
group by order_id
having count(*) > 1



      
    ) dbt_internal_test
[0m18:39:16.906808 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m18:39:16.910990 [debug] [Thread-1 (]: Timing info for test.dbt_idx.unique_customer_orders_status_order_id.b7a45e83ee (execute): 18:39:16.852096 => 18:39:16.909981
[0m18:39:16.912005 [debug] [Thread-1 (]: On test.dbt_idx.unique_customer_orders_status_order_id.b7a45e83ee: ROLLBACK
[0m18:39:16.914580 [debug] [Thread-1 (]: On test.dbt_idx.unique_customer_orders_status_order_id.b7a45e83ee: Close
[0m18:39:16.917446 [info ] [Thread-1 (]: 9 of 9 PASS unique_customer_orders_status_order_id ............................. [[32mPASS[0m in 0.08s]
[0m18:39:16.920256 [debug] [Thread-1 (]: Finished running node test.dbt_idx.unique_customer_orders_status_order_id.b7a45e83ee
[0m18:39:16.924845 [debug] [MainThread]: Using postgres connection "master"
[0m18:39:16.926439 [debug] [MainThread]: On master: BEGIN
[0m18:39:16.926439 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:39:16.955788 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m18:39:16.956785 [debug] [MainThread]: On master: COMMIT
[0m18:39:16.958306 [debug] [MainThread]: Using postgres connection "master"
[0m18:39:16.958306 [debug] [MainThread]: On master: COMMIT
[0m18:39:16.961322 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m18:39:16.962340 [debug] [MainThread]: On master: Close
[0m18:39:16.963327 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:39:16.966378 [debug] [MainThread]: Connection 'list_IDX-Stock_snapshots' was properly closed.
[0m18:39:16.967954 [debug] [MainThread]: Connection 'test.dbt_idx.unique_customer_orders_status_order_id.b7a45e83ee' was properly closed.
[0m18:39:16.969662 [info ] [MainThread]: 
[0m18:39:16.971171 [info ] [MainThread]: Finished running 9 tests in 0 hours 0 minutes and 1.07 seconds (1.07s).
[0m18:39:16.975214 [debug] [MainThread]: Command end result
[0m18:39:17.000228 [info ] [MainThread]: 
[0m18:39:17.002741 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m18:39:17.004755 [info ] [MainThread]: 
[0m18:39:17.006781 [error] [MainThread]: [31mFailure in test assert_customer_dimension_has_no_row_loss.sql (tests\assert_customer_dimension_has_no_row_loss.sql.sql)[0m
[0m18:39:17.008281 [error] [MainThread]:   Got 105 results, configured to fail if != 0
[0m18:39:17.010296 [info ] [MainThread]: 
[0m18:39:17.011314 [info ] [MainThread]:   compiled Code at target\compiled\dbt_idx\tests\assert_customer_dimension_has_no_row_loss.sql.sql
[0m18:39:17.013849 [info ] [MainThread]: 
[0m18:39:17.016395 [info ] [MainThread]: Done. PASS=8 WARN=0 ERROR=1 SKIP=0 TOTAL=9
[0m18:39:17.018491 [debug] [MainThread]: Command `dbt test` failed at 18:39:17.018491 after 1.72 seconds
[0m18:39:17.019500 [debug] [MainThread]: Flushing usage events


============================== 22:35:10.035109 | c16dbe10-b0ee-47a0-ab98-2a88941d0aaf ==============================
[0m22:35:10.035109 [info ] [MainThread]: Running with dbt=1.6.1
[0m22:35:10.040108 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': 'D:\\00 Project\\00 My Project\\IdeaProjects\\Py-DBT-IDX', 'log_path': 'D:\\00 Project\\00 My Project\\IdeaProjects\\Py-DBT-IDX\\logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt docs generate', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'False'}
[0m22:35:10.164213 [info ] [MainThread]: Registered adapter: postgres=1.6.1
[0m22:35:10.175589 [debug] [MainThread]: checksum: efe19d9f5b93d1a98cc804fbfcdb6b3aced98b974af664946fee1cde8837deb7, vars: {}, profile: , target: , version: 1.6.1
[0m22:35:10.356091 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m22:35:10.357601 [debug] [MainThread]: Partial parsing: updated file: dbt_idx://tests\assert_customer_dimension_has_no_row_loss.sql.sql
[0m22:35:10.425147 [info ] [MainThread]: Found 1 snapshot, 9 tests, 7 models, 3 sources, 0 exposures, 0 metrics, 349 macros, 0 groups, 0 semantic models
[0m22:35:10.429147 [info ] [MainThread]: 
[0m22:35:10.431145 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m22:35:10.434148 [debug] [ThreadPool]: Acquiring new postgres connection 'list_IDX-Stock_warehouse'
[0m22:35:10.448679 [debug] [ThreadPool]: Using postgres connection "list_IDX-Stock_warehouse"
[0m22:35:10.450675 [debug] [ThreadPool]: On list_IDX-Stock_warehouse: BEGIN
[0m22:35:10.451678 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:35:10.491200 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m22:35:10.493195 [debug] [ThreadPool]: Using postgres connection "list_IDX-Stock_warehouse"
[0m22:35:10.494195 [debug] [ThreadPool]: On list_IDX-Stock_warehouse: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "connection_name": "list_IDX-Stock_warehouse"} */
select
      'IDX-Stock' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'warehouse'
    union all
    select
      'IDX-Stock' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'warehouse'
    union all
    select
      'IDX-Stock' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'warehouse'
  
[0m22:35:10.499170 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.0 seconds
[0m22:35:10.501168 [debug] [ThreadPool]: On list_IDX-Stock_warehouse: ROLLBACK
[0m22:35:10.504173 [debug] [ThreadPool]: On list_IDX-Stock_warehouse: Close
[0m22:35:10.506176 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_IDX-Stock_warehouse, now list_IDX-Stock_snapshots)
[0m22:35:10.514713 [debug] [ThreadPool]: Using postgres connection "list_IDX-Stock_snapshots"
[0m22:35:10.516713 [debug] [ThreadPool]: On list_IDX-Stock_snapshots: BEGIN
[0m22:35:10.516713 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:35:10.541714 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m22:35:10.542727 [debug] [ThreadPool]: Using postgres connection "list_IDX-Stock_snapshots"
[0m22:35:10.543738 [debug] [ThreadPool]: On list_IDX-Stock_snapshots: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "connection_name": "list_IDX-Stock_snapshots"} */
select
      'IDX-Stock' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'snapshots'
    union all
    select
      'IDX-Stock' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'snapshots'
    union all
    select
      'IDX-Stock' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'snapshots'
  
[0m22:35:10.552724 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.0 seconds
[0m22:35:10.555709 [debug] [ThreadPool]: On list_IDX-Stock_snapshots: ROLLBACK
[0m22:35:10.558714 [debug] [ThreadPool]: On list_IDX-Stock_snapshots: Close
[0m22:35:10.568715 [debug] [MainThread]: Using postgres connection "master"
[0m22:35:10.569741 [debug] [MainThread]: On master: BEGIN
[0m22:35:10.570740 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:35:10.596179 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m22:35:10.597160 [debug] [MainThread]: Using postgres connection "master"
[0m22:35:10.598207 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m22:35:10.607173 [debug] [MainThread]: SQL status: SELECT 6 in 0.0 seconds
[0m22:35:10.611159 [debug] [MainThread]: On master: ROLLBACK
[0m22:35:10.614172 [debug] [MainThread]: On master: Close
[0m22:35:10.616176 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m22:35:10.618067 [info ] [MainThread]: 
[0m22:35:10.623617 [debug] [Thread-1 (]: Began running node model.dbt_idx.stg_eltool__customers
[0m22:35:10.625596 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.dbt_idx.stg_eltool__customers'
[0m22:35:10.627609 [debug] [Thread-1 (]: Began compiling node model.dbt_idx.stg_eltool__customers
[0m22:35:10.640612 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_idx.stg_eltool__customers"
[0m22:35:10.648595 [debug] [Thread-1 (]: Timing info for model.dbt_idx.stg_eltool__customers (compile): 22:35:10.628597 => 22:35:10.648595
[0m22:35:10.649594 [debug] [Thread-1 (]: Began executing node model.dbt_idx.stg_eltool__customers
[0m22:35:10.650608 [debug] [Thread-1 (]: Timing info for model.dbt_idx.stg_eltool__customers (execute): 22:35:10.650608 => 22:35:10.650608
[0m22:35:10.652595 [debug] [Thread-1 (]: Finished running node model.dbt_idx.stg_eltool__customers
[0m22:35:10.653608 [debug] [Thread-1 (]: Began running node model.dbt_idx.stg_eltool__orders
[0m22:35:10.654616 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_idx.stg_eltool__customers, now model.dbt_idx.stg_eltool__orders)
[0m22:35:10.655593 [debug] [Thread-1 (]: Began compiling node model.dbt_idx.stg_eltool__orders
[0m22:35:10.658594 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_idx.stg_eltool__orders"
[0m22:35:10.669102 [debug] [Thread-1 (]: Timing info for model.dbt_idx.stg_eltool__orders (compile): 22:35:10.656623 => 22:35:10.669102
[0m22:35:10.670118 [debug] [Thread-1 (]: Began executing node model.dbt_idx.stg_eltool__orders
[0m22:35:10.671131 [debug] [Thread-1 (]: Timing info for model.dbt_idx.stg_eltool__orders (execute): 22:35:10.671131 => 22:35:10.671131
[0m22:35:10.673107 [debug] [Thread-1 (]: Finished running node model.dbt_idx.stg_eltool__orders
[0m22:35:10.674098 [debug] [Thread-1 (]: Began running node model.dbt_idx.stg_eltool__state
[0m22:35:10.675096 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_idx.stg_eltool__orders, now model.dbt_idx.stg_eltool__state)
[0m22:35:10.675096 [debug] [Thread-1 (]: Began compiling node model.dbt_idx.stg_eltool__state
[0m22:35:10.679133 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_idx.stg_eltool__state"
[0m22:35:10.685618 [debug] [Thread-1 (]: Timing info for model.dbt_idx.stg_eltool__state (compile): 22:35:10.676133 => 22:35:10.684665
[0m22:35:10.685618 [debug] [Thread-1 (]: Began executing node model.dbt_idx.stg_eltool__state
[0m22:35:10.686657 [debug] [Thread-1 (]: Timing info for model.dbt_idx.stg_eltool__state (execute): 22:35:10.686657 => 22:35:10.686657
[0m22:35:10.687652 [debug] [Thread-1 (]: Finished running node model.dbt_idx.stg_eltool__state
[0m22:35:10.688651 [debug] [Thread-1 (]: Began running node snapshot.dbt_idx.customers_snapshot
[0m22:35:10.689624 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_idx.stg_eltool__state, now snapshot.dbt_idx.customers_snapshot)
[0m22:35:10.690617 [debug] [Thread-1 (]: Began compiling node snapshot.dbt_idx.customers_snapshot
[0m22:35:10.693650 [debug] [Thread-1 (]: Timing info for snapshot.dbt_idx.customers_snapshot (compile): 22:35:10.691617 => 22:35:10.693650
[0m22:35:10.694651 [debug] [Thread-1 (]: Began executing node snapshot.dbt_idx.customers_snapshot
[0m22:35:10.695619 [debug] [Thread-1 (]: Timing info for snapshot.dbt_idx.customers_snapshot (execute): 22:35:10.695619 => 22:35:10.695619
[0m22:35:10.696650 [debug] [Thread-1 (]: Finished running node snapshot.dbt_idx.customers_snapshot
[0m22:35:10.697617 [debug] [Thread-1 (]: Began running node test.dbt_idx.source_not_null_warehouse_customers_customer_id.ae7452c4c6
[0m22:35:10.698650 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly snapshot.dbt_idx.customers_snapshot, now test.dbt_idx.source_not_null_warehouse_customers_customer_id.ae7452c4c6)
[0m22:35:10.698650 [debug] [Thread-1 (]: Began compiling node test.dbt_idx.source_not_null_warehouse_customers_customer_id.ae7452c4c6
[0m22:35:10.710618 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_idx.source_not_null_warehouse_customers_customer_id.ae7452c4c6"
[0m22:35:10.717617 [debug] [Thread-1 (]: Timing info for test.dbt_idx.source_not_null_warehouse_customers_customer_id.ae7452c4c6 (compile): 22:35:10.699653 => 22:35:10.716662
[0m22:35:10.717617 [debug] [Thread-1 (]: Began executing node test.dbt_idx.source_not_null_warehouse_customers_customer_id.ae7452c4c6
[0m22:35:10.718642 [debug] [Thread-1 (]: Timing info for test.dbt_idx.source_not_null_warehouse_customers_customer_id.ae7452c4c6 (execute): 22:35:10.718642 => 22:35:10.718642
[0m22:35:10.720618 [debug] [Thread-1 (]: Finished running node test.dbt_idx.source_not_null_warehouse_customers_customer_id.ae7452c4c6
[0m22:35:10.721620 [debug] [Thread-1 (]: Began running node test.dbt_idx.source_not_null_warehouse_orders_order_id.c85a1f0b76
[0m22:35:10.722657 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_idx.source_not_null_warehouse_customers_customer_id.ae7452c4c6, now test.dbt_idx.source_not_null_warehouse_orders_order_id.c85a1f0b76)
[0m22:35:10.722657 [debug] [Thread-1 (]: Began compiling node test.dbt_idx.source_not_null_warehouse_orders_order_id.c85a1f0b76
[0m22:35:10.727642 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_idx.source_not_null_warehouse_orders_order_id.c85a1f0b76"
[0m22:35:10.734642 [debug] [Thread-1 (]: Timing info for test.dbt_idx.source_not_null_warehouse_orders_order_id.c85a1f0b76 (compile): 22:35:10.723644 => 22:35:10.733616
[0m22:35:10.734642 [debug] [Thread-1 (]: Began executing node test.dbt_idx.source_not_null_warehouse_orders_order_id.c85a1f0b76
[0m22:35:10.735644 [debug] [Thread-1 (]: Timing info for test.dbt_idx.source_not_null_warehouse_orders_order_id.c85a1f0b76 (execute): 22:35:10.735644 => 22:35:10.735644
[0m22:35:10.736619 [debug] [Thread-1 (]: Finished running node test.dbt_idx.source_not_null_warehouse_orders_order_id.c85a1f0b76
[0m22:35:10.737641 [debug] [Thread-1 (]: Began running node test.dbt_idx.source_relationships_warehouse_orders_cust_id__customer_id__source_warehouse_customers_.d3f9188fc2
[0m22:35:10.738621 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_idx.source_not_null_warehouse_orders_order_id.c85a1f0b76, now test.dbt_idx.source_relationships_warehouse_orders_cust_id__customer_id__source_warehouse_customers_.d3f9188fc2)
[0m22:35:10.739616 [debug] [Thread-1 (]: Began compiling node test.dbt_idx.source_relationships_warehouse_orders_cust_id__customer_id__source_warehouse_customers_.d3f9188fc2
[0m22:35:10.747653 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_idx.source_relationships_warehouse_orders_cust_id__customer_id__source_warehouse_customers_.d3f9188fc2"
[0m22:35:10.754688 [debug] [Thread-1 (]: Timing info for test.dbt_idx.source_relationships_warehouse_orders_cust_id__customer_id__source_warehouse_customers_.d3f9188fc2 (compile): 22:35:10.739616 => 22:35:10.753698
[0m22:35:10.754688 [debug] [Thread-1 (]: Began executing node test.dbt_idx.source_relationships_warehouse_orders_cust_id__customer_id__source_warehouse_customers_.d3f9188fc2
[0m22:35:10.755687 [debug] [Thread-1 (]: Timing info for test.dbt_idx.source_relationships_warehouse_orders_cust_id__customer_id__source_warehouse_customers_.d3f9188fc2 (execute): 22:35:10.755687 => 22:35:10.755687
[0m22:35:10.756673 [debug] [Thread-1 (]: Finished running node test.dbt_idx.source_relationships_warehouse_orders_cust_id__customer_id__source_warehouse_customers_.d3f9188fc2
[0m22:35:10.757692 [debug] [Thread-1 (]: Began running node test.dbt_idx.source_unique_warehouse_orders_order_id.839fb43d0f
[0m22:35:10.758653 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_idx.source_relationships_warehouse_orders_cust_id__customer_id__source_warehouse_customers_.d3f9188fc2, now test.dbt_idx.source_unique_warehouse_orders_order_id.839fb43d0f)
[0m22:35:10.759653 [debug] [Thread-1 (]: Began compiling node test.dbt_idx.source_unique_warehouse_orders_order_id.839fb43d0f
[0m22:35:10.765688 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_idx.source_unique_warehouse_orders_order_id.839fb43d0f"
[0m22:35:10.771673 [debug] [Thread-1 (]: Timing info for test.dbt_idx.source_unique_warehouse_orders_order_id.839fb43d0f (compile): 22:35:10.759653 => 22:35:10.771673
[0m22:35:10.772693 [debug] [Thread-1 (]: Began executing node test.dbt_idx.source_unique_warehouse_orders_order_id.839fb43d0f
[0m22:35:10.773675 [debug] [Thread-1 (]: Timing info for test.dbt_idx.source_unique_warehouse_orders_order_id.839fb43d0f (execute): 22:35:10.773675 => 22:35:10.773675
[0m22:35:10.774668 [debug] [Thread-1 (]: Finished running node test.dbt_idx.source_unique_warehouse_orders_order_id.839fb43d0f
[0m22:35:10.775670 [debug] [Thread-1 (]: Began running node model.dbt_idx.fact_orders
[0m22:35:10.776700 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_idx.source_unique_warehouse_orders_order_id.839fb43d0f, now model.dbt_idx.fact_orders)
[0m22:35:10.776700 [debug] [Thread-1 (]: Began compiling node model.dbt_idx.fact_orders
[0m22:35:10.779700 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_idx.fact_orders"
[0m22:35:10.785940 [debug] [Thread-1 (]: Timing info for model.dbt_idx.fact_orders (compile): 22:35:10.777702 => 22:35:10.785940
[0m22:35:10.786924 [debug] [Thread-1 (]: Began executing node model.dbt_idx.fact_orders
[0m22:35:10.786924 [debug] [Thread-1 (]: Timing info for model.dbt_idx.fact_orders (execute): 22:35:10.786924 => 22:35:10.786924
[0m22:35:10.787960 [debug] [Thread-1 (]: Finished running node model.dbt_idx.fact_orders
[0m22:35:10.788966 [debug] [Thread-1 (]: Began running node model.dbt_idx.stg_eltool__customers_snapshots
[0m22:35:10.789939 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_idx.fact_orders, now model.dbt_idx.stg_eltool__customers_snapshots)
[0m22:35:10.791002 [debug] [Thread-1 (]: Began compiling node model.dbt_idx.stg_eltool__customers_snapshots
[0m22:35:10.793958 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_idx.stg_eltool__customers_snapshots"
[0m22:35:10.800427 [debug] [Thread-1 (]: Timing info for model.dbt_idx.stg_eltool__customers_snapshots (compile): 22:35:10.791926 => 22:35:10.800427
[0m22:35:10.801406 [debug] [Thread-1 (]: Began executing node model.dbt_idx.stg_eltool__customers_snapshots
[0m22:35:10.802407 [debug] [Thread-1 (]: Timing info for model.dbt_idx.stg_eltool__customers_snapshots (execute): 22:35:10.801406 => 22:35:10.801406
[0m22:35:10.803406 [debug] [Thread-1 (]: Finished running node model.dbt_idx.stg_eltool__customers_snapshots
[0m22:35:10.804408 [debug] [Thread-1 (]: Began running node model.dbt_idx.dim_customers
[0m22:35:10.805410 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_idx.stg_eltool__customers_snapshots, now model.dbt_idx.dim_customers)
[0m22:35:10.806412 [debug] [Thread-1 (]: Began compiling node model.dbt_idx.dim_customers
[0m22:35:10.809410 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_idx.dim_customers"
[0m22:35:10.815410 [debug] [Thread-1 (]: Timing info for model.dbt_idx.dim_customers (compile): 22:35:10.806412 => 22:35:10.814407
[0m22:35:10.816411 [debug] [Thread-1 (]: Began executing node model.dbt_idx.dim_customers
[0m22:35:10.816411 [debug] [Thread-1 (]: Timing info for model.dbt_idx.dim_customers (execute): 22:35:10.816411 => 22:35:10.816411
[0m22:35:10.818411 [debug] [Thread-1 (]: Finished running node model.dbt_idx.dim_customers
[0m22:35:10.818411 [debug] [Thread-1 (]: Began running node test.dbt_idx.not_null_stg_eltool__customers_snapshots_customer_id.ea4fc4ca86
[0m22:35:10.820429 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_idx.dim_customers, now test.dbt_idx.not_null_stg_eltool__customers_snapshots_customer_id.ea4fc4ca86)
[0m22:35:10.821425 [debug] [Thread-1 (]: Began compiling node test.dbt_idx.not_null_stg_eltool__customers_snapshots_customer_id.ea4fc4ca86
[0m22:35:10.825410 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_idx.not_null_stg_eltool__customers_snapshots_customer_id.ea4fc4ca86"
[0m22:35:10.831411 [debug] [Thread-1 (]: Timing info for test.dbt_idx.not_null_stg_eltool__customers_snapshots_customer_id.ea4fc4ca86 (compile): 22:35:10.821425 => 22:35:10.830407
[0m22:35:10.832411 [debug] [Thread-1 (]: Began executing node test.dbt_idx.not_null_stg_eltool__customers_snapshots_customer_id.ea4fc4ca86
[0m22:35:10.832411 [debug] [Thread-1 (]: Timing info for test.dbt_idx.not_null_stg_eltool__customers_snapshots_customer_id.ea4fc4ca86 (execute): 22:35:10.832411 => 22:35:10.832411
[0m22:35:10.833410 [debug] [Thread-1 (]: Finished running node test.dbt_idx.not_null_stg_eltool__customers_snapshots_customer_id.ea4fc4ca86
[0m22:35:10.834411 [debug] [Thread-1 (]: Began running node model.dbt_idx.customer_orders_status
[0m22:35:10.835436 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_idx.not_null_stg_eltool__customers_snapshots_customer_id.ea4fc4ca86, now model.dbt_idx.customer_orders_status)
[0m22:35:10.836410 [debug] [Thread-1 (]: Began compiling node model.dbt_idx.customer_orders_status
[0m22:35:10.839410 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_idx.customer_orders_status"
[0m22:35:10.844406 [debug] [Thread-1 (]: Timing info for model.dbt_idx.customer_orders_status (compile): 22:35:10.836410 => 22:35:10.844406
[0m22:35:10.845412 [debug] [Thread-1 (]: Began executing node model.dbt_idx.customer_orders_status
[0m22:35:10.846411 [debug] [Thread-1 (]: Timing info for model.dbt_idx.customer_orders_status (execute): 22:35:10.845412 => 22:35:10.845412
[0m22:35:10.847410 [debug] [Thread-1 (]: Finished running node model.dbt_idx.customer_orders_status
[0m22:35:10.847410 [debug] [Thread-1 (]: Began running node test.dbt_idx.assert_customer_dimension_has_no_row_loss.sql
[0m22:35:10.849410 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_idx.customer_orders_status, now test.dbt_idx.assert_customer_dimension_has_no_row_loss.sql)
[0m22:35:10.849410 [debug] [Thread-1 (]: Began compiling node test.dbt_idx.assert_customer_dimension_has_no_row_loss.sql
[0m22:35:10.853410 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_idx.assert_customer_dimension_has_no_row_loss.sql"
[0m22:35:10.858746 [debug] [Thread-1 (]: Timing info for test.dbt_idx.assert_customer_dimension_has_no_row_loss.sql (compile): 22:35:10.850411 => 22:35:10.858746
[0m22:35:10.859749 [debug] [Thread-1 (]: Began executing node test.dbt_idx.assert_customer_dimension_has_no_row_loss.sql
[0m22:35:10.860713 [debug] [Thread-1 (]: Timing info for test.dbt_idx.assert_customer_dimension_has_no_row_loss.sql (execute): 22:35:10.860713 => 22:35:10.860713
[0m22:35:10.861748 [debug] [Thread-1 (]: Finished running node test.dbt_idx.assert_customer_dimension_has_no_row_loss.sql
[0m22:35:10.862711 [debug] [Thread-1 (]: Began running node test.dbt_idx.accepted_values_customer_orders_status_order_status__delivered__invoiced__shipped__processing__canceled__unavailable.ea8c296d27
[0m22:35:10.862711 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_idx.assert_customer_dimension_has_no_row_loss.sql, now test.dbt_idx.accepted_values_customer_orders_status_order_status__delivered__invoiced__shipped__processing__canceled__unavailable.ea8c296d27)
[0m22:35:10.863748 [debug] [Thread-1 (]: Began compiling node test.dbt_idx.accepted_values_customer_orders_status_order_status__delivered__invoiced__shipped__processing__canceled__unavailable.ea8c296d27
[0m22:35:10.874787 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_idx.accepted_values_customer_orders_status_order_status__delivered__invoiced__shipped__processing__canceled__unavailable.ea8c296d27"
[0m22:35:10.880753 [debug] [Thread-1 (]: Timing info for test.dbt_idx.accepted_values_customer_orders_status_order_status__delivered__invoiced__shipped__processing__canceled__unavailable.ea8c296d27 (compile): 22:35:10.864725 => 22:35:10.879755
[0m22:35:10.880753 [debug] [Thread-1 (]: Began executing node test.dbt_idx.accepted_values_customer_orders_status_order_status__delivered__invoiced__shipped__processing__canceled__unavailable.ea8c296d27
[0m22:35:10.881753 [debug] [Thread-1 (]: Timing info for test.dbt_idx.accepted_values_customer_orders_status_order_status__delivered__invoiced__shipped__processing__canceled__unavailable.ea8c296d27 (execute): 22:35:10.881753 => 22:35:10.881753
[0m22:35:10.882769 [debug] [Thread-1 (]: Finished running node test.dbt_idx.accepted_values_customer_orders_status_order_status__delivered__invoiced__shipped__processing__canceled__unavailable.ea8c296d27
[0m22:35:10.883787 [debug] [Thread-1 (]: Began running node test.dbt_idx.not_null_customer_orders_status_customer_id.3915c814eb
[0m22:35:10.884328 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_idx.accepted_values_customer_orders_status_order_status__delivered__invoiced__shipped__processing__canceled__unavailable.ea8c296d27, now test.dbt_idx.not_null_customer_orders_status_customer_id.3915c814eb)
[0m22:35:10.885369 [debug] [Thread-1 (]: Began compiling node test.dbt_idx.not_null_customer_orders_status_customer_id.3915c814eb
[0m22:35:10.890398 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_idx.not_null_customer_orders_status_customer_id.3915c814eb"
[0m22:35:10.897356 [debug] [Thread-1 (]: Timing info for test.dbt_idx.not_null_customer_orders_status_customer_id.3915c814eb (compile): 22:35:10.886338 => 22:35:10.897356
[0m22:35:10.898356 [debug] [Thread-1 (]: Began executing node test.dbt_idx.not_null_customer_orders_status_customer_id.3915c814eb
[0m22:35:10.899355 [debug] [Thread-1 (]: Timing info for test.dbt_idx.not_null_customer_orders_status_customer_id.3915c814eb (execute): 22:35:10.899355 => 22:35:10.899355
[0m22:35:10.901355 [debug] [Thread-1 (]: Finished running node test.dbt_idx.not_null_customer_orders_status_customer_id.3915c814eb
[0m22:35:10.901355 [debug] [Thread-1 (]: Began running node test.dbt_idx.unique_customer_orders_status_order_id.b7a45e83ee
[0m22:35:10.902355 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_idx.not_null_customer_orders_status_customer_id.3915c814eb, now test.dbt_idx.unique_customer_orders_status_order_id.b7a45e83ee)
[0m22:35:10.903354 [debug] [Thread-1 (]: Began compiling node test.dbt_idx.unique_customer_orders_status_order_id.b7a45e83ee
[0m22:35:10.907355 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_idx.unique_customer_orders_status_order_id.b7a45e83ee"
[0m22:35:10.913653 [debug] [Thread-1 (]: Timing info for test.dbt_idx.unique_customer_orders_status_order_id.b7a45e83ee (compile): 22:35:10.903354 => 22:35:10.912686
[0m22:35:10.914651 [debug] [Thread-1 (]: Began executing node test.dbt_idx.unique_customer_orders_status_order_id.b7a45e83ee
[0m22:35:10.914651 [debug] [Thread-1 (]: Timing info for test.dbt_idx.unique_customer_orders_status_order_id.b7a45e83ee (execute): 22:35:10.914651 => 22:35:10.914651
[0m22:35:10.916654 [debug] [Thread-1 (]: Finished running node test.dbt_idx.unique_customer_orders_status_order_id.b7a45e83ee
[0m22:35:10.917664 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:35:10.918650 [debug] [MainThread]: Connection 'list_IDX-Stock_snapshots' was properly closed.
[0m22:35:10.919652 [debug] [MainThread]: Connection 'test.dbt_idx.unique_customer_orders_status_order_id.b7a45e83ee' was properly closed.
[0m22:35:10.922648 [debug] [MainThread]: Command end result
[0m22:35:11.272872 [debug] [MainThread]: Acquiring new postgres connection 'generate_catalog'
[0m22:35:11.272872 [info ] [MainThread]: Building catalog
[0m22:35:11.275838 [debug] [ThreadPool]: Acquiring new postgres connection 'IDX-Stock.information_schema'
[0m22:35:11.284351 [debug] [ThreadPool]: Using postgres connection "IDX-Stock.information_schema"
[0m22:35:11.285365 [debug] [ThreadPool]: On IDX-Stock.information_schema: BEGIN
[0m22:35:11.286360 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:35:11.308884 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m22:35:11.309884 [debug] [ThreadPool]: Using postgres connection "IDX-Stock.information_schema"
[0m22:35:11.310881 [debug] [ThreadPool]: On IDX-Stock.information_schema: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "connection_name": "IDX-Stock.information_schema"} */

    
    

    select
        'IDX-Stock' as table_database,
        sch.nspname as table_schema,
        tbl.relname as table_name,
        case tbl.relkind
            when 'v' then 'VIEW'
            else 'BASE TABLE'
        end as table_type,
        tbl_desc.description as table_comment,
        col.attname as column_name,
        col.attnum as column_index,
        pg_catalog.format_type(col.atttypid, col.atttypmod) as column_type,
        col_desc.description as column_comment,
        pg_get_userbyid(tbl.relowner) as table_owner

    from pg_catalog.pg_namespace sch
    join pg_catalog.pg_class tbl on tbl.relnamespace = sch.oid
    join pg_catalog.pg_attribute col on col.attrelid = tbl.oid
    left outer join pg_catalog.pg_description tbl_desc on (tbl_desc.objoid = tbl.oid and tbl_desc.objsubid = 0)
    left outer join pg_catalog.pg_description col_desc on (col_desc.objoid = tbl.oid and col_desc.objsubid = col.attnum)

    where (upper(sch.nspname) = upper('warehouse') or upper(sch.nspname) = upper('snapshots'))
      and not pg_is_other_temp_schema(sch.oid) -- not a temporary schema belonging to another session
      and tbl.relpersistence in ('p', 'u') -- [p]ermanent table or [u]nlogged table. Exclude [t]emporary tables
      and tbl.relkind in ('r', 'v', 'f', 'p') -- o[r]dinary table, [v]iew, [f]oreign table, [p]artitioned table. Other values are [i]ndex, [S]equence, [c]omposite type, [t]OAST table, [m]aterialized view
      and col.attnum > 0 -- negative numbers are used for system columns such as oid
      and not col.attisdropped -- column as not been dropped

    order by
        sch.nspname,
        tbl.relname,
        col.attnum
[0m22:35:11.320398 [debug] [ThreadPool]: SQL status: SELECT 77 in 0.0 seconds
[0m22:35:11.328365 [debug] [ThreadPool]: On IDX-Stock.information_schema: ROLLBACK
[0m22:35:11.330330 [debug] [ThreadPool]: On IDX-Stock.information_schema: Close
[0m22:35:11.355362 [info ] [MainThread]: Catalog written to D:\00 Project\00 My Project\IdeaProjects\Py-DBT-IDX\target\catalog.json
[0m22:35:11.357331 [debug] [MainThread]: Command `dbt docs generate` succeeded at 22:35:11.357331 after 1.36 seconds
[0m22:35:11.358331 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
[0m22:35:11.358331 [debug] [MainThread]: Connection 'IDX-Stock.information_schema' was properly closed.
[0m22:35:11.359333 [debug] [MainThread]: Flushing usage events


============================== 22:35:23.422319 | 71be45e0-426d-4cf4-8780-409403bd1a6a ==============================
[0m22:35:23.422319 [info ] [MainThread]: Running with dbt=1.6.1
[0m22:35:23.429829 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': 'D:\\00 Project\\00 My Project\\IdeaProjects\\Py-DBT-IDX\\logs', 'fail_fast': 'False', 'profiles_dir': 'D:\\00 Project\\00 My Project\\IdeaProjects\\Py-DBT-IDX', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt docs serve', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'False'}
[0m22:38:10.713456 [error] [MainThread]: Encountered an error:

[0m22:38:10.724507 [error] [MainThread]: Traceback (most recent call last):
  File "C:\Users\dmitr\Py-DBT-IDX\Lib\site-packages\dbt\cli\requires.py", line 87, in wrapper
    result, success = func(*args, **kwargs)
                      ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\dmitr\Py-DBT-IDX\Lib\site-packages\dbt\cli\requires.py", line 72, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\dmitr\Py-DBT-IDX\Lib\site-packages\dbt\cli\requires.py", line 143, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\dmitr\Py-DBT-IDX\Lib\site-packages\dbt\cli\requires.py", line 172, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\dmitr\Py-DBT-IDX\Lib\site-packages\dbt\cli\requires.py", line 219, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\dmitr\Py-DBT-IDX\Lib\site-packages\dbt\cli\main.py", line 307, in docs_serve
    results = task.run()
              ^^^^^^^^^^
  File "C:\Users\dmitr\Py-DBT-IDX\Lib\site-packages\dbt\task\serve.py", line 28, in run
    httpd.serve_forever()
  File "C:\Python311\Lib\socketserver.py", line 233, in serve_forever
    ready = selector.select(poll_interval)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Python311\Lib\selectors.py", line 323, in select
    r, w, _ = self._select(self._readers, self._writers, [], timeout)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Python311\Lib\selectors.py", line 314, in _select
    r, w, x = select.select(r, w, w, timeout)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
KeyboardInterrupt

[0m22:38:10.726507 [debug] [MainThread]: Command `dbt docs serve` failed at 22:38:10.726507 after 167.36 seconds
[0m22:38:10.727524 [debug] [MainThread]: Flushing usage events


============================== 22:38:17.482797 | dbd64980-bb0b-466c-917e-ad096d663d9c ==============================
[0m22:38:17.482797 [info ] [MainThread]: Running with dbt=1.6.1
[0m22:38:17.490826 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'D:\\00 Project\\00 My Project\\IdeaProjects\\Py-DBT-IDX\\logs', 'version_check': 'True', 'profiles_dir': 'D:\\00 Project\\00 My Project\\IdeaProjects\\Py-DBT-IDX', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt test', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'False'}
[0m22:38:17.637940 [info ] [MainThread]: Registered adapter: postgres=1.6.1
[0m22:38:17.648950 [debug] [MainThread]: checksum: efe19d9f5b93d1a98cc804fbfcdb6b3aced98b974af664946fee1cde8837deb7, vars: {}, profile: , target: , version: 1.6.1
[0m22:38:17.828545 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m22:38:17.829545 [debug] [MainThread]: Partial parsing: updated file: dbt_idx://tests\assert_customer_dimension_has_no_row_loss.sql.sql
[0m22:38:17.913287 [info ] [MainThread]: Found 1 snapshot, 9 tests, 7 models, 3 sources, 0 exposures, 0 metrics, 349 macros, 0 groups, 0 semantic models
[0m22:38:17.917294 [info ] [MainThread]: 
[0m22:38:17.919289 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m22:38:17.923297 [debug] [ThreadPool]: Acquiring new postgres connection 'list_IDX-Stock_warehouse'
[0m22:38:17.944289 [debug] [ThreadPool]: Using postgres connection "list_IDX-Stock_warehouse"
[0m22:38:17.945304 [debug] [ThreadPool]: On list_IDX-Stock_warehouse: BEGIN
[0m22:38:17.946294 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:38:17.986293 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m22:38:17.987295 [debug] [ThreadPool]: Using postgres connection "list_IDX-Stock_warehouse"
[0m22:38:17.988314 [debug] [ThreadPool]: On list_IDX-Stock_warehouse: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "connection_name": "list_IDX-Stock_warehouse"} */
select
      'IDX-Stock' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'warehouse'
    union all
    select
      'IDX-Stock' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'warehouse'
    union all
    select
      'IDX-Stock' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'warehouse'
  
[0m22:38:17.994297 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.0 seconds
[0m22:38:17.996295 [debug] [ThreadPool]: On list_IDX-Stock_warehouse: ROLLBACK
[0m22:38:17.999295 [debug] [ThreadPool]: On list_IDX-Stock_warehouse: Close
[0m22:38:18.002644 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_IDX-Stock_warehouse, now list_IDX-Stock_snapshots)
[0m22:38:18.009637 [debug] [ThreadPool]: Using postgres connection "list_IDX-Stock_snapshots"
[0m22:38:18.010635 [debug] [ThreadPool]: On list_IDX-Stock_snapshots: BEGIN
[0m22:38:18.011637 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:38:18.037635 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m22:38:18.038634 [debug] [ThreadPool]: Using postgres connection "list_IDX-Stock_snapshots"
[0m22:38:18.039634 [debug] [ThreadPool]: On list_IDX-Stock_snapshots: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "connection_name": "list_IDX-Stock_snapshots"} */
select
      'IDX-Stock' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'snapshots'
    union all
    select
      'IDX-Stock' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'snapshots'
    union all
    select
      'IDX-Stock' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'snapshots'
  
[0m22:38:18.045639 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.0 seconds
[0m22:38:18.048635 [debug] [ThreadPool]: On list_IDX-Stock_snapshots: ROLLBACK
[0m22:38:18.051658 [debug] [ThreadPool]: On list_IDX-Stock_snapshots: Close
[0m22:38:18.062659 [debug] [MainThread]: Using postgres connection "master"
[0m22:38:18.064655 [debug] [MainThread]: On master: BEGIN
[0m22:38:18.065636 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:38:18.106383 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m22:38:18.107362 [debug] [MainThread]: Using postgres connection "master"
[0m22:38:18.108363 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m22:38:18.119373 [debug] [MainThread]: SQL status: SELECT 6 in 0.0 seconds
[0m22:38:18.124389 [debug] [MainThread]: On master: ROLLBACK
[0m22:38:18.127365 [debug] [MainThread]: Using postgres connection "master"
[0m22:38:18.128377 [debug] [MainThread]: On master: BEGIN
[0m22:38:18.132378 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m22:38:18.133378 [debug] [MainThread]: On master: COMMIT
[0m22:38:18.135377 [debug] [MainThread]: Using postgres connection "master"
[0m22:38:18.136393 [debug] [MainThread]: On master: COMMIT
[0m22:38:18.140382 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m22:38:18.141378 [debug] [MainThread]: On master: Close
[0m22:38:18.144380 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m22:38:18.146379 [info ] [MainThread]: 
[0m22:38:18.155408 [debug] [Thread-1 (]: Began running node test.dbt_idx.accepted_values_customer_orders_status_order_status__delivered__invoiced__shipped__processing__canceled__unavailable.ea8c296d27
[0m22:38:18.157377 [info ] [Thread-1 (]: 1 of 9 START test accepted_values_customer_orders_status_order_status__delivered__invoiced__shipped__processing__canceled__unavailable  [RUN]
[0m22:38:18.160378 [debug] [Thread-1 (]: Acquiring new postgres connection 'test.dbt_idx.accepted_values_customer_orders_status_order_status__delivered__invoiced__shipped__processing__canceled__unavailable.ea8c296d27'
[0m22:38:18.162379 [debug] [Thread-1 (]: Began compiling node test.dbt_idx.accepted_values_customer_orders_status_order_status__delivered__invoiced__shipped__processing__canceled__unavailable.ea8c296d27
[0m22:38:18.205095 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_idx.accepted_values_customer_orders_status_order_status__delivered__invoiced__shipped__processing__canceled__unavailable.ea8c296d27"
[0m22:38:18.215350 [debug] [Thread-1 (]: Timing info for test.dbt_idx.accepted_values_customer_orders_status_order_status__delivered__invoiced__shipped__processing__canceled__unavailable.ea8c296d27 (compile): 22:38:18.163385 => 22:38:18.215350
[0m22:38:18.219129 [debug] [Thread-1 (]: Began executing node test.dbt_idx.accepted_values_customer_orders_status_order_status__delivered__invoiced__shipped__processing__canceled__unavailable.ea8c296d27
[0m22:38:18.261517 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_idx.accepted_values_customer_orders_status_order_status__delivered__invoiced__shipped__processing__canceled__unavailable.ea8c296d27"
[0m22:38:18.271258 [debug] [Thread-1 (]: Using postgres connection "test.dbt_idx.accepted_values_customer_orders_status_order_status__delivered__invoiced__shipped__processing__canceled__unavailable.ea8c296d27"
[0m22:38:18.273253 [debug] [Thread-1 (]: On test.dbt_idx.accepted_values_customer_orders_status_order_status__delivered__invoiced__shipped__processing__canceled__unavailable.ea8c296d27: BEGIN
[0m22:38:18.274267 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m22:38:18.342879 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m22:38:18.343869 [debug] [Thread-1 (]: Using postgres connection "test.dbt_idx.accepted_values_customer_orders_status_order_status__delivered__invoiced__shipped__processing__canceled__unavailable.ea8c296d27"
[0m22:38:18.345857 [debug] [Thread-1 (]: On test.dbt_idx.accepted_values_customer_orders_status_order_status__delivered__invoiced__shipped__processing__canceled__unavailable.ea8c296d27: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "test.dbt_idx.accepted_values_customer_orders_status_order_status__delivered__invoiced__shipped__processing__canceled__unavailable.ea8c296d27"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        order_status as value_field,
        count(*) as n_records

    from "IDX-Stock"."warehouse"."customer_orders_status"
    group by order_status

)

select *
from all_values
where value_field not in (
    'delivered','invoiced','shipped','processing','canceled','unavailable'
)



      
    ) dbt_internal_test
[0m22:38:18.353231 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m22:38:18.358252 [debug] [Thread-1 (]: Timing info for test.dbt_idx.accepted_values_customer_orders_status_order_status__delivered__invoiced__shipped__processing__canceled__unavailable.ea8c296d27 (execute): 22:38:18.223352 => 22:38:18.357233
[0m22:38:18.359232 [debug] [Thread-1 (]: On test.dbt_idx.accepted_values_customer_orders_status_order_status__delivered__invoiced__shipped__processing__canceled__unavailable.ea8c296d27: ROLLBACK
[0m22:38:18.362297 [debug] [Thread-1 (]: On test.dbt_idx.accepted_values_customer_orders_status_order_status__delivered__invoiced__shipped__processing__canceled__unavailable.ea8c296d27: Close
[0m22:38:18.364855 [info ] [Thread-1 (]: 1 of 9 PASS accepted_values_customer_orders_status_order_status__delivered__invoiced__shipped__processing__canceled__unavailable  [[32mPASS[0m in 0.20s]
[0m22:38:18.366845 [debug] [Thread-1 (]: Finished running node test.dbt_idx.accepted_values_customer_orders_status_order_status__delivered__invoiced__shipped__processing__canceled__unavailable.ea8c296d27
[0m22:38:18.370187 [debug] [Thread-1 (]: Began running node test.dbt_idx.assert_customer_dimension_has_no_row_loss.sql
[0m22:38:18.371892 [info ] [Thread-1 (]: 2 of 9 START test assert_customer_dimension_has_no_row_loss.sql ................ [RUN]
[0m22:38:18.374889 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_idx.accepted_values_customer_orders_status_order_status__delivered__invoiced__shipped__processing__canceled__unavailable.ea8c296d27, now test.dbt_idx.assert_customer_dimension_has_no_row_loss.sql)
[0m22:38:18.376560 [debug] [Thread-1 (]: Began compiling node test.dbt_idx.assert_customer_dimension_has_no_row_loss.sql
[0m22:38:18.384015 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_idx.assert_customer_dimension_has_no_row_loss.sql"
[0m22:38:18.392794 [debug] [Thread-1 (]: Timing info for test.dbt_idx.assert_customer_dimension_has_no_row_loss.sql (compile): 22:38:18.378222 => 22:38:18.391813
[0m22:38:18.394800 [debug] [Thread-1 (]: Began executing node test.dbt_idx.assert_customer_dimension_has_no_row_loss.sql
[0m22:38:18.400362 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_idx.assert_customer_dimension_has_no_row_loss.sql"
[0m22:38:18.409413 [debug] [Thread-1 (]: Using postgres connection "test.dbt_idx.assert_customer_dimension_has_no_row_loss.sql"
[0m22:38:18.410450 [debug] [Thread-1 (]: On test.dbt_idx.assert_customer_dimension_has_no_row_loss.sql: BEGIN
[0m22:38:18.411411 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:38:18.438839 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m22:38:18.440835 [debug] [Thread-1 (]: Using postgres connection "test.dbt_idx.assert_customer_dimension_has_no_row_loss.sql"
[0m22:38:18.442832 [debug] [Thread-1 (]: On test.dbt_idx.assert_customer_dimension_has_no_row_loss.sql: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "test.dbt_idx.assert_customer_dimension_has_no_row_loss.sql"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      -- dim_customers must have the same number of rows as its staging counterpart
-- Therefore return records where this isn't true to make the test fail
select *
from (
    select dim_cust.customer_id
    from "IDX-Stock"."warehouse"."dim_customers" dim_cust
        left join "IDX-Stock"."warehouse"."stg_eltool__customers_snapshots" stg_cust
    on dim_cust.customer_id = stg_cust.customer_id
    where stg_cust.customer_id is null
    UNION ALL
    select stg_cust.customer_id
    from "IDX-Stock"."warehouse"."stg_eltool__customers_snapshots" stg_cust
      left join "IDX-Stock"."warehouse"."dim_customers" dim_cust
    on stg_cust.customer_id = dim_cust.customer_id
    where dim_cust.customer_id is null
) tmp
      
    ) dbt_internal_test
[0m22:38:18.449913 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m22:38:18.453911 [debug] [Thread-1 (]: Timing info for test.dbt_idx.assert_customer_dimension_has_no_row_loss.sql (execute): 22:38:18.395798 => 22:38:18.453911
[0m22:38:18.455913 [debug] [Thread-1 (]: On test.dbt_idx.assert_customer_dimension_has_no_row_loss.sql: ROLLBACK
[0m22:38:18.459438 [debug] [Thread-1 (]: On test.dbt_idx.assert_customer_dimension_has_no_row_loss.sql: Close
[0m22:38:18.461437 [info ] [Thread-1 (]: 2 of 9 PASS assert_customer_dimension_has_no_row_loss.sql ...................... [[32mPASS[0m in 0.09s]
[0m22:38:18.463964 [debug] [Thread-1 (]: Finished running node test.dbt_idx.assert_customer_dimension_has_no_row_loss.sql
[0m22:38:18.464965 [debug] [Thread-1 (]: Began running node test.dbt_idx.not_null_customer_orders_status_customer_id.3915c814eb
[0m22:38:18.466479 [info ] [Thread-1 (]: 3 of 9 START test not_null_customer_orders_status_customer_id .................. [RUN]
[0m22:38:18.469493 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_idx.assert_customer_dimension_has_no_row_loss.sql, now test.dbt_idx.not_null_customer_orders_status_customer_id.3915c814eb)
[0m22:38:18.470493 [debug] [Thread-1 (]: Began compiling node test.dbt_idx.not_null_customer_orders_status_customer_id.3915c814eb
[0m22:38:18.485603 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_idx.not_null_customer_orders_status_customer_id.3915c814eb"
[0m22:38:18.493596 [debug] [Thread-1 (]: Timing info for test.dbt_idx.not_null_customer_orders_status_customer_id.3915c814eb (compile): 22:38:18.471492 => 22:38:18.492601
[0m22:38:18.494595 [debug] [Thread-1 (]: Began executing node test.dbt_idx.not_null_customer_orders_status_customer_id.3915c814eb
[0m22:38:18.498595 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_idx.not_null_customer_orders_status_customer_id.3915c814eb"
[0m22:38:18.505427 [debug] [Thread-1 (]: Using postgres connection "test.dbt_idx.not_null_customer_orders_status_customer_id.3915c814eb"
[0m22:38:18.506428 [debug] [Thread-1 (]: On test.dbt_idx.not_null_customer_orders_status_customer_id.3915c814eb: BEGIN
[0m22:38:18.507429 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:38:18.528955 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m22:38:18.529951 [debug] [Thread-1 (]: Using postgres connection "test.dbt_idx.not_null_customer_orders_status_customer_id.3915c814eb"
[0m22:38:18.530952 [debug] [Thread-1 (]: On test.dbt_idx.not_null_customer_orders_status_customer_id.3915c814eb: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "test.dbt_idx.not_null_customer_orders_status_customer_id.3915c814eb"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select customer_id
from "IDX-Stock"."warehouse"."customer_orders_status"
where customer_id is null



      
    ) dbt_internal_test
[0m22:38:18.534950 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m22:38:18.537029 [debug] [Thread-1 (]: Timing info for test.dbt_idx.not_null_customer_orders_status_customer_id.3915c814eb (execute): 22:38:18.494595 => 22:38:18.537029
[0m22:38:18.538036 [debug] [Thread-1 (]: On test.dbt_idx.not_null_customer_orders_status_customer_id.3915c814eb: ROLLBACK
[0m22:38:18.540032 [debug] [Thread-1 (]: On test.dbt_idx.not_null_customer_orders_status_customer_id.3915c814eb: Close
[0m22:38:18.542031 [info ] [Thread-1 (]: 3 of 9 PASS not_null_customer_orders_status_customer_id ........................ [[32mPASS[0m in 0.07s]
[0m22:38:18.544038 [debug] [Thread-1 (]: Finished running node test.dbt_idx.not_null_customer_orders_status_customer_id.3915c814eb
[0m22:38:18.545420 [debug] [Thread-1 (]: Began running node test.dbt_idx.not_null_stg_eltool__customers_snapshots_customer_id.ea4fc4ca86
[0m22:38:18.546029 [info ] [Thread-1 (]: 4 of 9 START test not_null_stg_eltool__customers_snapshots_customer_id ......... [RUN]
[0m22:38:18.548026 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_idx.not_null_customer_orders_status_customer_id.3915c814eb, now test.dbt_idx.not_null_stg_eltool__customers_snapshots_customer_id.ea4fc4ca86)
[0m22:38:18.549038 [debug] [Thread-1 (]: Began compiling node test.dbt_idx.not_null_stg_eltool__customers_snapshots_customer_id.ea4fc4ca86
[0m22:38:18.556558 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_idx.not_null_stg_eltool__customers_snapshots_customer_id.ea4fc4ca86"
[0m22:38:18.564201 [debug] [Thread-1 (]: Timing info for test.dbt_idx.not_null_stg_eltool__customers_snapshots_customer_id.ea4fc4ca86 (compile): 22:38:18.549038 => 22:38:18.564201
[0m22:38:18.565188 [debug] [Thread-1 (]: Began executing node test.dbt_idx.not_null_stg_eltool__customers_snapshots_customer_id.ea4fc4ca86
[0m22:38:18.568185 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_idx.not_null_stg_eltool__customers_snapshots_customer_id.ea4fc4ca86"
[0m22:38:18.576374 [debug] [Thread-1 (]: Using postgres connection "test.dbt_idx.not_null_stg_eltool__customers_snapshots_customer_id.ea4fc4ca86"
[0m22:38:18.577373 [debug] [Thread-1 (]: On test.dbt_idx.not_null_stg_eltool__customers_snapshots_customer_id.ea4fc4ca86: BEGIN
[0m22:38:18.578398 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:38:18.602010 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m22:38:18.603416 [debug] [Thread-1 (]: Using postgres connection "test.dbt_idx.not_null_stg_eltool__customers_snapshots_customer_id.ea4fc4ca86"
[0m22:38:18.604417 [debug] [Thread-1 (]: On test.dbt_idx.not_null_stg_eltool__customers_snapshots_customer_id.ea4fc4ca86: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "test.dbt_idx.not_null_stg_eltool__customers_snapshots_customer_id.ea4fc4ca86"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select customer_id
from "IDX-Stock"."warehouse"."stg_eltool__customers_snapshots"
where customer_id is null



      
    ) dbt_internal_test
[0m22:38:18.607414 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m22:38:18.609433 [debug] [Thread-1 (]: Timing info for test.dbt_idx.not_null_stg_eltool__customers_snapshots_customer_id.ea4fc4ca86 (execute): 22:38:18.566186 => 22:38:18.609433
[0m22:38:18.610941 [debug] [Thread-1 (]: On test.dbt_idx.not_null_stg_eltool__customers_snapshots_customer_id.ea4fc4ca86: ROLLBACK
[0m22:38:18.612948 [debug] [Thread-1 (]: On test.dbt_idx.not_null_stg_eltool__customers_snapshots_customer_id.ea4fc4ca86: Close
[0m22:38:18.615953 [info ] [Thread-1 (]: 4 of 9 PASS not_null_stg_eltool__customers_snapshots_customer_id ............... [[32mPASS[0m in 0.07s]
[0m22:38:18.617955 [debug] [Thread-1 (]: Finished running node test.dbt_idx.not_null_stg_eltool__customers_snapshots_customer_id.ea4fc4ca86
[0m22:38:18.618952 [debug] [Thread-1 (]: Began running node test.dbt_idx.source_not_null_warehouse_customers_customer_id.ae7452c4c6
[0m22:38:18.619950 [info ] [Thread-1 (]: 5 of 9 START test source_not_null_warehouse_customers_customer_id .............. [RUN]
[0m22:38:18.621949 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_idx.not_null_stg_eltool__customers_snapshots_customer_id.ea4fc4ca86, now test.dbt_idx.source_not_null_warehouse_customers_customer_id.ae7452c4c6)
[0m22:38:18.622946 [debug] [Thread-1 (]: Began compiling node test.dbt_idx.source_not_null_warehouse_customers_customer_id.ae7452c4c6
[0m22:38:18.627946 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_idx.source_not_null_warehouse_customers_customer_id.ae7452c4c6"
[0m22:38:18.635483 [debug] [Thread-1 (]: Timing info for test.dbt_idx.source_not_null_warehouse_customers_customer_id.ae7452c4c6 (compile): 22:38:18.622946 => 22:38:18.635483
[0m22:38:18.636500 [debug] [Thread-1 (]: Began executing node test.dbt_idx.source_not_null_warehouse_customers_customer_id.ae7452c4c6
[0m22:38:18.640501 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_idx.source_not_null_warehouse_customers_customer_id.ae7452c4c6"
[0m22:38:18.647259 [debug] [Thread-1 (]: Using postgres connection "test.dbt_idx.source_not_null_warehouse_customers_customer_id.ae7452c4c6"
[0m22:38:18.648254 [debug] [Thread-1 (]: On test.dbt_idx.source_not_null_warehouse_customers_customer_id.ae7452c4c6: BEGIN
[0m22:38:18.649255 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:38:18.672846 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m22:38:18.673849 [debug] [Thread-1 (]: Using postgres connection "test.dbt_idx.source_not_null_warehouse_customers_customer_id.ae7452c4c6"
[0m22:38:18.674831 [debug] [Thread-1 (]: On test.dbt_idx.source_not_null_warehouse_customers_customer_id.ae7452c4c6: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "test.dbt_idx.source_not_null_warehouse_customers_customer_id.ae7452c4c6"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select customer_id
from "IDX-Stock"."warehouse"."customers"
where customer_id is null



      
    ) dbt_internal_test
[0m22:38:18.676831 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m22:38:18.679832 [debug] [Thread-1 (]: Timing info for test.dbt_idx.source_not_null_warehouse_customers_customer_id.ae7452c4c6 (execute): 22:38:18.637479 => 22:38:18.678830
[0m22:38:18.680832 [debug] [Thread-1 (]: On test.dbt_idx.source_not_null_warehouse_customers_customer_id.ae7452c4c6: ROLLBACK
[0m22:38:18.682978 [debug] [Thread-1 (]: On test.dbt_idx.source_not_null_warehouse_customers_customer_id.ae7452c4c6: Close
[0m22:38:18.684839 [info ] [Thread-1 (]: 5 of 9 PASS source_not_null_warehouse_customers_customer_id .................... [[32mPASS[0m in 0.06s]
[0m22:38:18.686832 [debug] [Thread-1 (]: Finished running node test.dbt_idx.source_not_null_warehouse_customers_customer_id.ae7452c4c6
[0m22:38:18.687839 [debug] [Thread-1 (]: Began running node test.dbt_idx.source_not_null_warehouse_orders_order_id.c85a1f0b76
[0m22:38:18.688832 [info ] [Thread-1 (]: 6 of 9 START test source_not_null_warehouse_orders_order_id .................... [RUN]
[0m22:38:18.690830 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_idx.source_not_null_warehouse_customers_customer_id.ae7452c4c6, now test.dbt_idx.source_not_null_warehouse_orders_order_id.c85a1f0b76)
[0m22:38:18.691834 [debug] [Thread-1 (]: Began compiling node test.dbt_idx.source_not_null_warehouse_orders_order_id.c85a1f0b76
[0m22:38:18.698320 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_idx.source_not_null_warehouse_orders_order_id.c85a1f0b76"
[0m22:38:18.705534 [debug] [Thread-1 (]: Timing info for test.dbt_idx.source_not_null_warehouse_orders_order_id.c85a1f0b76 (compile): 22:38:18.691834 => 22:38:18.705534
[0m22:38:18.706508 [debug] [Thread-1 (]: Began executing node test.dbt_idx.source_not_null_warehouse_orders_order_id.c85a1f0b76
[0m22:38:18.709505 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_idx.source_not_null_warehouse_orders_order_id.c85a1f0b76"
[0m22:38:18.716038 [debug] [Thread-1 (]: Using postgres connection "test.dbt_idx.source_not_null_warehouse_orders_order_id.c85a1f0b76"
[0m22:38:18.717040 [debug] [Thread-1 (]: On test.dbt_idx.source_not_null_warehouse_orders_order_id.c85a1f0b76: BEGIN
[0m22:38:18.718042 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:38:18.740576 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m22:38:18.741557 [debug] [Thread-1 (]: Using postgres connection "test.dbt_idx.source_not_null_warehouse_orders_order_id.c85a1f0b76"
[0m22:38:18.742562 [debug] [Thread-1 (]: On test.dbt_idx.source_not_null_warehouse_orders_order_id.c85a1f0b76: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "test.dbt_idx.source_not_null_warehouse_orders_order_id.c85a1f0b76"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select order_id
from "IDX-Stock"."warehouse"."orders"
where order_id is null



      
    ) dbt_internal_test
[0m22:38:18.745557 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m22:38:18.747558 [debug] [Thread-1 (]: Timing info for test.dbt_idx.source_not_null_warehouse_orders_order_id.c85a1f0b76 (execute): 22:38:18.707527 => 22:38:18.747558
[0m22:38:18.748582 [debug] [Thread-1 (]: On test.dbt_idx.source_not_null_warehouse_orders_order_id.c85a1f0b76: ROLLBACK
[0m22:38:18.750560 [debug] [Thread-1 (]: On test.dbt_idx.source_not_null_warehouse_orders_order_id.c85a1f0b76: Close
[0m22:38:18.752562 [info ] [Thread-1 (]: 6 of 9 PASS source_not_null_warehouse_orders_order_id .......................... [[32mPASS[0m in 0.06s]
[0m22:38:18.755091 [debug] [Thread-1 (]: Finished running node test.dbt_idx.source_not_null_warehouse_orders_order_id.c85a1f0b76
[0m22:38:18.756104 [debug] [Thread-1 (]: Began running node test.dbt_idx.source_relationships_warehouse_orders_cust_id__customer_id__source_warehouse_customers_.d3f9188fc2
[0m22:38:18.757102 [info ] [Thread-1 (]: 7 of 9 START test source_relationships_warehouse_orders_cust_id__customer_id__source_warehouse_customers_  [RUN]
[0m22:38:18.759100 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_idx.source_not_null_warehouse_orders_order_id.c85a1f0b76, now test.dbt_idx.source_relationships_warehouse_orders_cust_id__customer_id__source_warehouse_customers_.d3f9188fc2)
[0m22:38:18.760101 [debug] [Thread-1 (]: Began compiling node test.dbt_idx.source_relationships_warehouse_orders_cust_id__customer_id__source_warehouse_customers_.d3f9188fc2
[0m22:38:18.770100 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_idx.source_relationships_warehouse_orders_cust_id__customer_id__source_warehouse_customers_.d3f9188fc2"
[0m22:38:18.778183 [debug] [Thread-1 (]: Timing info for test.dbt_idx.source_relationships_warehouse_orders_cust_id__customer_id__source_warehouse_customers_.d3f9188fc2 (compile): 22:38:18.760101 => 22:38:18.777184
[0m22:38:18.779187 [debug] [Thread-1 (]: Began executing node test.dbt_idx.source_relationships_warehouse_orders_cust_id__customer_id__source_warehouse_customers_.d3f9188fc2
[0m22:38:18.782183 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_idx.source_relationships_warehouse_orders_cust_id__customer_id__source_warehouse_customers_.d3f9188fc2"
[0m22:38:18.789260 [debug] [Thread-1 (]: Using postgres connection "test.dbt_idx.source_relationships_warehouse_orders_cust_id__customer_id__source_warehouse_customers_.d3f9188fc2"
[0m22:38:18.790189 [debug] [Thread-1 (]: On test.dbt_idx.source_relationships_warehouse_orders_cust_id__customer_id__source_warehouse_customers_.d3f9188fc2: BEGIN
[0m22:38:18.791187 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:38:18.812509 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m22:38:18.814510 [debug] [Thread-1 (]: Using postgres connection "test.dbt_idx.source_relationships_warehouse_orders_cust_id__customer_id__source_warehouse_customers_.d3f9188fc2"
[0m22:38:18.814510 [debug] [Thread-1 (]: On test.dbt_idx.source_relationships_warehouse_orders_cust_id__customer_id__source_warehouse_customers_.d3f9188fc2: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "test.dbt_idx.source_relationships_warehouse_orders_cust_id__customer_id__source_warehouse_customers_.d3f9188fc2"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select cust_id as from_field
    from "IDX-Stock"."warehouse"."orders"
    where cust_id is not null
),

parent as (
    select customer_id as to_field
    from "IDX-Stock"."warehouse"."customers"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m22:38:18.818612 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m22:38:18.820647 [debug] [Thread-1 (]: Timing info for test.dbt_idx.source_relationships_warehouse_orders_cust_id__customer_id__source_warehouse_customers_.d3f9188fc2 (execute): 22:38:18.780188 => 22:38:18.820647
[0m22:38:18.821616 [debug] [Thread-1 (]: On test.dbt_idx.source_relationships_warehouse_orders_cust_id__customer_id__source_warehouse_customers_.d3f9188fc2: ROLLBACK
[0m22:38:18.824614 [debug] [Thread-1 (]: On test.dbt_idx.source_relationships_warehouse_orders_cust_id__customer_id__source_warehouse_customers_.d3f9188fc2: Close
[0m22:38:18.826625 [info ] [Thread-1 (]: 7 of 9 PASS source_relationships_warehouse_orders_cust_id__customer_id__source_warehouse_customers_  [[32mPASS[0m in 0.07s]
[0m22:38:18.828620 [debug] [Thread-1 (]: Finished running node test.dbt_idx.source_relationships_warehouse_orders_cust_id__customer_id__source_warehouse_customers_.d3f9188fc2
[0m22:38:18.829614 [debug] [Thread-1 (]: Began running node test.dbt_idx.source_unique_warehouse_orders_order_id.839fb43d0f
[0m22:38:18.830672 [info ] [Thread-1 (]: 8 of 9 START test source_unique_warehouse_orders_order_id ...................... [RUN]
[0m22:38:18.832649 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_idx.source_relationships_warehouse_orders_cust_id__customer_id__source_warehouse_customers_.d3f9188fc2, now test.dbt_idx.source_unique_warehouse_orders_order_id.839fb43d0f)
[0m22:38:18.832649 [debug] [Thread-1 (]: Began compiling node test.dbt_idx.source_unique_warehouse_orders_order_id.839fb43d0f
[0m22:38:18.840232 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_idx.source_unique_warehouse_orders_order_id.839fb43d0f"
[0m22:38:18.848197 [debug] [Thread-1 (]: Timing info for test.dbt_idx.source_unique_warehouse_orders_order_id.839fb43d0f (compile): 22:38:18.834189 => 22:38:18.847195
[0m22:38:18.849196 [debug] [Thread-1 (]: Began executing node test.dbt_idx.source_unique_warehouse_orders_order_id.839fb43d0f
[0m22:38:18.851781 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_idx.source_unique_warehouse_orders_order_id.839fb43d0f"
[0m22:38:18.858750 [debug] [Thread-1 (]: Using postgres connection "test.dbt_idx.source_unique_warehouse_orders_order_id.839fb43d0f"
[0m22:38:18.859772 [debug] [Thread-1 (]: On test.dbt_idx.source_unique_warehouse_orders_order_id.839fb43d0f: BEGIN
[0m22:38:18.860756 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:38:18.884255 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m22:38:18.885286 [debug] [Thread-1 (]: Using postgres connection "test.dbt_idx.source_unique_warehouse_orders_order_id.839fb43d0f"
[0m22:38:18.886264 [debug] [Thread-1 (]: On test.dbt_idx.source_unique_warehouse_orders_order_id.839fb43d0f: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "test.dbt_idx.source_unique_warehouse_orders_order_id.839fb43d0f"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    order_id as unique_field,
    count(*) as n_records

from "IDX-Stock"."warehouse"."orders"
where order_id is not null
group by order_id
having count(*) > 1



      
    ) dbt_internal_test
[0m22:38:18.889316 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m22:38:18.892297 [debug] [Thread-1 (]: Timing info for test.dbt_idx.source_unique_warehouse_orders_order_id.839fb43d0f (execute): 22:38:18.849196 => 22:38:18.891298
[0m22:38:18.893265 [debug] [Thread-1 (]: On test.dbt_idx.source_unique_warehouse_orders_order_id.839fb43d0f: ROLLBACK
[0m22:38:18.895263 [debug] [Thread-1 (]: On test.dbt_idx.source_unique_warehouse_orders_order_id.839fb43d0f: Close
[0m22:38:18.896820 [info ] [Thread-1 (]: 8 of 9 PASS source_unique_warehouse_orders_order_id ............................ [[32mPASS[0m in 0.07s]
[0m22:38:18.898826 [debug] [Thread-1 (]: Finished running node test.dbt_idx.source_unique_warehouse_orders_order_id.839fb43d0f
[0m22:38:18.899815 [debug] [Thread-1 (]: Began running node test.dbt_idx.unique_customer_orders_status_order_id.b7a45e83ee
[0m22:38:18.901060 [info ] [Thread-1 (]: 9 of 9 START test unique_customer_orders_status_order_id ....................... [RUN]
[0m22:38:18.903093 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_idx.source_unique_warehouse_orders_order_id.839fb43d0f, now test.dbt_idx.unique_customer_orders_status_order_id.b7a45e83ee)
[0m22:38:18.904070 [debug] [Thread-1 (]: Began compiling node test.dbt_idx.unique_customer_orders_status_order_id.b7a45e83ee
[0m22:38:18.909095 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_idx.unique_customer_orders_status_order_id.b7a45e83ee"
[0m22:38:18.915087 [debug] [Thread-1 (]: Timing info for test.dbt_idx.unique_customer_orders_status_order_id.b7a45e83ee (compile): 22:38:18.904070 => 22:38:18.915087
[0m22:38:18.916628 [debug] [Thread-1 (]: Began executing node test.dbt_idx.unique_customer_orders_status_order_id.b7a45e83ee
[0m22:38:18.919669 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_idx.unique_customer_orders_status_order_id.b7a45e83ee"
[0m22:38:18.926640 [debug] [Thread-1 (]: Using postgres connection "test.dbt_idx.unique_customer_orders_status_order_id.b7a45e83ee"
[0m22:38:18.927674 [debug] [Thread-1 (]: On test.dbt_idx.unique_customer_orders_status_order_id.b7a45e83ee: BEGIN
[0m22:38:18.928636 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:38:18.952151 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m22:38:18.953182 [debug] [Thread-1 (]: Using postgres connection "test.dbt_idx.unique_customer_orders_status_order_id.b7a45e83ee"
[0m22:38:18.954658 [debug] [Thread-1 (]: On test.dbt_idx.unique_customer_orders_status_order_id.b7a45e83ee: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "test.dbt_idx.unique_customer_orders_status_order_id.b7a45e83ee"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    order_id as unique_field,
    count(*) as n_records

from "IDX-Stock"."warehouse"."customer_orders_status"
where order_id is not null
group by order_id
having count(*) > 1



      
    ) dbt_internal_test
[0m22:38:18.958721 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m22:38:18.960701 [debug] [Thread-1 (]: Timing info for test.dbt_idx.unique_customer_orders_status_order_id.b7a45e83ee (execute): 22:38:18.917637 => 22:38:18.960701
[0m22:38:18.961700 [debug] [Thread-1 (]: On test.dbt_idx.unique_customer_orders_status_order_id.b7a45e83ee: ROLLBACK
[0m22:38:18.963673 [debug] [Thread-1 (]: On test.dbt_idx.unique_customer_orders_status_order_id.b7a45e83ee: Close
[0m22:38:18.965760 [info ] [Thread-1 (]: 9 of 9 PASS unique_customer_orders_status_order_id ............................. [[32mPASS[0m in 0.06s]
[0m22:38:18.967667 [debug] [Thread-1 (]: Finished running node test.dbt_idx.unique_customer_orders_status_order_id.b7a45e83ee
[0m22:38:18.970687 [debug] [MainThread]: Using postgres connection "master"
[0m22:38:18.971669 [debug] [MainThread]: On master: BEGIN
[0m22:38:18.972693 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:38:18.994226 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m22:38:18.995242 [debug] [MainThread]: On master: COMMIT
[0m22:38:18.995242 [debug] [MainThread]: Using postgres connection "master"
[0m22:38:18.996230 [debug] [MainThread]: On master: COMMIT
[0m22:38:18.998343 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m22:38:19.000894 [debug] [MainThread]: On master: Close
[0m22:38:19.002903 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:38:19.003895 [debug] [MainThread]: Connection 'list_IDX-Stock_snapshots' was properly closed.
[0m22:38:19.004896 [debug] [MainThread]: Connection 'test.dbt_idx.unique_customer_orders_status_order_id.b7a45e83ee' was properly closed.
[0m22:38:19.006260 [info ] [MainThread]: 
[0m22:38:19.006894 [info ] [MainThread]: Finished running 9 tests in 0 hours 0 minutes and 1.09 seconds (1.09s).
[0m22:38:19.010895 [debug] [MainThread]: Command end result
[0m22:38:19.031014 [info ] [MainThread]: 
[0m22:38:19.031014 [info ] [MainThread]: [32mCompleted successfully[0m
[0m22:38:19.032556 [info ] [MainThread]: 
[0m22:38:19.033598 [info ] [MainThread]: Done. PASS=9 WARN=0 ERROR=0 SKIP=0 TOTAL=9
[0m22:38:19.034563 [debug] [MainThread]: Command `dbt test` succeeded at 22:38:19.034563 after 1.60 seconds
[0m22:38:19.035599 [debug] [MainThread]: Flushing usage events


============================== 22:38:29.954496 | 17cfe8fd-d22b-474e-807e-8ab64b90f1f7 ==============================
[0m22:38:29.954496 [info ] [MainThread]: Running with dbt=1.6.1
[0m22:38:29.959459 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'D:\\00 Project\\00 My Project\\IdeaProjects\\Py-DBT-IDX\\logs', 'version_check': 'True', 'profiles_dir': 'D:\\00 Project\\00 My Project\\IdeaProjects\\Py-DBT-IDX', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt docs generate', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'False'}
[0m22:38:30.086615 [info ] [MainThread]: Registered adapter: postgres=1.6.1
[0m22:38:30.096583 [debug] [MainThread]: checksum: efe19d9f5b93d1a98cc804fbfcdb6b3aced98b974af664946fee1cde8837deb7, vars: {}, profile: , target: , version: 1.6.1
[0m22:38:30.246950 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m22:38:30.247950 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m22:38:30.275939 [info ] [MainThread]: Found 1 snapshot, 9 tests, 7 models, 3 sources, 0 exposures, 0 metrics, 349 macros, 0 groups, 0 semantic models
[0m22:38:30.278934 [info ] [MainThread]: 
[0m22:38:30.279935 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m22:38:30.283935 [debug] [ThreadPool]: Acquiring new postgres connection 'list_IDX-Stock_warehouse'
[0m22:38:30.297143 [debug] [ThreadPool]: Using postgres connection "list_IDX-Stock_warehouse"
[0m22:38:30.298105 [debug] [ThreadPool]: On list_IDX-Stock_warehouse: BEGIN
[0m22:38:30.299106 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:38:30.336780 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m22:38:30.337789 [debug] [ThreadPool]: Using postgres connection "list_IDX-Stock_warehouse"
[0m22:38:30.338780 [debug] [ThreadPool]: On list_IDX-Stock_warehouse: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "connection_name": "list_IDX-Stock_warehouse"} */
select
      'IDX-Stock' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'warehouse'
    union all
    select
      'IDX-Stock' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'warehouse'
    union all
    select
      'IDX-Stock' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'warehouse'
  
[0m22:38:30.343789 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.0 seconds
[0m22:38:30.346297 [debug] [ThreadPool]: On list_IDX-Stock_warehouse: ROLLBACK
[0m22:38:30.349304 [debug] [ThreadPool]: On list_IDX-Stock_warehouse: Close
[0m22:38:30.352307 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_IDX-Stock_warehouse, now list_IDX-Stock_snapshots)
[0m22:38:30.358538 [debug] [ThreadPool]: Using postgres connection "list_IDX-Stock_snapshots"
[0m22:38:30.360538 [debug] [ThreadPool]: On list_IDX-Stock_snapshots: BEGIN
[0m22:38:30.361539 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:38:30.385624 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m22:38:30.386596 [debug] [ThreadPool]: Using postgres connection "list_IDX-Stock_snapshots"
[0m22:38:30.387596 [debug] [ThreadPool]: On list_IDX-Stock_snapshots: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "connection_name": "list_IDX-Stock_snapshots"} */
select
      'IDX-Stock' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'snapshots'
    union all
    select
      'IDX-Stock' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'snapshots'
    union all
    select
      'IDX-Stock' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'snapshots'
  
[0m22:38:30.393107 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.0 seconds
[0m22:38:30.395117 [debug] [ThreadPool]: On list_IDX-Stock_snapshots: ROLLBACK
[0m22:38:30.397128 [debug] [ThreadPool]: On list_IDX-Stock_snapshots: Close
[0m22:38:30.406646 [debug] [MainThread]: Using postgres connection "master"
[0m22:38:30.407650 [debug] [MainThread]: On master: BEGIN
[0m22:38:30.408649 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:38:30.437175 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m22:38:30.438174 [debug] [MainThread]: Using postgres connection "master"
[0m22:38:30.440173 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m22:38:30.448349 [debug] [MainThread]: SQL status: SELECT 6 in 0.0 seconds
[0m22:38:30.451657 [debug] [MainThread]: On master: ROLLBACK
[0m22:38:30.454649 [debug] [MainThread]: On master: Close
[0m22:38:30.456647 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m22:38:30.458348 [info ] [MainThread]: 
[0m22:38:30.465924 [debug] [Thread-1 (]: Began running node model.dbt_idx.stg_eltool__customers
[0m22:38:30.466935 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.dbt_idx.stg_eltool__customers'
[0m22:38:30.467923 [debug] [Thread-1 (]: Began compiling node model.dbt_idx.stg_eltool__customers
[0m22:38:30.478941 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_idx.stg_eltool__customers"
[0m22:38:30.487032 [debug] [Thread-1 (]: Timing info for model.dbt_idx.stg_eltool__customers (compile): 22:38:30.469924 => 22:38:30.487032
[0m22:38:30.488036 [debug] [Thread-1 (]: Began executing node model.dbt_idx.stg_eltool__customers
[0m22:38:30.490032 [debug] [Thread-1 (]: Timing info for model.dbt_idx.stg_eltool__customers (execute): 22:38:30.489031 => 22:38:30.489031
[0m22:38:30.492045 [debug] [Thread-1 (]: Finished running node model.dbt_idx.stg_eltool__customers
[0m22:38:30.493032 [debug] [Thread-1 (]: Began running node model.dbt_idx.stg_eltool__orders
[0m22:38:30.494030 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_idx.stg_eltool__customers, now model.dbt_idx.stg_eltool__orders)
[0m22:38:30.495199 [debug] [Thread-1 (]: Began compiling node model.dbt_idx.stg_eltool__orders
[0m22:38:30.499132 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_idx.stg_eltool__orders"
[0m22:38:30.513161 [debug] [Thread-1 (]: Timing info for model.dbt_idx.stg_eltool__orders (compile): 22:38:30.496107 => 22:38:30.512167
[0m22:38:30.514130 [debug] [Thread-1 (]: Began executing node model.dbt_idx.stg_eltool__orders
[0m22:38:30.515143 [debug] [Thread-1 (]: Timing info for model.dbt_idx.stg_eltool__orders (execute): 22:38:30.514130 => 22:38:30.514130
[0m22:38:30.517136 [debug] [Thread-1 (]: Finished running node model.dbt_idx.stg_eltool__orders
[0m22:38:30.518139 [debug] [Thread-1 (]: Began running node model.dbt_idx.stg_eltool__state
[0m22:38:30.520134 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_idx.stg_eltool__orders, now model.dbt_idx.stg_eltool__state)
[0m22:38:30.521155 [debug] [Thread-1 (]: Began compiling node model.dbt_idx.stg_eltool__state
[0m22:38:30.524660 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_idx.stg_eltool__state"
[0m22:38:30.532686 [debug] [Thread-1 (]: Timing info for model.dbt_idx.stg_eltool__state (compile): 22:38:30.522139 => 22:38:30.532686
[0m22:38:30.533710 [debug] [Thread-1 (]: Began executing node model.dbt_idx.stg_eltool__state
[0m22:38:30.534660 [debug] [Thread-1 (]: Timing info for model.dbt_idx.stg_eltool__state (execute): 22:38:30.534660 => 22:38:30.534660
[0m22:38:30.535667 [debug] [Thread-1 (]: Finished running node model.dbt_idx.stg_eltool__state
[0m22:38:30.536664 [debug] [Thread-1 (]: Began running node snapshot.dbt_idx.customers_snapshot
[0m22:38:30.538669 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_idx.stg_eltool__state, now snapshot.dbt_idx.customers_snapshot)
[0m22:38:30.539663 [debug] [Thread-1 (]: Began compiling node snapshot.dbt_idx.customers_snapshot
[0m22:38:30.545196 [debug] [Thread-1 (]: Timing info for snapshot.dbt_idx.customers_snapshot (compile): 22:38:30.540668 => 22:38:30.545196
[0m22:38:30.546195 [debug] [Thread-1 (]: Began executing node snapshot.dbt_idx.customers_snapshot
[0m22:38:30.548195 [debug] [Thread-1 (]: Timing info for snapshot.dbt_idx.customers_snapshot (execute): 22:38:30.547196 => 22:38:30.547196
[0m22:38:30.550210 [debug] [Thread-1 (]: Finished running node snapshot.dbt_idx.customers_snapshot
[0m22:38:30.551189 [debug] [Thread-1 (]: Began running node test.dbt_idx.source_not_null_warehouse_customers_customer_id.ae7452c4c6
[0m22:38:30.553204 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly snapshot.dbt_idx.customers_snapshot, now test.dbt_idx.source_not_null_warehouse_customers_customer_id.ae7452c4c6)
[0m22:38:30.554226 [debug] [Thread-1 (]: Began compiling node test.dbt_idx.source_not_null_warehouse_customers_customer_id.ae7452c4c6
[0m22:38:30.574620 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_idx.source_not_null_warehouse_customers_customer_id.ae7452c4c6"
[0m22:38:30.584584 [debug] [Thread-1 (]: Timing info for test.dbt_idx.source_not_null_warehouse_customers_customer_id.ae7452c4c6 (compile): 22:38:30.555193 => 22:38:30.583547
[0m22:38:30.585573 [debug] [Thread-1 (]: Began executing node test.dbt_idx.source_not_null_warehouse_customers_customer_id.ae7452c4c6
[0m22:38:30.586550 [debug] [Thread-1 (]: Timing info for test.dbt_idx.source_not_null_warehouse_customers_customer_id.ae7452c4c6 (execute): 22:38:30.586550 => 22:38:30.586550
[0m22:38:30.589552 [debug] [Thread-1 (]: Finished running node test.dbt_idx.source_not_null_warehouse_customers_customer_id.ae7452c4c6
[0m22:38:30.590549 [debug] [Thread-1 (]: Began running node test.dbt_idx.source_not_null_warehouse_orders_order_id.c85a1f0b76
[0m22:38:30.592550 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_idx.source_not_null_warehouse_customers_customer_id.ae7452c4c6, now test.dbt_idx.source_not_null_warehouse_orders_order_id.c85a1f0b76)
[0m22:38:30.593547 [debug] [Thread-1 (]: Began compiling node test.dbt_idx.source_not_null_warehouse_orders_order_id.c85a1f0b76
[0m22:38:30.600887 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_idx.source_not_null_warehouse_orders_order_id.c85a1f0b76"
[0m22:38:30.608891 [debug] [Thread-1 (]: Timing info for test.dbt_idx.source_not_null_warehouse_orders_order_id.c85a1f0b76 (compile): 22:38:30.594554 => 22:38:30.608891
[0m22:38:30.609887 [debug] [Thread-1 (]: Began executing node test.dbt_idx.source_not_null_warehouse_orders_order_id.c85a1f0b76
[0m22:38:30.610918 [debug] [Thread-1 (]: Timing info for test.dbt_idx.source_not_null_warehouse_orders_order_id.c85a1f0b76 (execute): 22:38:30.610918 => 22:38:30.610918
[0m22:38:30.613152 [debug] [Thread-1 (]: Finished running node test.dbt_idx.source_not_null_warehouse_orders_order_id.c85a1f0b76
[0m22:38:30.614182 [debug] [Thread-1 (]: Began running node test.dbt_idx.source_relationships_warehouse_orders_cust_id__customer_id__source_warehouse_customers_.d3f9188fc2
[0m22:38:30.616155 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_idx.source_not_null_warehouse_orders_order_id.c85a1f0b76, now test.dbt_idx.source_relationships_warehouse_orders_cust_id__customer_id__source_warehouse_customers_.d3f9188fc2)
[0m22:38:30.617147 [debug] [Thread-1 (]: Began compiling node test.dbt_idx.source_relationships_warehouse_orders_cust_id__customer_id__source_warehouse_customers_.d3f9188fc2
[0m22:38:30.643344 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_idx.source_relationships_warehouse_orders_cust_id__customer_id__source_warehouse_customers_.d3f9188fc2"
[0m22:38:30.657056 [debug] [Thread-1 (]: Timing info for test.dbt_idx.source_relationships_warehouse_orders_cust_id__customer_id__source_warehouse_customers_.d3f9188fc2 (compile): 22:38:30.619155 => 22:38:30.655453
[0m22:38:30.658511 [debug] [Thread-1 (]: Began executing node test.dbt_idx.source_relationships_warehouse_orders_cust_id__customer_id__source_warehouse_customers_.d3f9188fc2
[0m22:38:30.662107 [debug] [Thread-1 (]: Timing info for test.dbt_idx.source_relationships_warehouse_orders_cust_id__customer_id__source_warehouse_customers_.d3f9188fc2 (execute): 22:38:30.660025 => 22:38:30.660025
[0m22:38:30.665692 [debug] [Thread-1 (]: Finished running node test.dbt_idx.source_relationships_warehouse_orders_cust_id__customer_id__source_warehouse_customers_.d3f9188fc2
[0m22:38:30.667704 [debug] [Thread-1 (]: Began running node test.dbt_idx.source_unique_warehouse_orders_order_id.839fb43d0f
[0m22:38:30.669703 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_idx.source_relationships_warehouse_orders_cust_id__customer_id__source_warehouse_customers_.d3f9188fc2, now test.dbt_idx.source_unique_warehouse_orders_order_id.839fb43d0f)
[0m22:38:30.671702 [debug] [Thread-1 (]: Began compiling node test.dbt_idx.source_unique_warehouse_orders_order_id.839fb43d0f
[0m22:38:30.694062 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_idx.source_unique_warehouse_orders_order_id.839fb43d0f"
[0m22:38:30.707282 [debug] [Thread-1 (]: Timing info for test.dbt_idx.source_unique_warehouse_orders_order_id.839fb43d0f (compile): 22:38:30.673284 => 22:38:30.706282
[0m22:38:30.708278 [debug] [Thread-1 (]: Began executing node test.dbt_idx.source_unique_warehouse_orders_order_id.839fb43d0f
[0m22:38:30.711304 [debug] [Thread-1 (]: Timing info for test.dbt_idx.source_unique_warehouse_orders_order_id.839fb43d0f (execute): 22:38:30.710278 => 22:38:30.710278
[0m22:38:30.714340 [debug] [Thread-1 (]: Finished running node test.dbt_idx.source_unique_warehouse_orders_order_id.839fb43d0f
[0m22:38:30.715865 [debug] [Thread-1 (]: Began running node model.dbt_idx.fact_orders
[0m22:38:30.719405 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_idx.source_unique_warehouse_orders_order_id.839fb43d0f, now model.dbt_idx.fact_orders)
[0m22:38:30.721496 [debug] [Thread-1 (]: Began compiling node model.dbt_idx.fact_orders
[0m22:38:30.731586 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_idx.fact_orders"
[0m22:38:30.742262 [debug] [Thread-1 (]: Timing info for model.dbt_idx.fact_orders (compile): 22:38:30.722510 => 22:38:30.741261
[0m22:38:30.743262 [debug] [Thread-1 (]: Began executing node model.dbt_idx.fact_orders
[0m22:38:30.743262 [debug] [Thread-1 (]: Timing info for model.dbt_idx.fact_orders (execute): 22:38:30.743262 => 22:38:30.743262
[0m22:38:30.745801 [debug] [Thread-1 (]: Finished running node model.dbt_idx.fact_orders
[0m22:38:30.746832 [debug] [Thread-1 (]: Began running node model.dbt_idx.stg_eltool__customers_snapshots
[0m22:38:30.747852 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_idx.fact_orders, now model.dbt_idx.stg_eltool__customers_snapshots)
[0m22:38:30.748383 [debug] [Thread-1 (]: Began compiling node model.dbt_idx.stg_eltool__customers_snapshots
[0m22:38:30.752431 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_idx.stg_eltool__customers_snapshots"
[0m22:38:30.760524 [debug] [Thread-1 (]: Timing info for model.dbt_idx.stg_eltool__customers_snapshots (compile): 22:38:30.749416 => 22:38:30.759505
[0m22:38:30.761509 [debug] [Thread-1 (]: Began executing node model.dbt_idx.stg_eltool__customers_snapshots
[0m22:38:30.762517 [debug] [Thread-1 (]: Timing info for model.dbt_idx.stg_eltool__customers_snapshots (execute): 22:38:30.762517 => 22:38:30.762517
[0m22:38:30.764506 [debug] [Thread-1 (]: Finished running node model.dbt_idx.stg_eltool__customers_snapshots
[0m22:38:30.765507 [debug] [Thread-1 (]: Began running node model.dbt_idx.dim_customers
[0m22:38:30.767504 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_idx.stg_eltool__customers_snapshots, now model.dbt_idx.dim_customers)
[0m22:38:30.768504 [debug] [Thread-1 (]: Began compiling node model.dbt_idx.dim_customers
[0m22:38:30.773634 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_idx.dim_customers"
[0m22:38:30.781167 [debug] [Thread-1 (]: Timing info for model.dbt_idx.dim_customers (compile): 22:38:30.769526 => 22:38:30.780196
[0m22:38:30.782164 [debug] [Thread-1 (]: Began executing node model.dbt_idx.dim_customers
[0m22:38:30.783161 [debug] [Thread-1 (]: Timing info for model.dbt_idx.dim_customers (execute): 22:38:30.782164 => 22:38:30.783161
[0m22:38:30.784195 [debug] [Thread-1 (]: Finished running node model.dbt_idx.dim_customers
[0m22:38:30.785195 [debug] [Thread-1 (]: Began running node test.dbt_idx.not_null_stg_eltool__customers_snapshots_customer_id.ea4fc4ca86
[0m22:38:30.786194 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_idx.dim_customers, now test.dbt_idx.not_null_stg_eltool__customers_snapshots_customer_id.ea4fc4ca86)
[0m22:38:30.787194 [debug] [Thread-1 (]: Began compiling node test.dbt_idx.not_null_stg_eltool__customers_snapshots_customer_id.ea4fc4ca86
[0m22:38:30.795148 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_idx.not_null_stg_eltool__customers_snapshots_customer_id.ea4fc4ca86"
[0m22:38:30.804123 [debug] [Thread-1 (]: Timing info for test.dbt_idx.not_null_stg_eltool__customers_snapshots_customer_id.ea4fc4ca86 (compile): 22:38:30.788597 => 22:38:30.803123
[0m22:38:30.805121 [debug] [Thread-1 (]: Began executing node test.dbt_idx.not_null_stg_eltool__customers_snapshots_customer_id.ea4fc4ca86
[0m22:38:30.805121 [debug] [Thread-1 (]: Timing info for test.dbt_idx.not_null_stg_eltool__customers_snapshots_customer_id.ea4fc4ca86 (execute): 22:38:30.805121 => 22:38:30.805121
[0m22:38:30.806712 [debug] [Thread-1 (]: Finished running node test.dbt_idx.not_null_stg_eltool__customers_snapshots_customer_id.ea4fc4ca86
[0m22:38:30.807738 [debug] [Thread-1 (]: Began running node model.dbt_idx.customer_orders_status
[0m22:38:30.809745 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_idx.not_null_stg_eltool__customers_snapshots_customer_id.ea4fc4ca86, now model.dbt_idx.customer_orders_status)
[0m22:38:30.809745 [debug] [Thread-1 (]: Began compiling node model.dbt_idx.customer_orders_status
[0m22:38:30.814478 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_idx.customer_orders_status"
[0m22:38:30.821478 [debug] [Thread-1 (]: Timing info for model.dbt_idx.customer_orders_status (compile): 22:38:30.809745 => 22:38:30.821478
[0m22:38:30.823455 [debug] [Thread-1 (]: Began executing node model.dbt_idx.customer_orders_status
[0m22:38:30.823455 [debug] [Thread-1 (]: Timing info for model.dbt_idx.customer_orders_status (execute): 22:38:30.823455 => 22:38:30.823455
[0m22:38:30.826492 [debug] [Thread-1 (]: Finished running node model.dbt_idx.customer_orders_status
[0m22:38:30.827491 [debug] [Thread-1 (]: Began running node test.dbt_idx.assert_customer_dimension_has_no_row_loss.sql
[0m22:38:30.830525 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_idx.customer_orders_status, now test.dbt_idx.assert_customer_dimension_has_no_row_loss.sql)
[0m22:38:30.831531 [debug] [Thread-1 (]: Began compiling node test.dbt_idx.assert_customer_dimension_has_no_row_loss.sql
[0m22:38:30.840491 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_idx.assert_customer_dimension_has_no_row_loss.sql"
[0m22:38:30.849536 [debug] [Thread-1 (]: Timing info for test.dbt_idx.assert_customer_dimension_has_no_row_loss.sql (compile): 22:38:30.832533 => 22:38:30.848574
[0m22:38:30.850560 [debug] [Thread-1 (]: Began executing node test.dbt_idx.assert_customer_dimension_has_no_row_loss.sql
[0m22:38:30.851571 [debug] [Thread-1 (]: Timing info for test.dbt_idx.assert_customer_dimension_has_no_row_loss.sql (execute): 22:38:30.851571 => 22:38:30.851571
[0m22:38:30.853535 [debug] [Thread-1 (]: Finished running node test.dbt_idx.assert_customer_dimension_has_no_row_loss.sql
[0m22:38:30.854534 [debug] [Thread-1 (]: Began running node test.dbt_idx.accepted_values_customer_orders_status_order_status__delivered__invoiced__shipped__processing__canceled__unavailable.ea8c296d27
[0m22:38:30.855535 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_idx.assert_customer_dimension_has_no_row_loss.sql, now test.dbt_idx.accepted_values_customer_orders_status_order_status__delivered__invoiced__shipped__processing__canceled__unavailable.ea8c296d27)
[0m22:38:30.856536 [debug] [Thread-1 (]: Began compiling node test.dbt_idx.accepted_values_customer_orders_status_order_status__delivered__invoiced__shipped__processing__canceled__unavailable.ea8c296d27
[0m22:38:30.869578 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_idx.accepted_values_customer_orders_status_order_status__delivered__invoiced__shipped__processing__canceled__unavailable.ea8c296d27"
[0m22:38:30.877594 [debug] [Thread-1 (]: Timing info for test.dbt_idx.accepted_values_customer_orders_status_order_status__delivered__invoiced__shipped__processing__canceled__unavailable.ea8c296d27 (compile): 22:38:30.856536 => 22:38:30.876579
[0m22:38:30.878577 [debug] [Thread-1 (]: Began executing node test.dbt_idx.accepted_values_customer_orders_status_order_status__delivered__invoiced__shipped__processing__canceled__unavailable.ea8c296d27
[0m22:38:30.879580 [debug] [Thread-1 (]: Timing info for test.dbt_idx.accepted_values_customer_orders_status_order_status__delivered__invoiced__shipped__processing__canceled__unavailable.ea8c296d27 (execute): 22:38:30.879580 => 22:38:30.879580
[0m22:38:30.880831 [debug] [Thread-1 (]: Finished running node test.dbt_idx.accepted_values_customer_orders_status_order_status__delivered__invoiced__shipped__processing__canceled__unavailable.ea8c296d27
[0m22:38:30.882795 [debug] [Thread-1 (]: Began running node test.dbt_idx.not_null_customer_orders_status_customer_id.3915c814eb
[0m22:38:30.883831 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_idx.accepted_values_customer_orders_status_order_status__delivered__invoiced__shipped__processing__canceled__unavailable.ea8c296d27, now test.dbt_idx.not_null_customer_orders_status_customer_id.3915c814eb)
[0m22:38:30.884811 [debug] [Thread-1 (]: Began compiling node test.dbt_idx.not_null_customer_orders_status_customer_id.3915c814eb
[0m22:38:30.891338 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_idx.not_null_customer_orders_status_customer_id.3915c814eb"
[0m22:38:30.898334 [debug] [Thread-1 (]: Timing info for test.dbt_idx.not_null_customer_orders_status_customer_id.3915c814eb (compile): 22:38:30.884811 => 22:38:30.898334
[0m22:38:30.899339 [debug] [Thread-1 (]: Began executing node test.dbt_idx.not_null_customer_orders_status_customer_id.3915c814eb
[0m22:38:30.900368 [debug] [Thread-1 (]: Timing info for test.dbt_idx.not_null_customer_orders_status_customer_id.3915c814eb (execute): 22:38:30.900368 => 22:38:30.900368
[0m22:38:30.902541 [debug] [Thread-1 (]: Finished running node test.dbt_idx.not_null_customer_orders_status_customer_id.3915c814eb
[0m22:38:30.903508 [debug] [Thread-1 (]: Began running node test.dbt_idx.unique_customer_orders_status_order_id.b7a45e83ee
[0m22:38:30.904530 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_idx.not_null_customer_orders_status_customer_id.3915c814eb, now test.dbt_idx.unique_customer_orders_status_order_id.b7a45e83ee)
[0m22:38:30.906508 [debug] [Thread-1 (]: Began compiling node test.dbt_idx.unique_customer_orders_status_order_id.b7a45e83ee
[0m22:38:30.911525 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_idx.unique_customer_orders_status_order_id.b7a45e83ee"
[0m22:38:30.919602 [debug] [Thread-1 (]: Timing info for test.dbt_idx.unique_customer_orders_status_order_id.b7a45e83ee (compile): 22:38:30.906508 => 22:38:30.919602
[0m22:38:30.921603 [debug] [Thread-1 (]: Began executing node test.dbt_idx.unique_customer_orders_status_order_id.b7a45e83ee
[0m22:38:30.924188 [debug] [Thread-1 (]: Timing info for test.dbt_idx.unique_customer_orders_status_order_id.b7a45e83ee (execute): 22:38:30.923118 => 22:38:30.923118
[0m22:38:30.925128 [debug] [Thread-1 (]: Finished running node test.dbt_idx.unique_customer_orders_status_order_id.b7a45e83ee
[0m22:38:30.928138 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:38:30.929153 [debug] [MainThread]: Connection 'list_IDX-Stock_snapshots' was properly closed.
[0m22:38:30.930156 [debug] [MainThread]: Connection 'test.dbt_idx.unique_customer_orders_status_order_id.b7a45e83ee' was properly closed.
[0m22:38:30.934129 [debug] [MainThread]: Command end result
[0m22:38:31.392062 [debug] [MainThread]: Acquiring new postgres connection 'generate_catalog'
[0m22:38:31.393025 [info ] [MainThread]: Building catalog
[0m22:38:31.398083 [debug] [ThreadPool]: Acquiring new postgres connection 'IDX-Stock.information_schema'
[0m22:38:31.407069 [debug] [ThreadPool]: Using postgres connection "IDX-Stock.information_schema"
[0m22:38:31.408063 [debug] [ThreadPool]: On IDX-Stock.information_schema: BEGIN
[0m22:38:31.409590 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:38:31.435795 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m22:38:31.436795 [debug] [ThreadPool]: Using postgres connection "IDX-Stock.information_schema"
[0m22:38:31.437812 [debug] [ThreadPool]: On IDX-Stock.information_schema: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "connection_name": "IDX-Stock.information_schema"} */

    
    

    select
        'IDX-Stock' as table_database,
        sch.nspname as table_schema,
        tbl.relname as table_name,
        case tbl.relkind
            when 'v' then 'VIEW'
            else 'BASE TABLE'
        end as table_type,
        tbl_desc.description as table_comment,
        col.attname as column_name,
        col.attnum as column_index,
        pg_catalog.format_type(col.atttypid, col.atttypmod) as column_type,
        col_desc.description as column_comment,
        pg_get_userbyid(tbl.relowner) as table_owner

    from pg_catalog.pg_namespace sch
    join pg_catalog.pg_class tbl on tbl.relnamespace = sch.oid
    join pg_catalog.pg_attribute col on col.attrelid = tbl.oid
    left outer join pg_catalog.pg_description tbl_desc on (tbl_desc.objoid = tbl.oid and tbl_desc.objsubid = 0)
    left outer join pg_catalog.pg_description col_desc on (col_desc.objoid = tbl.oid and col_desc.objsubid = col.attnum)

    where (upper(sch.nspname) = upper('warehouse') or upper(sch.nspname) = upper('snapshots'))
      and not pg_is_other_temp_schema(sch.oid) -- not a temporary schema belonging to another session
      and tbl.relpersistence in ('p', 'u') -- [p]ermanent table or [u]nlogged table. Exclude [t]emporary tables
      and tbl.relkind in ('r', 'v', 'f', 'p') -- o[r]dinary table, [v]iew, [f]oreign table, [p]artitioned table. Other values are [i]ndex, [S]equence, [c]omposite type, [t]OAST table, [m]aterialized view
      and col.attnum > 0 -- negative numbers are used for system columns such as oid
      and not col.attisdropped -- column as not been dropped

    order by
        sch.nspname,
        tbl.relname,
        col.attnum
[0m22:38:31.444794 [debug] [ThreadPool]: SQL status: SELECT 77 in 0.0 seconds
[0m22:38:31.455911 [debug] [ThreadPool]: On IDX-Stock.information_schema: ROLLBACK
[0m22:38:31.459577 [debug] [ThreadPool]: On IDX-Stock.information_schema: Close
[0m22:38:31.504233 [info ] [MainThread]: Catalog written to D:\00 Project\00 My Project\IdeaProjects\Py-DBT-IDX\target\catalog.json
[0m22:38:31.507778 [debug] [MainThread]: Command `dbt docs generate` succeeded at 22:38:31.507778 after 1.59 seconds
[0m22:38:31.509779 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
[0m22:38:31.510754 [debug] [MainThread]: Connection 'IDX-Stock.information_schema' was properly closed.
[0m22:38:31.512263 [debug] [MainThread]: Flushing usage events


============================== 22:38:39.984176 | 36f0edca-3680-4b4a-96be-deb10670ad9a ==============================
[0m22:38:39.984176 [info ] [MainThread]: Running with dbt=1.6.1
[0m22:38:39.989176 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'D:\\00 Project\\00 My Project\\IdeaProjects\\Py-DBT-IDX', 'debug': 'False', 'version_check': 'True', 'log_path': 'D:\\00 Project\\00 My Project\\IdeaProjects\\Py-DBT-IDX\\logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt docs serve', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'False'}


============================== 13:08:11.514484 | 8c3b585c-73be-4768-a7c1-41d7134d8424 ==============================
[0m13:08:11.514484 [info ] [MainThread]: Running with dbt=1.6.1
[0m13:08:11.521826 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'D:\\00 Project\\00 My Project\\IdeaProjects\\Py-DBT-IDX\\logs', 'version_check': 'True', 'profiles_dir': 'D:\\00 Project\\00 My Project\\IdeaProjects\\Py-DBT-IDX', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'False'}
[0m13:08:11.525862 [error] [MainThread]: Encountered an error:
Runtime Error
  The profile 'dbt_idx' does not have a target named 'dev'. The valid target names for this profile are:
   - IDX_warehouse
[0m13:08:11.526841 [debug] [MainThread]: Command `dbt run` failed at 13:08:11.526841 after 0.05 seconds
[0m13:08:11.527837 [debug] [MainThread]: Flushing usage events


============================== 13:14:29.349773 | e53996b0-eacf-44a2-97f0-bdd94e991651 ==============================
[0m13:14:29.349773 [info ] [MainThread]: Running with dbt=1.6.1
[0m13:14:29.355735 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'D:\\00 Project\\00 My Project\\IdeaProjects\\Py-DBT-IDX\\logs', 'debug': 'False', 'profiles_dir': 'D:\\00 Project\\00 My Project\\IdeaProjects\\Py-DBT-IDX', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt snapshot', 'send_anonymous_usage_stats': 'False'}
[0m13:14:29.523713 [info ] [MainThread]: Registered adapter: postgres=1.6.1
[0m13:14:29.534291 [debug] [MainThread]: checksum: efe19d9f5b93d1a98cc804fbfcdb6b3aced98b974af664946fee1cde8837deb7, vars: {}, profile: , target: , version: 1.6.1
[0m13:14:29.546839 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m13:14:30.614172 [info ] [MainThread]: Found 7 models, 1 snapshot, 10 tests, 3 sources, 0 exposures, 0 metrics, 349 macros, 0 groups, 0 semantic models
[0m13:14:30.616049 [info ] [MainThread]: 
[0m13:14:30.618014 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m13:14:30.620558 [debug] [ThreadPool]: Acquiring new postgres connection 'list_IDX-Stock'
[0m13:14:30.634149 [debug] [ThreadPool]: Using postgres connection "list_IDX-Stock"
[0m13:14:30.635130 [debug] [ThreadPool]: On list_IDX-Stock: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "connection_name": "list_IDX-Stock"} */

    select distinct nspname from pg_namespace
  
[0m13:14:30.636114 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:14:30.688068 [debug] [ThreadPool]: SQL status: SELECT 12 in 0.0 seconds
[0m13:14:30.689604 [debug] [ThreadPool]: On list_IDX-Stock: Close
[0m13:14:30.693617 [debug] [ThreadPool]: Acquiring new postgres connection 'list_IDX-Stock_IDX-Schema'
[0m13:14:30.701166 [debug] [ThreadPool]: Using postgres connection "list_IDX-Stock_IDX-Schema"
[0m13:14:30.702132 [debug] [ThreadPool]: On list_IDX-Stock_IDX-Schema: BEGIN
[0m13:14:30.703130 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:14:30.728529 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m13:14:30.729061 [debug] [ThreadPool]: Using postgres connection "list_IDX-Stock_IDX-Schema"
[0m13:14:30.730066 [debug] [ThreadPool]: On list_IDX-Stock_IDX-Schema: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "connection_name": "list_IDX-Stock_IDX-Schema"} */
select
      'IDX-Stock' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'IDX-Schema'
    union all
    select
      'IDX-Stock' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'IDX-Schema'
    union all
    select
      'IDX-Stock' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'IDX-Schema'
  
[0m13:14:30.734094 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.0 seconds
[0m13:14:30.736095 [debug] [ThreadPool]: On list_IDX-Stock_IDX-Schema: ROLLBACK
[0m13:14:30.739067 [debug] [ThreadPool]: On list_IDX-Stock_IDX-Schema: Close
[0m13:14:30.741236 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_IDX-Stock_IDX-Schema, now list_IDX-Stock_snapshots)
[0m13:14:30.747196 [debug] [ThreadPool]: Using postgres connection "list_IDX-Stock_snapshots"
[0m13:14:30.747196 [debug] [ThreadPool]: On list_IDX-Stock_snapshots: BEGIN
[0m13:14:30.748221 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:14:30.769033 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m13:14:30.769576 [debug] [ThreadPool]: Using postgres connection "list_IDX-Stock_snapshots"
[0m13:14:30.770620 [debug] [ThreadPool]: On list_IDX-Stock_snapshots: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "connection_name": "list_IDX-Stock_snapshots"} */
select
      'IDX-Stock' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'snapshots'
    union all
    select
      'IDX-Stock' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'snapshots'
    union all
    select
      'IDX-Stock' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'snapshots'
  
[0m13:14:30.775796 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.0 seconds
[0m13:14:30.776808 [debug] [ThreadPool]: On list_IDX-Stock_snapshots: ROLLBACK
[0m13:14:30.779777 [debug] [ThreadPool]: On list_IDX-Stock_snapshots: Close
[0m13:14:30.786834 [debug] [MainThread]: Using postgres connection "master"
[0m13:14:30.786834 [debug] [MainThread]: On master: BEGIN
[0m13:14:30.787826 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:14:30.813139 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m13:14:30.813236 [debug] [MainThread]: Using postgres connection "master"
[0m13:14:30.814266 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m13:14:30.821762 [debug] [MainThread]: SQL status: SELECT 0 in 0.0 seconds
[0m13:14:30.823776 [debug] [MainThread]: On master: ROLLBACK
[0m13:14:30.825860 [debug] [MainThread]: Using postgres connection "master"
[0m13:14:30.826942 [debug] [MainThread]: On master: BEGIN
[0m13:14:30.830049 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m13:14:30.831046 [debug] [MainThread]: On master: COMMIT
[0m13:14:30.832072 [debug] [MainThread]: Using postgres connection "master"
[0m13:14:30.833081 [debug] [MainThread]: On master: COMMIT
[0m13:14:30.835097 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m13:14:30.836048 [debug] [MainThread]: On master: Close
[0m13:14:30.837045 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:14:30.839062 [info ] [MainThread]: 
[0m13:14:30.844987 [debug] [Thread-1 (]: Began running node snapshot.dbt_idx.customers_snapshot
[0m13:14:30.845988 [info ] [Thread-1 (]: 1 of 1 START snapshot snapshots.customers_snapshot ............................. [RUN]
[0m13:14:30.846999 [debug] [Thread-1 (]: Acquiring new postgres connection 'snapshot.dbt_idx.customers_snapshot'
[0m13:14:30.847985 [debug] [Thread-1 (]: Began compiling node snapshot.dbt_idx.customers_snapshot
[0m13:14:30.857531 [debug] [Thread-1 (]: Timing info for snapshot.dbt_idx.customers_snapshot (compile): 13:14:30.849012 => 13:14:30.857531
[0m13:14:30.857531 [debug] [Thread-1 (]: Began executing node snapshot.dbt_idx.customers_snapshot
[0m13:14:30.907282 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.dbt_idx.customers_snapshot"
[0m13:14:30.915809 [debug] [Thread-1 (]: Using postgres connection "snapshot.dbt_idx.customers_snapshot"
[0m13:14:30.915809 [debug] [Thread-1 (]: On snapshot.dbt_idx.customers_snapshot: BEGIN
[0m13:14:30.916809 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m13:14:30.941027 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m13:14:30.942061 [debug] [Thread-1 (]: Using postgres connection "snapshot.dbt_idx.customers_snapshot"
[0m13:14:30.943030 [debug] [Thread-1 (]: On snapshot.dbt_idx.customers_snapshot: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "snapshot.dbt_idx.customers_snapshot"} */

      
  
    

  create  table "IDX-Stock"."snapshots"."customers_snapshot"
  
  
    as
  
  (
    

    select *,
        md5(coalesce(cast(customer_id as varchar ), '')
         || '|' || coalesce(cast(datetime_updated as varchar ), '')
        ) as dbt_scd_id,
        datetime_updated as dbt_updated_at,
        datetime_updated as dbt_valid_from,
        nullif(datetime_updated, datetime_updated) as dbt_valid_to
    from (
        



select *
from "IDX-Stock"."warehouse"."customers"

    ) sbq



  );
  
  
[0m13:14:30.946028 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "warehouse.customers" does not exist
LINE 28: from "IDX-Stock"."warehouse"."customers"
              ^

[0m13:14:30.947027 [debug] [Thread-1 (]: On snapshot.dbt_idx.customers_snapshot: ROLLBACK
[0m13:14:30.949026 [debug] [Thread-1 (]: Timing info for snapshot.dbt_idx.customers_snapshot (execute): 13:14:30.859087 => 13:14:30.949026
[0m13:14:30.950555 [debug] [Thread-1 (]: On snapshot.dbt_idx.customers_snapshot: Close
[0m13:14:30.970189 [debug] [Thread-1 (]: Database Error in snapshot customers_snapshot (snapshots\customers.sql)
  relation "warehouse.customers" does not exist
  LINE 28: from "IDX-Stock"."warehouse"."customers"
                ^
  compiled Code at target\run\dbt_idx\snapshots\customers.sql
[0m13:14:30.971199 [error] [Thread-1 (]: 1 of 1 ERROR snapshotting snapshots.customers_snapshot ......................... [[31mERROR[0m in 0.12s]
[0m13:14:30.972217 [debug] [Thread-1 (]: Finished running node snapshot.dbt_idx.customers_snapshot
[0m13:14:30.975190 [debug] [MainThread]: Using postgres connection "master"
[0m13:14:30.975190 [debug] [MainThread]: On master: BEGIN
[0m13:14:30.976190 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:14:30.999972 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m13:14:31.000969 [debug] [MainThread]: On master: COMMIT
[0m13:14:31.001994 [debug] [MainThread]: Using postgres connection "master"
[0m13:14:31.002969 [debug] [MainThread]: On master: COMMIT
[0m13:14:31.004965 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m13:14:31.005967 [debug] [MainThread]: On master: Close
[0m13:14:31.006980 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:14:31.008971 [debug] [MainThread]: Connection 'list_IDX-Stock' was properly closed.
[0m13:14:31.008971 [debug] [MainThread]: Connection 'list_IDX-Stock_snapshots' was properly closed.
[0m13:14:31.010303 [debug] [MainThread]: Connection 'snapshot.dbt_idx.customers_snapshot' was properly closed.
[0m13:14:31.011301 [info ] [MainThread]: 
[0m13:14:31.012314 [info ] [MainThread]: Finished running 1 snapshot in 0 hours 0 minutes and 0.39 seconds (0.39s).
[0m13:14:31.014301 [debug] [MainThread]: Command end result
[0m13:14:31.039059 [info ] [MainThread]: 
[0m13:14:31.039983 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m13:14:31.041001 [info ] [MainThread]: 
[0m13:14:31.042049 [error] [MainThread]: [33mDatabase Error in snapshot customers_snapshot (snapshots\customers.sql)[0m
[0m13:14:31.043014 [error] [MainThread]:   relation "warehouse.customers" does not exist
[0m13:14:31.044020 [error] [MainThread]:   LINE 28: from "IDX-Stock"."warehouse"."customers"
[0m13:14:31.045041 [error] [MainThread]:                 ^
[0m13:14:31.046014 [error] [MainThread]:   compiled Code at target\run\dbt_idx\snapshots\customers.sql
[0m13:14:31.048013 [info ] [MainThread]: 
[0m13:14:31.049013 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m13:14:31.049013 [debug] [MainThread]: Command `dbt snapshot` failed at 13:14:31.049013 after 1.74 seconds
[0m13:14:31.050818 [debug] [MainThread]: Flushing usage events


============================== 13:16:25.744017 | be2d323b-2909-4fc5-8fb6-a948899aad2b ==============================
[0m13:16:25.744017 [info ] [MainThread]: Running with dbt=1.6.1
[0m13:16:25.750221 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'D:\\00 Project\\00 My Project\\IdeaProjects\\Py-DBT-IDX', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'D:\\00 Project\\00 My Project\\IdeaProjects\\Py-DBT-IDX\\logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt snapshot', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'False'}
[0m13:16:25.928982 [info ] [MainThread]: Registered adapter: postgres=1.6.1
[0m13:16:25.942069 [debug] [MainThread]: checksum: efe19d9f5b93d1a98cc804fbfcdb6b3aced98b974af664946fee1cde8837deb7, vars: {}, profile: , target: , version: 1.6.1
[0m13:16:26.129887 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m13:16:26.130929 [debug] [MainThread]: Partial parsing: updated file: dbt_idx://snapshots\customers.sql
[0m13:16:26.157561 [error] [MainThread]: Encountered an error:
Compilation Error in snapshot customers_snapshot (snapshots\customers.sql)
  source() takes exactly two arguments (1 given)
[0m13:16:26.158681 [debug] [MainThread]: Command `dbt snapshot` failed at 13:16:26.158681 after 0.46 seconds
[0m13:16:26.159692 [debug] [MainThread]: Flushing usage events


============================== 13:17:14.982105 | 3bc6cf7d-d510-4cc0-b138-785cda2ffa70 ==============================
[0m13:17:14.982105 [info ] [MainThread]: Running with dbt=1.6.1
[0m13:17:14.991668 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'D:\\00 Project\\00 My Project\\IdeaProjects\\Py-DBT-IDX', 'version_check': 'True', 'warn_error': 'None', 'log_path': 'D:\\00 Project\\00 My Project\\IdeaProjects\\Py-DBT-IDX\\logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt snapshot', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'False'}
[0m13:17:15.172234 [info ] [MainThread]: Registered adapter: postgres=1.6.1
[0m13:17:15.184749 [debug] [MainThread]: checksum: efe19d9f5b93d1a98cc804fbfcdb6b3aced98b974af664946fee1cde8837deb7, vars: {}, profile: , target: , version: 1.6.1
[0m13:17:15.360471 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m13:17:15.361496 [debug] [MainThread]: Partial parsing: updated file: dbt_idx://snapshots\customers.sql
[0m13:17:15.403237 [error] [MainThread]: Encountered an error:
Compilation Error
  Snapshot 'snapshot.dbt_idx.customers_snapshot' (snapshots\customers.sql) depends on a source named 'IDX-Schema.customers' which was not found
[0m13:17:15.404208 [debug] [MainThread]: Command `dbt snapshot` failed at 13:17:15.404208 after 0.47 seconds
[0m13:17:15.405206 [debug] [MainThread]: Flushing usage events


============================== 13:20:45.404939 | 7c7048ae-5270-4ec5-ae88-b0b26a4a7c22 ==============================
[0m13:20:45.404939 [info ] [MainThread]: Running with dbt=1.6.1
[0m13:20:45.411054 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': 'D:\\00 Project\\00 My Project\\IdeaProjects\\Py-DBT-IDX\\logs', 'fail_fast': 'False', 'profiles_dir': 'D:\\00 Project\\00 My Project\\IdeaProjects\\Py-DBT-IDX', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt snapshot', 'send_anonymous_usage_stats': 'False'}
[0m13:20:45.569456 [info ] [MainThread]: Registered adapter: postgres=1.6.1
[0m13:20:45.580041 [debug] [MainThread]: checksum: efe19d9f5b93d1a98cc804fbfcdb6b3aced98b974af664946fee1cde8837deb7, vars: {}, profile: , target: , version: 1.6.1
[0m13:20:45.784826 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m13:20:45.786838 [debug] [MainThread]: Partial parsing: updated file: dbt_idx://snapshots\customers.sql
[0m13:20:45.852856 [error] [MainThread]: Encountered an error:
Compilation Error
  Snapshot 'snapshot.dbt_idx.customers_snapshot' (snapshots\customers.sql) depends on a source named '"IDX-Schema".customers' which was not found
[0m13:20:45.855378 [debug] [MainThread]: Command `dbt snapshot` failed at 13:20:45.854848 after 0.49 seconds
[0m13:20:45.856388 [debug] [MainThread]: Flushing usage events


============================== 13:29:48.798847 | 72941f75-0eea-4972-af84-f5d7037e4eb3 ==============================
[0m13:29:48.798847 [info ] [MainThread]: Running with dbt=1.6.1
[0m13:29:48.803794 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'D:\\00 Project\\00 My Project\\IdeaProjects\\Py-DBT-IDX\\logs', 'profiles_dir': 'D:\\00 Project\\00 My Project\\IdeaProjects\\Py-DBT-IDX', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt snapshot', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'False'}
[0m13:29:48.947423 [info ] [MainThread]: Registered adapter: postgres=1.6.1
[0m13:29:48.957938 [debug] [MainThread]: checksum: efe19d9f5b93d1a98cc804fbfcdb6b3aced98b974af664946fee1cde8837deb7, vars: {}, profile: , target: , version: 1.6.1
[0m13:29:49.102969 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m13:29:49.104968 [debug] [MainThread]: Partial parsing: updated file: dbt_idx://models\staging\src_eltool.yml
[0m13:29:49.105947 [debug] [MainThread]: Partial parsing: updated file: dbt_idx://snapshots\customers.sql
[0m13:29:49.273461 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.dbt_idx.stg_eltool__customers' (models\staging\stg_eltool__customers.sql) depends on a source named 'warehouse.customers' which was not found
[0m13:29:49.274442 [debug] [MainThread]: Command `dbt snapshot` failed at 13:29:49.274442 after 0.52 seconds
[0m13:29:49.276984 [debug] [MainThread]: Flushing usage events


============================== 13:29:54.840649 | 02c951d2-3f1b-4ccf-9596-abad927600dd ==============================
[0m13:29:54.840649 [info ] [MainThread]: Running with dbt=1.6.1
[0m13:29:54.846155 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': 'D:\\00 Project\\00 My Project\\IdeaProjects\\Py-DBT-IDX', 'log_path': 'D:\\00 Project\\00 My Project\\IdeaProjects\\Py-DBT-IDX\\logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt snapshot', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'False'}
[0m13:29:54.992495 [info ] [MainThread]: Registered adapter: postgres=1.6.1
[0m13:29:55.002992 [debug] [MainThread]: checksum: efe19d9f5b93d1a98cc804fbfcdb6b3aced98b974af664946fee1cde8837deb7, vars: {}, profile: , target: , version: 1.6.1
[0m13:29:55.146993 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m13:29:55.148996 [debug] [MainThread]: Partial parsing: updated file: dbt_idx://models\staging\src_eltool.yml
[0m13:29:55.150010 [debug] [MainThread]: Partial parsing: updated file: dbt_idx://snapshots\customers.sql
[0m13:29:55.306731 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.dbt_idx.stg_eltool__customers' (models\staging\stg_eltool__customers.sql) depends on a source named 'warehouse.customers' which was not found
[0m13:29:55.308697 [debug] [MainThread]: Command `dbt snapshot` failed at 13:29:55.308697 after 0.51 seconds
[0m13:29:55.308697 [debug] [MainThread]: Flushing usage events


============================== 13:30:22.968289 | a3b82655-c5f6-40be-8baf-146627a5411c ==============================
[0m13:30:22.968289 [info ] [MainThread]: Running with dbt=1.6.1
[0m13:30:22.974310 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'D:\\00 Project\\00 My Project\\IdeaProjects\\Py-DBT-IDX\\logs', 'version_check': 'True', 'profiles_dir': 'D:\\00 Project\\00 My Project\\IdeaProjects\\Py-DBT-IDX', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt snapshot', 'send_anonymous_usage_stats': 'False'}
[0m13:30:23.114508 [info ] [MainThread]: Registered adapter: postgres=1.6.1
[0m13:30:23.126648 [debug] [MainThread]: checksum: efe19d9f5b93d1a98cc804fbfcdb6b3aced98b974af664946fee1cde8837deb7, vars: {}, profile: , target: , version: 1.6.1
[0m13:30:23.286780 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 5 files changed.
[0m13:30:23.288780 [debug] [MainThread]: Partial parsing: updated file: dbt_idx://models\staging\src_eltool.yml
[0m13:30:23.289779 [debug] [MainThread]: Partial parsing: updated file: dbt_idx://snapshots\customers.sql
[0m13:30:23.290781 [debug] [MainThread]: Partial parsing: updated file: dbt_idx://models\staging\stg_eltool__state.sql
[0m13:30:23.290781 [debug] [MainThread]: Partial parsing: updated file: dbt_idx://models\staging\stg_eltool__orders.sql
[0m13:30:23.291780 [debug] [MainThread]: Partial parsing: updated file: dbt_idx://models\staging\stg_eltool__customers.sql
[0m13:30:23.521067 [info ] [MainThread]: Found 7 models, 1 snapshot, 10 tests, 3 sources, 0 exposures, 0 metrics, 349 macros, 0 groups, 0 semantic models
[0m13:30:23.524104 [info ] [MainThread]: 
[0m13:30:23.525613 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m13:30:23.527658 [debug] [ThreadPool]: Acquiring new postgres connection 'list_IDX-Stock'
[0m13:30:23.540031 [debug] [ThreadPool]: Using postgres connection "list_IDX-Stock"
[0m13:30:23.541031 [debug] [ThreadPool]: On list_IDX-Stock: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "connection_name": "list_IDX-Stock"} */

    select distinct nspname from pg_namespace
  
[0m13:30:23.541996 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:30:23.573166 [debug] [ThreadPool]: SQL status: SELECT 11 in 0.0 seconds
[0m13:30:23.574135 [debug] [ThreadPool]: On list_IDX-Stock: Close
[0m13:30:23.577730 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_IDX-Stock, now create_IDX-Stock_snapshots)
[0m13:30:23.579730 [debug] [ThreadPool]: Creating schema "database: "IDX-Stock"
schema: "snapshots"
"
[0m13:30:23.585761 [debug] [ThreadPool]: Using postgres connection "create_IDX-Stock_snapshots"
[0m13:30:23.585761 [debug] [ThreadPool]: On create_IDX-Stock_snapshots: BEGIN
[0m13:30:23.586859 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:30:23.611498 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m13:30:23.613556 [debug] [ThreadPool]: Using postgres connection "create_IDX-Stock_snapshots"
[0m13:30:23.615288 [debug] [ThreadPool]: On create_IDX-Stock_snapshots: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "connection_name": "create_IDX-Stock_snapshots"} */
create schema if not exists "snapshots"
[0m13:30:23.619423 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.0 seconds
[0m13:30:23.622765 [debug] [ThreadPool]: On create_IDX-Stock_snapshots: COMMIT
[0m13:30:23.624486 [debug] [ThreadPool]: Using postgres connection "create_IDX-Stock_snapshots"
[0m13:30:23.625521 [debug] [ThreadPool]: On create_IDX-Stock_snapshots: COMMIT
[0m13:30:23.633144 [debug] [ThreadPool]: SQL status: COMMIT in 0.0 seconds
[0m13:30:23.634272 [debug] [ThreadPool]: On create_IDX-Stock_snapshots: Close
[0m13:30:23.640719 [debug] [ThreadPool]: Acquiring new postgres connection 'list_IDX-Stock_snapshots'
[0m13:30:23.648167 [debug] [ThreadPool]: Using postgres connection "list_IDX-Stock_snapshots"
[0m13:30:23.649166 [debug] [ThreadPool]: On list_IDX-Stock_snapshots: BEGIN
[0m13:30:23.649166 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:30:23.734605 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m13:30:23.735577 [debug] [ThreadPool]: Using postgres connection "list_IDX-Stock_snapshots"
[0m13:30:23.736142 [debug] [ThreadPool]: On list_IDX-Stock_snapshots: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "connection_name": "list_IDX-Stock_snapshots"} */
select
      'IDX-Stock' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'snapshots'
    union all
    select
      'IDX-Stock' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'snapshots'
    union all
    select
      'IDX-Stock' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'snapshots'
  
[0m13:30:23.743676 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.0 seconds
[0m13:30:23.745704 [debug] [ThreadPool]: On list_IDX-Stock_snapshots: ROLLBACK
[0m13:30:23.749062 [debug] [ThreadPool]: On list_IDX-Stock_snapshots: Close
[0m13:30:23.751580 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_IDX-Stock_snapshots, now list_IDX-Stock_IDX-Schema)
[0m13:30:23.757209 [debug] [ThreadPool]: Using postgres connection "list_IDX-Stock_IDX-Schema"
[0m13:30:23.758760 [debug] [ThreadPool]: On list_IDX-Stock_IDX-Schema: BEGIN
[0m13:30:23.759805 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:30:23.786010 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m13:30:23.786905 [debug] [ThreadPool]: Using postgres connection "list_IDX-Stock_IDX-Schema"
[0m13:30:23.788920 [debug] [ThreadPool]: On list_IDX-Stock_IDX-Schema: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "connection_name": "list_IDX-Stock_IDX-Schema"} */
select
      'IDX-Stock' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'IDX-Schema'
    union all
    select
      'IDX-Stock' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'IDX-Schema'
    union all
    select
      'IDX-Stock' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'IDX-Schema'
  
[0m13:30:23.798728 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.0 seconds
[0m13:30:23.802462 [debug] [ThreadPool]: On list_IDX-Stock_IDX-Schema: ROLLBACK
[0m13:30:23.805455 [debug] [ThreadPool]: On list_IDX-Stock_IDX-Schema: Close
[0m13:30:23.814695 [debug] [MainThread]: Using postgres connection "master"
[0m13:30:23.816229 [debug] [MainThread]: On master: BEGIN
[0m13:30:23.816229 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:30:23.847062 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m13:30:23.848103 [debug] [MainThread]: Using postgres connection "master"
[0m13:30:23.849073 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m13:30:23.857129 [debug] [MainThread]: SQL status: SELECT 0 in 0.0 seconds
[0m13:30:23.859193 [debug] [MainThread]: On master: ROLLBACK
[0m13:30:23.862181 [debug] [MainThread]: Using postgres connection "master"
[0m13:30:23.863130 [debug] [MainThread]: On master: BEGIN
[0m13:30:23.867695 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m13:30:23.869228 [debug] [MainThread]: On master: COMMIT
[0m13:30:23.870236 [debug] [MainThread]: Using postgres connection "master"
[0m13:30:23.871241 [debug] [MainThread]: On master: COMMIT
[0m13:30:23.873241 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m13:30:23.874272 [debug] [MainThread]: On master: Close
[0m13:30:23.875781 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:30:23.877790 [info ] [MainThread]: 
[0m13:30:23.884825 [debug] [Thread-1 (]: Began running node snapshot.dbt_idx.customers_snapshot
[0m13:30:23.885787 [info ] [Thread-1 (]: 1 of 1 START snapshot snapshots.customers_snapshot ............................. [RUN]
[0m13:30:23.888136 [debug] [Thread-1 (]: Acquiring new postgres connection 'snapshot.dbt_idx.customers_snapshot'
[0m13:30:23.889146 [debug] [Thread-1 (]: Began compiling node snapshot.dbt_idx.customers_snapshot
[0m13:30:23.904684 [debug] [Thread-1 (]: Timing info for snapshot.dbt_idx.customers_snapshot (compile): 13:30:23.890166 => 13:30:23.904684
[0m13:30:23.905686 [debug] [Thread-1 (]: Began executing node snapshot.dbt_idx.customers_snapshot
[0m13:30:23.961224 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.dbt_idx.customers_snapshot"
[0m13:30:23.969726 [debug] [Thread-1 (]: Using postgres connection "snapshot.dbt_idx.customers_snapshot"
[0m13:30:23.970725 [debug] [Thread-1 (]: On snapshot.dbt_idx.customers_snapshot: BEGIN
[0m13:30:23.972233 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m13:30:23.995828 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m13:30:23.998037 [debug] [Thread-1 (]: Using postgres connection "snapshot.dbt_idx.customers_snapshot"
[0m13:30:23.999073 [debug] [Thread-1 (]: On snapshot.dbt_idx.customers_snapshot: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "snapshot.dbt_idx.customers_snapshot"} */

      
  
    

  create  table "IDX-Stock"."snapshots"."customers_snapshot"
  
  
    as
  
  (
    

    select *,
        md5(coalesce(cast(customer_id as varchar ), '')
         || '|' || coalesce(cast(datetime_updated as varchar ), '')
        ) as dbt_scd_id,
        datetime_updated as dbt_updated_at,
        datetime_updated as dbt_valid_from,
        nullif(datetime_updated, datetime_updated) as dbt_valid_to
    from (
        



select *
from "IDX-Stock"."IDX-Schema"."customers"

    ) sbq



  );
  
  
[0m13:30:24.012614 [debug] [Thread-1 (]: SQL status: SELECT 100 in 0.0 seconds
[0m13:30:24.042053 [debug] [Thread-1 (]: On snapshot.dbt_idx.customers_snapshot: COMMIT
[0m13:30:24.044057 [debug] [Thread-1 (]: Using postgres connection "snapshot.dbt_idx.customers_snapshot"
[0m13:30:24.044057 [debug] [Thread-1 (]: On snapshot.dbt_idx.customers_snapshot: COMMIT
[0m13:30:24.049603 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m13:30:24.051658 [debug] [Thread-1 (]: Timing info for snapshot.dbt_idx.customers_snapshot (execute): 13:30:23.906938 => 13:30:24.051115
[0m13:30:24.051658 [debug] [Thread-1 (]: On snapshot.dbt_idx.customers_snapshot: Close
[0m13:30:24.055712 [info ] [Thread-1 (]: 1 of 1 OK snapshotted snapshots.customers_snapshot ............................. [[32msuccess[0m in 0.17s]
[0m13:30:24.057730 [debug] [Thread-1 (]: Finished running node snapshot.dbt_idx.customers_snapshot
[0m13:30:24.061744 [debug] [MainThread]: Using postgres connection "master"
[0m13:30:24.062744 [debug] [MainThread]: On master: BEGIN
[0m13:30:24.063736 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:30:24.093167 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m13:30:24.094167 [debug] [MainThread]: On master: COMMIT
[0m13:30:24.095165 [debug] [MainThread]: Using postgres connection "master"
[0m13:30:24.095672 [debug] [MainThread]: On master: COMMIT
[0m13:30:24.098706 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m13:30:24.099703 [debug] [MainThread]: On master: Close
[0m13:30:24.101705 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:30:24.102706 [debug] [MainThread]: Connection 'create_IDX-Stock_snapshots' was properly closed.
[0m13:30:24.103704 [debug] [MainThread]: Connection 'list_IDX-Stock_IDX-Schema' was properly closed.
[0m13:30:24.104705 [debug] [MainThread]: Connection 'snapshot.dbt_idx.customers_snapshot' was properly closed.
[0m13:30:24.106222 [info ] [MainThread]: 
[0m13:30:24.107250 [info ] [MainThread]: Finished running 1 snapshot in 0 hours 0 minutes and 0.58 seconds (0.58s).
[0m13:30:24.109803 [debug] [MainThread]: Command end result
[0m13:30:24.139614 [info ] [MainThread]: 
[0m13:30:24.141607 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:30:24.142628 [info ] [MainThread]: 
[0m13:30:24.143607 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m13:30:24.144609 [debug] [MainThread]: Command `dbt snapshot` succeeded at 13:30:24.144609 after 1.22 seconds
[0m13:30:24.145621 [debug] [MainThread]: Flushing usage events


============================== 13:30:43.030096 | a685c631-81df-4bf6-907d-67501a29bdfb ==============================
[0m13:30:43.030096 [info ] [MainThread]: Running with dbt=1.6.1
[0m13:30:43.035611 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'D:\\00 Project\\00 My Project\\IdeaProjects\\Py-DBT-IDX', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': 'D:\\00 Project\\00 My Project\\IdeaProjects\\Py-DBT-IDX\\logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'False'}
[0m13:30:43.171419 [info ] [MainThread]: Registered adapter: postgres=1.6.1
[0m13:30:43.182045 [debug] [MainThread]: checksum: efe19d9f5b93d1a98cc804fbfcdb6b3aced98b974af664946fee1cde8837deb7, vars: {}, profile: , target: , version: 1.6.1
[0m13:30:43.343304 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:30:43.344304 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:30:43.397088 [info ] [MainThread]: Found 7 models, 1 snapshot, 10 tests, 3 sources, 0 exposures, 0 metrics, 349 macros, 0 groups, 0 semantic models
[0m13:30:43.400099 [info ] [MainThread]: 
[0m13:30:43.401683 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m13:30:43.404680 [debug] [ThreadPool]: Acquiring new postgres connection 'list_IDX-Stock'
[0m13:30:43.415585 [debug] [ThreadPool]: Using postgres connection "list_IDX-Stock"
[0m13:30:43.416576 [debug] [ThreadPool]: On list_IDX-Stock: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "connection_name": "list_IDX-Stock"} */

    select distinct nspname from pg_namespace
  
[0m13:30:43.417575 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:30:43.449642 [debug] [ThreadPool]: SQL status: SELECT 12 in 0.0 seconds
[0m13:30:43.451638 [debug] [ThreadPool]: On list_IDX-Stock: Close
[0m13:30:43.456159 [debug] [ThreadPool]: Acquiring new postgres connection 'list_IDX-Stock_IDX-Schema'
[0m13:30:43.463224 [debug] [ThreadPool]: Using postgres connection "list_IDX-Stock_IDX-Schema"
[0m13:30:43.463224 [debug] [ThreadPool]: On list_IDX-Stock_IDX-Schema: BEGIN
[0m13:30:43.464263 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:30:43.485856 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m13:30:43.487332 [debug] [ThreadPool]: Using postgres connection "list_IDX-Stock_IDX-Schema"
[0m13:30:43.488347 [debug] [ThreadPool]: On list_IDX-Stock_IDX-Schema: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "connection_name": "list_IDX-Stock_IDX-Schema"} */
select
      'IDX-Stock' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'IDX-Schema'
    union all
    select
      'IDX-Stock' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'IDX-Schema'
    union all
    select
      'IDX-Stock' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'IDX-Schema'
  
[0m13:30:43.494088 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.0 seconds
[0m13:30:43.495655 [debug] [ThreadPool]: On list_IDX-Stock_IDX-Schema: ROLLBACK
[0m13:30:43.497612 [debug] [ThreadPool]: On list_IDX-Stock_IDX-Schema: Close
[0m13:30:43.501664 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_IDX-Stock_IDX-Schema, now list_IDX-Stock_snapshots)
[0m13:30:43.507143 [debug] [ThreadPool]: Using postgres connection "list_IDX-Stock_snapshots"
[0m13:30:43.508149 [debug] [ThreadPool]: On list_IDX-Stock_snapshots: BEGIN
[0m13:30:43.509150 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:30:43.531538 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m13:30:43.533528 [debug] [ThreadPool]: Using postgres connection "list_IDX-Stock_snapshots"
[0m13:30:43.533528 [debug] [ThreadPool]: On list_IDX-Stock_snapshots: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "connection_name": "list_IDX-Stock_snapshots"} */
select
      'IDX-Stock' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'snapshots'
    union all
    select
      'IDX-Stock' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'snapshots'
    union all
    select
      'IDX-Stock' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'snapshots'
  
[0m13:30:43.538661 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.0 seconds
[0m13:30:43.540695 [debug] [ThreadPool]: On list_IDX-Stock_snapshots: ROLLBACK
[0m13:30:43.542665 [debug] [ThreadPool]: On list_IDX-Stock_snapshots: Close
[0m13:30:43.550782 [debug] [MainThread]: Using postgres connection "master"
[0m13:30:43.551802 [debug] [MainThread]: On master: BEGIN
[0m13:30:43.552781 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:30:43.575665 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m13:30:43.577175 [debug] [MainThread]: Using postgres connection "master"
[0m13:30:43.578227 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m13:30:43.584180 [debug] [MainThread]: SQL status: SELECT 0 in 0.0 seconds
[0m13:30:43.585828 [debug] [MainThread]: On master: ROLLBACK
[0m13:30:43.588037 [debug] [MainThread]: Using postgres connection "master"
[0m13:30:43.589083 [debug] [MainThread]: On master: BEGIN
[0m13:30:43.592084 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m13:30:43.593135 [debug] [MainThread]: On master: COMMIT
[0m13:30:43.594140 [debug] [MainThread]: Using postgres connection "master"
[0m13:30:43.594140 [debug] [MainThread]: On master: COMMIT
[0m13:30:43.596731 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m13:30:43.596731 [debug] [MainThread]: On master: Close
[0m13:30:43.598714 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:30:43.599710 [info ] [MainThread]: 
[0m13:30:43.604709 [debug] [Thread-1 (]: Began running node model.dbt_idx.stg_eltool__customers
[0m13:30:43.605736 [info ] [Thread-1 (]: 1 of 7 START sql view model IDX-Schema.stg_eltool__customers ................... [RUN]
[0m13:30:43.607022 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.dbt_idx.stg_eltool__customers'
[0m13:30:43.609029 [debug] [Thread-1 (]: Began compiling node model.dbt_idx.stg_eltool__customers
[0m13:30:43.617626 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_idx.stg_eltool__customers"
[0m13:30:43.624087 [debug] [Thread-1 (]: Timing info for model.dbt_idx.stg_eltool__customers (compile): 13:30:43.610023 => 13:30:43.624087
[0m13:30:43.625648 [debug] [Thread-1 (]: Began executing node model.dbt_idx.stg_eltool__customers
[0m13:30:43.663162 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_idx.stg_eltool__customers"
[0m13:30:43.670153 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__customers"
[0m13:30:43.672176 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__customers: BEGIN
[0m13:30:43.673155 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m13:30:43.698761 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m13:30:43.699761 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__customers"
[0m13:30:43.700761 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__customers: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__customers"} */

  create view "IDX-Stock"."IDX-Schema"."stg_eltool__customers__dbt_tmp"
    
    
  as (
    with source as (select *
                from "IDX-Stock"."IDX-Schema"."customers"),
     renamed as (select
                     customer_id,
                    'This is Dummy' as dummy
                 from source
                 where customer_id = 1234567890)
select *
from renamed
  );
[0m13:30:43.708290 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m13:30:43.715885 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__customers"
[0m13:30:43.716803 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__customers: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__customers"} */
alter table "IDX-Stock"."IDX-Schema"."stg_eltool__customers__dbt_tmp" rename to "stg_eltool__customers"
[0m13:30:43.719748 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:30:43.737991 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__customers: COMMIT
[0m13:30:43.738964 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__customers"
[0m13:30:43.738964 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__customers: COMMIT
[0m13:30:43.742817 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m13:30:43.752398 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__customers"
[0m13:30:43.753386 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__customers: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__customers"} */
drop view if exists "IDX-Stock"."IDX-Schema"."stg_eltool__customers__dbt_backup" cascade
[0m13:30:43.756013 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m13:30:43.757956 [debug] [Thread-1 (]: Timing info for model.dbt_idx.stg_eltool__customers (execute): 13:30:43.626612 => 13:30:43.757956
[0m13:30:43.757956 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__customers: Close
[0m13:30:43.759940 [info ] [Thread-1 (]: 1 of 7 OK created sql view model IDX-Schema.stg_eltool__customers .............. [[32mCREATE VIEW[0m in 0.15s]
[0m13:30:43.762923 [debug] [Thread-1 (]: Finished running node model.dbt_idx.stg_eltool__customers
[0m13:30:43.763955 [debug] [Thread-1 (]: Began running node model.dbt_idx.stg_eltool__customers_snapshots
[0m13:30:43.764929 [info ] [Thread-1 (]: 2 of 7 START sql view model IDX-Schema.stg_eltool__customers_snapshots ......... [RUN]
[0m13:30:43.767044 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_idx.stg_eltool__customers, now model.dbt_idx.stg_eltool__customers_snapshots)
[0m13:30:43.768068 [debug] [Thread-1 (]: Began compiling node model.dbt_idx.stg_eltool__customers_snapshots
[0m13:30:43.774052 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_idx.stg_eltool__customers_snapshots"
[0m13:30:43.781167 [debug] [Thread-1 (]: Timing info for model.dbt_idx.stg_eltool__customers_snapshots (compile): 13:30:43.769051 => 13:30:43.781167
[0m13:30:43.782163 [debug] [Thread-1 (]: Began executing node model.dbt_idx.stg_eltool__customers_snapshots
[0m13:30:43.787756 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_idx.stg_eltool__customers_snapshots"
[0m13:30:43.796867 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__customers_snapshots"
[0m13:30:43.797868 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__customers_snapshots: BEGIN
[0m13:30:43.798845 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:30:43.824138 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m13:30:43.824138 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__customers_snapshots"
[0m13:30:43.825700 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__customers_snapshots: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__customers_snapshots"} */

  create view "IDX-Stock"."IDX-Schema"."stg_eltool__customers_snapshots__dbt_tmp"
    
    
  as (
    with source as (select *
                from "IDX-Stock"."snapshots"."customers_snapshot"),
     renamed as (select customer_id,
                        zipcode,
                        city,
                        state_code,
                        datetime_created::TIMESTAMP AS datetime_created,
                        datetime_updated::TIMESTAMP AS datetime_updated,
                        dbt_valid_from,
                        dbt_valid_to
                 from source)
select *
from renamed
  );
[0m13:30:43.831666 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m13:30:43.836803 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__customers_snapshots"
[0m13:30:43.837807 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__customers_snapshots: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__customers_snapshots"} */
alter table "IDX-Stock"."IDX-Schema"."stg_eltool__customers_snapshots__dbt_tmp" rename to "stg_eltool__customers_snapshots"
[0m13:30:43.841818 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:30:43.843802 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__customers_snapshots: COMMIT
[0m13:30:43.844801 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__customers_snapshots"
[0m13:30:43.845802 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__customers_snapshots: COMMIT
[0m13:30:43.849317 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m13:30:43.853349 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__customers_snapshots"
[0m13:30:43.854315 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__customers_snapshots: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__customers_snapshots"} */
drop view if exists "IDX-Stock"."IDX-Schema"."stg_eltool__customers_snapshots__dbt_backup" cascade
[0m13:30:43.855822 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m13:30:43.858864 [debug] [Thread-1 (]: Timing info for model.dbt_idx.stg_eltool__customers_snapshots (execute): 13:30:43.783160 => 13:30:43.858864
[0m13:30:43.859830 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__customers_snapshots: Close
[0m13:30:43.861840 [info ] [Thread-1 (]: 2 of 7 OK created sql view model IDX-Schema.stg_eltool__customers_snapshots .... [[32mCREATE VIEW[0m in 0.09s]
[0m13:30:43.863833 [debug] [Thread-1 (]: Finished running node model.dbt_idx.stg_eltool__customers_snapshots
[0m13:30:43.864841 [debug] [Thread-1 (]: Began running node model.dbt_idx.stg_eltool__orders
[0m13:30:43.865830 [info ] [Thread-1 (]: 3 of 7 START sql view model IDX-Schema.stg_eltool__orders ...................... [RUN]
[0m13:30:43.866960 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_idx.stg_eltool__customers_snapshots, now model.dbt_idx.stg_eltool__orders)
[0m13:30:43.867970 [debug] [Thread-1 (]: Began compiling node model.dbt_idx.stg_eltool__orders
[0m13:30:43.870991 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_idx.stg_eltool__orders"
[0m13:30:43.883579 [debug] [Thread-1 (]: Timing info for model.dbt_idx.stg_eltool__orders (compile): 13:30:43.868979 => 13:30:43.883579
[0m13:30:43.884577 [debug] [Thread-1 (]: Began executing node model.dbt_idx.stg_eltool__orders
[0m13:30:43.890007 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_idx.stg_eltool__orders"
[0m13:30:43.901536 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__orders"
[0m13:30:43.903527 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__orders: BEGIN
[0m13:30:43.904527 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:30:43.928394 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m13:30:43.929410 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__orders"
[0m13:30:43.929410 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__orders: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__orders"} */

  create view "IDX-Stock"."IDX-Schema"."stg_eltool__orders__dbt_tmp"
    
    
  as (
    with source as (select *
                from "IDX-Stock"."IDX-Schema"."orders"),
     renamed as (select order_id,
                        cust_id AS customer_id,
                        order_status,
                        order_purchase_timestamp::TIMESTAMP,
                        order_approved_at::TIMESTAMP,
                        order_delivered_carrier_date::TIMESTAMP,
                        order_delivered_customer_date::TIMESTAMP,
                        order_estimated_delivery_date::TIMESTAMP
                 from source)
select *
from renamed
  );
[0m13:30:43.934405 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m13:30:43.938994 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__orders"
[0m13:30:43.939998 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__orders: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__orders"} */
alter table "IDX-Stock"."IDX-Schema"."stg_eltool__orders__dbt_tmp" rename to "stg_eltool__orders"
[0m13:30:43.942960 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:30:43.945553 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__orders: COMMIT
[0m13:30:43.946578 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__orders"
[0m13:30:43.947566 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__orders: COMMIT
[0m13:30:43.951581 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m13:30:43.954617 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__orders"
[0m13:30:43.955582 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__orders: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__orders"} */
drop view if exists "IDX-Stock"."IDX-Schema"."stg_eltool__orders__dbt_backup" cascade
[0m13:30:43.958137 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m13:30:43.963732 [debug] [Thread-1 (]: Timing info for model.dbt_idx.stg_eltool__orders (execute): 13:30:43.885580 => 13:30:43.962530
[0m13:30:43.965363 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__orders: Close
[0m13:30:43.969307 [info ] [Thread-1 (]: 3 of 7 OK created sql view model IDX-Schema.stg_eltool__orders ................. [[32mCREATE VIEW[0m in 0.10s]
[0m13:30:43.972133 [debug] [Thread-1 (]: Finished running node model.dbt_idx.stg_eltool__orders
[0m13:30:43.974330 [debug] [Thread-1 (]: Began running node model.dbt_idx.stg_eltool__state
[0m13:30:43.975947 [info ] [Thread-1 (]: 4 of 7 START sql view model IDX-Schema.stg_eltool__state ....................... [RUN]
[0m13:30:43.978213 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_idx.stg_eltool__orders, now model.dbt_idx.stg_eltool__state)
[0m13:30:43.979583 [debug] [Thread-1 (]: Began compiling node model.dbt_idx.stg_eltool__state
[0m13:30:43.984490 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_idx.stg_eltool__state"
[0m13:30:43.994029 [debug] [Thread-1 (]: Timing info for model.dbt_idx.stg_eltool__state (compile): 13:30:43.980341 => 13:30:43.994029
[0m13:30:43.995671 [debug] [Thread-1 (]: Began executing node model.dbt_idx.stg_eltool__state
[0m13:30:44.000635 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_idx.stg_eltool__state"
[0m13:30:44.007704 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__state"
[0m13:30:44.008712 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__state: BEGIN
[0m13:30:44.009682 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:30:44.062639 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m13:30:44.063704 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__state"
[0m13:30:44.064643 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__state: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__state"} */

  create view "IDX-Stock"."IDX-Schema"."stg_eltool__state__dbt_tmp"
    
    
  as (
    with source as (select *
                from "IDX-Stock"."IDX-Schema"."state"),
     renamed as (select state_identifier::INT AS state_id,
                         state_code::VARCHAR(2) AS state_code,
                         st_name::VARCHAR(30) AS state_name
                 from source)
select *
from renamed
  );
[0m13:30:44.069160 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m13:30:44.074156 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__state"
[0m13:30:44.074156 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__state: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__state"} */
alter table "IDX-Stock"."IDX-Schema"."stg_eltool__state__dbt_tmp" rename to "stg_eltool__state"
[0m13:30:44.078733 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:30:44.080692 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__state: COMMIT
[0m13:30:44.081674 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__state"
[0m13:30:44.081674 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__state: COMMIT
[0m13:30:44.085810 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m13:30:44.090207 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__state"
[0m13:30:44.090207 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__state: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__state"} */
drop view if exists "IDX-Stock"."IDX-Schema"."stg_eltool__state__dbt_backup" cascade
[0m13:30:44.093157 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m13:30:44.095743 [debug] [Thread-1 (]: Timing info for model.dbt_idx.stg_eltool__state (execute): 13:30:43.995671 => 13:30:44.094203
[0m13:30:44.096750 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__state: Close
[0m13:30:44.098756 [info ] [Thread-1 (]: 4 of 7 OK created sql view model IDX-Schema.stg_eltool__state .................. [[32mCREATE VIEW[0m in 0.12s]
[0m13:30:44.100755 [debug] [Thread-1 (]: Finished running node model.dbt_idx.stg_eltool__state
[0m13:30:44.102266 [debug] [Thread-1 (]: Began running node model.dbt_idx.fact_orders
[0m13:30:44.103278 [info ] [Thread-1 (]: 5 of 7 START sql table model IDX-Schema.fact_orders ............................ [RUN]
[0m13:30:44.104277 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_idx.stg_eltool__state, now model.dbt_idx.fact_orders)
[0m13:30:44.105808 [debug] [Thread-1 (]: Began compiling node model.dbt_idx.fact_orders
[0m13:30:44.110818 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_idx.fact_orders"
[0m13:30:44.121035 [debug] [Thread-1 (]: Timing info for model.dbt_idx.fact_orders (compile): 13:30:44.106816 => 13:30:44.120496
[0m13:30:44.122858 [debug] [Thread-1 (]: Began executing node model.dbt_idx.fact_orders
[0m13:30:44.152051 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_idx.fact_orders"
[0m13:30:44.158526 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.fact_orders"
[0m13:30:44.160533 [debug] [Thread-1 (]: On model.dbt_idx.fact_orders: BEGIN
[0m13:30:44.161529 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:30:44.182709 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m13:30:44.183737 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.fact_orders"
[0m13:30:44.184719 [debug] [Thread-1 (]: On model.dbt_idx.fact_orders: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.fact_orders"} */

  
    

  create  table "IDX-Stock"."IDX-Schema"."fact_orders__dbt_tmp"
  
  
    as
  
  (
    with orders as (
    select *
    from "IDX-Stock"."IDX-Schema"."stg_eltool__orders"
)
select * from orders
  );
  
[0m13:30:44.195550 [debug] [Thread-1 (]: SQL status: SELECT 999 in 0.0 seconds
[0m13:30:44.199573 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.fact_orders"
[0m13:30:44.199573 [debug] [Thread-1 (]: On model.dbt_idx.fact_orders: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.fact_orders"} */
alter table "IDX-Stock"."IDX-Schema"."fact_orders__dbt_tmp" rename to "fact_orders"
[0m13:30:44.203596 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:30:44.209187 [debug] [Thread-1 (]: On model.dbt_idx.fact_orders: COMMIT
[0m13:30:44.210156 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.fact_orders"
[0m13:30:44.211155 [debug] [Thread-1 (]: On model.dbt_idx.fact_orders: COMMIT
[0m13:30:44.215701 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m13:30:44.222707 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.fact_orders"
[0m13:30:44.223745 [debug] [Thread-1 (]: On model.dbt_idx.fact_orders: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.fact_orders"} */
drop table if exists "IDX-Stock"."IDX-Schema"."fact_orders__dbt_backup" cascade
[0m13:30:44.225761 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m13:30:44.227990 [debug] [Thread-1 (]: Timing info for model.dbt_idx.fact_orders (execute): 13:30:44.124222 => 13:30:44.227990
[0m13:30:44.228987 [debug] [Thread-1 (]: On model.dbt_idx.fact_orders: Close
[0m13:30:44.230975 [info ] [Thread-1 (]: 5 of 7 OK created sql table model IDX-Schema.fact_orders ....................... [[32mSELECT 999[0m in 0.13s]
[0m13:30:44.232952 [debug] [Thread-1 (]: Finished running node model.dbt_idx.fact_orders
[0m13:30:44.233954 [debug] [Thread-1 (]: Began running node model.dbt_idx.dim_customers
[0m13:30:44.235478 [info ] [Thread-1 (]: 6 of 7 START sql table model IDX-Schema.dim_customers .......................... [RUN]
[0m13:30:44.236513 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_idx.fact_orders, now model.dbt_idx.dim_customers)
[0m13:30:44.237483 [debug] [Thread-1 (]: Began compiling node model.dbt_idx.dim_customers
[0m13:30:44.240519 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_idx.dim_customers"
[0m13:30:44.247037 [debug] [Thread-1 (]: Timing info for model.dbt_idx.dim_customers (compile): 13:30:44.238487 => 13:30:44.247037
[0m13:30:44.248061 [debug] [Thread-1 (]: Began executing node model.dbt_idx.dim_customers
[0m13:30:44.253071 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_idx.dim_customers"
[0m13:30:44.258586 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.dim_customers"
[0m13:30:44.259625 [debug] [Thread-1 (]: On model.dbt_idx.dim_customers: BEGIN
[0m13:30:44.260586 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:30:44.284178 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m13:30:44.284178 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.dim_customers"
[0m13:30:44.285813 [debug] [Thread-1 (]: On model.dbt_idx.dim_customers: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.dim_customers"} */

  
    

  create  table "IDX-Stock"."IDX-Schema"."dim_customers__dbt_tmp"
  
  
    as
  
  (
    -- noinspection SqlDialectInspectionForFile

with customers as (
    select *
    from "IDX-Stock"."IDX-Schema"."stg_eltool__customers_snapshots"
    ),
     state as (
         select *
         from "IDX-Stock"."IDX-Schema"."stg_eltool__state"
     )
select c.customer_id,
       c.zipcode,
       c.city,
       c.state_code,
       s.state_name,
       c.datetime_created,
       c.datetime_updated,
       c.dbt_valid_from::TIMESTAMP as valid_from,
        CASE WHEN c.dbt_valid_to IS NULL
            THEN '9999-12-31'::TIMESTAMP
            ELSE c.dbt_valid_to::TIMESTAMP
        END as valid_to
from customers c
    join state s on c.state_code = s.state_code
  );
  
[0m13:30:44.290750 [debug] [Thread-1 (]: SQL status: SELECT 100 in 0.0 seconds
[0m13:30:44.295764 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.dim_customers"
[0m13:30:44.296276 [debug] [Thread-1 (]: On model.dbt_idx.dim_customers: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.dim_customers"} */
alter table "IDX-Stock"."IDX-Schema"."dim_customers__dbt_tmp" rename to "dim_customers"
[0m13:30:44.299284 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:30:44.301284 [debug] [Thread-1 (]: On model.dbt_idx.dim_customers: COMMIT
[0m13:30:44.302320 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.dim_customers"
[0m13:30:44.303285 [debug] [Thread-1 (]: On model.dbt_idx.dim_customers: COMMIT
[0m13:30:44.307821 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m13:30:44.313798 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.dim_customers"
[0m13:30:44.314797 [debug] [Thread-1 (]: On model.dbt_idx.dim_customers: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.dim_customers"} */
drop table if exists "IDX-Stock"."IDX-Schema"."dim_customers__dbt_backup" cascade
[0m13:30:44.317193 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m13:30:44.320236 [debug] [Thread-1 (]: Timing info for model.dbt_idx.dim_customers (execute): 13:30:44.249073 => 13:30:44.320236
[0m13:30:44.321254 [debug] [Thread-1 (]: On model.dbt_idx.dim_customers: Close
[0m13:30:44.323233 [info ] [Thread-1 (]: 6 of 7 OK created sql table model IDX-Schema.dim_customers ..................... [[32mSELECT 100[0m in 0.09s]
[0m13:30:44.324194 [debug] [Thread-1 (]: Finished running node model.dbt_idx.dim_customers
[0m13:30:44.325721 [debug] [Thread-1 (]: Began running node model.dbt_idx.customer_orders_status
[0m13:30:44.327734 [info ] [Thread-1 (]: 7 of 7 START sql view model IDX-Schema.customer_orders_status .................. [RUN]
[0m13:30:44.329730 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_idx.dim_customers, now model.dbt_idx.customer_orders_status)
[0m13:30:44.330729 [debug] [Thread-1 (]: Began compiling node model.dbt_idx.customer_orders_status
[0m13:30:44.333766 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_idx.customer_orders_status"
[0m13:30:44.341281 [debug] [Thread-1 (]: Timing info for model.dbt_idx.customer_orders_status (compile): 13:30:44.330729 => 13:30:44.341281
[0m13:30:44.343255 [debug] [Thread-1 (]: Began executing node model.dbt_idx.customer_orders_status
[0m13:30:44.348807 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_idx.customer_orders_status"
[0m13:30:44.358229 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.customer_orders_status"
[0m13:30:44.358796 [debug] [Thread-1 (]: On model.dbt_idx.customer_orders_status: BEGIN
[0m13:30:44.359985 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:30:44.383223 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m13:30:44.384260 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.customer_orders_status"
[0m13:30:44.385956 [debug] [Thread-1 (]: On model.dbt_idx.customer_orders_status: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.customer_orders_status"} */

  create view "IDX-Stock"."IDX-Schema"."customer_orders_status__dbt_tmp"
    
    
  as (
    with orders as (select *
                from "IDX-Stock"."IDX-Schema"."fact_orders"),
     customers as (select *
                   from "IDX-Stock"."IDX-Schema"."dim_customers")
select o.order_id,
       o.customer_id,
       o.order_status,
       o.order_purchase_timestamp,
       o.order_approved_at,
       o.order_delivered_carrier_date,
       o.order_delivered_customer_date,
       o.order_estimated_delivery_date,
       c.zipcode    as customer_zipcode,
       c.city       as customer_city,
       c.state_code as customer_state_code,
       c.state_name as customer_state_name
from orders o
    join customers c on o.customer_id = c.customer_id
    and o.order_purchase_timestamp >= c.valid_from
    and o.order_purchase_timestamp <= c.valid_to
  );
[0m13:30:44.391813 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m13:30:44.396354 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.customer_orders_status"
[0m13:30:44.397366 [debug] [Thread-1 (]: On model.dbt_idx.customer_orders_status: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.customer_orders_status"} */
alter table "IDX-Stock"."IDX-Schema"."customer_orders_status__dbt_tmp" rename to "customer_orders_status"
[0m13:30:44.400377 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:30:44.403408 [debug] [Thread-1 (]: On model.dbt_idx.customer_orders_status: COMMIT
[0m13:30:44.403408 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.customer_orders_status"
[0m13:30:44.404374 [debug] [Thread-1 (]: On model.dbt_idx.customer_orders_status: COMMIT
[0m13:30:44.409137 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m13:30:44.412139 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.customer_orders_status"
[0m13:30:44.413176 [debug] [Thread-1 (]: On model.dbt_idx.customer_orders_status: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.customer_orders_status"} */
drop view if exists "IDX-Stock"."IDX-Schema"."customer_orders_status__dbt_backup" cascade
[0m13:30:44.415648 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m13:30:44.417684 [debug] [Thread-1 (]: Timing info for model.dbt_idx.customer_orders_status (execute): 13:30:44.344255 => 13:30:44.417684
[0m13:30:44.418680 [debug] [Thread-1 (]: On model.dbt_idx.customer_orders_status: Close
[0m13:30:44.421658 [info ] [Thread-1 (]: 7 of 7 OK created sql view model IDX-Schema.customer_orders_status ............. [[32mCREATE VIEW[0m in 0.09s]
[0m13:30:44.423657 [debug] [Thread-1 (]: Finished running node model.dbt_idx.customer_orders_status
[0m13:30:44.427123 [debug] [MainThread]: Using postgres connection "master"
[0m13:30:44.428128 [debug] [MainThread]: On master: BEGIN
[0m13:30:44.429145 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:30:44.453545 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m13:30:44.454545 [debug] [MainThread]: On master: COMMIT
[0m13:30:44.455545 [debug] [MainThread]: Using postgres connection "master"
[0m13:30:44.456050 [debug] [MainThread]: On master: COMMIT
[0m13:30:44.458091 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m13:30:44.459065 [debug] [MainThread]: On master: Close
[0m13:30:44.460065 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:30:44.461069 [debug] [MainThread]: Connection 'list_IDX-Stock' was properly closed.
[0m13:30:44.462067 [debug] [MainThread]: Connection 'list_IDX-Stock_snapshots' was properly closed.
[0m13:30:44.463101 [debug] [MainThread]: Connection 'model.dbt_idx.customer_orders_status' was properly closed.
[0m13:30:44.464067 [info ] [MainThread]: 
[0m13:30:44.465572 [info ] [MainThread]: Finished running 5 view models, 2 table models in 0 hours 0 minutes and 1.06 seconds (1.06s).
[0m13:30:44.468102 [debug] [MainThread]: Command end result
[0m13:30:44.496780 [info ] [MainThread]: 
[0m13:30:44.497808 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:30:44.498798 [info ] [MainThread]: 
[0m13:30:44.499786 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=0 SKIP=0 TOTAL=7
[0m13:30:44.500785 [debug] [MainThread]: Command `dbt run` succeeded at 13:30:44.500785 after 1.51 seconds
[0m13:30:44.501787 [debug] [MainThread]: Flushing usage events


============================== 19:05:25.145046 | 8a7e4b77-e2e9-4815-8d8b-3eb8625ed6d2 ==============================
[0m19:05:25.145046 [info ] [MainThread]: Running with dbt=1.6.1
[0m19:05:25.179093 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'D:\\00 Project\\00 My Project\\IdeaProjects\\Py-DBT-IDX\\logs', 'debug': 'False', 'profiles_dir': 'D:\\00 Project\\00 My Project\\IdeaProjects\\Py-DBT-IDX', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'False'}
[0m19:05:25.313989 [info ] [MainThread]: Registered adapter: postgres=1.6.1
[0m19:05:25.322983 [debug] [MainThread]: checksum: efe19d9f5b93d1a98cc804fbfcdb6b3aced98b974af664946fee1cde8837deb7, vars: {}, profile: , target: , version: 1.6.1
[0m19:05:25.496260 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 2 files added, 1 files changed.
[0m19:05:25.497258 [debug] [MainThread]: Partial parsing: added file: dbt_idx://models\staging\stg_eltool__company.sql
[0m19:05:25.498259 [debug] [MainThread]: Partial parsing: added file: dbt_idx://models\staging\stg_eltool__stock.sql
[0m19:05:25.499260 [debug] [MainThread]: Partial parsing: updated file: dbt_idx://models\staging\src_eltool.yml
[0m19:05:25.708027 [info ] [MainThread]: Found 9 models, 1 snapshot, 14 tests, 5 sources, 0 exposures, 0 metrics, 349 macros, 0 groups, 0 semantic models
[0m19:05:25.711311 [info ] [MainThread]: 
[0m19:05:25.712265 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m19:05:25.715268 [debug] [ThreadPool]: Acquiring new postgres connection 'list_IDX-Stock'
[0m19:05:25.725268 [debug] [ThreadPool]: Using postgres connection "list_IDX-Stock"
[0m19:05:25.726288 [debug] [ThreadPool]: On list_IDX-Stock: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "connection_name": "list_IDX-Stock"} */

    select distinct nspname from pg_namespace
  
[0m19:05:25.726288 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:05:25.890490 [debug] [ThreadPool]: SQL status: SELECT 12 in 0.0 seconds
[0m19:05:25.896066 [debug] [ThreadPool]: On list_IDX-Stock: Close
[0m19:05:25.903012 [debug] [ThreadPool]: Acquiring new postgres connection 'list_IDX-Stock_snapshots'
[0m19:05:25.915683 [debug] [ThreadPool]: Using postgres connection "list_IDX-Stock_snapshots"
[0m19:05:25.917213 [debug] [ThreadPool]: On list_IDX-Stock_snapshots: BEGIN
[0m19:05:25.919243 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:05:25.947319 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m19:05:25.948317 [debug] [ThreadPool]: Using postgres connection "list_IDX-Stock_snapshots"
[0m19:05:25.949319 [debug] [ThreadPool]: On list_IDX-Stock_snapshots: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "connection_name": "list_IDX-Stock_snapshots"} */
select
      'IDX-Stock' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'snapshots'
    union all
    select
      'IDX-Stock' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'snapshots'
    union all
    select
      'IDX-Stock' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'snapshots'
  
[0m19:05:25.956581 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.0 seconds
[0m19:05:25.958582 [debug] [ThreadPool]: On list_IDX-Stock_snapshots: ROLLBACK
[0m19:05:25.961593 [debug] [ThreadPool]: On list_IDX-Stock_snapshots: Close
[0m19:05:25.965147 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_IDX-Stock_snapshots, now list_IDX-Stock_IDX-Schema)
[0m19:05:25.971179 [debug] [ThreadPool]: Using postgres connection "list_IDX-Stock_IDX-Schema"
[0m19:05:25.971179 [debug] [ThreadPool]: On list_IDX-Stock_IDX-Schema: BEGIN
[0m19:05:25.972691 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:05:26.002066 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m19:05:26.003050 [debug] [ThreadPool]: Using postgres connection "list_IDX-Stock_IDX-Schema"
[0m19:05:26.004070 [debug] [ThreadPool]: On list_IDX-Stock_IDX-Schema: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "connection_name": "list_IDX-Stock_IDX-Schema"} */
select
      'IDX-Stock' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'IDX-Schema'
    union all
    select
      'IDX-Stock' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'IDX-Schema'
    union all
    select
      'IDX-Stock' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'IDX-Schema'
  
[0m19:05:26.007853 [debug] [ThreadPool]: SQL status: SELECT 13 in 0.0 seconds
[0m19:05:26.009399 [debug] [ThreadPool]: On list_IDX-Stock_IDX-Schema: ROLLBACK
[0m19:05:26.011407 [debug] [ThreadPool]: On list_IDX-Stock_IDX-Schema: Close
[0m19:05:26.020405 [debug] [MainThread]: Using postgres connection "master"
[0m19:05:26.021439 [debug] [MainThread]: On master: BEGIN
[0m19:05:26.022444 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:05:26.042438 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m19:05:26.043422 [debug] [MainThread]: Using postgres connection "master"
[0m19:05:26.043422 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m19:05:26.053421 [debug] [MainThread]: SQL status: SELECT 6 in 0.0 seconds
[0m19:05:26.056456 [debug] [MainThread]: On master: ROLLBACK
[0m19:05:26.058452 [debug] [MainThread]: Using postgres connection "master"
[0m19:05:26.059437 [debug] [MainThread]: On master: BEGIN
[0m19:05:26.062702 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m19:05:26.062702 [debug] [MainThread]: On master: COMMIT
[0m19:05:26.063737 [debug] [MainThread]: Using postgres connection "master"
[0m19:05:26.064704 [debug] [MainThread]: On master: COMMIT
[0m19:05:26.066701 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m19:05:26.066701 [debug] [MainThread]: On master: Close
[0m19:05:26.068707 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m19:05:26.069706 [info ] [MainThread]: 
[0m19:05:26.075701 [debug] [Thread-1 (]: Began running node model.dbt_idx.stg_eltool__company
[0m19:05:26.076704 [info ] [Thread-1 (]: 1 of 9 START sql view model IDX-Schema.stg_eltool__company ..................... [RUN]
[0m19:05:26.077727 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.dbt_idx.stg_eltool__company'
[0m19:05:26.077727 [debug] [Thread-1 (]: Began compiling node model.dbt_idx.stg_eltool__company
[0m19:05:26.084745 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_idx.stg_eltool__company"
[0m19:05:26.088583 [debug] [Thread-1 (]: Timing info for model.dbt_idx.stg_eltool__company (compile): 19:05:26.078726 => 19:05:26.088583
[0m19:05:26.090582 [debug] [Thread-1 (]: Began executing node model.dbt_idx.stg_eltool__company
[0m19:05:26.130177 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_idx.stg_eltool__company"
[0m19:05:26.135176 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__company"
[0m19:05:26.136192 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__company: BEGIN
[0m19:05:26.138194 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m19:05:26.162090 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m19:05:26.163106 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__company"
[0m19:05:26.164119 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__company: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__company"} */

  create view "IDX-Stock"."IDX-Schema"."stg_eltool__company__dbt_tmp"
    
    
  as (
    with source as (select *
                from "IDX-Stock"."IDX-Schema"."ksql-company-stream"),
     renamed as (select id,
                        ticker,
                        name,
                        logo
                 from source)
select *
from renamed
  );
[0m19:05:26.178259 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m19:05:26.186239 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__company"
[0m19:05:26.187240 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__company: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__company"} */
alter table "IDX-Stock"."IDX-Schema"."stg_eltool__company__dbt_tmp" rename to "stg_eltool__company"
[0m19:05:26.189527 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:05:26.205537 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__company: COMMIT
[0m19:05:26.206537 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__company"
[0m19:05:26.207564 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__company: COMMIT
[0m19:05:26.211091 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m19:05:26.220218 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__company"
[0m19:05:26.221236 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__company: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__company"} */
drop view if exists "IDX-Stock"."IDX-Schema"."stg_eltool__company__dbt_backup" cascade
[0m19:05:26.223226 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m19:05:26.226229 [debug] [Thread-1 (]: Timing info for model.dbt_idx.stg_eltool__company (execute): 19:05:26.090582 => 19:05:26.225229
[0m19:05:26.226229 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__company: Close
[0m19:05:26.229261 [info ] [Thread-1 (]: 1 of 9 OK created sql view model IDX-Schema.stg_eltool__company ................ [[32mCREATE VIEW[0m in 0.15s]
[0m19:05:26.231243 [debug] [Thread-1 (]: Finished running node model.dbt_idx.stg_eltool__company
[0m19:05:26.232233 [debug] [Thread-1 (]: Began running node model.dbt_idx.stg_eltool__customers
[0m19:05:26.233235 [info ] [Thread-1 (]: 2 of 9 START sql view model IDX-Schema.stg_eltool__customers ................... [RUN]
[0m19:05:26.235230 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_idx.stg_eltool__company, now model.dbt_idx.stg_eltool__customers)
[0m19:05:26.236245 [debug] [Thread-1 (]: Began compiling node model.dbt_idx.stg_eltool__customers
[0m19:05:26.239227 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_idx.stg_eltool__customers"
[0m19:05:26.246776 [debug] [Thread-1 (]: Timing info for model.dbt_idx.stg_eltool__customers (compile): 19:05:26.236245 => 19:05:26.246776
[0m19:05:26.247759 [debug] [Thread-1 (]: Began executing node model.dbt_idx.stg_eltool__customers
[0m19:05:26.252790 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_idx.stg_eltool__customers"
[0m19:05:26.259769 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__customers"
[0m19:05:26.260753 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__customers: BEGIN
[0m19:05:26.261752 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:05:26.287327 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m19:05:26.288828 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__customers"
[0m19:05:26.289840 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__customers: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__customers"} */

  create view "IDX-Stock"."IDX-Schema"."stg_eltool__customers__dbt_tmp"
    
    
  as (
    with source as (select *
                from "IDX-Stock"."IDX-Schema"."customers"),
     renamed as (select
                     customer_id,
                    'This is Dummy' as dummy
                 from source
                 where customer_id = 1234567890)
select *
from renamed
  );
[0m19:05:26.293835 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m19:05:26.300678 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__customers"
[0m19:05:26.301678 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__customers: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__customers"} */
alter table "IDX-Stock"."IDX-Schema"."stg_eltool__customers" rename to "stg_eltool__customers__dbt_backup"
[0m19:05:26.304680 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:05:26.308194 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__customers"
[0m19:05:26.309714 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__customers: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__customers"} */
alter table "IDX-Stock"."IDX-Schema"."stg_eltool__customers__dbt_tmp" rename to "stg_eltool__customers"
[0m19:05:26.311726 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:05:26.316761 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__customers: COMMIT
[0m19:05:26.317725 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__customers"
[0m19:05:26.318725 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__customers: COMMIT
[0m19:05:26.322726 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m19:05:26.327271 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__customers"
[0m19:05:26.327271 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__customers: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__customers"} */
drop view if exists "IDX-Stock"."IDX-Schema"."stg_eltool__customers__dbt_backup" cascade
[0m19:05:26.334271 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m19:05:26.336274 [debug] [Thread-1 (]: Timing info for model.dbt_idx.stg_eltool__customers (execute): 19:05:26.248757 => 19:05:26.336274
[0m19:05:26.337303 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__customers: Close
[0m19:05:26.340283 [info ] [Thread-1 (]: 2 of 9 OK created sql view model IDX-Schema.stg_eltool__customers .............. [[32mCREATE VIEW[0m in 0.11s]
[0m19:05:26.342271 [debug] [Thread-1 (]: Finished running node model.dbt_idx.stg_eltool__customers
[0m19:05:26.344309 [debug] [Thread-1 (]: Began running node model.dbt_idx.stg_eltool__customers_snapshots
[0m19:05:26.345272 [info ] [Thread-1 (]: 3 of 9 START sql view model IDX-Schema.stg_eltool__customers_snapshots ......... [RUN]
[0m19:05:26.347309 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_idx.stg_eltool__customers, now model.dbt_idx.stg_eltool__customers_snapshots)
[0m19:05:26.347309 [debug] [Thread-1 (]: Began compiling node model.dbt_idx.stg_eltool__customers_snapshots
[0m19:05:26.350670 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_idx.stg_eltool__customers_snapshots"
[0m19:05:26.358637 [debug] [Thread-1 (]: Timing info for model.dbt_idx.stg_eltool__customers_snapshots (compile): 19:05:26.348669 => 19:05:26.357636
[0m19:05:26.359636 [debug] [Thread-1 (]: Began executing node model.dbt_idx.stg_eltool__customers_snapshots
[0m19:05:26.364669 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_idx.stg_eltool__customers_snapshots"
[0m19:05:26.371898 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__customers_snapshots"
[0m19:05:26.372879 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__customers_snapshots: BEGIN
[0m19:05:26.374137 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:05:26.398044 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m19:05:26.399043 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__customers_snapshots"
[0m19:05:26.400045 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__customers_snapshots: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__customers_snapshots"} */

  create view "IDX-Stock"."IDX-Schema"."stg_eltool__customers_snapshots__dbt_tmp"
    
    
  as (
    with source as (select *
                from "IDX-Stock"."snapshots"."customers_snapshot"),
     renamed as (select customer_id,
                        zipcode,
                        city,
                        state_code,
                        datetime_created::TIMESTAMP AS datetime_created,
                        datetime_updated::TIMESTAMP AS datetime_updated,
                        dbt_valid_from,
                        dbt_valid_to
                 from source)
select *
from renamed
  );
[0m19:05:26.407063 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m19:05:26.411564 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__customers_snapshots"
[0m19:05:26.411564 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__customers_snapshots: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__customers_snapshots"} */
alter table "IDX-Stock"."IDX-Schema"."stg_eltool__customers_snapshots" rename to "stg_eltool__customers_snapshots__dbt_backup"
[0m19:05:26.414559 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:05:26.417565 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__customers_snapshots"
[0m19:05:26.418564 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__customers_snapshots: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__customers_snapshots"} */
alter table "IDX-Stock"."IDX-Schema"."stg_eltool__customers_snapshots__dbt_tmp" rename to "stg_eltool__customers_snapshots"
[0m19:05:26.421216 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:05:26.423226 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__customers_snapshots: COMMIT
[0m19:05:26.424228 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__customers_snapshots"
[0m19:05:26.425218 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__customers_snapshots: COMMIT
[0m19:05:26.428192 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m19:05:26.432216 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__customers_snapshots"
[0m19:05:26.433192 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__customers_snapshots: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__customers_snapshots"} */
drop view if exists "IDX-Stock"."IDX-Schema"."stg_eltool__customers_snapshots__dbt_backup" cascade
[0m19:05:26.436509 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m19:05:26.438555 [debug] [Thread-1 (]: Timing info for model.dbt_idx.stg_eltool__customers_snapshots (execute): 19:05:26.359636 => 19:05:26.438555
[0m19:05:26.439540 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__customers_snapshots: Close
[0m19:05:26.440524 [info ] [Thread-1 (]: 3 of 9 OK created sql view model IDX-Schema.stg_eltool__customers_snapshots .... [[32mCREATE VIEW[0m in 0.09s]
[0m19:05:26.443522 [debug] [Thread-1 (]: Finished running node model.dbt_idx.stg_eltool__customers_snapshots
[0m19:05:26.444521 [debug] [Thread-1 (]: Began running node model.dbt_idx.stg_eltool__orders
[0m19:05:26.445552 [info ] [Thread-1 (]: 4 of 9 START sql view model IDX-Schema.stg_eltool__orders ...................... [RUN]
[0m19:05:26.447524 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_idx.stg_eltool__customers_snapshots, now model.dbt_idx.stg_eltool__orders)
[0m19:05:26.448548 [debug] [Thread-1 (]: Began compiling node model.dbt_idx.stg_eltool__orders
[0m19:05:26.451521 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_idx.stg_eltool__orders"
[0m19:05:26.464556 [debug] [Thread-1 (]: Timing info for model.dbt_idx.stg_eltool__orders (compile): 19:05:26.448548 => 19:05:26.464556
[0m19:05:26.465520 [debug] [Thread-1 (]: Began executing node model.dbt_idx.stg_eltool__orders
[0m19:05:26.471519 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_idx.stg_eltool__orders"
[0m19:05:26.485519 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__orders"
[0m19:05:26.485519 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__orders: BEGIN
[0m19:05:26.486556 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:05:26.510052 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m19:05:26.511095 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__orders"
[0m19:05:26.512059 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__orders: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__orders"} */

  create view "IDX-Stock"."IDX-Schema"."stg_eltool__orders__dbt_tmp"
    
    
  as (
    with source as (select *
                from "IDX-Stock"."IDX-Schema"."orders"),
     renamed as (select order_id,
                        cust_id AS customer_id,
                        order_status,
                        order_purchase_timestamp::TIMESTAMP,
                        order_approved_at::TIMESTAMP,
                        order_delivered_carrier_date::TIMESTAMP,
                        order_delivered_customer_date::TIMESTAMP,
                        order_estimated_delivery_date::TIMESTAMP
                 from source)
select *
from renamed
  );
[0m19:05:26.518059 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m19:05:26.521057 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__orders"
[0m19:05:26.522058 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__orders: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__orders"} */
alter table "IDX-Stock"."IDX-Schema"."stg_eltool__orders" rename to "stg_eltool__orders__dbt_backup"
[0m19:05:26.525059 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:05:26.529093 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__orders"
[0m19:05:26.529093 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__orders: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__orders"} */
alter table "IDX-Stock"."IDX-Schema"."stg_eltool__orders__dbt_tmp" rename to "stg_eltool__orders"
[0m19:05:26.532058 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:05:26.534094 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__orders: COMMIT
[0m19:05:26.535062 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__orders"
[0m19:05:26.536060 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__orders: COMMIT
[0m19:05:26.539143 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m19:05:26.543144 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__orders"
[0m19:05:26.543144 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__orders: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__orders"} */
drop view if exists "IDX-Stock"."IDX-Schema"."stg_eltool__orders__dbt_backup" cascade
[0m19:05:26.548173 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m19:05:26.550147 [debug] [Thread-1 (]: Timing info for model.dbt_idx.stg_eltool__orders (execute): 19:05:26.466520 => 19:05:26.549168
[0m19:05:26.550147 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__orders: Close
[0m19:05:26.552151 [info ] [Thread-1 (]: 4 of 9 OK created sql view model IDX-Schema.stg_eltool__orders ................. [[32mCREATE VIEW[0m in 0.11s]
[0m19:05:26.555155 [debug] [Thread-1 (]: Finished running node model.dbt_idx.stg_eltool__orders
[0m19:05:26.557156 [debug] [Thread-1 (]: Began running node model.dbt_idx.stg_eltool__state
[0m19:05:26.558147 [info ] [Thread-1 (]: 5 of 9 START sql view model IDX-Schema.stg_eltool__state ....................... [RUN]
[0m19:05:26.560151 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_idx.stg_eltool__orders, now model.dbt_idx.stg_eltool__state)
[0m19:05:26.561152 [debug] [Thread-1 (]: Began compiling node model.dbt_idx.stg_eltool__state
[0m19:05:26.566695 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_idx.stg_eltool__state"
[0m19:05:26.576697 [debug] [Thread-1 (]: Timing info for model.dbt_idx.stg_eltool__state (compile): 19:05:26.562149 => 19:05:26.576064
[0m19:05:26.577696 [debug] [Thread-1 (]: Began executing node model.dbt_idx.stg_eltool__state
[0m19:05:26.631759 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_idx.stg_eltool__state"
[0m19:05:26.639779 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__state"
[0m19:05:26.639779 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__state: BEGIN
[0m19:05:26.640762 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:05:26.661759 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m19:05:26.662758 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__state"
[0m19:05:26.663758 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__state: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__state"} */

  create view "IDX-Stock"."IDX-Schema"."stg_eltool__state__dbt_tmp"
    
    
  as (
    with source as (select *
                from "IDX-Stock"."IDX-Schema"."state"),
     renamed as (select state_identifier::INT AS state_id,
                         state_code::VARCHAR(2) AS state_code,
                         st_name::VARCHAR(30) AS state_name
                 from source)
select *
from renamed
  );
[0m19:05:26.667758 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m19:05:26.670794 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__state"
[0m19:05:26.671794 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__state: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__state"} */
alter table "IDX-Stock"."IDX-Schema"."stg_eltool__state" rename to "stg_eltool__state__dbt_backup"
[0m19:05:26.674771 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:05:26.677796 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__state"
[0m19:05:26.678763 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__state: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__state"} */
alter table "IDX-Stock"."IDX-Schema"."stg_eltool__state__dbt_tmp" rename to "stg_eltool__state"
[0m19:05:26.680810 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:05:26.683761 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__state: COMMIT
[0m19:05:26.684773 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__state"
[0m19:05:26.685762 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__state: COMMIT
[0m19:05:26.689764 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m19:05:26.692760 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__state"
[0m19:05:26.693762 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__state: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__state"} */
drop view if exists "IDX-Stock"."IDX-Schema"."stg_eltool__state__dbt_backup" cascade
[0m19:05:26.698787 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m19:05:26.700822 [debug] [Thread-1 (]: Timing info for model.dbt_idx.stg_eltool__state (execute): 19:05:26.578696 => 19:05:26.700822
[0m19:05:26.701787 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__state: Close
[0m19:05:26.703793 [info ] [Thread-1 (]: 5 of 9 OK created sql view model IDX-Schema.stg_eltool__state .................. [[32mCREATE VIEW[0m in 0.14s]
[0m19:05:26.705789 [debug] [Thread-1 (]: Finished running node model.dbt_idx.stg_eltool__state
[0m19:05:26.706794 [debug] [Thread-1 (]: Began running node model.dbt_idx.stg_eltool__stock
[0m19:05:26.707822 [info ] [Thread-1 (]: 6 of 9 START sql view model IDX-Schema.stg_eltool__stock ....................... [RUN]
[0m19:05:26.708824 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_idx.stg_eltool__state, now model.dbt_idx.stg_eltool__stock)
[0m19:05:26.710335 [debug] [Thread-1 (]: Began compiling node model.dbt_idx.stg_eltool__stock
[0m19:05:26.713379 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_idx.stg_eltool__stock"
[0m19:05:26.717350 [debug] [Thread-1 (]: Timing info for model.dbt_idx.stg_eltool__stock (compile): 19:05:26.710335 => 19:05:26.717350
[0m19:05:26.718343 [debug] [Thread-1 (]: Began executing node model.dbt_idx.stg_eltool__stock
[0m19:05:26.722379 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_idx.stg_eltool__stock"
[0m19:05:26.725343 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__stock"
[0m19:05:26.726389 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__stock: BEGIN
[0m19:05:26.727383 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:05:26.748138 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m19:05:26.749162 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__stock"
[0m19:05:26.750158 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__stock: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__stock"} */

  create view "IDX-Stock"."IDX-Schema"."stg_eltool__stock__dbt_tmp"
    
    
  as (
    with source as (select *
                from "IDX-Stock"."IDX-Schema"."ksql-stock-stream"),
     renamed as (select id,
                        ticker,
                        date,
                        open,
                        high,
                        low,
                        close,
                        volume
                 from source)
select *
from renamed
  );
[0m19:05:26.753140 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m19:05:26.757160 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__stock"
[0m19:05:26.758135 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__stock: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__stock"} */
alter table "IDX-Stock"."IDX-Schema"."stg_eltool__stock__dbt_tmp" rename to "stg_eltool__stock"
[0m19:05:26.761135 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:05:26.763172 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__stock: COMMIT
[0m19:05:26.764136 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__stock"
[0m19:05:26.765164 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__stock: COMMIT
[0m19:05:26.769238 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m19:05:26.772234 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__stock"
[0m19:05:26.772234 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__stock: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__stock"} */
drop view if exists "IDX-Stock"."IDX-Schema"."stg_eltool__stock__dbt_backup" cascade
[0m19:05:26.775235 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m19:05:26.777269 [debug] [Thread-1 (]: Timing info for model.dbt_idx.stg_eltool__stock (execute): 19:05:26.718343 => 19:05:26.777269
[0m19:05:26.778247 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__stock: Close
[0m19:05:26.779251 [info ] [Thread-1 (]: 6 of 9 OK created sql view model IDX-Schema.stg_eltool__stock .................. [[32mCREATE VIEW[0m in 0.07s]
[0m19:05:26.781259 [debug] [Thread-1 (]: Finished running node model.dbt_idx.stg_eltool__stock
[0m19:05:26.782242 [debug] [Thread-1 (]: Began running node model.dbt_idx.fact_orders
[0m19:05:26.783235 [info ] [Thread-1 (]: 7 of 9 START sql table model IDX-Schema.fact_orders ............................ [RUN]
[0m19:05:26.785271 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_idx.stg_eltool__stock, now model.dbt_idx.fact_orders)
[0m19:05:26.785271 [debug] [Thread-1 (]: Began compiling node model.dbt_idx.fact_orders
[0m19:05:26.788269 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_idx.fact_orders"
[0m19:05:26.796251 [debug] [Thread-1 (]: Timing info for model.dbt_idx.fact_orders (compile): 19:05:26.786270 => 19:05:26.796251
[0m19:05:26.798261 [debug] [Thread-1 (]: Began executing node model.dbt_idx.fact_orders
[0m19:05:26.821836 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_idx.fact_orders"
[0m19:05:26.829838 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.fact_orders"
[0m19:05:26.830844 [debug] [Thread-1 (]: On model.dbt_idx.fact_orders: BEGIN
[0m19:05:26.831847 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:05:26.853937 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m19:05:26.854931 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.fact_orders"
[0m19:05:26.855966 [debug] [Thread-1 (]: On model.dbt_idx.fact_orders: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.fact_orders"} */

  
    

  create  table "IDX-Stock"."IDX-Schema"."fact_orders__dbt_tmp"
  
  
    as
  
  (
    with orders as (
    select *
    from "IDX-Stock"."IDX-Schema"."stg_eltool__orders"
)
select * from orders
  );
  
[0m19:05:26.863929 [debug] [Thread-1 (]: SQL status: SELECT 999 in 0.0 seconds
[0m19:05:26.866965 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.fact_orders"
[0m19:05:26.867933 [debug] [Thread-1 (]: On model.dbt_idx.fact_orders: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.fact_orders"} */
alter table "IDX-Stock"."IDX-Schema"."fact_orders" rename to "fact_orders__dbt_backup"
[0m19:05:26.869966 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:05:26.872933 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.fact_orders"
[0m19:05:26.873964 [debug] [Thread-1 (]: On model.dbt_idx.fact_orders: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.fact_orders"} */
alter table "IDX-Stock"."IDX-Schema"."fact_orders__dbt_tmp" rename to "fact_orders"
[0m19:05:26.876875 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:05:26.882885 [debug] [Thread-1 (]: On model.dbt_idx.fact_orders: COMMIT
[0m19:05:26.882885 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.fact_orders"
[0m19:05:26.883886 [debug] [Thread-1 (]: On model.dbt_idx.fact_orders: COMMIT
[0m19:05:26.887561 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m19:05:26.893589 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.fact_orders"
[0m19:05:26.894559 [debug] [Thread-1 (]: On model.dbt_idx.fact_orders: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.fact_orders"} */
drop table if exists "IDX-Stock"."IDX-Schema"."fact_orders__dbt_backup" cascade
[0m19:05:26.900566 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m19:05:26.902565 [debug] [Thread-1 (]: Timing info for model.dbt_idx.fact_orders (execute): 19:05:26.799265 => 19:05:26.902565
[0m19:05:26.902565 [debug] [Thread-1 (]: On model.dbt_idx.fact_orders: Close
[0m19:05:26.904566 [info ] [Thread-1 (]: 7 of 9 OK created sql table model IDX-Schema.fact_orders ....................... [[32mSELECT 999[0m in 0.12s]
[0m19:05:26.906577 [debug] [Thread-1 (]: Finished running node model.dbt_idx.fact_orders
[0m19:05:26.907568 [debug] [Thread-1 (]: Began running node model.dbt_idx.dim_customers
[0m19:05:26.908565 [info ] [Thread-1 (]: 8 of 9 START sql table model IDX-Schema.dim_customers .......................... [RUN]
[0m19:05:26.909565 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_idx.fact_orders, now model.dbt_idx.dim_customers)
[0m19:05:26.910601 [debug] [Thread-1 (]: Began compiling node model.dbt_idx.dim_customers
[0m19:05:26.913996 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_idx.dim_customers"
[0m19:05:26.920960 [debug] [Thread-1 (]: Timing info for model.dbt_idx.dim_customers (compile): 19:05:26.910601 => 19:05:26.920960
[0m19:05:26.921972 [debug] [Thread-1 (]: Began executing node model.dbt_idx.dim_customers
[0m19:05:26.926960 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_idx.dim_customers"
[0m19:05:26.965142 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.dim_customers"
[0m19:05:26.966113 [debug] [Thread-1 (]: On model.dbt_idx.dim_customers: BEGIN
[0m19:05:26.967113 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:05:26.989663 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m19:05:26.990637 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.dim_customers"
[0m19:05:26.990637 [debug] [Thread-1 (]: On model.dbt_idx.dim_customers: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.dim_customers"} */

  
    

  create  table "IDX-Stock"."IDX-Schema"."dim_customers__dbt_tmp"
  
  
    as
  
  (
    -- noinspection SqlDialectInspectionForFile

with customers as (
    select *
    from "IDX-Stock"."IDX-Schema"."stg_eltool__customers_snapshots"
    ),
     state as (
         select *
         from "IDX-Stock"."IDX-Schema"."stg_eltool__state"
     )
select c.customer_id,
       c.zipcode,
       c.city,
       c.state_code,
       s.state_name,
       c.datetime_created,
       c.datetime_updated,
       c.dbt_valid_from::TIMESTAMP as valid_from,
        CASE WHEN c.dbt_valid_to IS NULL
            THEN '9999-12-31'::TIMESTAMP
            ELSE c.dbt_valid_to::TIMESTAMP
        END as valid_to
from customers c
    join state s on c.state_code = s.state_code
  );
  
[0m19:05:26.997639 [debug] [Thread-1 (]: SQL status: SELECT 100 in 0.0 seconds
[0m19:05:27.000640 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.dim_customers"
[0m19:05:27.001672 [debug] [Thread-1 (]: On model.dbt_idx.dim_customers: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.dim_customers"} */
alter table "IDX-Stock"."IDX-Schema"."dim_customers" rename to "dim_customers__dbt_backup"
[0m19:05:27.003636 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:05:27.006673 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.dim_customers"
[0m19:05:27.007673 [debug] [Thread-1 (]: On model.dbt_idx.dim_customers: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.dim_customers"} */
alter table "IDX-Stock"."IDX-Schema"."dim_customers__dbt_tmp" rename to "dim_customers"
[0m19:05:27.010640 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:05:27.013205 [debug] [Thread-1 (]: On model.dbt_idx.dim_customers: COMMIT
[0m19:05:27.013205 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.dim_customers"
[0m19:05:27.014175 [debug] [Thread-1 (]: On model.dbt_idx.dim_customers: COMMIT
[0m19:05:27.017170 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m19:05:27.020198 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.dim_customers"
[0m19:05:27.021194 [debug] [Thread-1 (]: On model.dbt_idx.dim_customers: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.dim_customers"} */
drop table if exists "IDX-Stock"."IDX-Schema"."dim_customers__dbt_backup" cascade
[0m19:05:27.026186 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m19:05:27.028174 [debug] [Thread-1 (]: Timing info for model.dbt_idx.dim_customers (execute): 19:05:26.922959 => 19:05:27.027174
[0m19:05:27.028174 [debug] [Thread-1 (]: On model.dbt_idx.dim_customers: Close
[0m19:05:27.030178 [info ] [Thread-1 (]: 8 of 9 OK created sql table model IDX-Schema.dim_customers ..................... [[32mSELECT 100[0m in 0.12s]
[0m19:05:27.032175 [debug] [Thread-1 (]: Finished running node model.dbt_idx.dim_customers
[0m19:05:27.034169 [debug] [Thread-1 (]: Began running node model.dbt_idx.customer_orders_status
[0m19:05:27.035172 [info ] [Thread-1 (]: 9 of 9 START sql view model IDX-Schema.customer_orders_status .................. [RUN]
[0m19:05:27.036170 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_idx.dim_customers, now model.dbt_idx.customer_orders_status)
[0m19:05:27.037172 [debug] [Thread-1 (]: Began compiling node model.dbt_idx.customer_orders_status
[0m19:05:27.040206 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_idx.customer_orders_status"
[0m19:05:27.047117 [debug] [Thread-1 (]: Timing info for model.dbt_idx.customer_orders_status (compile): 19:05:27.037172 => 19:05:27.046150
[0m19:05:27.047117 [debug] [Thread-1 (]: Began executing node model.dbt_idx.customer_orders_status
[0m19:05:27.052152 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_idx.customer_orders_status"
[0m19:05:27.059182 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.customer_orders_status"
[0m19:05:27.060135 [debug] [Thread-1 (]: On model.dbt_idx.customer_orders_status: BEGIN
[0m19:05:27.060135 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:05:27.082331 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m19:05:27.083360 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.customer_orders_status"
[0m19:05:27.084329 [debug] [Thread-1 (]: On model.dbt_idx.customer_orders_status: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.customer_orders_status"} */

  create view "IDX-Stock"."IDX-Schema"."customer_orders_status__dbt_tmp"
    
    
  as (
    with orders as (select *
                from "IDX-Stock"."IDX-Schema"."fact_orders"),
     customers as (select *
                   from "IDX-Stock"."IDX-Schema"."dim_customers")
select o.order_id,
       o.customer_id,
       o.order_status,
       o.order_purchase_timestamp,
       o.order_approved_at,
       o.order_delivered_carrier_date,
       o.order_delivered_customer_date,
       o.order_estimated_delivery_date,
       c.zipcode    as customer_zipcode,
       c.city       as customer_city,
       c.state_code as customer_state_code,
       c.state_name as customer_state_name
from orders o
    join customers c on o.customer_id = c.customer_id
    and o.order_purchase_timestamp >= c.valid_from
    and o.order_purchase_timestamp <= c.valid_to
  );
[0m19:05:27.088366 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m19:05:27.091372 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.customer_orders_status"
[0m19:05:27.092355 [debug] [Thread-1 (]: On model.dbt_idx.customer_orders_status: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.customer_orders_status"} */
alter table "IDX-Stock"."IDX-Schema"."customer_orders_status__dbt_tmp" rename to "customer_orders_status"
[0m19:05:27.094355 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:05:27.096395 [debug] [Thread-1 (]: On model.dbt_idx.customer_orders_status: COMMIT
[0m19:05:27.097391 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.customer_orders_status"
[0m19:05:27.098366 [debug] [Thread-1 (]: On model.dbt_idx.customer_orders_status: COMMIT
[0m19:05:27.101039 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m19:05:27.105076 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.customer_orders_status"
[0m19:05:27.105076 [debug] [Thread-1 (]: On model.dbt_idx.customer_orders_status: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.customer_orders_status"} */
drop view if exists "IDX-Stock"."IDX-Schema"."customer_orders_status__dbt_backup" cascade
[0m19:05:27.107039 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m19:05:27.109066 [debug] [Thread-1 (]: Timing info for model.dbt_idx.customer_orders_status (execute): 19:05:27.048151 => 19:05:27.109066
[0m19:05:27.109066 [debug] [Thread-1 (]: On model.dbt_idx.customer_orders_status: Close
[0m19:05:27.111606 [info ] [Thread-1 (]: 9 of 9 OK created sql view model IDX-Schema.customer_orders_status ............. [[32mCREATE VIEW[0m in 0.07s]
[0m19:05:27.113636 [debug] [Thread-1 (]: Finished running node model.dbt_idx.customer_orders_status
[0m19:05:27.115602 [debug] [MainThread]: Using postgres connection "master"
[0m19:05:27.116611 [debug] [MainThread]: On master: BEGIN
[0m19:05:27.116611 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m19:05:27.139097 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m19:05:27.140108 [debug] [MainThread]: On master: COMMIT
[0m19:05:27.140108 [debug] [MainThread]: Using postgres connection "master"
[0m19:05:27.141123 [debug] [MainThread]: On master: COMMIT
[0m19:05:27.143185 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m19:05:27.143185 [debug] [MainThread]: On master: Close
[0m19:05:27.145201 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:05:27.146211 [debug] [MainThread]: Connection 'list_IDX-Stock' was properly closed.
[0m19:05:27.147197 [debug] [MainThread]: Connection 'list_IDX-Stock_IDX-Schema' was properly closed.
[0m19:05:27.147197 [debug] [MainThread]: Connection 'model.dbt_idx.customer_orders_status' was properly closed.
[0m19:05:27.148218 [info ] [MainThread]: 
[0m19:05:27.150202 [info ] [MainThread]: Finished running 7 view models, 2 table models in 0 hours 0 minutes and 1.44 seconds (1.44s).
[0m19:05:27.152230 [debug] [MainThread]: Command end result
[0m19:05:27.177213 [info ] [MainThread]: 
[0m19:05:27.178232 [info ] [MainThread]: [32mCompleted successfully[0m
[0m19:05:27.179230 [info ] [MainThread]: 
[0m19:05:27.180198 [info ] [MainThread]: Done. PASS=9 WARN=0 ERROR=0 SKIP=0 TOTAL=9
[0m19:05:27.182205 [debug] [MainThread]: Command `dbt run` succeeded at 19:05:27.182205 after 2.07 seconds
[0m19:05:27.183195 [debug] [MainThread]: Flushing usage events


============================== 19:13:56.637849 | 971ca78c-2ab1-4bed-a43a-0d26ee818589 ==============================
[0m19:13:56.637849 [info ] [MainThread]: Running with dbt=1.6.1
[0m19:13:56.644847 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'D:\\00 Project\\00 My Project\\IdeaProjects\\Py-DBT-IDX\\logs', 'version_check': 'True', 'profiles_dir': 'D:\\00 Project\\00 My Project\\IdeaProjects\\Py-DBT-IDX', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'False'}
[0m19:13:56.817878 [info ] [MainThread]: Registered adapter: postgres=1.6.1
[0m19:13:56.830424 [debug] [MainThread]: checksum: efe19d9f5b93d1a98cc804fbfcdb6b3aced98b974af664946fee1cde8837deb7, vars: {}, profile: , target: , version: 1.6.1
[0m19:13:57.043326 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 3 files changed.
[0m19:13:57.044299 [debug] [MainThread]: Partial parsing: added file: dbt_idx://models\marts\core\dim_stocks.sql
[0m19:13:57.045289 [debug] [MainThread]: Partial parsing: updated file: dbt_idx://models\staging\stg_eltool.yml
[0m19:13:57.046813 [debug] [MainThread]: Partial parsing: updated file: dbt_idx://models\marts\core\core.yml
[0m19:13:57.047839 [debug] [MainThread]: Partial parsing: updated file: dbt_idx://models\staging\stg_eltool__stock.sql
[0m19:13:57.170060 [info ] [MainThread]: Found 10 models, 1 snapshot, 17 tests, 5 sources, 0 exposures, 0 metrics, 349 macros, 0 groups, 0 semantic models
[0m19:13:57.174083 [info ] [MainThread]: 
[0m19:13:57.176087 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m19:13:57.181638 [debug] [ThreadPool]: Acquiring new postgres connection 'list_IDX-Stock'
[0m19:13:57.195705 [debug] [ThreadPool]: Using postgres connection "list_IDX-Stock"
[0m19:13:57.195705 [debug] [ThreadPool]: On list_IDX-Stock: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "connection_name": "list_IDX-Stock"} */

    select distinct nspname from pg_namespace
  
[0m19:13:57.197216 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:13:57.232284 [debug] [ThreadPool]: SQL status: SELECT 12 in 0.0 seconds
[0m19:13:57.234284 [debug] [ThreadPool]: On list_IDX-Stock: Close
[0m19:13:57.238252 [debug] [ThreadPool]: Acquiring new postgres connection 'list_IDX-Stock_IDX-Schema'
[0m19:13:57.245284 [debug] [ThreadPool]: Using postgres connection "list_IDX-Stock_IDX-Schema"
[0m19:13:57.246249 [debug] [ThreadPool]: On list_IDX-Stock_IDX-Schema: BEGIN
[0m19:13:57.246249 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:13:57.267041 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m19:13:57.268045 [debug] [ThreadPool]: Using postgres connection "list_IDX-Stock_IDX-Schema"
[0m19:13:57.268045 [debug] [ThreadPool]: On list_IDX-Stock_IDX-Schema: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "connection_name": "list_IDX-Stock_IDX-Schema"} */
select
      'IDX-Stock' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'IDX-Schema'
    union all
    select
      'IDX-Stock' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'IDX-Schema'
    union all
    select
      'IDX-Stock' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'IDX-Schema'
  
[0m19:13:57.273596 [debug] [ThreadPool]: SQL status: SELECT 15 in 0.0 seconds
[0m19:13:57.275607 [debug] [ThreadPool]: On list_IDX-Stock_IDX-Schema: ROLLBACK
[0m19:13:57.276609 [debug] [ThreadPool]: On list_IDX-Stock_IDX-Schema: Close
[0m19:13:57.278608 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_IDX-Stock_IDX-Schema, now list_IDX-Stock_snapshots)
[0m19:13:57.285651 [debug] [ThreadPool]: Using postgres connection "list_IDX-Stock_snapshots"
[0m19:13:57.286653 [debug] [ThreadPool]: On list_IDX-Stock_snapshots: BEGIN
[0m19:13:57.287619 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:13:57.308151 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m19:13:57.308151 [debug] [ThreadPool]: Using postgres connection "list_IDX-Stock_snapshots"
[0m19:13:57.309153 [debug] [ThreadPool]: On list_IDX-Stock_snapshots: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "connection_name": "list_IDX-Stock_snapshots"} */
select
      'IDX-Stock' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'snapshots'
    union all
    select
      'IDX-Stock' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'snapshots'
    union all
    select
      'IDX-Stock' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'snapshots'
  
[0m19:13:57.313765 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.0 seconds
[0m19:13:57.315814 [debug] [ThreadPool]: On list_IDX-Stock_snapshots: ROLLBACK
[0m19:13:57.317780 [debug] [ThreadPool]: On list_IDX-Stock_snapshots: Close
[0m19:13:57.323801 [debug] [MainThread]: Using postgres connection "master"
[0m19:13:57.324809 [debug] [MainThread]: On master: BEGIN
[0m19:13:57.325766 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:13:57.346499 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m19:13:57.347504 [debug] [MainThread]: Using postgres connection "master"
[0m19:13:57.347504 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m19:13:57.355497 [debug] [MainThread]: SQL status: SELECT 8 in 0.0 seconds
[0m19:13:57.358496 [debug] [MainThread]: On master: ROLLBACK
[0m19:13:57.360498 [debug] [MainThread]: Using postgres connection "master"
[0m19:13:57.361496 [debug] [MainThread]: On master: BEGIN
[0m19:13:57.364511 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m19:13:57.365507 [debug] [MainThread]: On master: COMMIT
[0m19:13:57.365507 [debug] [MainThread]: Using postgres connection "master"
[0m19:13:57.366507 [debug] [MainThread]: On master: COMMIT
[0m19:13:57.368518 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m19:13:57.368518 [debug] [MainThread]: On master: Close
[0m19:13:57.370530 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m19:13:57.371531 [info ] [MainThread]: 
[0m19:13:57.377559 [debug] [Thread-1 (]: Began running node model.dbt_idx.stg_eltool__company
[0m19:13:57.378563 [info ] [Thread-1 (]: 1 of 10 START sql view model IDX-Schema.stg_eltool__company .................... [RUN]
[0m19:13:57.379529 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.dbt_idx.stg_eltool__company'
[0m19:13:57.380530 [debug] [Thread-1 (]: Began compiling node model.dbt_idx.stg_eltool__company
[0m19:13:57.387567 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_idx.stg_eltool__company"
[0m19:13:57.394569 [debug] [Thread-1 (]: Timing info for model.dbt_idx.stg_eltool__company (compile): 19:13:57.380530 => 19:13:57.394569
[0m19:13:57.395532 [debug] [Thread-1 (]: Began executing node model.dbt_idx.stg_eltool__company
[0m19:13:57.432116 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_idx.stg_eltool__company"
[0m19:13:57.439095 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__company"
[0m19:13:57.440082 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__company: BEGIN
[0m19:13:57.440082 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m19:13:57.463126 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m19:13:57.464126 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__company"
[0m19:13:57.465126 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__company: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__company"} */

  create view "IDX-Stock"."IDX-Schema"."stg_eltool__company__dbt_tmp"
    
    
  as (
    with source as (select *
                from "IDX-Stock"."IDX-Schema"."ksql-company-stream"),
     renamed as (select id,
                        ticker,
                        name,
                        logo
                 from source)
select *
from renamed
  );
[0m19:13:57.469916 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m19:13:57.477913 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__company"
[0m19:13:57.477913 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__company: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__company"} */
alter table "IDX-Stock"."IDX-Schema"."stg_eltool__company" rename to "stg_eltool__company__dbt_backup"
[0m19:13:57.481912 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:13:57.484922 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__company"
[0m19:13:57.485956 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__company: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__company"} */
alter table "IDX-Stock"."IDX-Schema"."stg_eltool__company__dbt_tmp" rename to "stg_eltool__company"
[0m19:13:57.488934 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:13:57.506019 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__company: COMMIT
[0m19:13:57.507075 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__company"
[0m19:13:57.508036 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__company: COMMIT
[0m19:13:57.511088 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m19:13:57.519107 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__company"
[0m19:13:57.520094 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__company: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__company"} */
drop view if exists "IDX-Stock"."IDX-Schema"."stg_eltool__company__dbt_backup" cascade
[0m19:13:57.524446 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m19:13:57.525450 [debug] [Thread-1 (]: Timing info for model.dbt_idx.stg_eltool__company (execute): 19:13:57.395532 => 19:13:57.525450
[0m19:13:57.526444 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__company: Close
[0m19:13:57.528413 [info ] [Thread-1 (]: 1 of 10 OK created sql view model IDX-Schema.stg_eltool__company ............... [[32mCREATE VIEW[0m in 0.15s]
[0m19:13:57.530408 [debug] [Thread-1 (]: Finished running node model.dbt_idx.stg_eltool__company
[0m19:13:57.531444 [debug] [Thread-1 (]: Began running node model.dbt_idx.stg_eltool__customers
[0m19:13:57.532456 [info ] [Thread-1 (]: 2 of 10 START sql view model IDX-Schema.stg_eltool__customers .................. [RUN]
[0m19:13:57.533411 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_idx.stg_eltool__company, now model.dbt_idx.stg_eltool__customers)
[0m19:13:57.534443 [debug] [Thread-1 (]: Began compiling node model.dbt_idx.stg_eltool__customers
[0m19:13:57.537442 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_idx.stg_eltool__customers"
[0m19:13:57.543836 [debug] [Thread-1 (]: Timing info for model.dbt_idx.stg_eltool__customers (compile): 19:13:57.535437 => 19:13:57.542845
[0m19:13:57.544834 [debug] [Thread-1 (]: Began executing node model.dbt_idx.stg_eltool__customers
[0m19:13:57.549869 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_idx.stg_eltool__customers"
[0m19:13:57.555870 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__customers"
[0m19:13:57.556873 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__customers: BEGIN
[0m19:13:57.557832 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:13:57.580840 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m19:13:57.582872 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__customers"
[0m19:13:57.584425 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__customers: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__customers"} */

  create view "IDX-Stock"."IDX-Schema"."stg_eltool__customers__dbt_tmp"
    
    
  as (
    with source as (select *
                from "IDX-Stock"."IDX-Schema"."customers"),
     renamed as (select
                     customer_id,
                    'This is Dummy' as dummy
                 from source
                 where customer_id = 1234567890)
select *
from renamed
  );
[0m19:13:57.587909 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m19:13:57.593916 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__customers"
[0m19:13:57.594921 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__customers: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__customers"} */
alter table "IDX-Stock"."IDX-Schema"."stg_eltool__customers" rename to "stg_eltool__customers__dbt_backup"
[0m19:13:57.597831 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:13:57.602839 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__customers"
[0m19:13:57.602839 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__customers: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__customers"} */
alter table "IDX-Stock"."IDX-Schema"."stg_eltool__customers__dbt_tmp" rename to "stg_eltool__customers"
[0m19:13:57.605860 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:13:57.608838 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__customers: COMMIT
[0m19:13:57.609842 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__customers"
[0m19:13:57.610844 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__customers: COMMIT
[0m19:13:57.614839 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m19:13:57.617874 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__customers"
[0m19:13:57.618836 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__customers: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__customers"} */
drop view if exists "IDX-Stock"."IDX-Schema"."stg_eltool__customers__dbt_backup" cascade
[0m19:13:57.622349 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m19:13:57.624346 [debug] [Thread-1 (]: Timing info for model.dbt_idx.stg_eltool__customers (execute): 19:13:57.544834 => 19:13:57.624346
[0m19:13:57.625348 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__customers: Close
[0m19:13:57.627350 [info ] [Thread-1 (]: 2 of 10 OK created sql view model IDX-Schema.stg_eltool__customers ............. [[32mCREATE VIEW[0m in 0.09s]
[0m19:13:57.628350 [debug] [Thread-1 (]: Finished running node model.dbt_idx.stg_eltool__customers
[0m19:13:57.630353 [debug] [Thread-1 (]: Began running node model.dbt_idx.stg_eltool__customers_snapshots
[0m19:13:57.631351 [info ] [Thread-1 (]: 3 of 10 START sql view model IDX-Schema.stg_eltool__customers_snapshots ........ [RUN]
[0m19:13:57.632348 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_idx.stg_eltool__customers, now model.dbt_idx.stg_eltool__customers_snapshots)
[0m19:13:57.633383 [debug] [Thread-1 (]: Began compiling node model.dbt_idx.stg_eltool__customers_snapshots
[0m19:13:57.636382 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_idx.stg_eltool__customers_snapshots"
[0m19:13:57.642934 [debug] [Thread-1 (]: Timing info for model.dbt_idx.stg_eltool__customers_snapshots (compile): 19:13:57.634388 => 19:13:57.642934
[0m19:13:57.643947 [debug] [Thread-1 (]: Began executing node model.dbt_idx.stg_eltool__customers_snapshots
[0m19:13:57.650932 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_idx.stg_eltool__customers_snapshots"
[0m19:13:57.656931 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__customers_snapshots"
[0m19:13:57.657966 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__customers_snapshots: BEGIN
[0m19:13:57.658970 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:13:57.680615 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m19:13:57.681600 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__customers_snapshots"
[0m19:13:57.681600 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__customers_snapshots: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__customers_snapshots"} */

  create view "IDX-Stock"."IDX-Schema"."stg_eltool__customers_snapshots__dbt_tmp"
    
    
  as (
    with source as (select *
                from "IDX-Stock"."snapshots"."customers_snapshot"),
     renamed as (select customer_id,
                        zipcode,
                        city,
                        state_code,
                        datetime_created::TIMESTAMP AS datetime_created,
                        datetime_updated::TIMESTAMP AS datetime_updated,
                        dbt_valid_from,
                        dbt_valid_to
                 from source)
select *
from renamed
  );
[0m19:13:57.686608 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m19:13:57.693606 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__customers_snapshots"
[0m19:13:57.694612 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__customers_snapshots: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__customers_snapshots"} */
alter table "IDX-Stock"."IDX-Schema"."stg_eltool__customers_snapshots" rename to "stg_eltool__customers_snapshots__dbt_backup"
[0m19:13:57.697120 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:13:57.701128 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__customers_snapshots"
[0m19:13:57.702151 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__customers_snapshots: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__customers_snapshots"} */
alter table "IDX-Stock"."IDX-Schema"."stg_eltool__customers_snapshots__dbt_tmp" rename to "stg_eltool__customers_snapshots"
[0m19:13:57.705144 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:13:57.707128 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__customers_snapshots: COMMIT
[0m19:13:57.708152 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__customers_snapshots"
[0m19:13:57.709128 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__customers_snapshots: COMMIT
[0m19:13:57.712735 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m19:13:57.716720 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__customers_snapshots"
[0m19:13:57.716720 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__customers_snapshots: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__customers_snapshots"} */
drop view if exists "IDX-Stock"."IDX-Schema"."stg_eltool__customers_snapshots__dbt_backup" cascade
[0m19:13:57.721744 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m19:13:57.722744 [debug] [Thread-1 (]: Timing info for model.dbt_idx.stg_eltool__customers_snapshots (execute): 19:13:57.644930 => 19:13:57.722744
[0m19:13:57.723750 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__customers_snapshots: Close
[0m19:13:57.725717 [info ] [Thread-1 (]: 3 of 10 OK created sql view model IDX-Schema.stg_eltool__customers_snapshots ... [[32mCREATE VIEW[0m in 0.09s]
[0m19:13:57.727720 [debug] [Thread-1 (]: Finished running node model.dbt_idx.stg_eltool__customers_snapshots
[0m19:13:57.728717 [debug] [Thread-1 (]: Began running node model.dbt_idx.stg_eltool__orders
[0m19:13:57.729731 [info ] [Thread-1 (]: 4 of 10 START sql view model IDX-Schema.stg_eltool__orders ..................... [RUN]
[0m19:13:57.731734 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_idx.stg_eltool__customers_snapshots, now model.dbt_idx.stg_eltool__orders)
[0m19:13:57.732731 [debug] [Thread-1 (]: Began compiling node model.dbt_idx.stg_eltool__orders
[0m19:13:57.735736 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_idx.stg_eltool__orders"
[0m19:13:57.747719 [debug] [Thread-1 (]: Timing info for model.dbt_idx.stg_eltool__orders (compile): 19:13:57.732731 => 19:13:57.746717
[0m19:13:57.747719 [debug] [Thread-1 (]: Began executing node model.dbt_idx.stg_eltool__orders
[0m19:13:57.753719 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_idx.stg_eltool__orders"
[0m19:13:57.765114 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__orders"
[0m19:13:57.766117 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__orders: BEGIN
[0m19:13:57.766117 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:13:57.788027 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m19:13:57.789025 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__orders"
[0m19:13:57.789025 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__orders: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__orders"} */

  create view "IDX-Stock"."IDX-Schema"."stg_eltool__orders__dbt_tmp"
    
    
  as (
    with source as (select *
                from "IDX-Stock"."IDX-Schema"."orders"),
     renamed as (select order_id,
                        cust_id AS customer_id,
                        order_status,
                        order_purchase_timestamp::TIMESTAMP,
                        order_approved_at::TIMESTAMP,
                        order_delivered_carrier_date::TIMESTAMP,
                        order_delivered_customer_date::TIMESTAMP,
                        order_estimated_delivery_date::TIMESTAMP
                 from source)
select *
from renamed
  );
[0m19:13:57.793081 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m19:13:57.797059 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__orders"
[0m19:13:57.798537 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__orders: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__orders"} */
alter table "IDX-Stock"."IDX-Schema"."stg_eltool__orders" rename to "stg_eltool__orders__dbt_backup"
[0m19:13:57.800537 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:13:57.804572 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__orders"
[0m19:13:57.804572 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__orders: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__orders"} */
alter table "IDX-Stock"."IDX-Schema"."stg_eltool__orders__dbt_tmp" rename to "stg_eltool__orders"
[0m19:13:57.807185 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:13:57.809216 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__orders: COMMIT
[0m19:13:57.810181 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__orders"
[0m19:13:57.811182 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__orders: COMMIT
[0m19:13:57.814181 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m19:13:57.817219 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__orders"
[0m19:13:57.817219 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__orders: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__orders"} */
drop view if exists "IDX-Stock"."IDX-Schema"."stg_eltool__orders__dbt_backup" cascade
[0m19:13:57.821612 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m19:13:57.823646 [debug] [Thread-1 (]: Timing info for model.dbt_idx.stg_eltool__orders (execute): 19:13:57.748779 => 19:13:57.822625
[0m19:13:57.823646 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__orders: Close
[0m19:13:57.825630 [info ] [Thread-1 (]: 4 of 10 OK created sql view model IDX-Schema.stg_eltool__orders ................ [[32mCREATE VIEW[0m in 0.09s]
[0m19:13:57.827617 [debug] [Thread-1 (]: Finished running node model.dbt_idx.stg_eltool__orders
[0m19:13:57.829614 [debug] [Thread-1 (]: Began running node model.dbt_idx.stg_eltool__state
[0m19:13:57.830620 [info ] [Thread-1 (]: 5 of 10 START sql view model IDX-Schema.stg_eltool__state ...................... [RUN]
[0m19:13:57.831646 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_idx.stg_eltool__orders, now model.dbt_idx.stg_eltool__state)
[0m19:13:57.832646 [debug] [Thread-1 (]: Began compiling node model.dbt_idx.stg_eltool__state
[0m19:13:57.835647 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_idx.stg_eltool__state"
[0m19:13:57.841389 [debug] [Thread-1 (]: Timing info for model.dbt_idx.stg_eltool__state (compile): 19:13:57.833678 => 19:13:57.841389
[0m19:13:57.842426 [debug] [Thread-1 (]: Began executing node model.dbt_idx.stg_eltool__state
[0m19:13:57.847427 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_idx.stg_eltool__state"
[0m19:13:57.854389 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__state"
[0m19:13:57.855427 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__state: BEGIN
[0m19:13:57.856396 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:13:57.876078 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m19:13:57.877094 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__state"
[0m19:13:57.878060 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__state: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__state"} */

  create view "IDX-Stock"."IDX-Schema"."stg_eltool__state__dbt_tmp"
    
    
  as (
    with source as (select *
                from "IDX-Stock"."IDX-Schema"."state"),
     renamed as (select state_identifier::INT AS state_id,
                         state_code::VARCHAR(2) AS state_code,
                         st_name::VARCHAR(30) AS state_name
                 from source)
select *
from renamed
  );
[0m19:13:57.882059 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m19:13:57.886102 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__state"
[0m19:13:57.886102 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__state: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__state"} */
alter table "IDX-Stock"."IDX-Schema"."stg_eltool__state" rename to "stg_eltool__state__dbt_backup"
[0m19:13:57.889065 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:13:57.893081 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__state"
[0m19:13:57.894085 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__state: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__state"} */
alter table "IDX-Stock"."IDX-Schema"."stg_eltool__state__dbt_tmp" rename to "stg_eltool__state"
[0m19:13:57.896065 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:13:57.897619 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__state: COMMIT
[0m19:13:57.898651 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__state"
[0m19:13:57.899641 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__state: COMMIT
[0m19:13:57.902206 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m19:13:57.907252 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__state"
[0m19:13:57.908218 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__state: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__state"} */
drop view if exists "IDX-Stock"."IDX-Schema"."stg_eltool__state__dbt_backup" cascade
[0m19:13:57.912216 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m19:13:57.915251 [debug] [Thread-1 (]: Timing info for model.dbt_idx.stg_eltool__state (execute): 19:13:57.843393 => 19:13:57.915251
[0m19:13:57.916238 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__state: Close
[0m19:13:57.917231 [info ] [Thread-1 (]: 5 of 10 OK created sql view model IDX-Schema.stg_eltool__state ................. [[32mCREATE VIEW[0m in 0.09s]
[0m19:13:57.919225 [debug] [Thread-1 (]: Finished running node model.dbt_idx.stg_eltool__state
[0m19:13:57.920223 [debug] [Thread-1 (]: Began running node model.dbt_idx.stg_eltool__stock
[0m19:13:57.922218 [info ] [Thread-1 (]: 6 of 10 START sql view model IDX-Schema.stg_eltool__stock ...................... [RUN]
[0m19:13:57.923218 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_idx.stg_eltool__state, now model.dbt_idx.stg_eltool__stock)
[0m19:13:57.924235 [debug] [Thread-1 (]: Began compiling node model.dbt_idx.stg_eltool__stock
[0m19:13:57.927254 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_idx.stg_eltool__stock"
[0m19:13:57.934253 [debug] [Thread-1 (]: Timing info for model.dbt_idx.stg_eltool__stock (compile): 19:13:57.925222 => 19:13:57.933216
[0m19:13:57.934253 [debug] [Thread-1 (]: Began executing node model.dbt_idx.stg_eltool__stock
[0m19:13:57.940222 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_idx.stg_eltool__stock"
[0m19:13:57.948747 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__stock"
[0m19:13:57.948747 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__stock: BEGIN
[0m19:13:57.949783 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:13:57.973750 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m19:13:57.974749 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__stock"
[0m19:13:57.975782 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__stock: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__stock"} */

  create view "IDX-Stock"."IDX-Schema"."stg_eltool__stock__dbt_tmp"
    
    
  as (
    with source as (select *
                from "IDX-Stock"."IDX-Schema"."ksql-stock-stream"),
     renamed as (select a.id,
                        a.ticker,
                        a.date,
                        a.open,
                        a.high,
                        a.low,
                        a.close,
                        a.volume
                 from source a)
select *
from renamed
  );
[0m19:13:57.979355 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m19:13:57.984447 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__stock"
[0m19:13:57.985419 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__stock: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__stock"} */
alter table "IDX-Stock"."IDX-Schema"."stg_eltool__stock" rename to "stg_eltool__stock__dbt_backup"
[0m19:13:57.988422 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:13:57.992455 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__stock"
[0m19:13:57.993411 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__stock: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__stock"} */
alter table "IDX-Stock"."IDX-Schema"."stg_eltool__stock__dbt_tmp" rename to "stg_eltool__stock"
[0m19:13:57.995412 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:13:57.997991 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__stock: COMMIT
[0m19:13:57.997991 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__stock"
[0m19:13:57.999047 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__stock: COMMIT
[0m19:13:58.002007 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m19:13:58.004999 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__stock"
[0m19:13:58.006034 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__stock: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__stock"} */
drop view if exists "IDX-Stock"."IDX-Schema"."stg_eltool__stock__dbt_backup" cascade
[0m19:13:58.009854 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m19:13:58.011875 [debug] [Thread-1 (]: Timing info for model.dbt_idx.stg_eltool__stock (execute): 19:13:57.935221 => 19:13:58.011875
[0m19:13:58.012838 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__stock: Close
[0m19:13:58.013865 [info ] [Thread-1 (]: 6 of 10 OK created sql view model IDX-Schema.stg_eltool__stock ................. [[32mCREATE VIEW[0m in 0.09s]
[0m19:13:58.015843 [debug] [Thread-1 (]: Finished running node model.dbt_idx.stg_eltool__stock
[0m19:13:58.017841 [debug] [Thread-1 (]: Began running node model.dbt_idx.fact_orders
[0m19:13:58.018855 [info ] [Thread-1 (]: 7 of 10 START sql table model IDX-Schema.fact_orders ........................... [RUN]
[0m19:13:58.019838 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_idx.stg_eltool__stock, now model.dbt_idx.fact_orders)
[0m19:13:58.020863 [debug] [Thread-1 (]: Began compiling node model.dbt_idx.fact_orders
[0m19:13:58.023873 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_idx.fact_orders"
[0m19:13:58.029204 [debug] [Thread-1 (]: Timing info for model.dbt_idx.fact_orders (compile): 19:13:58.021844 => 19:13:58.029204
[0m19:13:58.030169 [debug] [Thread-1 (]: Began executing node model.dbt_idx.fact_orders
[0m19:13:58.054170 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_idx.fact_orders"
[0m19:13:58.060204 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.fact_orders"
[0m19:13:58.061171 [debug] [Thread-1 (]: On model.dbt_idx.fact_orders: BEGIN
[0m19:13:58.062190 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:13:58.089376 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m19:13:58.090378 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.fact_orders"
[0m19:13:58.091373 [debug] [Thread-1 (]: On model.dbt_idx.fact_orders: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.fact_orders"} */

  
    

  create  table "IDX-Stock"."IDX-Schema"."fact_orders__dbt_tmp"
  
  
    as
  
  (
    with orders as (
    select *
    from "IDX-Stock"."IDX-Schema"."stg_eltool__orders"
)
select * from orders
  );
  
[0m19:13:58.099894 [debug] [Thread-1 (]: SQL status: SELECT 999 in 0.0 seconds
[0m19:13:58.104906 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.fact_orders"
[0m19:13:58.105906 [debug] [Thread-1 (]: On model.dbt_idx.fact_orders: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.fact_orders"} */
alter table "IDX-Stock"."IDX-Schema"."fact_orders" rename to "fact_orders__dbt_backup"
[0m19:13:58.108906 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:13:58.112532 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.fact_orders"
[0m19:13:58.113660 [debug] [Thread-1 (]: On model.dbt_idx.fact_orders: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.fact_orders"} */
alter table "IDX-Stock"."IDX-Schema"."fact_orders__dbt_tmp" rename to "fact_orders"
[0m19:13:58.115661 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:13:58.123660 [debug] [Thread-1 (]: On model.dbt_idx.fact_orders: COMMIT
[0m19:13:58.125664 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.fact_orders"
[0m19:13:58.126679 [debug] [Thread-1 (]: On model.dbt_idx.fact_orders: COMMIT
[0m19:13:58.130432 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m19:13:58.135929 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.fact_orders"
[0m19:13:58.136929 [debug] [Thread-1 (]: On model.dbt_idx.fact_orders: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.fact_orders"} */
drop table if exists "IDX-Stock"."IDX-Schema"."fact_orders__dbt_backup" cascade
[0m19:13:58.143484 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m19:13:58.146488 [debug] [Thread-1 (]: Timing info for model.dbt_idx.fact_orders (execute): 19:13:58.031168 => 19:13:58.145519
[0m19:13:58.147488 [debug] [Thread-1 (]: On model.dbt_idx.fact_orders: Close
[0m19:13:58.149499 [info ] [Thread-1 (]: 7 of 10 OK created sql table model IDX-Schema.fact_orders ...................... [[32mSELECT 999[0m in 0.13s]
[0m19:13:58.152013 [debug] [Thread-1 (]: Finished running node model.dbt_idx.fact_orders
[0m19:13:58.153106 [debug] [Thread-1 (]: Began running node model.dbt_idx.dim_customers
[0m19:13:58.154027 [info ] [Thread-1 (]: 8 of 10 START sql table model IDX-Schema.dim_customers ......................... [RUN]
[0m19:13:58.156010 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_idx.fact_orders, now model.dbt_idx.dim_customers)
[0m19:13:58.157013 [debug] [Thread-1 (]: Began compiling node model.dbt_idx.dim_customers
[0m19:13:58.161007 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_idx.dim_customers"
[0m19:13:58.168530 [debug] [Thread-1 (]: Timing info for model.dbt_idx.dim_customers (compile): 19:13:58.158012 => 19:13:58.168530
[0m19:13:58.170045 [debug] [Thread-1 (]: Began executing node model.dbt_idx.dim_customers
[0m19:13:58.178023 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_idx.dim_customers"
[0m19:13:58.184547 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.dim_customers"
[0m19:13:58.184547 [debug] [Thread-1 (]: On model.dbt_idx.dim_customers: BEGIN
[0m19:13:58.186540 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:13:58.214178 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m19:13:58.215178 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.dim_customers"
[0m19:13:58.215178 [debug] [Thread-1 (]: On model.dbt_idx.dim_customers: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.dim_customers"} */

  
    

  create  table "IDX-Stock"."IDX-Schema"."dim_customers__dbt_tmp"
  
  
    as
  
  (
    -- noinspection SqlDialectInspectionForFile

with customers as (
    select *
    from "IDX-Stock"."IDX-Schema"."stg_eltool__customers_snapshots"
    ),
     state as (
         select *
         from "IDX-Stock"."IDX-Schema"."stg_eltool__state"
     )
select c.customer_id,
       c.zipcode,
       c.city,
       c.state_code,
       s.state_name,
       c.datetime_created,
       c.datetime_updated,
       c.dbt_valid_from::TIMESTAMP as valid_from,
        CASE WHEN c.dbt_valid_to IS NULL
            THEN '9999-12-31'::TIMESTAMP
            ELSE c.dbt_valid_to::TIMESTAMP
        END as valid_to
from customers c
    join state s on c.state_code = s.state_code
  );
  
[0m19:13:58.222702 [debug] [Thread-1 (]: SQL status: SELECT 100 in 0.0 seconds
[0m19:13:58.227697 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.dim_customers"
[0m19:13:58.228754 [debug] [Thread-1 (]: On model.dbt_idx.dim_customers: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.dim_customers"} */
alter table "IDX-Stock"."IDX-Schema"."dim_customers" rename to "dim_customers__dbt_backup"
[0m19:13:58.231697 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:13:58.281728 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.dim_customers"
[0m19:13:58.282730 [debug] [Thread-1 (]: On model.dbt_idx.dim_customers: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.dim_customers"} */
alter table "IDX-Stock"."IDX-Schema"."dim_customers__dbt_tmp" rename to "dim_customers"
[0m19:13:58.285730 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:13:58.288731 [debug] [Thread-1 (]: On model.dbt_idx.dim_customers: COMMIT
[0m19:13:58.290242 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.dim_customers"
[0m19:13:58.290242 [debug] [Thread-1 (]: On model.dbt_idx.dim_customers: COMMIT
[0m19:13:58.294779 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m19:13:58.298298 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.dim_customers"
[0m19:13:58.299303 [debug] [Thread-1 (]: On model.dbt_idx.dim_customers: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.dim_customers"} */
drop table if exists "IDX-Stock"."IDX-Schema"."dim_customers__dbt_backup" cascade
[0m19:13:58.303829 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m19:13:58.305833 [debug] [Thread-1 (]: Timing info for model.dbt_idx.dim_customers (execute): 19:13:58.171090 => 19:13:58.305833
[0m19:13:58.306834 [debug] [Thread-1 (]: On model.dbt_idx.dim_customers: Close
[0m19:13:58.308840 [info ] [Thread-1 (]: 8 of 10 OK created sql table model IDX-Schema.dim_customers .................... [[32mSELECT 100[0m in 0.15s]
[0m19:13:58.311833 [debug] [Thread-1 (]: Finished running node model.dbt_idx.dim_customers
[0m19:13:58.313834 [debug] [Thread-1 (]: Began running node model.dbt_idx.dim_stocks
[0m19:13:58.314831 [info ] [Thread-1 (]: 9 of 10 START sql table model IDX-Schema.dim_stocks ............................ [RUN]
[0m19:13:58.316830 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_idx.dim_customers, now model.dbt_idx.dim_stocks)
[0m19:13:58.317828 [debug] [Thread-1 (]: Began compiling node model.dbt_idx.dim_stocks
[0m19:13:58.320830 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_idx.dim_stocks"
[0m19:13:58.324831 [debug] [Thread-1 (]: Timing info for model.dbt_idx.dim_stocks (compile): 19:13:58.317828 => 19:13:58.324831
[0m19:13:58.325830 [debug] [Thread-1 (]: Began executing node model.dbt_idx.dim_stocks
[0m19:13:58.334351 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_idx.dim_stocks"
[0m19:13:58.339345 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.dim_stocks"
[0m19:13:58.340350 [debug] [Thread-1 (]: On model.dbt_idx.dim_stocks: BEGIN
[0m19:13:58.341347 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:13:58.361687 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m19:13:58.362714 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.dim_stocks"
[0m19:13:58.363695 [debug] [Thread-1 (]: On model.dbt_idx.dim_stocks: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.dim_stocks"} */

  
    

  create  table "IDX-Stock"."IDX-Schema"."dim_stocks__dbt_tmp"
  
  
    as
  
  (
    -- noinspection SqlDialectInspectionForFile

with stock as (
    select *
    from "IDX-Stock"."IDX-Schema"."stg_eltool__stock"
    ),
     company as (
         select *
         from "IDX-Stock"."IDX-Schema"."stg_eltool__company"
     )
select a.id,
       a.ticker,
       b.name,
       a.date,
       a.open,
       a.high,
       a.low,
       a.close,
       a.colume,
       b.logo,
from stock a
    join company b on a.id = b.id
  );
  
[0m19:13:58.366701 [debug] [Thread-1 (]: Postgres adapter: Postgres error: syntax error at or near "from"
LINE 32: from stock a
         ^

[0m19:13:58.367732 [debug] [Thread-1 (]: On model.dbt_idx.dim_stocks: ROLLBACK
[0m19:13:58.371699 [debug] [Thread-1 (]: Timing info for model.dbt_idx.dim_stocks (execute): 19:13:58.326830 => 19:13:58.370705
[0m19:13:58.371699 [debug] [Thread-1 (]: On model.dbt_idx.dim_stocks: Close
[0m19:13:58.391299 [debug] [Thread-1 (]: Database Error in model dim_stocks (models\marts\core\dim_stocks.sql)
  syntax error at or near "from"
  LINE 32: from stock a
           ^
  compiled Code at target\run\dbt_idx\models\marts\core\dim_stocks.sql
[0m19:13:58.393297 [error] [Thread-1 (]: 9 of 10 ERROR creating sql table model IDX-Schema.dim_stocks ................... [[31mERROR[0m in 0.08s]
[0m19:13:58.394298 [debug] [Thread-1 (]: Finished running node model.dbt_idx.dim_stocks
[0m19:13:58.395274 [debug] [Thread-1 (]: Began running node model.dbt_idx.customer_orders_status
[0m19:13:58.396272 [info ] [Thread-1 (]: 10 of 10 START sql view model IDX-Schema.customer_orders_status ................ [RUN]
[0m19:13:58.397781 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_idx.dim_stocks, now model.dbt_idx.customer_orders_status)
[0m19:13:58.398801 [debug] [Thread-1 (]: Began compiling node model.dbt_idx.customer_orders_status
[0m19:13:58.401789 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_idx.customer_orders_status"
[0m19:13:58.409057 [debug] [Thread-1 (]: Timing info for model.dbt_idx.customer_orders_status (compile): 19:13:58.398801 => 19:13:58.409057
[0m19:13:58.410058 [debug] [Thread-1 (]: Began executing node model.dbt_idx.customer_orders_status
[0m19:13:58.416056 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_idx.customer_orders_status"
[0m19:13:58.423041 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.customer_orders_status"
[0m19:13:58.424028 [debug] [Thread-1 (]: On model.dbt_idx.customer_orders_status: BEGIN
[0m19:13:58.425027 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:13:58.449579 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m19:13:58.450606 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.customer_orders_status"
[0m19:13:58.451604 [debug] [Thread-1 (]: On model.dbt_idx.customer_orders_status: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.customer_orders_status"} */

  create view "IDX-Stock"."IDX-Schema"."customer_orders_status__dbt_tmp"
    
    
  as (
    with orders as (select *
                from "IDX-Stock"."IDX-Schema"."fact_orders"),
     customers as (select *
                   from "IDX-Stock"."IDX-Schema"."dim_customers")
select o.order_id,
       o.customer_id,
       o.order_status,
       o.order_purchase_timestamp,
       o.order_approved_at,
       o.order_delivered_carrier_date,
       o.order_delivered_customer_date,
       o.order_estimated_delivery_date,
       c.zipcode    as customer_zipcode,
       c.city       as customer_city,
       c.state_code as customer_state_code,
       c.state_name as customer_state_name
from orders o
    join customers c on o.customer_id = c.customer_id
    and o.order_purchase_timestamp >= c.valid_from
    and o.order_purchase_timestamp <= c.valid_to
  );
[0m19:13:58.455592 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m19:13:58.459591 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.customer_orders_status"
[0m19:13:58.460591 [debug] [Thread-1 (]: On model.dbt_idx.customer_orders_status: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.customer_orders_status"} */
alter table "IDX-Stock"."IDX-Schema"."customer_orders_status__dbt_tmp" rename to "customer_orders_status"
[0m19:13:58.463591 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:13:58.464626 [debug] [Thread-1 (]: On model.dbt_idx.customer_orders_status: COMMIT
[0m19:13:58.465631 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.customer_orders_status"
[0m19:13:58.466626 [debug] [Thread-1 (]: On model.dbt_idx.customer_orders_status: COMMIT
[0m19:13:58.471272 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m19:13:58.474268 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.customer_orders_status"
[0m19:13:58.475287 [debug] [Thread-1 (]: On model.dbt_idx.customer_orders_status: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.customer_orders_status"} */
drop view if exists "IDX-Stock"."IDX-Schema"."customer_orders_status__dbt_backup" cascade
[0m19:13:58.477273 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m19:13:58.479295 [debug] [Thread-1 (]: Timing info for model.dbt_idx.customer_orders_status (execute): 19:13:58.411021 => 19:13:58.479295
[0m19:13:58.480276 [debug] [Thread-1 (]: On model.dbt_idx.customer_orders_status: Close
[0m19:13:58.482277 [info ] [Thread-1 (]: 10 of 10 OK created sql view model IDX-Schema.customer_orders_status ........... [[32mCREATE VIEW[0m in 0.08s]
[0m19:13:58.484362 [debug] [Thread-1 (]: Finished running node model.dbt_idx.customer_orders_status
[0m19:13:58.487299 [debug] [MainThread]: Using postgres connection "master"
[0m19:13:58.488283 [debug] [MainThread]: On master: BEGIN
[0m19:13:58.489287 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m19:13:58.510452 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m19:13:58.511449 [debug] [MainThread]: On master: COMMIT
[0m19:13:58.511449 [debug] [MainThread]: Using postgres connection "master"
[0m19:13:58.512442 [debug] [MainThread]: On master: COMMIT
[0m19:13:58.514443 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m19:13:58.514443 [debug] [MainThread]: On master: Close
[0m19:13:58.517445 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:13:58.518453 [debug] [MainThread]: Connection 'list_IDX-Stock' was properly closed.
[0m19:13:58.519448 [debug] [MainThread]: Connection 'list_IDX-Stock_snapshots' was properly closed.
[0m19:13:58.520450 [debug] [MainThread]: Connection 'model.dbt_idx.customer_orders_status' was properly closed.
[0m19:13:58.521444 [info ] [MainThread]: 
[0m19:13:58.523450 [info ] [MainThread]: Finished running 7 view models, 3 table models in 0 hours 0 minutes and 1.35 seconds (1.35s).
[0m19:13:58.526479 [debug] [MainThread]: Command end result
[0m19:13:58.553069 [info ] [MainThread]: 
[0m19:13:58.555074 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m19:13:58.556046 [info ] [MainThread]: 
[0m19:13:58.557052 [error] [MainThread]: [33mDatabase Error in model dim_stocks (models\marts\core\dim_stocks.sql)[0m
[0m19:13:58.558111 [error] [MainThread]:   syntax error at or near "from"
[0m19:13:58.559051 [error] [MainThread]:   LINE 32: from stock a
[0m19:13:58.560053 [error] [MainThread]:            ^
[0m19:13:58.561053 [error] [MainThread]:   compiled Code at target\run\dbt_idx\models\marts\core\dim_stocks.sql
[0m19:13:58.562035 [info ] [MainThread]: 
[0m19:13:58.563071 [info ] [MainThread]: Done. PASS=9 WARN=0 ERROR=1 SKIP=0 TOTAL=10
[0m19:13:58.564032 [debug] [MainThread]: Command `dbt run` failed at 19:13:58.564032 after 1.98 seconds
[0m19:13:58.565076 [debug] [MainThread]: Flushing usage events


============================== 19:14:39.210641 | 011b54c7-8f86-4a3b-a191-d01f18f73727 ==============================
[0m19:14:39.210641 [info ] [MainThread]: Running with dbt=1.6.1
[0m19:14:39.214605 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'D:\\00 Project\\00 My Project\\IdeaProjects\\Py-DBT-IDX', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'D:\\00 Project\\00 My Project\\IdeaProjects\\Py-DBT-IDX\\logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'False'}
[0m19:14:39.335215 [info ] [MainThread]: Registered adapter: postgres=1.6.1
[0m19:14:39.344241 [debug] [MainThread]: checksum: efe19d9f5b93d1a98cc804fbfcdb6b3aced98b974af664946fee1cde8837deb7, vars: {}, profile: , target: , version: 1.6.1
[0m19:14:39.495162 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m19:14:39.496163 [debug] [MainThread]: Partial parsing: updated file: dbt_idx://models\staging\stg_eltool__stock.sql
[0m19:14:39.600847 [info ] [MainThread]: Found 10 models, 1 snapshot, 17 tests, 5 sources, 0 exposures, 0 metrics, 349 macros, 0 groups, 0 semantic models
[0m19:14:39.602814 [info ] [MainThread]: 
[0m19:14:39.604817 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m19:14:39.607811 [debug] [ThreadPool]: Acquiring new postgres connection 'list_IDX-Stock'
[0m19:14:39.617815 [debug] [ThreadPool]: Using postgres connection "list_IDX-Stock"
[0m19:14:39.618816 [debug] [ThreadPool]: On list_IDX-Stock: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "connection_name": "list_IDX-Stock"} */

    select distinct nspname from pg_namespace
  
[0m19:14:39.619830 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:14:39.653670 [debug] [ThreadPool]: SQL status: SELECT 12 in 0.0 seconds
[0m19:14:39.654705 [debug] [ThreadPool]: On list_IDX-Stock: Close
[0m19:14:39.658672 [debug] [ThreadPool]: Acquiring new postgres connection 'list_IDX-Stock_IDX-Schema'
[0m19:14:39.665705 [debug] [ThreadPool]: Using postgres connection "list_IDX-Stock_IDX-Schema"
[0m19:14:39.666704 [debug] [ThreadPool]: On list_IDX-Stock_IDX-Schema: BEGIN
[0m19:14:39.667738 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:14:39.688056 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m19:14:39.689052 [debug] [ThreadPool]: Using postgres connection "list_IDX-Stock_IDX-Schema"
[0m19:14:39.690055 [debug] [ThreadPool]: On list_IDX-Stock_IDX-Schema: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "connection_name": "list_IDX-Stock_IDX-Schema"} */
select
      'IDX-Stock' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'IDX-Schema'
    union all
    select
      'IDX-Stock' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'IDX-Schema'
    union all
    select
      'IDX-Stock' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'IDX-Schema'
  
[0m19:14:39.694051 [debug] [ThreadPool]: SQL status: SELECT 15 in 0.0 seconds
[0m19:14:39.696053 [debug] [ThreadPool]: On list_IDX-Stock_IDX-Schema: ROLLBACK
[0m19:14:39.698053 [debug] [ThreadPool]: On list_IDX-Stock_IDX-Schema: Close
[0m19:14:39.700057 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_IDX-Stock_IDX-Schema, now list_IDX-Stock_snapshots)
[0m19:14:39.707091 [debug] [ThreadPool]: Using postgres connection "list_IDX-Stock_snapshots"
[0m19:14:39.707091 [debug] [ThreadPool]: On list_IDX-Stock_snapshots: BEGIN
[0m19:14:39.708053 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:14:39.729039 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m19:14:39.730018 [debug] [ThreadPool]: Using postgres connection "list_IDX-Stock_snapshots"
[0m19:14:39.731019 [debug] [ThreadPool]: On list_IDX-Stock_snapshots: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "connection_name": "list_IDX-Stock_snapshots"} */
select
      'IDX-Stock' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'snapshots'
    union all
    select
      'IDX-Stock' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'snapshots'
    union all
    select
      'IDX-Stock' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'snapshots'
  
[0m19:14:39.735031 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.0 seconds
[0m19:14:39.736030 [debug] [ThreadPool]: On list_IDX-Stock_snapshots: ROLLBACK
[0m19:14:39.739030 [debug] [ThreadPool]: On list_IDX-Stock_snapshots: Close
[0m19:14:39.746030 [debug] [MainThread]: Using postgres connection "master"
[0m19:14:39.747030 [debug] [MainThread]: On master: BEGIN
[0m19:14:39.748065 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:14:39.770186 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m19:14:39.771185 [debug] [MainThread]: Using postgres connection "master"
[0m19:14:39.771185 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m19:14:39.778225 [debug] [MainThread]: SQL status: SELECT 8 in 0.0 seconds
[0m19:14:39.782222 [debug] [MainThread]: On master: ROLLBACK
[0m19:14:39.785185 [debug] [MainThread]: Using postgres connection "master"
[0m19:14:39.785185 [debug] [MainThread]: On master: BEGIN
[0m19:14:39.789188 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m19:14:39.789188 [debug] [MainThread]: On master: COMMIT
[0m19:14:39.790190 [debug] [MainThread]: Using postgres connection "master"
[0m19:14:39.791225 [debug] [MainThread]: On master: COMMIT
[0m19:14:39.793033 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m19:14:39.793033 [debug] [MainThread]: On master: Close
[0m19:14:39.795045 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m19:14:39.796045 [info ] [MainThread]: 
[0m19:14:39.801045 [debug] [Thread-1 (]: Began running node model.dbt_idx.stg_eltool__company
[0m19:14:39.802079 [info ] [Thread-1 (]: 1 of 10 START sql view model IDX-Schema.stg_eltool__company .................... [RUN]
[0m19:14:39.804047 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.dbt_idx.stg_eltool__company'
[0m19:14:39.804047 [debug] [Thread-1 (]: Began compiling node model.dbt_idx.stg_eltool__company
[0m19:14:39.812080 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_idx.stg_eltool__company"
[0m19:14:39.820479 [debug] [Thread-1 (]: Timing info for model.dbt_idx.stg_eltool__company (compile): 19:14:39.805071 => 19:14:39.819480
[0m19:14:39.820479 [debug] [Thread-1 (]: Began executing node model.dbt_idx.stg_eltool__company
[0m19:14:39.857140 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_idx.stg_eltool__company"
[0m19:14:39.863575 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__company"
[0m19:14:39.864558 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__company: BEGIN
[0m19:14:39.865575 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m19:14:39.886141 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m19:14:39.887140 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__company"
[0m19:14:39.888147 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__company: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__company"} */

  create view "IDX-Stock"."IDX-Schema"."stg_eltool__company__dbt_tmp"
    
    
  as (
    with source as (select *
                from "IDX-Stock"."IDX-Schema"."ksql-company-stream"),
     renamed as (select id,
                        ticker,
                        name,
                        logo
                 from source)
select *
from renamed
  );
[0m19:14:39.892155 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m19:14:39.899137 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__company"
[0m19:14:39.900152 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__company: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__company"} */
alter table "IDX-Stock"."IDX-Schema"."stg_eltool__company" rename to "stg_eltool__company__dbt_backup"
[0m19:14:39.902171 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:14:39.905218 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__company"
[0m19:14:39.906216 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__company: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__company"} */
alter table "IDX-Stock"."IDX-Schema"."stg_eltool__company__dbt_tmp" rename to "stg_eltool__company"
[0m19:14:39.908202 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:14:39.925216 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__company: COMMIT
[0m19:14:39.926182 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__company"
[0m19:14:39.927265 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__company: COMMIT
[0m19:14:39.930687 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m19:14:39.938765 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__company"
[0m19:14:39.939763 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__company: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__company"} */
drop view if exists "IDX-Stock"."IDX-Schema"."stg_eltool__company__dbt_backup" cascade
[0m19:14:39.943745 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m19:14:39.945757 [debug] [Thread-1 (]: Timing info for model.dbt_idx.stg_eltool__company (execute): 19:14:39.821519 => 19:14:39.944728
[0m19:14:39.945757 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__company: Close
[0m19:14:39.946754 [info ] [Thread-1 (]: 1 of 10 OK created sql view model IDX-Schema.stg_eltool__company ............... [[32mCREATE VIEW[0m in 0.14s]
[0m19:14:39.950270 [debug] [Thread-1 (]: Finished running node model.dbt_idx.stg_eltool__company
[0m19:14:39.952269 [debug] [Thread-1 (]: Began running node model.dbt_idx.stg_eltool__customers
[0m19:14:39.952269 [info ] [Thread-1 (]: 2 of 10 START sql view model IDX-Schema.stg_eltool__customers .................. [RUN]
[0m19:14:39.953305 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_idx.stg_eltool__company, now model.dbt_idx.stg_eltool__customers)
[0m19:14:39.954317 [debug] [Thread-1 (]: Began compiling node model.dbt_idx.stg_eltool__customers
[0m19:14:39.958326 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_idx.stg_eltool__customers"
[0m19:14:39.965699 [debug] [Thread-1 (]: Timing info for model.dbt_idx.stg_eltool__customers (compile): 19:14:39.955317 => 19:14:39.964698
[0m19:14:39.966701 [debug] [Thread-1 (]: Began executing node model.dbt_idx.stg_eltool__customers
[0m19:14:39.971733 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_idx.stg_eltool__customers"
[0m19:14:39.977698 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__customers"
[0m19:14:39.978738 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__customers: BEGIN
[0m19:14:39.979697 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:14:40.002316 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m19:14:40.003313 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__customers"
[0m19:14:40.003313 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__customers: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__customers"} */

  create view "IDX-Stock"."IDX-Schema"."stg_eltool__customers__dbt_tmp"
    
    
  as (
    with source as (select *
                from "IDX-Stock"."IDX-Schema"."customers"),
     renamed as (select
                     customer_id,
                    'This is Dummy' as dummy
                 from source
                 where customer_id = 1234567890)
select *
from renamed
  );
[0m19:14:40.007318 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m19:14:40.011350 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__customers"
[0m19:14:40.011350 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__customers: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__customers"} */
alter table "IDX-Stock"."IDX-Schema"."stg_eltool__customers" rename to "stg_eltool__customers__dbt_backup"
[0m19:14:40.014314 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:14:40.017351 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__customers"
[0m19:14:40.018312 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__customers: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__customers"} */
alter table "IDX-Stock"."IDX-Schema"."stg_eltool__customers__dbt_tmp" rename to "stg_eltool__customers"
[0m19:14:40.020315 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:14:40.024314 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__customers: COMMIT
[0m19:14:40.024314 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__customers"
[0m19:14:40.025314 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__customers: COMMIT
[0m19:14:40.029315 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m19:14:40.033313 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__customers"
[0m19:14:40.034354 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__customers: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__customers"} */
drop view if exists "IDX-Stock"."IDX-Schema"."stg_eltool__customers__dbt_backup" cascade
[0m19:14:40.038319 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m19:14:40.040322 [debug] [Thread-1 (]: Timing info for model.dbt_idx.stg_eltool__customers (execute): 19:14:39.966701 => 19:14:40.040322
[0m19:14:40.041371 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__customers: Close
[0m19:14:40.042337 [info ] [Thread-1 (]: 2 of 10 OK created sql view model IDX-Schema.stg_eltool__customers ............. [[32mCREATE VIEW[0m in 0.09s]
[0m19:14:40.044324 [debug] [Thread-1 (]: Finished running node model.dbt_idx.stg_eltool__customers
[0m19:14:40.045329 [debug] [Thread-1 (]: Began running node model.dbt_idx.stg_eltool__customers_snapshots
[0m19:14:40.046357 [info ] [Thread-1 (]: 3 of 10 START sql view model IDX-Schema.stg_eltool__customers_snapshots ........ [RUN]
[0m19:14:40.047340 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_idx.stg_eltool__customers, now model.dbt_idx.stg_eltool__customers_snapshots)
[0m19:14:40.048834 [debug] [Thread-1 (]: Began compiling node model.dbt_idx.stg_eltool__customers_snapshots
[0m19:14:40.051875 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_idx.stg_eltool__customers_snapshots"
[0m19:14:40.057826 [debug] [Thread-1 (]: Timing info for model.dbt_idx.stg_eltool__customers_snapshots (compile): 19:14:40.048834 => 19:14:40.057826
[0m19:14:40.058856 [debug] [Thread-1 (]: Began executing node model.dbt_idx.stg_eltool__customers_snapshots
[0m19:14:40.064866 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_idx.stg_eltool__customers_snapshots"
[0m19:14:40.071822 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__customers_snapshots"
[0m19:14:40.071822 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__customers_snapshots: BEGIN
[0m19:14:40.072856 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:14:40.094650 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m19:14:40.095645 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__customers_snapshots"
[0m19:14:40.095645 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__customers_snapshots: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__customers_snapshots"} */

  create view "IDX-Stock"."IDX-Schema"."stg_eltool__customers_snapshots__dbt_tmp"
    
    
  as (
    with source as (select *
                from "IDX-Stock"."snapshots"."customers_snapshot"),
     renamed as (select customer_id,
                        zipcode,
                        city,
                        state_code,
                        datetime_created::TIMESTAMP AS datetime_created,
                        datetime_updated::TIMESTAMP AS datetime_updated,
                        dbt_valid_from,
                        dbt_valid_to
                 from source)
select *
from renamed
  );
[0m19:14:40.102665 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m19:14:40.105651 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__customers_snapshots"
[0m19:14:40.106679 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__customers_snapshots: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__customers_snapshots"} */
alter table "IDX-Stock"."IDX-Schema"."stg_eltool__customers_snapshots" rename to "stg_eltool__customers_snapshots__dbt_backup"
[0m19:14:40.109649 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:14:40.113280 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__customers_snapshots"
[0m19:14:40.114259 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__customers_snapshots: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__customers_snapshots"} */
alter table "IDX-Stock"."IDX-Schema"."stg_eltool__customers_snapshots__dbt_tmp" rename to "stg_eltool__customers_snapshots"
[0m19:14:40.116291 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:14:40.119282 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__customers_snapshots: COMMIT
[0m19:14:40.120254 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__customers_snapshots"
[0m19:14:40.121247 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__customers_snapshots: COMMIT
[0m19:14:40.124299 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m19:14:40.127326 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__customers_snapshots"
[0m19:14:40.127326 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__customers_snapshots: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__customers_snapshots"} */
drop view if exists "IDX-Stock"."IDX-Schema"."stg_eltool__customers_snapshots__dbt_backup" cascade
[0m19:14:40.132291 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m19:14:40.133321 [debug] [Thread-1 (]: Timing info for model.dbt_idx.stg_eltool__customers_snapshots (execute): 19:14:40.059818 => 19:14:40.133321
[0m19:14:40.134353 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__customers_snapshots: Close
[0m19:14:40.136332 [info ] [Thread-1 (]: 3 of 10 OK created sql view model IDX-Schema.stg_eltool__customers_snapshots ... [[32mCREATE VIEW[0m in 0.09s]
[0m19:14:40.138349 [debug] [Thread-1 (]: Finished running node model.dbt_idx.stg_eltool__customers_snapshots
[0m19:14:40.139335 [debug] [Thread-1 (]: Began running node model.dbt_idx.stg_eltool__orders
[0m19:14:40.140327 [info ] [Thread-1 (]: 4 of 10 START sql view model IDX-Schema.stg_eltool__orders ..................... [RUN]
[0m19:14:40.140885 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_idx.stg_eltool__customers_snapshots, now model.dbt_idx.stg_eltool__orders)
[0m19:14:40.141894 [debug] [Thread-1 (]: Began compiling node model.dbt_idx.stg_eltool__orders
[0m19:14:40.144897 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_idx.stg_eltool__orders"
[0m19:14:40.156529 [debug] [Thread-1 (]: Timing info for model.dbt_idx.stg_eltool__orders (compile): 19:14:40.142911 => 19:14:40.156529
[0m19:14:40.157496 [debug] [Thread-1 (]: Began executing node model.dbt_idx.stg_eltool__orders
[0m19:14:40.163532 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_idx.stg_eltool__orders"
[0m19:14:40.174533 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__orders"
[0m19:14:40.175550 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__orders: BEGIN
[0m19:14:40.176495 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:14:40.197185 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m19:14:40.197185 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__orders"
[0m19:14:40.198220 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__orders: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__orders"} */

  create view "IDX-Stock"."IDX-Schema"."stg_eltool__orders__dbt_tmp"
    
    
  as (
    with source as (select *
                from "IDX-Stock"."IDX-Schema"."orders"),
     renamed as (select order_id,
                        cust_id AS customer_id,
                        order_status,
                        order_purchase_timestamp::TIMESTAMP,
                        order_approved_at::TIMESTAMP,
                        order_delivered_carrier_date::TIMESTAMP,
                        order_delivered_customer_date::TIMESTAMP,
                        order_estimated_delivery_date::TIMESTAMP
                 from source)
select *
from renamed
  );
[0m19:14:40.202186 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m19:14:40.206184 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__orders"
[0m19:14:40.206184 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__orders: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__orders"} */
alter table "IDX-Stock"."IDX-Schema"."stg_eltool__orders" rename to "stg_eltool__orders__dbt_backup"
[0m19:14:40.209185 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:14:40.213220 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__orders"
[0m19:14:40.214185 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__orders: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__orders"} */
alter table "IDX-Stock"."IDX-Schema"."stg_eltool__orders__dbt_tmp" rename to "stg_eltool__orders"
[0m19:14:40.216132 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:14:40.218158 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__orders: COMMIT
[0m19:14:40.219160 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__orders"
[0m19:14:40.219160 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__orders: COMMIT
[0m19:14:40.223122 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m19:14:40.226121 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__orders"
[0m19:14:40.227134 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__orders: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__orders"} */
drop view if exists "IDX-Stock"."IDX-Schema"."stg_eltool__orders__dbt_backup" cascade
[0m19:14:40.231140 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m19:14:40.233147 [debug] [Thread-1 (]: Timing info for model.dbt_idx.stg_eltool__orders (execute): 19:14:40.158498 => 19:14:40.233147
[0m19:14:40.234153 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__orders: Close
[0m19:14:40.235160 [info ] [Thread-1 (]: 4 of 10 OK created sql view model IDX-Schema.stg_eltool__orders ................ [[32mCREATE VIEW[0m in 0.09s]
[0m19:14:40.237163 [debug] [Thread-1 (]: Finished running node model.dbt_idx.stg_eltool__orders
[0m19:14:40.238154 [debug] [Thread-1 (]: Began running node model.dbt_idx.stg_eltool__state
[0m19:14:40.240154 [info ] [Thread-1 (]: 5 of 10 START sql view model IDX-Schema.stg_eltool__state ...................... [RUN]
[0m19:14:40.242156 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_idx.stg_eltool__orders, now model.dbt_idx.stg_eltool__state)
[0m19:14:40.243171 [debug] [Thread-1 (]: Began compiling node model.dbt_idx.stg_eltool__state
[0m19:14:40.247154 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_idx.stg_eltool__state"
[0m19:14:40.254186 [debug] [Thread-1 (]: Timing info for model.dbt_idx.stg_eltool__state (compile): 19:14:40.244216 => 19:14:40.253185
[0m19:14:40.254186 [debug] [Thread-1 (]: Began executing node model.dbt_idx.stg_eltool__state
[0m19:14:40.260192 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_idx.stg_eltool__state"
[0m19:14:40.266149 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__state"
[0m19:14:40.267185 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__state: BEGIN
[0m19:14:40.268150 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:14:40.289692 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m19:14:40.290674 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__state"
[0m19:14:40.291672 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__state: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__state"} */

  create view "IDX-Stock"."IDX-Schema"."stg_eltool__state__dbt_tmp"
    
    
  as (
    with source as (select *
                from "IDX-Stock"."IDX-Schema"."state"),
     renamed as (select state_identifier::INT AS state_id,
                         state_code::VARCHAR(2) AS state_code,
                         st_name::VARCHAR(30) AS state_name
                 from source)
select *
from renamed
  );
[0m19:14:40.295685 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m19:14:40.298673 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__state"
[0m19:14:40.299675 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__state: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__state"} */
alter table "IDX-Stock"."IDX-Schema"."stg_eltool__state" rename to "stg_eltool__state__dbt_backup"
[0m19:14:40.302637 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:14:40.305673 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__state"
[0m19:14:40.306639 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__state: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__state"} */
alter table "IDX-Stock"."IDX-Schema"."stg_eltool__state__dbt_tmp" rename to "stg_eltool__state"
[0m19:14:40.308968 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:14:40.310979 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__state: COMMIT
[0m19:14:40.311979 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__state"
[0m19:14:40.312978 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__state: COMMIT
[0m19:14:40.316288 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m19:14:40.319287 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__state"
[0m19:14:40.320289 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__state: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__state"} */
drop view if exists "IDX-Stock"."IDX-Schema"."stg_eltool__state__dbt_backup" cascade
[0m19:14:40.324288 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m19:14:40.326313 [debug] [Thread-1 (]: Timing info for model.dbt_idx.stg_eltool__state (execute): 19:14:40.255185 => 19:14:40.326313
[0m19:14:40.327288 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__state: Close
[0m19:14:40.328291 [info ] [Thread-1 (]: 5 of 10 OK created sql view model IDX-Schema.stg_eltool__state ................. [[32mCREATE VIEW[0m in 0.09s]
[0m19:14:40.330316 [debug] [Thread-1 (]: Finished running node model.dbt_idx.stg_eltool__state
[0m19:14:40.332296 [debug] [Thread-1 (]: Began running node model.dbt_idx.stg_eltool__stock
[0m19:14:40.333302 [info ] [Thread-1 (]: 6 of 10 START sql view model IDX-Schema.stg_eltool__stock ...................... [RUN]
[0m19:14:40.334309 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_idx.stg_eltool__state, now model.dbt_idx.stg_eltool__stock)
[0m19:14:40.335344 [debug] [Thread-1 (]: Began compiling node model.dbt_idx.stg_eltool__stock
[0m19:14:40.339305 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_idx.stg_eltool__stock"
[0m19:14:40.345607 [debug] [Thread-1 (]: Timing info for model.dbt_idx.stg_eltool__stock (compile): 19:14:40.335344 => 19:14:40.345607
[0m19:14:40.346630 [debug] [Thread-1 (]: Began executing node model.dbt_idx.stg_eltool__stock
[0m19:14:40.352127 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_idx.stg_eltool__stock"
[0m19:14:40.358162 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__stock"
[0m19:14:40.359163 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__stock: BEGIN
[0m19:14:40.360128 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:14:40.381610 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m19:14:40.382609 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__stock"
[0m19:14:40.382609 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__stock: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__stock"} */

  create view "IDX-Stock"."IDX-Schema"."stg_eltool__stock__dbt_tmp"
    
    
  as (
    with source as (select *
                from "IDX-Stock"."IDX-Schema"."ksql-stock-stream"),
     renamed as (select a.id,
                        a.ticker,
                        a.date,
                        a.open,
                        a.high,
                        a.low,
                        a.close,
                        a.volume
                 from source as a)
select *
from renamed
  );
[0m19:14:40.386644 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m19:14:40.390647 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__stock"
[0m19:14:40.391645 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__stock: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__stock"} */
alter table "IDX-Stock"."IDX-Schema"."stg_eltool__stock" rename to "stg_eltool__stock__dbt_backup"
[0m19:14:40.393644 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:14:40.397609 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__stock"
[0m19:14:40.397609 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__stock: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__stock"} */
alter table "IDX-Stock"."IDX-Schema"."stg_eltool__stock__dbt_tmp" rename to "stg_eltool__stock"
[0m19:14:40.400468 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:14:40.402486 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__stock: COMMIT
[0m19:14:40.403479 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__stock"
[0m19:14:40.404443 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__stock: COMMIT
[0m19:14:40.406998 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m19:14:40.410033 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__stock"
[0m19:14:40.411038 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__stock: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__stock"} */
drop view if exists "IDX-Stock"."IDX-Schema"."stg_eltool__stock__dbt_backup" cascade
[0m19:14:40.414999 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m19:14:40.416035 [debug] [Thread-1 (]: Timing info for model.dbt_idx.stg_eltool__stock (execute): 19:14:40.346630 => 19:14:40.416035
[0m19:14:40.417033 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__stock: Close
[0m19:14:40.419002 [info ] [Thread-1 (]: 6 of 10 OK created sql view model IDX-Schema.stg_eltool__stock ................. [[32mCREATE VIEW[0m in 0.08s]
[0m19:14:40.420999 [debug] [Thread-1 (]: Finished running node model.dbt_idx.stg_eltool__stock
[0m19:14:40.421999 [debug] [Thread-1 (]: Began running node model.dbt_idx.fact_orders
[0m19:14:40.423007 [info ] [Thread-1 (]: 7 of 10 START sql table model IDX-Schema.fact_orders ........................... [RUN]
[0m19:14:40.424027 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_idx.stg_eltool__stock, now model.dbt_idx.fact_orders)
[0m19:14:40.425000 [debug] [Thread-1 (]: Began compiling node model.dbt_idx.fact_orders
[0m19:14:40.428003 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_idx.fact_orders"
[0m19:14:40.435008 [debug] [Thread-1 (]: Timing info for model.dbt_idx.fact_orders (compile): 19:14:40.425000 => 19:14:40.434006
[0m19:14:40.436006 [debug] [Thread-1 (]: Began executing node model.dbt_idx.fact_orders
[0m19:14:40.462589 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_idx.fact_orders"
[0m19:14:40.467906 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.fact_orders"
[0m19:14:40.468871 [debug] [Thread-1 (]: On model.dbt_idx.fact_orders: BEGIN
[0m19:14:40.468871 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:14:40.492708 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m19:14:40.493721 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.fact_orders"
[0m19:14:40.493721 [debug] [Thread-1 (]: On model.dbt_idx.fact_orders: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.fact_orders"} */

  
    

  create  table "IDX-Stock"."IDX-Schema"."fact_orders__dbt_tmp"
  
  
    as
  
  (
    with orders as (
    select *
    from "IDX-Stock"."IDX-Schema"."stg_eltool__orders"
)
select * from orders
  );
  
[0m19:14:40.500720 [debug] [Thread-1 (]: SQL status: SELECT 999 in 0.0 seconds
[0m19:14:40.504755 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.fact_orders"
[0m19:14:40.504755 [debug] [Thread-1 (]: On model.dbt_idx.fact_orders: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.fact_orders"} */
alter table "IDX-Stock"."IDX-Schema"."fact_orders" rename to "fact_orders__dbt_backup"
[0m19:14:40.507504 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:14:40.510552 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.fact_orders"
[0m19:14:40.511514 [debug] [Thread-1 (]: On model.dbt_idx.fact_orders: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.fact_orders"} */
alter table "IDX-Stock"."IDX-Schema"."fact_orders__dbt_tmp" rename to "fact_orders"
[0m19:14:40.512515 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:14:40.518551 [debug] [Thread-1 (]: On model.dbt_idx.fact_orders: COMMIT
[0m19:14:40.519550 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.fact_orders"
[0m19:14:40.520514 [debug] [Thread-1 (]: On model.dbt_idx.fact_orders: COMMIT
[0m19:14:40.523513 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m19:14:40.529518 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.fact_orders"
[0m19:14:40.530514 [debug] [Thread-1 (]: On model.dbt_idx.fact_orders: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.fact_orders"} */
drop table if exists "IDX-Stock"."IDX-Schema"."fact_orders__dbt_backup" cascade
[0m19:14:40.536150 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m19:14:40.538184 [debug] [Thread-1 (]: Timing info for model.dbt_idx.fact_orders (execute): 19:14:40.436006 => 19:14:40.538184
[0m19:14:40.539147 [debug] [Thread-1 (]: On model.dbt_idx.fact_orders: Close
[0m19:14:40.541153 [info ] [Thread-1 (]: 7 of 10 OK created sql table model IDX-Schema.fact_orders ...................... [[32mSELECT 999[0m in 0.12s]
[0m19:14:40.543166 [debug] [Thread-1 (]: Finished running node model.dbt_idx.fact_orders
[0m19:14:40.544168 [debug] [Thread-1 (]: Began running node model.dbt_idx.dim_customers
[0m19:14:40.545149 [info ] [Thread-1 (]: 8 of 10 START sql table model IDX-Schema.dim_customers ......................... [RUN]
[0m19:14:40.546150 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_idx.fact_orders, now model.dbt_idx.dim_customers)
[0m19:14:40.547147 [debug] [Thread-1 (]: Began compiling node model.dbt_idx.dim_customers
[0m19:14:40.549728 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_idx.dim_customers"
[0m19:14:40.555728 [debug] [Thread-1 (]: Timing info for model.dbt_idx.dim_customers (compile): 19:14:40.547147 => 19:14:40.555728
[0m19:14:40.556729 [debug] [Thread-1 (]: Began executing node model.dbt_idx.dim_customers
[0m19:14:40.561732 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_idx.dim_customers"
[0m19:14:40.567736 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.dim_customers"
[0m19:14:40.568700 [debug] [Thread-1 (]: On model.dbt_idx.dim_customers: BEGIN
[0m19:14:40.569719 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:14:40.591419 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m19:14:40.592419 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.dim_customers"
[0m19:14:40.592419 [debug] [Thread-1 (]: On model.dbt_idx.dim_customers: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.dim_customers"} */

  
    

  create  table "IDX-Stock"."IDX-Schema"."dim_customers__dbt_tmp"
  
  
    as
  
  (
    -- noinspection SqlDialectInspectionForFile

with customers as (
    select *
    from "IDX-Stock"."IDX-Schema"."stg_eltool__customers_snapshots"
    ),
     state as (
         select *
         from "IDX-Stock"."IDX-Schema"."stg_eltool__state"
     )
select c.customer_id,
       c.zipcode,
       c.city,
       c.state_code,
       s.state_name,
       c.datetime_created,
       c.datetime_updated,
       c.dbt_valid_from::TIMESTAMP as valid_from,
        CASE WHEN c.dbt_valid_to IS NULL
            THEN '9999-12-31'::TIMESTAMP
            ELSE c.dbt_valid_to::TIMESTAMP
        END as valid_to
from customers c
    join state s on c.state_code = s.state_code
  );
  
[0m19:14:40.596932 [debug] [Thread-1 (]: SQL status: SELECT 100 in 0.0 seconds
[0m19:14:40.601936 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.dim_customers"
[0m19:14:40.602979 [debug] [Thread-1 (]: On model.dbt_idx.dim_customers: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.dim_customers"} */
alter table "IDX-Stock"."IDX-Schema"."dim_customers" rename to "dim_customers__dbt_backup"
[0m19:14:40.605990 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:14:40.611966 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.dim_customers"
[0m19:14:40.612931 [debug] [Thread-1 (]: On model.dbt_idx.dim_customers: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.dim_customers"} */
alter table "IDX-Stock"."IDX-Schema"."dim_customers__dbt_tmp" rename to "dim_customers"
[0m19:14:40.614966 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:14:40.655630 [debug] [Thread-1 (]: On model.dbt_idx.dim_customers: COMMIT
[0m19:14:40.656621 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.dim_customers"
[0m19:14:40.657626 [debug] [Thread-1 (]: On model.dbt_idx.dim_customers: COMMIT
[0m19:14:40.661604 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m19:14:40.666645 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.dim_customers"
[0m19:14:40.667619 [debug] [Thread-1 (]: On model.dbt_idx.dim_customers: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.dim_customers"} */
drop table if exists "IDX-Stock"."IDX-Schema"."dim_customers__dbt_backup" cascade
[0m19:14:40.672894 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m19:14:40.674909 [debug] [Thread-1 (]: Timing info for model.dbt_idx.dim_customers (execute): 19:14:40.557702 => 19:14:40.673874
[0m19:14:40.674909 [debug] [Thread-1 (]: On model.dbt_idx.dim_customers: Close
[0m19:14:40.677888 [info ] [Thread-1 (]: 8 of 10 OK created sql table model IDX-Schema.dim_customers .................... [[32mSELECT 100[0m in 0.13s]
[0m19:14:40.678874 [debug] [Thread-1 (]: Finished running node model.dbt_idx.dim_customers
[0m19:14:40.679876 [debug] [Thread-1 (]: Began running node model.dbt_idx.dim_stocks
[0m19:14:40.680894 [info ] [Thread-1 (]: 9 of 10 START sql table model IDX-Schema.dim_stocks ............................ [RUN]
[0m19:14:40.682875 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_idx.dim_customers, now model.dbt_idx.dim_stocks)
[0m19:14:40.682875 [debug] [Thread-1 (]: Began compiling node model.dbt_idx.dim_stocks
[0m19:14:40.685908 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_idx.dim_stocks"
[0m19:14:40.692910 [debug] [Thread-1 (]: Timing info for model.dbt_idx.dim_stocks (compile): 19:14:40.683910 => 19:14:40.691933
[0m19:14:40.693895 [debug] [Thread-1 (]: Began executing node model.dbt_idx.dim_stocks
[0m19:14:40.697931 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_idx.dim_stocks"
[0m19:14:40.703895 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.dim_stocks"
[0m19:14:40.703895 [debug] [Thread-1 (]: On model.dbt_idx.dim_stocks: BEGIN
[0m19:14:40.704930 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:14:40.725657 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m19:14:40.726640 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.dim_stocks"
[0m19:14:40.727640 [debug] [Thread-1 (]: On model.dbt_idx.dim_stocks: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.dim_stocks"} */

  
    

  create  table "IDX-Stock"."IDX-Schema"."dim_stocks__dbt_tmp"
  
  
    as
  
  (
    -- noinspection SqlDialectInspectionForFile

with stock as (
    select *
    from "IDX-Stock"."IDX-Schema"."stg_eltool__stock"
    ),
     company as (
         select *
         from "IDX-Stock"."IDX-Schema"."stg_eltool__company"
     )
select a.id,
       a.ticker,
       b.name,
       a.date,
       a.open,
       a.high,
       a.low,
       a.close,
       a.colume,
       b.logo,
from stock a
    join company b on a.id = b.id
  );
  
[0m19:14:40.729647 [debug] [Thread-1 (]: Postgres adapter: Postgres error: syntax error at or near "from"
LINE 32: from stock a
         ^

[0m19:14:40.730640 [debug] [Thread-1 (]: On model.dbt_idx.dim_stocks: ROLLBACK
[0m19:14:40.732647 [debug] [Thread-1 (]: Timing info for model.dbt_idx.dim_stocks (execute): 19:14:40.693895 => 19:14:40.732647
[0m19:14:40.733649 [debug] [Thread-1 (]: On model.dbt_idx.dim_stocks: Close
[0m19:14:40.746041 [debug] [Thread-1 (]: Database Error in model dim_stocks (models\marts\core\dim_stocks.sql)
  syntax error at or near "from"
  LINE 32: from stock a
           ^
  compiled Code at target\run\dbt_idx\models\marts\core\dim_stocks.sql
[0m19:14:40.747014 [error] [Thread-1 (]: 9 of 10 ERROR creating sql table model IDX-Schema.dim_stocks ................... [[31mERROR[0m in 0.07s]
[0m19:14:40.748524 [debug] [Thread-1 (]: Finished running node model.dbt_idx.dim_stocks
[0m19:14:40.749531 [debug] [Thread-1 (]: Began running node model.dbt_idx.customer_orders_status
[0m19:14:40.749531 [info ] [Thread-1 (]: 10 of 10 START sql view model IDX-Schema.customer_orders_status ................ [RUN]
[0m19:14:40.751532 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_idx.dim_stocks, now model.dbt_idx.customer_orders_status)
[0m19:14:40.752538 [debug] [Thread-1 (]: Began compiling node model.dbt_idx.customer_orders_status
[0m19:14:40.755558 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_idx.customer_orders_status"
[0m19:14:40.763205 [debug] [Thread-1 (]: Timing info for model.dbt_idx.customer_orders_status (compile): 19:14:40.752538 => 19:14:40.762591
[0m19:14:40.764366 [debug] [Thread-1 (]: Began executing node model.dbt_idx.customer_orders_status
[0m19:14:40.773347 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_idx.customer_orders_status"
[0m19:14:40.781376 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.customer_orders_status"
[0m19:14:40.782419 [debug] [Thread-1 (]: On model.dbt_idx.customer_orders_status: BEGIN
[0m19:14:40.783419 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:14:40.804015 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m19:14:40.804015 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.customer_orders_status"
[0m19:14:40.805041 [debug] [Thread-1 (]: On model.dbt_idx.customer_orders_status: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.customer_orders_status"} */

  create view "IDX-Stock"."IDX-Schema"."customer_orders_status__dbt_tmp"
    
    
  as (
    with orders as (select *
                from "IDX-Stock"."IDX-Schema"."fact_orders"),
     customers as (select *
                   from "IDX-Stock"."IDX-Schema"."dim_customers")
select o.order_id,
       o.customer_id,
       o.order_status,
       o.order_purchase_timestamp,
       o.order_approved_at,
       o.order_delivered_carrier_date,
       o.order_delivered_customer_date,
       o.order_estimated_delivery_date,
       c.zipcode    as customer_zipcode,
       c.city       as customer_city,
       c.state_code as customer_state_code,
       c.state_name as customer_state_name
from orders o
    join customers c on o.customer_id = c.customer_id
    and o.order_purchase_timestamp >= c.valid_from
    and o.order_purchase_timestamp <= c.valid_to
  );
[0m19:14:40.808754 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m19:14:40.811765 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.customer_orders_status"
[0m19:14:40.812799 [debug] [Thread-1 (]: On model.dbt_idx.customer_orders_status: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.customer_orders_status"} */
alter table "IDX-Stock"."IDX-Schema"."customer_orders_status__dbt_tmp" rename to "customer_orders_status"
[0m19:14:40.815765 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:14:40.817800 [debug] [Thread-1 (]: On model.dbt_idx.customer_orders_status: COMMIT
[0m19:14:40.817800 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.customer_orders_status"
[0m19:14:40.818804 [debug] [Thread-1 (]: On model.dbt_idx.customer_orders_status: COMMIT
[0m19:14:40.821764 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m19:14:40.824789 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.customer_orders_status"
[0m19:14:40.825807 [debug] [Thread-1 (]: On model.dbt_idx.customer_orders_status: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.customer_orders_status"} */
drop view if exists "IDX-Stock"."IDX-Schema"."customer_orders_status__dbt_backup" cascade
[0m19:14:40.827787 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m19:14:40.829765 [debug] [Thread-1 (]: Timing info for model.dbt_idx.customer_orders_status (execute): 19:14:40.764924 => 19:14:40.829765
[0m19:14:40.830765 [debug] [Thread-1 (]: On model.dbt_idx.customer_orders_status: Close
[0m19:14:40.831764 [info ] [Thread-1 (]: 10 of 10 OK created sql view model IDX-Schema.customer_orders_status ........... [[32mCREATE VIEW[0m in 0.08s]
[0m19:14:40.833784 [debug] [Thread-1 (]: Finished running node model.dbt_idx.customer_orders_status
[0m19:14:40.836781 [debug] [MainThread]: Using postgres connection "master"
[0m19:14:40.837776 [debug] [MainThread]: On master: BEGIN
[0m19:14:40.837776 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m19:14:40.857687 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m19:14:40.858709 [debug] [MainThread]: On master: COMMIT
[0m19:14:40.859686 [debug] [MainThread]: Using postgres connection "master"
[0m19:14:40.859686 [debug] [MainThread]: On master: COMMIT
[0m19:14:40.861690 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m19:14:40.862710 [debug] [MainThread]: On master: Close
[0m19:14:40.863698 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:14:40.865697 [debug] [MainThread]: Connection 'list_IDX-Stock' was properly closed.
[0m19:14:40.866692 [debug] [MainThread]: Connection 'list_IDX-Stock_snapshots' was properly closed.
[0m19:14:40.867693 [debug] [MainThread]: Connection 'model.dbt_idx.customer_orders_status' was properly closed.
[0m19:14:40.868702 [info ] [MainThread]: 
[0m19:14:40.869688 [info ] [MainThread]: Finished running 7 view models, 3 table models in 0 hours 0 minutes and 1.26 seconds (1.26s).
[0m19:14:40.873720 [debug] [MainThread]: Command end result
[0m19:14:40.899692 [info ] [MainThread]: 
[0m19:14:40.900695 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m19:14:40.902697 [info ] [MainThread]: 
[0m19:14:40.903715 [error] [MainThread]: [33mDatabase Error in model dim_stocks (models\marts\core\dim_stocks.sql)[0m
[0m19:14:40.905691 [error] [MainThread]:   syntax error at or near "from"
[0m19:14:40.906687 [error] [MainThread]:   LINE 32: from stock a
[0m19:14:40.907706 [error] [MainThread]:            ^
[0m19:14:40.908712 [error] [MainThread]:   compiled Code at target\run\dbt_idx\models\marts\core\dim_stocks.sql
[0m19:14:40.909685 [info ] [MainThread]: 
[0m19:14:40.911695 [info ] [MainThread]: Done. PASS=9 WARN=0 ERROR=1 SKIP=0 TOTAL=10
[0m19:14:40.912687 [debug] [MainThread]: Command `dbt run` failed at 19:14:40.912687 after 1.74 seconds
[0m19:14:40.913686 [debug] [MainThread]: Flushing usage events


============================== 19:15:01.239295 | c6a88af5-0ba7-42ad-9a11-dd47219781a2 ==============================
[0m19:15:01.239295 [info ] [MainThread]: Running with dbt=1.6.1
[0m19:15:01.244783 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'D:\\00 Project\\00 My Project\\IdeaProjects\\Py-DBT-IDX', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': 'D:\\00 Project\\00 My Project\\IdeaProjects\\Py-DBT-IDX\\logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'False'}
[0m19:15:01.374486 [info ] [MainThread]: Registered adapter: postgres=1.6.1
[0m19:15:01.385523 [debug] [MainThread]: checksum: efe19d9f5b93d1a98cc804fbfcdb6b3aced98b974af664946fee1cde8837deb7, vars: {}, profile: , target: , version: 1.6.1
[0m19:15:01.586358 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m19:15:01.587358 [debug] [MainThread]: Partial parsing: updated file: dbt_idx://models\staging\stg_eltool__stock.sql
[0m19:15:01.710757 [info ] [MainThread]: Found 10 models, 1 snapshot, 17 tests, 5 sources, 0 exposures, 0 metrics, 349 macros, 0 groups, 0 semantic models
[0m19:15:01.714294 [info ] [MainThread]: 
[0m19:15:01.716821 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m19:15:01.721603 [debug] [ThreadPool]: Acquiring new postgres connection 'list_IDX-Stock'
[0m19:15:01.747168 [debug] [ThreadPool]: Using postgres connection "list_IDX-Stock"
[0m19:15:01.749165 [debug] [ThreadPool]: On list_IDX-Stock: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "connection_name": "list_IDX-Stock"} */

    select distinct nspname from pg_namespace
  
[0m19:15:01.750164 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:15:01.797844 [debug] [ThreadPool]: SQL status: SELECT 12 in 0.0 seconds
[0m19:15:01.800841 [debug] [ThreadPool]: On list_IDX-Stock: Close
[0m19:15:01.804845 [debug] [ThreadPool]: Acquiring new postgres connection 'list_IDX-Stock_snapshots'
[0m19:15:01.814357 [debug] [ThreadPool]: Using postgres connection "list_IDX-Stock_snapshots"
[0m19:15:01.815358 [debug] [ThreadPool]: On list_IDX-Stock_snapshots: BEGIN
[0m19:15:01.815358 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:15:01.840607 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m19:15:01.841604 [debug] [ThreadPool]: Using postgres connection "list_IDX-Stock_snapshots"
[0m19:15:01.842603 [debug] [ThreadPool]: On list_IDX-Stock_snapshots: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "connection_name": "list_IDX-Stock_snapshots"} */
select
      'IDX-Stock' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'snapshots'
    union all
    select
      'IDX-Stock' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'snapshots'
    union all
    select
      'IDX-Stock' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'snapshots'
  
[0m19:15:01.847615 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.0 seconds
[0m19:15:01.850601 [debug] [ThreadPool]: On list_IDX-Stock_snapshots: ROLLBACK
[0m19:15:01.852606 [debug] [ThreadPool]: On list_IDX-Stock_snapshots: Close
[0m19:15:01.854614 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_IDX-Stock_snapshots, now list_IDX-Stock_IDX-Schema)
[0m19:15:01.859618 [debug] [ThreadPool]: Using postgres connection "list_IDX-Stock_IDX-Schema"
[0m19:15:01.860610 [debug] [ThreadPool]: On list_IDX-Stock_IDX-Schema: BEGIN
[0m19:15:01.861616 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:15:01.881135 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m19:15:01.882135 [debug] [ThreadPool]: Using postgres connection "list_IDX-Stock_IDX-Schema"
[0m19:15:01.883134 [debug] [ThreadPool]: On list_IDX-Stock_IDX-Schema: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "connection_name": "list_IDX-Stock_IDX-Schema"} */
select
      'IDX-Stock' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'IDX-Schema'
    union all
    select
      'IDX-Stock' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'IDX-Schema'
    union all
    select
      'IDX-Stock' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'IDX-Schema'
  
[0m19:15:01.887133 [debug] [ThreadPool]: SQL status: SELECT 15 in 0.0 seconds
[0m19:15:01.890135 [debug] [ThreadPool]: On list_IDX-Stock_IDX-Schema: ROLLBACK
[0m19:15:01.892163 [debug] [ThreadPool]: On list_IDX-Stock_IDX-Schema: Close
[0m19:15:01.901199 [debug] [MainThread]: Using postgres connection "master"
[0m19:15:01.902198 [debug] [MainThread]: On master: BEGIN
[0m19:15:01.902198 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:15:01.923654 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m19:15:01.924652 [debug] [MainThread]: Using postgres connection "master"
[0m19:15:01.925650 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m19:15:01.933646 [debug] [MainThread]: SQL status: SELECT 8 in 0.0 seconds
[0m19:15:01.937681 [debug] [MainThread]: On master: ROLLBACK
[0m19:15:01.939663 [debug] [MainThread]: Using postgres connection "master"
[0m19:15:01.940650 [debug] [MainThread]: On master: BEGIN
[0m19:15:01.943487 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m19:15:01.943487 [debug] [MainThread]: On master: COMMIT
[0m19:15:01.944518 [debug] [MainThread]: Using postgres connection "master"
[0m19:15:01.945500 [debug] [MainThread]: On master: COMMIT
[0m19:15:01.946482 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m19:15:01.947512 [debug] [MainThread]: On master: Close
[0m19:15:01.948483 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m19:15:01.950488 [info ] [MainThread]: 
[0m19:15:01.955484 [debug] [Thread-1 (]: Began running node model.dbt_idx.stg_eltool__company
[0m19:15:01.956489 [info ] [Thread-1 (]: 1 of 10 START sql view model IDX-Schema.stg_eltool__company .................... [RUN]
[0m19:15:01.957517 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.dbt_idx.stg_eltool__company'
[0m19:15:01.958491 [debug] [Thread-1 (]: Began compiling node model.dbt_idx.stg_eltool__company
[0m19:15:01.965490 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_idx.stg_eltool__company"
[0m19:15:01.972859 [debug] [Thread-1 (]: Timing info for model.dbt_idx.stg_eltool__company (compile): 19:15:01.959489 => 19:15:01.971888
[0m19:15:01.973853 [debug] [Thread-1 (]: Began executing node model.dbt_idx.stg_eltool__company
[0m19:15:02.010853 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_idx.stg_eltool__company"
[0m19:15:02.017546 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__company"
[0m19:15:02.018534 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__company: BEGIN
[0m19:15:02.018534 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m19:15:02.040855 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m19:15:02.041830 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__company"
[0m19:15:02.041830 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__company: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__company"} */

  create view "IDX-Stock"."IDX-Schema"."stg_eltool__company__dbt_tmp"
    
    
  as (
    with source as (select *
                from "IDX-Stock"."IDX-Schema"."ksql-company-stream"),
     renamed as (select id,
                        ticker,
                        name,
                        logo
                 from source)
select *
from renamed
  );
[0m19:15:02.046828 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m19:15:02.052865 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__company"
[0m19:15:02.053863 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__company: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__company"} */
alter table "IDX-Stock"."IDX-Schema"."stg_eltool__company" rename to "stg_eltool__company__dbt_backup"
[0m19:15:02.056873 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:15:02.060910 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__company"
[0m19:15:02.061918 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__company: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__company"} */
alter table "IDX-Stock"."IDX-Schema"."stg_eltool__company__dbt_tmp" rename to "stg_eltool__company"
[0m19:15:02.064624 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:15:02.081103 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__company: COMMIT
[0m19:15:02.082104 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__company"
[0m19:15:02.083102 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__company: COMMIT
[0m19:15:02.086303 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m19:15:02.095335 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__company"
[0m19:15:02.095335 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__company: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__company"} */
drop view if exists "IDX-Stock"."IDX-Schema"."stg_eltool__company__dbt_backup" cascade
[0m19:15:02.100340 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m19:15:02.101302 [debug] [Thread-1 (]: Timing info for model.dbt_idx.stg_eltool__company (execute): 19:15:01.973853 => 19:15:02.101302
[0m19:15:02.102300 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__company: Close
[0m19:15:02.104302 [info ] [Thread-1 (]: 1 of 10 OK created sql view model IDX-Schema.stg_eltool__company ............... [[32mCREATE VIEW[0m in 0.15s]
[0m19:15:02.106316 [debug] [Thread-1 (]: Finished running node model.dbt_idx.stg_eltool__company
[0m19:15:02.107302 [debug] [Thread-1 (]: Began running node model.dbt_idx.stg_eltool__customers
[0m19:15:02.109304 [info ] [Thread-1 (]: 2 of 10 START sql view model IDX-Schema.stg_eltool__customers .................. [RUN]
[0m19:15:02.110322 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_idx.stg_eltool__company, now model.dbt_idx.stg_eltool__customers)
[0m19:15:02.111305 [debug] [Thread-1 (]: Began compiling node model.dbt_idx.stg_eltool__customers
[0m19:15:02.114339 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_idx.stg_eltool__customers"
[0m19:15:02.121339 [debug] [Thread-1 (]: Timing info for model.dbt_idx.stg_eltool__customers (compile): 19:15:02.112300 => 19:15:02.120336
[0m19:15:02.121339 [debug] [Thread-1 (]: Began executing node model.dbt_idx.stg_eltool__customers
[0m19:15:02.127336 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_idx.stg_eltool__customers"
[0m19:15:02.132148 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__customers"
[0m19:15:02.133147 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__customers: BEGIN
[0m19:15:02.134148 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:15:02.155943 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m19:15:02.156975 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__customers"
[0m19:15:02.157959 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__customers: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__customers"} */

  create view "IDX-Stock"."IDX-Schema"."stg_eltool__customers__dbt_tmp"
    
    
  as (
    with source as (select *
                from "IDX-Stock"."IDX-Schema"."customers"),
     renamed as (select
                     customer_id,
                    'This is Dummy' as dummy
                 from source
                 where customer_id = 1234567890)
select *
from renamed
  );
[0m19:15:02.161940 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m19:15:02.164976 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__customers"
[0m19:15:02.165990 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__customers: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__customers"} */
alter table "IDX-Stock"."IDX-Schema"."stg_eltool__customers" rename to "stg_eltool__customers__dbt_backup"
[0m19:15:02.167982 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:15:02.172527 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__customers"
[0m19:15:02.173527 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__customers: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__customers"} */
alter table "IDX-Stock"."IDX-Schema"."stg_eltool__customers__dbt_tmp" rename to "stg_eltool__customers"
[0m19:15:02.175528 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:15:02.179525 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__customers: COMMIT
[0m19:15:02.180528 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__customers"
[0m19:15:02.180528 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__customers: COMMIT
[0m19:15:02.184542 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m19:15:02.187526 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__customers"
[0m19:15:02.188525 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__customers: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__customers"} */
drop view if exists "IDX-Stock"."IDX-Schema"."stg_eltool__customers__dbt_backup" cascade
[0m19:15:02.192901 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m19:15:02.194937 [debug] [Thread-1 (]: Timing info for model.dbt_idx.stg_eltool__customers (execute): 19:15:02.122337 => 19:15:02.194937
[0m19:15:02.195901 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__customers: Close
[0m19:15:02.196908 [info ] [Thread-1 (]: 2 of 10 OK created sql view model IDX-Schema.stg_eltool__customers ............. [[32mCREATE VIEW[0m in 0.09s]
[0m19:15:02.198905 [debug] [Thread-1 (]: Finished running node model.dbt_idx.stg_eltool__customers
[0m19:15:02.200914 [debug] [Thread-1 (]: Began running node model.dbt_idx.stg_eltool__customers_snapshots
[0m19:15:02.201900 [info ] [Thread-1 (]: 3 of 10 START sql view model IDX-Schema.stg_eltool__customers_snapshots ........ [RUN]
[0m19:15:02.203902 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_idx.stg_eltool__customers, now model.dbt_idx.stg_eltool__customers_snapshots)
[0m19:15:02.204901 [debug] [Thread-1 (]: Began compiling node model.dbt_idx.stg_eltool__customers_snapshots
[0m19:15:02.207936 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_idx.stg_eltool__customers_snapshots"
[0m19:15:02.214906 [debug] [Thread-1 (]: Timing info for model.dbt_idx.stg_eltool__customers_snapshots (compile): 19:15:02.205907 => 19:15:02.213932
[0m19:15:02.215901 [debug] [Thread-1 (]: Began executing node model.dbt_idx.stg_eltool__customers_snapshots
[0m19:15:02.222931 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_idx.stg_eltool__customers_snapshots"
[0m19:15:02.229901 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__customers_snapshots"
[0m19:15:02.230927 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__customers_snapshots: BEGIN
[0m19:15:02.231960 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:15:02.254557 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m19:15:02.255546 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__customers_snapshots"
[0m19:15:02.255546 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__customers_snapshots: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__customers_snapshots"} */

  create view "IDX-Stock"."IDX-Schema"."stg_eltool__customers_snapshots__dbt_tmp"
    
    
  as (
    with source as (select *
                from "IDX-Stock"."snapshots"."customers_snapshot"),
     renamed as (select customer_id,
                        zipcode,
                        city,
                        state_code,
                        datetime_created::TIMESTAMP AS datetime_created,
                        datetime_updated::TIMESTAMP AS datetime_updated,
                        dbt_valid_from,
                        dbt_valid_to
                 from source)
select *
from renamed
  );
[0m19:15:02.260086 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m19:15:02.264080 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__customers_snapshots"
[0m19:15:02.265047 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__customers_snapshots: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__customers_snapshots"} */
alter table "IDX-Stock"."IDX-Schema"."stg_eltool__customers_snapshots" rename to "stg_eltool__customers_snapshots__dbt_backup"
[0m19:15:02.268059 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:15:02.271698 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__customers_snapshots"
[0m19:15:02.272699 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__customers_snapshots: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__customers_snapshots"} */
alter table "IDX-Stock"."IDX-Schema"."stg_eltool__customers_snapshots__dbt_tmp" rename to "stg_eltool__customers_snapshots"
[0m19:15:02.275701 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:15:02.277731 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__customers_snapshots: COMMIT
[0m19:15:02.278693 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__customers_snapshots"
[0m19:15:02.279802 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__customers_snapshots: COMMIT
[0m19:15:02.283792 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m19:15:02.285793 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__customers_snapshots"
[0m19:15:02.287299 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__customers_snapshots: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__customers_snapshots"} */
drop view if exists "IDX-Stock"."IDX-Schema"."stg_eltool__customers_snapshots__dbt_backup" cascade
[0m19:15:02.292306 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m19:15:02.294304 [debug] [Thread-1 (]: Timing info for model.dbt_idx.stg_eltool__customers_snapshots (execute): 19:15:02.215901 => 19:15:02.294304
[0m19:15:02.295308 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__customers_snapshots: Close
[0m19:15:02.297306 [info ] [Thread-1 (]: 3 of 10 OK created sql view model IDX-Schema.stg_eltool__customers_snapshots ... [[32mCREATE VIEW[0m in 0.09s]
[0m19:15:02.299311 [debug] [Thread-1 (]: Finished running node model.dbt_idx.stg_eltool__customers_snapshots
[0m19:15:02.300315 [debug] [Thread-1 (]: Began running node model.dbt_idx.stg_eltool__orders
[0m19:15:02.302321 [info ] [Thread-1 (]: 4 of 10 START sql view model IDX-Schema.stg_eltool__orders ..................... [RUN]
[0m19:15:02.303304 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_idx.stg_eltool__customers_snapshots, now model.dbt_idx.stg_eltool__orders)
[0m19:15:02.304341 [debug] [Thread-1 (]: Began compiling node model.dbt_idx.stg_eltool__orders
[0m19:15:02.307344 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_idx.stg_eltool__orders"
[0m19:15:02.318306 [debug] [Thread-1 (]: Timing info for model.dbt_idx.stg_eltool__orders (compile): 19:15:02.305342 => 19:15:02.317339
[0m19:15:02.319306 [debug] [Thread-1 (]: Began executing node model.dbt_idx.stg_eltool__orders
[0m19:15:02.323342 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_idx.stg_eltool__orders"
[0m19:15:02.335993 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__orders"
[0m19:15:02.336997 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__orders: BEGIN
[0m19:15:02.338033 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:15:02.358915 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m19:15:02.359918 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__orders"
[0m19:15:02.360972 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__orders: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__orders"} */

  create view "IDX-Stock"."IDX-Schema"."stg_eltool__orders__dbt_tmp"
    
    
  as (
    with source as (select *
                from "IDX-Stock"."IDX-Schema"."orders"),
     renamed as (select order_id,
                        cust_id AS customer_id,
                        order_status,
                        order_purchase_timestamp::TIMESTAMP,
                        order_approved_at::TIMESTAMP,
                        order_delivered_carrier_date::TIMESTAMP,
                        order_delivered_customer_date::TIMESTAMP,
                        order_estimated_delivery_date::TIMESTAMP
                 from source)
select *
from renamed
  );
[0m19:15:02.364211 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m19:15:02.368224 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__orders"
[0m19:15:02.369235 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__orders: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__orders"} */
alter table "IDX-Stock"."IDX-Schema"."stg_eltool__orders" rename to "stg_eltool__orders__dbt_backup"
[0m19:15:02.371749 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:15:02.374785 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__orders"
[0m19:15:02.374785 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__orders: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__orders"} */
alter table "IDX-Stock"."IDX-Schema"."stg_eltool__orders__dbt_tmp" rename to "stg_eltool__orders"
[0m19:15:02.377748 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:15:02.379784 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__orders: COMMIT
[0m19:15:02.380783 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__orders"
[0m19:15:02.381802 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__orders: COMMIT
[0m19:15:02.384793 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m19:15:02.387825 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__orders"
[0m19:15:02.388800 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__orders: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__orders"} */
drop view if exists "IDX-Stock"."IDX-Schema"."stg_eltool__orders__dbt_backup" cascade
[0m19:15:02.392800 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m19:15:02.394828 [debug] [Thread-1 (]: Timing info for model.dbt_idx.stg_eltool__orders (execute): 19:15:02.319306 => 19:15:02.393800
[0m19:15:02.394828 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__orders: Close
[0m19:15:02.396811 [info ] [Thread-1 (]: 4 of 10 OK created sql view model IDX-Schema.stg_eltool__orders ................ [[32mCREATE VIEW[0m in 0.09s]
[0m19:15:02.398798 [debug] [Thread-1 (]: Finished running node model.dbt_idx.stg_eltool__orders
[0m19:15:02.399801 [debug] [Thread-1 (]: Began running node model.dbt_idx.stg_eltool__state
[0m19:15:02.401800 [info ] [Thread-1 (]: 5 of 10 START sql view model IDX-Schema.stg_eltool__state ...................... [RUN]
[0m19:15:02.402837 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_idx.stg_eltool__orders, now model.dbt_idx.stg_eltool__state)
[0m19:15:02.403828 [debug] [Thread-1 (]: Began compiling node model.dbt_idx.stg_eltool__state
[0m19:15:02.406827 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_idx.stg_eltool__state"
[0m19:15:02.412908 [debug] [Thread-1 (]: Timing info for model.dbt_idx.stg_eltool__state (compile): 19:15:02.404828 => 19:15:02.412908
[0m19:15:02.413874 [debug] [Thread-1 (]: Began executing node model.dbt_idx.stg_eltool__state
[0m19:15:02.418873 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_idx.stg_eltool__state"
[0m19:15:02.424503 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__state"
[0m19:15:02.425500 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__state: BEGIN
[0m19:15:02.426499 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:15:02.450464 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m19:15:02.450464 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__state"
[0m19:15:02.451489 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__state: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__state"} */

  create view "IDX-Stock"."IDX-Schema"."stg_eltool__state__dbt_tmp"
    
    
  as (
    with source as (select *
                from "IDX-Stock"."IDX-Schema"."state"),
     renamed as (select state_identifier::INT AS state_id,
                         state_code::VARCHAR(2) AS state_code,
                         st_name::VARCHAR(30) AS state_name
                 from source)
select *
from renamed
  );
[0m19:15:02.454487 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m19:15:02.458534 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__state"
[0m19:15:02.459534 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__state: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__state"} */
alter table "IDX-Stock"."IDX-Schema"."stg_eltool__state" rename to "stg_eltool__state__dbt_backup"
[0m19:15:02.462003 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:15:02.466015 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__state"
[0m19:15:02.466015 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__state: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__state"} */
alter table "IDX-Stock"."IDX-Schema"."stg_eltool__state__dbt_tmp" rename to "stg_eltool__state"
[0m19:15:02.468471 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:15:02.471011 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__state: COMMIT
[0m19:15:02.472019 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__state"
[0m19:15:02.472019 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__state: COMMIT
[0m19:15:02.475628 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m19:15:02.478651 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__state"
[0m19:15:02.479669 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__state: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__state"} */
drop view if exists "IDX-Stock"."IDX-Schema"."stg_eltool__state__dbt_backup" cascade
[0m19:15:02.483626 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m19:15:02.484626 [debug] [Thread-1 (]: Timing info for model.dbt_idx.stg_eltool__state (execute): 19:15:02.414872 => 19:15:02.484626
[0m19:15:02.485624 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__state: Close
[0m19:15:02.487637 [info ] [Thread-1 (]: 5 of 10 OK created sql view model IDX-Schema.stg_eltool__state ................. [[32mCREATE VIEW[0m in 0.08s]
[0m19:15:02.489636 [debug] [Thread-1 (]: Finished running node model.dbt_idx.stg_eltool__state
[0m19:15:02.490634 [debug] [Thread-1 (]: Began running node model.dbt_idx.stg_eltool__stock
[0m19:15:02.492630 [info ] [Thread-1 (]: 6 of 10 START sql view model IDX-Schema.stg_eltool__stock ...................... [RUN]
[0m19:15:02.494629 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_idx.stg_eltool__state, now model.dbt_idx.stg_eltool__stock)
[0m19:15:02.495631 [debug] [Thread-1 (]: Began compiling node model.dbt_idx.stg_eltool__stock
[0m19:15:02.500645 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_idx.stg_eltool__stock"
[0m19:15:02.506654 [debug] [Thread-1 (]: Timing info for model.dbt_idx.stg_eltool__stock (compile): 19:15:02.496658 => 19:15:02.506654
[0m19:15:02.507625 [debug] [Thread-1 (]: Began executing node model.dbt_idx.stg_eltool__stock
[0m19:15:02.513653 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_idx.stg_eltool__stock"
[0m19:15:02.519627 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__stock"
[0m19:15:02.520637 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__stock: BEGIN
[0m19:15:02.520637 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:15:02.543322 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m19:15:02.544333 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__stock"
[0m19:15:02.544333 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__stock: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__stock"} */

  create view "IDX-Stock"."IDX-Schema"."stg_eltool__stock__dbt_tmp"
    
    
  as (
    with source as (select *
                from "IDX-Stock"."IDX-Schema"."ksql-stock-stream"),
     renamed as (select *
                 from source)
select *
from renamed
  );
[0m19:15:02.548335 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m19:15:02.551376 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__stock"
[0m19:15:02.552367 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__stock: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__stock"} */
alter table "IDX-Stock"."IDX-Schema"."stg_eltool__stock" rename to "stg_eltool__stock__dbt_backup"
[0m19:15:02.554370 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:15:02.557410 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__stock"
[0m19:15:02.558412 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__stock: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__stock"} */
alter table "IDX-Stock"."IDX-Schema"."stg_eltool__stock__dbt_tmp" rename to "stg_eltool__stock"
[0m19:15:02.560375 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:15:02.563404 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__stock: COMMIT
[0m19:15:02.564374 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__stock"
[0m19:15:02.564374 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__stock: COMMIT
[0m19:15:02.568366 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m19:15:02.571378 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__stock"
[0m19:15:02.571883 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__stock: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__stock"} */
drop view if exists "IDX-Stock"."IDX-Schema"."stg_eltool__stock__dbt_backup" cascade
[0m19:15:02.575888 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m19:15:02.577918 [debug] [Thread-1 (]: Timing info for model.dbt_idx.stg_eltool__stock (execute): 19:15:02.508667 => 19:15:02.577918
[0m19:15:02.578921 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__stock: Close
[0m19:15:02.580913 [info ] [Thread-1 (]: 6 of 10 OK created sql view model IDX-Schema.stg_eltool__stock ................. [[32mCREATE VIEW[0m in 0.09s]
[0m19:15:02.581899 [debug] [Thread-1 (]: Finished running node model.dbt_idx.stg_eltool__stock
[0m19:15:02.583900 [debug] [Thread-1 (]: Began running node model.dbt_idx.fact_orders
[0m19:15:02.584907 [info ] [Thread-1 (]: 7 of 10 START sql table model IDX-Schema.fact_orders ........................... [RUN]
[0m19:15:02.585902 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_idx.stg_eltool__stock, now model.dbt_idx.fact_orders)
[0m19:15:02.586896 [debug] [Thread-1 (]: Began compiling node model.dbt_idx.fact_orders
[0m19:15:02.589928 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_idx.fact_orders"
[0m19:15:02.596201 [debug] [Thread-1 (]: Timing info for model.dbt_idx.fact_orders (compile): 19:15:02.586896 => 19:15:02.596201
[0m19:15:02.597211 [debug] [Thread-1 (]: Began executing node model.dbt_idx.fact_orders
[0m19:15:02.619228 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_idx.fact_orders"
[0m19:15:02.626280 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.fact_orders"
[0m19:15:02.626280 [debug] [Thread-1 (]: On model.dbt_idx.fact_orders: BEGIN
[0m19:15:02.627317 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:15:02.649286 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m19:15:02.650293 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.fact_orders"
[0m19:15:02.650293 [debug] [Thread-1 (]: On model.dbt_idx.fact_orders: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.fact_orders"} */

  
    

  create  table "IDX-Stock"."IDX-Schema"."fact_orders__dbt_tmp"
  
  
    as
  
  (
    with orders as (
    select *
    from "IDX-Stock"."IDX-Schema"."stg_eltool__orders"
)
select * from orders
  );
  
[0m19:15:02.658032 [debug] [Thread-1 (]: SQL status: SELECT 999 in 0.0 seconds
[0m19:15:02.661345 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.fact_orders"
[0m19:15:02.662349 [debug] [Thread-1 (]: On model.dbt_idx.fact_orders: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.fact_orders"} */
alter table "IDX-Stock"."IDX-Schema"."fact_orders" rename to "fact_orders__dbt_backup"
[0m19:15:02.664311 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:15:02.667348 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.fact_orders"
[0m19:15:02.668323 [debug] [Thread-1 (]: On model.dbt_idx.fact_orders: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.fact_orders"} */
alter table "IDX-Stock"."IDX-Schema"."fact_orders__dbt_tmp" rename to "fact_orders"
[0m19:15:02.670317 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:15:02.675769 [debug] [Thread-1 (]: On model.dbt_idx.fact_orders: COMMIT
[0m19:15:02.676771 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.fact_orders"
[0m19:15:02.677738 [debug] [Thread-1 (]: On model.dbt_idx.fact_orders: COMMIT
[0m19:15:02.680777 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m19:15:02.685824 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.fact_orders"
[0m19:15:02.686819 [debug] [Thread-1 (]: On model.dbt_idx.fact_orders: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.fact_orders"} */
drop table if exists "IDX-Stock"."IDX-Schema"."fact_orders__dbt_backup" cascade
[0m19:15:02.690816 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m19:15:02.692815 [debug] [Thread-1 (]: Timing info for model.dbt_idx.fact_orders (execute): 19:15:02.598217 => 19:15:02.692815
[0m19:15:02.693814 [debug] [Thread-1 (]: On model.dbt_idx.fact_orders: Close
[0m19:15:02.695822 [info ] [Thread-1 (]: 7 of 10 OK created sql table model IDX-Schema.fact_orders ...................... [[32mSELECT 999[0m in 0.11s]
[0m19:15:02.697819 [debug] [Thread-1 (]: Finished running node model.dbt_idx.fact_orders
[0m19:15:02.698816 [debug] [Thread-1 (]: Began running node model.dbt_idx.dim_customers
[0m19:15:02.699816 [info ] [Thread-1 (]: 8 of 10 START sql table model IDX-Schema.dim_customers ......................... [RUN]
[0m19:15:02.701817 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_idx.fact_orders, now model.dbt_idx.dim_customers)
[0m19:15:02.701817 [debug] [Thread-1 (]: Began compiling node model.dbt_idx.dim_customers
[0m19:15:02.705814 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_idx.dim_customers"
[0m19:15:02.713817 [debug] [Thread-1 (]: Timing info for model.dbt_idx.dim_customers (compile): 19:15:02.702815 => 19:15:02.712817
[0m19:15:02.713817 [debug] [Thread-1 (]: Began executing node model.dbt_idx.dim_customers
[0m19:15:02.719817 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_idx.dim_customers"
[0m19:15:02.725818 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.dim_customers"
[0m19:15:02.726816 [debug] [Thread-1 (]: On model.dbt_idx.dim_customers: BEGIN
[0m19:15:02.726816 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:15:02.748509 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m19:15:02.749491 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.dim_customers"
[0m19:15:02.750493 [debug] [Thread-1 (]: On model.dbt_idx.dim_customers: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.dim_customers"} */

  
    

  create  table "IDX-Stock"."IDX-Schema"."dim_customers__dbt_tmp"
  
  
    as
  
  (
    -- noinspection SqlDialectInspectionForFile

with customers as (
    select *
    from "IDX-Stock"."IDX-Schema"."stg_eltool__customers_snapshots"
    ),
     state as (
         select *
         from "IDX-Stock"."IDX-Schema"."stg_eltool__state"
     )
select c.customer_id,
       c.zipcode,
       c.city,
       c.state_code,
       s.state_name,
       c.datetime_created,
       c.datetime_updated,
       c.dbt_valid_from::TIMESTAMP as valid_from,
        CASE WHEN c.dbt_valid_to IS NULL
            THEN '9999-12-31'::TIMESTAMP
            ELSE c.dbt_valid_to::TIMESTAMP
        END as valid_to
from customers c
    join state s on c.state_code = s.state_code
  );
  
[0m19:15:02.755330 [debug] [Thread-1 (]: SQL status: SELECT 100 in 0.0 seconds
[0m19:15:02.759441 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.dim_customers"
[0m19:15:02.760408 [debug] [Thread-1 (]: On model.dbt_idx.dim_customers: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.dim_customers"} */
alter table "IDX-Stock"."IDX-Schema"."dim_customers" rename to "dim_customers__dbt_backup"
[0m19:15:02.762411 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:15:02.768604 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.dim_customers"
[0m19:15:02.769453 [debug] [Thread-1 (]: On model.dbt_idx.dim_customers: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.dim_customers"} */
alter table "IDX-Stock"."IDX-Schema"."dim_customers__dbt_tmp" rename to "dim_customers"
[0m19:15:02.771345 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:15:02.812219 [debug] [Thread-1 (]: On model.dbt_idx.dim_customers: COMMIT
[0m19:15:02.813209 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.dim_customers"
[0m19:15:02.814186 [debug] [Thread-1 (]: On model.dbt_idx.dim_customers: COMMIT
[0m19:15:02.817721 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m19:15:02.821736 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.dim_customers"
[0m19:15:02.822710 [debug] [Thread-1 (]: On model.dbt_idx.dim_customers: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.dim_customers"} */
drop table if exists "IDX-Stock"."IDX-Schema"."dim_customers__dbt_backup" cascade
[0m19:15:02.828288 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m19:15:02.832282 [debug] [Thread-1 (]: Timing info for model.dbt_idx.dim_customers (execute): 19:15:02.714816 => 19:15:02.831278
[0m19:15:02.833273 [debug] [Thread-1 (]: On model.dbt_idx.dim_customers: Close
[0m19:15:02.835278 [info ] [Thread-1 (]: 8 of 10 OK created sql table model IDX-Schema.dim_customers .................... [[32mSELECT 100[0m in 0.13s]
[0m19:15:02.838274 [debug] [Thread-1 (]: Finished running node model.dbt_idx.dim_customers
[0m19:15:02.839299 [debug] [Thread-1 (]: Began running node model.dbt_idx.dim_stocks
[0m19:15:02.840276 [info ] [Thread-1 (]: 9 of 10 START sql table model IDX-Schema.dim_stocks ............................ [RUN]
[0m19:15:02.842811 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_idx.dim_customers, now model.dbt_idx.dim_stocks)
[0m19:15:02.844832 [debug] [Thread-1 (]: Began compiling node model.dbt_idx.dim_stocks
[0m19:15:02.851811 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_idx.dim_stocks"
[0m19:15:02.862958 [debug] [Thread-1 (]: Timing info for model.dbt_idx.dim_stocks (compile): 19:15:02.845823 => 19:15:02.861333
[0m19:15:02.863329 [debug] [Thread-1 (]: Began executing node model.dbt_idx.dim_stocks
[0m19:15:02.874472 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_idx.dim_stocks"
[0m19:15:02.881577 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.dim_stocks"
[0m19:15:02.883090 [debug] [Thread-1 (]: On model.dbt_idx.dim_stocks: BEGIN
[0m19:15:02.884115 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:15:02.909583 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m19:15:02.910123 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.dim_stocks"
[0m19:15:02.911175 [debug] [Thread-1 (]: On model.dbt_idx.dim_stocks: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.dim_stocks"} */

  
    

  create  table "IDX-Stock"."IDX-Schema"."dim_stocks__dbt_tmp"
  
  
    as
  
  (
    -- noinspection SqlDialectInspectionForFile

with stock as (
    select *
    from "IDX-Stock"."IDX-Schema"."stg_eltool__stock"
    ),
     company as (
         select *
         from "IDX-Stock"."IDX-Schema"."stg_eltool__company"
     )
select a.id,
       a.ticker,
       b.name,
       a.date,
       a.open,
       a.high,
       a.low,
       a.close,
       a.colume,
       b.logo,
from stock a
    join company b on a.id = b.id
  );
  
[0m19:15:02.914130 [debug] [Thread-1 (]: Postgres adapter: Postgres error: syntax error at or near "from"
LINE 32: from stock a
         ^

[0m19:15:02.915149 [debug] [Thread-1 (]: On model.dbt_idx.dim_stocks: ROLLBACK
[0m19:15:02.918212 [debug] [Thread-1 (]: Timing info for model.dbt_idx.dim_stocks (execute): 19:15:02.864347 => 19:15:02.918212
[0m19:15:02.919801 [debug] [Thread-1 (]: On model.dbt_idx.dim_stocks: Close
[0m19:15:02.936303 [debug] [Thread-1 (]: Database Error in model dim_stocks (models\marts\core\dim_stocks.sql)
  syntax error at or near "from"
  LINE 32: from stock a
           ^
  compiled Code at target\run\dbt_idx\models\marts\core\dim_stocks.sql
[0m19:15:02.937305 [error] [Thread-1 (]: 9 of 10 ERROR creating sql table model IDX-Schema.dim_stocks ................... [[31mERROR[0m in 0.10s]
[0m19:15:02.938829 [debug] [Thread-1 (]: Finished running node model.dbt_idx.dim_stocks
[0m19:15:02.940836 [debug] [Thread-1 (]: Began running node model.dbt_idx.customer_orders_status
[0m19:15:02.942343 [info ] [Thread-1 (]: 10 of 10 START sql view model IDX-Schema.customer_orders_status ................ [RUN]
[0m19:15:02.944355 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_idx.dim_stocks, now model.dbt_idx.customer_orders_status)
[0m19:15:02.945370 [debug] [Thread-1 (]: Began compiling node model.dbt_idx.customer_orders_status
[0m19:15:02.950378 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_idx.customer_orders_status"
[0m19:15:02.958862 [debug] [Thread-1 (]: Timing info for model.dbt_idx.customer_orders_status (compile): 19:15:02.945370 => 19:15:02.958862
[0m19:15:02.960866 [debug] [Thread-1 (]: Began executing node model.dbt_idx.customer_orders_status
[0m19:15:02.966301 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_idx.customer_orders_status"
[0m19:15:02.974831 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.customer_orders_status"
[0m19:15:02.975856 [debug] [Thread-1 (]: On model.dbt_idx.customer_orders_status: BEGIN
[0m19:15:02.977385 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:15:03.004486 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m19:15:03.005488 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.customer_orders_status"
[0m19:15:03.006487 [debug] [Thread-1 (]: On model.dbt_idx.customer_orders_status: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.customer_orders_status"} */

  create view "IDX-Stock"."IDX-Schema"."customer_orders_status__dbt_tmp"
    
    
  as (
    with orders as (select *
                from "IDX-Stock"."IDX-Schema"."fact_orders"),
     customers as (select *
                   from "IDX-Stock"."IDX-Schema"."dim_customers")
select o.order_id,
       o.customer_id,
       o.order_status,
       o.order_purchase_timestamp,
       o.order_approved_at,
       o.order_delivered_carrier_date,
       o.order_delivered_customer_date,
       o.order_estimated_delivery_date,
       c.zipcode    as customer_zipcode,
       c.city       as customer_city,
       c.state_code as customer_state_code,
       c.state_name as customer_state_name
from orders o
    join customers c on o.customer_id = c.customer_id
    and o.order_purchase_timestamp >= c.valid_from
    and o.order_purchase_timestamp <= c.valid_to
  );
[0m19:15:03.013054 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m19:15:03.017359 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.customer_orders_status"
[0m19:15:03.018354 [debug] [Thread-1 (]: On model.dbt_idx.customer_orders_status: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.customer_orders_status"} */
alter table "IDX-Stock"."IDX-Schema"."customer_orders_status__dbt_tmp" rename to "customer_orders_status"
[0m19:15:03.021889 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:15:03.023921 [debug] [Thread-1 (]: On model.dbt_idx.customer_orders_status: COMMIT
[0m19:15:03.024889 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.customer_orders_status"
[0m19:15:03.025928 [debug] [Thread-1 (]: On model.dbt_idx.customer_orders_status: COMMIT
[0m19:15:03.029889 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m19:15:03.033908 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.customer_orders_status"
[0m19:15:03.033908 [debug] [Thread-1 (]: On model.dbt_idx.customer_orders_status: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.customer_orders_status"} */
drop view if exists "IDX-Stock"."IDX-Schema"."customer_orders_status__dbt_backup" cascade
[0m19:15:03.035885 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m19:15:03.037920 [debug] [Thread-1 (]: Timing info for model.dbt_idx.customer_orders_status (execute): 19:15:02.961883 => 19:15:03.037920
[0m19:15:03.038910 [debug] [Thread-1 (]: On model.dbt_idx.customer_orders_status: Close
[0m19:15:03.040904 [info ] [Thread-1 (]: 10 of 10 OK created sql view model IDX-Schema.customer_orders_status ........... [[32mCREATE VIEW[0m in 0.10s]
[0m19:15:03.042920 [debug] [Thread-1 (]: Finished running node model.dbt_idx.customer_orders_status
[0m19:15:03.044920 [debug] [MainThread]: Using postgres connection "master"
[0m19:15:03.045896 [debug] [MainThread]: On master: BEGIN
[0m19:15:03.045896 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m19:15:03.068196 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m19:15:03.069195 [debug] [MainThread]: On master: COMMIT
[0m19:15:03.069195 [debug] [MainThread]: Using postgres connection "master"
[0m19:15:03.070209 [debug] [MainThread]: On master: COMMIT
[0m19:15:03.071717 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m19:15:03.072722 [debug] [MainThread]: On master: Close
[0m19:15:03.073722 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:15:03.075724 [debug] [MainThread]: Connection 'list_IDX-Stock' was properly closed.
[0m19:15:03.075724 [debug] [MainThread]: Connection 'list_IDX-Stock_IDX-Schema' was properly closed.
[0m19:15:03.076737 [debug] [MainThread]: Connection 'model.dbt_idx.customer_orders_status' was properly closed.
[0m19:15:03.078723 [info ] [MainThread]: 
[0m19:15:03.079728 [info ] [MainThread]: Finished running 7 view models, 3 table models in 0 hours 0 minutes and 1.36 seconds (1.36s).
[0m19:15:03.082722 [debug] [MainThread]: Command end result
[0m19:15:03.105594 [info ] [MainThread]: 
[0m19:15:03.107563 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m19:15:03.108564 [info ] [MainThread]: 
[0m19:15:03.109575 [error] [MainThread]: [33mDatabase Error in model dim_stocks (models\marts\core\dim_stocks.sql)[0m
[0m19:15:03.110604 [error] [MainThread]:   syntax error at or near "from"
[0m19:15:03.111596 [error] [MainThread]:   LINE 32: from stock a
[0m19:15:03.112596 [error] [MainThread]:            ^
[0m19:15:03.113609 [error] [MainThread]:   compiled Code at target\run\dbt_idx\models\marts\core\dim_stocks.sql
[0m19:15:03.115566 [info ] [MainThread]: 
[0m19:15:03.116596 [info ] [MainThread]: Done. PASS=9 WARN=0 ERROR=1 SKIP=0 TOTAL=10
[0m19:15:03.118564 [debug] [MainThread]: Command `dbt run` failed at 19:15:03.118564 after 1.92 seconds
[0m19:15:03.119571 [debug] [MainThread]: Flushing usage events


============================== 19:15:21.776705 | 2289c47b-292c-4687-9197-187010fe4911 ==============================
[0m19:15:21.776705 [info ] [MainThread]: Running with dbt=1.6.1
[0m19:15:21.783221 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'D:\\00 Project\\00 My Project\\IdeaProjects\\Py-DBT-IDX\\logs', 'debug': 'False', 'profiles_dir': 'D:\\00 Project\\00 My Project\\IdeaProjects\\Py-DBT-IDX', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'False'}
[0m19:15:21.962791 [info ] [MainThread]: Registered adapter: postgres=1.6.1
[0m19:15:21.972786 [debug] [MainThread]: checksum: efe19d9f5b93d1a98cc804fbfcdb6b3aced98b974af664946fee1cde8837deb7, vars: {}, profile: , target: , version: 1.6.1
[0m19:15:22.134101 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m19:15:22.135101 [debug] [MainThread]: Partial parsing: updated file: dbt_idx://models\marts\core\dim_stocks.sql
[0m19:15:22.236664 [info ] [MainThread]: Found 10 models, 1 snapshot, 17 tests, 5 sources, 0 exposures, 0 metrics, 349 macros, 0 groups, 0 semantic models
[0m19:15:22.239335 [info ] [MainThread]: 
[0m19:15:22.240304 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m19:15:22.243292 [debug] [ThreadPool]: Acquiring new postgres connection 'list_IDX-Stock'
[0m19:15:22.254309 [debug] [ThreadPool]: Using postgres connection "list_IDX-Stock"
[0m19:15:22.255293 [debug] [ThreadPool]: On list_IDX-Stock: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "connection_name": "list_IDX-Stock"} */

    select distinct nspname from pg_namespace
  
[0m19:15:22.256294 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:15:22.291098 [debug] [ThreadPool]: SQL status: SELECT 12 in 0.0 seconds
[0m19:15:22.293117 [debug] [ThreadPool]: On list_IDX-Stock: Close
[0m19:15:22.296662 [debug] [ThreadPool]: Acquiring new postgres connection 'list_IDX-Stock_snapshots'
[0m19:15:22.303653 [debug] [ThreadPool]: Using postgres connection "list_IDX-Stock_snapshots"
[0m19:15:22.304654 [debug] [ThreadPool]: On list_IDX-Stock_snapshots: BEGIN
[0m19:15:22.305654 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:15:22.326023 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m19:15:22.326988 [debug] [ThreadPool]: Using postgres connection "list_IDX-Stock_snapshots"
[0m19:15:22.327988 [debug] [ThreadPool]: On list_IDX-Stock_snapshots: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "connection_name": "list_IDX-Stock_snapshots"} */
select
      'IDX-Stock' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'snapshots'
    union all
    select
      'IDX-Stock' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'snapshots'
    union all
    select
      'IDX-Stock' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'snapshots'
  
[0m19:15:22.331919 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.0 seconds
[0m19:15:22.333965 [debug] [ThreadPool]: On list_IDX-Stock_snapshots: ROLLBACK
[0m19:15:22.335966 [debug] [ThreadPool]: On list_IDX-Stock_snapshots: Close
[0m19:15:22.337939 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_IDX-Stock_snapshots, now list_IDX-Stock_IDX-Schema)
[0m19:15:22.341965 [debug] [ThreadPool]: Using postgres connection "list_IDX-Stock_IDX-Schema"
[0m19:15:22.341965 [debug] [ThreadPool]: On list_IDX-Stock_IDX-Schema: BEGIN
[0m19:15:22.342936 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:15:22.363553 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m19:15:22.364554 [debug] [ThreadPool]: Using postgres connection "list_IDX-Stock_IDX-Schema"
[0m19:15:22.365581 [debug] [ThreadPool]: On list_IDX-Stock_IDX-Schema: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "connection_name": "list_IDX-Stock_IDX-Schema"} */
select
      'IDX-Stock' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'IDX-Schema'
    union all
    select
      'IDX-Stock' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'IDX-Schema'
    union all
    select
      'IDX-Stock' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'IDX-Schema'
  
[0m19:15:22.369558 [debug] [ThreadPool]: SQL status: SELECT 15 in 0.0 seconds
[0m19:15:22.371583 [debug] [ThreadPool]: On list_IDX-Stock_IDX-Schema: ROLLBACK
[0m19:15:22.373577 [debug] [ThreadPool]: On list_IDX-Stock_IDX-Schema: Close
[0m19:15:22.383606 [debug] [MainThread]: Using postgres connection "master"
[0m19:15:22.383606 [debug] [MainThread]: On master: BEGIN
[0m19:15:22.384586 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:15:22.405198 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m19:15:22.405198 [debug] [MainThread]: Using postgres connection "master"
[0m19:15:22.406235 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m19:15:22.413242 [debug] [MainThread]: SQL status: SELECT 8 in 0.0 seconds
[0m19:15:22.416232 [debug] [MainThread]: On master: ROLLBACK
[0m19:15:22.418198 [debug] [MainThread]: Using postgres connection "master"
[0m19:15:22.419232 [debug] [MainThread]: On master: BEGIN
[0m19:15:22.422203 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m19:15:22.423224 [debug] [MainThread]: On master: COMMIT
[0m19:15:22.424206 [debug] [MainThread]: Using postgres connection "master"
[0m19:15:22.424206 [debug] [MainThread]: On master: COMMIT
[0m19:15:22.426197 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m19:15:22.427216 [debug] [MainThread]: On master: Close
[0m19:15:22.428198 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m19:15:22.430198 [info ] [MainThread]: 
[0m19:15:22.435378 [debug] [Thread-1 (]: Began running node model.dbt_idx.stg_eltool__company
[0m19:15:22.435378 [info ] [Thread-1 (]: 1 of 10 START sql view model IDX-Schema.stg_eltool__company .................... [RUN]
[0m19:15:22.437417 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.dbt_idx.stg_eltool__company'
[0m19:15:22.438378 [debug] [Thread-1 (]: Began compiling node model.dbt_idx.stg_eltool__company
[0m19:15:22.445414 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_idx.stg_eltool__company"
[0m19:15:22.451187 [debug] [Thread-1 (]: Timing info for model.dbt_idx.stg_eltool__company (compile): 19:15:22.438378 => 19:15:22.451187
[0m19:15:22.452222 [debug] [Thread-1 (]: Began executing node model.dbt_idx.stg_eltool__company
[0m19:15:22.491270 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_idx.stg_eltool__company"
[0m19:15:22.498315 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__company"
[0m19:15:22.499319 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__company: BEGIN
[0m19:15:22.500328 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m19:15:22.522739 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m19:15:22.523738 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__company"
[0m19:15:22.524755 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__company: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__company"} */

  create view "IDX-Stock"."IDX-Schema"."stg_eltool__company__dbt_tmp"
    
    
  as (
    with source as (select *
                from "IDX-Stock"."IDX-Schema"."ksql-company-stream"),
     renamed as (select id,
                        ticker,
                        name,
                        logo
                 from source)
select *
from renamed
  );
[0m19:15:22.527738 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m19:15:22.534737 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__company"
[0m19:15:22.535741 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__company: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__company"} */
alter table "IDX-Stock"."IDX-Schema"."stg_eltool__company" rename to "stg_eltool__company__dbt_backup"
[0m19:15:22.537629 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:15:22.541674 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__company"
[0m19:15:22.541674 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__company: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__company"} */
alter table "IDX-Stock"."IDX-Schema"."stg_eltool__company__dbt_tmp" rename to "stg_eltool__company"
[0m19:15:22.544340 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:15:22.561374 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__company: COMMIT
[0m19:15:22.562372 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__company"
[0m19:15:22.563337 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__company: COMMIT
[0m19:15:22.567351 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m19:15:22.577337 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__company"
[0m19:15:22.578336 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__company: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__company"} */
drop view if exists "IDX-Stock"."IDX-Schema"."stg_eltool__company__dbt_backup" cascade
[0m19:15:22.582078 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m19:15:22.584123 [debug] [Thread-1 (]: Timing info for model.dbt_idx.stg_eltool__company (execute): 19:15:22.453226 => 19:15:22.584123
[0m19:15:22.585126 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__company: Close
[0m19:15:22.587094 [info ] [Thread-1 (]: 1 of 10 OK created sql view model IDX-Schema.stg_eltool__company ............... [[32mCREATE VIEW[0m in 0.15s]
[0m19:15:22.589091 [debug] [Thread-1 (]: Finished running node model.dbt_idx.stg_eltool__company
[0m19:15:22.590101 [debug] [Thread-1 (]: Began running node model.dbt_idx.stg_eltool__customers
[0m19:15:22.591132 [info ] [Thread-1 (]: 2 of 10 START sql view model IDX-Schema.stg_eltool__customers .................. [RUN]
[0m19:15:22.592121 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_idx.stg_eltool__company, now model.dbt_idx.stg_eltool__customers)
[0m19:15:22.593089 [debug] [Thread-1 (]: Began compiling node model.dbt_idx.stg_eltool__customers
[0m19:15:22.597352 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_idx.stg_eltool__customers"
[0m19:15:22.602308 [debug] [Thread-1 (]: Timing info for model.dbt_idx.stg_eltool__customers (compile): 19:15:22.594305 => 19:15:22.602308
[0m19:15:22.603339 [debug] [Thread-1 (]: Began executing node model.dbt_idx.stg_eltool__customers
[0m19:15:22.608339 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_idx.stg_eltool__customers"
[0m19:15:22.614304 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__customers"
[0m19:15:22.615306 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__customers: BEGIN
[0m19:15:22.616302 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:15:22.636849 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m19:15:22.637873 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__customers"
[0m19:15:22.638847 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__customers: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__customers"} */

  create view "IDX-Stock"."IDX-Schema"."stg_eltool__customers__dbt_tmp"
    
    
  as (
    with source as (select *
                from "IDX-Stock"."IDX-Schema"."customers"),
     renamed as (select
                     customer_id,
                    'This is Dummy' as dummy
                 from source
                 where customer_id = 1234567890)
select *
from renamed
  );
[0m19:15:22.641837 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m19:15:22.645867 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__customers"
[0m19:15:22.646837 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__customers: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__customers"} */
alter table "IDX-Stock"."IDX-Schema"."stg_eltool__customers" rename to "stg_eltool__customers__dbt_backup"
[0m19:15:22.649836 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:15:22.652836 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__customers"
[0m19:15:22.652836 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__customers: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__customers"} */
alter table "IDX-Stock"."IDX-Schema"."stg_eltool__customers__dbt_tmp" rename to "stg_eltool__customers"
[0m19:15:22.655843 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:15:22.657859 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__customers: COMMIT
[0m19:15:22.658871 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__customers"
[0m19:15:22.659869 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__customers: COMMIT
[0m19:15:22.663994 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m19:15:22.666993 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__customers"
[0m19:15:22.667995 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__customers: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__customers"} */
drop view if exists "IDX-Stock"."IDX-Schema"."stg_eltool__customers__dbt_backup" cascade
[0m19:15:22.671968 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m19:15:22.674994 [debug] [Thread-1 (]: Timing info for model.dbt_idx.stg_eltool__customers (execute): 19:15:22.604327 => 19:15:22.673975
[0m19:15:22.674994 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__customers: Close
[0m19:15:22.676972 [info ] [Thread-1 (]: 2 of 10 OK created sql view model IDX-Schema.stg_eltool__customers ............. [[32mCREATE VIEW[0m in 0.08s]
[0m19:15:22.679983 [debug] [Thread-1 (]: Finished running node model.dbt_idx.stg_eltool__customers
[0m19:15:22.680980 [debug] [Thread-1 (]: Began running node model.dbt_idx.stg_eltool__customers_snapshots
[0m19:15:22.681981 [info ] [Thread-1 (]: 3 of 10 START sql view model IDX-Schema.stg_eltool__customers_snapshots ........ [RUN]
[0m19:15:22.683977 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_idx.stg_eltool__customers, now model.dbt_idx.stg_eltool__customers_snapshots)
[0m19:15:22.684979 [debug] [Thread-1 (]: Began compiling node model.dbt_idx.stg_eltool__customers_snapshots
[0m19:15:22.688979 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_idx.stg_eltool__customers_snapshots"
[0m19:15:22.695308 [debug] [Thread-1 (]: Timing info for model.dbt_idx.stg_eltool__customers_snapshots (compile): 19:15:22.684979 => 19:15:22.694338
[0m19:15:22.696332 [debug] [Thread-1 (]: Began executing node model.dbt_idx.stg_eltool__customers_snapshots
[0m19:15:22.703344 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_idx.stg_eltool__customers_snapshots"
[0m19:15:22.708359 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__customers_snapshots"
[0m19:15:22.709375 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__customers_snapshots: BEGIN
[0m19:15:22.710360 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:15:22.730803 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m19:15:22.731839 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__customers_snapshots"
[0m19:15:22.732815 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__customers_snapshots: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__customers_snapshots"} */

  create view "IDX-Stock"."IDX-Schema"."stg_eltool__customers_snapshots__dbt_tmp"
    
    
  as (
    with source as (select *
                from "IDX-Stock"."snapshots"."customers_snapshot"),
     renamed as (select customer_id,
                        zipcode,
                        city,
                        state_code,
                        datetime_created::TIMESTAMP AS datetime_created,
                        datetime_updated::TIMESTAMP AS datetime_updated,
                        dbt_valid_from,
                        dbt_valid_to
                 from source)
select *
from renamed
  );
[0m19:15:22.736822 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m19:15:22.740829 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__customers_snapshots"
[0m19:15:22.741839 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__customers_snapshots: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__customers_snapshots"} */
alter table "IDX-Stock"."IDX-Schema"."stg_eltool__customers_snapshots" rename to "stg_eltool__customers_snapshots__dbt_backup"
[0m19:15:22.743833 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:15:22.747835 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__customers_snapshots"
[0m19:15:22.747835 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__customers_snapshots: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__customers_snapshots"} */
alter table "IDX-Stock"."IDX-Schema"."stg_eltool__customers_snapshots__dbt_tmp" rename to "stg_eltool__customers_snapshots"
[0m19:15:22.750805 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:15:22.753796 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__customers_snapshots: COMMIT
[0m19:15:22.753796 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__customers_snapshots"
[0m19:15:22.754796 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__customers_snapshots: COMMIT
[0m19:15:22.758618 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m19:15:22.762618 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__customers_snapshots"
[0m19:15:22.762618 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__customers_snapshots: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__customers_snapshots"} */
drop view if exists "IDX-Stock"."IDX-Schema"."stg_eltool__customers_snapshots__dbt_backup" cascade
[0m19:15:22.766618 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m19:15:22.768657 [debug] [Thread-1 (]: Timing info for model.dbt_idx.stg_eltool__customers_snapshots (execute): 19:15:22.696332 => 19:15:22.768657
[0m19:15:22.769650 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__customers_snapshots: Close
[0m19:15:22.771623 [info ] [Thread-1 (]: 3 of 10 OK created sql view model IDX-Schema.stg_eltool__customers_snapshots ... [[32mCREATE VIEW[0m in 0.09s]
[0m19:15:22.773620 [debug] [Thread-1 (]: Finished running node model.dbt_idx.stg_eltool__customers_snapshots
[0m19:15:22.774625 [debug] [Thread-1 (]: Began running node model.dbt_idx.stg_eltool__orders
[0m19:15:22.775623 [info ] [Thread-1 (]: 4 of 10 START sql view model IDX-Schema.stg_eltool__orders ..................... [RUN]
[0m19:15:22.776620 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_idx.stg_eltool__customers_snapshots, now model.dbt_idx.stg_eltool__orders)
[0m19:15:22.777622 [debug] [Thread-1 (]: Began compiling node model.dbt_idx.stg_eltool__orders
[0m19:15:22.780628 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_idx.stg_eltool__orders"
[0m19:15:22.791664 [debug] [Thread-1 (]: Timing info for model.dbt_idx.stg_eltool__orders (compile): 19:15:22.777622 => 19:15:22.791664
[0m19:15:22.793174 [debug] [Thread-1 (]: Began executing node model.dbt_idx.stg_eltool__orders
[0m19:15:22.798206 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_idx.stg_eltool__orders"
[0m19:15:22.807199 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__orders"
[0m19:15:22.808199 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__orders: BEGIN
[0m19:15:22.809200 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:15:22.830961 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m19:15:22.831966 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__orders"
[0m19:15:22.831966 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__orders: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__orders"} */

  create view "IDX-Stock"."IDX-Schema"."stg_eltool__orders__dbt_tmp"
    
    
  as (
    with source as (select *
                from "IDX-Stock"."IDX-Schema"."orders"),
     renamed as (select order_id,
                        cust_id AS customer_id,
                        order_status,
                        order_purchase_timestamp::TIMESTAMP,
                        order_approved_at::TIMESTAMP,
                        order_delivered_carrier_date::TIMESTAMP,
                        order_delivered_customer_date::TIMESTAMP,
                        order_estimated_delivery_date::TIMESTAMP
                 from source)
select *
from renamed
  );
[0m19:15:22.835668 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m19:15:22.839702 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__orders"
[0m19:15:22.840667 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__orders: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__orders"} */
alter table "IDX-Stock"."IDX-Schema"."stg_eltool__orders" rename to "stg_eltool__orders__dbt_backup"
[0m19:15:22.842934 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:15:22.846982 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__orders"
[0m19:15:22.846982 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__orders: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__orders"} */
alter table "IDX-Stock"."IDX-Schema"."stg_eltool__orders__dbt_tmp" rename to "stg_eltool__orders"
[0m19:15:22.849953 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:15:22.851984 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__orders: COMMIT
[0m19:15:22.852947 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__orders"
[0m19:15:22.853970 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__orders: COMMIT
[0m19:15:22.856889 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m19:15:22.860923 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__orders"
[0m19:15:22.861908 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__orders: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__orders"} */
drop view if exists "IDX-Stock"."IDX-Schema"."stg_eltool__orders__dbt_backup" cascade
[0m19:15:22.865887 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m19:15:22.867887 [debug] [Thread-1 (]: Timing info for model.dbt_idx.stg_eltool__orders (execute): 19:15:22.793174 => 19:15:22.866888
[0m19:15:22.867887 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__orders: Close
[0m19:15:22.869896 [info ] [Thread-1 (]: 4 of 10 OK created sql view model IDX-Schema.stg_eltool__orders ................ [[32mCREATE VIEW[0m in 0.09s]
[0m19:15:22.871891 [debug] [Thread-1 (]: Finished running node model.dbt_idx.stg_eltool__orders
[0m19:15:22.872896 [debug] [Thread-1 (]: Began running node model.dbt_idx.stg_eltool__state
[0m19:15:22.873891 [info ] [Thread-1 (]: 5 of 10 START sql view model IDX-Schema.stg_eltool__state ...................... [RUN]
[0m19:15:22.874912 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_idx.stg_eltool__orders, now model.dbt_idx.stg_eltool__state)
[0m19:15:22.875887 [debug] [Thread-1 (]: Began compiling node model.dbt_idx.stg_eltool__state
[0m19:15:22.880905 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_idx.stg_eltool__state"
[0m19:15:22.886931 [debug] [Thread-1 (]: Timing info for model.dbt_idx.stg_eltool__state (compile): 19:15:22.876890 => 19:15:22.886931
[0m19:15:22.887931 [debug] [Thread-1 (]: Began executing node model.dbt_idx.stg_eltool__state
[0m19:15:22.895409 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_idx.stg_eltool__state"
[0m19:15:22.903943 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__state"
[0m19:15:22.904940 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__state: BEGIN
[0m19:15:22.905953 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:15:22.936271 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m19:15:22.936271 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__state"
[0m19:15:22.937810 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__state: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__state"} */

  create view "IDX-Stock"."IDX-Schema"."stg_eltool__state__dbt_tmp"
    
    
  as (
    with source as (select *
                from "IDX-Stock"."IDX-Schema"."state"),
     renamed as (select state_identifier::INT AS state_id,
                         state_code::VARCHAR(2) AS state_code,
                         st_name::VARCHAR(30) AS state_name
                 from source)
select *
from renamed
  );
[0m19:15:22.942819 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m19:15:22.947871 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__state"
[0m19:15:22.948871 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__state: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__state"} */
alter table "IDX-Stock"."IDX-Schema"."stg_eltool__state" rename to "stg_eltool__state__dbt_backup"
[0m19:15:22.951856 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:15:22.959771 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__state"
[0m19:15:22.960784 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__state: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__state"} */
alter table "IDX-Stock"."IDX-Schema"."stg_eltool__state__dbt_tmp" rename to "stg_eltool__state"
[0m19:15:22.963303 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:15:22.966330 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__state: COMMIT
[0m19:15:22.967337 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__state"
[0m19:15:22.968340 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__state: COMMIT
[0m19:15:22.972301 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m19:15:22.975850 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__state"
[0m19:15:22.976857 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__state: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__state"} */
drop view if exists "IDX-Stock"."IDX-Schema"."stg_eltool__state__dbt_backup" cascade
[0m19:15:22.980860 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m19:15:22.983455 [debug] [Thread-1 (]: Timing info for model.dbt_idx.stg_eltool__state (execute): 19:15:22.888894 => 19:15:22.983455
[0m19:15:22.984499 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__state: Close
[0m19:15:22.986471 [info ] [Thread-1 (]: 5 of 10 OK created sql view model IDX-Schema.stg_eltool__state ................. [[32mCREATE VIEW[0m in 0.11s]
[0m19:15:22.989466 [debug] [Thread-1 (]: Finished running node model.dbt_idx.stg_eltool__state
[0m19:15:22.990465 [debug] [Thread-1 (]: Began running node model.dbt_idx.stg_eltool__stock
[0m19:15:22.991464 [info ] [Thread-1 (]: 6 of 10 START sql view model IDX-Schema.stg_eltool__stock ...................... [RUN]
[0m19:15:22.993466 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_idx.stg_eltool__state, now model.dbt_idx.stg_eltool__stock)
[0m19:15:22.995648 [debug] [Thread-1 (]: Began compiling node model.dbt_idx.stg_eltool__stock
[0m19:15:23.004711 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_idx.stg_eltool__stock"
[0m19:15:23.011742 [debug] [Thread-1 (]: Timing info for model.dbt_idx.stg_eltool__stock (compile): 19:15:22.996161 => 19:15:23.011742
[0m19:15:23.013752 [debug] [Thread-1 (]: Began executing node model.dbt_idx.stg_eltool__stock
[0m19:15:23.020305 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_idx.stg_eltool__stock"
[0m19:15:23.027833 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__stock"
[0m19:15:23.028833 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__stock: BEGIN
[0m19:15:23.029831 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:15:23.053658 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m19:15:23.055667 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__stock"
[0m19:15:23.056673 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__stock: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__stock"} */

  create view "IDX-Stock"."IDX-Schema"."stg_eltool__stock__dbt_tmp"
    
    
  as (
    with source as (select *
                from "IDX-Stock"."IDX-Schema"."ksql-stock-stream"),
     renamed as (select *
                 from source)
select *
from renamed
  );
[0m19:15:23.060685 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m19:15:23.066339 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__stock"
[0m19:15:23.068326 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__stock: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__stock"} */
alter table "IDX-Stock"."IDX-Schema"."stg_eltool__stock" rename to "stg_eltool__stock__dbt_backup"
[0m19:15:23.071465 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:15:23.075435 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__stock"
[0m19:15:23.076470 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__stock: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__stock"} */
alter table "IDX-Stock"."IDX-Schema"."stg_eltool__stock__dbt_tmp" rename to "stg_eltool__stock"
[0m19:15:23.080433 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:15:23.083867 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__stock: COMMIT
[0m19:15:23.084865 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__stock"
[0m19:15:23.085863 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__stock: COMMIT
[0m19:15:23.089867 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m19:15:23.095377 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__stock"
[0m19:15:23.096386 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__stock: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__stock"} */
drop view if exists "IDX-Stock"."IDX-Schema"."stg_eltool__stock__dbt_backup" cascade
[0m19:15:23.100073 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m19:15:23.102083 [debug] [Thread-1 (]: Timing info for model.dbt_idx.stg_eltool__stock (execute): 19:15:23.014716 => 19:15:23.102083
[0m19:15:23.103083 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__stock: Close
[0m19:15:23.105606 [info ] [Thread-1 (]: 6 of 10 OK created sql view model IDX-Schema.stg_eltool__stock ................. [[32mCREATE VIEW[0m in 0.11s]
[0m19:15:23.107606 [debug] [Thread-1 (]: Finished running node model.dbt_idx.stg_eltool__stock
[0m19:15:23.108618 [debug] [Thread-1 (]: Began running node model.dbt_idx.fact_orders
[0m19:15:23.109606 [info ] [Thread-1 (]: 7 of 10 START sql table model IDX-Schema.fact_orders ........................... [RUN]
[0m19:15:23.111601 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_idx.stg_eltool__stock, now model.dbt_idx.fact_orders)
[0m19:15:23.111601 [debug] [Thread-1 (]: Began compiling node model.dbt_idx.fact_orders
[0m19:15:23.115160 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_idx.fact_orders"
[0m19:15:23.121599 [debug] [Thread-1 (]: Timing info for model.dbt_idx.fact_orders (compile): 19:15:23.112602 => 19:15:23.121599
[0m19:15:23.122640 [debug] [Thread-1 (]: Began executing node model.dbt_idx.fact_orders
[0m19:15:23.159557 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_idx.fact_orders"
[0m19:15:23.166573 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.fact_orders"
[0m19:15:23.167078 [debug] [Thread-1 (]: On model.dbt_idx.fact_orders: BEGIN
[0m19:15:23.168086 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:15:23.191430 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m19:15:23.192431 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.fact_orders"
[0m19:15:23.192431 [debug] [Thread-1 (]: On model.dbt_idx.fact_orders: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.fact_orders"} */

  
    

  create  table "IDX-Stock"."IDX-Schema"."fact_orders__dbt_tmp"
  
  
    as
  
  (
    with orders as (
    select *
    from "IDX-Stock"."IDX-Schema"."stg_eltool__orders"
)
select * from orders
  );
  
[0m19:15:23.200786 [debug] [Thread-1 (]: SQL status: SELECT 999 in 0.0 seconds
[0m19:15:23.204785 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.fact_orders"
[0m19:15:23.205785 [debug] [Thread-1 (]: On model.dbt_idx.fact_orders: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.fact_orders"} */
alter table "IDX-Stock"."IDX-Schema"."fact_orders" rename to "fact_orders__dbt_backup"
[0m19:15:23.207786 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:15:23.212341 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.fact_orders"
[0m19:15:23.212341 [debug] [Thread-1 (]: On model.dbt_idx.fact_orders: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.fact_orders"} */
alter table "IDX-Stock"."IDX-Schema"."fact_orders__dbt_tmp" rename to "fact_orders"
[0m19:15:23.215353 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:15:23.223384 [debug] [Thread-1 (]: On model.dbt_idx.fact_orders: COMMIT
[0m19:15:23.224348 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.fact_orders"
[0m19:15:23.225346 [debug] [Thread-1 (]: On model.dbt_idx.fact_orders: COMMIT
[0m19:15:23.229360 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m19:15:23.235351 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.fact_orders"
[0m19:15:23.235351 [debug] [Thread-1 (]: On model.dbt_idx.fact_orders: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.fact_orders"} */
drop table if exists "IDX-Stock"."IDX-Schema"."fact_orders__dbt_backup" cascade
[0m19:15:23.241105 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m19:15:23.243087 [debug] [Thread-1 (]: Timing info for model.dbt_idx.fact_orders (execute): 19:15:23.123612 => 19:15:23.243087
[0m19:15:23.244086 [debug] [Thread-1 (]: On model.dbt_idx.fact_orders: Close
[0m19:15:23.246613 [info ] [Thread-1 (]: 7 of 10 OK created sql table model IDX-Schema.fact_orders ...................... [[32mSELECT 999[0m in 0.14s]
[0m19:15:23.249620 [debug] [Thread-1 (]: Finished running node model.dbt_idx.fact_orders
[0m19:15:23.250622 [debug] [Thread-1 (]: Began running node model.dbt_idx.dim_customers
[0m19:15:23.251633 [info ] [Thread-1 (]: 8 of 10 START sql table model IDX-Schema.dim_customers ......................... [RUN]
[0m19:15:23.253635 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_idx.fact_orders, now model.dbt_idx.dim_customers)
[0m19:15:23.254622 [debug] [Thread-1 (]: Began compiling node model.dbt_idx.dim_customers
[0m19:15:23.258619 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_idx.dim_customers"
[0m19:15:23.266116 [debug] [Thread-1 (]: Timing info for model.dbt_idx.dim_customers (compile): 19:15:23.254622 => 19:15:23.265122
[0m19:15:23.267082 [debug] [Thread-1 (]: Began executing node model.dbt_idx.dim_customers
[0m19:15:23.274137 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_idx.dim_customers"
[0m19:15:23.281091 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.dim_customers"
[0m19:15:23.281858 [debug] [Thread-1 (]: On model.dbt_idx.dim_customers: BEGIN
[0m19:15:23.282397 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:15:23.305539 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m19:15:23.306533 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.dim_customers"
[0m19:15:23.306533 [debug] [Thread-1 (]: On model.dbt_idx.dim_customers: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.dim_customers"} */

  
    

  create  table "IDX-Stock"."IDX-Schema"."dim_customers__dbt_tmp"
  
  
    as
  
  (
    -- noinspection SqlDialectInspectionForFile

with customers as (
    select *
    from "IDX-Stock"."IDX-Schema"."stg_eltool__customers_snapshots"
    ),
     state as (
         select *
         from "IDX-Stock"."IDX-Schema"."stg_eltool__state"
     )
select c.customer_id,
       c.zipcode,
       c.city,
       c.state_code,
       s.state_name,
       c.datetime_created,
       c.datetime_updated,
       c.dbt_valid_from::TIMESTAMP as valid_from,
        CASE WHEN c.dbt_valid_to IS NULL
            THEN '9999-12-31'::TIMESTAMP
            ELSE c.dbt_valid_to::TIMESTAMP
        END as valid_to
from customers c
    join state s on c.state_code = s.state_code
  );
  
[0m19:15:23.311858 [debug] [Thread-1 (]: SQL status: SELECT 100 in 0.0 seconds
[0m19:15:23.316832 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.dim_customers"
[0m19:15:23.317831 [debug] [Thread-1 (]: On model.dbt_idx.dim_customers: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.dim_customers"} */
alter table "IDX-Stock"."IDX-Schema"."dim_customers" rename to "dim_customers__dbt_backup"
[0m19:15:23.320836 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:15:23.329383 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.dim_customers"
[0m19:15:23.330387 [debug] [Thread-1 (]: On model.dbt_idx.dim_customers: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.dim_customers"} */
alter table "IDX-Stock"."IDX-Schema"."dim_customers__dbt_tmp" rename to "dim_customers"
[0m19:15:23.332388 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:15:23.378110 [debug] [Thread-1 (]: On model.dbt_idx.dim_customers: COMMIT
[0m19:15:23.378110 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.dim_customers"
[0m19:15:23.379121 [debug] [Thread-1 (]: On model.dbt_idx.dim_customers: COMMIT
[0m19:15:23.383131 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m19:15:23.386119 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.dim_customers"
[0m19:15:23.387119 [debug] [Thread-1 (]: On model.dbt_idx.dim_customers: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.dim_customers"} */
drop table if exists "IDX-Stock"."IDX-Schema"."dim_customers__dbt_backup" cascade
[0m19:15:23.392118 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m19:15:23.393650 [debug] [Thread-1 (]: Timing info for model.dbt_idx.dim_customers (execute): 19:15:23.268101 => 19:15:23.393650
[0m19:15:23.394661 [debug] [Thread-1 (]: On model.dbt_idx.dim_customers: Close
[0m19:15:23.396665 [info ] [Thread-1 (]: 8 of 10 OK created sql table model IDX-Schema.dim_customers .................... [[32mSELECT 100[0m in 0.14s]
[0m19:15:23.398667 [debug] [Thread-1 (]: Finished running node model.dbt_idx.dim_customers
[0m19:15:23.401033 [debug] [Thread-1 (]: Began running node model.dbt_idx.dim_stocks
[0m19:15:23.401998 [info ] [Thread-1 (]: 9 of 10 START sql table model IDX-Schema.dim_stocks ............................ [RUN]
[0m19:15:23.404002 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_idx.dim_customers, now model.dbt_idx.dim_stocks)
[0m19:15:23.405000 [debug] [Thread-1 (]: Began compiling node model.dbt_idx.dim_stocks
[0m19:15:23.407999 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_idx.dim_stocks"
[0m19:15:23.414997 [debug] [Thread-1 (]: Timing info for model.dbt_idx.dim_stocks (compile): 19:15:23.406007 => 19:15:23.414997
[0m19:15:23.416011 [debug] [Thread-1 (]: Began executing node model.dbt_idx.dim_stocks
[0m19:15:23.421038 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_idx.dim_stocks"
[0m19:15:23.426592 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.dim_stocks"
[0m19:15:23.427599 [debug] [Thread-1 (]: On model.dbt_idx.dim_stocks: BEGIN
[0m19:15:23.428579 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:15:23.449534 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m19:15:23.450569 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.dim_stocks"
[0m19:15:23.451541 [debug] [Thread-1 (]: On model.dbt_idx.dim_stocks: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.dim_stocks"} */

  
    

  create  table "IDX-Stock"."IDX-Schema"."dim_stocks__dbt_tmp"
  
  
    as
  
  (
    -- noinspection SqlDialectInspectionForFile

with stock as (
    select *
    from "IDX-Stock"."IDX-Schema"."stg_eltool__stock"
    ),
     company as (
         select *
         from "IDX-Stock"."IDX-Schema"."stg_eltool__company"
     )
select a.id,
       a.ticker,
       b.name,
       a.date,
       a.open,
       a.high,
       a.low,
       a.close,
       a.colume,
       b.logo
from stock a
    join company b on a.id = b.id
  );
  
[0m19:15:23.456026 [debug] [Thread-1 (]: Postgres adapter: Postgres error: column a.colume does not exist
LINE 30:        a.colume,
                ^
HINT:  Perhaps you meant to reference the column "a.volume".

[0m19:15:23.457019 [debug] [Thread-1 (]: On model.dbt_idx.dim_stocks: ROLLBACK
[0m19:15:23.458996 [debug] [Thread-1 (]: Timing info for model.dbt_idx.dim_stocks (execute): 19:15:23.416011 => 19:15:23.458996
[0m19:15:23.460000 [debug] [Thread-1 (]: On model.dbt_idx.dim_stocks: Close
[0m19:15:23.474030 [debug] [Thread-1 (]: Database Error in model dim_stocks (models\marts\core\dim_stocks.sql)
  column a.colume does not exist
  LINE 30:        a.colume,
                  ^
  HINT:  Perhaps you meant to reference the column "a.volume".
  compiled Code at target\run\dbt_idx\models\marts\core\dim_stocks.sql
[0m19:15:23.475031 [error] [Thread-1 (]: 9 of 10 ERROR creating sql table model IDX-Schema.dim_stocks ................... [[31mERROR[0m in 0.07s]
[0m19:15:23.476007 [debug] [Thread-1 (]: Finished running node model.dbt_idx.dim_stocks
[0m19:15:23.477029 [debug] [Thread-1 (]: Began running node model.dbt_idx.customer_orders_status
[0m19:15:23.477029 [info ] [Thread-1 (]: 10 of 10 START sql view model IDX-Schema.customer_orders_status ................ [RUN]
[0m19:15:23.478043 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_idx.dim_stocks, now model.dbt_idx.customer_orders_status)
[0m19:15:23.479091 [debug] [Thread-1 (]: Began compiling node model.dbt_idx.customer_orders_status
[0m19:15:23.482089 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_idx.customer_orders_status"
[0m19:15:23.488160 [debug] [Thread-1 (]: Timing info for model.dbt_idx.customer_orders_status (compile): 19:15:23.480062 => 19:15:23.488160
[0m19:15:23.489108 [debug] [Thread-1 (]: Began executing node model.dbt_idx.customer_orders_status
[0m19:15:23.493708 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_idx.customer_orders_status"
[0m19:15:23.502224 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.customer_orders_status"
[0m19:15:23.503232 [debug] [Thread-1 (]: On model.dbt_idx.customer_orders_status: BEGIN
[0m19:15:23.504232 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:15:23.530080 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m19:15:23.531103 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.customer_orders_status"
[0m19:15:23.532103 [debug] [Thread-1 (]: On model.dbt_idx.customer_orders_status: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.customer_orders_status"} */

  create view "IDX-Stock"."IDX-Schema"."customer_orders_status__dbt_tmp"
    
    
  as (
    with orders as (select *
                from "IDX-Stock"."IDX-Schema"."fact_orders"),
     customers as (select *
                   from "IDX-Stock"."IDX-Schema"."dim_customers")
select o.order_id,
       o.customer_id,
       o.order_status,
       o.order_purchase_timestamp,
       o.order_approved_at,
       o.order_delivered_carrier_date,
       o.order_delivered_customer_date,
       o.order_estimated_delivery_date,
       c.zipcode    as customer_zipcode,
       c.city       as customer_city,
       c.state_code as customer_state_code,
       c.state_name as customer_state_name
from orders o
    join customers c on o.customer_id = c.customer_id
    and o.order_purchase_timestamp >= c.valid_from
    and o.order_purchase_timestamp <= c.valid_to
  );
[0m19:15:23.536119 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m19:15:23.540070 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.customer_orders_status"
[0m19:15:23.541067 [debug] [Thread-1 (]: On model.dbt_idx.customer_orders_status: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.customer_orders_status"} */
alter table "IDX-Stock"."IDX-Schema"."customer_orders_status__dbt_tmp" rename to "customer_orders_status"
[0m19:15:23.544103 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:15:23.547067 [debug] [Thread-1 (]: On model.dbt_idx.customer_orders_status: COMMIT
[0m19:15:23.548066 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.customer_orders_status"
[0m19:15:23.548066 [debug] [Thread-1 (]: On model.dbt_idx.customer_orders_status: COMMIT
[0m19:15:23.551652 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m19:15:23.554667 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.customer_orders_status"
[0m19:15:23.555628 [debug] [Thread-1 (]: On model.dbt_idx.customer_orders_status: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.customer_orders_status"} */
drop view if exists "IDX-Stock"."IDX-Schema"."customer_orders_status__dbt_backup" cascade
[0m19:15:23.557628 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m19:15:23.558664 [debug] [Thread-1 (]: Timing info for model.dbt_idx.customer_orders_status (execute): 19:15:23.490127 => 19:15:23.558664
[0m19:15:23.559662 [debug] [Thread-1 (]: On model.dbt_idx.customer_orders_status: Close
[0m19:15:23.561631 [info ] [Thread-1 (]: 10 of 10 OK created sql view model IDX-Schema.customer_orders_status ........... [[32mCREATE VIEW[0m in 0.08s]
[0m19:15:23.563630 [debug] [Thread-1 (]: Finished running node model.dbt_idx.customer_orders_status
[0m19:15:23.565631 [debug] [MainThread]: Using postgres connection "master"
[0m19:15:23.566664 [debug] [MainThread]: On master: BEGIN
[0m19:15:23.567649 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m19:15:23.589633 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m19:15:23.590630 [debug] [MainThread]: On master: COMMIT
[0m19:15:23.590630 [debug] [MainThread]: Using postgres connection "master"
[0m19:15:23.591630 [debug] [MainThread]: On master: COMMIT
[0m19:15:23.595024 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m19:15:23.596038 [debug] [MainThread]: On master: Close
[0m19:15:23.598027 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:15:23.600026 [debug] [MainThread]: Connection 'list_IDX-Stock' was properly closed.
[0m19:15:23.601039 [debug] [MainThread]: Connection 'list_IDX-Stock_IDX-Schema' was properly closed.
[0m19:15:23.602025 [debug] [MainThread]: Connection 'model.dbt_idx.customer_orders_status' was properly closed.
[0m19:15:23.602025 [info ] [MainThread]: 
[0m19:15:23.603254 [info ] [MainThread]: Finished running 7 view models, 3 table models in 0 hours 0 minutes and 1.36 seconds (1.36s).
[0m19:15:23.606265 [debug] [MainThread]: Command end result
[0m19:15:23.631285 [info ] [MainThread]: 
[0m19:15:23.632265 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m19:15:23.633280 [info ] [MainThread]: 
[0m19:15:23.634305 [error] [MainThread]: [33mDatabase Error in model dim_stocks (models\marts\core\dim_stocks.sql)[0m
[0m19:15:23.635264 [error] [MainThread]:   column a.colume does not exist
[0m19:15:23.636268 [error] [MainThread]:   LINE 30:        a.colume,
[0m19:15:23.637267 [error] [MainThread]:                   ^
[0m19:15:23.637267 [error] [MainThread]:   HINT:  Perhaps you meant to reference the column "a.volume".
[0m19:15:23.639266 [error] [MainThread]:   compiled Code at target\run\dbt_idx\models\marts\core\dim_stocks.sql
[0m19:15:23.640303 [info ] [MainThread]: 
[0m19:15:23.641322 [info ] [MainThread]: Done. PASS=9 WARN=0 ERROR=1 SKIP=0 TOTAL=10
[0m19:15:23.643272 [debug] [MainThread]: Command `dbt run` failed at 19:15:23.643272 after 1.91 seconds
[0m19:15:23.644266 [debug] [MainThread]: Flushing usage events


============================== 19:15:36.568030 | 9486cf01-9661-4b83-90d9-66c8620ad1d5 ==============================
[0m19:15:36.568030 [info ] [MainThread]: Running with dbt=1.6.1
[0m19:15:36.574049 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'D:\\00 Project\\00 My Project\\IdeaProjects\\Py-DBT-IDX\\logs', 'profiles_dir': 'D:\\00 Project\\00 My Project\\IdeaProjects\\Py-DBT-IDX', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'False'}
[0m19:15:36.728161 [info ] [MainThread]: Registered adapter: postgres=1.6.1
[0m19:15:36.737797 [debug] [MainThread]: checksum: efe19d9f5b93d1a98cc804fbfcdb6b3aced98b974af664946fee1cde8837deb7, vars: {}, profile: , target: , version: 1.6.1
[0m19:15:36.888681 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m19:15:36.889682 [debug] [MainThread]: Partial parsing: updated file: dbt_idx://models\marts\core\dim_stocks.sql
[0m19:15:37.055699 [info ] [MainThread]: Found 10 models, 1 snapshot, 17 tests, 5 sources, 0 exposures, 0 metrics, 349 macros, 0 groups, 0 semantic models
[0m19:15:37.058437 [info ] [MainThread]: 
[0m19:15:37.060416 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m19:15:37.063404 [debug] [ThreadPool]: Acquiring new postgres connection 'list_IDX-Stock'
[0m19:15:37.073449 [debug] [ThreadPool]: Using postgres connection "list_IDX-Stock"
[0m19:15:37.074442 [debug] [ThreadPool]: On list_IDX-Stock: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "connection_name": "list_IDX-Stock"} */

    select distinct nspname from pg_namespace
  
[0m19:15:37.075417 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:15:37.105391 [debug] [ThreadPool]: SQL status: SELECT 12 in 0.0 seconds
[0m19:15:37.107738 [debug] [ThreadPool]: On list_IDX-Stock: Close
[0m19:15:37.111704 [debug] [ThreadPool]: Acquiring new postgres connection 'list_IDX-Stock_snapshots'
[0m19:15:37.117704 [debug] [ThreadPool]: Using postgres connection "list_IDX-Stock_snapshots"
[0m19:15:37.118713 [debug] [ThreadPool]: On list_IDX-Stock_snapshots: BEGIN
[0m19:15:37.119703 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:15:37.139018 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m19:15:37.140020 [debug] [ThreadPool]: Using postgres connection "list_IDX-Stock_snapshots"
[0m19:15:37.141022 [debug] [ThreadPool]: On list_IDX-Stock_snapshots: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "connection_name": "list_IDX-Stock_snapshots"} */
select
      'IDX-Stock' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'snapshots'
    union all
    select
      'IDX-Stock' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'snapshots'
    union all
    select
      'IDX-Stock' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'snapshots'
  
[0m19:15:37.145088 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.0 seconds
[0m19:15:37.146126 [debug] [ThreadPool]: On list_IDX-Stock_snapshots: ROLLBACK
[0m19:15:37.148882 [debug] [ThreadPool]: On list_IDX-Stock_snapshots: Close
[0m19:15:37.150893 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_IDX-Stock_snapshots, now list_IDX-Stock_IDX-Schema)
[0m19:15:37.153892 [debug] [ThreadPool]: Using postgres connection "list_IDX-Stock_IDX-Schema"
[0m19:15:37.154892 [debug] [ThreadPool]: On list_IDX-Stock_IDX-Schema: BEGIN
[0m19:15:37.155900 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:15:37.176775 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m19:15:37.176775 [debug] [ThreadPool]: Using postgres connection "list_IDX-Stock_IDX-Schema"
[0m19:15:37.177786 [debug] [ThreadPool]: On list_IDX-Stock_IDX-Schema: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "connection_name": "list_IDX-Stock_IDX-Schema"} */
select
      'IDX-Stock' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'IDX-Schema'
    union all
    select
      'IDX-Stock' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'IDX-Schema'
    union all
    select
      'IDX-Stock' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'IDX-Schema'
  
[0m19:15:37.182785 [debug] [ThreadPool]: SQL status: SELECT 15 in 0.0 seconds
[0m19:15:37.183786 [debug] [ThreadPool]: On list_IDX-Stock_IDX-Schema: ROLLBACK
[0m19:15:37.185825 [debug] [ThreadPool]: On list_IDX-Stock_IDX-Schema: Close
[0m19:15:37.195831 [debug] [MainThread]: Using postgres connection "master"
[0m19:15:37.195831 [debug] [MainThread]: On master: BEGIN
[0m19:15:37.196833 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:15:37.218672 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m19:15:37.219686 [debug] [MainThread]: Using postgres connection "master"
[0m19:15:37.220666 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m19:15:37.229663 [debug] [MainThread]: SQL status: SELECT 8 in 0.0 seconds
[0m19:15:37.233661 [debug] [MainThread]: On master: ROLLBACK
[0m19:15:37.235660 [debug] [MainThread]: Using postgres connection "master"
[0m19:15:37.236675 [debug] [MainThread]: On master: BEGIN
[0m19:15:37.240659 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m19:15:37.241697 [debug] [MainThread]: On master: COMMIT
[0m19:15:37.242698 [debug] [MainThread]: Using postgres connection "master"
[0m19:15:37.243669 [debug] [MainThread]: On master: COMMIT
[0m19:15:37.245676 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m19:15:37.246668 [debug] [MainThread]: On master: Close
[0m19:15:37.248677 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m19:15:37.250673 [info ] [MainThread]: 
[0m19:15:37.258677 [debug] [Thread-1 (]: Began running node model.dbt_idx.stg_eltool__company
[0m19:15:37.259670 [info ] [Thread-1 (]: 1 of 10 START sql view model IDX-Schema.stg_eltool__company .................... [RUN]
[0m19:15:37.262687 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.dbt_idx.stg_eltool__company'
[0m19:15:37.262687 [debug] [Thread-1 (]: Began compiling node model.dbt_idx.stg_eltool__company
[0m19:15:37.271668 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_idx.stg_eltool__company"
[0m19:15:37.277320 [debug] [Thread-1 (]: Timing info for model.dbt_idx.stg_eltool__company (compile): 19:15:37.263719 => 19:15:37.277320
[0m19:15:37.278332 [debug] [Thread-1 (]: Began executing node model.dbt_idx.stg_eltool__company
[0m19:15:37.325695 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_idx.stg_eltool__company"
[0m19:15:37.333216 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__company"
[0m19:15:37.333216 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__company: BEGIN
[0m19:15:37.334212 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m19:15:37.356730 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m19:15:37.357731 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__company"
[0m19:15:37.358727 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__company: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__company"} */

  create view "IDX-Stock"."IDX-Schema"."stg_eltool__company__dbt_tmp"
    
    
  as (
    with source as (select *
                from "IDX-Stock"."IDX-Schema"."ksql-company-stream"),
     renamed as (select id,
                        ticker,
                        name,
                        logo
                 from source)
select *
from renamed
  );
[0m19:15:37.363735 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m19:15:37.371239 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__company"
[0m19:15:37.372245 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__company: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__company"} */
alter table "IDX-Stock"."IDX-Schema"."stg_eltool__company" rename to "stg_eltool__company__dbt_backup"
[0m19:15:37.375241 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:15:37.379258 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__company"
[0m19:15:37.380253 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__company: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__company"} */
alter table "IDX-Stock"."IDX-Schema"."stg_eltool__company__dbt_tmp" rename to "stg_eltool__company"
[0m19:15:37.382788 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:15:37.402792 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__company: COMMIT
[0m19:15:37.403781 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__company"
[0m19:15:37.404784 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__company: COMMIT
[0m19:15:37.409309 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m19:15:37.418335 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__company"
[0m19:15:37.419301 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__company: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__company"} */
drop view if exists "IDX-Stock"."IDX-Schema"."stg_eltool__company__dbt_backup" cascade
[0m19:15:37.422678 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m19:15:37.424689 [debug] [Thread-1 (]: Timing info for model.dbt_idx.stg_eltool__company (execute): 19:15:37.279331 => 19:15:37.424689
[0m19:15:37.425688 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__company: Close
[0m19:15:37.427689 [info ] [Thread-1 (]: 1 of 10 OK created sql view model IDX-Schema.stg_eltool__company ............... [[32mCREATE VIEW[0m in 0.17s]
[0m19:15:37.429700 [debug] [Thread-1 (]: Finished running node model.dbt_idx.stg_eltool__company
[0m19:15:37.430700 [debug] [Thread-1 (]: Began running node model.dbt_idx.stg_eltool__customers
[0m19:15:37.431726 [info ] [Thread-1 (]: 2 of 10 START sql view model IDX-Schema.stg_eltool__customers .................. [RUN]
[0m19:15:37.433689 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_idx.stg_eltool__company, now model.dbt_idx.stg_eltool__customers)
[0m19:15:37.433689 [debug] [Thread-1 (]: Began compiling node model.dbt_idx.stg_eltool__customers
[0m19:15:37.437723 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_idx.stg_eltool__customers"
[0m19:15:37.443751 [debug] [Thread-1 (]: Timing info for model.dbt_idx.stg_eltool__customers (compile): 19:15:37.434723 => 19:15:37.442787
[0m19:15:37.443751 [debug] [Thread-1 (]: Began executing node model.dbt_idx.stg_eltool__customers
[0m19:15:37.448755 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_idx.stg_eltool__customers"
[0m19:15:37.454777 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__customers"
[0m19:15:37.455777 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__customers: BEGIN
[0m19:15:37.456750 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:15:37.477451 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m19:15:37.478453 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__customers"
[0m19:15:37.479452 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__customers: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__customers"} */

  create view "IDX-Stock"."IDX-Schema"."stg_eltool__customers__dbt_tmp"
    
    
  as (
    with source as (select *
                from "IDX-Stock"."IDX-Schema"."customers"),
     renamed as (select
                     customer_id,
                    'This is Dummy' as dummy
                 from source
                 where customer_id = 1234567890)
select *
from renamed
  );
[0m19:15:37.482495 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m19:15:37.486450 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__customers"
[0m19:15:37.487482 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__customers: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__customers"} */
alter table "IDX-Stock"."IDX-Schema"."stg_eltool__customers" rename to "stg_eltool__customers__dbt_backup"
[0m19:15:37.489456 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:15:37.495529 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__customers"
[0m19:15:37.496515 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__customers: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__customers"} */
alter table "IDX-Stock"."IDX-Schema"."stg_eltool__customers__dbt_tmp" rename to "stg_eltool__customers"
[0m19:15:37.498496 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:15:37.501498 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__customers: COMMIT
[0m19:15:37.502530 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__customers"
[0m19:15:37.503494 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__customers: COMMIT
[0m19:15:37.507493 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m19:15:37.510590 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__customers"
[0m19:15:37.511564 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__customers: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__customers"} */
drop view if exists "IDX-Stock"."IDX-Schema"."stg_eltool__customers__dbt_backup" cascade
[0m19:15:37.515142 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m19:15:37.517173 [debug] [Thread-1 (]: Timing info for model.dbt_idx.stg_eltool__customers (execute): 19:15:37.444788 => 19:15:37.517173
[0m19:15:37.517173 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__customers: Close
[0m19:15:37.519145 [info ] [Thread-1 (]: 2 of 10 OK created sql view model IDX-Schema.stg_eltool__customers ............. [[32mCREATE VIEW[0m in 0.09s]
[0m19:15:37.521142 [debug] [Thread-1 (]: Finished running node model.dbt_idx.stg_eltool__customers
[0m19:15:37.522143 [debug] [Thread-1 (]: Began running node model.dbt_idx.stg_eltool__customers_snapshots
[0m19:15:37.523142 [info ] [Thread-1 (]: 3 of 10 START sql view model IDX-Schema.stg_eltool__customers_snapshots ........ [RUN]
[0m19:15:37.524141 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_idx.stg_eltool__customers, now model.dbt_idx.stg_eltool__customers_snapshots)
[0m19:15:37.525142 [debug] [Thread-1 (]: Began compiling node model.dbt_idx.stg_eltool__customers_snapshots
[0m19:15:37.528141 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_idx.stg_eltool__customers_snapshots"
[0m19:15:37.534142 [debug] [Thread-1 (]: Timing info for model.dbt_idx.stg_eltool__customers_snapshots (compile): 19:15:37.526141 => 19:15:37.534142
[0m19:15:37.535143 [debug] [Thread-1 (]: Began executing node model.dbt_idx.stg_eltool__customers_snapshots
[0m19:15:37.541178 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_idx.stg_eltool__customers_snapshots"
[0m19:15:37.547180 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__customers_snapshots"
[0m19:15:37.549147 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__customers_snapshots: BEGIN
[0m19:15:37.550151 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:15:37.570984 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m19:15:37.572016 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__customers_snapshots"
[0m19:15:37.572978 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__customers_snapshots: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__customers_snapshots"} */

  create view "IDX-Stock"."IDX-Schema"."stg_eltool__customers_snapshots__dbt_tmp"
    
    
  as (
    with source as (select *
                from "IDX-Stock"."snapshots"."customers_snapshot"),
     renamed as (select customer_id,
                        zipcode,
                        city,
                        state_code,
                        datetime_created::TIMESTAMP AS datetime_created,
                        datetime_updated::TIMESTAMP AS datetime_updated,
                        dbt_valid_from,
                        dbt_valid_to
                 from source)
select *
from renamed
  );
[0m19:15:37.575986 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m19:15:37.579979 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__customers_snapshots"
[0m19:15:37.581015 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__customers_snapshots: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__customers_snapshots"} */
alter table "IDX-Stock"."IDX-Schema"."stg_eltool__customers_snapshots" rename to "stg_eltool__customers_snapshots__dbt_backup"
[0m19:15:37.582981 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:15:37.586014 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__customers_snapshots"
[0m19:15:37.587013 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__customers_snapshots: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__customers_snapshots"} */
alter table "IDX-Stock"."IDX-Schema"."stg_eltool__customers_snapshots__dbt_tmp" rename to "stg_eltool__customers_snapshots"
[0m19:15:37.589583 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:15:37.592618 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__customers_snapshots: COMMIT
[0m19:15:37.592618 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__customers_snapshots"
[0m19:15:37.593658 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__customers_snapshots: COMMIT
[0m19:15:37.597288 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m19:15:37.601333 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__customers_snapshots"
[0m19:15:37.602299 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__customers_snapshots: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__customers_snapshots"} */
drop view if exists "IDX-Stock"."IDX-Schema"."stg_eltool__customers_snapshots__dbt_backup" cascade
[0m19:15:37.606321 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m19:15:37.608868 [debug] [Thread-1 (]: Timing info for model.dbt_idx.stg_eltool__customers_snapshots (execute): 19:15:37.535143 => 19:15:37.608868
[0m19:15:37.609835 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__customers_snapshots: Close
[0m19:15:37.611839 [info ] [Thread-1 (]: 3 of 10 OK created sql view model IDX-Schema.stg_eltool__customers_snapshots ... [[32mCREATE VIEW[0m in 0.09s]
[0m19:15:37.613853 [debug] [Thread-1 (]: Finished running node model.dbt_idx.stg_eltool__customers_snapshots
[0m19:15:37.614838 [debug] [Thread-1 (]: Began running node model.dbt_idx.stg_eltool__orders
[0m19:15:37.615871 [info ] [Thread-1 (]: 4 of 10 START sql view model IDX-Schema.stg_eltool__orders ..................... [RUN]
[0m19:15:37.617017 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_idx.stg_eltool__customers_snapshots, now model.dbt_idx.stg_eltool__orders)
[0m19:15:37.618055 [debug] [Thread-1 (]: Began compiling node model.dbt_idx.stg_eltool__orders
[0m19:15:37.622062 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_idx.stg_eltool__orders"
[0m19:15:37.633031 [debug] [Thread-1 (]: Timing info for model.dbt_idx.stg_eltool__orders (compile): 19:15:37.619034 => 19:15:37.632063
[0m19:15:37.633031 [debug] [Thread-1 (]: Began executing node model.dbt_idx.stg_eltool__orders
[0m19:15:37.638031 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_idx.stg_eltool__orders"
[0m19:15:37.647894 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__orders"
[0m19:15:37.648930 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__orders: BEGIN
[0m19:15:37.649909 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:15:37.671901 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m19:15:37.672919 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__orders"
[0m19:15:37.673902 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__orders: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__orders"} */

  create view "IDX-Stock"."IDX-Schema"."stg_eltool__orders__dbt_tmp"
    
    
  as (
    with source as (select *
                from "IDX-Stock"."IDX-Schema"."orders"),
     renamed as (select order_id,
                        cust_id AS customer_id,
                        order_status,
                        order_purchase_timestamp::TIMESTAMP,
                        order_approved_at::TIMESTAMP,
                        order_delivered_carrier_date::TIMESTAMP,
                        order_delivered_customer_date::TIMESTAMP,
                        order_estimated_delivery_date::TIMESTAMP
                 from source)
select *
from renamed
  );
[0m19:15:37.677286 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m19:15:37.681324 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__orders"
[0m19:15:37.682323 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__orders: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__orders"} */
alter table "IDX-Stock"."IDX-Schema"."stg_eltool__orders" rename to "stg_eltool__orders__dbt_backup"
[0m19:15:37.685296 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:15:37.688321 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__orders"
[0m19:15:37.689337 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__orders: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__orders"} */
alter table "IDX-Stock"."IDX-Schema"."stg_eltool__orders__dbt_tmp" rename to "stg_eltool__orders"
[0m19:15:37.691323 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:15:37.694354 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__orders: COMMIT
[0m19:15:37.694354 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__orders"
[0m19:15:37.695358 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__orders: COMMIT
[0m19:15:37.698352 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m19:15:37.702375 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__orders"
[0m19:15:37.702375 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__orders: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__orders"} */
drop view if exists "IDX-Stock"."IDX-Schema"."stg_eltool__orders__dbt_backup" cascade
[0m19:15:37.706182 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m19:15:37.708720 [debug] [Thread-1 (]: Timing info for model.dbt_idx.stg_eltool__orders (execute): 19:15:37.634031 => 19:15:37.707712
[0m19:15:37.708720 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__orders: Close
[0m19:15:37.710733 [info ] [Thread-1 (]: 4 of 10 OK created sql view model IDX-Schema.stg_eltool__orders ................ [[32mCREATE VIEW[0m in 0.09s]
[0m19:15:37.713726 [debug] [Thread-1 (]: Finished running node model.dbt_idx.stg_eltool__orders
[0m19:15:37.714721 [debug] [Thread-1 (]: Began running node model.dbt_idx.stg_eltool__state
[0m19:15:37.715720 [info ] [Thread-1 (]: 5 of 10 START sql view model IDX-Schema.stg_eltool__state ...................... [RUN]
[0m19:15:37.717720 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_idx.stg_eltool__orders, now model.dbt_idx.stg_eltool__state)
[0m19:15:37.718727 [debug] [Thread-1 (]: Began compiling node model.dbt_idx.stg_eltool__state
[0m19:15:37.721727 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_idx.stg_eltool__state"
[0m19:15:37.728725 [debug] [Thread-1 (]: Timing info for model.dbt_idx.stg_eltool__state (compile): 19:15:37.718727 => 19:15:37.728725
[0m19:15:37.729744 [debug] [Thread-1 (]: Began executing node model.dbt_idx.stg_eltool__state
[0m19:15:37.734722 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_idx.stg_eltool__state"
[0m19:15:37.741719 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__state"
[0m19:15:37.741719 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__state: BEGIN
[0m19:15:37.742753 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:15:37.764274 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m19:15:37.765304 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__state"
[0m19:15:37.766280 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__state: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__state"} */

  create view "IDX-Stock"."IDX-Schema"."stg_eltool__state__dbt_tmp"
    
    
  as (
    with source as (select *
                from "IDX-Stock"."IDX-Schema"."state"),
     renamed as (select state_identifier::INT AS state_id,
                         state_code::VARCHAR(2) AS state_code,
                         st_name::VARCHAR(30) AS state_name
                 from source)
select *
from renamed
  );
[0m19:15:37.769296 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m19:15:37.773293 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__state"
[0m19:15:37.773293 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__state: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__state"} */
alter table "IDX-Stock"."IDX-Schema"."stg_eltool__state" rename to "stg_eltool__state__dbt_backup"
[0m19:15:37.775295 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:15:37.779327 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__state"
[0m19:15:37.780271 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__state: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__state"} */
alter table "IDX-Stock"."IDX-Schema"."stg_eltool__state__dbt_tmp" rename to "stg_eltool__state"
[0m19:15:37.782274 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:15:37.785271 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__state: COMMIT
[0m19:15:37.785271 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__state"
[0m19:15:37.786296 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__state: COMMIT
[0m19:15:37.790004 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m19:15:37.793020 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__state"
[0m19:15:37.794020 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__state: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__state"} */
drop view if exists "IDX-Stock"."IDX-Schema"."stg_eltool__state__dbt_backup" cascade
[0m19:15:37.798025 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m19:15:37.800032 [debug] [Thread-1 (]: Timing info for model.dbt_idx.stg_eltool__state (execute): 19:15:37.730723 => 19:15:37.800032
[0m19:15:37.801031 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__state: Close
[0m19:15:37.803033 [info ] [Thread-1 (]: 5 of 10 OK created sql view model IDX-Schema.stg_eltool__state ................. [[32mCREATE VIEW[0m in 0.09s]
[0m19:15:37.804030 [debug] [Thread-1 (]: Finished running node model.dbt_idx.stg_eltool__state
[0m19:15:37.806032 [debug] [Thread-1 (]: Began running node model.dbt_idx.stg_eltool__stock
[0m19:15:37.806032 [info ] [Thread-1 (]: 6 of 10 START sql view model IDX-Schema.stg_eltool__stock ...................... [RUN]
[0m19:15:37.807536 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_idx.stg_eltool__state, now model.dbt_idx.stg_eltool__stock)
[0m19:15:37.808545 [debug] [Thread-1 (]: Began compiling node model.dbt_idx.stg_eltool__stock
[0m19:15:37.813578 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_idx.stg_eltool__stock"
[0m19:15:37.820492 [debug] [Thread-1 (]: Timing info for model.dbt_idx.stg_eltool__stock (compile): 19:15:37.809544 => 19:15:37.819455
[0m19:15:37.820492 [debug] [Thread-1 (]: Began executing node model.dbt_idx.stg_eltool__stock
[0m19:15:37.825493 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_idx.stg_eltool__stock"
[0m19:15:37.831455 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__stock"
[0m19:15:37.832489 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__stock: BEGIN
[0m19:15:37.832489 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:15:37.853914 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m19:15:37.854949 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__stock"
[0m19:15:37.855958 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__stock: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__stock"} */

  create view "IDX-Stock"."IDX-Schema"."stg_eltool__stock__dbt_tmp"
    
    
  as (
    with source as (select *
                from "IDX-Stock"."IDX-Schema"."ksql-stock-stream"),
     renamed as (select *
                 from source)
select *
from renamed
  );
[0m19:15:37.860285 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m19:15:37.863333 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__stock"
[0m19:15:37.864296 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__stock: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__stock"} */
alter table "IDX-Stock"."IDX-Schema"."stg_eltool__stock" rename to "stg_eltool__stock__dbt_backup"
[0m19:15:37.866333 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:15:37.870295 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__stock"
[0m19:15:37.871295 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__stock: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__stock"} */
alter table "IDX-Stock"."IDX-Schema"."stg_eltool__stock__dbt_tmp" rename to "stg_eltool__stock"
[0m19:15:37.874312 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:15:37.877333 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__stock: COMMIT
[0m19:15:37.877333 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__stock"
[0m19:15:37.879300 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__stock: COMMIT
[0m19:15:37.883766 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m19:15:37.887284 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__stock"
[0m19:15:37.888285 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__stock: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__stock"} */
drop view if exists "IDX-Stock"."IDX-Schema"."stg_eltool__stock__dbt_backup" cascade
[0m19:15:37.893484 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m19:15:37.895316 [debug] [Thread-1 (]: Timing info for model.dbt_idx.stg_eltool__stock (execute): 19:15:37.821491 => 19:15:37.895316
[0m19:15:37.896314 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__stock: Close
[0m19:15:37.898323 [info ] [Thread-1 (]: 6 of 10 OK created sql view model IDX-Schema.stg_eltool__stock ................. [[32mCREATE VIEW[0m in 0.09s]
[0m19:15:37.900498 [debug] [Thread-1 (]: Finished running node model.dbt_idx.stg_eltool__stock
[0m19:15:37.901497 [debug] [Thread-1 (]: Began running node model.dbt_idx.fact_orders
[0m19:15:37.902489 [info ] [Thread-1 (]: 7 of 10 START sql table model IDX-Schema.fact_orders ........................... [RUN]
[0m19:15:37.904499 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_idx.stg_eltool__stock, now model.dbt_idx.fact_orders)
[0m19:15:37.905496 [debug] [Thread-1 (]: Began compiling node model.dbt_idx.fact_orders
[0m19:15:37.908759 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_idx.fact_orders"
[0m19:15:37.915432 [debug] [Thread-1 (]: Timing info for model.dbt_idx.fact_orders (compile): 19:15:37.906494 => 19:15:37.915432
[0m19:15:37.916424 [debug] [Thread-1 (]: Began executing node model.dbt_idx.fact_orders
[0m19:15:37.944462 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_idx.fact_orders"
[0m19:15:37.950673 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.fact_orders"
[0m19:15:37.951635 [debug] [Thread-1 (]: On model.dbt_idx.fact_orders: BEGIN
[0m19:15:37.952670 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:15:37.978538 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m19:15:37.979519 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.fact_orders"
[0m19:15:37.980519 [debug] [Thread-1 (]: On model.dbt_idx.fact_orders: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.fact_orders"} */

  
    

  create  table "IDX-Stock"."IDX-Schema"."fact_orders__dbt_tmp"
  
  
    as
  
  (
    with orders as (
    select *
    from "IDX-Stock"."IDX-Schema"."stg_eltool__orders"
)
select * from orders
  );
  
[0m19:15:37.991622 [debug] [Thread-1 (]: SQL status: SELECT 999 in 0.0 seconds
[0m19:15:37.999185 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.fact_orders"
[0m19:15:38.001207 [debug] [Thread-1 (]: On model.dbt_idx.fact_orders: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.fact_orders"} */
alter table "IDX-Stock"."IDX-Schema"."fact_orders" rename to "fact_orders__dbt_backup"
[0m19:15:38.008728 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:15:38.017816 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.fact_orders"
[0m19:15:38.018804 [debug] [Thread-1 (]: On model.dbt_idx.fact_orders: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.fact_orders"} */
alter table "IDX-Stock"."IDX-Schema"."fact_orders__dbt_tmp" rename to "fact_orders"
[0m19:15:38.024803 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:15:38.039803 [debug] [Thread-1 (]: On model.dbt_idx.fact_orders: COMMIT
[0m19:15:38.040817 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.fact_orders"
[0m19:15:38.041801 [debug] [Thread-1 (]: On model.dbt_idx.fact_orders: COMMIT
[0m19:15:38.047809 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m19:15:38.057556 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.fact_orders"
[0m19:15:38.058557 [debug] [Thread-1 (]: On model.dbt_idx.fact_orders: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.fact_orders"} */
drop table if exists "IDX-Stock"."IDX-Schema"."fact_orders__dbt_backup" cascade
[0m19:15:38.068162 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m19:15:38.071173 [debug] [Thread-1 (]: Timing info for model.dbt_idx.fact_orders (execute): 19:15:37.916424 => 19:15:38.071173
[0m19:15:38.073164 [debug] [Thread-1 (]: On model.dbt_idx.fact_orders: Close
[0m19:15:38.080156 [info ] [Thread-1 (]: 7 of 10 OK created sql table model IDX-Schema.fact_orders ...................... [[32mSELECT 999[0m in 0.17s]
[0m19:15:38.082283 [debug] [Thread-1 (]: Finished running node model.dbt_idx.fact_orders
[0m19:15:38.084280 [debug] [Thread-1 (]: Began running node model.dbt_idx.dim_customers
[0m19:15:38.087304 [info ] [Thread-1 (]: 8 of 10 START sql table model IDX-Schema.dim_customers ......................... [RUN]
[0m19:15:38.092878 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_idx.fact_orders, now model.dbt_idx.dim_customers)
[0m19:15:38.096992 [debug] [Thread-1 (]: Began compiling node model.dbt_idx.dim_customers
[0m19:15:38.106344 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_idx.dim_customers"
[0m19:15:38.124204 [debug] [Thread-1 (]: Timing info for model.dbt_idx.dim_customers (compile): 19:15:38.098014 => 19:15:38.123210
[0m19:15:38.126824 [debug] [Thread-1 (]: Began executing node model.dbt_idx.dim_customers
[0m19:15:38.144605 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_idx.dim_customers"
[0m19:15:38.160734 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.dim_customers"
[0m19:15:38.163738 [debug] [Thread-1 (]: On model.dbt_idx.dim_customers: BEGIN
[0m19:15:38.165996 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:15:38.203534 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m19:15:38.204826 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.dim_customers"
[0m19:15:38.207898 [debug] [Thread-1 (]: On model.dbt_idx.dim_customers: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.dim_customers"} */

  
    

  create  table "IDX-Stock"."IDX-Schema"."dim_customers__dbt_tmp"
  
  
    as
  
  (
    -- noinspection SqlDialectInspectionForFile

with customers as (
    select *
    from "IDX-Stock"."IDX-Schema"."stg_eltool__customers_snapshots"
    ),
     state as (
         select *
         from "IDX-Stock"."IDX-Schema"."stg_eltool__state"
     )
select c.customer_id,
       c.zipcode,
       c.city,
       c.state_code,
       s.state_name,
       c.datetime_created,
       c.datetime_updated,
       c.dbt_valid_from::TIMESTAMP as valid_from,
        CASE WHEN c.dbt_valid_to IS NULL
            THEN '9999-12-31'::TIMESTAMP
            ELSE c.dbt_valid_to::TIMESTAMP
        END as valid_to
from customers c
    join state s on c.state_code = s.state_code
  );
  
[0m19:15:38.218630 [debug] [Thread-1 (]: SQL status: SELECT 100 in 0.0 seconds
[0m19:15:38.226016 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.dim_customers"
[0m19:15:38.227029 [debug] [Thread-1 (]: On model.dbt_idx.dim_customers: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.dim_customers"} */
alter table "IDX-Stock"."IDX-Schema"."dim_customers" rename to "dim_customers__dbt_backup"
[0m19:15:38.231263 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:15:38.247216 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.dim_customers"
[0m19:15:38.248227 [debug] [Thread-1 (]: On model.dbt_idx.dim_customers: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.dim_customers"} */
alter table "IDX-Stock"."IDX-Schema"."dim_customers__dbt_tmp" rename to "dim_customers"
[0m19:15:38.252509 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:15:38.357407 [debug] [Thread-1 (]: On model.dbt_idx.dim_customers: COMMIT
[0m19:15:38.358415 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.dim_customers"
[0m19:15:38.359454 [debug] [Thread-1 (]: On model.dbt_idx.dim_customers: COMMIT
[0m19:15:38.362553 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m19:15:38.370751 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.dim_customers"
[0m19:15:38.372751 [debug] [Thread-1 (]: On model.dbt_idx.dim_customers: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.dim_customers"} */
drop table if exists "IDX-Stock"."IDX-Schema"."dim_customers__dbt_backup" cascade
[0m19:15:38.378278 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m19:15:38.383375 [debug] [Thread-1 (]: Timing info for model.dbt_idx.dim_customers (execute): 19:15:38.127825 => 19:15:38.383375
[0m19:15:38.384380 [debug] [Thread-1 (]: On model.dbt_idx.dim_customers: Close
[0m19:15:38.387368 [info ] [Thread-1 (]: 8 of 10 OK created sql table model IDX-Schema.dim_customers .................... [[32mSELECT 100[0m in 0.30s]
[0m19:15:38.390364 [debug] [Thread-1 (]: Finished running node model.dbt_idx.dim_customers
[0m19:15:38.392888 [debug] [Thread-1 (]: Began running node model.dbt_idx.dim_stocks
[0m19:15:38.396205 [info ] [Thread-1 (]: 9 of 10 START sql table model IDX-Schema.dim_stocks ............................ [RUN]
[0m19:15:38.398724 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_idx.dim_customers, now model.dbt_idx.dim_stocks)
[0m19:15:38.403263 [debug] [Thread-1 (]: Began compiling node model.dbt_idx.dim_stocks
[0m19:15:38.413891 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_idx.dim_stocks"
[0m19:15:38.479435 [debug] [Thread-1 (]: Timing info for model.dbt_idx.dim_stocks (compile): 19:15:38.405286 => 19:15:38.478434
[0m19:15:38.481440 [debug] [Thread-1 (]: Began executing node model.dbt_idx.dim_stocks
[0m19:15:38.514625 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_idx.dim_stocks"
[0m19:15:38.525878 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.dim_stocks"
[0m19:15:38.526892 [debug] [Thread-1 (]: On model.dbt_idx.dim_stocks: BEGIN
[0m19:15:38.528403 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:15:38.564011 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m19:15:38.566534 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.dim_stocks"
[0m19:15:38.568539 [debug] [Thread-1 (]: On model.dbt_idx.dim_stocks: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.dim_stocks"} */

  
    

  create  table "IDX-Stock"."IDX-Schema"."dim_stocks__dbt_tmp"
  
  
    as
  
  (
    -- noinspection SqlDialectInspectionForFile

with stock as (
    select *
    from "IDX-Stock"."IDX-Schema"."stg_eltool__stock"
    ),
     company as (
         select *
         from "IDX-Stock"."IDX-Schema"."stg_eltool__company"
     )
select a.id,
       a.ticker,
       b.name,
       a.date,
       a.open,
       a.high,
       a.low,
       a.close,
       a.volume,
       b.logo
from stock a
    join company b on a.id = b.id
  );
  
[0m19:15:38.594157 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.0 seconds
[0m19:15:38.600675 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.dim_stocks"
[0m19:15:38.602676 [debug] [Thread-1 (]: On model.dbt_idx.dim_stocks: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.dim_stocks"} */
alter table "IDX-Stock"."IDX-Schema"."dim_stocks__dbt_tmp" rename to "dim_stocks"
[0m19:15:38.605953 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:15:38.617261 [debug] [Thread-1 (]: On model.dbt_idx.dim_stocks: COMMIT
[0m19:15:38.619259 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.dim_stocks"
[0m19:15:38.622650 [debug] [Thread-1 (]: On model.dbt_idx.dim_stocks: COMMIT
[0m19:15:38.628257 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m19:15:38.636785 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.dim_stocks"
[0m19:15:38.638028 [debug] [Thread-1 (]: On model.dbt_idx.dim_stocks: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.dim_stocks"} */
drop table if exists "IDX-Stock"."IDX-Schema"."dim_stocks__dbt_backup" cascade
[0m19:15:38.641185 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m19:15:38.644028 [debug] [Thread-1 (]: Timing info for model.dbt_idx.dim_stocks (execute): 19:15:38.482959 => 19:15:38.644028
[0m19:15:38.645025 [debug] [Thread-1 (]: On model.dbt_idx.dim_stocks: Close
[0m19:15:38.648038 [info ] [Thread-1 (]: 9 of 10 OK created sql table model IDX-Schema.dim_stocks ....................... [[32mSELECT 0[0m in 0.25s]
[0m19:15:38.651600 [debug] [Thread-1 (]: Finished running node model.dbt_idx.dim_stocks
[0m19:15:38.653579 [debug] [Thread-1 (]: Began running node model.dbt_idx.customer_orders_status
[0m19:15:38.654582 [info ] [Thread-1 (]: 10 of 10 START sql view model IDX-Schema.customer_orders_status ................ [RUN]
[0m19:15:38.656587 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_idx.dim_stocks, now model.dbt_idx.customer_orders_status)
[0m19:15:38.658101 [debug] [Thread-1 (]: Began compiling node model.dbt_idx.customer_orders_status
[0m19:15:38.664904 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_idx.customer_orders_status"
[0m19:15:38.674424 [debug] [Thread-1 (]: Timing info for model.dbt_idx.customer_orders_status (compile): 19:15:38.659122 => 19:15:38.673419
[0m19:15:38.676419 [debug] [Thread-1 (]: Began executing node model.dbt_idx.customer_orders_status
[0m19:15:38.690045 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_idx.customer_orders_status"
[0m19:15:38.698594 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.customer_orders_status"
[0m19:15:38.700575 [debug] [Thread-1 (]: On model.dbt_idx.customer_orders_status: BEGIN
[0m19:15:38.702587 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:15:38.734523 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m19:15:38.735529 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.customer_orders_status"
[0m19:15:38.736523 [debug] [Thread-1 (]: On model.dbt_idx.customer_orders_status: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.customer_orders_status"} */

  create view "IDX-Stock"."IDX-Schema"."customer_orders_status__dbt_tmp"
    
    
  as (
    with orders as (select *
                from "IDX-Stock"."IDX-Schema"."fact_orders"),
     customers as (select *
                   from "IDX-Stock"."IDX-Schema"."dim_customers")
select o.order_id,
       o.customer_id,
       o.order_status,
       o.order_purchase_timestamp,
       o.order_approved_at,
       o.order_delivered_carrier_date,
       o.order_delivered_customer_date,
       o.order_estimated_delivery_date,
       c.zipcode    as customer_zipcode,
       c.city       as customer_city,
       c.state_code as customer_state_code,
       c.state_name as customer_state_name
from orders o
    join customers c on o.customer_id = c.customer_id
    and o.order_purchase_timestamp >= c.valid_from
    and o.order_purchase_timestamp <= c.valid_to
  );
[0m19:15:38.743577 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m19:15:38.752622 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.customer_orders_status"
[0m19:15:38.754628 [debug] [Thread-1 (]: On model.dbt_idx.customer_orders_status: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.customer_orders_status"} */
alter table "IDX-Stock"."IDX-Schema"."customer_orders_status__dbt_tmp" rename to "customer_orders_status"
[0m19:15:38.757158 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:15:38.761503 [debug] [Thread-1 (]: On model.dbt_idx.customer_orders_status: COMMIT
[0m19:15:38.764521 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.customer_orders_status"
[0m19:15:38.766522 [debug] [Thread-1 (]: On model.dbt_idx.customer_orders_status: COMMIT
[0m19:15:38.771523 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m19:15:38.777069 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.customer_orders_status"
[0m19:15:38.778063 [debug] [Thread-1 (]: On model.dbt_idx.customer_orders_status: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.customer_orders_status"} */
drop view if exists "IDX-Stock"."IDX-Schema"."customer_orders_status__dbt_backup" cascade
[0m19:15:38.781872 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m19:15:38.785873 [debug] [Thread-1 (]: Timing info for model.dbt_idx.customer_orders_status (execute): 19:15:38.677421 => 19:15:38.784871
[0m19:15:38.787874 [debug] [Thread-1 (]: On model.dbt_idx.customer_orders_status: Close
[0m19:15:38.791401 [info ] [Thread-1 (]: 10 of 10 OK created sql view model IDX-Schema.customer_orders_status ........... [[32mCREATE VIEW[0m in 0.13s]
[0m19:15:38.794396 [debug] [Thread-1 (]: Finished running node model.dbt_idx.customer_orders_status
[0m19:15:38.798921 [debug] [MainThread]: Using postgres connection "master"
[0m19:15:38.799923 [debug] [MainThread]: On master: BEGIN
[0m19:15:38.799923 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m19:15:38.823347 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m19:15:38.825336 [debug] [MainThread]: On master: COMMIT
[0m19:15:38.826343 [debug] [MainThread]: Using postgres connection "master"
[0m19:15:38.827343 [debug] [MainThread]: On master: COMMIT
[0m19:15:38.828347 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m19:15:38.829855 [debug] [MainThread]: On master: Close
[0m19:15:38.831866 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:15:38.832867 [debug] [MainThread]: Connection 'list_IDX-Stock' was properly closed.
[0m19:15:38.833865 [debug] [MainThread]: Connection 'list_IDX-Stock_IDX-Schema' was properly closed.
[0m19:15:38.836394 [debug] [MainThread]: Connection 'model.dbt_idx.customer_orders_status' was properly closed.
[0m19:15:38.837395 [info ] [MainThread]: 
[0m19:15:38.838396 [info ] [MainThread]: Finished running 7 view models, 3 table models in 0 hours 0 minutes and 1.78 seconds (1.78s).
[0m19:15:38.842008 [debug] [MainThread]: Command end result
[0m19:15:38.875877 [info ] [MainThread]: 
[0m19:15:38.877889 [info ] [MainThread]: [32mCompleted successfully[0m
[0m19:15:38.878897 [info ] [MainThread]: 
[0m19:15:38.880901 [info ] [MainThread]: Done. PASS=10 WARN=0 ERROR=0 SKIP=0 TOTAL=10
[0m19:15:38.882890 [debug] [MainThread]: Command `dbt run` succeeded at 19:15:38.882890 after 2.37 seconds
[0m19:15:38.883892 [debug] [MainThread]: Flushing usage events


============================== 19:16:13.075303 | b096b6af-e2f2-4367-a6a3-4c1fe6ab4305 ==============================
[0m19:16:13.075303 [info ] [MainThread]: Running with dbt=1.6.1
[0m19:16:13.080181 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'D:\\00 Project\\00 My Project\\IdeaProjects\\Py-DBT-IDX\\logs', 'debug': 'False', 'profiles_dir': 'D:\\00 Project\\00 My Project\\IdeaProjects\\Py-DBT-IDX', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt run', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'False'}
[0m19:16:13.198790 [info ] [MainThread]: Registered adapter: postgres=1.6.1
[0m19:16:13.208788 [debug] [MainThread]: checksum: efe19d9f5b93d1a98cc804fbfcdb6b3aced98b974af664946fee1cde8837deb7, vars: {}, profile: , target: , version: 1.6.1
[0m19:16:13.358566 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m19:16:13.359567 [debug] [MainThread]: Partial parsing: updated file: dbt_idx://models\marts\core\dim_stocks.sql
[0m19:16:13.464040 [info ] [MainThread]: Found 10 models, 1 snapshot, 17 tests, 5 sources, 0 exposures, 0 metrics, 349 macros, 0 groups, 0 semantic models
[0m19:16:13.467076 [info ] [MainThread]: 
[0m19:16:13.468041 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m19:16:13.472040 [debug] [ThreadPool]: Acquiring new postgres connection 'list_IDX-Stock'
[0m19:16:13.481040 [debug] [ThreadPool]: Using postgres connection "list_IDX-Stock"
[0m19:16:13.482041 [debug] [ThreadPool]: On list_IDX-Stock: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "connection_name": "list_IDX-Stock"} */

    select distinct nspname from pg_namespace
  
[0m19:16:13.483043 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:16:13.512199 [debug] [ThreadPool]: SQL status: SELECT 12 in 0.0 seconds
[0m19:16:13.514195 [debug] [ThreadPool]: On list_IDX-Stock: Close
[0m19:16:13.519194 [debug] [ThreadPool]: Acquiring new postgres connection 'list_IDX-Stock_snapshots'
[0m19:16:13.526222 [debug] [ThreadPool]: Using postgres connection "list_IDX-Stock_snapshots"
[0m19:16:13.526222 [debug] [ThreadPool]: On list_IDX-Stock_snapshots: BEGIN
[0m19:16:13.527221 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:16:13.547105 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m19:16:13.548105 [debug] [ThreadPool]: Using postgres connection "list_IDX-Stock_snapshots"
[0m19:16:13.549103 [debug] [ThreadPool]: On list_IDX-Stock_snapshots: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "connection_name": "list_IDX-Stock_snapshots"} */
select
      'IDX-Stock' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'snapshots'
    union all
    select
      'IDX-Stock' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'snapshots'
    union all
    select
      'IDX-Stock' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'snapshots'
  
[0m19:16:13.553107 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.0 seconds
[0m19:16:13.555139 [debug] [ThreadPool]: On list_IDX-Stock_snapshots: ROLLBACK
[0m19:16:13.557104 [debug] [ThreadPool]: On list_IDX-Stock_snapshots: Close
[0m19:16:13.559104 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_IDX-Stock_snapshots, now list_IDX-Stock_IDX-Schema)
[0m19:16:13.563105 [debug] [ThreadPool]: Using postgres connection "list_IDX-Stock_IDX-Schema"
[0m19:16:13.563105 [debug] [ThreadPool]: On list_IDX-Stock_IDX-Schema: BEGIN
[0m19:16:13.564104 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:16:13.584661 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m19:16:13.584661 [debug] [ThreadPool]: Using postgres connection "list_IDX-Stock_IDX-Schema"
[0m19:16:13.585672 [debug] [ThreadPool]: On list_IDX-Stock_IDX-Schema: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "connection_name": "list_IDX-Stock_IDX-Schema"} */
select
      'IDX-Stock' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'IDX-Schema'
    union all
    select
      'IDX-Stock' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'IDX-Schema'
    union all
    select
      'IDX-Stock' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'IDX-Schema'
  
[0m19:16:13.590344 [debug] [ThreadPool]: SQL status: SELECT 16 in 0.0 seconds
[0m19:16:13.592390 [debug] [ThreadPool]: On list_IDX-Stock_IDX-Schema: ROLLBACK
[0m19:16:13.594356 [debug] [ThreadPool]: On list_IDX-Stock_IDX-Schema: Close
[0m19:16:13.605391 [debug] [MainThread]: Using postgres connection "master"
[0m19:16:13.606367 [debug] [MainThread]: On master: BEGIN
[0m19:16:13.606367 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:16:13.629713 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m19:16:13.630701 [debug] [MainThread]: Using postgres connection "master"
[0m19:16:13.631699 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m19:16:13.638866 [debug] [MainThread]: SQL status: SELECT 8 in 0.0 seconds
[0m19:16:13.641912 [debug] [MainThread]: On master: ROLLBACK
[0m19:16:13.644456 [debug] [MainThread]: Using postgres connection "master"
[0m19:16:13.644456 [debug] [MainThread]: On master: BEGIN
[0m19:16:13.648458 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m19:16:13.649473 [debug] [MainThread]: On master: COMMIT
[0m19:16:13.650439 [debug] [MainThread]: Using postgres connection "master"
[0m19:16:13.650439 [debug] [MainThread]: On master: COMMIT
[0m19:16:13.652459 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m19:16:13.652459 [debug] [MainThread]: On master: Close
[0m19:16:13.654443 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m19:16:13.655437 [info ] [MainThread]: 
[0m19:16:13.661719 [debug] [Thread-1 (]: Began running node model.dbt_idx.stg_eltool__company
[0m19:16:13.662768 [info ] [Thread-1 (]: 1 of 10 START sql view model IDX-Schema.stg_eltool__company .................... [RUN]
[0m19:16:13.664767 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.dbt_idx.stg_eltool__company'
[0m19:16:13.665731 [debug] [Thread-1 (]: Began compiling node model.dbt_idx.stg_eltool__company
[0m19:16:13.673732 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_idx.stg_eltool__company"
[0m19:16:13.680205 [debug] [Thread-1 (]: Timing info for model.dbt_idx.stg_eltool__company (compile): 19:16:13.665731 => 19:16:13.679204
[0m19:16:13.680205 [debug] [Thread-1 (]: Began executing node model.dbt_idx.stg_eltool__company
[0m19:16:13.718168 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_idx.stg_eltool__company"
[0m19:16:13.724098 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__company"
[0m19:16:13.725112 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__company: BEGIN
[0m19:16:13.725112 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m19:16:13.746954 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m19:16:13.746954 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__company"
[0m19:16:13.747992 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__company: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__company"} */

  create view "IDX-Stock"."IDX-Schema"."stg_eltool__company__dbt_tmp"
    
    
  as (
    with source as (select *
                from "IDX-Stock"."IDX-Schema"."ksql-company-stream"),
     renamed as (select id,
                        ticker,
                        name,
                        logo
                 from source)
select *
from renamed
  );
[0m19:16:13.751965 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m19:16:13.757948 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__company"
[0m19:16:13.758949 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__company: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__company"} */
alter table "IDX-Stock"."IDX-Schema"."stg_eltool__company" rename to "stg_eltool__company__dbt_backup"
[0m19:16:13.761699 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:16:13.764709 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__company"
[0m19:16:13.765709 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__company: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__company"} */
alter table "IDX-Stock"."IDX-Schema"."stg_eltool__company__dbt_tmp" rename to "stg_eltool__company"
[0m19:16:13.767710 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:16:13.784709 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__company: COMMIT
[0m19:16:13.785709 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__company"
[0m19:16:13.785709 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__company: COMMIT
[0m19:16:13.789952 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m19:16:13.797997 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__company"
[0m19:16:13.798989 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__company: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__company"} */
drop view if exists "IDX-Stock"."IDX-Schema"."stg_eltool__company__dbt_backup" cascade
[0m19:16:13.802963 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m19:16:13.804963 [debug] [Thread-1 (]: Timing info for model.dbt_idx.stg_eltool__company (execute): 19:16:13.681203 => 19:16:13.803963
[0m19:16:13.804963 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__company: Close
[0m19:16:13.806963 [info ] [Thread-1 (]: 1 of 10 OK created sql view model IDX-Schema.stg_eltool__company ............... [[32mCREATE VIEW[0m in 0.14s]
[0m19:16:13.808967 [debug] [Thread-1 (]: Finished running node model.dbt_idx.stg_eltool__company
[0m19:16:13.810980 [debug] [Thread-1 (]: Began running node model.dbt_idx.stg_eltool__customers
[0m19:16:13.811968 [info ] [Thread-1 (]: 2 of 10 START sql view model IDX-Schema.stg_eltool__customers .................. [RUN]
[0m19:16:13.814006 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_idx.stg_eltool__company, now model.dbt_idx.stg_eltool__customers)
[0m19:16:13.814995 [debug] [Thread-1 (]: Began compiling node model.dbt_idx.stg_eltool__customers
[0m19:16:13.817966 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_idx.stg_eltool__customers"
[0m19:16:13.823964 [debug] [Thread-1 (]: Timing info for model.dbt_idx.stg_eltool__customers (compile): 19:16:13.814995 => 19:16:13.823964
[0m19:16:13.824963 [debug] [Thread-1 (]: Began executing node model.dbt_idx.stg_eltool__customers
[0m19:16:13.830968 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_idx.stg_eltool__customers"
[0m19:16:13.836624 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__customers"
[0m19:16:13.837588 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__customers: BEGIN
[0m19:16:13.838643 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:16:13.862073 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m19:16:13.863084 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__customers"
[0m19:16:13.863084 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__customers: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__customers"} */

  create view "IDX-Stock"."IDX-Schema"."stg_eltool__customers__dbt_tmp"
    
    
  as (
    with source as (select *
                from "IDX-Stock"."IDX-Schema"."customers"),
     renamed as (select
                     customer_id,
                    'This is Dummy' as dummy
                 from source
                 where customer_id = 1234567890)
select *
from renamed
  );
[0m19:16:13.866552 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m19:16:13.870600 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__customers"
[0m19:16:13.871581 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__customers: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__customers"} */
alter table "IDX-Stock"."IDX-Schema"."stg_eltool__customers" rename to "stg_eltool__customers__dbt_backup"
[0m19:16:13.873589 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:16:13.877567 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__customers"
[0m19:16:13.877567 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__customers: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__customers"} */
alter table "IDX-Stock"."IDX-Schema"."stg_eltool__customers__dbt_tmp" rename to "stg_eltool__customers"
[0m19:16:13.880562 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:16:13.882566 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__customers: COMMIT
[0m19:16:13.883564 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__customers"
[0m19:16:13.883564 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__customers: COMMIT
[0m19:16:13.887388 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m19:16:13.890437 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__customers"
[0m19:16:13.891434 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__customers: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__customers"} */
drop view if exists "IDX-Stock"."IDX-Schema"."stg_eltool__customers__dbt_backup" cascade
[0m19:16:13.895071 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m19:16:13.897094 [debug] [Thread-1 (]: Timing info for model.dbt_idx.stg_eltool__customers (execute): 19:16:13.825961 => 19:16:13.897094
[0m19:16:13.898095 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__customers: Close
[0m19:16:13.900086 [info ] [Thread-1 (]: 2 of 10 OK created sql view model IDX-Schema.stg_eltool__customers ............. [[32mCREATE VIEW[0m in 0.09s]
[0m19:16:13.901087 [debug] [Thread-1 (]: Finished running node model.dbt_idx.stg_eltool__customers
[0m19:16:13.902074 [debug] [Thread-1 (]: Began running node model.dbt_idx.stg_eltool__customers_snapshots
[0m19:16:13.904106 [info ] [Thread-1 (]: 3 of 10 START sql view model IDX-Schema.stg_eltool__customers_snapshots ........ [RUN]
[0m19:16:13.905070 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_idx.stg_eltool__customers, now model.dbt_idx.stg_eltool__customers_snapshots)
[0m19:16:13.906069 [debug] [Thread-1 (]: Began compiling node model.dbt_idx.stg_eltool__customers_snapshots
[0m19:16:13.909070 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_idx.stg_eltool__customers_snapshots"
[0m19:16:13.914070 [debug] [Thread-1 (]: Timing info for model.dbt_idx.stg_eltool__customers_snapshots (compile): 19:16:13.906069 => 19:16:13.914070
[0m19:16:13.915107 [debug] [Thread-1 (]: Began executing node model.dbt_idx.stg_eltool__customers_snapshots
[0m19:16:13.922106 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_idx.stg_eltool__customers_snapshots"
[0m19:16:13.928071 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__customers_snapshots"
[0m19:16:13.929112 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__customers_snapshots: BEGIN
[0m19:16:13.930077 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:16:13.951763 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m19:16:13.952714 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__customers_snapshots"
[0m19:16:13.953708 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__customers_snapshots: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__customers_snapshots"} */

  create view "IDX-Stock"."IDX-Schema"."stg_eltool__customers_snapshots__dbt_tmp"
    
    
  as (
    with source as (select *
                from "IDX-Stock"."snapshots"."customers_snapshot"),
     renamed as (select customer_id,
                        zipcode,
                        city,
                        state_code,
                        datetime_created::TIMESTAMP AS datetime_created,
                        datetime_updated::TIMESTAMP AS datetime_updated,
                        dbt_valid_from,
                        dbt_valid_to
                 from source)
select *
from renamed
  );
[0m19:16:13.958166 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m19:16:13.961144 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__customers_snapshots"
[0m19:16:13.962144 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__customers_snapshots: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__customers_snapshots"} */
alter table "IDX-Stock"."IDX-Schema"."stg_eltool__customers_snapshots" rename to "stg_eltool__customers_snapshots__dbt_backup"
[0m19:16:13.964145 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:16:13.968144 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__customers_snapshots"
[0m19:16:13.968144 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__customers_snapshots: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__customers_snapshots"} */
alter table "IDX-Stock"."IDX-Schema"."stg_eltool__customers_snapshots__dbt_tmp" rename to "stg_eltool__customers_snapshots"
[0m19:16:13.970666 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:16:13.972676 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__customers_snapshots: COMMIT
[0m19:16:13.973678 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__customers_snapshots"
[0m19:16:13.974640 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__customers_snapshots: COMMIT
[0m19:16:13.977659 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m19:16:13.980645 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__customers_snapshots"
[0m19:16:13.981676 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__customers_snapshots: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__customers_snapshots"} */
drop view if exists "IDX-Stock"."IDX-Schema"."stg_eltool__customers_snapshots__dbt_backup" cascade
[0m19:16:13.985641 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m19:16:13.987661 [debug] [Thread-1 (]: Timing info for model.dbt_idx.stg_eltool__customers_snapshots (execute): 19:16:13.916108 => 19:16:13.987661
[0m19:16:13.988668 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__customers_snapshots: Close
[0m19:16:13.990646 [info ] [Thread-1 (]: 3 of 10 OK created sql view model IDX-Schema.stg_eltool__customers_snapshots ... [[32mCREATE VIEW[0m in 0.08s]
[0m19:16:13.991643 [debug] [Thread-1 (]: Finished running node model.dbt_idx.stg_eltool__customers_snapshots
[0m19:16:13.993644 [debug] [Thread-1 (]: Began running node model.dbt_idx.stg_eltool__orders
[0m19:16:13.993644 [info ] [Thread-1 (]: 4 of 10 START sql view model IDX-Schema.stg_eltool__orders ..................... [RUN]
[0m19:16:13.994673 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_idx.stg_eltool__customers_snapshots, now model.dbt_idx.stg_eltool__orders)
[0m19:16:13.995666 [debug] [Thread-1 (]: Began compiling node model.dbt_idx.stg_eltool__orders
[0m19:16:13.998669 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_idx.stg_eltool__orders"
[0m19:16:14.008675 [debug] [Thread-1 (]: Timing info for model.dbt_idx.stg_eltool__orders (compile): 19:16:13.996649 => 19:16:14.008675
[0m19:16:14.009640 [debug] [Thread-1 (]: Began executing node model.dbt_idx.stg_eltool__orders
[0m19:16:14.014705 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_idx.stg_eltool__orders"
[0m19:16:14.028644 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__orders"
[0m19:16:14.029666 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__orders: BEGIN
[0m19:16:14.030651 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:16:14.052065 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m19:16:14.053065 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__orders"
[0m19:16:14.054073 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__orders: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__orders"} */

  create view "IDX-Stock"."IDX-Schema"."stg_eltool__orders__dbt_tmp"
    
    
  as (
    with source as (select *
                from "IDX-Stock"."IDX-Schema"."orders"),
     renamed as (select order_id,
                        cust_id AS customer_id,
                        order_status,
                        order_purchase_timestamp::TIMESTAMP,
                        order_approved_at::TIMESTAMP,
                        order_delivered_carrier_date::TIMESTAMP,
                        order_delivered_customer_date::TIMESTAMP,
                        order_estimated_delivery_date::TIMESTAMP
                 from source)
select *
from renamed
  );
[0m19:16:14.058103 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m19:16:14.063066 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__orders"
[0m19:16:14.063066 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__orders: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__orders"} */
alter table "IDX-Stock"."IDX-Schema"."stg_eltool__orders" rename to "stg_eltool__orders__dbt_backup"
[0m19:16:14.066068 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:16:14.071078 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__orders"
[0m19:16:14.072067 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__orders: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__orders"} */
alter table "IDX-Stock"."IDX-Schema"."stg_eltool__orders__dbt_tmp" rename to "stg_eltool__orders"
[0m19:16:14.075083 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:16:14.078089 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__orders: COMMIT
[0m19:16:14.079103 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__orders"
[0m19:16:14.079103 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__orders: COMMIT
[0m19:16:14.082237 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m19:16:14.086249 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__orders"
[0m19:16:14.088249 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__orders: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__orders"} */
drop view if exists "IDX-Stock"."IDX-Schema"."stg_eltool__orders__dbt_backup" cascade
[0m19:16:14.092248 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m19:16:14.094248 [debug] [Thread-1 (]: Timing info for model.dbt_idx.stg_eltool__orders (execute): 19:16:14.009640 => 19:16:14.094248
[0m19:16:14.095249 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__orders: Close
[0m19:16:14.097249 [info ] [Thread-1 (]: 4 of 10 OK created sql view model IDX-Schema.stg_eltool__orders ................ [[32mCREATE VIEW[0m in 0.10s]
[0m19:16:14.098252 [debug] [Thread-1 (]: Finished running node model.dbt_idx.stg_eltool__orders
[0m19:16:14.099248 [debug] [Thread-1 (]: Began running node model.dbt_idx.stg_eltool__state
[0m19:16:14.101248 [info ] [Thread-1 (]: 5 of 10 START sql view model IDX-Schema.stg_eltool__state ...................... [RUN]
[0m19:16:14.102249 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_idx.stg_eltool__orders, now model.dbt_idx.stg_eltool__state)
[0m19:16:14.103272 [debug] [Thread-1 (]: Began compiling node model.dbt_idx.stg_eltool__state
[0m19:16:14.107282 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_idx.stg_eltool__state"
[0m19:16:14.114248 [debug] [Thread-1 (]: Timing info for model.dbt_idx.stg_eltool__state (compile): 19:16:14.104267 => 19:16:14.113249
[0m19:16:14.115250 [debug] [Thread-1 (]: Began executing node model.dbt_idx.stg_eltool__state
[0m19:16:14.123259 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_idx.stg_eltool__state"
[0m19:16:14.130259 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__state"
[0m19:16:14.131254 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__state: BEGIN
[0m19:16:14.131254 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:16:14.155779 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m19:16:14.156807 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__state"
[0m19:16:14.157783 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__state: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__state"} */

  create view "IDX-Stock"."IDX-Schema"."stg_eltool__state__dbt_tmp"
    
    
  as (
    with source as (select *
                from "IDX-Stock"."IDX-Schema"."state"),
     renamed as (select state_identifier::INT AS state_id,
                         state_code::VARCHAR(2) AS state_code,
                         st_name::VARCHAR(30) AS state_name
                 from source)
select *
from renamed
  );
[0m19:16:14.160783 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m19:16:14.164796 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__state"
[0m19:16:14.165768 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__state: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__state"} */
alter table "IDX-Stock"."IDX-Schema"."stg_eltool__state" rename to "stg_eltool__state__dbt_backup"
[0m19:16:14.167766 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:16:14.172803 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__state"
[0m19:16:14.172803 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__state: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__state"} */
alter table "IDX-Stock"."IDX-Schema"."stg_eltool__state__dbt_tmp" rename to "stg_eltool__state"
[0m19:16:14.175766 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:16:14.178803 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__state: COMMIT
[0m19:16:14.179773 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__state"
[0m19:16:14.180767 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__state: COMMIT
[0m19:16:14.183544 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m19:16:14.187544 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__state"
[0m19:16:14.187544 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__state: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__state"} */
drop view if exists "IDX-Stock"."IDX-Schema"."stg_eltool__state__dbt_backup" cascade
[0m19:16:14.191544 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m19:16:14.193574 [debug] [Thread-1 (]: Timing info for model.dbt_idx.stg_eltool__state (execute): 19:16:14.116250 => 19:16:14.193574
[0m19:16:14.194553 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__state: Close
[0m19:16:14.196554 [info ] [Thread-1 (]: 5 of 10 OK created sql view model IDX-Schema.stg_eltool__state ................. [[32mCREATE VIEW[0m in 0.09s]
[0m19:16:14.198542 [debug] [Thread-1 (]: Finished running node model.dbt_idx.stg_eltool__state
[0m19:16:14.199542 [debug] [Thread-1 (]: Began running node model.dbt_idx.stg_eltool__stock
[0m19:16:14.200562 [info ] [Thread-1 (]: 6 of 10 START sql view model IDX-Schema.stg_eltool__stock ...................... [RUN]
[0m19:16:14.202564 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_idx.stg_eltool__state, now model.dbt_idx.stg_eltool__stock)
[0m19:16:14.203543 [debug] [Thread-1 (]: Began compiling node model.dbt_idx.stg_eltool__stock
[0m19:16:14.208576 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_idx.stg_eltool__stock"
[0m19:16:14.214571 [debug] [Thread-1 (]: Timing info for model.dbt_idx.stg_eltool__stock (compile): 19:16:14.203543 => 19:16:14.214571
[0m19:16:14.216541 [debug] [Thread-1 (]: Began executing node model.dbt_idx.stg_eltool__stock
[0m19:16:14.225556 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_idx.stg_eltool__stock"
[0m19:16:14.233549 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__stock"
[0m19:16:14.233549 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__stock: BEGIN
[0m19:16:14.234575 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:16:14.259068 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m19:16:14.261079 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__stock"
[0m19:16:14.262065 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__stock: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__stock"} */

  create view "IDX-Stock"."IDX-Schema"."stg_eltool__stock__dbt_tmp"
    
    
  as (
    with source as (select *
                from "IDX-Stock"."IDX-Schema"."ksql-stock-stream"),
     renamed as (select *
                 from source)
select *
from renamed
  );
[0m19:16:14.266066 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m19:16:14.272065 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__stock"
[0m19:16:14.273071 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__stock: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__stock"} */
alter table "IDX-Stock"."IDX-Schema"."stg_eltool__stock" rename to "stg_eltool__stock__dbt_backup"
[0m19:16:14.276095 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:16:14.281099 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__stock"
[0m19:16:14.282065 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__stock: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__stock"} */
alter table "IDX-Stock"."IDX-Schema"."stg_eltool__stock__dbt_tmp" rename to "stg_eltool__stock"
[0m19:16:14.285074 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:16:14.288067 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__stock: COMMIT
[0m19:16:14.290068 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__stock"
[0m19:16:14.291064 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__stock: COMMIT
[0m19:16:14.295219 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m19:16:14.300225 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__stock"
[0m19:16:14.301230 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__stock: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__stock"} */
drop view if exists "IDX-Stock"."IDX-Schema"."stg_eltool__stock__dbt_backup" cascade
[0m19:16:14.305522 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m19:16:14.308545 [debug] [Thread-1 (]: Timing info for model.dbt_idx.stg_eltool__stock (execute): 19:16:14.217548 => 19:16:14.307527
[0m19:16:14.308545 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__stock: Close
[0m19:16:14.310521 [info ] [Thread-1 (]: 6 of 10 OK created sql view model IDX-Schema.stg_eltool__stock ................. [[32mCREATE VIEW[0m in 0.11s]
[0m19:16:14.313528 [debug] [Thread-1 (]: Finished running node model.dbt_idx.stg_eltool__stock
[0m19:16:14.315526 [debug] [Thread-1 (]: Began running node model.dbt_idx.fact_orders
[0m19:16:14.316524 [info ] [Thread-1 (]: 7 of 10 START sql table model IDX-Schema.fact_orders ........................... [RUN]
[0m19:16:14.317526 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_idx.stg_eltool__stock, now model.dbt_idx.fact_orders)
[0m19:16:14.318522 [debug] [Thread-1 (]: Began compiling node model.dbt_idx.fact_orders
[0m19:16:14.322522 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_idx.fact_orders"
[0m19:16:14.329630 [debug] [Thread-1 (]: Timing info for model.dbt_idx.fact_orders (compile): 19:16:14.319521 => 19:16:14.329630
[0m19:16:14.330608 [debug] [Thread-1 (]: Began executing node model.dbt_idx.fact_orders
[0m19:16:14.363191 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_idx.fact_orders"
[0m19:16:14.371195 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.fact_orders"
[0m19:16:14.372194 [debug] [Thread-1 (]: On model.dbt_idx.fact_orders: BEGIN
[0m19:16:14.373198 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:16:14.399212 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m19:16:14.400202 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.fact_orders"
[0m19:16:14.401195 [debug] [Thread-1 (]: On model.dbt_idx.fact_orders: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.fact_orders"} */

  
    

  create  table "IDX-Stock"."IDX-Schema"."fact_orders__dbt_tmp"
  
  
    as
  
  (
    with orders as (
    select *
    from "IDX-Stock"."IDX-Schema"."stg_eltool__orders"
)
select * from orders
  );
  
[0m19:16:14.411230 [debug] [Thread-1 (]: SQL status: SELECT 999 in 0.0 seconds
[0m19:16:14.417742 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.fact_orders"
[0m19:16:14.418746 [debug] [Thread-1 (]: On model.dbt_idx.fact_orders: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.fact_orders"} */
alter table "IDX-Stock"."IDX-Schema"."fact_orders" rename to "fact_orders__dbt_backup"
[0m19:16:14.422742 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:16:14.427741 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.fact_orders"
[0m19:16:14.428755 [debug] [Thread-1 (]: On model.dbt_idx.fact_orders: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.fact_orders"} */
alter table "IDX-Stock"."IDX-Schema"."fact_orders__dbt_tmp" rename to "fact_orders"
[0m19:16:14.431770 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:16:14.441315 [debug] [Thread-1 (]: On model.dbt_idx.fact_orders: COMMIT
[0m19:16:14.442325 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.fact_orders"
[0m19:16:14.443317 [debug] [Thread-1 (]: On model.dbt_idx.fact_orders: COMMIT
[0m19:16:14.446834 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m19:16:14.453850 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.fact_orders"
[0m19:16:14.454833 [debug] [Thread-1 (]: On model.dbt_idx.fact_orders: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.fact_orders"} */
drop table if exists "IDX-Stock"."IDX-Schema"."fact_orders__dbt_backup" cascade
[0m19:16:14.459987 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m19:16:14.461983 [debug] [Thread-1 (]: Timing info for model.dbt_idx.fact_orders (execute): 19:16:14.332574 => 19:16:14.461983
[0m19:16:14.462982 [debug] [Thread-1 (]: On model.dbt_idx.fact_orders: Close
[0m19:16:14.465991 [info ] [Thread-1 (]: 7 of 10 OK created sql table model IDX-Schema.fact_orders ...................... [[32mSELECT 999[0m in 0.15s]
[0m19:16:14.467987 [debug] [Thread-1 (]: Finished running node model.dbt_idx.fact_orders
[0m19:16:14.468999 [debug] [Thread-1 (]: Began running node model.dbt_idx.dim_customers
[0m19:16:14.470983 [info ] [Thread-1 (]: 8 of 10 START sql table model IDX-Schema.dim_customers ......................... [RUN]
[0m19:16:14.472988 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_idx.fact_orders, now model.dbt_idx.dim_customers)
[0m19:16:14.473991 [debug] [Thread-1 (]: Began compiling node model.dbt_idx.dim_customers
[0m19:16:14.477985 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_idx.dim_customers"
[0m19:16:14.484011 [debug] [Thread-1 (]: Timing info for model.dbt_idx.dim_customers (compile): 19:16:14.473991 => 19:16:14.484011
[0m19:16:14.485015 [debug] [Thread-1 (]: Began executing node model.dbt_idx.dim_customers
[0m19:16:14.491018 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_idx.dim_customers"
[0m19:16:14.497986 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.dim_customers"
[0m19:16:14.498984 [debug] [Thread-1 (]: On model.dbt_idx.dim_customers: BEGIN
[0m19:16:14.499987 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:16:14.527006 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m19:16:14.527986 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.dim_customers"
[0m19:16:14.528985 [debug] [Thread-1 (]: On model.dbt_idx.dim_customers: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.dim_customers"} */

  
    

  create  table "IDX-Stock"."IDX-Schema"."dim_customers__dbt_tmp"
  
  
    as
  
  (
    -- noinspection SqlDialectInspectionForFile

with customers as (
    select *
    from "IDX-Stock"."IDX-Schema"."stg_eltool__customers_snapshots"
    ),
     state as (
         select *
         from "IDX-Stock"."IDX-Schema"."stg_eltool__state"
     )
select c.customer_id,
       c.zipcode,
       c.city,
       c.state_code,
       s.state_name,
       c.datetime_created,
       c.datetime_updated,
       c.dbt_valid_from::TIMESTAMP as valid_from,
        CASE WHEN c.dbt_valid_to IS NULL
            THEN '9999-12-31'::TIMESTAMP
            ELSE c.dbt_valid_to::TIMESTAMP
        END as valid_to
from customers c
    join state s on c.state_code = s.state_code
  );
  
[0m19:16:14.534996 [debug] [Thread-1 (]: SQL status: SELECT 100 in 0.0 seconds
[0m19:16:14.540994 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.dim_customers"
[0m19:16:14.541991 [debug] [Thread-1 (]: On model.dbt_idx.dim_customers: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.dim_customers"} */
alter table "IDX-Stock"."IDX-Schema"."dim_customers" rename to "dim_customers__dbt_backup"
[0m19:16:14.544502 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:16:14.553509 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.dim_customers"
[0m19:16:14.554510 [debug] [Thread-1 (]: On model.dbt_idx.dim_customers: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.dim_customers"} */
alter table "IDX-Stock"."IDX-Schema"."dim_customers__dbt_tmp" rename to "dim_customers"
[0m19:16:14.557514 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:16:14.610509 [debug] [Thread-1 (]: On model.dbt_idx.dim_customers: COMMIT
[0m19:16:14.611515 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.dim_customers"
[0m19:16:14.612514 [debug] [Thread-1 (]: On model.dbt_idx.dim_customers: COMMIT
[0m19:16:14.615508 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m19:16:14.621509 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.dim_customers"
[0m19:16:14.622513 [debug] [Thread-1 (]: On model.dbt_idx.dim_customers: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.dim_customers"} */
drop table if exists "IDX-Stock"."IDX-Schema"."dim_customers__dbt_backup" cascade
[0m19:16:14.626508 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m19:16:14.629510 [debug] [Thread-1 (]: Timing info for model.dbt_idx.dim_customers (execute): 19:16:14.485985 => 19:16:14.629510
[0m19:16:14.630517 [debug] [Thread-1 (]: On model.dbt_idx.dim_customers: Close
[0m19:16:14.632518 [info ] [Thread-1 (]: 8 of 10 OK created sql table model IDX-Schema.dim_customers .................... [[32mSELECT 100[0m in 0.16s]
[0m19:16:14.634517 [debug] [Thread-1 (]: Finished running node model.dbt_idx.dim_customers
[0m19:16:14.636520 [debug] [Thread-1 (]: Began running node model.dbt_idx.dim_stocks
[0m19:16:14.637521 [info ] [Thread-1 (]: 9 of 10 START sql table model IDX-Schema.dim_stocks ............................ [RUN]
[0m19:16:14.639518 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_idx.dim_customers, now model.dbt_idx.dim_stocks)
[0m19:16:14.640516 [debug] [Thread-1 (]: Began compiling node model.dbt_idx.dim_stocks
[0m19:16:14.644531 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_idx.dim_stocks"
[0m19:16:14.651656 [debug] [Thread-1 (]: Timing info for model.dbt_idx.dim_stocks (compile): 19:16:14.640516 => 19:16:14.650656
[0m19:16:14.652659 [debug] [Thread-1 (]: Began executing node model.dbt_idx.dim_stocks
[0m19:16:14.660652 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_idx.dim_stocks"
[0m19:16:14.667665 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.dim_stocks"
[0m19:16:14.670095 [debug] [Thread-1 (]: On model.dbt_idx.dim_stocks: BEGIN
[0m19:16:14.671807 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:16:14.699438 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m19:16:14.701435 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.dim_stocks"
[0m19:16:14.702447 [debug] [Thread-1 (]: On model.dbt_idx.dim_stocks: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.dim_stocks"} */

  
    

  create  table "IDX-Stock"."IDX-Schema"."dim_stocks__dbt_tmp"
  
  
    as
  
  (
    -- noinspection SqlDialectInspectionForFile

with stock as (
    select *
    from "IDX-Stock"."IDX-Schema"."stg_eltool__stock"
    ),
     company as (
         select *
         from "IDX-Stock"."IDX-Schema"."stg_eltool__company"
     )
select a.id,
       a.ticker,
       b.name,
       a.date,
       a.open,
       a.high,
       a.low,
       a.close,
       a.volume,
       b.logo
from stock a
    join company b on a.ticker = b.ticker
  );
  
[0m19:16:14.789330 [debug] [Thread-1 (]: SQL status: SELECT 26131 in 0.0 seconds
[0m19:16:14.795461 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.dim_stocks"
[0m19:16:14.797457 [debug] [Thread-1 (]: On model.dbt_idx.dim_stocks: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.dim_stocks"} */
alter table "IDX-Stock"."IDX-Schema"."dim_stocks" rename to "dim_stocks__dbt_backup"
[0m19:16:14.800456 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:16:14.804456 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.dim_stocks"
[0m19:16:14.805455 [debug] [Thread-1 (]: On model.dbt_idx.dim_stocks: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.dim_stocks"} */
alter table "IDX-Stock"."IDX-Schema"."dim_stocks__dbt_tmp" rename to "dim_stocks"
[0m19:16:14.808476 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:16:14.812455 [debug] [Thread-1 (]: On model.dbt_idx.dim_stocks: COMMIT
[0m19:16:14.813454 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.dim_stocks"
[0m19:16:14.814457 [debug] [Thread-1 (]: On model.dbt_idx.dim_stocks: COMMIT
[0m19:16:14.825455 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m19:16:14.831466 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.dim_stocks"
[0m19:16:14.832470 [debug] [Thread-1 (]: On model.dbt_idx.dim_stocks: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.dim_stocks"} */
drop table if exists "IDX-Stock"."IDX-Schema"."dim_stocks__dbt_backup" cascade
[0m19:16:14.838460 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m19:16:14.841463 [debug] [Thread-1 (]: Timing info for model.dbt_idx.dim_stocks (execute): 19:16:14.653652 => 19:16:14.840466
[0m19:16:14.842465 [debug] [Thread-1 (]: On model.dbt_idx.dim_stocks: Close
[0m19:16:14.844987 [info ] [Thread-1 (]: 9 of 10 OK created sql table model IDX-Schema.dim_stocks ....................... [[32mSELECT 26131[0m in 0.21s]
[0m19:16:14.847998 [debug] [Thread-1 (]: Finished running node model.dbt_idx.dim_stocks
[0m19:16:14.849001 [debug] [Thread-1 (]: Began running node model.dbt_idx.customer_orders_status
[0m19:16:14.851020 [info ] [Thread-1 (]: 10 of 10 START sql view model IDX-Schema.customer_orders_status ................ [RUN]
[0m19:16:14.854001 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_idx.dim_stocks, now model.dbt_idx.customer_orders_status)
[0m19:16:14.855995 [debug] [Thread-1 (]: Began compiling node model.dbt_idx.customer_orders_status
[0m19:16:14.865000 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_idx.customer_orders_status"
[0m19:16:14.874001 [debug] [Thread-1 (]: Timing info for model.dbt_idx.customer_orders_status (compile): 19:16:14.856998 => 19:16:14.873001
[0m19:16:14.875997 [debug] [Thread-1 (]: Began executing node model.dbt_idx.customer_orders_status
[0m19:16:14.882007 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_idx.customer_orders_status"
[0m19:16:14.889010 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.customer_orders_status"
[0m19:16:14.889999 [debug] [Thread-1 (]: On model.dbt_idx.customer_orders_status: BEGIN
[0m19:16:14.891016 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:16:14.911995 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m19:16:14.913028 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.customer_orders_status"
[0m19:16:14.913994 [debug] [Thread-1 (]: On model.dbt_idx.customer_orders_status: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.customer_orders_status"} */

  create view "IDX-Stock"."IDX-Schema"."customer_orders_status__dbt_tmp"
    
    
  as (
    with orders as (select *
                from "IDX-Stock"."IDX-Schema"."fact_orders"),
     customers as (select *
                   from "IDX-Stock"."IDX-Schema"."dim_customers")
select o.order_id,
       o.customer_id,
       o.order_status,
       o.order_purchase_timestamp,
       o.order_approved_at,
       o.order_delivered_carrier_date,
       o.order_delivered_customer_date,
       o.order_estimated_delivery_date,
       c.zipcode    as customer_zipcode,
       c.city       as customer_city,
       c.state_code as customer_state_code,
       c.state_name as customer_state_name
from orders o
    join customers c on o.customer_id = c.customer_id
    and o.order_purchase_timestamp >= c.valid_from
    and o.order_purchase_timestamp <= c.valid_to
  );
[0m19:16:14.917998 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m19:16:14.921030 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.customer_orders_status"
[0m19:16:14.922025 [debug] [Thread-1 (]: On model.dbt_idx.customer_orders_status: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.customer_orders_status"} */
alter table "IDX-Stock"."IDX-Schema"."customer_orders_status__dbt_tmp" rename to "customer_orders_status"
[0m19:16:14.926839 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:16:14.932238 [debug] [Thread-1 (]: On model.dbt_idx.customer_orders_status: COMMIT
[0m19:16:14.933844 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.customer_orders_status"
[0m19:16:14.935511 [debug] [Thread-1 (]: On model.dbt_idx.customer_orders_status: COMMIT
[0m19:16:14.940604 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m19:16:14.945419 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.customer_orders_status"
[0m19:16:14.946483 [debug] [Thread-1 (]: On model.dbt_idx.customer_orders_status: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.customer_orders_status"} */
drop view if exists "IDX-Stock"."IDX-Schema"."customer_orders_status__dbt_backup" cascade
[0m19:16:14.949186 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m19:16:14.951540 [debug] [Thread-1 (]: Timing info for model.dbt_idx.customer_orders_status (execute): 19:16:14.877012 => 19:16:14.951540
[0m19:16:14.952552 [debug] [Thread-1 (]: On model.dbt_idx.customer_orders_status: Close
[0m19:16:14.954553 [info ] [Thread-1 (]: 10 of 10 OK created sql view model IDX-Schema.customer_orders_status ........... [[32mCREATE VIEW[0m in 0.10s]
[0m19:16:14.956569 [debug] [Thread-1 (]: Finished running node model.dbt_idx.customer_orders_status
[0m19:16:14.959578 [debug] [MainThread]: Using postgres connection "master"
[0m19:16:14.960549 [debug] [MainThread]: On master: BEGIN
[0m19:16:14.960549 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m19:16:15.056027 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m19:16:15.057034 [debug] [MainThread]: On master: COMMIT
[0m19:16:15.058049 [debug] [MainThread]: Using postgres connection "master"
[0m19:16:15.059085 [debug] [MainThread]: On master: COMMIT
[0m19:16:15.061040 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m19:16:15.062035 [debug] [MainThread]: On master: Close
[0m19:16:15.064041 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:16:15.065041 [debug] [MainThread]: Connection 'list_IDX-Stock' was properly closed.
[0m19:16:15.067044 [debug] [MainThread]: Connection 'list_IDX-Stock_IDX-Schema' was properly closed.
[0m19:16:15.068055 [debug] [MainThread]: Connection 'model.dbt_idx.customer_orders_status' was properly closed.
[0m19:16:15.068902 [info ] [MainThread]: 
[0m19:16:15.069925 [info ] [MainThread]: Finished running 7 view models, 3 table models in 0 hours 0 minutes and 1.60 seconds (1.60s).
[0m19:16:15.072911 [debug] [MainThread]: Command end result
[0m19:16:15.110960 [info ] [MainThread]: 
[0m19:16:15.112944 [info ] [MainThread]: [32mCompleted successfully[0m
[0m19:16:15.113566 [info ] [MainThread]: 
[0m19:16:15.114578 [info ] [MainThread]: Done. PASS=10 WARN=0 ERROR=0 SKIP=0 TOTAL=10
[0m19:16:15.116578 [debug] [MainThread]: Command `dbt run` succeeded at 19:16:15.116578 after 2.08 seconds
[0m19:16:15.117582 [debug] [MainThread]: Flushing usage events


============================== 19:19:22.786732 | e376767b-9403-406a-902d-ab0b12193d8e ==============================
[0m19:19:22.786732 [info ] [MainThread]: Running with dbt=1.6.1
[0m19:19:22.794538 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'D:\\00 Project\\00 My Project\\IdeaProjects\\Py-DBT-IDX\\logs', 'profiles_dir': 'D:\\00 Project\\00 My Project\\IdeaProjects\\Py-DBT-IDX', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'False'}
[0m19:19:22.974288 [info ] [MainThread]: Registered adapter: postgres=1.6.1
[0m19:19:22.993649 [debug] [MainThread]: checksum: efe19d9f5b93d1a98cc804fbfcdb6b3aced98b974af664946fee1cde8837deb7, vars: {}, profile: , target: , version: 1.6.1
[0m19:19:23.198032 [debug] [MainThread]: Partial parsing enabled: 1 files deleted, 3 files added, 1 files changed.
[0m19:19:23.199061 [debug] [MainThread]: Partial parsing: added file: dbt_idx://models\marts\stock\stock.yml
[0m19:19:23.200043 [debug] [MainThread]: Partial parsing: added file: dbt_idx://models\marts\stock\stock_update_status.sql
[0m19:19:23.201038 [debug] [MainThread]: Partial parsing: added file: dbt_idx://models\marts\core\fact_stocks.sql
[0m19:19:23.202604 [debug] [MainThread]: Partial parsing: updated file: dbt_idx://models\marts\core\core.yml
[0m19:19:23.203567 [debug] [MainThread]: Partial parsing: deleted file: dbt_idx://models\marts\core\dim_stocks.sql
[0m19:19:23.347641 [info ] [MainThread]: Found 11 models, 1 snapshot, 18 tests, 5 sources, 0 exposures, 0 metrics, 349 macros, 0 groups, 0 semantic models
[0m19:19:23.351675 [info ] [MainThread]: 
[0m19:19:23.352653 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m19:19:23.354499 [debug] [ThreadPool]: Acquiring new postgres connection 'list_IDX-Stock'
[0m19:19:23.365016 [debug] [ThreadPool]: Using postgres connection "list_IDX-Stock"
[0m19:19:23.366016 [debug] [ThreadPool]: On list_IDX-Stock: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "connection_name": "list_IDX-Stock"} */

    select distinct nspname from pg_namespace
  
[0m19:19:23.367015 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:19:23.396394 [debug] [ThreadPool]: SQL status: SELECT 12 in 0.0 seconds
[0m19:19:23.398430 [debug] [ThreadPool]: On list_IDX-Stock: Close
[0m19:19:23.401431 [debug] [ThreadPool]: Acquiring new postgres connection 'list_IDX-Stock_IDX-Schema'
[0m19:19:23.409394 [debug] [ThreadPool]: Using postgres connection "list_IDX-Stock_IDX-Schema"
[0m19:19:23.410417 [debug] [ThreadPool]: On list_IDX-Stock_IDX-Schema: BEGIN
[0m19:19:23.411395 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:19:23.432283 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m19:19:23.432283 [debug] [ThreadPool]: Using postgres connection "list_IDX-Stock_IDX-Schema"
[0m19:19:23.433283 [debug] [ThreadPool]: On list_IDX-Stock_IDX-Schema: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "connection_name": "list_IDX-Stock_IDX-Schema"} */
select
      'IDX-Stock' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'IDX-Schema'
    union all
    select
      'IDX-Stock' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'IDX-Schema'
    union all
    select
      'IDX-Stock' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'IDX-Schema'
  
[0m19:19:23.438325 [debug] [ThreadPool]: SQL status: SELECT 15 in 0.0 seconds
[0m19:19:23.441358 [debug] [ThreadPool]: On list_IDX-Stock_IDX-Schema: ROLLBACK
[0m19:19:23.444350 [debug] [ThreadPool]: On list_IDX-Stock_IDX-Schema: Close
[0m19:19:23.447373 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_IDX-Stock_IDX-Schema, now list_IDX-Stock_snapshots)
[0m19:19:23.458624 [debug] [ThreadPool]: Using postgres connection "list_IDX-Stock_snapshots"
[0m19:19:23.458624 [debug] [ThreadPool]: On list_IDX-Stock_snapshots: BEGIN
[0m19:19:23.459623 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:19:23.486057 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m19:19:23.487053 [debug] [ThreadPool]: Using postgres connection "list_IDX-Stock_snapshots"
[0m19:19:23.487053 [debug] [ThreadPool]: On list_IDX-Stock_snapshots: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "connection_name": "list_IDX-Stock_snapshots"} */
select
      'IDX-Stock' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'snapshots'
    union all
    select
      'IDX-Stock' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'snapshots'
    union all
    select
      'IDX-Stock' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'snapshots'
  
[0m19:19:23.491683 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.0 seconds
[0m19:19:23.492698 [debug] [ThreadPool]: On list_IDX-Stock_snapshots: ROLLBACK
[0m19:19:23.495524 [debug] [ThreadPool]: On list_IDX-Stock_snapshots: Close
[0m19:19:23.502564 [debug] [MainThread]: Using postgres connection "master"
[0m19:19:23.503536 [debug] [MainThread]: On master: BEGIN
[0m19:19:23.503536 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:19:23.531087 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m19:19:23.532087 [debug] [MainThread]: Using postgres connection "master"
[0m19:19:23.533107 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m19:19:23.541127 [debug] [MainThread]: SQL status: SELECT 8 in 0.0 seconds
[0m19:19:23.545652 [debug] [MainThread]: On master: ROLLBACK
[0m19:19:23.548617 [debug] [MainThread]: Using postgres connection "master"
[0m19:19:23.548617 [debug] [MainThread]: On master: BEGIN
[0m19:19:23.552645 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m19:19:23.553653 [debug] [MainThread]: On master: COMMIT
[0m19:19:23.554628 [debug] [MainThread]: Using postgres connection "master"
[0m19:19:23.555617 [debug] [MainThread]: On master: COMMIT
[0m19:19:23.557190 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m19:19:23.558236 [debug] [MainThread]: On master: Close
[0m19:19:23.560200 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m19:19:23.561197 [info ] [MainThread]: 
[0m19:19:23.567212 [debug] [Thread-1 (]: Began running node model.dbt_idx.stg_eltool__company
[0m19:19:23.568200 [info ] [Thread-1 (]: 1 of 10 START sql view model IDX-Schema.stg_eltool__company .................... [RUN]
[0m19:19:23.570197 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.dbt_idx.stg_eltool__company'
[0m19:19:23.571195 [debug] [Thread-1 (]: Began compiling node model.dbt_idx.stg_eltool__company
[0m19:19:23.584199 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_idx.stg_eltool__company"
[0m19:19:23.591199 [debug] [Thread-1 (]: Timing info for model.dbt_idx.stg_eltool__company (compile): 19:19:23.572199 => 19:19:23.591199
[0m19:19:23.592213 [debug] [Thread-1 (]: Began executing node model.dbt_idx.stg_eltool__company
[0m19:19:23.638235 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_idx.stg_eltool__company"
[0m19:19:23.643247 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__company"
[0m19:19:23.644211 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__company: BEGIN
[0m19:19:23.645240 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m19:19:23.666820 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m19:19:23.667871 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__company"
[0m19:19:23.668815 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__company: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__company"} */

  create view "IDX-Stock"."IDX-Schema"."stg_eltool__company__dbt_tmp"
    
    
  as (
    with source as (select *
                from "IDX-Stock"."IDX-Schema"."ksql-company-stream"),
     renamed as (select id,
                        ticker,
                        name,
                        logo
                 from source)
select *
from renamed
  );
[0m19:19:23.671851 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m19:19:23.678849 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__company"
[0m19:19:23.679850 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__company: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__company"} */
alter table "IDX-Stock"."IDX-Schema"."stg_eltool__company" rename to "stg_eltool__company__dbt_backup"
[0m19:19:23.682818 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:19:23.686870 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__company"
[0m19:19:23.687825 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__company: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__company"} */
alter table "IDX-Stock"."IDX-Schema"."stg_eltool__company__dbt_tmp" rename to "stg_eltool__company"
[0m19:19:23.689820 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:19:23.707848 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__company: COMMIT
[0m19:19:23.707848 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__company"
[0m19:19:23.708849 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__company: COMMIT
[0m19:19:23.712816 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m19:19:23.720842 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__company"
[0m19:19:23.721851 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__company: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__company"} */
drop view if exists "IDX-Stock"."IDX-Schema"."stg_eltool__company__dbt_backup" cascade
[0m19:19:23.725482 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m19:19:23.727509 [debug] [Thread-1 (]: Timing info for model.dbt_idx.stg_eltool__company (execute): 19:19:23.593213 => 19:19:23.727509
[0m19:19:23.728507 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__company: Close
[0m19:19:23.730486 [info ] [Thread-1 (]: 1 of 10 OK created sql view model IDX-Schema.stg_eltool__company ............... [[32mCREATE VIEW[0m in 0.16s]
[0m19:19:23.732489 [debug] [Thread-1 (]: Finished running node model.dbt_idx.stg_eltool__company
[0m19:19:23.733485 [debug] [Thread-1 (]: Began running node model.dbt_idx.stg_eltool__customers
[0m19:19:23.734490 [info ] [Thread-1 (]: 2 of 10 START sql view model IDX-Schema.stg_eltool__customers .................. [RUN]
[0m19:19:23.736484 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_idx.stg_eltool__company, now model.dbt_idx.stg_eltool__customers)
[0m19:19:23.737514 [debug] [Thread-1 (]: Began compiling node model.dbt_idx.stg_eltool__customers
[0m19:19:23.741540 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_idx.stg_eltool__customers"
[0m19:19:23.749549 [debug] [Thread-1 (]: Timing info for model.dbt_idx.stg_eltool__customers (compile): 19:19:23.738537 => 19:19:23.748588
[0m19:19:23.749549 [debug] [Thread-1 (]: Began executing node model.dbt_idx.stg_eltool__customers
[0m19:19:23.755587 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_idx.stg_eltool__customers"
[0m19:19:23.762150 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__customers"
[0m19:19:23.764198 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__customers: BEGIN
[0m19:19:23.764198 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:19:23.787147 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m19:19:23.788149 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__customers"
[0m19:19:23.789145 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__customers: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__customers"} */

  create view "IDX-Stock"."IDX-Schema"."stg_eltool__customers__dbt_tmp"
    
    
  as (
    with source as (select *
                from "IDX-Stock"."IDX-Schema"."customers"),
     renamed as (select
                     customer_id,
                    'This is Dummy' as dummy
                 from source
                 where customer_id = 1234567890)
select *
from renamed
  );
[0m19:19:23.793157 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m19:19:23.798185 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__customers"
[0m19:19:23.799178 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__customers: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__customers"} */
alter table "IDX-Stock"."IDX-Schema"."stg_eltool__customers" rename to "stg_eltool__customers__dbt_backup"
[0m19:19:23.802143 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:19:23.806176 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__customers"
[0m19:19:23.806176 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__customers: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__customers"} */
alter table "IDX-Stock"."IDX-Schema"."stg_eltool__customers__dbt_tmp" rename to "stg_eltool__customers"
[0m19:19:23.809156 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:19:23.811178 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__customers: COMMIT
[0m19:19:23.812180 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__customers"
[0m19:19:23.813143 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__customers: COMMIT
[0m19:19:23.817142 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m19:19:23.820142 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__customers"
[0m19:19:23.821163 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__customers: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__customers"} */
drop view if exists "IDX-Stock"."IDX-Schema"."stg_eltool__customers__dbt_backup" cascade
[0m19:19:23.825151 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m19:19:23.827144 [debug] [Thread-1 (]: Timing info for model.dbt_idx.stg_eltool__customers (execute): 19:19:23.750583 => 19:19:23.827144
[0m19:19:23.828143 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__customers: Close
[0m19:19:23.830153 [info ] [Thread-1 (]: 2 of 10 OK created sql view model IDX-Schema.stg_eltool__customers ............. [[32mCREATE VIEW[0m in 0.09s]
[0m19:19:23.832143 [debug] [Thread-1 (]: Finished running node model.dbt_idx.stg_eltool__customers
[0m19:19:23.834155 [debug] [Thread-1 (]: Began running node model.dbt_idx.stg_eltool__customers_snapshots
[0m19:19:23.835142 [info ] [Thread-1 (]: 3 of 10 START sql view model IDX-Schema.stg_eltool__customers_snapshots ........ [RUN]
[0m19:19:23.836162 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_idx.stg_eltool__customers, now model.dbt_idx.stg_eltool__customers_snapshots)
[0m19:19:23.837175 [debug] [Thread-1 (]: Began compiling node model.dbt_idx.stg_eltool__customers_snapshots
[0m19:19:23.840179 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_idx.stg_eltool__customers_snapshots"
[0m19:19:23.847207 [debug] [Thread-1 (]: Timing info for model.dbt_idx.stg_eltool__customers_snapshots (compile): 19:19:23.838160 => 19:19:23.847207
[0m19:19:23.848197 [debug] [Thread-1 (]: Began executing node model.dbt_idx.stg_eltool__customers_snapshots
[0m19:19:23.857727 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_idx.stg_eltool__customers_snapshots"
[0m19:19:23.863735 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__customers_snapshots"
[0m19:19:23.864789 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__customers_snapshots: BEGIN
[0m19:19:23.865771 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:19:23.887791 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m19:19:23.888735 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__customers_snapshots"
[0m19:19:23.889736 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__customers_snapshots: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__customers_snapshots"} */

  create view "IDX-Stock"."IDX-Schema"."stg_eltool__customers_snapshots__dbt_tmp"
    
    
  as (
    with source as (select *
                from "IDX-Stock"."snapshots"."customers_snapshot"),
     renamed as (select customer_id,
                        zipcode,
                        city,
                        state_code,
                        datetime_created::TIMESTAMP AS datetime_created,
                        datetime_updated::TIMESTAMP AS datetime_updated,
                        dbt_valid_from,
                        dbt_valid_to
                 from source)
select *
from renamed
  );
[0m19:19:23.894732 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m19:19:23.900770 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__customers_snapshots"
[0m19:19:23.901769 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__customers_snapshots: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__customers_snapshots"} */
alter table "IDX-Stock"."IDX-Schema"."stg_eltool__customers_snapshots" rename to "stg_eltool__customers_snapshots__dbt_backup"
[0m19:19:23.905734 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:19:23.909770 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__customers_snapshots"
[0m19:19:23.909770 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__customers_snapshots: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__customers_snapshots"} */
alter table "IDX-Stock"."IDX-Schema"."stg_eltool__customers_snapshots__dbt_tmp" rename to "stg_eltool__customers_snapshots"
[0m19:19:23.912737 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:19:23.916738 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__customers_snapshots: COMMIT
[0m19:19:23.917734 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__customers_snapshots"
[0m19:19:23.918768 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__customers_snapshots: COMMIT
[0m19:19:23.922748 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m19:19:23.928735 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__customers_snapshots"
[0m19:19:23.929735 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__customers_snapshots: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__customers_snapshots"} */
drop view if exists "IDX-Stock"."IDX-Schema"."stg_eltool__customers_snapshots__dbt_backup" cascade
[0m19:19:23.933734 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m19:19:23.936748 [debug] [Thread-1 (]: Timing info for model.dbt_idx.stg_eltool__customers_snapshots (execute): 19:19:23.849151 => 19:19:23.935750
[0m19:19:23.936748 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__customers_snapshots: Close
[0m19:19:23.939742 [info ] [Thread-1 (]: 3 of 10 OK created sql view model IDX-Schema.stg_eltool__customers_snapshots ... [[32mCREATE VIEW[0m in 0.10s]
[0m19:19:23.941741 [debug] [Thread-1 (]: Finished running node model.dbt_idx.stg_eltool__customers_snapshots
[0m19:19:23.942757 [debug] [Thread-1 (]: Began running node model.dbt_idx.stg_eltool__orders
[0m19:19:23.943801 [info ] [Thread-1 (]: 4 of 10 START sql view model IDX-Schema.stg_eltool__orders ..................... [RUN]
[0m19:19:23.945782 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_idx.stg_eltool__customers_snapshots, now model.dbt_idx.stg_eltool__orders)
[0m19:19:23.946748 [debug] [Thread-1 (]: Began compiling node model.dbt_idx.stg_eltool__orders
[0m19:19:23.949746 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_idx.stg_eltool__orders"
[0m19:19:23.962330 [debug] [Thread-1 (]: Timing info for model.dbt_idx.stg_eltool__orders (compile): 19:19:23.946748 => 19:19:23.961327
[0m19:19:23.963294 [debug] [Thread-1 (]: Began executing node model.dbt_idx.stg_eltool__orders
[0m19:19:23.969327 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_idx.stg_eltool__orders"
[0m19:19:23.979079 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__orders"
[0m19:19:23.980084 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__orders: BEGIN
[0m19:19:23.981046 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:19:24.004047 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m19:19:24.005048 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__orders"
[0m19:19:24.006049 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__orders: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__orders"} */

  create view "IDX-Stock"."IDX-Schema"."stg_eltool__orders__dbt_tmp"
    
    
  as (
    with source as (select *
                from "IDX-Stock"."IDX-Schema"."orders"),
     renamed as (select order_id,
                        cust_id AS customer_id,
                        order_status,
                        order_purchase_timestamp::TIMESTAMP,
                        order_approved_at::TIMESTAMP,
                        order_delivered_carrier_date::TIMESTAMP,
                        order_delivered_customer_date::TIMESTAMP,
                        order_estimated_delivery_date::TIMESTAMP
                 from source)
select *
from renamed
  );
[0m19:19:24.010052 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m19:19:24.014048 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__orders"
[0m19:19:24.015048 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__orders: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__orders"} */
alter table "IDX-Stock"."IDX-Schema"."stg_eltool__orders" rename to "stg_eltool__orders__dbt_backup"
[0m19:19:24.017048 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:19:24.021047 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__orders"
[0m19:19:24.022069 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__orders: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__orders"} */
alter table "IDX-Stock"."IDX-Schema"."stg_eltool__orders__dbt_tmp" rename to "stg_eltool__orders"
[0m19:19:24.025048 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:19:24.027056 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__orders: COMMIT
[0m19:19:24.028049 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__orders"
[0m19:19:24.029048 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__orders: COMMIT
[0m19:19:24.032048 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m19:19:24.036055 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__orders"
[0m19:19:24.037078 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__orders: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__orders"} */
drop view if exists "IDX-Stock"."IDX-Schema"."stg_eltool__orders__dbt_backup" cascade
[0m19:19:24.041043 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m19:19:24.043047 [debug] [Thread-1 (]: Timing info for model.dbt_idx.stg_eltool__orders (execute): 19:19:23.963294 => 19:19:24.043047
[0m19:19:24.044047 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__orders: Close
[0m19:19:24.046054 [info ] [Thread-1 (]: 4 of 10 OK created sql view model IDX-Schema.stg_eltool__orders ................ [[32mCREATE VIEW[0m in 0.10s]
[0m19:19:24.049067 [debug] [Thread-1 (]: Finished running node model.dbt_idx.stg_eltool__orders
[0m19:19:24.050071 [debug] [Thread-1 (]: Began running node model.dbt_idx.stg_eltool__state
[0m19:19:24.051085 [info ] [Thread-1 (]: 5 of 10 START sql view model IDX-Schema.stg_eltool__state ...................... [RUN]
[0m19:19:24.053089 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_idx.stg_eltool__orders, now model.dbt_idx.stg_eltool__state)
[0m19:19:24.054065 [debug] [Thread-1 (]: Began compiling node model.dbt_idx.stg_eltool__state
[0m19:19:24.056085 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_idx.stg_eltool__state"
[0m19:19:24.063485 [debug] [Thread-1 (]: Timing info for model.dbt_idx.stg_eltool__state (compile): 19:19:24.055050 => 19:19:24.062470
[0m19:19:24.064437 [debug] [Thread-1 (]: Began executing node model.dbt_idx.stg_eltool__state
[0m19:19:24.069469 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_idx.stg_eltool__state"
[0m19:19:24.076445 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__state"
[0m19:19:24.077435 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__state: BEGIN
[0m19:19:24.078440 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:19:24.102434 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m19:19:24.102434 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__state"
[0m19:19:24.103471 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__state: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__state"} */

  create view "IDX-Stock"."IDX-Schema"."stg_eltool__state__dbt_tmp"
    
    
  as (
    with source as (select *
                from "IDX-Stock"."IDX-Schema"."state"),
     renamed as (select state_identifier::INT AS state_id,
                         state_code::VARCHAR(2) AS state_code,
                         st_name::VARCHAR(30) AS state_name
                 from source)
select *
from renamed
  );
[0m19:19:24.107439 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m19:19:24.111470 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__state"
[0m19:19:24.111470 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__state: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__state"} */
alter table "IDX-Stock"."IDX-Schema"."stg_eltool__state" rename to "stg_eltool__state__dbt_backup"
[0m19:19:24.114534 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:19:24.118052 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__state"
[0m19:19:24.119052 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__state: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__state"} */
alter table "IDX-Stock"."IDX-Schema"."stg_eltool__state__dbt_tmp" rename to "stg_eltool__state"
[0m19:19:24.120588 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:19:24.122628 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__state: COMMIT
[0m19:19:24.123629 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__state"
[0m19:19:24.124595 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__state: COMMIT
[0m19:19:24.127593 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m19:19:24.132618 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__state"
[0m19:19:24.133613 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__state: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__state"} */
drop view if exists "IDX-Stock"."IDX-Schema"."stg_eltool__state__dbt_backup" cascade
[0m19:19:24.137594 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m19:19:24.138619 [debug] [Thread-1 (]: Timing info for model.dbt_idx.stg_eltool__state (execute): 19:19:24.065471 => 19:19:24.138619
[0m19:19:24.139620 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__state: Close
[0m19:19:24.141598 [info ] [Thread-1 (]: 5 of 10 OK created sql view model IDX-Schema.stg_eltool__state ................. [[32mCREATE VIEW[0m in 0.09s]
[0m19:19:24.143601 [debug] [Thread-1 (]: Finished running node model.dbt_idx.stg_eltool__state
[0m19:19:24.144604 [debug] [Thread-1 (]: Began running node model.dbt_idx.stg_eltool__stock
[0m19:19:24.146604 [info ] [Thread-1 (]: 6 of 10 START sql view model IDX-Schema.stg_eltool__stock ...................... [RUN]
[0m19:19:24.147613 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_idx.stg_eltool__state, now model.dbt_idx.stg_eltool__stock)
[0m19:19:24.148636 [debug] [Thread-1 (]: Began compiling node model.dbt_idx.stg_eltool__stock
[0m19:19:24.153623 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_idx.stg_eltool__stock"
[0m19:19:24.162133 [debug] [Thread-1 (]: Timing info for model.dbt_idx.stg_eltool__stock (compile): 19:19:24.149603 => 19:19:24.162133
[0m19:19:24.163127 [debug] [Thread-1 (]: Began executing node model.dbt_idx.stg_eltool__stock
[0m19:19:24.169126 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_idx.stg_eltool__stock"
[0m19:19:24.176126 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__stock"
[0m19:19:24.177134 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__stock: BEGIN
[0m19:19:24.178126 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:19:24.200041 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m19:19:24.201056 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__stock"
[0m19:19:24.202024 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__stock: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__stock"} */

  create view "IDX-Stock"."IDX-Schema"."stg_eltool__stock__dbt_tmp"
    
    
  as (
    with source as (select *
                from "IDX-Stock"."IDX-Schema"."ksql-stock-stream"),
     renamed as (select *
                 from source)
select *
from renamed
  );
[0m19:19:24.205024 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m19:19:24.209033 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__stock"
[0m19:19:24.209033 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__stock: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__stock"} */
alter table "IDX-Stock"."IDX-Schema"."stg_eltool__stock" rename to "stg_eltool__stock__dbt_backup"
[0m19:19:24.212024 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:19:24.215027 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__stock"
[0m19:19:24.216027 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__stock: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__stock"} */
alter table "IDX-Stock"."IDX-Schema"."stg_eltool__stock__dbt_tmp" rename to "stg_eltool__stock"
[0m19:19:24.218154 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:19:24.220177 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__stock: COMMIT
[0m19:19:24.221207 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__stock"
[0m19:19:24.221207 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__stock: COMMIT
[0m19:19:24.225148 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m19:19:24.229142 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__stock"
[0m19:19:24.230141 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__stock: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__stock"} */
drop view if exists "IDX-Stock"."IDX-Schema"."stg_eltool__stock__dbt_backup" cascade
[0m19:19:24.234142 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m19:19:24.237142 [debug] [Thread-1 (]: Timing info for model.dbt_idx.stg_eltool__stock (execute): 19:19:24.164125 => 19:19:24.236143
[0m19:19:24.238142 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__stock: Close
[0m19:19:24.240148 [info ] [Thread-1 (]: 6 of 10 OK created sql view model IDX-Schema.stg_eltool__stock ................. [[32mCREATE VIEW[0m in 0.09s]
[0m19:19:24.242142 [debug] [Thread-1 (]: Finished running node model.dbt_idx.stg_eltool__stock
[0m19:19:24.244167 [debug] [Thread-1 (]: Began running node model.dbt_idx.fact_orders
[0m19:19:24.245149 [info ] [Thread-1 (]: 7 of 10 START sql table model IDX-Schema.fact_orders ........................... [RUN]
[0m19:19:24.246151 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_idx.stg_eltool__stock, now model.dbt_idx.fact_orders)
[0m19:19:24.247165 [debug] [Thread-1 (]: Began compiling node model.dbt_idx.fact_orders
[0m19:19:24.250184 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_idx.fact_orders"
[0m19:19:24.256153 [debug] [Thread-1 (]: Timing info for model.dbt_idx.fact_orders (compile): 19:19:24.248175 => 19:19:24.256153
[0m19:19:24.257693 [debug] [Thread-1 (]: Began executing node model.dbt_idx.fact_orders
[0m19:19:24.281712 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_idx.fact_orders"
[0m19:19:24.288702 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.fact_orders"
[0m19:19:24.289701 [debug] [Thread-1 (]: On model.dbt_idx.fact_orders: BEGIN
[0m19:19:24.290700 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:19:24.311954 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m19:19:24.313534 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.fact_orders"
[0m19:19:24.315387 [debug] [Thread-1 (]: On model.dbt_idx.fact_orders: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.fact_orders"} */

  
    

  create  table "IDX-Stock"."IDX-Schema"."fact_orders__dbt_tmp"
  
  
    as
  
  (
    with orders as (
    select *
    from "IDX-Stock"."IDX-Schema"."stg_eltool__orders"
)
select * from orders
  );
  
[0m19:19:24.322932 [debug] [Thread-1 (]: SQL status: SELECT 999 in 0.0 seconds
[0m19:19:24.327928 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.fact_orders"
[0m19:19:24.328927 [debug] [Thread-1 (]: On model.dbt_idx.fact_orders: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.fact_orders"} */
alter table "IDX-Stock"."IDX-Schema"."fact_orders" rename to "fact_orders__dbt_backup"
[0m19:19:24.330976 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:19:24.334929 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.fact_orders"
[0m19:19:24.335985 [debug] [Thread-1 (]: On model.dbt_idx.fact_orders: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.fact_orders"} */
alter table "IDX-Stock"."IDX-Schema"."fact_orders__dbt_tmp" rename to "fact_orders"
[0m19:19:24.338974 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:19:24.344986 [debug] [Thread-1 (]: On model.dbt_idx.fact_orders: COMMIT
[0m19:19:24.345970 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.fact_orders"
[0m19:19:24.345970 [debug] [Thread-1 (]: On model.dbt_idx.fact_orders: COMMIT
[0m19:19:24.349971 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m19:19:24.356972 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.fact_orders"
[0m19:19:24.357971 [debug] [Thread-1 (]: On model.dbt_idx.fact_orders: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.fact_orders"} */
drop table if exists "IDX-Stock"."IDX-Schema"."fact_orders__dbt_backup" cascade
[0m19:19:24.362845 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m19:19:24.364859 [debug] [Thread-1 (]: Timing info for model.dbt_idx.fact_orders (execute): 19:19:24.258735 => 19:19:24.363856
[0m19:19:24.365855 [debug] [Thread-1 (]: On model.dbt_idx.fact_orders: Close
[0m19:19:24.366863 [info ] [Thread-1 (]: 7 of 10 OK created sql table model IDX-Schema.fact_orders ...................... [[32mSELECT 999[0m in 0.12s]
[0m19:19:24.368860 [debug] [Thread-1 (]: Finished running node model.dbt_idx.fact_orders
[0m19:19:24.369876 [debug] [Thread-1 (]: Began running node model.dbt_idx.dim_customers
[0m19:19:24.370893 [info ] [Thread-1 (]: 8 of 10 START sql table model IDX-Schema.dim_customers ......................... [RUN]
[0m19:19:24.371856 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_idx.fact_orders, now model.dbt_idx.dim_customers)
[0m19:19:24.372890 [debug] [Thread-1 (]: Began compiling node model.dbt_idx.dim_customers
[0m19:19:24.375897 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_idx.dim_customers"
[0m19:19:24.381891 [debug] [Thread-1 (]: Timing info for model.dbt_idx.dim_customers (compile): 19:19:24.372890 => 19:19:24.381891
[0m19:19:24.382857 [debug] [Thread-1 (]: Began executing node model.dbt_idx.dim_customers
[0m19:19:24.389867 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_idx.dim_customers"
[0m19:19:24.396890 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.dim_customers"
[0m19:19:24.397892 [debug] [Thread-1 (]: On model.dbt_idx.dim_customers: BEGIN
[0m19:19:24.398913 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:19:24.421857 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m19:19:24.422859 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.dim_customers"
[0m19:19:24.423859 [debug] [Thread-1 (]: On model.dbt_idx.dim_customers: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.dim_customers"} */

  
    

  create  table "IDX-Stock"."IDX-Schema"."dim_customers__dbt_tmp"
  
  
    as
  
  (
    -- noinspection SqlDialectInspectionForFile

with customers as (
    select *
    from "IDX-Stock"."IDX-Schema"."stg_eltool__customers_snapshots"
    ),
     state as (
         select *
         from "IDX-Stock"."IDX-Schema"."stg_eltool__state"
     )
select c.customer_id,
       c.zipcode,
       c.city,
       c.state_code,
       s.state_name,
       c.datetime_created,
       c.datetime_updated,
       c.dbt_valid_from::TIMESTAMP as valid_from,
        CASE WHEN c.dbt_valid_to IS NULL
            THEN '9999-12-31'::TIMESTAMP
            ELSE c.dbt_valid_to::TIMESTAMP
        END as valid_to
from customers c
    join state s on c.state_code = s.state_code
  );
  
[0m19:19:24.428859 [debug] [Thread-1 (]: SQL status: SELECT 100 in 0.0 seconds
[0m19:19:24.432912 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.dim_customers"
[0m19:19:24.433871 [debug] [Thread-1 (]: On model.dbt_idx.dim_customers: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.dim_customers"} */
alter table "IDX-Stock"."IDX-Schema"."dim_customers" rename to "dim_customers__dbt_backup"
[0m19:19:24.436857 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:19:24.480490 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.dim_customers"
[0m19:19:24.480490 [debug] [Thread-1 (]: On model.dbt_idx.dim_customers: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.dim_customers"} */
alter table "IDX-Stock"."IDX-Schema"."dim_customers__dbt_tmp" rename to "dim_customers"
[0m19:19:24.483505 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:19:24.487487 [debug] [Thread-1 (]: On model.dbt_idx.dim_customers: COMMIT
[0m19:19:24.488454 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.dim_customers"
[0m19:19:24.489509 [debug] [Thread-1 (]: On model.dbt_idx.dim_customers: COMMIT
[0m19:19:24.494454 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m19:19:24.499453 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.dim_customers"
[0m19:19:24.500456 [debug] [Thread-1 (]: On model.dbt_idx.dim_customers: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.dim_customers"} */
drop table if exists "IDX-Stock"."IDX-Schema"."dim_customers__dbt_backup" cascade
[0m19:19:24.506457 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m19:19:24.510453 [debug] [Thread-1 (]: Timing info for model.dbt_idx.dim_customers (execute): 19:19:24.383872 => 19:19:24.509457
[0m19:19:24.511454 [debug] [Thread-1 (]: On model.dbt_idx.dim_customers: Close
[0m19:19:24.514984 [info ] [Thread-1 (]: 8 of 10 OK created sql table model IDX-Schema.dim_customers .................... [[32mSELECT 100[0m in 0.14s]
[0m19:19:24.516991 [debug] [Thread-1 (]: Finished running node model.dbt_idx.dim_customers
[0m19:19:24.517981 [debug] [Thread-1 (]: Began running node model.dbt_idx.fact_stocks
[0m19:19:24.518987 [info ] [Thread-1 (]: 9 of 10 START sql table model IDX-Schema.fact_stocks ........................... [RUN]
[0m19:19:24.520980 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_idx.dim_customers, now model.dbt_idx.fact_stocks)
[0m19:19:24.520980 [debug] [Thread-1 (]: Began compiling node model.dbt_idx.fact_stocks
[0m19:19:24.524988 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_idx.fact_stocks"
[0m19:19:24.529017 [debug] [Thread-1 (]: Timing info for model.dbt_idx.fact_stocks (compile): 19:19:24.521979 => 19:19:24.528015
[0m19:19:24.529017 [debug] [Thread-1 (]: Began executing node model.dbt_idx.fact_stocks
[0m19:19:24.534990 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_idx.fact_stocks"
[0m19:19:24.539014 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.fact_stocks"
[0m19:19:24.540014 [debug] [Thread-1 (]: On model.dbt_idx.fact_stocks: BEGIN
[0m19:19:24.541008 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:19:24.565520 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m19:19:24.566537 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.fact_stocks"
[0m19:19:24.567500 [debug] [Thread-1 (]: On model.dbt_idx.fact_stocks: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.fact_stocks"} */

  
    

  create  table "IDX-Stock"."IDX-Schema"."fact_stocks__dbt_tmp"
  
  
    as
  
  (
    -- noinspection SqlDialectInspectionForFile

with stock as (
    select *
    from "IDX-Stock"."IDX-Schema"."stg_eltool__stock"
    ),
     company as (
         select *
         from "IDX-Stock"."IDX-Schema"."stg_eltool__company"
     )
select a.id,
       a.ticker,
       b.name,
       a.date,
       a.open,
       a.high,
       a.low,
       a.close,
       a.volume,
       b.logo
from stock a
    join company b on a.ticker = b.ticker
  );
  
[0m19:19:24.611744 [debug] [Thread-1 (]: SQL status: SELECT 26131 in 0.0 seconds
[0m19:19:24.616326 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.fact_stocks"
[0m19:19:24.617292 [debug] [Thread-1 (]: On model.dbt_idx.fact_stocks: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.fact_stocks"} */
alter table "IDX-Stock"."IDX-Schema"."fact_stocks__dbt_tmp" rename to "fact_stocks"
[0m19:19:24.619293 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:19:24.621328 [debug] [Thread-1 (]: On model.dbt_idx.fact_stocks: COMMIT
[0m19:19:24.622329 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.fact_stocks"
[0m19:19:24.623329 [debug] [Thread-1 (]: On model.dbt_idx.fact_stocks: COMMIT
[0m19:19:24.634300 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m19:19:24.637328 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.fact_stocks"
[0m19:19:24.638347 [debug] [Thread-1 (]: On model.dbt_idx.fact_stocks: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.fact_stocks"} */
drop table if exists "IDX-Stock"."IDX-Schema"."fact_stocks__dbt_backup" cascade
[0m19:19:24.640332 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m19:19:24.642328 [debug] [Thread-1 (]: Timing info for model.dbt_idx.fact_stocks (execute): 19:19:24.530022 => 19:19:24.642328
[0m19:19:24.643379 [debug] [Thread-1 (]: On model.dbt_idx.fact_stocks: Close
[0m19:19:24.645335 [info ] [Thread-1 (]: 9 of 10 OK created sql table model IDX-Schema.fact_stocks ...................... [[32mSELECT 26131[0m in 0.12s]
[0m19:19:24.647340 [debug] [Thread-1 (]: Finished running node model.dbt_idx.fact_stocks
[0m19:19:24.649348 [debug] [Thread-1 (]: Began running node model.dbt_idx.customer_orders_status
[0m19:19:24.650339 [info ] [Thread-1 (]: 10 of 10 START sql view model IDX-Schema.customer_orders_status ................ [RUN]
[0m19:19:24.652342 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_idx.fact_stocks, now model.dbt_idx.customer_orders_status)
[0m19:19:24.652342 [debug] [Thread-1 (]: Began compiling node model.dbt_idx.customer_orders_status
[0m19:19:24.658373 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_idx.customer_orders_status"
[0m19:19:24.664623 [debug] [Thread-1 (]: Timing info for model.dbt_idx.customer_orders_status (compile): 19:19:24.653369 => 19:19:24.664623
[0m19:19:24.665614 [debug] [Thread-1 (]: Began executing node model.dbt_idx.customer_orders_status
[0m19:19:24.670614 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_idx.customer_orders_status"
[0m19:19:24.675585 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.customer_orders_status"
[0m19:19:24.676587 [debug] [Thread-1 (]: On model.dbt_idx.customer_orders_status: BEGIN
[0m19:19:24.677553 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:19:24.699553 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m19:19:24.700552 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.customer_orders_status"
[0m19:19:24.700552 [debug] [Thread-1 (]: On model.dbt_idx.customer_orders_status: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.customer_orders_status"} */

  create view "IDX-Stock"."IDX-Schema"."customer_orders_status__dbt_tmp"
    
    
  as (
    with orders as (select *
                from "IDX-Stock"."IDX-Schema"."fact_orders"),
     customers as (select *
                   from "IDX-Stock"."IDX-Schema"."dim_customers")
select o.order_id,
       o.customer_id,
       o.order_status,
       o.order_purchase_timestamp,
       o.order_approved_at,
       o.order_delivered_carrier_date,
       o.order_delivered_customer_date,
       o.order_estimated_delivery_date,
       c.zipcode    as customer_zipcode,
       c.city       as customer_city,
       c.state_code as customer_state_code,
       c.state_name as customer_state_name
from orders o
    join customers c on o.customer_id = c.customer_id
    and o.order_purchase_timestamp >= c.valid_from
    and o.order_purchase_timestamp <= c.valid_to
  );
[0m19:19:24.704553 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m19:19:24.708576 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.customer_orders_status"
[0m19:19:24.709552 [debug] [Thread-1 (]: On model.dbt_idx.customer_orders_status: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.customer_orders_status"} */
alter table "IDX-Stock"."IDX-Schema"."customer_orders_status__dbt_tmp" rename to "customer_orders_status"
[0m19:19:24.711554 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:19:24.713582 [debug] [Thread-1 (]: On model.dbt_idx.customer_orders_status: COMMIT
[0m19:19:24.714553 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.customer_orders_status"
[0m19:19:24.715577 [debug] [Thread-1 (]: On model.dbt_idx.customer_orders_status: COMMIT
[0m19:19:24.719552 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m19:19:24.722579 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.customer_orders_status"
[0m19:19:24.723553 [debug] [Thread-1 (]: On model.dbt_idx.customer_orders_status: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.customer_orders_status"} */
drop view if exists "IDX-Stock"."IDX-Schema"."customer_orders_status__dbt_backup" cascade
[0m19:19:24.726560 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m19:19:24.729585 [debug] [Thread-1 (]: Timing info for model.dbt_idx.customer_orders_status (execute): 19:19:24.666602 => 19:19:24.728589
[0m19:19:24.730574 [debug] [Thread-1 (]: On model.dbt_idx.customer_orders_status: Close
[0m19:19:24.732558 [info ] [Thread-1 (]: 10 of 10 OK created sql view model IDX-Schema.customer_orders_status ........... [[32mCREATE VIEW[0m in 0.08s]
[0m19:19:24.735558 [debug] [Thread-1 (]: Finished running node model.dbt_idx.customer_orders_status
[0m19:19:24.738558 [debug] [MainThread]: Using postgres connection "master"
[0m19:19:24.739552 [debug] [MainThread]: On master: BEGIN
[0m19:19:24.740553 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m19:19:24.762863 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m19:19:24.763923 [debug] [MainThread]: On master: COMMIT
[0m19:19:24.764498 [debug] [MainThread]: Using postgres connection "master"
[0m19:19:24.765123 [debug] [MainThread]: On master: COMMIT
[0m19:19:24.766714 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m19:19:24.767266 [debug] [MainThread]: On master: Close
[0m19:19:24.768844 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:19:24.769958 [debug] [MainThread]: Connection 'list_IDX-Stock' was properly closed.
[0m19:19:24.769958 [debug] [MainThread]: Connection 'list_IDX-Stock_snapshots' was properly closed.
[0m19:19:24.770965 [debug] [MainThread]: Connection 'model.dbt_idx.customer_orders_status' was properly closed.
[0m19:19:24.772980 [info ] [MainThread]: 
[0m19:19:24.773981 [info ] [MainThread]: Finished running 7 view models, 3 table models in 0 hours 0 minutes and 1.42 seconds (1.42s).
[0m19:19:24.777017 [debug] [MainThread]: Command end result
[0m19:19:24.804004 [info ] [MainThread]: 
[0m19:19:24.805973 [info ] [MainThread]: [32mCompleted successfully[0m
[0m19:19:24.807020 [info ] [MainThread]: 
[0m19:19:24.807967 [info ] [MainThread]: Done. PASS=10 WARN=0 ERROR=0 SKIP=0 TOTAL=10
[0m19:19:24.808966 [debug] [MainThread]: Command `dbt run` succeeded at 19:19:24.808966 after 2.06 seconds
[0m19:19:24.809965 [debug] [MainThread]: Flushing usage events


============================== 19:24:23.780743 | b5d3d06f-42b6-4e0c-b01f-a1c501fb3659 ==============================
[0m19:24:23.780743 [info ] [MainThread]: Running with dbt=1.6.1
[0m19:24:23.787744 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'D:\\00 Project\\00 My Project\\IdeaProjects\\Py-DBT-IDX', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'D:\\00 Project\\00 My Project\\IdeaProjects\\Py-DBT-IDX\\logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'False'}
[0m19:24:23.925321 [info ] [MainThread]: Registered adapter: postgres=1.6.1
[0m19:24:23.934678 [debug] [MainThread]: checksum: efe19d9f5b93d1a98cc804fbfcdb6b3aced98b974af664946fee1cde8837deb7, vars: {}, profile: , target: , version: 1.6.1
[0m19:24:24.111374 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m19:24:24.113391 [debug] [MainThread]: Partial parsing: updated file: dbt_idx://models\marts\stock\stock_update_status.sql
[0m19:24:24.223872 [info ] [MainThread]: Found 11 models, 1 snapshot, 18 tests, 5 sources, 0 exposures, 0 metrics, 349 macros, 0 groups, 0 semantic models
[0m19:24:24.226863 [info ] [MainThread]: 
[0m19:24:24.227870 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m19:24:24.230867 [debug] [ThreadPool]: Acquiring new postgres connection 'list_IDX-Stock'
[0m19:24:24.240863 [debug] [ThreadPool]: Using postgres connection "list_IDX-Stock"
[0m19:24:24.242871 [debug] [ThreadPool]: On list_IDX-Stock: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "connection_name": "list_IDX-Stock"} */

    select distinct nspname from pg_namespace
  
[0m19:24:24.243902 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:24:24.275605 [debug] [ThreadPool]: SQL status: SELECT 12 in 0.0 seconds
[0m19:24:24.277639 [debug] [ThreadPool]: On list_IDX-Stock: Close
[0m19:24:24.281642 [debug] [ThreadPool]: Acquiring new postgres connection 'list_IDX-Stock_IDX-Schema'
[0m19:24:24.287639 [debug] [ThreadPool]: Using postgres connection "list_IDX-Stock_IDX-Schema"
[0m19:24:24.288606 [debug] [ThreadPool]: On list_IDX-Stock_IDX-Schema: BEGIN
[0m19:24:24.289621 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:24:24.310683 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m19:24:24.311699 [debug] [ThreadPool]: Using postgres connection "list_IDX-Stock_IDX-Schema"
[0m19:24:24.311699 [debug] [ThreadPool]: On list_IDX-Stock_IDX-Schema: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "connection_name": "list_IDX-Stock_IDX-Schema"} */
select
      'IDX-Stock' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'IDX-Schema'
    union all
    select
      'IDX-Stock' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'IDX-Schema'
    union all
    select
      'IDX-Stock' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'IDX-Schema'
  
[0m19:24:24.316680 [debug] [ThreadPool]: SQL status: SELECT 16 in 0.0 seconds
[0m19:24:24.318708 [debug] [ThreadPool]: On list_IDX-Stock_IDX-Schema: ROLLBACK
[0m19:24:24.320680 [debug] [ThreadPool]: On list_IDX-Stock_IDX-Schema: Close
[0m19:24:24.322685 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_IDX-Stock_IDX-Schema, now list_IDX-Stock_snapshots)
[0m19:24:24.333271 [debug] [ThreadPool]: Using postgres connection "list_IDX-Stock_snapshots"
[0m19:24:24.334436 [debug] [ThreadPool]: On list_IDX-Stock_snapshots: BEGIN
[0m19:24:24.335074 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:24:24.355832 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m19:24:24.356830 [debug] [ThreadPool]: Using postgres connection "list_IDX-Stock_snapshots"
[0m19:24:24.357857 [debug] [ThreadPool]: On list_IDX-Stock_snapshots: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "connection_name": "list_IDX-Stock_snapshots"} */
select
      'IDX-Stock' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'snapshots'
    union all
    select
      'IDX-Stock' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'snapshots'
    union all
    select
      'IDX-Stock' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'snapshots'
  
[0m19:24:24.362162 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.0 seconds
[0m19:24:24.363231 [debug] [ThreadPool]: On list_IDX-Stock_snapshots: ROLLBACK
[0m19:24:24.365173 [debug] [ThreadPool]: On list_IDX-Stock_snapshots: Close
[0m19:24:24.372757 [debug] [MainThread]: Using postgres connection "master"
[0m19:24:24.373740 [debug] [MainThread]: On master: BEGIN
[0m19:24:24.374722 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:24:24.397729 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m19:24:24.398728 [debug] [MainThread]: Using postgres connection "master"
[0m19:24:24.399728 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m19:24:24.407967 [debug] [MainThread]: SQL status: SELECT 8 in 0.0 seconds
[0m19:24:24.412967 [debug] [MainThread]: On master: ROLLBACK
[0m19:24:24.414963 [debug] [MainThread]: Using postgres connection "master"
[0m19:24:24.416002 [debug] [MainThread]: On master: BEGIN
[0m19:24:24.419301 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m19:24:24.419301 [debug] [MainThread]: On master: COMMIT
[0m19:24:24.420349 [debug] [MainThread]: Using postgres connection "master"
[0m19:24:24.421341 [debug] [MainThread]: On master: COMMIT
[0m19:24:24.423312 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m19:24:24.424321 [debug] [MainThread]: On master: Close
[0m19:24:24.425340 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m19:24:24.427318 [info ] [MainThread]: 
[0m19:24:24.432377 [debug] [Thread-1 (]: Began running node model.dbt_idx.stg_eltool__company
[0m19:24:24.433391 [info ] [Thread-1 (]: 1 of 11 START sql view model IDX-Schema.stg_eltool__company .................... [RUN]
[0m19:24:24.434387 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.dbt_idx.stg_eltool__company'
[0m19:24:24.435390 [debug] [Thread-1 (]: Began compiling node model.dbt_idx.stg_eltool__company
[0m19:24:24.443427 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_idx.stg_eltool__company"
[0m19:24:24.450470 [debug] [Thread-1 (]: Timing info for model.dbt_idx.stg_eltool__company (compile): 19:24:24.435390 => 19:24:24.450470
[0m19:24:24.451471 [debug] [Thread-1 (]: Began executing node model.dbt_idx.stg_eltool__company
[0m19:24:24.487093 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_idx.stg_eltool__company"
[0m19:24:24.492656 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__company"
[0m19:24:24.493693 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__company: BEGIN
[0m19:24:24.494703 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m19:24:24.515396 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m19:24:24.516424 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__company"
[0m19:24:24.517394 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__company: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__company"} */

  create view "IDX-Stock"."IDX-Schema"."stg_eltool__company__dbt_tmp"
    
    
  as (
    with source as (select *
                from "IDX-Stock"."IDX-Schema"."ksql-company-stream"),
     renamed as (select id,
                        ticker,
                        name,
                        logo
                 from source)
select *
from renamed
  );
[0m19:24:24.522989 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m19:24:24.540617 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__company"
[0m19:24:24.542338 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__company: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__company"} */
alter table "IDX-Stock"."IDX-Schema"."stg_eltool__company" rename to "stg_eltool__company__dbt_backup"
[0m19:24:24.546326 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:24:24.549567 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__company"
[0m19:24:24.550716 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__company: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__company"} */
alter table "IDX-Stock"."IDX-Schema"."stg_eltool__company__dbt_tmp" rename to "stg_eltool__company"
[0m19:24:24.553139 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:24:24.569769 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__company: COMMIT
[0m19:24:24.569769 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__company"
[0m19:24:24.570769 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__company: COMMIT
[0m19:24:24.574476 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m19:24:24.583514 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__company"
[0m19:24:24.584504 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__company: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__company"} */
drop view if exists "IDX-Stock"."IDX-Schema"."stg_eltool__company__dbt_backup" cascade
[0m19:24:24.588477 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m19:24:24.590500 [debug] [Thread-1 (]: Timing info for model.dbt_idx.stg_eltool__company (execute): 19:24:24.452477 => 19:24:24.590500
[0m19:24:24.591477 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__company: Close
[0m19:24:24.593481 [info ] [Thread-1 (]: 1 of 11 OK created sql view model IDX-Schema.stg_eltool__company ............... [[32mCREATE VIEW[0m in 0.16s]
[0m19:24:24.595502 [debug] [Thread-1 (]: Finished running node model.dbt_idx.stg_eltool__company
[0m19:24:24.595502 [debug] [Thread-1 (]: Began running node model.dbt_idx.stg_eltool__customers
[0m19:24:24.596490 [info ] [Thread-1 (]: 2 of 11 START sql view model IDX-Schema.stg_eltool__customers .................. [RUN]
[0m19:24:24.597502 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_idx.stg_eltool__company, now model.dbt_idx.stg_eltool__customers)
[0m19:24:24.598476 [debug] [Thread-1 (]: Began compiling node model.dbt_idx.stg_eltool__customers
[0m19:24:24.601475 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_idx.stg_eltool__customers"
[0m19:24:24.611479 [debug] [Thread-1 (]: Timing info for model.dbt_idx.stg_eltool__customers (compile): 19:24:24.599484 => 19:24:24.610516
[0m19:24:24.612479 [debug] [Thread-1 (]: Began executing node model.dbt_idx.stg_eltool__customers
[0m19:24:24.619236 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_idx.stg_eltool__customers"
[0m19:24:24.627336 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__customers"
[0m19:24:24.628334 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__customers: BEGIN
[0m19:24:24.629341 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:24:24.655425 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m19:24:24.656456 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__customers"
[0m19:24:24.657420 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__customers: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__customers"} */

  create view "IDX-Stock"."IDX-Schema"."stg_eltool__customers__dbt_tmp"
    
    
  as (
    with source as (select *
                from "IDX-Stock"."IDX-Schema"."customers"),
     renamed as (select
                     customer_id,
                    'This is Dummy' as dummy
                 from source
                 where customer_id = 1234567890)
select *
from renamed
  );
[0m19:24:24.664852 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m19:24:24.676460 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__customers"
[0m19:24:24.677602 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__customers: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__customers"} */
alter table "IDX-Stock"."IDX-Schema"."stg_eltool__customers" rename to "stg_eltool__customers__dbt_backup"
[0m19:24:24.683788 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:24:24.691237 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__customers"
[0m19:24:24.692258 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__customers: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__customers"} */
alter table "IDX-Stock"."IDX-Schema"."stg_eltool__customers__dbt_tmp" rename to "stg_eltool__customers"
[0m19:24:24.695225 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:24:24.698302 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__customers: COMMIT
[0m19:24:24.699722 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__customers"
[0m19:24:24.700731 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__customers: COMMIT
[0m19:24:24.704207 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m19:24:24.708237 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__customers"
[0m19:24:24.709241 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__customers: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__customers"} */
drop view if exists "IDX-Stock"."IDX-Schema"."stg_eltool__customers__dbt_backup" cascade
[0m19:24:24.713222 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m19:24:24.716795 [debug] [Thread-1 (]: Timing info for model.dbt_idx.stg_eltool__customers (execute): 19:24:24.614239 => 19:24:24.716795
[0m19:24:24.717807 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__customers: Close
[0m19:24:24.719793 [info ] [Thread-1 (]: 2 of 11 OK created sql view model IDX-Schema.stg_eltool__customers ............. [[32mCREATE VIEW[0m in 0.12s]
[0m19:24:24.721793 [debug] [Thread-1 (]: Finished running node model.dbt_idx.stg_eltool__customers
[0m19:24:24.724333 [debug] [Thread-1 (]: Began running node model.dbt_idx.stg_eltool__customers_snapshots
[0m19:24:24.725805 [info ] [Thread-1 (]: 3 of 11 START sql view model IDX-Schema.stg_eltool__customers_snapshots ........ [RUN]
[0m19:24:24.726795 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_idx.stg_eltool__customers, now model.dbt_idx.stg_eltool__customers_snapshots)
[0m19:24:24.728795 [debug] [Thread-1 (]: Began compiling node model.dbt_idx.stg_eltool__customers_snapshots
[0m19:24:24.731828 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_idx.stg_eltool__customers_snapshots"
[0m19:24:24.741040 [debug] [Thread-1 (]: Timing info for model.dbt_idx.stg_eltool__customers_snapshots (compile): 19:24:24.728795 => 19:24:24.740054
[0m19:24:24.742020 [debug] [Thread-1 (]: Began executing node model.dbt_idx.stg_eltool__customers_snapshots
[0m19:24:24.753551 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_idx.stg_eltool__customers_snapshots"
[0m19:24:24.760516 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__customers_snapshots"
[0m19:24:24.761517 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__customers_snapshots: BEGIN
[0m19:24:24.761517 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:24:24.789433 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m19:24:24.790433 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__customers_snapshots"
[0m19:24:24.791437 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__customers_snapshots: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__customers_snapshots"} */

  create view "IDX-Stock"."IDX-Schema"."stg_eltool__customers_snapshots__dbt_tmp"
    
    
  as (
    with source as (select *
                from "IDX-Stock"."snapshots"."customers_snapshot"),
     renamed as (select customer_id,
                        zipcode,
                        city,
                        state_code,
                        datetime_created::TIMESTAMP AS datetime_created,
                        datetime_updated::TIMESTAMP AS datetime_updated,
                        dbt_valid_from,
                        dbt_valid_to
                 from source)
select *
from renamed
  );
[0m19:24:24.796460 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m19:24:24.800981 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__customers_snapshots"
[0m19:24:24.800981 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__customers_snapshots: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__customers_snapshots"} */
alter table "IDX-Stock"."IDX-Schema"."stg_eltool__customers_snapshots" rename to "stg_eltool__customers_snapshots__dbt_backup"
[0m19:24:24.804997 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:24:24.809001 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__customers_snapshots"
[0m19:24:24.809988 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__customers_snapshots: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__customers_snapshots"} */
alter table "IDX-Stock"."IDX-Schema"."stg_eltool__customers_snapshots__dbt_tmp" rename to "stg_eltool__customers_snapshots"
[0m19:24:24.812993 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:24:24.815513 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__customers_snapshots: COMMIT
[0m19:24:24.816531 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__customers_snapshots"
[0m19:24:24.817511 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__customers_snapshots: COMMIT
[0m19:24:24.821054 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m19:24:24.827058 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__customers_snapshots"
[0m19:24:24.829058 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__customers_snapshots: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__customers_snapshots"} */
drop view if exists "IDX-Stock"."IDX-Schema"."stg_eltool__customers_snapshots__dbt_backup" cascade
[0m19:24:24.834589 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m19:24:24.838579 [debug] [Thread-1 (]: Timing info for model.dbt_idx.stg_eltool__customers_snapshots (execute): 19:24:24.743008 => 19:24:24.838579
[0m19:24:24.839580 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__customers_snapshots: Close
[0m19:24:24.842861 [info ] [Thread-1 (]: 3 of 11 OK created sql view model IDX-Schema.stg_eltool__customers_snapshots ... [[32mCREATE VIEW[0m in 0.12s]
[0m19:24:24.845873 [debug] [Thread-1 (]: Finished running node model.dbt_idx.stg_eltool__customers_snapshots
[0m19:24:24.847872 [debug] [Thread-1 (]: Began running node model.dbt_idx.stg_eltool__orders
[0m19:24:24.848869 [info ] [Thread-1 (]: 4 of 11 START sql view model IDX-Schema.stg_eltool__orders ..................... [RUN]
[0m19:24:24.850869 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_idx.stg_eltool__customers_snapshots, now model.dbt_idx.stg_eltool__orders)
[0m19:24:24.851905 [debug] [Thread-1 (]: Began compiling node model.dbt_idx.stg_eltool__orders
[0m19:24:24.856182 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_idx.stg_eltool__orders"
[0m19:24:24.869224 [debug] [Thread-1 (]: Timing info for model.dbt_idx.stg_eltool__orders (compile): 19:24:24.852903 => 19:24:24.869224
[0m19:24:24.871205 [debug] [Thread-1 (]: Began executing node model.dbt_idx.stg_eltool__orders
[0m19:24:24.881156 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_idx.stg_eltool__orders"
[0m19:24:24.897218 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__orders"
[0m19:24:24.898213 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__orders: BEGIN
[0m19:24:24.898213 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:24:24.925074 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m19:24:24.926074 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__orders"
[0m19:24:24.927074 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__orders: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__orders"} */

  create view "IDX-Stock"."IDX-Schema"."stg_eltool__orders__dbt_tmp"
    
    
  as (
    with source as (select *
                from "IDX-Stock"."IDX-Schema"."orders"),
     renamed as (select order_id,
                        cust_id AS customer_id,
                        order_status,
                        order_purchase_timestamp::TIMESTAMP,
                        order_approved_at::TIMESTAMP,
                        order_delivered_carrier_date::TIMESTAMP,
                        order_delivered_customer_date::TIMESTAMP,
                        order_estimated_delivery_date::TIMESTAMP
                 from source)
select *
from renamed
  );
[0m19:24:24.932076 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m19:24:24.937089 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__orders"
[0m19:24:24.938088 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__orders: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__orders"} */
alter table "IDX-Stock"."IDX-Schema"."stg_eltool__orders" rename to "stg_eltool__orders__dbt_backup"
[0m19:24:24.941072 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:24:24.945614 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__orders"
[0m19:24:24.946610 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__orders: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__orders"} */
alter table "IDX-Stock"."IDX-Schema"."stg_eltool__orders__dbt_tmp" rename to "stg_eltool__orders"
[0m19:24:24.949608 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:24:24.951608 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__orders: COMMIT
[0m19:24:24.952607 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__orders"
[0m19:24:24.953613 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__orders: COMMIT
[0m19:24:24.957004 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m19:24:24.960015 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__orders"
[0m19:24:24.961016 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__orders: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__orders"} */
drop view if exists "IDX-Stock"."IDX-Schema"."stg_eltool__orders__dbt_backup" cascade
[0m19:24:24.965019 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m19:24:24.966036 [debug] [Thread-1 (]: Timing info for model.dbt_idx.stg_eltool__orders (execute): 19:24:24.872202 => 19:24:24.966036
[0m19:24:24.967542 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__orders: Close
[0m19:24:24.969550 [info ] [Thread-1 (]: 4 of 11 OK created sql view model IDX-Schema.stg_eltool__orders ................ [[32mCREATE VIEW[0m in 0.12s]
[0m19:24:24.971553 [debug] [Thread-1 (]: Finished running node model.dbt_idx.stg_eltool__orders
[0m19:24:24.972553 [debug] [Thread-1 (]: Began running node model.dbt_idx.stg_eltool__state
[0m19:24:24.973549 [info ] [Thread-1 (]: 5 of 11 START sql view model IDX-Schema.stg_eltool__state ...................... [RUN]
[0m19:24:24.975571 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_idx.stg_eltool__orders, now model.dbt_idx.stg_eltool__state)
[0m19:24:24.976550 [debug] [Thread-1 (]: Began compiling node model.dbt_idx.stg_eltool__state
[0m19:24:24.979549 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_idx.stg_eltool__state"
[0m19:24:24.986553 [debug] [Thread-1 (]: Timing info for model.dbt_idx.stg_eltool__state (compile): 19:24:24.976550 => 19:24:24.985550
[0m19:24:24.987553 [debug] [Thread-1 (]: Began executing node model.dbt_idx.stg_eltool__state
[0m19:24:24.992588 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_idx.stg_eltool__state"
[0m19:24:24.999531 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__state"
[0m19:24:24.999531 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__state: BEGIN
[0m19:24:25.000531 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:24:25.025797 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m19:24:25.026797 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__state"
[0m19:24:25.026797 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__state: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__state"} */

  create view "IDX-Stock"."IDX-Schema"."stg_eltool__state__dbt_tmp"
    
    
  as (
    with source as (select *
                from "IDX-Stock"."IDX-Schema"."state"),
     renamed as (select state_identifier::INT AS state_id,
                         state_code::VARCHAR(2) AS state_code,
                         st_name::VARCHAR(30) AS state_name
                 from source)
select *
from renamed
  );
[0m19:24:25.030798 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m19:24:25.035797 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__state"
[0m19:24:25.036800 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__state: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__state"} */
alter table "IDX-Stock"."IDX-Schema"."stg_eltool__state" rename to "stg_eltool__state__dbt_backup"
[0m19:24:25.039489 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:24:25.042540 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__state"
[0m19:24:25.043500 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__state: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__state"} */
alter table "IDX-Stock"."IDX-Schema"."stg_eltool__state__dbt_tmp" rename to "stg_eltool__state"
[0m19:24:25.045499 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:24:25.048535 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__state: COMMIT
[0m19:24:25.048535 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__state"
[0m19:24:25.049533 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__state: COMMIT
[0m19:24:25.053081 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m19:24:25.057093 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__state"
[0m19:24:25.058129 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__state: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__state"} */
drop view if exists "IDX-Stock"."IDX-Schema"."stg_eltool__state__dbt_backup" cascade
[0m19:24:25.063093 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m19:24:25.065128 [debug] [Thread-1 (]: Timing info for model.dbt_idx.stg_eltool__state (execute): 19:24:24.988549 => 19:24:25.064127
[0m19:24:25.065128 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__state: Close
[0m19:24:25.066152 [info ] [Thread-1 (]: 5 of 11 OK created sql view model IDX-Schema.stg_eltool__state ................. [[32mCREATE VIEW[0m in 0.09s]
[0m19:24:25.068681 [debug] [Thread-1 (]: Finished running node model.dbt_idx.stg_eltool__state
[0m19:24:25.069698 [debug] [Thread-1 (]: Began running node model.dbt_idx.stg_eltool__stock
[0m19:24:25.071679 [info ] [Thread-1 (]: 6 of 11 START sql view model IDX-Schema.stg_eltool__stock ...................... [RUN]
[0m19:24:25.072681 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_idx.stg_eltool__state, now model.dbt_idx.stg_eltool__stock)
[0m19:24:25.073737 [debug] [Thread-1 (]: Began compiling node model.dbt_idx.stg_eltool__stock
[0m19:24:25.076714 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_idx.stg_eltool__stock"
[0m19:24:25.084110 [debug] [Thread-1 (]: Timing info for model.dbt_idx.stg_eltool__stock (compile): 19:24:25.074682 => 19:24:25.083108
[0m19:24:25.085126 [debug] [Thread-1 (]: Began executing node model.dbt_idx.stg_eltool__stock
[0m19:24:25.091143 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_idx.stg_eltool__stock"
[0m19:24:25.097977 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__stock"
[0m19:24:25.098968 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__stock: BEGIN
[0m19:24:25.098968 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:24:25.122540 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m19:24:25.123558 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__stock"
[0m19:24:25.124533 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__stock: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__stock"} */

  create view "IDX-Stock"."IDX-Schema"."stg_eltool__stock__dbt_tmp"
    
    
  as (
    with source as (select *
                from "IDX-Stock"."IDX-Schema"."ksql-stock-stream"),
     renamed as (select *
                 from source)
select *
from renamed
  );
[0m19:24:25.127558 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m19:24:25.131558 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__stock"
[0m19:24:25.132556 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__stock: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__stock"} */
alter table "IDX-Stock"."IDX-Schema"."stg_eltool__stock" rename to "stg_eltool__stock__dbt_backup"
[0m19:24:25.135561 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:24:25.139558 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__stock"
[0m19:24:25.140532 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__stock: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__stock"} */
alter table "IDX-Stock"."IDX-Schema"."stg_eltool__stock__dbt_tmp" rename to "stg_eltool__stock"
[0m19:24:25.142967 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:24:25.145015 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__stock: COMMIT
[0m19:24:25.145981 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__stock"
[0m19:24:25.145981 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__stock: COMMIT
[0m19:24:25.150001 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m19:24:25.154009 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__stock"
[0m19:24:25.155008 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__stock: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__stock"} */
drop view if exists "IDX-Stock"."IDX-Schema"."stg_eltool__stock__dbt_backup" cascade
[0m19:24:25.159118 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m19:24:25.161128 [debug] [Thread-1 (]: Timing info for model.dbt_idx.stg_eltool__stock (execute): 19:24:25.085126 => 19:24:25.160127
[0m19:24:25.161128 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__stock: Close
[0m19:24:25.163107 [info ] [Thread-1 (]: 6 of 11 OK created sql view model IDX-Schema.stg_eltool__stock ................. [[32mCREATE VIEW[0m in 0.09s]
[0m19:24:25.165104 [debug] [Thread-1 (]: Finished running node model.dbt_idx.stg_eltool__stock
[0m19:24:25.166122 [debug] [Thread-1 (]: Began running node model.dbt_idx.fact_orders
[0m19:24:25.167630 [info ] [Thread-1 (]: 7 of 11 START sql table model IDX-Schema.fact_orders ........................... [RUN]
[0m19:24:25.168638 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_idx.stg_eltool__stock, now model.dbt_idx.fact_orders)
[0m19:24:25.169637 [debug] [Thread-1 (]: Began compiling node model.dbt_idx.fact_orders
[0m19:24:25.173639 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_idx.fact_orders"
[0m19:24:25.180639 [debug] [Thread-1 (]: Timing info for model.dbt_idx.fact_orders (compile): 19:24:25.170672 => 19:24:25.180639
[0m19:24:25.182638 [debug] [Thread-1 (]: Began executing node model.dbt_idx.fact_orders
[0m19:24:25.209645 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_idx.fact_orders"
[0m19:24:25.215677 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.fact_orders"
[0m19:24:25.216636 [debug] [Thread-1 (]: On model.dbt_idx.fact_orders: BEGIN
[0m19:24:25.217672 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:24:25.272203 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m19:24:25.273237 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.fact_orders"
[0m19:24:25.274244 [debug] [Thread-1 (]: On model.dbt_idx.fact_orders: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.fact_orders"} */

  
    

  create  table "IDX-Stock"."IDX-Schema"."fact_orders__dbt_tmp"
  
  
    as
  
  (
    with orders as (
    select *
    from "IDX-Stock"."IDX-Schema"."stg_eltool__orders"
)
select * from orders
  );
  
[0m19:24:25.281200 [debug] [Thread-1 (]: SQL status: SELECT 999 in 0.0 seconds
[0m19:24:25.286237 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.fact_orders"
[0m19:24:25.287221 [debug] [Thread-1 (]: On model.dbt_idx.fact_orders: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.fact_orders"} */
alter table "IDX-Stock"."IDX-Schema"."fact_orders" rename to "fact_orders__dbt_backup"
[0m19:24:25.289238 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:24:25.294239 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.fact_orders"
[0m19:24:25.294239 [debug] [Thread-1 (]: On model.dbt_idx.fact_orders: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.fact_orders"} */
alter table "IDX-Stock"."IDX-Schema"."fact_orders__dbt_tmp" rename to "fact_orders"
[0m19:24:25.297223 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:24:25.303201 [debug] [Thread-1 (]: On model.dbt_idx.fact_orders: COMMIT
[0m19:24:25.305212 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.fact_orders"
[0m19:24:25.306201 [debug] [Thread-1 (]: On model.dbt_idx.fact_orders: COMMIT
[0m19:24:25.310219 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m19:24:25.315241 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.fact_orders"
[0m19:24:25.316236 [debug] [Thread-1 (]: On model.dbt_idx.fact_orders: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.fact_orders"} */
drop table if exists "IDX-Stock"."IDX-Schema"."fact_orders__dbt_backup" cascade
[0m19:24:25.323203 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m19:24:25.325238 [debug] [Thread-1 (]: Timing info for model.dbt_idx.fact_orders (execute): 19:24:25.183672 => 19:24:25.324205
[0m19:24:25.325238 [debug] [Thread-1 (]: On model.dbt_idx.fact_orders: Close
[0m19:24:25.328244 [info ] [Thread-1 (]: 7 of 11 OK created sql table model IDX-Schema.fact_orders ...................... [[32mSELECT 999[0m in 0.16s]
[0m19:24:25.330208 [debug] [Thread-1 (]: Finished running node model.dbt_idx.fact_orders
[0m19:24:25.331207 [debug] [Thread-1 (]: Began running node model.dbt_idx.dim_customers
[0m19:24:25.332222 [info ] [Thread-1 (]: 8 of 11 START sql table model IDX-Schema.dim_customers ......................... [RUN]
[0m19:24:25.334222 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_idx.fact_orders, now model.dbt_idx.dim_customers)
[0m19:24:25.335222 [debug] [Thread-1 (]: Began compiling node model.dbt_idx.dim_customers
[0m19:24:25.338236 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_idx.dim_customers"
[0m19:24:25.344233 [debug] [Thread-1 (]: Timing info for model.dbt_idx.dim_customers (compile): 19:24:25.336218 => 19:24:25.344233
[0m19:24:25.345274 [debug] [Thread-1 (]: Began executing node model.dbt_idx.dim_customers
[0m19:24:25.351268 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_idx.dim_customers"
[0m19:24:25.356784 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.dim_customers"
[0m19:24:25.357749 [debug] [Thread-1 (]: On model.dbt_idx.dim_customers: BEGIN
[0m19:24:25.358750 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:24:25.381818 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m19:24:25.382819 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.dim_customers"
[0m19:24:25.383790 [debug] [Thread-1 (]: On model.dbt_idx.dim_customers: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.dim_customers"} */

  
    

  create  table "IDX-Stock"."IDX-Schema"."dim_customers__dbt_tmp"
  
  
    as
  
  (
    -- noinspection SqlDialectInspectionForFile

with customers as (
    select *
    from "IDX-Stock"."IDX-Schema"."stg_eltool__customers_snapshots"
    ),
     state as (
         select *
         from "IDX-Stock"."IDX-Schema"."stg_eltool__state"
     )
select c.customer_id,
       c.zipcode,
       c.city,
       c.state_code,
       s.state_name,
       c.datetime_created,
       c.datetime_updated,
       c.dbt_valid_from::TIMESTAMP as valid_from,
        CASE WHEN c.dbt_valid_to IS NULL
            THEN '9999-12-31'::TIMESTAMP
            ELSE c.dbt_valid_to::TIMESTAMP
        END as valid_to
from customers c
    join state s on c.state_code = s.state_code
  );
  
[0m19:24:25.388835 [debug] [Thread-1 (]: SQL status: SELECT 100 in 0.0 seconds
[0m19:24:25.394807 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.dim_customers"
[0m19:24:25.396789 [debug] [Thread-1 (]: On model.dbt_idx.dim_customers: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.dim_customers"} */
alter table "IDX-Stock"."IDX-Schema"."dim_customers" rename to "dim_customers__dbt_backup"
[0m19:24:25.400794 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:24:25.445796 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.dim_customers"
[0m19:24:25.446786 [debug] [Thread-1 (]: On model.dbt_idx.dim_customers: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.dim_customers"} */
alter table "IDX-Stock"."IDX-Schema"."dim_customers__dbt_tmp" rename to "dim_customers"
[0m19:24:25.449954 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:24:25.452952 [debug] [Thread-1 (]: On model.dbt_idx.dim_customers: COMMIT
[0m19:24:25.453959 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.dim_customers"
[0m19:24:25.454958 [debug] [Thread-1 (]: On model.dbt_idx.dim_customers: COMMIT
[0m19:24:25.458049 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m19:24:25.462108 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.dim_customers"
[0m19:24:25.463052 [debug] [Thread-1 (]: On model.dbt_idx.dim_customers: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.dim_customers"} */
drop table if exists "IDX-Stock"."IDX-Schema"."dim_customers__dbt_backup" cascade
[0m19:24:25.468049 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m19:24:25.469610 [debug] [Thread-1 (]: Timing info for model.dbt_idx.dim_customers (execute): 19:24:25.345274 => 19:24:25.469610
[0m19:24:25.470599 [debug] [Thread-1 (]: On model.dbt_idx.dim_customers: Close
[0m19:24:25.472587 [info ] [Thread-1 (]: 8 of 11 OK created sql table model IDX-Schema.dim_customers .................... [[32mSELECT 100[0m in 0.14s]
[0m19:24:25.473587 [debug] [Thread-1 (]: Finished running node model.dbt_idx.dim_customers
[0m19:24:25.475587 [debug] [Thread-1 (]: Began running node model.dbt_idx.fact_stocks
[0m19:24:25.476630 [info ] [Thread-1 (]: 9 of 11 START sql table model IDX-Schema.fact_stocks ........................... [RUN]
[0m19:24:25.477588 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_idx.dim_customers, now model.dbt_idx.fact_stocks)
[0m19:24:25.478585 [debug] [Thread-1 (]: Began compiling node model.dbt_idx.fact_stocks
[0m19:24:25.481609 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_idx.fact_stocks"
[0m19:24:25.489601 [debug] [Thread-1 (]: Timing info for model.dbt_idx.fact_stocks (compile): 19:24:25.478585 => 19:24:25.488589
[0m19:24:25.490620 [debug] [Thread-1 (]: Began executing node model.dbt_idx.fact_stocks
[0m19:24:25.497609 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_idx.fact_stocks"
[0m19:24:25.503859 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.fact_stocks"
[0m19:24:25.504842 [debug] [Thread-1 (]: On model.dbt_idx.fact_stocks: BEGIN
[0m19:24:25.504842 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:24:25.527843 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m19:24:25.528842 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.fact_stocks"
[0m19:24:25.529860 [debug] [Thread-1 (]: On model.dbt_idx.fact_stocks: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.fact_stocks"} */

  
    

  create  table "IDX-Stock"."IDX-Schema"."fact_stocks__dbt_tmp"
  
  
    as
  
  (
    -- noinspection SqlDialectInspectionForFile

with stock as (
    select *
    from "IDX-Stock"."IDX-Schema"."stg_eltool__stock"
    ),
     company as (
         select *
         from "IDX-Stock"."IDX-Schema"."stg_eltool__company"
     )
select a.id,
       a.ticker,
       b.name,
       a.date,
       a.open,
       a.high,
       a.low,
       a.close,
       a.volume,
       b.logo
from stock a
    join company b on a.ticker = b.ticker
  );
  
[0m19:24:25.579942 [debug] [Thread-1 (]: SQL status: SELECT 26131 in 0.0 seconds
[0m19:24:25.583975 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.fact_stocks"
[0m19:24:25.584952 [debug] [Thread-1 (]: On model.dbt_idx.fact_stocks: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.fact_stocks"} */
alter table "IDX-Stock"."IDX-Schema"."fact_stocks" rename to "fact_stocks__dbt_backup"
[0m19:24:25.586941 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:24:25.591489 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.fact_stocks"
[0m19:24:25.592478 [debug] [Thread-1 (]: On model.dbt_idx.fact_stocks: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.fact_stocks"} */
alter table "IDX-Stock"."IDX-Schema"."fact_stocks__dbt_tmp" rename to "fact_stocks"
[0m19:24:25.594487 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:24:25.597484 [debug] [Thread-1 (]: On model.dbt_idx.fact_stocks: COMMIT
[0m19:24:25.598459 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.fact_stocks"
[0m19:24:25.598459 [debug] [Thread-1 (]: On model.dbt_idx.fact_stocks: COMMIT
[0m19:24:25.609381 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m19:24:25.612416 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.fact_stocks"
[0m19:24:25.613413 [debug] [Thread-1 (]: On model.dbt_idx.fact_stocks: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.fact_stocks"} */
drop table if exists "IDX-Stock"."IDX-Schema"."fact_stocks__dbt_backup" cascade
[0m19:24:25.618718 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m19:24:25.619745 [debug] [Thread-1 (]: Timing info for model.dbt_idx.fact_stocks (execute): 19:24:25.491606 => 19:24:25.619745
[0m19:24:25.620743 [debug] [Thread-1 (]: On model.dbt_idx.fact_stocks: Close
[0m19:24:25.622725 [info ] [Thread-1 (]: 9 of 11 OK created sql table model IDX-Schema.fact_stocks ...................... [[32mSELECT 26131[0m in 0.15s]
[0m19:24:25.625719 [debug] [Thread-1 (]: Finished running node model.dbt_idx.fact_stocks
[0m19:24:25.626719 [debug] [Thread-1 (]: Began running node model.dbt_idx.customer_orders_status
[0m19:24:25.627723 [info ] [Thread-1 (]: 10 of 11 START sql view model IDX-Schema.customer_orders_status ................ [RUN]
[0m19:24:25.628721 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_idx.fact_stocks, now model.dbt_idx.customer_orders_status)
[0m19:24:25.629717 [debug] [Thread-1 (]: Began compiling node model.dbt_idx.customer_orders_status
[0m19:24:25.633755 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_idx.customer_orders_status"
[0m19:24:25.640803 [debug] [Thread-1 (]: Timing info for model.dbt_idx.customer_orders_status (compile): 19:24:25.630724 => 19:24:25.639810
[0m19:24:25.640803 [debug] [Thread-1 (]: Began executing node model.dbt_idx.customer_orders_status
[0m19:24:25.646789 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_idx.customer_orders_status"
[0m19:24:25.653553 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.customer_orders_status"
[0m19:24:25.654565 [debug] [Thread-1 (]: On model.dbt_idx.customer_orders_status: BEGIN
[0m19:24:25.654565 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:24:25.675784 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m19:24:25.677786 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.customer_orders_status"
[0m19:24:25.678783 [debug] [Thread-1 (]: On model.dbt_idx.customer_orders_status: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.customer_orders_status"} */

  create view "IDX-Stock"."IDX-Schema"."customer_orders_status__dbt_tmp"
    
    
  as (
    with orders as (select *
                from "IDX-Stock"."IDX-Schema"."fact_orders"),
     customers as (select *
                   from "IDX-Stock"."IDX-Schema"."dim_customers")
select o.order_id,
       o.customer_id,
       o.order_status,
       o.order_purchase_timestamp,
       o.order_approved_at,
       o.order_delivered_carrier_date,
       o.order_delivered_customer_date,
       o.order_estimated_delivery_date,
       c.zipcode    as customer_zipcode,
       c.city       as customer_city,
       c.state_code as customer_state_code,
       c.state_name as customer_state_name
from orders o
    join customers c on o.customer_id = c.customer_id
    and o.order_purchase_timestamp >= c.valid_from
    and o.order_purchase_timestamp <= c.valid_to
  );
[0m19:24:25.683783 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m19:24:25.689816 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.customer_orders_status"
[0m19:24:25.690783 [debug] [Thread-1 (]: On model.dbt_idx.customer_orders_status: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.customer_orders_status"} */
alter table "IDX-Stock"."IDX-Schema"."customer_orders_status__dbt_tmp" rename to "customer_orders_status"
[0m19:24:25.692780 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:24:25.694816 [debug] [Thread-1 (]: On model.dbt_idx.customer_orders_status: COMMIT
[0m19:24:25.694816 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.customer_orders_status"
[0m19:24:25.695781 [debug] [Thread-1 (]: On model.dbt_idx.customer_orders_status: COMMIT
[0m19:24:25.699811 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m19:24:25.702810 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.customer_orders_status"
[0m19:24:25.703817 [debug] [Thread-1 (]: On model.dbt_idx.customer_orders_status: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.customer_orders_status"} */
drop view if exists "IDX-Stock"."IDX-Schema"."customer_orders_status__dbt_backup" cascade
[0m19:24:25.705782 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m19:24:25.707813 [debug] [Thread-1 (]: Timing info for model.dbt_idx.customer_orders_status (execute): 19:24:25.641806 => 19:24:25.707813
[0m19:24:25.708790 [debug] [Thread-1 (]: On model.dbt_idx.customer_orders_status: Close
[0m19:24:25.710787 [info ] [Thread-1 (]: 10 of 11 OK created sql view model IDX-Schema.customer_orders_status ........... [[32mCREATE VIEW[0m in 0.08s]
[0m19:24:25.712809 [debug] [Thread-1 (]: Finished running node model.dbt_idx.customer_orders_status
[0m19:24:25.713797 [debug] [Thread-1 (]: Began running node model.dbt_idx.stock_update_status
[0m19:24:25.714808 [info ] [Thread-1 (]: 11 of 11 START sql view model IDX-Schema.stock_update_status ................... [RUN]
[0m19:24:25.715788 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_idx.customer_orders_status, now model.dbt_idx.stock_update_status)
[0m19:24:25.716801 [debug] [Thread-1 (]: Began compiling node model.dbt_idx.stock_update_status
[0m19:24:25.719823 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_idx.stock_update_status"
[0m19:24:25.724509 [debug] [Thread-1 (]: Timing info for model.dbt_idx.stock_update_status (compile): 19:24:25.717788 => 19:24:25.723999
[0m19:24:25.724509 [debug] [Thread-1 (]: Began executing node model.dbt_idx.stock_update_status
[0m19:24:25.730515 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_idx.stock_update_status"
[0m19:24:25.735517 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stock_update_status"
[0m19:24:25.736518 [debug] [Thread-1 (]: On model.dbt_idx.stock_update_status: BEGIN
[0m19:24:25.737517 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:24:25.758560 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m19:24:25.759574 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stock_update_status"
[0m19:24:25.760562 [debug] [Thread-1 (]: On model.dbt_idx.stock_update_status: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stock_update_status"} */

  create view "IDX-Stock"."IDX-Schema"."stock_update_status__dbt_tmp"
    
    
  as (
    with stock as (select *
                from "IDX-Stock"."IDX-Schema"."fact_stocks")
                )
select *
from stock a
  );
[0m19:24:25.762511 [debug] [Thread-1 (]: Postgres adapter: Postgres error: syntax error at or near ")"
LINE 9:                 )
                        ^

[0m19:24:25.763541 [debug] [Thread-1 (]: On model.dbt_idx.stock_update_status: ROLLBACK
[0m19:24:25.765510 [debug] [Thread-1 (]: Timing info for model.dbt_idx.stock_update_status (execute): 19:24:25.725515 => 19:24:25.765510
[0m19:24:25.766560 [debug] [Thread-1 (]: On model.dbt_idx.stock_update_status: Close
[0m19:24:25.785546 [debug] [Thread-1 (]: Database Error in model stock_update_status (models\marts\stock\stock_update_status.sql)
  syntax error at or near ")"
  LINE 9:                 )
                          ^
  compiled Code at target\run\dbt_idx\models\marts\stock\stock_update_status.sql
[0m19:24:25.786508 [error] [Thread-1 (]: 11 of 11 ERROR creating sql view model IDX-Schema.stock_update_status .......... [[31mERROR[0m in 0.07s]
[0m19:24:25.788509 [debug] [Thread-1 (]: Finished running node model.dbt_idx.stock_update_status
[0m19:24:25.790698 [debug] [MainThread]: Using postgres connection "master"
[0m19:24:25.791718 [debug] [MainThread]: On master: BEGIN
[0m19:24:25.792762 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m19:24:25.814839 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m19:24:25.815876 [debug] [MainThread]: On master: COMMIT
[0m19:24:25.815876 [debug] [MainThread]: Using postgres connection "master"
[0m19:24:25.816880 [debug] [MainThread]: On master: COMMIT
[0m19:24:25.818858 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m19:24:25.819840 [debug] [MainThread]: On master: Close
[0m19:24:25.820852 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:24:25.821843 [debug] [MainThread]: Connection 'list_IDX-Stock' was properly closed.
[0m19:24:25.822873 [debug] [MainThread]: Connection 'list_IDX-Stock_snapshots' was properly closed.
[0m19:24:25.823865 [debug] [MainThread]: Connection 'model.dbt_idx.stock_update_status' was properly closed.
[0m19:24:25.823865 [info ] [MainThread]: 
[0m19:24:25.825844 [info ] [MainThread]: Finished running 8 view models, 3 table models in 0 hours 0 minutes and 1.60 seconds (1.60s).
[0m19:24:25.829840 [debug] [MainThread]: Command end result
[0m19:24:25.854881 [info ] [MainThread]: 
[0m19:24:25.855894 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m19:24:25.856906 [info ] [MainThread]: 
[0m19:24:25.857880 [error] [MainThread]: [33mDatabase Error in model stock_update_status (models\marts\stock\stock_update_status.sql)[0m
[0m19:24:25.858900 [error] [MainThread]:   syntax error at or near ")"
[0m19:24:25.859912 [error] [MainThread]:   LINE 9:                 )
[0m19:24:25.861893 [error] [MainThread]:                           ^
[0m19:24:25.862886 [error] [MainThread]:   compiled Code at target\run\dbt_idx\models\marts\stock\stock_update_status.sql
[0m19:24:25.863917 [info ] [MainThread]: 
[0m19:24:25.864923 [info ] [MainThread]: Done. PASS=10 WARN=0 ERROR=1 SKIP=0 TOTAL=11
[0m19:24:25.865916 [debug] [MainThread]: Command `dbt run` failed at 19:24:25.865916 after 2.13 seconds
[0m19:24:25.866922 [debug] [MainThread]: Flushing usage events


============================== 19:24:40.623464 | 3136f047-6e21-40d7-9130-12ae106eb040 ==============================
[0m19:24:40.623464 [info ] [MainThread]: Running with dbt=1.6.1
[0m19:24:40.629467 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': 'D:\\00 Project\\00 My Project\\IdeaProjects\\Py-DBT-IDX', 'log_path': 'D:\\00 Project\\00 My Project\\IdeaProjects\\Py-DBT-IDX\\logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'False'}
[0m19:24:40.828728 [info ] [MainThread]: Registered adapter: postgres=1.6.1
[0m19:24:40.843789 [debug] [MainThread]: checksum: efe19d9f5b93d1a98cc804fbfcdb6b3aced98b974af664946fee1cde8837deb7, vars: {}, profile: , target: , version: 1.6.1
[0m19:24:41.017533 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m19:24:41.018532 [debug] [MainThread]: Partial parsing: updated file: dbt_idx://models\marts\stock\stock_update_status.sql
[0m19:24:41.141776 [info ] [MainThread]: Found 11 models, 1 snapshot, 18 tests, 5 sources, 0 exposures, 0 metrics, 349 macros, 0 groups, 0 semantic models
[0m19:24:41.144764 [info ] [MainThread]: 
[0m19:24:41.146768 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m19:24:41.149279 [debug] [ThreadPool]: Acquiring new postgres connection 'list_IDX-Stock'
[0m19:24:41.162470 [debug] [ThreadPool]: Using postgres connection "list_IDX-Stock"
[0m19:24:41.163287 [debug] [ThreadPool]: On list_IDX-Stock: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "connection_name": "list_IDX-Stock"} */

    select distinct nspname from pg_namespace
  
[0m19:24:41.164285 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:24:41.197884 [debug] [ThreadPool]: SQL status: SELECT 12 in 0.0 seconds
[0m19:24:41.199881 [debug] [ThreadPool]: On list_IDX-Stock: Close
[0m19:24:41.204847 [debug] [ThreadPool]: Acquiring new postgres connection 'list_IDX-Stock_snapshots'
[0m19:24:41.211885 [debug] [ThreadPool]: Using postgres connection "list_IDX-Stock_snapshots"
[0m19:24:41.212853 [debug] [ThreadPool]: On list_IDX-Stock_snapshots: BEGIN
[0m19:24:41.213851 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:24:41.238952 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m19:24:41.239937 [debug] [ThreadPool]: Using postgres connection "list_IDX-Stock_snapshots"
[0m19:24:41.240882 [debug] [ThreadPool]: On list_IDX-Stock_snapshots: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "connection_name": "list_IDX-Stock_snapshots"} */
select
      'IDX-Stock' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'snapshots'
    union all
    select
      'IDX-Stock' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'snapshots'
    union all
    select
      'IDX-Stock' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'snapshots'
  
[0m19:24:41.246919 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.0 seconds
[0m19:24:41.248918 [debug] [ThreadPool]: On list_IDX-Stock_snapshots: ROLLBACK
[0m19:24:41.251446 [debug] [ThreadPool]: On list_IDX-Stock_snapshots: Close
[0m19:24:41.253441 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_IDX-Stock_snapshots, now list_IDX-Stock_IDX-Schema)
[0m19:24:41.257955 [debug] [ThreadPool]: Using postgres connection "list_IDX-Stock_IDX-Schema"
[0m19:24:41.258963 [debug] [ThreadPool]: On list_IDX-Stock_IDX-Schema: BEGIN
[0m19:24:41.259963 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:24:41.283601 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m19:24:41.285143 [debug] [ThreadPool]: Using postgres connection "list_IDX-Stock_IDX-Schema"
[0m19:24:41.286184 [debug] [ThreadPool]: On list_IDX-Stock_IDX-Schema: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "connection_name": "list_IDX-Stock_IDX-Schema"} */
select
      'IDX-Stock' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'IDX-Schema'
    union all
    select
      'IDX-Stock' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'IDX-Schema'
    union all
    select
      'IDX-Stock' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'IDX-Schema'
  
[0m19:24:41.291173 [debug] [ThreadPool]: SQL status: SELECT 16 in 0.0 seconds
[0m19:24:41.294186 [debug] [ThreadPool]: On list_IDX-Stock_IDX-Schema: ROLLBACK
[0m19:24:41.296205 [debug] [ThreadPool]: On list_IDX-Stock_IDX-Schema: Close
[0m19:24:41.306686 [debug] [MainThread]: Using postgres connection "master"
[0m19:24:41.306686 [debug] [MainThread]: On master: BEGIN
[0m19:24:41.307686 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:24:41.329218 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m19:24:41.330260 [debug] [MainThread]: Using postgres connection "master"
[0m19:24:41.331781 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m19:24:41.340728 [debug] [MainThread]: SQL status: SELECT 8 in 0.0 seconds
[0m19:24:41.345305 [debug] [MainThread]: On master: ROLLBACK
[0m19:24:41.347316 [debug] [MainThread]: Using postgres connection "master"
[0m19:24:41.348557 [debug] [MainThread]: On master: BEGIN
[0m19:24:41.353561 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m19:24:41.354559 [debug] [MainThread]: On master: COMMIT
[0m19:24:41.354559 [debug] [MainThread]: Using postgres connection "master"
[0m19:24:41.355591 [debug] [MainThread]: On master: COMMIT
[0m19:24:41.357903 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m19:24:41.358586 [debug] [MainThread]: On master: Close
[0m19:24:41.360558 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m19:24:41.362574 [info ] [MainThread]: 
[0m19:24:41.368230 [debug] [Thread-1 (]: Began running node model.dbt_idx.stg_eltool__company
[0m19:24:41.369227 [info ] [Thread-1 (]: 1 of 11 START sql view model IDX-Schema.stg_eltool__company .................... [RUN]
[0m19:24:41.371271 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.dbt_idx.stg_eltool__company'
[0m19:24:41.371271 [debug] [Thread-1 (]: Began compiling node model.dbt_idx.stg_eltool__company
[0m19:24:41.379271 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_idx.stg_eltool__company"
[0m19:24:41.389371 [debug] [Thread-1 (]: Timing info for model.dbt_idx.stg_eltool__company (compile): 19:24:41.372272 => 19:24:41.388372
[0m19:24:41.390345 [debug] [Thread-1 (]: Began executing node model.dbt_idx.stg_eltool__company
[0m19:24:41.439336 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_idx.stg_eltool__company"
[0m19:24:41.447394 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__company"
[0m19:24:41.448398 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__company: BEGIN
[0m19:24:41.449395 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m19:24:41.470843 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m19:24:41.471846 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__company"
[0m19:24:41.471846 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__company: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__company"} */

  create view "IDX-Stock"."IDX-Schema"."stg_eltool__company__dbt_tmp"
    
    
  as (
    with source as (select *
                from "IDX-Stock"."IDX-Schema"."ksql-company-stream"),
     renamed as (select id,
                        ticker,
                        name,
                        logo
                 from source)
select *
from renamed
  );
[0m19:24:41.475876 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m19:24:41.483845 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__company"
[0m19:24:41.483845 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__company: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__company"} */
alter table "IDX-Stock"."IDX-Schema"."stg_eltool__company" rename to "stg_eltool__company__dbt_backup"
[0m19:24:41.487388 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:24:41.493970 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__company"
[0m19:24:41.494935 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__company: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__company"} */
alter table "IDX-Stock"."IDX-Schema"."stg_eltool__company__dbt_tmp" rename to "stg_eltool__company"
[0m19:24:41.497942 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:24:41.515554 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__company: COMMIT
[0m19:24:41.516550 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__company"
[0m19:24:41.517542 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__company: COMMIT
[0m19:24:41.521555 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m19:24:41.530138 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__company"
[0m19:24:41.531138 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__company: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__company"} */
drop view if exists "IDX-Stock"."IDX-Schema"."stg_eltool__company__dbt_backup" cascade
[0m19:24:41.535942 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m19:24:41.537944 [debug] [Thread-1 (]: Timing info for model.dbt_idx.stg_eltool__company (execute): 19:24:41.391333 => 19:24:41.537944
[0m19:24:41.538964 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__company: Close
[0m19:24:41.541957 [info ] [Thread-1 (]: 1 of 11 OK created sql view model IDX-Schema.stg_eltool__company ............... [[32mCREATE VIEW[0m in 0.17s]
[0m19:24:41.544953 [debug] [Thread-1 (]: Finished running node model.dbt_idx.stg_eltool__company
[0m19:24:41.545947 [debug] [Thread-1 (]: Began running node model.dbt_idx.stg_eltool__customers
[0m19:24:41.546961 [info ] [Thread-1 (]: 2 of 11 START sql view model IDX-Schema.stg_eltool__customers .................. [RUN]
[0m19:24:41.547953 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_idx.stg_eltool__company, now model.dbt_idx.stg_eltool__customers)
[0m19:24:41.548947 [debug] [Thread-1 (]: Began compiling node model.dbt_idx.stg_eltool__customers
[0m19:24:41.551946 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_idx.stg_eltool__customers"
[0m19:24:41.558948 [debug] [Thread-1 (]: Timing info for model.dbt_idx.stg_eltool__customers (compile): 19:24:41.549965 => 19:24:41.557947
[0m19:24:41.559946 [debug] [Thread-1 (]: Began executing node model.dbt_idx.stg_eltool__customers
[0m19:24:41.564301 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_idx.stg_eltool__customers"
[0m19:24:41.571312 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__customers"
[0m19:24:41.572325 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__customers: BEGIN
[0m19:24:41.573312 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:24:41.595532 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m19:24:41.597535 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__customers"
[0m19:24:41.597535 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__customers: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__customers"} */

  create view "IDX-Stock"."IDX-Schema"."stg_eltool__customers__dbt_tmp"
    
    
  as (
    with source as (select *
                from "IDX-Stock"."IDX-Schema"."customers"),
     renamed as (select
                     customer_id,
                    'This is Dummy' as dummy
                 from source
                 where customer_id = 1234567890)
select *
from renamed
  );
[0m19:24:41.602056 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m19:24:41.605596 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__customers"
[0m19:24:41.606606 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__customers: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__customers"} */
alter table "IDX-Stock"."IDX-Schema"."stg_eltool__customers" rename to "stg_eltool__customers__dbt_backup"
[0m19:24:41.609606 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:24:41.612606 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__customers"
[0m19:24:41.613607 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__customers: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__customers"} */
alter table "IDX-Stock"."IDX-Schema"."stg_eltool__customers__dbt_tmp" rename to "stg_eltool__customers"
[0m19:24:41.616180 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:24:41.619153 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__customers: COMMIT
[0m19:24:41.620155 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__customers"
[0m19:24:41.621153 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__customers: COMMIT
[0m19:24:41.624929 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m19:24:41.627938 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__customers"
[0m19:24:41.628940 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__customers: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__customers"} */
drop view if exists "IDX-Stock"."IDX-Schema"."stg_eltool__customers__dbt_backup" cascade
[0m19:24:41.633936 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m19:24:41.636187 [debug] [Thread-1 (]: Timing info for model.dbt_idx.stg_eltool__customers (execute): 19:24:41.559946 => 19:24:41.636187
[0m19:24:41.637165 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__customers: Close
[0m19:24:41.639158 [info ] [Thread-1 (]: 2 of 11 OK created sql view model IDX-Schema.stg_eltool__customers ............. [[32mCREATE VIEW[0m in 0.09s]
[0m19:24:41.641163 [debug] [Thread-1 (]: Finished running node model.dbt_idx.stg_eltool__customers
[0m19:24:41.643156 [debug] [Thread-1 (]: Began running node model.dbt_idx.stg_eltool__customers_snapshots
[0m19:24:41.644168 [info ] [Thread-1 (]: 3 of 11 START sql view model IDX-Schema.stg_eltool__customers_snapshots ........ [RUN]
[0m19:24:41.647161 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_idx.stg_eltool__customers, now model.dbt_idx.stg_eltool__customers_snapshots)
[0m19:24:41.648156 [debug] [Thread-1 (]: Began compiling node model.dbt_idx.stg_eltool__customers_snapshots
[0m19:24:41.653155 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_idx.stg_eltool__customers_snapshots"
[0m19:24:41.660154 [debug] [Thread-1 (]: Timing info for model.dbt_idx.stg_eltool__customers_snapshots (compile): 19:24:41.649152 => 19:24:41.660154
[0m19:24:41.661189 [debug] [Thread-1 (]: Began executing node model.dbt_idx.stg_eltool__customers_snapshots
[0m19:24:41.669188 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_idx.stg_eltool__customers_snapshots"
[0m19:24:41.675152 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__customers_snapshots"
[0m19:24:41.676201 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__customers_snapshots: BEGIN
[0m19:24:41.676745 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:24:41.703811 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m19:24:41.704846 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__customers_snapshots"
[0m19:24:41.705813 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__customers_snapshots: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__customers_snapshots"} */

  create view "IDX-Stock"."IDX-Schema"."stg_eltool__customers_snapshots__dbt_tmp"
    
    
  as (
    with source as (select *
                from "IDX-Stock"."snapshots"."customers_snapshot"),
     renamed as (select customer_id,
                        zipcode,
                        city,
                        state_code,
                        datetime_created::TIMESTAMP AS datetime_created,
                        datetime_updated::TIMESTAMP AS datetime_updated,
                        dbt_valid_from,
                        dbt_valid_to
                 from source)
select *
from renamed
  );
[0m19:24:41.711719 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m19:24:41.715739 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__customers_snapshots"
[0m19:24:41.716717 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__customers_snapshots: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__customers_snapshots"} */
alter table "IDX-Stock"."IDX-Schema"."stg_eltool__customers_snapshots" rename to "stg_eltool__customers_snapshots__dbt_backup"
[0m19:24:41.720252 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:24:41.725243 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__customers_snapshots"
[0m19:24:41.727242 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__customers_snapshots: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__customers_snapshots"} */
alter table "IDX-Stock"."IDX-Schema"."stg_eltool__customers_snapshots__dbt_tmp" rename to "stg_eltool__customers_snapshots"
[0m19:24:41.731243 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:24:41.735813 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__customers_snapshots: COMMIT
[0m19:24:41.736837 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__customers_snapshots"
[0m19:24:41.737812 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__customers_snapshots: COMMIT
[0m19:24:41.743806 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m19:24:41.747804 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__customers_snapshots"
[0m19:24:41.748805 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__customers_snapshots: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__customers_snapshots"} */
drop view if exists "IDX-Stock"."IDX-Schema"."stg_eltool__customers_snapshots__dbt_backup" cascade
[0m19:24:41.753321 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m19:24:41.756839 [debug] [Thread-1 (]: Timing info for model.dbt_idx.stg_eltool__customers_snapshots (execute): 19:24:41.662195 => 19:24:41.755321
[0m19:24:41.757846 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__customers_snapshots: Close
[0m19:24:41.759850 [info ] [Thread-1 (]: 3 of 11 OK created sql view model IDX-Schema.stg_eltool__customers_snapshots ... [[32mCREATE VIEW[0m in 0.11s]
[0m19:24:41.762453 [debug] [Thread-1 (]: Finished running node model.dbt_idx.stg_eltool__customers_snapshots
[0m19:24:41.763457 [debug] [Thread-1 (]: Began running node model.dbt_idx.stg_eltool__orders
[0m19:24:41.764452 [info ] [Thread-1 (]: 4 of 11 START sql view model IDX-Schema.stg_eltool__orders ..................... [RUN]
[0m19:24:41.765457 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_idx.stg_eltool__customers_snapshots, now model.dbt_idx.stg_eltool__orders)
[0m19:24:41.766451 [debug] [Thread-1 (]: Began compiling node model.dbt_idx.stg_eltool__orders
[0m19:24:41.769449 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_idx.stg_eltool__orders"
[0m19:24:41.784090 [debug] [Thread-1 (]: Timing info for model.dbt_idx.stg_eltool__orders (compile): 19:24:41.767452 => 19:24:41.783087
[0m19:24:41.784090 [debug] [Thread-1 (]: Began executing node model.dbt_idx.stg_eltool__orders
[0m19:24:41.792161 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_idx.stg_eltool__orders"
[0m19:24:41.804715 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__orders"
[0m19:24:41.805714 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__orders: BEGIN
[0m19:24:41.805714 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:24:41.832393 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m19:24:41.833377 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__orders"
[0m19:24:41.834383 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__orders: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__orders"} */

  create view "IDX-Stock"."IDX-Schema"."stg_eltool__orders__dbt_tmp"
    
    
  as (
    with source as (select *
                from "IDX-Stock"."IDX-Schema"."orders"),
     renamed as (select order_id,
                        cust_id AS customer_id,
                        order_status,
                        order_purchase_timestamp::TIMESTAMP,
                        order_approved_at::TIMESTAMP,
                        order_delivered_carrier_date::TIMESTAMP,
                        order_delivered_customer_date::TIMESTAMP,
                        order_estimated_delivery_date::TIMESTAMP
                 from source)
select *
from renamed
  );
[0m19:24:41.839890 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m19:24:41.845900 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__orders"
[0m19:24:41.846899 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__orders: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__orders"} */
alter table "IDX-Stock"."IDX-Schema"."stg_eltool__orders" rename to "stg_eltool__orders__dbt_backup"
[0m19:24:41.849003 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:24:41.855001 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__orders"
[0m19:24:41.856000 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__orders: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__orders"} */
alter table "IDX-Stock"."IDX-Schema"."stg_eltool__orders__dbt_tmp" rename to "stg_eltool__orders"
[0m19:24:41.858004 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:24:41.861530 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__orders: COMMIT
[0m19:24:41.862528 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__orders"
[0m19:24:41.863527 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__orders: COMMIT
[0m19:24:41.867083 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m19:24:41.871105 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__orders"
[0m19:24:41.872079 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__orders: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__orders"} */
drop view if exists "IDX-Stock"."IDX-Schema"."stg_eltool__orders__dbt_backup" cascade
[0m19:24:41.876142 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m19:24:41.879115 [debug] [Thread-1 (]: Timing info for model.dbt_idx.stg_eltool__orders (execute): 19:24:41.786608 => 19:24:41.878134
[0m19:24:41.879115 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__orders: Close
[0m19:24:41.881710 [info ] [Thread-1 (]: 4 of 11 OK created sql view model IDX-Schema.stg_eltool__orders ................ [[32mCREATE VIEW[0m in 0.11s]
[0m19:24:41.883786 [debug] [Thread-1 (]: Finished running node model.dbt_idx.stg_eltool__orders
[0m19:24:41.885781 [debug] [Thread-1 (]: Began running node model.dbt_idx.stg_eltool__state
[0m19:24:41.886585 [info ] [Thread-1 (]: 5 of 11 START sql view model IDX-Schema.stg_eltool__state ...................... [RUN]
[0m19:24:41.889595 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_idx.stg_eltool__orders, now model.dbt_idx.stg_eltool__state)
[0m19:24:41.890609 [debug] [Thread-1 (]: Began compiling node model.dbt_idx.stg_eltool__state
[0m19:24:41.898124 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_idx.stg_eltool__state"
[0m19:24:41.907214 [debug] [Thread-1 (]: Timing info for model.dbt_idx.stg_eltool__state (compile): 19:24:41.891592 => 19:24:41.907214
[0m19:24:41.909274 [debug] [Thread-1 (]: Began executing node model.dbt_idx.stg_eltool__state
[0m19:24:41.916213 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_idx.stg_eltool__state"
[0m19:24:41.924756 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__state"
[0m19:24:41.925755 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__state: BEGIN
[0m19:24:41.925755 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:24:41.950040 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m19:24:41.951024 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__state"
[0m19:24:41.952040 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__state: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__state"} */

  create view "IDX-Stock"."IDX-Schema"."stg_eltool__state__dbt_tmp"
    
    
  as (
    with source as (select *
                from "IDX-Stock"."IDX-Schema"."state"),
     renamed as (select state_identifier::INT AS state_id,
                         state_code::VARCHAR(2) AS state_code,
                         st_name::VARCHAR(30) AS state_name
                 from source)
select *
from renamed
  );
[0m19:24:41.955025 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m19:24:41.959498 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__state"
[0m19:24:41.960464 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__state: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__state"} */
alter table "IDX-Stock"."IDX-Schema"."stg_eltool__state" rename to "stg_eltool__state__dbt_backup"
[0m19:24:41.964154 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:24:41.969167 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__state"
[0m19:24:41.970168 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__state: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__state"} */
alter table "IDX-Stock"."IDX-Schema"."stg_eltool__state__dbt_tmp" rename to "stg_eltool__state"
[0m19:24:41.972169 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:24:41.974719 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__state: COMMIT
[0m19:24:41.976692 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__state"
[0m19:24:41.976692 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__state: COMMIT
[0m19:24:41.980716 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m19:24:41.985717 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__state"
[0m19:24:41.987097 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__state: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__state"} */
drop view if exists "IDX-Stock"."IDX-Schema"."stg_eltool__state__dbt_backup" cascade
[0m19:24:41.991080 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m19:24:41.994117 [debug] [Thread-1 (]: Timing info for model.dbt_idx.stg_eltool__state (execute): 19:24:41.910237 => 19:24:41.993113
[0m19:24:41.994117 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__state: Close
[0m19:24:41.996282 [info ] [Thread-1 (]: 5 of 11 OK created sql view model IDX-Schema.stg_eltool__state ................. [[32mCREATE VIEW[0m in 0.11s]
[0m19:24:41.998286 [debug] [Thread-1 (]: Finished running node model.dbt_idx.stg_eltool__state
[0m19:24:41.999296 [debug] [Thread-1 (]: Began running node model.dbt_idx.stg_eltool__stock
[0m19:24:42.001314 [info ] [Thread-1 (]: 6 of 11 START sql view model IDX-Schema.stg_eltool__stock ...................... [RUN]
[0m19:24:42.002279 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_idx.stg_eltool__state, now model.dbt_idx.stg_eltool__stock)
[0m19:24:42.003314 [debug] [Thread-1 (]: Began compiling node model.dbt_idx.stg_eltool__stock
[0m19:24:42.007314 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_idx.stg_eltool__stock"
[0m19:24:42.014279 [debug] [Thread-1 (]: Timing info for model.dbt_idx.stg_eltool__stock (compile): 19:24:42.004319 => 19:24:42.013307
[0m19:24:42.015298 [debug] [Thread-1 (]: Began executing node model.dbt_idx.stg_eltool__stock
[0m19:24:42.020948 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_idx.stg_eltool__stock"
[0m19:24:42.027908 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__stock"
[0m19:24:42.027908 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__stock: BEGIN
[0m19:24:42.028906 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:24:42.050981 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m19:24:42.051989 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__stock"
[0m19:24:42.052988 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__stock: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__stock"} */

  create view "IDX-Stock"."IDX-Schema"."stg_eltool__stock__dbt_tmp"
    
    
  as (
    with source as (select *
                from "IDX-Stock"."IDX-Schema"."ksql-stock-stream"),
     renamed as (select *
                 from source)
select *
from renamed
  );
[0m19:24:42.058014 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m19:24:42.062025 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__stock"
[0m19:24:42.062995 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__stock: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__stock"} */
alter table "IDX-Stock"."IDX-Schema"."stg_eltool__stock" rename to "stg_eltool__stock__dbt_backup"
[0m19:24:42.065987 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:24:42.070536 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__stock"
[0m19:24:42.071543 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__stock: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__stock"} */
alter table "IDX-Stock"."IDX-Schema"."stg_eltool__stock__dbt_tmp" rename to "stg_eltool__stock"
[0m19:24:42.074543 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:24:42.076578 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__stock: COMMIT
[0m19:24:42.077578 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__stock"
[0m19:24:42.078547 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__stock: COMMIT
[0m19:24:42.081544 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m19:24:42.086890 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__stock"
[0m19:24:42.086890 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__stock: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__stock"} */
drop view if exists "IDX-Stock"."IDX-Schema"."stg_eltool__stock__dbt_backup" cascade
[0m19:24:42.091898 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m19:24:42.094237 [debug] [Thread-1 (]: Timing info for model.dbt_idx.stg_eltool__stock (execute): 19:24:42.015298 => 19:24:42.094237
[0m19:24:42.094926 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__stock: Close
[0m19:24:42.096898 [info ] [Thread-1 (]: 6 of 11 OK created sql view model IDX-Schema.stg_eltool__stock ................. [[32mCREATE VIEW[0m in 0.09s]
[0m19:24:42.098896 [debug] [Thread-1 (]: Finished running node model.dbt_idx.stg_eltool__stock
[0m19:24:42.099925 [debug] [Thread-1 (]: Began running node model.dbt_idx.fact_orders
[0m19:24:42.101926 [info ] [Thread-1 (]: 7 of 11 START sql table model IDX-Schema.fact_orders ........................... [RUN]
[0m19:24:42.103910 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_idx.stg_eltool__stock, now model.dbt_idx.fact_orders)
[0m19:24:42.103910 [debug] [Thread-1 (]: Began compiling node model.dbt_idx.fact_orders
[0m19:24:42.107511 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_idx.fact_orders"
[0m19:24:42.115476 [debug] [Thread-1 (]: Timing info for model.dbt_idx.fact_orders (compile): 19:24:42.105468 => 19:24:42.114511
[0m19:24:42.116481 [debug] [Thread-1 (]: Began executing node model.dbt_idx.fact_orders
[0m19:24:42.139856 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_idx.fact_orders"
[0m19:24:42.149284 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.fact_orders"
[0m19:24:42.149284 [debug] [Thread-1 (]: On model.dbt_idx.fact_orders: BEGIN
[0m19:24:42.150319 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:24:42.172794 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m19:24:42.173731 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.fact_orders"
[0m19:24:42.174727 [debug] [Thread-1 (]: On model.dbt_idx.fact_orders: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.fact_orders"} */

  
    

  create  table "IDX-Stock"."IDX-Schema"."fact_orders__dbt_tmp"
  
  
    as
  
  (
    with orders as (
    select *
    from "IDX-Stock"."IDX-Schema"."stg_eltool__orders"
)
select * from orders
  );
  
[0m19:24:42.180944 [debug] [Thread-1 (]: SQL status: SELECT 999 in 0.0 seconds
[0m19:24:42.184008 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.fact_orders"
[0m19:24:42.186552 [debug] [Thread-1 (]: On model.dbt_idx.fact_orders: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.fact_orders"} */
alter table "IDX-Stock"."IDX-Schema"."fact_orders" rename to "fact_orders__dbt_backup"
[0m19:24:42.188536 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:24:42.194566 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.fact_orders"
[0m19:24:42.195531 [debug] [Thread-1 (]: On model.dbt_idx.fact_orders: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.fact_orders"} */
alter table "IDX-Stock"."IDX-Schema"."fact_orders__dbt_tmp" rename to "fact_orders"
[0m19:24:42.197048 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:24:42.204054 [debug] [Thread-1 (]: On model.dbt_idx.fact_orders: COMMIT
[0m19:24:42.205056 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.fact_orders"
[0m19:24:42.205457 [debug] [Thread-1 (]: On model.dbt_idx.fact_orders: COMMIT
[0m19:24:42.214651 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m19:24:42.219692 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.fact_orders"
[0m19:24:42.220696 [debug] [Thread-1 (]: On model.dbt_idx.fact_orders: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.fact_orders"} */
drop table if exists "IDX-Stock"."IDX-Schema"."fact_orders__dbt_backup" cascade
[0m19:24:42.225660 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m19:24:42.227693 [debug] [Thread-1 (]: Timing info for model.dbt_idx.fact_orders (execute): 19:24:42.117488 => 19:24:42.227693
[0m19:24:42.228705 [debug] [Thread-1 (]: On model.dbt_idx.fact_orders: Close
[0m19:24:42.230663 [info ] [Thread-1 (]: 7 of 11 OK created sql table model IDX-Schema.fact_orders ...................... [[32mSELECT 999[0m in 0.13s]
[0m19:24:42.232664 [debug] [Thread-1 (]: Finished running node model.dbt_idx.fact_orders
[0m19:24:42.234170 [debug] [Thread-1 (]: Began running node model.dbt_idx.dim_customers
[0m19:24:42.235178 [info ] [Thread-1 (]: 8 of 11 START sql table model IDX-Schema.dim_customers ......................... [RUN]
[0m19:24:42.237214 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_idx.fact_orders, now model.dbt_idx.dim_customers)
[0m19:24:42.237214 [debug] [Thread-1 (]: Began compiling node model.dbt_idx.dim_customers
[0m19:24:42.242185 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_idx.dim_customers"
[0m19:24:42.248895 [debug] [Thread-1 (]: Timing info for model.dbt_idx.dim_customers (compile): 19:24:42.238175 => 19:24:42.248895
[0m19:24:42.250907 [debug] [Thread-1 (]: Began executing node model.dbt_idx.dim_customers
[0m19:24:42.260104 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_idx.dim_customers"
[0m19:24:42.269076 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.dim_customers"
[0m19:24:42.271079 [debug] [Thread-1 (]: On model.dbt_idx.dim_customers: BEGIN
[0m19:24:42.272094 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:24:42.297428 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m19:24:42.297428 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.dim_customers"
[0m19:24:42.298461 [debug] [Thread-1 (]: On model.dbt_idx.dim_customers: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.dim_customers"} */

  
    

  create  table "IDX-Stock"."IDX-Schema"."dim_customers__dbt_tmp"
  
  
    as
  
  (
    -- noinspection SqlDialectInspectionForFile

with customers as (
    select *
    from "IDX-Stock"."IDX-Schema"."stg_eltool__customers_snapshots"
    ),
     state as (
         select *
         from "IDX-Stock"."IDX-Schema"."stg_eltool__state"
     )
select c.customer_id,
       c.zipcode,
       c.city,
       c.state_code,
       s.state_name,
       c.datetime_created,
       c.datetime_updated,
       c.dbt_valid_from::TIMESTAMP as valid_from,
        CASE WHEN c.dbt_valid_to IS NULL
            THEN '9999-12-31'::TIMESTAMP
            ELSE c.dbt_valid_to::TIMESTAMP
        END as valid_to
from customers c
    join state s on c.state_code = s.state_code
  );
  
[0m19:24:42.303429 [debug] [Thread-1 (]: SQL status: SELECT 100 in 0.0 seconds
[0m19:24:42.307462 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.dim_customers"
[0m19:24:42.307462 [debug] [Thread-1 (]: On model.dbt_idx.dim_customers: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.dim_customers"} */
alter table "IDX-Stock"."IDX-Schema"."dim_customers" rename to "dim_customers__dbt_backup"
[0m19:24:42.310429 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:24:42.355649 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.dim_customers"
[0m19:24:42.355649 [debug] [Thread-1 (]: On model.dbt_idx.dim_customers: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.dim_customers"} */
alter table "IDX-Stock"."IDX-Schema"."dim_customers__dbt_tmp" rename to "dim_customers"
[0m19:24:42.358595 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:24:42.360630 [debug] [Thread-1 (]: On model.dbt_idx.dim_customers: COMMIT
[0m19:24:42.362170 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.dim_customers"
[0m19:24:42.363198 [debug] [Thread-1 (]: On model.dbt_idx.dim_customers: COMMIT
[0m19:24:42.366234 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m19:24:42.369213 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.dim_customers"
[0m19:24:42.370211 [debug] [Thread-1 (]: On model.dbt_idx.dim_customers: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.dim_customers"} */
drop table if exists "IDX-Stock"."IDX-Schema"."dim_customers__dbt_backup" cascade
[0m19:24:42.374254 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m19:24:42.376213 [debug] [Thread-1 (]: Timing info for model.dbt_idx.dim_customers (execute): 19:24:42.251905 => 19:24:42.376213
[0m19:24:42.377225 [debug] [Thread-1 (]: On model.dbt_idx.dim_customers: Close
[0m19:24:42.379471 [info ] [Thread-1 (]: 8 of 11 OK created sql table model IDX-Schema.dim_customers .................... [[32mSELECT 100[0m in 0.14s]
[0m19:24:42.381471 [debug] [Thread-1 (]: Finished running node model.dbt_idx.dim_customers
[0m19:24:42.383472 [debug] [Thread-1 (]: Began running node model.dbt_idx.fact_stocks
[0m19:24:42.384487 [info ] [Thread-1 (]: 9 of 11 START sql table model IDX-Schema.fact_stocks ........................... [RUN]
[0m19:24:42.386839 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_idx.dim_customers, now model.dbt_idx.fact_stocks)
[0m19:24:42.387004 [debug] [Thread-1 (]: Began compiling node model.dbt_idx.fact_stocks
[0m19:24:42.391039 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_idx.fact_stocks"
[0m19:24:42.399552 [debug] [Thread-1 (]: Timing info for model.dbt_idx.fact_stocks (compile): 19:24:42.388042 => 19:24:42.398529
[0m19:24:42.400564 [debug] [Thread-1 (]: Began executing node model.dbt_idx.fact_stocks
[0m19:24:42.406588 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_idx.fact_stocks"
[0m19:24:42.413555 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.fact_stocks"
[0m19:24:42.414551 [debug] [Thread-1 (]: On model.dbt_idx.fact_stocks: BEGIN
[0m19:24:42.415550 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:24:42.439449 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m19:24:42.440476 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.fact_stocks"
[0m19:24:42.441440 [debug] [Thread-1 (]: On model.dbt_idx.fact_stocks: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.fact_stocks"} */

  
    

  create  table "IDX-Stock"."IDX-Schema"."fact_stocks__dbt_tmp"
  
  
    as
  
  (
    -- noinspection SqlDialectInspectionForFile

with stock as (
    select *
    from "IDX-Stock"."IDX-Schema"."stg_eltool__stock"
    ),
     company as (
         select *
         from "IDX-Stock"."IDX-Schema"."stg_eltool__company"
     )
select a.id,
       a.ticker,
       b.name,
       a.date,
       a.open,
       a.high,
       a.low,
       a.close,
       a.volume,
       b.logo
from stock a
    join company b on a.ticker = b.ticker
  );
  
[0m19:24:42.490019 [debug] [Thread-1 (]: SQL status: SELECT 26131 in 0.0 seconds
[0m19:24:42.494299 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.fact_stocks"
[0m19:24:42.495298 [debug] [Thread-1 (]: On model.dbt_idx.fact_stocks: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.fact_stocks"} */
alter table "IDX-Stock"."IDX-Schema"."fact_stocks" rename to "fact_stocks__dbt_backup"
[0m19:24:42.498268 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:24:42.502301 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.fact_stocks"
[0m19:24:42.502650 [debug] [Thread-1 (]: On model.dbt_idx.fact_stocks: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.fact_stocks"} */
alter table "IDX-Stock"."IDX-Schema"."fact_stocks__dbt_tmp" rename to "fact_stocks"
[0m19:24:42.505266 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:24:42.508268 [debug] [Thread-1 (]: On model.dbt_idx.fact_stocks: COMMIT
[0m19:24:42.509299 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.fact_stocks"
[0m19:24:42.510263 [debug] [Thread-1 (]: On model.dbt_idx.fact_stocks: COMMIT
[0m19:24:42.518829 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m19:24:42.522814 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.fact_stocks"
[0m19:24:42.523798 [debug] [Thread-1 (]: On model.dbt_idx.fact_stocks: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.fact_stocks"} */
drop table if exists "IDX-Stock"."IDX-Schema"."fact_stocks__dbt_backup" cascade
[0m19:24:42.528791 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m19:24:42.530788 [debug] [Thread-1 (]: Timing info for model.dbt_idx.fact_stocks (execute): 19:24:42.401549 => 19:24:42.530788
[0m19:24:42.530788 [debug] [Thread-1 (]: On model.dbt_idx.fact_stocks: Close
[0m19:24:42.532787 [info ] [Thread-1 (]: 9 of 11 OK created sql table model IDX-Schema.fact_stocks ...................... [[32mSELECT 26131[0m in 0.15s]
[0m19:24:42.534867 [debug] [Thread-1 (]: Finished running node model.dbt_idx.fact_stocks
[0m19:24:42.535867 [debug] [Thread-1 (]: Began running node model.dbt_idx.customer_orders_status
[0m19:24:42.537881 [info ] [Thread-1 (]: 10 of 11 START sql view model IDX-Schema.customer_orders_status ................ [RUN]
[0m19:24:42.538891 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_idx.fact_stocks, now model.dbt_idx.customer_orders_status)
[0m19:24:42.539865 [debug] [Thread-1 (]: Began compiling node model.dbt_idx.customer_orders_status
[0m19:24:42.543879 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_idx.customer_orders_status"
[0m19:24:42.549904 [debug] [Thread-1 (]: Timing info for model.dbt_idx.customer_orders_status (compile): 19:24:42.540895 => 19:24:42.549904
[0m19:24:42.550901 [debug] [Thread-1 (]: Began executing node model.dbt_idx.customer_orders_status
[0m19:24:42.556457 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_idx.customer_orders_status"
[0m19:24:42.564786 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.customer_orders_status"
[0m19:24:42.565447 [debug] [Thread-1 (]: On model.dbt_idx.customer_orders_status: BEGIN
[0m19:24:42.566484 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:24:42.591718 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m19:24:42.592729 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.customer_orders_status"
[0m19:24:42.593725 [debug] [Thread-1 (]: On model.dbt_idx.customer_orders_status: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.customer_orders_status"} */

  create view "IDX-Stock"."IDX-Schema"."customer_orders_status__dbt_tmp"
    
    
  as (
    with orders as (select *
                from "IDX-Stock"."IDX-Schema"."fact_orders"),
     customers as (select *
                   from "IDX-Stock"."IDX-Schema"."dim_customers")
select o.order_id,
       o.customer_id,
       o.order_status,
       o.order_purchase_timestamp,
       o.order_approved_at,
       o.order_delivered_carrier_date,
       o.order_delivered_customer_date,
       o.order_estimated_delivery_date,
       c.zipcode    as customer_zipcode,
       c.city       as customer_city,
       c.state_code as customer_state_code,
       c.state_name as customer_state_name
from orders o
    join customers c on o.customer_id = c.customer_id
    and o.order_purchase_timestamp >= c.valid_from
    and o.order_purchase_timestamp <= c.valid_to
  );
[0m19:24:42.599247 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m19:24:42.605250 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.customer_orders_status"
[0m19:24:42.606757 [debug] [Thread-1 (]: On model.dbt_idx.customer_orders_status: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.customer_orders_status"} */
alter table "IDX-Stock"."IDX-Schema"."customer_orders_status__dbt_tmp" rename to "customer_orders_status"
[0m19:24:42.609245 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:24:42.612283 [debug] [Thread-1 (]: On model.dbt_idx.customer_orders_status: COMMIT
[0m19:24:42.613248 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.customer_orders_status"
[0m19:24:42.614246 [debug] [Thread-1 (]: On model.dbt_idx.customer_orders_status: COMMIT
[0m19:24:42.617793 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m19:24:42.621823 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.customer_orders_status"
[0m19:24:42.622820 [debug] [Thread-1 (]: On model.dbt_idx.customer_orders_status: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.customer_orders_status"} */
drop view if exists "IDX-Stock"."IDX-Schema"."customer_orders_status__dbt_backup" cascade
[0m19:24:42.625776 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m19:24:42.628798 [debug] [Thread-1 (]: Timing info for model.dbt_idx.customer_orders_status (execute): 19:24:42.550901 => 19:24:42.627775
[0m19:24:42.629775 [debug] [Thread-1 (]: On model.dbt_idx.customer_orders_status: Close
[0m19:24:42.630778 [info ] [Thread-1 (]: 10 of 11 OK created sql view model IDX-Schema.customer_orders_status ........... [[32mCREATE VIEW[0m in 0.09s]
[0m19:24:42.635311 [debug] [Thread-1 (]: Finished running node model.dbt_idx.customer_orders_status
[0m19:24:42.636312 [debug] [Thread-1 (]: Began running node model.dbt_idx.stock_update_status
[0m19:24:42.637310 [info ] [Thread-1 (]: 11 of 11 START sql view model IDX-Schema.stock_update_status ................... [RUN]
[0m19:24:42.639307 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_idx.customer_orders_status, now model.dbt_idx.stock_update_status)
[0m19:24:42.640305 [debug] [Thread-1 (]: Began compiling node model.dbt_idx.stock_update_status
[0m19:24:42.643344 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_idx.stock_update_status"
[0m19:24:42.650977 [debug] [Thread-1 (]: Timing info for model.dbt_idx.stock_update_status (compile): 19:24:42.640305 => 19:24:42.650977
[0m19:24:42.651979 [debug] [Thread-1 (]: Began executing node model.dbt_idx.stock_update_status
[0m19:24:42.660560 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_idx.stock_update_status"
[0m19:24:42.667561 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stock_update_status"
[0m19:24:42.670156 [debug] [Thread-1 (]: On model.dbt_idx.stock_update_status: BEGIN
[0m19:24:42.671124 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:24:42.699302 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m19:24:42.700300 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stock_update_status"
[0m19:24:42.700300 [debug] [Thread-1 (]: On model.dbt_idx.stock_update_status: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stock_update_status"} */

  create view "IDX-Stock"."IDX-Schema"."stock_update_status__dbt_tmp"
    
    
  as (
    with stock as (select *
                from "IDX-Stock"."IDX-Schema"."fact_stocks"
                )
select *
from stock a
  );
[0m19:24:42.704301 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m19:24:42.707864 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stock_update_status"
[0m19:24:42.708879 [debug] [Thread-1 (]: On model.dbt_idx.stock_update_status: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stock_update_status"} */
alter table "IDX-Stock"."IDX-Schema"."stock_update_status__dbt_tmp" rename to "stock_update_status"
[0m19:24:42.712870 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:24:42.715872 [debug] [Thread-1 (]: On model.dbt_idx.stock_update_status: COMMIT
[0m19:24:42.716870 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stock_update_status"
[0m19:24:42.719195 [debug] [Thread-1 (]: On model.dbt_idx.stock_update_status: COMMIT
[0m19:24:42.722883 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m19:24:42.727877 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stock_update_status"
[0m19:24:42.729390 [debug] [Thread-1 (]: On model.dbt_idx.stock_update_status: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stock_update_status"} */
drop view if exists "IDX-Stock"."IDX-Schema"."stock_update_status__dbt_backup" cascade
[0m19:24:42.732404 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m19:24:42.736414 [debug] [Thread-1 (]: Timing info for model.dbt_idx.stock_update_status (execute): 19:24:42.652988 => 19:24:42.735403
[0m19:24:42.737419 [debug] [Thread-1 (]: On model.dbt_idx.stock_update_status: Close
[0m19:24:42.740616 [info ] [Thread-1 (]: 11 of 11 OK created sql view model IDX-Schema.stock_update_status .............. [[32mCREATE VIEW[0m in 0.10s]
[0m19:24:42.743632 [debug] [Thread-1 (]: Finished running node model.dbt_idx.stock_update_status
[0m19:24:42.748148 [debug] [MainThread]: Using postgres connection "master"
[0m19:24:42.750156 [debug] [MainThread]: On master: BEGIN
[0m19:24:42.751155 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m19:24:42.782256 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m19:24:42.783240 [debug] [MainThread]: On master: COMMIT
[0m19:24:42.784240 [debug] [MainThread]: Using postgres connection "master"
[0m19:24:42.785407 [debug] [MainThread]: On master: COMMIT
[0m19:24:42.788790 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m19:24:42.789802 [debug] [MainThread]: On master: Close
[0m19:24:42.791802 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:24:42.793805 [debug] [MainThread]: Connection 'list_IDX-Stock' was properly closed.
[0m19:24:42.794800 [debug] [MainThread]: Connection 'list_IDX-Stock_IDX-Schema' was properly closed.
[0m19:24:42.796813 [debug] [MainThread]: Connection 'model.dbt_idx.stock_update_status' was properly closed.
[0m19:24:42.796813 [info ] [MainThread]: 
[0m19:24:42.798376 [info ] [MainThread]: Finished running 8 view models, 3 table models in 0 hours 0 minutes and 1.65 seconds (1.65s).
[0m19:24:42.802383 [debug] [MainThread]: Command end result
[0m19:24:42.838722 [info ] [MainThread]: 
[0m19:24:42.840673 [info ] [MainThread]: [32mCompleted successfully[0m
[0m19:24:42.841686 [info ] [MainThread]: 
[0m19:24:42.843687 [info ] [MainThread]: Done. PASS=11 WARN=0 ERROR=0 SKIP=0 TOTAL=11
[0m19:24:42.844690 [debug] [MainThread]: Command `dbt run` succeeded at 19:24:42.844690 after 2.26 seconds
[0m19:24:42.846688 [debug] [MainThread]: Flushing usage events


============================== 19:27:47.883698 | 8e508135-c450-459a-b07b-5c63e8e57220 ==============================
[0m19:27:47.883698 [info ] [MainThread]: Running with dbt=1.6.1
[0m19:27:47.890236 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'D:\\00 Project\\00 My Project\\IdeaProjects\\Py-DBT-IDX', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'D:\\00 Project\\00 My Project\\IdeaProjects\\Py-DBT-IDX\\logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt run', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'False'}
[0m19:27:48.047982 [info ] [MainThread]: Registered adapter: postgres=1.6.1
[0m19:27:48.061616 [debug] [MainThread]: checksum: efe19d9f5b93d1a98cc804fbfcdb6b3aced98b974af664946fee1cde8837deb7, vars: {}, profile: , target: , version: 1.6.1
[0m19:27:48.205371 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m19:27:48.206372 [debug] [MainThread]: Partial parsing: updated file: dbt_idx://models\marts\stock\stock_update_status.sql
[0m19:27:48.311577 [info ] [MainThread]: Found 11 models, 1 snapshot, 18 tests, 5 sources, 0 exposures, 0 metrics, 349 macros, 0 groups, 0 semantic models
[0m19:27:48.313577 [info ] [MainThread]: 
[0m19:27:48.314877 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m19:27:48.318099 [debug] [ThreadPool]: Acquiring new postgres connection 'list_IDX-Stock'
[0m19:27:48.328099 [debug] [ThreadPool]: Using postgres connection "list_IDX-Stock"
[0m19:27:48.329099 [debug] [ThreadPool]: On list_IDX-Stock: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "connection_name": "list_IDX-Stock"} */

    select distinct nspname from pg_namespace
  
[0m19:27:48.330099 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:27:48.358869 [debug] [ThreadPool]: SQL status: SELECT 12 in 0.0 seconds
[0m19:27:48.360880 [debug] [ThreadPool]: On list_IDX-Stock: Close
[0m19:27:48.364890 [debug] [ThreadPool]: Acquiring new postgres connection 'list_IDX-Stock_snapshots'
[0m19:27:48.371857 [debug] [ThreadPool]: Using postgres connection "list_IDX-Stock_snapshots"
[0m19:27:48.372887 [debug] [ThreadPool]: On list_IDX-Stock_snapshots: BEGIN
[0m19:27:48.372887 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:27:48.393957 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m19:27:48.394955 [debug] [ThreadPool]: Using postgres connection "list_IDX-Stock_snapshots"
[0m19:27:48.394955 [debug] [ThreadPool]: On list_IDX-Stock_snapshots: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "connection_name": "list_IDX-Stock_snapshots"} */
select
      'IDX-Stock' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'snapshots'
    union all
    select
      'IDX-Stock' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'snapshots'
    union all
    select
      'IDX-Stock' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'snapshots'
  
[0m19:27:48.399954 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.0 seconds
[0m19:27:48.401983 [debug] [ThreadPool]: On list_IDX-Stock_snapshots: ROLLBACK
[0m19:27:48.403488 [debug] [ThreadPool]: On list_IDX-Stock_snapshots: Close
[0m19:27:48.405513 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_IDX-Stock_snapshots, now list_IDX-Stock_IDX-Schema)
[0m19:27:48.409530 [debug] [ThreadPool]: Using postgres connection "list_IDX-Stock_IDX-Schema"
[0m19:27:48.410584 [debug] [ThreadPool]: On list_IDX-Stock_IDX-Schema: BEGIN
[0m19:27:48.411496 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:27:48.441761 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m19:27:48.442957 [debug] [ThreadPool]: Using postgres connection "list_IDX-Stock_IDX-Schema"
[0m19:27:48.443500 [debug] [ThreadPool]: On list_IDX-Stock_IDX-Schema: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "connection_name": "list_IDX-Stock_IDX-Schema"} */
select
      'IDX-Stock' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'IDX-Schema'
    union all
    select
      'IDX-Stock' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'IDX-Schema'
    union all
    select
      'IDX-Stock' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'IDX-Schema'
  
[0m19:27:48.448595 [debug] [ThreadPool]: SQL status: SELECT 17 in 0.0 seconds
[0m19:27:48.451623 [debug] [ThreadPool]: On list_IDX-Stock_IDX-Schema: ROLLBACK
[0m19:27:48.453589 [debug] [ThreadPool]: On list_IDX-Stock_IDX-Schema: Close
[0m19:27:48.463593 [debug] [MainThread]: Using postgres connection "master"
[0m19:27:48.464431 [debug] [MainThread]: On master: BEGIN
[0m19:27:48.464593 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:27:48.550389 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m19:27:48.551390 [debug] [MainThread]: Using postgres connection "master"
[0m19:27:48.551390 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m19:27:48.562611 [debug] [MainThread]: SQL status: SELECT 9 in 0.0 seconds
[0m19:27:48.566609 [debug] [MainThread]: On master: ROLLBACK
[0m19:27:48.569612 [debug] [MainThread]: Using postgres connection "master"
[0m19:27:48.571615 [debug] [MainThread]: On master: BEGIN
[0m19:27:48.576031 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m19:27:48.578126 [debug] [MainThread]: On master: COMMIT
[0m19:27:48.578630 [debug] [MainThread]: Using postgres connection "master"
[0m19:27:48.579264 [debug] [MainThread]: On master: COMMIT
[0m19:27:48.582698 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m19:27:48.583823 [debug] [MainThread]: On master: Close
[0m19:27:48.586081 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m19:27:48.587826 [info ] [MainThread]: 
[0m19:27:48.593342 [debug] [Thread-1 (]: Began running node model.dbt_idx.stg_eltool__company
[0m19:27:48.594434 [info ] [Thread-1 (]: 1 of 11 START sql view model IDX-Schema.stg_eltool__company .................... [RUN]
[0m19:27:48.596103 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.dbt_idx.stg_eltool__company'
[0m19:27:48.596651 [debug] [Thread-1 (]: Began compiling node model.dbt_idx.stg_eltool__company
[0m19:27:48.605699 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_idx.stg_eltool__company"
[0m19:27:48.612556 [debug] [Thread-1 (]: Timing info for model.dbt_idx.stg_eltool__company (compile): 19:27:48.597177 => 19:27:48.612556
[0m19:27:48.613568 [debug] [Thread-1 (]: Began executing node model.dbt_idx.stg_eltool__company
[0m19:27:48.650605 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_idx.stg_eltool__company"
[0m19:27:48.656568 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__company"
[0m19:27:48.657566 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__company: BEGIN
[0m19:27:48.658568 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m19:27:48.679095 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m19:27:48.680096 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__company"
[0m19:27:48.681098 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__company: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__company"} */

  create view "IDX-Stock"."IDX-Schema"."stg_eltool__company__dbt_tmp"
    
    
  as (
    with source as (select *
                from "IDX-Stock"."IDX-Schema"."ksql-company-stream"),
     renamed as (select id,
                        ticker,
                        name,
                        logo
                 from source)
select *
from renamed
  );
[0m19:27:48.684095 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m19:27:48.690170 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__company"
[0m19:27:48.691162 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__company: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__company"} */
alter table "IDX-Stock"."IDX-Schema"."stg_eltool__company" rename to "stg_eltool__company__dbt_backup"
[0m19:27:48.694135 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:27:48.697170 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__company"
[0m19:27:48.698145 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__company: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__company"} */
alter table "IDX-Stock"."IDX-Schema"."stg_eltool__company__dbt_tmp" rename to "stg_eltool__company"
[0m19:27:48.701147 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:27:48.719718 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__company: COMMIT
[0m19:27:48.720719 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__company"
[0m19:27:48.721691 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__company: COMMIT
[0m19:27:48.725596 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m19:27:48.733632 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__company"
[0m19:27:48.734597 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__company: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__company"} */
drop view if exists "IDX-Stock"."IDX-Schema"."stg_eltool__company__dbt_backup" cascade
[0m19:27:48.738598 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m19:27:48.740600 [debug] [Thread-1 (]: Timing info for model.dbt_idx.stg_eltool__company (execute): 19:27:48.613568 => 19:27:48.740600
[0m19:27:48.742599 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__company: Close
[0m19:27:48.743608 [info ] [Thread-1 (]: 1 of 11 OK created sql view model IDX-Schema.stg_eltool__company ............... [[32mCREATE VIEW[0m in 0.15s]
[0m19:27:48.745664 [debug] [Thread-1 (]: Finished running node model.dbt_idx.stg_eltool__company
[0m19:27:48.746626 [debug] [Thread-1 (]: Began running node model.dbt_idx.stg_eltool__customers
[0m19:27:48.747613 [info ] [Thread-1 (]: 2 of 11 START sql view model IDX-Schema.stg_eltool__customers .................. [RUN]
[0m19:27:48.749598 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_idx.stg_eltool__company, now model.dbt_idx.stg_eltool__customers)
[0m19:27:48.750596 [debug] [Thread-1 (]: Began compiling node model.dbt_idx.stg_eltool__customers
[0m19:27:48.754636 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_idx.stg_eltool__customers"
[0m19:27:48.761645 [debug] [Thread-1 (]: Timing info for model.dbt_idx.stg_eltool__customers (compile): 19:27:48.750596 => 19:27:48.761645
[0m19:27:48.762671 [debug] [Thread-1 (]: Began executing node model.dbt_idx.stg_eltool__customers
[0m19:27:48.767657 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_idx.stg_eltool__customers"
[0m19:27:48.773514 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__customers"
[0m19:27:48.774546 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__customers: BEGIN
[0m19:27:48.775530 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:27:48.796565 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m19:27:48.797561 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__customers"
[0m19:27:48.797561 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__customers: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__customers"} */

  create view "IDX-Stock"."IDX-Schema"."stg_eltool__customers__dbt_tmp"
    
    
  as (
    with source as (select *
                from "IDX-Stock"."IDX-Schema"."customers"),
     renamed as (select
                     customer_id,
                    'This is Dummy' as dummy
                 from source
                 where customer_id = 1234567890)
select *
from renamed
  );
[0m19:27:48.801387 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m19:27:48.806949 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__customers"
[0m19:27:48.807914 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__customers: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__customers"} */
alter table "IDX-Stock"."IDX-Schema"."stg_eltool__customers" rename to "stg_eltool__customers__dbt_backup"
[0m19:27:48.810913 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:27:48.813913 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__customers"
[0m19:27:48.814913 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__customers: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__customers"} */
alter table "IDX-Stock"."IDX-Schema"."stg_eltool__customers__dbt_tmp" rename to "stg_eltool__customers"
[0m19:27:48.817158 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:27:48.819191 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__customers: COMMIT
[0m19:27:48.820192 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__customers"
[0m19:27:48.821167 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__customers: COMMIT
[0m19:27:48.825156 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m19:27:48.828182 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__customers"
[0m19:27:48.828182 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__customers: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__customers"} */
drop view if exists "IDX-Stock"."IDX-Schema"."stg_eltool__customers__dbt_backup" cascade
[0m19:27:48.832157 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m19:27:48.834182 [debug] [Thread-1 (]: Timing info for model.dbt_idx.stg_eltool__customers (execute): 19:27:48.762671 => 19:27:48.834182
[0m19:27:48.835217 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__customers: Close
[0m19:27:48.837166 [info ] [Thread-1 (]: 2 of 11 OK created sql view model IDX-Schema.stg_eltool__customers ............. [[32mCREATE VIEW[0m in 0.09s]
[0m19:27:48.838157 [debug] [Thread-1 (]: Finished running node model.dbt_idx.stg_eltool__customers
[0m19:27:48.839182 [debug] [Thread-1 (]: Began running node model.dbt_idx.stg_eltool__customers_snapshots
[0m19:27:48.840158 [info ] [Thread-1 (]: 3 of 11 START sql view model IDX-Schema.stg_eltool__customers_snapshots ........ [RUN]
[0m19:27:48.842156 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_idx.stg_eltool__customers, now model.dbt_idx.stg_eltool__customers_snapshots)
[0m19:27:48.843164 [debug] [Thread-1 (]: Began compiling node model.dbt_idx.stg_eltool__customers_snapshots
[0m19:27:48.845180 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_idx.stg_eltool__customers_snapshots"
[0m19:27:48.851972 [debug] [Thread-1 (]: Timing info for model.dbt_idx.stg_eltool__customers_snapshots (compile): 19:27:48.843164 => 19:27:48.851972
[0m19:27:48.852949 [debug] [Thread-1 (]: Began executing node model.dbt_idx.stg_eltool__customers_snapshots
[0m19:27:48.858992 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_idx.stg_eltool__customers_snapshots"
[0m19:27:48.864495 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__customers_snapshots"
[0m19:27:48.865459 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__customers_snapshots: BEGIN
[0m19:27:48.865459 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:27:48.890616 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m19:27:48.891623 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__customers_snapshots"
[0m19:27:48.892599 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__customers_snapshots: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__customers_snapshots"} */

  create view "IDX-Stock"."IDX-Schema"."stg_eltool__customers_snapshots__dbt_tmp"
    
    
  as (
    with source as (select *
                from "IDX-Stock"."snapshots"."customers_snapshot"),
     renamed as (select customer_id,
                        zipcode,
                        city,
                        state_code,
                        datetime_created::TIMESTAMP AS datetime_created,
                        datetime_updated::TIMESTAMP AS datetime_updated,
                        dbt_valid_from,
                        dbt_valid_to
                 from source)
select *
from renamed
  );
[0m19:27:48.895608 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m19:27:48.899626 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__customers_snapshots"
[0m19:27:48.900634 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__customers_snapshots: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__customers_snapshots"} */
alter table "IDX-Stock"."IDX-Schema"."stg_eltool__customers_snapshots" rename to "stg_eltool__customers_snapshots__dbt_backup"
[0m19:27:48.902595 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:27:48.906134 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__customers_snapshots"
[0m19:27:48.907121 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__customers_snapshots: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__customers_snapshots"} */
alter table "IDX-Stock"."IDX-Schema"."stg_eltool__customers_snapshots__dbt_tmp" rename to "stg_eltool__customers_snapshots"
[0m19:27:48.909111 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:27:48.912138 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__customers_snapshots: COMMIT
[0m19:27:48.912138 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__customers_snapshots"
[0m19:27:48.913147 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__customers_snapshots: COMMIT
[0m19:27:48.916318 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m19:27:48.919352 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__customers_snapshots"
[0m19:27:48.920352 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__customers_snapshots: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__customers_snapshots"} */
drop view if exists "IDX-Stock"."IDX-Schema"."stg_eltool__customers_snapshots__dbt_backup" cascade
[0m19:27:48.924322 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m19:27:48.926342 [debug] [Thread-1 (]: Timing info for model.dbt_idx.stg_eltool__customers_snapshots (execute): 19:27:48.852949 => 19:27:48.925318
[0m19:27:48.926342 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__customers_snapshots: Close
[0m19:27:48.928328 [info ] [Thread-1 (]: 3 of 11 OK created sql view model IDX-Schema.stg_eltool__customers_snapshots ... [[32mCREATE VIEW[0m in 0.09s]
[0m19:27:48.930322 [debug] [Thread-1 (]: Finished running node model.dbt_idx.stg_eltool__customers_snapshots
[0m19:27:48.931323 [debug] [Thread-1 (]: Began running node model.dbt_idx.stg_eltool__orders
[0m19:27:48.932322 [info ] [Thread-1 (]: 4 of 11 START sql view model IDX-Schema.stg_eltool__orders ..................... [RUN]
[0m19:27:48.933316 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_idx.stg_eltool__customers_snapshots, now model.dbt_idx.stg_eltool__orders)
[0m19:27:48.934318 [debug] [Thread-1 (]: Began compiling node model.dbt_idx.stg_eltool__orders
[0m19:27:48.937352 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_idx.stg_eltool__orders"
[0m19:27:48.947437 [debug] [Thread-1 (]: Timing info for model.dbt_idx.stg_eltool__orders (compile): 19:27:48.934318 => 19:27:48.947437
[0m19:27:48.948443 [debug] [Thread-1 (]: Began executing node model.dbt_idx.stg_eltool__orders
[0m19:27:48.952475 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_idx.stg_eltool__orders"
[0m19:27:48.963129 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__orders"
[0m19:27:48.964136 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__orders: BEGIN
[0m19:27:48.965098 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:27:48.985752 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m19:27:48.986764 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__orders"
[0m19:27:48.986764 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__orders: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__orders"} */

  create view "IDX-Stock"."IDX-Schema"."stg_eltool__orders__dbt_tmp"
    
    
  as (
    with source as (select *
                from "IDX-Stock"."IDX-Schema"."orders"),
     renamed as (select order_id,
                        cust_id AS customer_id,
                        order_status,
                        order_purchase_timestamp::TIMESTAMP,
                        order_approved_at::TIMESTAMP,
                        order_delivered_carrier_date::TIMESTAMP,
                        order_delivered_customer_date::TIMESTAMP,
                        order_estimated_delivery_date::TIMESTAMP
                 from source)
select *
from renamed
  );
[0m19:27:48.990761 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m19:27:48.994762 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__orders"
[0m19:27:48.995768 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__orders: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__orders"} */
alter table "IDX-Stock"."IDX-Schema"."stg_eltool__orders" rename to "stg_eltool__orders__dbt_backup"
[0m19:27:48.997701 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:27:49.000727 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__orders"
[0m19:27:49.001724 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__orders: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__orders"} */
alter table "IDX-Stock"."IDX-Schema"."stg_eltool__orders__dbt_tmp" rename to "stg_eltool__orders"
[0m19:27:49.004224 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:27:49.006265 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__orders: COMMIT
[0m19:27:49.007267 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__orders"
[0m19:27:49.008268 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__orders: COMMIT
[0m19:27:49.011438 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m19:27:49.014422 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__orders"
[0m19:27:49.015421 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__orders: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__orders"} */
drop view if exists "IDX-Stock"."IDX-Schema"."stg_eltool__orders__dbt_backup" cascade
[0m19:27:49.019422 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m19:27:49.022420 [debug] [Thread-1 (]: Timing info for model.dbt_idx.stg_eltool__orders (execute): 19:27:48.948443 => 19:27:49.022420
[0m19:27:49.023419 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__orders: Close
[0m19:27:49.024419 [info ] [Thread-1 (]: 4 of 11 OK created sql view model IDX-Schema.stg_eltool__orders ................ [[32mCREATE VIEW[0m in 0.09s]
[0m19:27:49.026420 [debug] [Thread-1 (]: Finished running node model.dbt_idx.stg_eltool__orders
[0m19:27:49.028420 [debug] [Thread-1 (]: Began running node model.dbt_idx.stg_eltool__state
[0m19:27:49.029454 [info ] [Thread-1 (]: 5 of 11 START sql view model IDX-Schema.stg_eltool__state ...................... [RUN]
[0m19:27:49.030454 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_idx.stg_eltool__orders, now model.dbt_idx.stg_eltool__state)
[0m19:27:49.031456 [debug] [Thread-1 (]: Began compiling node model.dbt_idx.stg_eltool__state
[0m19:27:49.034455 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_idx.stg_eltool__state"
[0m19:27:49.040455 [debug] [Thread-1 (]: Timing info for model.dbt_idx.stg_eltool__state (compile): 19:27:49.031456 => 19:27:49.040455
[0m19:27:49.041419 [debug] [Thread-1 (]: Began executing node model.dbt_idx.stg_eltool__state
[0m19:27:49.046419 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_idx.stg_eltool__state"
[0m19:27:49.052375 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__state"
[0m19:27:49.053395 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__state: BEGIN
[0m19:27:49.054384 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:27:49.078379 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m19:27:49.079379 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__state"
[0m19:27:49.080448 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__state: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__state"} */

  create view "IDX-Stock"."IDX-Schema"."stg_eltool__state__dbt_tmp"
    
    
  as (
    with source as (select *
                from "IDX-Stock"."IDX-Schema"."state"),
     renamed as (select state_identifier::INT AS state_id,
                         state_code::VARCHAR(2) AS state_code,
                         st_name::VARCHAR(30) AS state_name
                 from source)
select *
from renamed
  );
[0m19:27:49.084376 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m19:27:49.087402 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__state"
[0m19:27:49.088401 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__state: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__state"} */
alter table "IDX-Stock"."IDX-Schema"."stg_eltool__state" rename to "stg_eltool__state__dbt_backup"
[0m19:27:49.091345 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:27:49.094356 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__state"
[0m19:27:49.095355 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__state: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__state"} */
alter table "IDX-Stock"."IDX-Schema"."stg_eltool__state__dbt_tmp" rename to "stg_eltool__state"
[0m19:27:49.097252 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:27:49.099258 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__state: COMMIT
[0m19:27:49.100235 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__state"
[0m19:27:49.102238 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__state: COMMIT
[0m19:27:49.105418 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m19:27:49.110441 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__state"
[0m19:27:49.111417 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__state: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__state"} */
drop view if exists "IDX-Stock"."IDX-Schema"."stg_eltool__state__dbt_backup" cascade
[0m19:27:49.115441 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m19:27:49.118444 [debug] [Thread-1 (]: Timing info for model.dbt_idx.stg_eltool__state (execute): 19:27:49.042418 => 19:27:49.117417
[0m19:27:49.119451 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__state: Close
[0m19:27:49.121909 [info ] [Thread-1 (]: 5 of 11 OK created sql view model IDX-Schema.stg_eltool__state ................. [[32mCREATE VIEW[0m in 0.09s]
[0m19:27:49.123910 [debug] [Thread-1 (]: Finished running node model.dbt_idx.stg_eltool__state
[0m19:27:49.124904 [debug] [Thread-1 (]: Began running node model.dbt_idx.stg_eltool__stock
[0m19:27:49.126907 [info ] [Thread-1 (]: 6 of 11 START sql view model IDX-Schema.stg_eltool__stock ...................... [RUN]
[0m19:27:49.127910 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_idx.stg_eltool__state, now model.dbt_idx.stg_eltool__stock)
[0m19:27:49.128940 [debug] [Thread-1 (]: Began compiling node model.dbt_idx.stg_eltool__stock
[0m19:27:49.131958 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_idx.stg_eltool__stock"
[0m19:27:49.137912 [debug] [Thread-1 (]: Timing info for model.dbt_idx.stg_eltool__stock (compile): 19:27:49.128940 => 19:27:49.137912
[0m19:27:49.138929 [debug] [Thread-1 (]: Began executing node model.dbt_idx.stg_eltool__stock
[0m19:27:49.143903 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_idx.stg_eltool__stock"
[0m19:27:49.150906 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__stock"
[0m19:27:49.151905 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__stock: BEGIN
[0m19:27:49.152908 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:27:49.173674 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m19:27:49.174681 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__stock"
[0m19:27:49.175666 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__stock: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__stock"} */

  create view "IDX-Stock"."IDX-Schema"."stg_eltool__stock__dbt_tmp"
    
    
  as (
    with source as (select *
                from "IDX-Stock"."IDX-Schema"."ksql-stock-stream"),
     renamed as (select *
                 from source)
select *
from renamed
  );
[0m19:27:49.178689 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m19:27:49.182703 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__stock"
[0m19:27:49.183703 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__stock: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__stock"} */
alter table "IDX-Stock"."IDX-Schema"."stg_eltool__stock" rename to "stg_eltool__stock__dbt_backup"
[0m19:27:49.185983 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:27:49.189028 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__stock"
[0m19:27:49.190071 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__stock: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__stock"} */
alter table "IDX-Stock"."IDX-Schema"."stg_eltool__stock__dbt_tmp" rename to "stg_eltool__stock"
[0m19:27:49.192070 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:27:49.195072 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__stock: COMMIT
[0m19:27:49.196040 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__stock"
[0m19:27:49.196040 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__stock: COMMIT
[0m19:27:49.199076 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m19:27:49.203058 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__stock"
[0m19:27:49.203058 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__stock: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__stock"} */
drop view if exists "IDX-Stock"."IDX-Schema"."stg_eltool__stock__dbt_backup" cascade
[0m19:27:49.207194 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m19:27:49.209226 [debug] [Thread-1 (]: Timing info for model.dbt_idx.stg_eltool__stock (execute): 19:27:49.138929 => 19:27:49.209226
[0m19:27:49.210197 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__stock: Close
[0m19:27:49.212192 [info ] [Thread-1 (]: 6 of 11 OK created sql view model IDX-Schema.stg_eltool__stock ................. [[32mCREATE VIEW[0m in 0.08s]
[0m19:27:49.214208 [debug] [Thread-1 (]: Finished running node model.dbt_idx.stg_eltool__stock
[0m19:27:49.215195 [debug] [Thread-1 (]: Began running node model.dbt_idx.fact_orders
[0m19:27:49.216193 [info ] [Thread-1 (]: 7 of 11 START sql table model IDX-Schema.fact_orders ........................... [RUN]
[0m19:27:49.217192 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_idx.stg_eltool__stock, now model.dbt_idx.fact_orders)
[0m19:27:49.218192 [debug] [Thread-1 (]: Began compiling node model.dbt_idx.fact_orders
[0m19:27:49.221196 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_idx.fact_orders"
[0m19:27:49.226222 [debug] [Thread-1 (]: Timing info for model.dbt_idx.fact_orders (compile): 19:27:49.218192 => 19:27:49.226222
[0m19:27:49.227218 [debug] [Thread-1 (]: Began executing node model.dbt_idx.fact_orders
[0m19:27:49.256195 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_idx.fact_orders"
[0m19:27:49.262835 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.fact_orders"
[0m19:27:49.262835 [debug] [Thread-1 (]: On model.dbt_idx.fact_orders: BEGIN
[0m19:27:49.263835 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:27:49.283466 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m19:27:49.284503 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.fact_orders"
[0m19:27:49.285469 [debug] [Thread-1 (]: On model.dbt_idx.fact_orders: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.fact_orders"} */

  
    

  create  table "IDX-Stock"."IDX-Schema"."fact_orders__dbt_tmp"
  
  
    as
  
  (
    with orders as (
    select *
    from "IDX-Stock"."IDX-Schema"."stg_eltool__orders"
)
select * from orders
  );
  
[0m19:27:49.291508 [debug] [Thread-1 (]: SQL status: SELECT 999 in 0.0 seconds
[0m19:27:49.294542 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.fact_orders"
[0m19:27:49.295541 [debug] [Thread-1 (]: On model.dbt_idx.fact_orders: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.fact_orders"} */
alter table "IDX-Stock"."IDX-Schema"."fact_orders" rename to "fact_orders__dbt_backup"
[0m19:27:49.297512 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:27:49.301549 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.fact_orders"
[0m19:27:49.301549 [debug] [Thread-1 (]: On model.dbt_idx.fact_orders: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.fact_orders"} */
alter table "IDX-Stock"."IDX-Schema"."fact_orders__dbt_tmp" rename to "fact_orders"
[0m19:27:49.304050 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:27:49.310093 [debug] [Thread-1 (]: On model.dbt_idx.fact_orders: COMMIT
[0m19:27:49.310093 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.fact_orders"
[0m19:27:49.311122 [debug] [Thread-1 (]: On model.dbt_idx.fact_orders: COMMIT
[0m19:27:49.314472 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m19:27:49.319492 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.fact_orders"
[0m19:27:49.320456 [debug] [Thread-1 (]: On model.dbt_idx.fact_orders: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.fact_orders"} */
drop table if exists "IDX-Stock"."IDX-Schema"."fact_orders__dbt_backup" cascade
[0m19:27:49.327473 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m19:27:49.329494 [debug] [Thread-1 (]: Timing info for model.dbt_idx.fact_orders (execute): 19:27:49.228228 => 19:27:49.329494
[0m19:27:49.330464 [debug] [Thread-1 (]: On model.dbt_idx.fact_orders: Close
[0m19:27:49.332481 [info ] [Thread-1 (]: 7 of 11 OK created sql table model IDX-Schema.fact_orders ...................... [[32mSELECT 999[0m in 0.11s]
[0m19:27:49.334462 [debug] [Thread-1 (]: Finished running node model.dbt_idx.fact_orders
[0m19:27:49.336520 [debug] [Thread-1 (]: Began running node model.dbt_idx.dim_customers
[0m19:27:49.337456 [info ] [Thread-1 (]: 8 of 11 START sql table model IDX-Schema.dim_customers ......................... [RUN]
[0m19:27:49.338492 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_idx.fact_orders, now model.dbt_idx.dim_customers)
[0m19:27:49.339458 [debug] [Thread-1 (]: Began compiling node model.dbt_idx.dim_customers
[0m19:27:49.342545 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_idx.dim_customers"
[0m19:27:49.348640 [debug] [Thread-1 (]: Timing info for model.dbt_idx.dim_customers (compile): 19:27:49.339458 => 19:27:49.348640
[0m19:27:49.349601 [debug] [Thread-1 (]: Began executing node model.dbt_idx.dim_customers
[0m19:27:49.356601 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_idx.dim_customers"
[0m19:27:49.361568 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.dim_customers"
[0m19:27:49.362566 [debug] [Thread-1 (]: On model.dbt_idx.dim_customers: BEGIN
[0m19:27:49.363574 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:27:49.385635 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m19:27:49.386676 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.dim_customers"
[0m19:27:49.387649 [debug] [Thread-1 (]: On model.dbt_idx.dim_customers: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.dim_customers"} */

  
    

  create  table "IDX-Stock"."IDX-Schema"."dim_customers__dbt_tmp"
  
  
    as
  
  (
    -- noinspection SqlDialectInspectionForFile

with customers as (
    select *
    from "IDX-Stock"."IDX-Schema"."stg_eltool__customers_snapshots"
    ),
     state as (
         select *
         from "IDX-Stock"."IDX-Schema"."stg_eltool__state"
     )
select c.customer_id,
       c.zipcode,
       c.city,
       c.state_code,
       s.state_name,
       c.datetime_created,
       c.datetime_updated,
       c.dbt_valid_from::TIMESTAMP as valid_from,
        CASE WHEN c.dbt_valid_to IS NULL
            THEN '9999-12-31'::TIMESTAMP
            ELSE c.dbt_valid_to::TIMESTAMP
        END as valid_to
from customers c
    join state s on c.state_code = s.state_code
  );
  
[0m19:27:49.392647 [debug] [Thread-1 (]: SQL status: SELECT 100 in 0.0 seconds
[0m19:27:49.395682 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.dim_customers"
[0m19:27:49.396689 [debug] [Thread-1 (]: On model.dbt_idx.dim_customers: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.dim_customers"} */
alter table "IDX-Stock"."IDX-Schema"."dim_customers" rename to "dim_customers__dbt_backup"
[0m19:27:49.398684 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:27:49.439280 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.dim_customers"
[0m19:27:49.440245 [debug] [Thread-1 (]: On model.dbt_idx.dim_customers: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.dim_customers"} */
alter table "IDX-Stock"."IDX-Schema"."dim_customers__dbt_tmp" rename to "dim_customers"
[0m19:27:49.442245 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:27:49.445281 [debug] [Thread-1 (]: On model.dbt_idx.dim_customers: COMMIT
[0m19:27:49.446246 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.dim_customers"
[0m19:27:49.446246 [debug] [Thread-1 (]: On model.dbt_idx.dim_customers: COMMIT
[0m19:27:49.449724 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m19:27:49.452751 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.dim_customers"
[0m19:27:49.453747 [debug] [Thread-1 (]: On model.dbt_idx.dim_customers: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.dim_customers"} */
drop table if exists "IDX-Stock"."IDX-Schema"."dim_customers__dbt_backup" cascade
[0m19:27:49.457715 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m19:27:49.459739 [debug] [Thread-1 (]: Timing info for model.dbt_idx.dim_customers (execute): 19:27:49.350602 => 19:27:49.458711
[0m19:27:49.459739 [debug] [Thread-1 (]: On model.dbt_idx.dim_customers: Close
[0m19:27:49.461723 [info ] [Thread-1 (]: 8 of 11 OK created sql table model IDX-Schema.dim_customers .................... [[32mSELECT 100[0m in 0.12s]
[0m19:27:49.463729 [debug] [Thread-1 (]: Finished running node model.dbt_idx.dim_customers
[0m19:27:49.464716 [debug] [Thread-1 (]: Began running node model.dbt_idx.fact_stocks
[0m19:27:49.465712 [info ] [Thread-1 (]: 9 of 11 START sql table model IDX-Schema.fact_stocks ........................... [RUN]
[0m19:27:49.467738 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_idx.dim_customers, now model.dbt_idx.fact_stocks)
[0m19:27:49.468712 [debug] [Thread-1 (]: Began compiling node model.dbt_idx.fact_stocks
[0m19:27:49.471737 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_idx.fact_stocks"
[0m19:27:49.478716 [debug] [Thread-1 (]: Timing info for model.dbt_idx.fact_stocks (compile): 19:27:49.468712 => 19:27:49.478716
[0m19:27:49.479756 [debug] [Thread-1 (]: Began executing node model.dbt_idx.fact_stocks
[0m19:27:49.484738 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_idx.fact_stocks"
[0m19:27:49.490423 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.fact_stocks"
[0m19:27:49.491388 [debug] [Thread-1 (]: On model.dbt_idx.fact_stocks: BEGIN
[0m19:27:49.492392 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:27:49.512600 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m19:27:49.513600 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.fact_stocks"
[0m19:27:49.514604 [debug] [Thread-1 (]: On model.dbt_idx.fact_stocks: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.fact_stocks"} */

  
    

  create  table "IDX-Stock"."IDX-Schema"."fact_stocks__dbt_tmp"
  
  
    as
  
  (
    -- noinspection SqlDialectInspectionForFile

with stock as (
    select *
    from "IDX-Stock"."IDX-Schema"."stg_eltool__stock"
    ),
     company as (
         select *
         from "IDX-Stock"."IDX-Schema"."stg_eltool__company"
     )
select a.id,
       a.ticker,
       b.name,
       a.date,
       a.open,
       a.high,
       a.low,
       a.close,
       a.volume,
       b.logo
from stock a
    join company b on a.ticker = b.ticker
  );
  
[0m19:27:49.557258 [debug] [Thread-1 (]: SQL status: SELECT 26131 in 0.0 seconds
[0m19:27:49.560242 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.fact_stocks"
[0m19:27:49.561749 [debug] [Thread-1 (]: On model.dbt_idx.fact_stocks: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.fact_stocks"} */
alter table "IDX-Stock"."IDX-Schema"."fact_stocks" rename to "fact_stocks__dbt_backup"
[0m19:27:49.563774 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:27:49.567756 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.fact_stocks"
[0m19:27:49.568757 [debug] [Thread-1 (]: On model.dbt_idx.fact_stocks: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.fact_stocks"} */
alter table "IDX-Stock"."IDX-Schema"."fact_stocks__dbt_tmp" rename to "fact_stocks"
[0m19:27:49.570897 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:27:49.572884 [debug] [Thread-1 (]: On model.dbt_idx.fact_stocks: COMMIT
[0m19:27:49.573884 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.fact_stocks"
[0m19:27:49.574883 [debug] [Thread-1 (]: On model.dbt_idx.fact_stocks: COMMIT
[0m19:27:49.586631 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m19:27:49.589632 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.fact_stocks"
[0m19:27:49.590645 [debug] [Thread-1 (]: On model.dbt_idx.fact_stocks: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.fact_stocks"} */
drop table if exists "IDX-Stock"."IDX-Schema"."fact_stocks__dbt_backup" cascade
[0m19:27:49.596616 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m19:27:49.598651 [debug] [Thread-1 (]: Timing info for model.dbt_idx.fact_stocks (execute): 19:27:49.479756 => 19:27:49.598651
[0m19:27:49.599617 [debug] [Thread-1 (]: On model.dbt_idx.fact_stocks: Close
[0m19:27:49.601615 [info ] [Thread-1 (]: 9 of 11 OK created sql table model IDX-Schema.fact_stocks ...................... [[32mSELECT 26131[0m in 0.13s]
[0m19:27:49.602619 [debug] [Thread-1 (]: Finished running node model.dbt_idx.fact_stocks
[0m19:27:49.603616 [debug] [Thread-1 (]: Began running node model.dbt_idx.customer_orders_status
[0m19:27:49.604617 [info ] [Thread-1 (]: 10 of 11 START sql view model IDX-Schema.customer_orders_status ................ [RUN]
[0m19:27:49.606663 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_idx.fact_stocks, now model.dbt_idx.customer_orders_status)
[0m19:27:49.606663 [debug] [Thread-1 (]: Began compiling node model.dbt_idx.customer_orders_status
[0m19:27:49.610700 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_idx.customer_orders_status"
[0m19:27:49.617556 [debug] [Thread-1 (]: Timing info for model.dbt_idx.customer_orders_status (compile): 19:27:49.607662 => 19:27:49.616593
[0m19:27:49.618556 [debug] [Thread-1 (]: Began executing node model.dbt_idx.customer_orders_status
[0m19:27:49.622556 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_idx.customer_orders_status"
[0m19:27:49.629560 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.customer_orders_status"
[0m19:27:49.630591 [debug] [Thread-1 (]: On model.dbt_idx.customer_orders_status: BEGIN
[0m19:27:49.631593 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:27:49.652717 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m19:27:49.653742 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.customer_orders_status"
[0m19:27:49.654724 [debug] [Thread-1 (]: On model.dbt_idx.customer_orders_status: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.customer_orders_status"} */

  create view "IDX-Stock"."IDX-Schema"."customer_orders_status__dbt_tmp"
    
    
  as (
    with orders as (select *
                from "IDX-Stock"."IDX-Schema"."fact_orders"),
     customers as (select *
                   from "IDX-Stock"."IDX-Schema"."dim_customers")
select o.order_id,
       o.customer_id,
       o.order_status,
       o.order_purchase_timestamp,
       o.order_approved_at,
       o.order_delivered_carrier_date,
       o.order_delivered_customer_date,
       o.order_estimated_delivery_date,
       c.zipcode    as customer_zipcode,
       c.city       as customer_city,
       c.state_code as customer_state_code,
       c.state_name as customer_state_name
from orders o
    join customers c on o.customer_id = c.customer_id
    and o.order_purchase_timestamp >= c.valid_from
    and o.order_purchase_timestamp <= c.valid_to
  );
[0m19:27:49.657968 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m19:27:49.662018 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.customer_orders_status"
[0m19:27:49.662969 [debug] [Thread-1 (]: On model.dbt_idx.customer_orders_status: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.customer_orders_status"} */
alter table "IDX-Stock"."IDX-Schema"."customer_orders_status__dbt_tmp" rename to "customer_orders_status"
[0m19:27:49.664972 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:27:49.667005 [debug] [Thread-1 (]: On model.dbt_idx.customer_orders_status: COMMIT
[0m19:27:49.667970 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.customer_orders_status"
[0m19:27:49.668972 [debug] [Thread-1 (]: On model.dbt_idx.customer_orders_status: COMMIT
[0m19:27:49.672019 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m19:27:49.675708 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.customer_orders_status"
[0m19:27:49.675708 [debug] [Thread-1 (]: On model.dbt_idx.customer_orders_status: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.customer_orders_status"} */
drop view if exists "IDX-Stock"."IDX-Schema"."customer_orders_status__dbt_backup" cascade
[0m19:27:49.678713 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m19:27:49.679750 [debug] [Thread-1 (]: Timing info for model.dbt_idx.customer_orders_status (execute): 19:27:49.618556 => 19:27:49.679750
[0m19:27:49.680756 [debug] [Thread-1 (]: On model.dbt_idx.customer_orders_status: Close
[0m19:27:49.682719 [info ] [Thread-1 (]: 10 of 11 OK created sql view model IDX-Schema.customer_orders_status ........... [[32mCREATE VIEW[0m in 0.08s]
[0m19:27:49.684717 [debug] [Thread-1 (]: Finished running node model.dbt_idx.customer_orders_status
[0m19:27:49.685717 [debug] [Thread-1 (]: Began running node model.dbt_idx.stock_update_status
[0m19:27:49.685717 [info ] [Thread-1 (]: 11 of 11 START sql view model IDX-Schema.stock_update_status ................... [RUN]
[0m19:27:49.687753 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_idx.customer_orders_status, now model.dbt_idx.stock_update_status)
[0m19:27:49.687753 [debug] [Thread-1 (]: Began compiling node model.dbt_idx.stock_update_status
[0m19:27:49.691760 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_idx.stock_update_status"
[0m19:27:49.697657 [debug] [Thread-1 (]: Timing info for model.dbt_idx.stock_update_status (compile): 19:27:49.688749 => 19:27:49.697657
[0m19:27:49.698640 [debug] [Thread-1 (]: Began executing node model.dbt_idx.stock_update_status
[0m19:27:49.704639 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_idx.stock_update_status"
[0m19:27:49.711152 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stock_update_status"
[0m19:27:49.712139 [debug] [Thread-1 (]: On model.dbt_idx.stock_update_status: BEGIN
[0m19:27:49.713137 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:27:49.739637 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m19:27:49.740642 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stock_update_status"
[0m19:27:49.741657 [debug] [Thread-1 (]: On model.dbt_idx.stock_update_status: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stock_update_status"} */

  create view "IDX-Stock"."IDX-Schema"."stock_update_status__dbt_tmp"
    
    
  as (
    with stock as (select *
               from "IDX-Stock"."IDX-Schema"."fact_stocks")
select a.id,
       a.ticker,
       b.name,
       a.date,
       a.open,
       a.high,
       a.low,
       a.close,
       a.volume,
       rank() over (order by a.date desc) as rank
       b.logo
from stock a
  );
[0m19:27:49.745306 [debug] [Thread-1 (]: Postgres adapter: Postgres error: syntax error at or near "b"
LINE 19:        b.logo
                ^

[0m19:27:49.746318 [debug] [Thread-1 (]: On model.dbt_idx.stock_update_status: ROLLBACK
[0m19:27:49.748401 [debug] [Thread-1 (]: Timing info for model.dbt_idx.stock_update_status (execute): 19:27:49.698640 => 19:27:49.748401
[0m19:27:49.749423 [debug] [Thread-1 (]: On model.dbt_idx.stock_update_status: Close
[0m19:27:49.765960 [debug] [Thread-1 (]: Database Error in model stock_update_status (models\marts\stock\stock_update_status.sql)
  syntax error at or near "b"
  LINE 19:        b.logo
                  ^
  compiled Code at target\run\dbt_idx\models\marts\stock\stock_update_status.sql
[0m19:27:49.766997 [error] [Thread-1 (]: 11 of 11 ERROR creating sql view model IDX-Schema.stock_update_status .......... [[31mERROR[0m in 0.08s]
[0m19:27:49.767993 [debug] [Thread-1 (]: Finished running node model.dbt_idx.stock_update_status
[0m19:27:49.770968 [debug] [MainThread]: Using postgres connection "master"
[0m19:27:49.771970 [debug] [MainThread]: On master: BEGIN
[0m19:27:49.772967 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m19:27:49.802924 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m19:27:49.804462 [debug] [MainThread]: On master: COMMIT
[0m19:27:49.804462 [debug] [MainThread]: Using postgres connection "master"
[0m19:27:49.805506 [debug] [MainThread]: On master: COMMIT
[0m19:27:49.807534 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m19:27:49.808497 [debug] [MainThread]: On master: Close
[0m19:27:49.809496 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:27:49.811504 [debug] [MainThread]: Connection 'list_IDX-Stock' was properly closed.
[0m19:27:49.812505 [debug] [MainThread]: Connection 'list_IDX-Stock_IDX-Schema' was properly closed.
[0m19:27:49.813501 [debug] [MainThread]: Connection 'model.dbt_idx.stock_update_status' was properly closed.
[0m19:27:49.814502 [info ] [MainThread]: 
[0m19:27:49.815498 [info ] [MainThread]: Finished running 8 view models, 3 table models in 0 hours 0 minutes and 1.50 seconds (1.50s).
[0m19:27:49.818532 [debug] [MainThread]: Command end result
[0m19:27:49.845497 [info ] [MainThread]: 
[0m19:27:49.846497 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m19:27:49.846497 [info ] [MainThread]: 
[0m19:27:49.848508 [error] [MainThread]: [33mDatabase Error in model stock_update_status (models\marts\stock\stock_update_status.sql)[0m
[0m19:27:49.849510 [error] [MainThread]:   syntax error at or near "b"
[0m19:27:49.850499 [error] [MainThread]:   LINE 19:        b.logo
[0m19:27:49.851511 [error] [MainThread]:                   ^
[0m19:27:49.851511 [error] [MainThread]:   compiled Code at target\run\dbt_idx\models\marts\stock\stock_update_status.sql
[0m19:27:49.852497 [info ] [MainThread]: 
[0m19:27:49.853522 [info ] [MainThread]: Done. PASS=10 WARN=0 ERROR=1 SKIP=0 TOTAL=11
[0m19:27:49.854501 [debug] [MainThread]: Command `dbt run` failed at 19:27:49.854501 after 2.02 seconds
[0m19:27:49.855506 [debug] [MainThread]: Flushing usage events


============================== 19:28:01.246805 | 976c77ff-5a10-4244-83b8-f051dced7807 ==============================
[0m19:28:01.246805 [info ] [MainThread]: Running with dbt=1.6.1
[0m19:28:01.254812 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': 'D:\\00 Project\\00 My Project\\IdeaProjects\\Py-DBT-IDX', 'log_path': 'D:\\00 Project\\00 My Project\\IdeaProjects\\Py-DBT-IDX\\logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'False'}
[0m19:28:01.418864 [info ] [MainThread]: Registered adapter: postgres=1.6.1
[0m19:28:01.430384 [debug] [MainThread]: checksum: efe19d9f5b93d1a98cc804fbfcdb6b3aced98b974af664946fee1cde8837deb7, vars: {}, profile: , target: , version: 1.6.1
[0m19:28:01.625537 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m19:28:01.626537 [debug] [MainThread]: Partial parsing: updated file: dbt_idx://models\marts\stock\stock_update_status.sql
[0m19:28:01.752494 [info ] [MainThread]: Found 11 models, 1 snapshot, 18 tests, 5 sources, 0 exposures, 0 metrics, 349 macros, 0 groups, 0 semantic models
[0m19:28:01.758044 [info ] [MainThread]: 
[0m19:28:01.760036 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m19:28:01.765079 [debug] [ThreadPool]: Acquiring new postgres connection 'list_IDX-Stock'
[0m19:28:01.776425 [debug] [ThreadPool]: Using postgres connection "list_IDX-Stock"
[0m19:28:01.777458 [debug] [ThreadPool]: On list_IDX-Stock: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "connection_name": "list_IDX-Stock"} */

    select distinct nspname from pg_namespace
  
[0m19:28:01.778426 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:28:01.818186 [debug] [ThreadPool]: SQL status: SELECT 12 in 0.0 seconds
[0m19:28:01.821199 [debug] [ThreadPool]: On list_IDX-Stock: Close
[0m19:28:01.825727 [debug] [ThreadPool]: Acquiring new postgres connection 'list_IDX-Stock_snapshots'
[0m19:28:01.832758 [debug] [ThreadPool]: Using postgres connection "list_IDX-Stock_snapshots"
[0m19:28:01.833183 [debug] [ThreadPool]: On list_IDX-Stock_snapshots: BEGIN
[0m19:28:01.833760 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:28:01.855303 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m19:28:01.855303 [debug] [ThreadPool]: Using postgres connection "list_IDX-Stock_snapshots"
[0m19:28:01.856340 [debug] [ThreadPool]: On list_IDX-Stock_snapshots: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "connection_name": "list_IDX-Stock_snapshots"} */
select
      'IDX-Stock' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'snapshots'
    union all
    select
      'IDX-Stock' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'snapshots'
    union all
    select
      'IDX-Stock' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'snapshots'
  
[0m19:28:01.861301 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.0 seconds
[0m19:28:01.862338 [debug] [ThreadPool]: On list_IDX-Stock_snapshots: ROLLBACK
[0m19:28:01.864303 [debug] [ThreadPool]: On list_IDX-Stock_snapshots: Close
[0m19:28:01.866437 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_IDX-Stock_snapshots, now list_IDX-Stock_IDX-Schema)
[0m19:28:01.871430 [debug] [ThreadPool]: Using postgres connection "list_IDX-Stock_IDX-Schema"
[0m19:28:01.872432 [debug] [ThreadPool]: On list_IDX-Stock_IDX-Schema: BEGIN
[0m19:28:01.873433 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:28:01.896669 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m19:28:01.897665 [debug] [ThreadPool]: Using postgres connection "list_IDX-Stock_IDX-Schema"
[0m19:28:01.898665 [debug] [ThreadPool]: On list_IDX-Stock_IDX-Schema: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "connection_name": "list_IDX-Stock_IDX-Schema"} */
select
      'IDX-Stock' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'IDX-Schema'
    union all
    select
      'IDX-Stock' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'IDX-Schema'
    union all
    select
      'IDX-Stock' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'IDX-Schema'
  
[0m19:28:01.903692 [debug] [ThreadPool]: SQL status: SELECT 16 in 0.0 seconds
[0m19:28:01.906250 [debug] [ThreadPool]: On list_IDX-Stock_IDX-Schema: ROLLBACK
[0m19:28:01.909215 [debug] [ThreadPool]: On list_IDX-Stock_IDX-Schema: Close
[0m19:28:01.919736 [debug] [MainThread]: Using postgres connection "master"
[0m19:28:01.920737 [debug] [MainThread]: On master: BEGIN
[0m19:28:01.921738 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:28:01.942809 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m19:28:01.943802 [debug] [MainThread]: Using postgres connection "master"
[0m19:28:01.944804 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m19:28:01.952747 [debug] [MainThread]: SQL status: SELECT 8 in 0.0 seconds
[0m19:28:01.955739 [debug] [MainThread]: On master: ROLLBACK
[0m19:28:01.957738 [debug] [MainThread]: Using postgres connection "master"
[0m19:28:01.959250 [debug] [MainThread]: On master: BEGIN
[0m19:28:01.963296 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m19:28:01.964263 [debug] [MainThread]: On master: COMMIT
[0m19:28:01.964263 [debug] [MainThread]: Using postgres connection "master"
[0m19:28:01.965261 [debug] [MainThread]: On master: COMMIT
[0m19:28:01.967971 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m19:28:01.968971 [debug] [MainThread]: On master: Close
[0m19:28:01.969992 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m19:28:01.971972 [info ] [MainThread]: 
[0m19:28:01.977481 [debug] [Thread-1 (]: Began running node model.dbt_idx.stg_eltool__company
[0m19:28:01.978488 [info ] [Thread-1 (]: 1 of 11 START sql view model IDX-Schema.stg_eltool__company .................... [RUN]
[0m19:28:01.980489 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.dbt_idx.stg_eltool__company'
[0m19:28:01.981523 [debug] [Thread-1 (]: Began compiling node model.dbt_idx.stg_eltool__company
[0m19:28:01.990522 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_idx.stg_eltool__company"
[0m19:28:01.997025 [debug] [Thread-1 (]: Timing info for model.dbt_idx.stg_eltool__company (compile): 19:28:01.982534 => 19:28:01.997025
[0m19:28:01.999021 [debug] [Thread-1 (]: Began executing node model.dbt_idx.stg_eltool__company
[0m19:28:02.039789 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_idx.stg_eltool__company"
[0m19:28:02.046752 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__company"
[0m19:28:02.047752 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__company: BEGIN
[0m19:28:02.047752 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m19:28:02.070312 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m19:28:02.072423 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__company"
[0m19:28:02.072423 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__company: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__company"} */

  create view "IDX-Stock"."IDX-Schema"."stg_eltool__company__dbt_tmp"
    
    
  as (
    with source as (select *
                from "IDX-Stock"."IDX-Schema"."ksql-company-stream"),
     renamed as (select id,
                        ticker,
                        name,
                        logo
                 from source)
select *
from renamed
  );
[0m19:28:02.076425 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m19:28:02.084459 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__company"
[0m19:28:02.085422 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__company: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__company"} */
alter table "IDX-Stock"."IDX-Schema"."stg_eltool__company" rename to "stg_eltool__company__dbt_backup"
[0m19:28:02.088423 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:28:02.091977 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__company"
[0m19:28:02.092937 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__company: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__company"} */
alter table "IDX-Stock"."IDX-Schema"."stg_eltool__company__dbt_tmp" rename to "stg_eltool__company"
[0m19:28:02.095101 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:28:02.113558 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__company: COMMIT
[0m19:28:02.113558 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__company"
[0m19:28:02.114558 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__company: COMMIT
[0m19:28:02.118524 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m19:28:02.130172 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__company"
[0m19:28:02.131175 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__company: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__company"} */
drop view if exists "IDX-Stock"."IDX-Schema"."stg_eltool__company__dbt_backup" cascade
[0m19:28:02.135169 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m19:28:02.138166 [debug] [Thread-1 (]: Timing info for model.dbt_idx.stg_eltool__company (execute): 19:28:02.000021 => 19:28:02.138166
[0m19:28:02.139167 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__company: Close
[0m19:28:02.141176 [info ] [Thread-1 (]: 1 of 11 OK created sql view model IDX-Schema.stg_eltool__company ............... [[32mCREATE VIEW[0m in 0.16s]
[0m19:28:02.144615 [debug] [Thread-1 (]: Finished running node model.dbt_idx.stg_eltool__company
[0m19:28:02.146780 [debug] [Thread-1 (]: Began running node model.dbt_idx.stg_eltool__customers
[0m19:28:02.147903 [info ] [Thread-1 (]: 2 of 11 START sql view model IDX-Schema.stg_eltool__customers .................. [RUN]
[0m19:28:02.150173 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_idx.stg_eltool__company, now model.dbt_idx.stg_eltool__customers)
[0m19:28:02.152042 [debug] [Thread-1 (]: Began compiling node model.dbt_idx.stg_eltool__customers
[0m19:28:02.159624 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_idx.stg_eltool__customers"
[0m19:28:02.168296 [debug] [Thread-1 (]: Timing info for model.dbt_idx.stg_eltool__customers (compile): 19:28:02.153183 => 19:28:02.167277
[0m19:28:02.169284 [debug] [Thread-1 (]: Began executing node model.dbt_idx.stg_eltool__customers
[0m19:28:02.177319 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_idx.stg_eltool__customers"
[0m19:28:02.183202 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__customers"
[0m19:28:02.184187 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__customers: BEGIN
[0m19:28:02.185187 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:28:02.206204 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m19:28:02.207199 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__customers"
[0m19:28:02.207199 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__customers: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__customers"} */

  create view "IDX-Stock"."IDX-Schema"."stg_eltool__customers__dbt_tmp"
    
    
  as (
    with source as (select *
                from "IDX-Stock"."IDX-Schema"."customers"),
     renamed as (select
                     customer_id,
                    'This is Dummy' as dummy
                 from source
                 where customer_id = 1234567890)
select *
from renamed
  );
[0m19:28:02.210203 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m19:28:02.214233 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__customers"
[0m19:28:02.215245 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__customers: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__customers"} */
alter table "IDX-Stock"."IDX-Schema"."stg_eltool__customers" rename to "stg_eltool__customers__dbt_backup"
[0m19:28:02.217204 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:28:02.222791 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__customers"
[0m19:28:02.222791 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__customers: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__customers"} */
alter table "IDX-Stock"."IDX-Schema"."stg_eltool__customers__dbt_tmp" rename to "stg_eltool__customers"
[0m19:28:02.226832 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:28:02.228787 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__customers: COMMIT
[0m19:28:02.229790 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__customers"
[0m19:28:02.230752 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__customers: COMMIT
[0m19:28:02.234136 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m19:28:02.238183 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__customers"
[0m19:28:02.238183 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__customers: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__customers"} */
drop view if exists "IDX-Stock"."IDX-Schema"."stg_eltool__customers__dbt_backup" cascade
[0m19:28:02.242149 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m19:28:02.244179 [debug] [Thread-1 (]: Timing info for model.dbt_idx.stg_eltool__customers (execute): 19:28:02.170285 => 19:28:02.244179
[0m19:28:02.245149 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__customers: Close
[0m19:28:02.247185 [info ] [Thread-1 (]: 2 of 11 OK created sql view model IDX-Schema.stg_eltool__customers ............. [[32mCREATE VIEW[0m in 0.10s]
[0m19:28:02.249147 [debug] [Thread-1 (]: Finished running node model.dbt_idx.stg_eltool__customers
[0m19:28:02.250152 [debug] [Thread-1 (]: Began running node model.dbt_idx.stg_eltool__customers_snapshots
[0m19:28:02.251167 [info ] [Thread-1 (]: 3 of 11 START sql view model IDX-Schema.stg_eltool__customers_snapshots ........ [RUN]
[0m19:28:02.253152 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_idx.stg_eltool__customers, now model.dbt_idx.stg_eltool__customers_snapshots)
[0m19:28:02.254148 [debug] [Thread-1 (]: Began compiling node model.dbt_idx.stg_eltool__customers_snapshots
[0m19:28:02.258186 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_idx.stg_eltool__customers_snapshots"
[0m19:28:02.264147 [debug] [Thread-1 (]: Timing info for model.dbt_idx.stg_eltool__customers_snapshots (compile): 19:28:02.255155 => 19:28:02.263181
[0m19:28:02.265146 [debug] [Thread-1 (]: Began executing node model.dbt_idx.stg_eltool__customers_snapshots
[0m19:28:02.271150 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_idx.stg_eltool__customers_snapshots"
[0m19:28:02.276610 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__customers_snapshots"
[0m19:28:02.277672 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__customers_snapshots: BEGIN
[0m19:28:02.278623 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:28:02.298983 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m19:28:02.300046 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__customers_snapshots"
[0m19:28:02.300976 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__customers_snapshots: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__customers_snapshots"} */

  create view "IDX-Stock"."IDX-Schema"."stg_eltool__customers_snapshots__dbt_tmp"
    
    
  as (
    with source as (select *
                from "IDX-Stock"."snapshots"."customers_snapshot"),
     renamed as (select customer_id,
                        zipcode,
                        city,
                        state_code,
                        datetime_created::TIMESTAMP AS datetime_created,
                        datetime_updated::TIMESTAMP AS datetime_updated,
                        dbt_valid_from,
                        dbt_valid_to
                 from source)
select *
from renamed
  );
[0m19:28:02.304223 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m19:28:02.308270 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__customers_snapshots"
[0m19:28:02.309239 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__customers_snapshots: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__customers_snapshots"} */
alter table "IDX-Stock"."IDX-Schema"."stg_eltool__customers_snapshots" rename to "stg_eltool__customers_snapshots__dbt_backup"
[0m19:28:02.311254 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:28:02.314276 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__customers_snapshots"
[0m19:28:02.315267 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__customers_snapshots: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__customers_snapshots"} */
alter table "IDX-Stock"."IDX-Schema"."stg_eltool__customers_snapshots__dbt_tmp" rename to "stg_eltool__customers_snapshots"
[0m19:28:02.317237 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:28:02.320763 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__customers_snapshots: COMMIT
[0m19:28:02.321767 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__customers_snapshots"
[0m19:28:02.322759 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__customers_snapshots: COMMIT
[0m19:28:02.325812 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m19:28:02.329853 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__customers_snapshots"
[0m19:28:02.329853 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__customers_snapshots: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__customers_snapshots"} */
drop view if exists "IDX-Stock"."IDX-Schema"."stg_eltool__customers_snapshots__dbt_backup" cascade
[0m19:28:02.333824 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m19:28:02.335849 [debug] [Thread-1 (]: Timing info for model.dbt_idx.stg_eltool__customers_snapshots (execute): 19:28:02.265146 => 19:28:02.334822
[0m19:28:02.335849 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__customers_snapshots: Close
[0m19:28:02.337840 [info ] [Thread-1 (]: 3 of 11 OK created sql view model IDX-Schema.stg_eltool__customers_snapshots ... [[32mCREATE VIEW[0m in 0.08s]
[0m19:28:02.339824 [debug] [Thread-1 (]: Finished running node model.dbt_idx.stg_eltool__customers_snapshots
[0m19:28:02.340880 [debug] [Thread-1 (]: Began running node model.dbt_idx.stg_eltool__orders
[0m19:28:02.341847 [info ] [Thread-1 (]: 4 of 11 START sql view model IDX-Schema.stg_eltool__orders ..................... [RUN]
[0m19:28:02.343823 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_idx.stg_eltool__customers_snapshots, now model.dbt_idx.stg_eltool__orders)
[0m19:28:02.344822 [debug] [Thread-1 (]: Began compiling node model.dbt_idx.stg_eltool__orders
[0m19:28:02.346849 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_idx.stg_eltool__orders"
[0m19:28:02.357473 [debug] [Thread-1 (]: Timing info for model.dbt_idx.stg_eltool__orders (compile): 19:28:02.344822 => 19:28:02.357473
[0m19:28:02.358472 [debug] [Thread-1 (]: Began executing node model.dbt_idx.stg_eltool__orders
[0m19:28:02.363473 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_idx.stg_eltool__orders"
[0m19:28:02.374458 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__orders"
[0m19:28:02.375436 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__orders: BEGIN
[0m19:28:02.375436 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:28:02.397092 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m19:28:02.398123 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__orders"
[0m19:28:02.398123 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__orders: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__orders"} */

  create view "IDX-Stock"."IDX-Schema"."stg_eltool__orders__dbt_tmp"
    
    
  as (
    with source as (select *
                from "IDX-Stock"."IDX-Schema"."orders"),
     renamed as (select order_id,
                        cust_id AS customer_id,
                        order_status,
                        order_purchase_timestamp::TIMESTAMP,
                        order_approved_at::TIMESTAMP,
                        order_delivered_carrier_date::TIMESTAMP,
                        order_delivered_customer_date::TIMESTAMP,
                        order_estimated_delivery_date::TIMESTAMP
                 from source)
select *
from renamed
  );
[0m19:28:02.402089 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m19:28:02.406099 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__orders"
[0m19:28:02.407096 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__orders: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__orders"} */
alter table "IDX-Stock"."IDX-Schema"."stg_eltool__orders" rename to "stg_eltool__orders__dbt_backup"
[0m19:28:02.410100 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:28:02.414131 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__orders"
[0m19:28:02.415096 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__orders: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__orders"} */
alter table "IDX-Stock"."IDX-Schema"."stg_eltool__orders__dbt_tmp" rename to "stg_eltool__orders"
[0m19:28:02.417113 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:28:02.419679 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__orders: COMMIT
[0m19:28:02.419679 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__orders"
[0m19:28:02.420680 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__orders: COMMIT
[0m19:28:02.424099 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m19:28:02.427132 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__orders"
[0m19:28:02.428135 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__orders: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__orders"} */
drop view if exists "IDX-Stock"."IDX-Schema"."stg_eltool__orders__dbt_backup" cascade
[0m19:28:02.432132 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m19:28:02.433134 [debug] [Thread-1 (]: Timing info for model.dbt_idx.stg_eltool__orders (execute): 19:28:02.359470 => 19:28:02.433134
[0m19:28:02.436168 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__orders: Close
[0m19:28:02.438101 [info ] [Thread-1 (]: 4 of 11 OK created sql view model IDX-Schema.stg_eltool__orders ................ [[32mCREATE VIEW[0m in 0.09s]
[0m19:28:02.440115 [debug] [Thread-1 (]: Finished running node model.dbt_idx.stg_eltool__orders
[0m19:28:02.441096 [debug] [Thread-1 (]: Began running node model.dbt_idx.stg_eltool__state
[0m19:28:02.443133 [info ] [Thread-1 (]: 5 of 11 START sql view model IDX-Schema.stg_eltool__state ...................... [RUN]
[0m19:28:02.444104 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_idx.stg_eltool__orders, now model.dbt_idx.stg_eltool__state)
[0m19:28:02.445135 [debug] [Thread-1 (]: Began compiling node model.dbt_idx.stg_eltool__state
[0m19:28:02.448133 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_idx.stg_eltool__state"
[0m19:28:02.454136 [debug] [Thread-1 (]: Timing info for model.dbt_idx.stg_eltool__state (compile): 19:28:02.446101 => 19:28:02.454136
[0m19:28:02.455147 [debug] [Thread-1 (]: Began executing node model.dbt_idx.stg_eltool__state
[0m19:28:02.460098 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_idx.stg_eltool__state"
[0m19:28:02.467100 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__state"
[0m19:28:02.468097 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__state: BEGIN
[0m19:28:02.469099 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:28:02.505086 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m19:28:02.505630 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__state"
[0m19:28:02.506665 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__state: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__state"} */

  create view "IDX-Stock"."IDX-Schema"."stg_eltool__state__dbt_tmp"
    
    
  as (
    with source as (select *
                from "IDX-Stock"."IDX-Schema"."state"),
     renamed as (select state_identifier::INT AS state_id,
                         state_code::VARCHAR(2) AS state_code,
                         st_name::VARCHAR(30) AS state_name
                 from source)
select *
from renamed
  );
[0m19:28:02.509363 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m19:28:02.513376 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__state"
[0m19:28:02.514404 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__state: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__state"} */
alter table "IDX-Stock"."IDX-Schema"."stg_eltool__state" rename to "stg_eltool__state__dbt_backup"
[0m19:28:02.517376 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:28:02.519915 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__state"
[0m19:28:02.520946 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__state: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__state"} */
alter table "IDX-Stock"."IDX-Schema"."stg_eltool__state__dbt_tmp" rename to "stg_eltool__state"
[0m19:28:02.522911 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:28:02.525935 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__state: COMMIT
[0m19:28:02.525935 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__state"
[0m19:28:02.526944 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__state: COMMIT
[0m19:28:02.530156 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m19:28:02.534179 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__state"
[0m19:28:02.535191 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__state: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__state"} */
drop view if exists "IDX-Stock"."IDX-Schema"."stg_eltool__state__dbt_backup" cascade
[0m19:28:02.539160 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m19:28:02.541162 [debug] [Thread-1 (]: Timing info for model.dbt_idx.stg_eltool__state (execute): 19:28:02.456119 => 19:28:02.541162
[0m19:28:02.542154 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__state: Close
[0m19:28:02.543172 [info ] [Thread-1 (]: 5 of 11 OK created sql view model IDX-Schema.stg_eltool__state ................. [[32mCREATE VIEW[0m in 0.10s]
[0m19:28:02.545158 [debug] [Thread-1 (]: Finished running node model.dbt_idx.stg_eltool__state
[0m19:28:02.547159 [debug] [Thread-1 (]: Began running node model.dbt_idx.stg_eltool__stock
[0m19:28:02.548155 [info ] [Thread-1 (]: 6 of 11 START sql view model IDX-Schema.stg_eltool__stock ...................... [RUN]
[0m19:28:02.549155 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_idx.stg_eltool__state, now model.dbt_idx.stg_eltool__stock)
[0m19:28:02.550192 [debug] [Thread-1 (]: Began compiling node model.dbt_idx.stg_eltool__stock
[0m19:28:02.553191 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_idx.stg_eltool__stock"
[0m19:28:02.560155 [debug] [Thread-1 (]: Timing info for model.dbt_idx.stg_eltool__stock (compile): 19:28:02.551160 => 19:28:02.560155
[0m19:28:02.561155 [debug] [Thread-1 (]: Began executing node model.dbt_idx.stg_eltool__stock
[0m19:28:02.567155 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_idx.stg_eltool__stock"
[0m19:28:02.573189 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__stock"
[0m19:28:02.574190 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__stock: BEGIN
[0m19:28:02.576197 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:28:02.601155 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m19:28:02.602159 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__stock"
[0m19:28:02.602159 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__stock: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__stock"} */

  create view "IDX-Stock"."IDX-Schema"."stg_eltool__stock__dbt_tmp"
    
    
  as (
    with source as (select *
                from "IDX-Stock"."IDX-Schema"."ksql-stock-stream"),
     renamed as (select *
                 from source)
select *
from renamed
  );
[0m19:28:02.606171 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m19:28:02.610169 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__stock"
[0m19:28:02.611173 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__stock: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__stock"} */
alter table "IDX-Stock"."IDX-Schema"."stg_eltool__stock" rename to "stg_eltool__stock__dbt_backup"
[0m19:28:02.614175 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:28:02.618169 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__stock"
[0m19:28:02.619696 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__stock: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__stock"} */
alter table "IDX-Stock"."IDX-Schema"."stg_eltool__stock__dbt_tmp" rename to "stg_eltool__stock"
[0m19:28:02.621712 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:28:02.625708 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__stock: COMMIT
[0m19:28:02.626723 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__stock"
[0m19:28:02.627711 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__stock: COMMIT
[0m19:28:02.631722 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m19:28:02.635707 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__stock"
[0m19:28:02.636717 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__stock: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__stock"} */
drop view if exists "IDX-Stock"."IDX-Schema"."stg_eltool__stock__dbt_backup" cascade
[0m19:28:02.640706 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m19:28:02.643707 [debug] [Thread-1 (]: Timing info for model.dbt_idx.stg_eltool__stock (execute): 19:28:02.562155 => 19:28:02.642706
[0m19:28:02.644713 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__stock: Close
[0m19:28:02.646709 [info ] [Thread-1 (]: 6 of 11 OK created sql view model IDX-Schema.stg_eltool__stock ................. [[32mCREATE VIEW[0m in 0.10s]
[0m19:28:02.648724 [debug] [Thread-1 (]: Finished running node model.dbt_idx.stg_eltool__stock
[0m19:28:02.650709 [debug] [Thread-1 (]: Began running node model.dbt_idx.fact_orders
[0m19:28:02.651717 [info ] [Thread-1 (]: 7 of 11 START sql table model IDX-Schema.fact_orders ........................... [RUN]
[0m19:28:02.652707 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_idx.stg_eltool__stock, now model.dbt_idx.fact_orders)
[0m19:28:02.653707 [debug] [Thread-1 (]: Began compiling node model.dbt_idx.fact_orders
[0m19:28:02.659711 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_idx.fact_orders"
[0m19:28:02.669709 [debug] [Thread-1 (]: Timing info for model.dbt_idx.fact_orders (compile): 19:28:02.654707 => 19:28:02.668706
[0m19:28:02.671708 [debug] [Thread-1 (]: Began executing node model.dbt_idx.fact_orders
[0m19:28:02.708270 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_idx.fact_orders"
[0m19:28:02.715255 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.fact_orders"
[0m19:28:02.716232 [debug] [Thread-1 (]: On model.dbt_idx.fact_orders: BEGIN
[0m19:28:02.716232 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:28:02.738833 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m19:28:02.739791 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.fact_orders"
[0m19:28:02.740822 [debug] [Thread-1 (]: On model.dbt_idx.fact_orders: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.fact_orders"} */

  
    

  create  table "IDX-Stock"."IDX-Schema"."fact_orders__dbt_tmp"
  
  
    as
  
  (
    with orders as (
    select *
    from "IDX-Stock"."IDX-Schema"."stg_eltool__orders"
)
select * from orders
  );
  
[0m19:28:02.747798 [debug] [Thread-1 (]: SQL status: SELECT 999 in 0.0 seconds
[0m19:28:02.752796 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.fact_orders"
[0m19:28:02.753794 [debug] [Thread-1 (]: On model.dbt_idx.fact_orders: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.fact_orders"} */
alter table "IDX-Stock"."IDX-Schema"."fact_orders" rename to "fact_orders__dbt_backup"
[0m19:28:02.756790 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:28:02.763453 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.fact_orders"
[0m19:28:02.763453 [debug] [Thread-1 (]: On model.dbt_idx.fact_orders: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.fact_orders"} */
alter table "IDX-Stock"."IDX-Schema"."fact_orders__dbt_tmp" rename to "fact_orders"
[0m19:28:02.766313 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:28:02.772324 [debug] [Thread-1 (]: On model.dbt_idx.fact_orders: COMMIT
[0m19:28:02.773325 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.fact_orders"
[0m19:28:02.774329 [debug] [Thread-1 (]: On model.dbt_idx.fact_orders: COMMIT
[0m19:28:02.778325 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m19:28:02.784361 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.fact_orders"
[0m19:28:02.784361 [debug] [Thread-1 (]: On model.dbt_idx.fact_orders: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.fact_orders"} */
drop table if exists "IDX-Stock"."IDX-Schema"."fact_orders__dbt_backup" cascade
[0m19:28:02.789254 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m19:28:02.791254 [debug] [Thread-1 (]: Timing info for model.dbt_idx.fact_orders (execute): 19:28:02.671708 => 19:28:02.791254
[0m19:28:02.792254 [debug] [Thread-1 (]: On model.dbt_idx.fact_orders: Close
[0m19:28:02.793285 [info ] [Thread-1 (]: 7 of 11 OK created sql table model IDX-Schema.fact_orders ...................... [[32mSELECT 999[0m in 0.14s]
[0m19:28:02.795279 [debug] [Thread-1 (]: Finished running node model.dbt_idx.fact_orders
[0m19:28:02.796289 [debug] [Thread-1 (]: Began running node model.dbt_idx.dim_customers
[0m19:28:02.797257 [info ] [Thread-1 (]: 8 of 11 START sql table model IDX-Schema.dim_customers ......................... [RUN]
[0m19:28:02.799259 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_idx.fact_orders, now model.dbt_idx.dim_customers)
[0m19:28:02.800272 [debug] [Thread-1 (]: Began compiling node model.dbt_idx.dim_customers
[0m19:28:02.803309 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_idx.dim_customers"
[0m19:28:02.809264 [debug] [Thread-1 (]: Timing info for model.dbt_idx.dim_customers (compile): 19:28:02.800272 => 19:28:02.809264
[0m19:28:02.810262 [debug] [Thread-1 (]: Began executing node model.dbt_idx.dim_customers
[0m19:28:02.816299 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_idx.dim_customers"
[0m19:28:02.822445 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.dim_customers"
[0m19:28:02.822445 [debug] [Thread-1 (]: On model.dbt_idx.dim_customers: BEGIN
[0m19:28:02.823446 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:28:02.848603 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m19:28:02.849643 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.dim_customers"
[0m19:28:02.849643 [debug] [Thread-1 (]: On model.dbt_idx.dim_customers: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.dim_customers"} */

  
    

  create  table "IDX-Stock"."IDX-Schema"."dim_customers__dbt_tmp"
  
  
    as
  
  (
    -- noinspection SqlDialectInspectionForFile

with customers as (
    select *
    from "IDX-Stock"."IDX-Schema"."stg_eltool__customers_snapshots"
    ),
     state as (
         select *
         from "IDX-Stock"."IDX-Schema"."stg_eltool__state"
     )
select c.customer_id,
       c.zipcode,
       c.city,
       c.state_code,
       s.state_name,
       c.datetime_created,
       c.datetime_updated,
       c.dbt_valid_from::TIMESTAMP as valid_from,
        CASE WHEN c.dbt_valid_to IS NULL
            THEN '9999-12-31'::TIMESTAMP
            ELSE c.dbt_valid_to::TIMESTAMP
        END as valid_to
from customers c
    join state s on c.state_code = s.state_code
  );
  
[0m19:28:02.854605 [debug] [Thread-1 (]: SQL status: SELECT 100 in 0.0 seconds
[0m19:28:02.858640 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.dim_customers"
[0m19:28:02.859604 [debug] [Thread-1 (]: On model.dbt_idx.dim_customers: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.dim_customers"} */
alter table "IDX-Stock"."IDX-Schema"."dim_customers" rename to "dim_customers__dbt_backup"
[0m19:28:02.861605 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:28:02.907683 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.dim_customers"
[0m19:28:02.908653 [debug] [Thread-1 (]: On model.dbt_idx.dim_customers: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.dim_customers"} */
alter table "IDX-Stock"."IDX-Schema"."dim_customers__dbt_tmp" rename to "dim_customers"
[0m19:28:02.910550 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:28:02.913564 [debug] [Thread-1 (]: On model.dbt_idx.dim_customers: COMMIT
[0m19:28:02.914598 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.dim_customers"
[0m19:28:02.915599 [debug] [Thread-1 (]: On model.dbt_idx.dim_customers: COMMIT
[0m19:28:02.918562 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m19:28:02.921150 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.dim_customers"
[0m19:28:02.922147 [debug] [Thread-1 (]: On model.dbt_idx.dim_customers: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.dim_customers"} */
drop table if exists "IDX-Stock"."IDX-Schema"."dim_customers__dbt_backup" cascade
[0m19:28:02.925145 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m19:28:02.927172 [debug] [Thread-1 (]: Timing info for model.dbt_idx.dim_customers (execute): 19:28:02.811263 => 19:28:02.927172
[0m19:28:02.928178 [debug] [Thread-1 (]: On model.dbt_idx.dim_customers: Close
[0m19:28:02.930163 [info ] [Thread-1 (]: 8 of 11 OK created sql table model IDX-Schema.dim_customers .................... [[32mSELECT 100[0m in 0.13s]
[0m19:28:02.932148 [debug] [Thread-1 (]: Finished running node model.dbt_idx.dim_customers
[0m19:28:02.933172 [debug] [Thread-1 (]: Began running node model.dbt_idx.fact_stocks
[0m19:28:02.934147 [info ] [Thread-1 (]: 9 of 11 START sql table model IDX-Schema.fact_stocks ........................... [RUN]
[0m19:28:02.935161 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_idx.dim_customers, now model.dbt_idx.fact_stocks)
[0m19:28:02.936146 [debug] [Thread-1 (]: Began compiling node model.dbt_idx.fact_stocks
[0m19:28:02.938171 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_idx.fact_stocks"
[0m19:28:02.944171 [debug] [Thread-1 (]: Timing info for model.dbt_idx.fact_stocks (compile): 19:28:02.936146 => 19:28:02.944171
[0m19:28:02.945171 [debug] [Thread-1 (]: Began executing node model.dbt_idx.fact_stocks
[0m19:28:02.950172 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_idx.fact_stocks"
[0m19:28:02.957149 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.fact_stocks"
[0m19:28:02.958151 [debug] [Thread-1 (]: On model.dbt_idx.fact_stocks: BEGIN
[0m19:28:02.958151 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:28:02.978550 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m19:28:02.978550 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.fact_stocks"
[0m19:28:02.979586 [debug] [Thread-1 (]: On model.dbt_idx.fact_stocks: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.fact_stocks"} */

  
    

  create  table "IDX-Stock"."IDX-Schema"."fact_stocks__dbt_tmp"
  
  
    as
  
  (
    -- noinspection SqlDialectInspectionForFile

with stock as (
    select *
    from "IDX-Stock"."IDX-Schema"."stg_eltool__stock"
    ),
     company as (
         select *
         from "IDX-Stock"."IDX-Schema"."stg_eltool__company"
     )
select a.id,
       a.ticker,
       b.name,
       a.date,
       a.open,
       a.high,
       a.low,
       a.close,
       a.volume,
       b.logo
from stock a
    join company b on a.ticker = b.ticker
  );
  
[0m19:28:03.019716 [debug] [Thread-1 (]: SQL status: SELECT 26131 in 0.0 seconds
[0m19:28:03.023933 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.fact_stocks"
[0m19:28:03.023933 [debug] [Thread-1 (]: On model.dbt_idx.fact_stocks: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.fact_stocks"} */
alter table "IDX-Stock"."IDX-Schema"."fact_stocks" rename to "fact_stocks__dbt_backup"
[0m19:28:03.026937 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:28:03.029962 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.fact_stocks"
[0m19:28:03.030961 [debug] [Thread-1 (]: On model.dbt_idx.fact_stocks: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.fact_stocks"} */
alter table "IDX-Stock"."IDX-Schema"."fact_stocks__dbt_tmp" rename to "fact_stocks"
[0m19:28:03.033731 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:28:03.035725 [debug] [Thread-1 (]: On model.dbt_idx.fact_stocks: COMMIT
[0m19:28:03.036712 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.fact_stocks"
[0m19:28:03.036712 [debug] [Thread-1 (]: On model.dbt_idx.fact_stocks: COMMIT
[0m19:28:03.047690 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m19:28:03.051715 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.fact_stocks"
[0m19:28:03.051715 [debug] [Thread-1 (]: On model.dbt_idx.fact_stocks: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.fact_stocks"} */
drop table if exists "IDX-Stock"."IDX-Schema"."fact_stocks__dbt_backup" cascade
[0m19:28:03.057330 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m19:28:03.059366 [debug] [Thread-1 (]: Timing info for model.dbt_idx.fact_stocks (execute): 19:28:02.946148 => 19:28:03.059366
[0m19:28:03.060340 [debug] [Thread-1 (]: On model.dbt_idx.fact_stocks: Close
[0m19:28:03.063336 [info ] [Thread-1 (]: 9 of 11 OK created sql table model IDX-Schema.fact_stocks ...................... [[32mSELECT 26131[0m in 0.13s]
[0m19:28:03.065336 [debug] [Thread-1 (]: Finished running node model.dbt_idx.fact_stocks
[0m19:28:03.066335 [debug] [Thread-1 (]: Began running node model.dbt_idx.customer_orders_status
[0m19:28:03.067348 [info ] [Thread-1 (]: 10 of 11 START sql view model IDX-Schema.customer_orders_status ................ [RUN]
[0m19:28:03.068331 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_idx.fact_stocks, now model.dbt_idx.customer_orders_status)
[0m19:28:03.069349 [debug] [Thread-1 (]: Began compiling node model.dbt_idx.customer_orders_status
[0m19:28:03.073365 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_idx.customer_orders_status"
[0m19:28:03.080346 [debug] [Thread-1 (]: Timing info for model.dbt_idx.customer_orders_status (compile): 19:28:03.069349 => 19:28:03.079329
[0m19:28:03.081332 [debug] [Thread-1 (]: Began executing node model.dbt_idx.customer_orders_status
[0m19:28:03.088334 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_idx.customer_orders_status"
[0m19:28:03.094354 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.customer_orders_status"
[0m19:28:03.095357 [debug] [Thread-1 (]: On model.dbt_idx.customer_orders_status: BEGIN
[0m19:28:03.096343 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:28:03.118363 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m19:28:03.119903 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.customer_orders_status"
[0m19:28:03.119903 [debug] [Thread-1 (]: On model.dbt_idx.customer_orders_status: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.customer_orders_status"} */

  create view "IDX-Stock"."IDX-Schema"."customer_orders_status__dbt_tmp"
    
    
  as (
    with orders as (select *
                from "IDX-Stock"."IDX-Schema"."fact_orders"),
     customers as (select *
                   from "IDX-Stock"."IDX-Schema"."dim_customers")
select o.order_id,
       o.customer_id,
       o.order_status,
       o.order_purchase_timestamp,
       o.order_approved_at,
       o.order_delivered_carrier_date,
       o.order_delivered_customer_date,
       o.order_estimated_delivery_date,
       c.zipcode    as customer_zipcode,
       c.city       as customer_city,
       c.state_code as customer_state_code,
       c.state_name as customer_state_name
from orders o
    join customers c on o.customer_id = c.customer_id
    and o.order_purchase_timestamp >= c.valid_from
    and o.order_purchase_timestamp <= c.valid_to
  );
[0m19:28:03.123913 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m19:28:03.127944 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.customer_orders_status"
[0m19:28:03.127944 [debug] [Thread-1 (]: On model.dbt_idx.customer_orders_status: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.customer_orders_status"} */
alter table "IDX-Stock"."IDX-Schema"."customer_orders_status__dbt_tmp" rename to "customer_orders_status"
[0m19:28:03.130935 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:28:03.133911 [debug] [Thread-1 (]: On model.dbt_idx.customer_orders_status: COMMIT
[0m19:28:03.133911 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.customer_orders_status"
[0m19:28:03.134947 [debug] [Thread-1 (]: On model.dbt_idx.customer_orders_status: COMMIT
[0m19:28:03.138016 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m19:28:03.142024 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.customer_orders_status"
[0m19:28:03.143037 [debug] [Thread-1 (]: On model.dbt_idx.customer_orders_status: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.customer_orders_status"} */
drop view if exists "IDX-Stock"."IDX-Schema"."customer_orders_status__dbt_backup" cascade
[0m19:28:03.145019 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m19:28:03.147043 [debug] [Thread-1 (]: Timing info for model.dbt_idx.customer_orders_status (execute): 19:28:03.082337 => 19:28:03.147043
[0m19:28:03.147043 [debug] [Thread-1 (]: On model.dbt_idx.customer_orders_status: Close
[0m19:28:03.150019 [info ] [Thread-1 (]: 10 of 11 OK created sql view model IDX-Schema.customer_orders_status ........... [[32mCREATE VIEW[0m in 0.08s]
[0m19:28:03.152017 [debug] [Thread-1 (]: Finished running node model.dbt_idx.customer_orders_status
[0m19:28:03.153023 [debug] [Thread-1 (]: Began running node model.dbt_idx.stock_update_status
[0m19:28:03.154015 [info ] [Thread-1 (]: 11 of 11 START sql view model IDX-Schema.stock_update_status ................... [RUN]
[0m19:28:03.156014 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_idx.customer_orders_status, now model.dbt_idx.stock_update_status)
[0m19:28:03.157016 [debug] [Thread-1 (]: Began compiling node model.dbt_idx.stock_update_status
[0m19:28:03.161020 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_idx.stock_update_status"
[0m19:28:03.168017 [debug] [Thread-1 (]: Timing info for model.dbt_idx.stock_update_status (compile): 19:28:03.157016 => 19:28:03.167037
[0m19:28:03.169015 [debug] [Thread-1 (]: Began executing node model.dbt_idx.stock_update_status
[0m19:28:03.178045 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_idx.stock_update_status"
[0m19:28:03.184015 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stock_update_status"
[0m19:28:03.186020 [debug] [Thread-1 (]: On model.dbt_idx.stock_update_status: BEGIN
[0m19:28:03.187040 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:28:03.209035 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m19:28:03.210062 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stock_update_status"
[0m19:28:03.211079 [debug] [Thread-1 (]: On model.dbt_idx.stock_update_status: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stock_update_status"} */

  create view "IDX-Stock"."IDX-Schema"."stock_update_status__dbt_tmp"
    
    
  as (
    with stock as (select *
               from "IDX-Stock"."IDX-Schema"."fact_stocks")
select a.id,
       a.ticker,
       b.name,
       a.date,
       a.open,
       a.high,
       a.low,
       a.close,
       a.volume,
       rank() over (order by a.date desc) as rank,
       b.logo
from stock a
  );
[0m19:28:03.214032 [debug] [Thread-1 (]: Postgres adapter: Postgres error: missing FROM-clause entry for table "b"
LINE 11:        b.name,
                ^

[0m19:28:03.215050 [debug] [Thread-1 (]: On model.dbt_idx.stock_update_status: ROLLBACK
[0m19:28:03.218058 [debug] [Thread-1 (]: Timing info for model.dbt_idx.stock_update_status (execute): 19:28:03.169015 => 19:28:03.217028
[0m19:28:03.218058 [debug] [Thread-1 (]: On model.dbt_idx.stock_update_status: Close
[0m19:28:03.235690 [debug] [Thread-1 (]: Database Error in model stock_update_status (models\marts\stock\stock_update_status.sql)
  missing FROM-clause entry for table "b"
  LINE 11:        b.name,
                  ^
  compiled Code at target\run\dbt_idx\models\marts\stock\stock_update_status.sql
[0m19:28:03.236664 [error] [Thread-1 (]: 11 of 11 ERROR creating sql view model IDX-Schema.stock_update_status .......... [[31mERROR[0m in 0.08s]
[0m19:28:03.237688 [debug] [Thread-1 (]: Finished running node model.dbt_idx.stock_update_status
[0m19:28:03.240663 [debug] [MainThread]: Using postgres connection "master"
[0m19:28:03.242664 [debug] [MainThread]: On master: BEGIN
[0m19:28:03.243662 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m19:28:03.270107 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m19:28:03.271107 [debug] [MainThread]: On master: COMMIT
[0m19:28:03.272163 [debug] [MainThread]: Using postgres connection "master"
[0m19:28:03.273122 [debug] [MainThread]: On master: COMMIT
[0m19:28:03.275123 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m19:28:03.276107 [debug] [MainThread]: On master: Close
[0m19:28:03.277655 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:28:03.278671 [debug] [MainThread]: Connection 'list_IDX-Stock' was properly closed.
[0m19:28:03.279679 [debug] [MainThread]: Connection 'list_IDX-Stock_IDX-Schema' was properly closed.
[0m19:28:03.281667 [debug] [MainThread]: Connection 'model.dbt_idx.stock_update_status' was properly closed.
[0m19:28:03.281667 [info ] [MainThread]: 
[0m19:28:03.283667 [info ] [MainThread]: Finished running 8 view models, 3 table models in 0 hours 0 minutes and 1.52 seconds (1.52s).
[0m19:28:03.285993 [debug] [MainThread]: Command end result
[0m19:28:03.313375 [info ] [MainThread]: 
[0m19:28:03.314344 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m19:28:03.316871 [info ] [MainThread]: 
[0m19:28:03.317855 [error] [MainThread]: [33mDatabase Error in model stock_update_status (models\marts\stock\stock_update_status.sql)[0m
[0m19:28:03.318898 [error] [MainThread]:   missing FROM-clause entry for table "b"
[0m19:28:03.320416 [error] [MainThread]:   LINE 11:        b.name,
[0m19:28:03.321426 [error] [MainThread]:                   ^
[0m19:28:03.322425 [error] [MainThread]:   compiled Code at target\run\dbt_idx\models\marts\stock\stock_update_status.sql
[0m19:28:03.323428 [info ] [MainThread]: 
[0m19:28:03.324426 [info ] [MainThread]: Done. PASS=10 WARN=0 ERROR=1 SKIP=0 TOTAL=11
[0m19:28:03.326432 [debug] [MainThread]: Command `dbt run` failed at 19:28:03.326432 after 2.13 seconds
[0m19:28:03.327452 [debug] [MainThread]: Flushing usage events


============================== 19:28:18.682905 | 1457ebba-d7aa-42ca-8b82-4daf6f3f997c ==============================
[0m19:28:18.682905 [info ] [MainThread]: Running with dbt=1.6.1
[0m19:28:18.690895 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': 'D:\\00 Project\\00 My Project\\IdeaProjects\\Py-DBT-IDX\\logs', 'fail_fast': 'False', 'profiles_dir': 'D:\\00 Project\\00 My Project\\IdeaProjects\\Py-DBT-IDX', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'False'}
[0m19:28:18.854292 [info ] [MainThread]: Registered adapter: postgres=1.6.1
[0m19:28:18.865287 [debug] [MainThread]: checksum: efe19d9f5b93d1a98cc804fbfcdb6b3aced98b974af664946fee1cde8837deb7, vars: {}, profile: , target: , version: 1.6.1
[0m19:28:19.032780 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m19:28:19.033780 [debug] [MainThread]: Partial parsing: updated file: dbt_idx://models\marts\stock\stock_update_status.sql
[0m19:28:19.162493 [info ] [MainThread]: Found 11 models, 1 snapshot, 18 tests, 5 sources, 0 exposures, 0 metrics, 349 macros, 0 groups, 0 semantic models
[0m19:28:19.165485 [info ] [MainThread]: 
[0m19:28:19.167445 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m19:28:19.170303 [debug] [ThreadPool]: Acquiring new postgres connection 'list_IDX-Stock'
[0m19:28:19.180035 [debug] [ThreadPool]: Using postgres connection "list_IDX-Stock"
[0m19:28:19.181048 [debug] [ThreadPool]: On list_IDX-Stock: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "connection_name": "list_IDX-Stock"} */

    select distinct nspname from pg_namespace
  
[0m19:28:19.182035 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:28:19.218034 [debug] [ThreadPool]: SQL status: SELECT 12 in 0.0 seconds
[0m19:28:19.219035 [debug] [ThreadPool]: On list_IDX-Stock: Close
[0m19:28:19.224069 [debug] [ThreadPool]: Acquiring new postgres connection 'list_IDX-Stock_snapshots'
[0m19:28:19.231098 [debug] [ThreadPool]: Using postgres connection "list_IDX-Stock_snapshots"
[0m19:28:19.232059 [debug] [ThreadPool]: On list_IDX-Stock_snapshots: BEGIN
[0m19:28:19.233124 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:28:19.254407 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m19:28:19.255404 [debug] [ThreadPool]: Using postgres connection "list_IDX-Stock_snapshots"
[0m19:28:19.256405 [debug] [ThreadPool]: On list_IDX-Stock_snapshots: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "connection_name": "list_IDX-Stock_snapshots"} */
select
      'IDX-Stock' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'snapshots'
    union all
    select
      'IDX-Stock' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'snapshots'
    union all
    select
      'IDX-Stock' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'snapshots'
  
[0m19:28:19.262404 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.0 seconds
[0m19:28:19.264948 [debug] [ThreadPool]: On list_IDX-Stock_snapshots: ROLLBACK
[0m19:28:19.267987 [debug] [ThreadPool]: On list_IDX-Stock_snapshots: Close
[0m19:28:19.270984 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_IDX-Stock_snapshots, now list_IDX-Stock_IDX-Schema)
[0m19:28:19.274980 [debug] [ThreadPool]: Using postgres connection "list_IDX-Stock_IDX-Schema"
[0m19:28:19.275985 [debug] [ThreadPool]: On list_IDX-Stock_IDX-Schema: BEGIN
[0m19:28:19.276978 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:28:19.300520 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m19:28:19.301516 [debug] [ThreadPool]: Using postgres connection "list_IDX-Stock_IDX-Schema"
[0m19:28:19.302515 [debug] [ThreadPool]: On list_IDX-Stock_IDX-Schema: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "connection_name": "list_IDX-Stock_IDX-Schema"} */
select
      'IDX-Stock' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'IDX-Schema'
    union all
    select
      'IDX-Stock' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'IDX-Schema'
    union all
    select
      'IDX-Stock' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'IDX-Schema'
  
[0m19:28:19.307516 [debug] [ThreadPool]: SQL status: SELECT 16 in 0.0 seconds
[0m19:28:19.308516 [debug] [ThreadPool]: On list_IDX-Stock_IDX-Schema: ROLLBACK
[0m19:28:19.310517 [debug] [ThreadPool]: On list_IDX-Stock_IDX-Schema: Close
[0m19:28:19.320261 [debug] [MainThread]: Using postgres connection "master"
[0m19:28:19.321227 [debug] [MainThread]: On master: BEGIN
[0m19:28:19.322287 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:28:19.343493 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m19:28:19.345460 [debug] [MainThread]: Using postgres connection "master"
[0m19:28:19.346460 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m19:28:19.360136 [debug] [MainThread]: SQL status: SELECT 8 in 0.0 seconds
[0m19:28:19.364137 [debug] [MainThread]: On master: ROLLBACK
[0m19:28:19.367294 [debug] [MainThread]: Using postgres connection "master"
[0m19:28:19.368323 [debug] [MainThread]: On master: BEGIN
[0m19:28:19.372337 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m19:28:19.373331 [debug] [MainThread]: On master: COMMIT
[0m19:28:19.373331 [debug] [MainThread]: Using postgres connection "master"
[0m19:28:19.374357 [debug] [MainThread]: On master: COMMIT
[0m19:28:19.376346 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m19:28:19.377329 [debug] [MainThread]: On master: Close
[0m19:28:19.378330 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m19:28:19.380343 [info ] [MainThread]: 
[0m19:28:19.385329 [debug] [Thread-1 (]: Began running node model.dbt_idx.stg_eltool__company
[0m19:28:19.386372 [info ] [Thread-1 (]: 1 of 11 START sql view model IDX-Schema.stg_eltool__company .................... [RUN]
[0m19:28:19.388365 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.dbt_idx.stg_eltool__company'
[0m19:28:19.388365 [debug] [Thread-1 (]: Began compiling node model.dbt_idx.stg_eltool__company
[0m19:28:19.399335 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_idx.stg_eltool__company"
[0m19:28:19.406349 [debug] [Thread-1 (]: Timing info for model.dbt_idx.stg_eltool__company (compile): 19:28:19.389364 => 19:28:19.406349
[0m19:28:19.407368 [debug] [Thread-1 (]: Began executing node model.dbt_idx.stg_eltool__company
[0m19:28:19.448909 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_idx.stg_eltool__company"
[0m19:28:19.455890 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__company"
[0m19:28:19.456876 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__company: BEGIN
[0m19:28:19.457876 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m19:28:19.479879 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m19:28:19.480942 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__company"
[0m19:28:19.481878 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__company: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__company"} */

  create view "IDX-Stock"."IDX-Schema"."stg_eltool__company__dbt_tmp"
    
    
  as (
    with source as (select *
                from "IDX-Stock"."IDX-Schema"."ksql-company-stream"),
     renamed as (select id,
                        ticker,
                        name,
                        logo
                 from source)
select *
from renamed
  );
[0m19:28:19.484878 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m19:28:19.491908 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__company"
[0m19:28:19.493880 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__company: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__company"} */
alter table "IDX-Stock"."IDX-Schema"."stg_eltool__company" rename to "stg_eltool__company__dbt_backup"
[0m19:28:19.496539 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:28:19.499550 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__company"
[0m19:28:19.500549 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__company: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__company"} */
alter table "IDX-Stock"."IDX-Schema"."stg_eltool__company__dbt_tmp" rename to "stg_eltool__company"
[0m19:28:19.502978 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:28:19.519976 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__company: COMMIT
[0m19:28:19.519976 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__company"
[0m19:28:19.520976 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__company: COMMIT
[0m19:28:19.524988 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m19:28:19.532987 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__company"
[0m19:28:19.533987 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__company: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__company"} */
drop view if exists "IDX-Stock"."IDX-Schema"."stg_eltool__company__dbt_backup" cascade
[0m19:28:19.537986 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m19:28:19.540214 [debug] [Thread-1 (]: Timing info for model.dbt_idx.stg_eltool__company (execute): 19:28:19.407368 => 19:28:19.540214
[0m19:28:19.541214 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__company: Close
[0m19:28:19.542219 [info ] [Thread-1 (]: 1 of 11 OK created sql view model IDX-Schema.stg_eltool__company ............... [[32mCREATE VIEW[0m in 0.15s]
[0m19:28:19.544218 [debug] [Thread-1 (]: Finished running node model.dbt_idx.stg_eltool__company
[0m19:28:19.545218 [debug] [Thread-1 (]: Began running node model.dbt_idx.stg_eltool__customers
[0m19:28:19.546218 [info ] [Thread-1 (]: 2 of 11 START sql view model IDX-Schema.stg_eltool__customers .................. [RUN]
[0m19:28:19.548214 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_idx.stg_eltool__company, now model.dbt_idx.stg_eltool__customers)
[0m19:28:19.548214 [debug] [Thread-1 (]: Began compiling node model.dbt_idx.stg_eltool__customers
[0m19:28:19.552215 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_idx.stg_eltool__customers"
[0m19:28:19.559239 [debug] [Thread-1 (]: Timing info for model.dbt_idx.stg_eltool__customers (compile): 19:28:19.549213 => 19:28:19.559239
[0m19:28:19.560213 [debug] [Thread-1 (]: Began executing node model.dbt_idx.stg_eltool__customers
[0m19:28:19.566212 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_idx.stg_eltool__customers"
[0m19:28:19.573213 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__customers"
[0m19:28:19.573213 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__customers: BEGIN
[0m19:28:19.574212 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:28:19.595889 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m19:28:19.596902 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__customers"
[0m19:28:19.597889 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__customers: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__customers"} */

  create view "IDX-Stock"."IDX-Schema"."stg_eltool__customers__dbt_tmp"
    
    
  as (
    with source as (select *
                from "IDX-Stock"."IDX-Schema"."customers"),
     renamed as (select
                     customer_id,
                    'This is Dummy' as dummy
                 from source
                 where customer_id = 1234567890)
select *
from renamed
  );
[0m19:28:19.600936 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m19:28:19.604925 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__customers"
[0m19:28:19.605913 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__customers: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__customers"} */
alter table "IDX-Stock"."IDX-Schema"."stg_eltool__customers" rename to "stg_eltool__customers__dbt_backup"
[0m19:28:19.607890 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:28:19.611928 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__customers"
[0m19:28:19.612926 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__customers: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__customers"} */
alter table "IDX-Stock"."IDX-Schema"."stg_eltool__customers__dbt_tmp" rename to "stg_eltool__customers"
[0m19:28:19.615893 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:28:19.617927 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__customers: COMMIT
[0m19:28:19.618923 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__customers"
[0m19:28:19.619921 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__customers: COMMIT
[0m19:28:19.622945 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m19:28:19.625964 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__customers"
[0m19:28:19.626967 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__customers: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__customers"} */
drop view if exists "IDX-Stock"."IDX-Schema"."stg_eltool__customers__dbt_backup" cascade
[0m19:28:19.630934 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m19:28:19.632965 [debug] [Thread-1 (]: Timing info for model.dbt_idx.stg_eltool__customers (execute): 19:28:19.560213 => 19:28:19.632965
[0m19:28:19.633966 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__customers: Close
[0m19:28:19.635939 [info ] [Thread-1 (]: 2 of 11 OK created sql view model IDX-Schema.stg_eltool__customers ............. [[32mCREATE VIEW[0m in 0.09s]
[0m19:28:19.637936 [debug] [Thread-1 (]: Finished running node model.dbt_idx.stg_eltool__customers
[0m19:28:19.638929 [debug] [Thread-1 (]: Began running node model.dbt_idx.stg_eltool__customers_snapshots
[0m19:28:19.640150 [info ] [Thread-1 (]: 3 of 11 START sql view model IDX-Schema.stg_eltool__customers_snapshots ........ [RUN]
[0m19:28:19.641160 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_idx.stg_eltool__customers, now model.dbt_idx.stg_eltool__customers_snapshots)
[0m19:28:19.642191 [debug] [Thread-1 (]: Began compiling node model.dbt_idx.stg_eltool__customers_snapshots
[0m19:28:19.645183 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_idx.stg_eltool__customers_snapshots"
[0m19:28:19.654191 [debug] [Thread-1 (]: Timing info for model.dbt_idx.stg_eltool__customers_snapshots (compile): 19:28:19.643187 => 19:28:19.653152
[0m19:28:19.655172 [debug] [Thread-1 (]: Began executing node model.dbt_idx.stg_eltool__customers_snapshots
[0m19:28:19.663153 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_idx.stg_eltool__customers_snapshots"
[0m19:28:19.669151 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__customers_snapshots"
[0m19:28:19.670154 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__customers_snapshots: BEGIN
[0m19:28:19.671167 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:28:19.695888 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m19:28:19.695888 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__customers_snapshots"
[0m19:28:19.696926 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__customers_snapshots: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__customers_snapshots"} */

  create view "IDX-Stock"."IDX-Schema"."stg_eltool__customers_snapshots__dbt_tmp"
    
    
  as (
    with source as (select *
                from "IDX-Stock"."snapshots"."customers_snapshot"),
     renamed as (select customer_id,
                        zipcode,
                        city,
                        state_code,
                        datetime_created::TIMESTAMP AS datetime_created,
                        datetime_updated::TIMESTAMP AS datetime_updated,
                        dbt_valid_from,
                        dbt_valid_to
                 from source)
select *
from renamed
  );
[0m19:28:19.701894 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m19:28:19.705924 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__customers_snapshots"
[0m19:28:19.706943 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__customers_snapshots: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__customers_snapshots"} */
alter table "IDX-Stock"."IDX-Schema"."stg_eltool__customers_snapshots" rename to "stg_eltool__customers_snapshots__dbt_backup"
[0m19:28:19.709892 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:28:19.713937 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__customers_snapshots"
[0m19:28:19.714923 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__customers_snapshots: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__customers_snapshots"} */
alter table "IDX-Stock"."IDX-Schema"."stg_eltool__customers_snapshots__dbt_tmp" rename to "stg_eltool__customers_snapshots"
[0m19:28:19.717893 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:28:19.720917 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__customers_snapshots: COMMIT
[0m19:28:19.721908 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__customers_snapshots"
[0m19:28:19.722892 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__customers_snapshots: COMMIT
[0m19:28:19.727904 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m19:28:19.733915 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__customers_snapshots"
[0m19:28:19.734937 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__customers_snapshots: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__customers_snapshots"} */
drop view if exists "IDX-Stock"."IDX-Schema"."stg_eltool__customers_snapshots__dbt_backup" cascade
[0m19:28:19.739429 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m19:28:19.742438 [debug] [Thread-1 (]: Timing info for model.dbt_idx.stg_eltool__customers_snapshots (execute): 19:28:19.655172 => 19:28:19.741472
[0m19:28:19.743437 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__customers_snapshots: Close
[0m19:28:19.745443 [info ] [Thread-1 (]: 3 of 11 OK created sql view model IDX-Schema.stg_eltool__customers_snapshots ... [[32mCREATE VIEW[0m in 0.10s]
[0m19:28:19.746443 [debug] [Thread-1 (]: Finished running node model.dbt_idx.stg_eltool__customers_snapshots
[0m19:28:19.748441 [debug] [Thread-1 (]: Began running node model.dbt_idx.stg_eltool__orders
[0m19:28:19.749458 [info ] [Thread-1 (]: 4 of 11 START sql view model IDX-Schema.stg_eltool__orders ..................... [RUN]
[0m19:28:19.751440 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_idx.stg_eltool__customers_snapshots, now model.dbt_idx.stg_eltool__orders)
[0m19:28:19.751440 [debug] [Thread-1 (]: Began compiling node model.dbt_idx.stg_eltool__orders
[0m19:28:19.757139 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_idx.stg_eltool__orders"
[0m19:28:19.770686 [debug] [Thread-1 (]: Timing info for model.dbt_idx.stg_eltool__orders (compile): 19:28:19.752471 => 19:28:19.770686
[0m19:28:19.771683 [debug] [Thread-1 (]: Began executing node model.dbt_idx.stg_eltool__orders
[0m19:28:19.776713 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_idx.stg_eltool__orders"
[0m19:28:19.788722 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__orders"
[0m19:28:19.789735 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__orders: BEGIN
[0m19:28:19.790730 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:28:19.811696 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m19:28:19.812678 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__orders"
[0m19:28:19.813732 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__orders: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__orders"} */

  create view "IDX-Stock"."IDX-Schema"."stg_eltool__orders__dbt_tmp"
    
    
  as (
    with source as (select *
                from "IDX-Stock"."IDX-Schema"."orders"),
     renamed as (select order_id,
                        cust_id AS customer_id,
                        order_status,
                        order_purchase_timestamp::TIMESTAMP,
                        order_approved_at::TIMESTAMP,
                        order_delivered_carrier_date::TIMESTAMP,
                        order_delivered_customer_date::TIMESTAMP,
                        order_estimated_delivery_date::TIMESTAMP
                 from source)
select *
from renamed
  );
[0m19:28:19.817687 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m19:28:19.823724 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__orders"
[0m19:28:19.824734 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__orders: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__orders"} */
alter table "IDX-Stock"."IDX-Schema"."stg_eltool__orders" rename to "stg_eltool__orders__dbt_backup"
[0m19:28:19.826734 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:28:19.830734 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__orders"
[0m19:28:19.832731 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__orders: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__orders"} */
alter table "IDX-Stock"."IDX-Schema"."stg_eltool__orders__dbt_tmp" rename to "stg_eltool__orders"
[0m19:28:19.835788 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:28:19.837766 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__orders: COMMIT
[0m19:28:19.839329 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__orders"
[0m19:28:19.840353 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__orders: COMMIT
[0m19:28:19.843344 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m19:28:19.847370 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__orders"
[0m19:28:19.848370 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__orders: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__orders"} */
drop view if exists "IDX-Stock"."IDX-Schema"."stg_eltool__orders__dbt_backup" cascade
[0m19:28:19.851984 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m19:28:19.854018 [debug] [Thread-1 (]: Timing info for model.dbt_idx.stg_eltool__orders (execute): 19:28:19.772681 => 19:28:19.854018
[0m19:28:19.855019 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__orders: Close
[0m19:28:19.856988 [info ] [Thread-1 (]: 4 of 11 OK created sql view model IDX-Schema.stg_eltool__orders ................ [[32mCREATE VIEW[0m in 0.11s]
[0m19:28:19.857987 [debug] [Thread-1 (]: Finished running node model.dbt_idx.stg_eltool__orders
[0m19:28:19.859984 [debug] [Thread-1 (]: Began running node model.dbt_idx.stg_eltool__state
[0m19:28:19.861045 [info ] [Thread-1 (]: 5 of 11 START sql view model IDX-Schema.stg_eltool__state ...................... [RUN]
[0m19:28:19.861985 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_idx.stg_eltool__orders, now model.dbt_idx.stg_eltool__state)
[0m19:28:19.862988 [debug] [Thread-1 (]: Began compiling node model.dbt_idx.stg_eltool__state
[0m19:28:19.867989 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_idx.stg_eltool__state"
[0m19:28:19.874982 [debug] [Thread-1 (]: Timing info for model.dbt_idx.stg_eltool__state (compile): 19:28:19.863986 => 19:28:19.874982
[0m19:28:19.876034 [debug] [Thread-1 (]: Began executing node model.dbt_idx.stg_eltool__state
[0m19:28:19.882043 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_idx.stg_eltool__state"
[0m19:28:19.888983 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__state"
[0m19:28:19.888983 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__state: BEGIN
[0m19:28:19.890018 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:28:19.911969 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m19:28:19.912981 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__state"
[0m19:28:19.912981 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__state: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__state"} */

  create view "IDX-Stock"."IDX-Schema"."stg_eltool__state__dbt_tmp"
    
    
  as (
    with source as (select *
                from "IDX-Stock"."IDX-Schema"."state"),
     renamed as (select state_identifier::INT AS state_id,
                         state_code::VARCHAR(2) AS state_code,
                         st_name::VARCHAR(30) AS state_name
                 from source)
select *
from renamed
  );
[0m19:28:19.916015 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m19:28:19.920014 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__state"
[0m19:28:19.920014 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__state: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__state"} */
alter table "IDX-Stock"."IDX-Schema"."stg_eltool__state" rename to "stg_eltool__state__dbt_backup"
[0m19:28:19.922981 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:28:19.929016 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__state"
[0m19:28:19.930005 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__state: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__state"} */
alter table "IDX-Stock"."IDX-Schema"."stg_eltool__state__dbt_tmp" rename to "stg_eltool__state"
[0m19:28:19.933001 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:28:19.935998 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__state: COMMIT
[0m19:28:19.937001 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__state"
[0m19:28:19.937998 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__state: COMMIT
[0m19:28:19.941512 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m19:28:19.946513 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__state"
[0m19:28:19.947523 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__state: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__state"} */
drop view if exists "IDX-Stock"."IDX-Schema"."stg_eltool__state__dbt_backup" cascade
[0m19:28:19.950557 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m19:28:19.952600 [debug] [Thread-1 (]: Timing info for model.dbt_idx.stg_eltool__state (execute): 19:28:19.876987 => 19:28:19.952600
[0m19:28:19.953600 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__state: Close
[0m19:28:19.955571 [info ] [Thread-1 (]: 5 of 11 OK created sql view model IDX-Schema.stg_eltool__state ................. [[32mCREATE VIEW[0m in 0.09s]
[0m19:28:19.957594 [debug] [Thread-1 (]: Finished running node model.dbt_idx.stg_eltool__state
[0m19:28:19.958579 [debug] [Thread-1 (]: Began running node model.dbt_idx.stg_eltool__stock
[0m19:28:19.959565 [info ] [Thread-1 (]: 6 of 11 START sql view model IDX-Schema.stg_eltool__stock ...................... [RUN]
[0m19:28:19.960569 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_idx.stg_eltool__state, now model.dbt_idx.stg_eltool__stock)
[0m19:28:19.961602 [debug] [Thread-1 (]: Began compiling node model.dbt_idx.stg_eltool__stock
[0m19:28:19.964566 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_idx.stg_eltool__stock"
[0m19:28:19.970648 [debug] [Thread-1 (]: Timing info for model.dbt_idx.stg_eltool__stock (compile): 19:28:19.962565 => 19:28:19.969669
[0m19:28:19.971674 [debug] [Thread-1 (]: Began executing node model.dbt_idx.stg_eltool__stock
[0m19:28:19.976679 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_idx.stg_eltool__stock"
[0m19:28:19.982082 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__stock"
[0m19:28:19.983082 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__stock: BEGIN
[0m19:28:19.984059 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:28:20.006080 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m19:28:20.006080 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__stock"
[0m19:28:20.007046 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__stock: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__stock"} */

  create view "IDX-Stock"."IDX-Schema"."stg_eltool__stock__dbt_tmp"
    
    
  as (
    with source as (select *
                from "IDX-Stock"."IDX-Schema"."ksql-stock-stream"),
     renamed as (select *
                 from source)
select *
from renamed
  );
[0m19:28:20.010565 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m19:28:20.014611 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__stock"
[0m19:28:20.014611 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__stock: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__stock"} */
alter table "IDX-Stock"."IDX-Schema"."stg_eltool__stock" rename to "stg_eltool__stock__dbt_backup"
[0m19:28:20.017579 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:28:20.020612 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__stock"
[0m19:28:20.021612 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__stock: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__stock"} */
alter table "IDX-Stock"."IDX-Schema"."stg_eltool__stock__dbt_tmp" rename to "stg_eltool__stock"
[0m19:28:20.024589 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:28:20.026595 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__stock: COMMIT
[0m19:28:20.027598 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__stock"
[0m19:28:20.028600 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__stock: COMMIT
[0m19:28:20.031596 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m19:28:20.034622 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__stock"
[0m19:28:20.035624 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__stock: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__stock"} */
drop view if exists "IDX-Stock"."IDX-Schema"."stg_eltool__stock__dbt_backup" cascade
[0m19:28:20.039357 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m19:28:20.041393 [debug] [Thread-1 (]: Timing info for model.dbt_idx.stg_eltool__stock (execute): 19:28:19.971674 => 19:28:20.041393
[0m19:28:20.042400 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__stock: Close
[0m19:28:20.043405 [info ] [Thread-1 (]: 6 of 11 OK created sql view model IDX-Schema.stg_eltool__stock ................. [[32mCREATE VIEW[0m in 0.08s]
[0m19:28:20.045379 [debug] [Thread-1 (]: Finished running node model.dbt_idx.stg_eltool__stock
[0m19:28:20.047364 [debug] [Thread-1 (]: Began running node model.dbt_idx.fact_orders
[0m19:28:20.048364 [info ] [Thread-1 (]: 7 of 11 START sql table model IDX-Schema.fact_orders ........................... [RUN]
[0m19:28:20.049364 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_idx.stg_eltool__stock, now model.dbt_idx.fact_orders)
[0m19:28:20.050377 [debug] [Thread-1 (]: Began compiling node model.dbt_idx.fact_orders
[0m19:28:20.055397 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_idx.fact_orders"
[0m19:28:20.062380 [debug] [Thread-1 (]: Timing info for model.dbt_idx.fact_orders (compile): 19:28:20.050377 => 19:28:20.061393
[0m19:28:20.062380 [debug] [Thread-1 (]: Began executing node model.dbt_idx.fact_orders
[0m19:28:20.085366 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_idx.fact_orders"
[0m19:28:20.092112 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.fact_orders"
[0m19:28:20.093106 [debug] [Thread-1 (]: On model.dbt_idx.fact_orders: BEGIN
[0m19:28:20.094072 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:28:20.113435 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m19:28:20.114434 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.fact_orders"
[0m19:28:20.114434 [debug] [Thread-1 (]: On model.dbt_idx.fact_orders: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.fact_orders"} */

  
    

  create  table "IDX-Stock"."IDX-Schema"."fact_orders__dbt_tmp"
  
  
    as
  
  (
    with orders as (
    select *
    from "IDX-Stock"."IDX-Schema"."stg_eltool__orders"
)
select * from orders
  );
  
[0m19:28:20.120435 [debug] [Thread-1 (]: SQL status: SELECT 999 in 0.0 seconds
[0m19:28:20.123470 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.fact_orders"
[0m19:28:20.124471 [debug] [Thread-1 (]: On model.dbt_idx.fact_orders: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.fact_orders"} */
alter table "IDX-Stock"."IDX-Schema"."fact_orders" rename to "fact_orders__dbt_backup"
[0m19:28:20.126477 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:28:20.130512 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.fact_orders"
[0m19:28:20.131512 [debug] [Thread-1 (]: On model.dbt_idx.fact_orders: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.fact_orders"} */
alter table "IDX-Stock"."IDX-Schema"."fact_orders__dbt_tmp" rename to "fact_orders"
[0m19:28:20.133478 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:28:20.139512 [debug] [Thread-1 (]: On model.dbt_idx.fact_orders: COMMIT
[0m19:28:20.140055 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.fact_orders"
[0m19:28:20.141085 [debug] [Thread-1 (]: On model.dbt_idx.fact_orders: COMMIT
[0m19:28:20.144170 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m19:28:20.149149 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.fact_orders"
[0m19:28:20.150185 [debug] [Thread-1 (]: On model.dbt_idx.fact_orders: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.fact_orders"} */
drop table if exists "IDX-Stock"."IDX-Schema"."fact_orders__dbt_backup" cascade
[0m19:28:20.155196 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m19:28:20.156196 [debug] [Thread-1 (]: Timing info for model.dbt_idx.fact_orders (execute): 19:28:20.063394 => 19:28:20.156196
[0m19:28:20.157196 [debug] [Thread-1 (]: On model.dbt_idx.fact_orders: Close
[0m19:28:20.159208 [info ] [Thread-1 (]: 7 of 11 OK created sql table model IDX-Schema.fact_orders ...................... [[32mSELECT 999[0m in 0.11s]
[0m19:28:20.163197 [debug] [Thread-1 (]: Finished running node model.dbt_idx.fact_orders
[0m19:28:20.164196 [debug] [Thread-1 (]: Began running node model.dbt_idx.dim_customers
[0m19:28:20.165200 [info ] [Thread-1 (]: 8 of 11 START sql table model IDX-Schema.dim_customers ......................... [RUN]
[0m19:28:20.167196 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_idx.fact_orders, now model.dbt_idx.dim_customers)
[0m19:28:20.168196 [debug] [Thread-1 (]: Began compiling node model.dbt_idx.dim_customers
[0m19:28:20.171209 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_idx.dim_customers"
[0m19:28:20.177400 [debug] [Thread-1 (]: Timing info for model.dbt_idx.dim_customers (compile): 19:28:20.168196 => 19:28:20.177400
[0m19:28:20.178380 [debug] [Thread-1 (]: Began executing node model.dbt_idx.dim_customers
[0m19:28:20.184429 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_idx.dim_customers"
[0m19:28:20.191381 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.dim_customers"
[0m19:28:20.192380 [debug] [Thread-1 (]: On model.dbt_idx.dim_customers: BEGIN
[0m19:28:20.193379 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:28:20.217379 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m19:28:20.218384 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.dim_customers"
[0m19:28:20.218384 [debug] [Thread-1 (]: On model.dbt_idx.dim_customers: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.dim_customers"} */

  
    

  create  table "IDX-Stock"."IDX-Schema"."dim_customers__dbt_tmp"
  
  
    as
  
  (
    -- noinspection SqlDialectInspectionForFile

with customers as (
    select *
    from "IDX-Stock"."IDX-Schema"."stg_eltool__customers_snapshots"
    ),
     state as (
         select *
         from "IDX-Stock"."IDX-Schema"."stg_eltool__state"
     )
select c.customer_id,
       c.zipcode,
       c.city,
       c.state_code,
       s.state_name,
       c.datetime_created,
       c.datetime_updated,
       c.dbt_valid_from::TIMESTAMP as valid_from,
        CASE WHEN c.dbt_valid_to IS NULL
            THEN '9999-12-31'::TIMESTAMP
            ELSE c.dbt_valid_to::TIMESTAMP
        END as valid_to
from customers c
    join state s on c.state_code = s.state_code
  );
  
[0m19:28:20.224382 [debug] [Thread-1 (]: SQL status: SELECT 100 in 0.0 seconds
[0m19:28:20.227424 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.dim_customers"
[0m19:28:20.228424 [debug] [Thread-1 (]: On model.dbt_idx.dim_customers: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.dim_customers"} */
alter table "IDX-Stock"."IDX-Schema"."dim_customers" rename to "dim_customers__dbt_backup"
[0m19:28:20.230787 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:28:20.278400 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.dim_customers"
[0m19:28:20.279399 [debug] [Thread-1 (]: On model.dbt_idx.dim_customers: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.dim_customers"} */
alter table "IDX-Stock"."IDX-Schema"."dim_customers__dbt_tmp" rename to "dim_customers"
[0m19:28:20.281366 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:28:20.285365 [debug] [Thread-1 (]: On model.dbt_idx.dim_customers: COMMIT
[0m19:28:20.286366 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.dim_customers"
[0m19:28:20.286366 [debug] [Thread-1 (]: On model.dbt_idx.dim_customers: COMMIT
[0m19:28:20.289792 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m19:28:20.293823 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.dim_customers"
[0m19:28:20.294804 [debug] [Thread-1 (]: On model.dbt_idx.dim_customers: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.dim_customers"} */
drop table if exists "IDX-Stock"."IDX-Schema"."dim_customers__dbt_backup" cascade
[0m19:28:20.297799 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m19:28:20.299825 [debug] [Thread-1 (]: Timing info for model.dbt_idx.dim_customers (execute): 19:28:20.178380 => 19:28:20.299825
[0m19:28:20.300828 [debug] [Thread-1 (]: On model.dbt_idx.dim_customers: Close
[0m19:28:20.302817 [info ] [Thread-1 (]: 8 of 11 OK created sql table model IDX-Schema.dim_customers .................... [[32mSELECT 100[0m in 0.14s]
[0m19:28:20.304801 [debug] [Thread-1 (]: Finished running node model.dbt_idx.dim_customers
[0m19:28:20.305820 [debug] [Thread-1 (]: Began running node model.dbt_idx.fact_stocks
[0m19:28:20.306835 [info ] [Thread-1 (]: 9 of 11 START sql table model IDX-Schema.fact_stocks ........................... [RUN]
[0m19:28:20.308800 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_idx.dim_customers, now model.dbt_idx.fact_stocks)
[0m19:28:20.309888 [debug] [Thread-1 (]: Began compiling node model.dbt_idx.fact_stocks
[0m19:28:20.312836 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_idx.fact_stocks"
[0m19:28:20.319837 [debug] [Thread-1 (]: Timing info for model.dbt_idx.fact_stocks (compile): 19:28:20.309888 => 19:28:20.319837
[0m19:28:20.320834 [debug] [Thread-1 (]: Began executing node model.dbt_idx.fact_stocks
[0m19:28:20.326457 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_idx.fact_stocks"
[0m19:28:20.333403 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.fact_stocks"
[0m19:28:20.334412 [debug] [Thread-1 (]: On model.dbt_idx.fact_stocks: BEGIN
[0m19:28:20.334412 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:28:20.355225 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m19:28:20.356200 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.fact_stocks"
[0m19:28:20.357214 [debug] [Thread-1 (]: On model.dbt_idx.fact_stocks: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.fact_stocks"} */

  
    

  create  table "IDX-Stock"."IDX-Schema"."fact_stocks__dbt_tmp"
  
  
    as
  
  (
    -- noinspection SqlDialectInspectionForFile

with stock as (
    select *
    from "IDX-Stock"."IDX-Schema"."stg_eltool__stock"
    ),
     company as (
         select *
         from "IDX-Stock"."IDX-Schema"."stg_eltool__company"
     )
select a.id,
       a.ticker,
       b.name,
       a.date,
       a.open,
       a.high,
       a.low,
       a.close,
       a.volume,
       b.logo
from stock a
    join company b on a.ticker = b.ticker
  );
  
[0m19:28:20.405571 [debug] [Thread-1 (]: SQL status: SELECT 26131 in 0.0 seconds
[0m19:28:20.410577 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.fact_stocks"
[0m19:28:20.411578 [debug] [Thread-1 (]: On model.dbt_idx.fact_stocks: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.fact_stocks"} */
alter table "IDX-Stock"."IDX-Schema"."fact_stocks" rename to "fact_stocks__dbt_backup"
[0m19:28:20.414105 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:28:20.417736 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.fact_stocks"
[0m19:28:20.418742 [debug] [Thread-1 (]: On model.dbt_idx.fact_stocks: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.fact_stocks"} */
alter table "IDX-Stock"."IDX-Schema"."fact_stocks__dbt_tmp" rename to "fact_stocks"
[0m19:28:20.421741 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:28:20.427830 [debug] [Thread-1 (]: On model.dbt_idx.fact_stocks: COMMIT
[0m19:28:20.429307 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.fact_stocks"
[0m19:28:20.430344 [debug] [Thread-1 (]: On model.dbt_idx.fact_stocks: COMMIT
[0m19:28:20.442260 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m19:28:20.447261 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.fact_stocks"
[0m19:28:20.448254 [debug] [Thread-1 (]: On model.dbt_idx.fact_stocks: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.fact_stocks"} */
drop table if exists "IDX-Stock"."IDX-Schema"."fact_stocks__dbt_backup" cascade
[0m19:28:20.455324 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m19:28:20.458375 [debug] [Thread-1 (]: Timing info for model.dbt_idx.fact_stocks (execute): 19:28:20.322349 => 19:28:20.457332
[0m19:28:20.459336 [debug] [Thread-1 (]: On model.dbt_idx.fact_stocks: Close
[0m19:28:20.461338 [info ] [Thread-1 (]: 9 of 11 OK created sql table model IDX-Schema.fact_stocks ...................... [[32mSELECT 26131[0m in 0.15s]
[0m19:28:20.463337 [debug] [Thread-1 (]: Finished running node model.dbt_idx.fact_stocks
[0m19:28:20.464337 [debug] [Thread-1 (]: Began running node model.dbt_idx.customer_orders_status
[0m19:28:20.465347 [info ] [Thread-1 (]: 10 of 11 START sql view model IDX-Schema.customer_orders_status ................ [RUN]
[0m19:28:20.467335 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_idx.fact_stocks, now model.dbt_idx.customer_orders_status)
[0m19:28:20.468339 [debug] [Thread-1 (]: Began compiling node model.dbt_idx.customer_orders_status
[0m19:28:20.473911 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_idx.customer_orders_status"
[0m19:28:20.479925 [debug] [Thread-1 (]: Timing info for model.dbt_idx.customer_orders_status (compile): 19:28:20.470348 => 19:28:20.479925
[0m19:28:20.480917 [debug] [Thread-1 (]: Began executing node model.dbt_idx.customer_orders_status
[0m19:28:20.487952 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_idx.customer_orders_status"
[0m19:28:20.494451 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.customer_orders_status"
[0m19:28:20.495472 [debug] [Thread-1 (]: On model.dbt_idx.customer_orders_status: BEGIN
[0m19:28:20.495472 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:28:20.519564 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m19:28:20.520561 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.customer_orders_status"
[0m19:28:20.521547 [debug] [Thread-1 (]: On model.dbt_idx.customer_orders_status: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.customer_orders_status"} */

  create view "IDX-Stock"."IDX-Schema"."customer_orders_status__dbt_tmp"
    
    
  as (
    with orders as (select *
                from "IDX-Stock"."IDX-Schema"."fact_orders"),
     customers as (select *
                   from "IDX-Stock"."IDX-Schema"."dim_customers")
select o.order_id,
       o.customer_id,
       o.order_status,
       o.order_purchase_timestamp,
       o.order_approved_at,
       o.order_delivered_carrier_date,
       o.order_delivered_customer_date,
       o.order_estimated_delivery_date,
       c.zipcode    as customer_zipcode,
       c.city       as customer_city,
       c.state_code as customer_state_code,
       c.state_name as customer_state_name
from orders o
    join customers c on o.customer_id = c.customer_id
    and o.order_purchase_timestamp >= c.valid_from
    and o.order_purchase_timestamp <= c.valid_to
  );
[0m19:28:20.525588 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m19:28:20.529722 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.customer_orders_status"
[0m19:28:20.530561 [debug] [Thread-1 (]: On model.dbt_idx.customer_orders_status: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.customer_orders_status"} */
alter table "IDX-Stock"."IDX-Schema"."customer_orders_status__dbt_tmp" rename to "customer_orders_status"
[0m19:28:20.533581 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:28:20.535560 [debug] [Thread-1 (]: On model.dbt_idx.customer_orders_status: COMMIT
[0m19:28:20.537066 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.customer_orders_status"
[0m19:28:20.538097 [debug] [Thread-1 (]: On model.dbt_idx.customer_orders_status: COMMIT
[0m19:28:20.541543 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m19:28:20.545303 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.customer_orders_status"
[0m19:28:20.545303 [debug] [Thread-1 (]: On model.dbt_idx.customer_orders_status: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.customer_orders_status"} */
drop view if exists "IDX-Stock"."IDX-Schema"."customer_orders_status__dbt_backup" cascade
[0m19:28:20.548363 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m19:28:20.551371 [debug] [Thread-1 (]: Timing info for model.dbt_idx.customer_orders_status (execute): 19:28:20.481922 => 19:28:20.550373
[0m19:28:20.551371 [debug] [Thread-1 (]: On model.dbt_idx.customer_orders_status: Close
[0m19:28:20.554377 [info ] [Thread-1 (]: 10 of 11 OK created sql view model IDX-Schema.customer_orders_status ........... [[32mCREATE VIEW[0m in 0.09s]
[0m19:28:20.556373 [debug] [Thread-1 (]: Finished running node model.dbt_idx.customer_orders_status
[0m19:28:20.557388 [debug] [Thread-1 (]: Began running node model.dbt_idx.stock_update_status
[0m19:28:20.558397 [info ] [Thread-1 (]: 11 of 11 START sql view model IDX-Schema.stock_update_status ................... [RUN]
[0m19:28:20.559373 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_idx.customer_orders_status, now model.dbt_idx.stock_update_status)
[0m19:28:20.560372 [debug] [Thread-1 (]: Began compiling node model.dbt_idx.stock_update_status
[0m19:28:20.564372 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_idx.stock_update_status"
[0m19:28:20.570192 [debug] [Thread-1 (]: Timing info for model.dbt_idx.stock_update_status (compile): 19:28:20.561373 => 19:28:20.570192
[0m19:28:20.571155 [debug] [Thread-1 (]: Began executing node model.dbt_idx.stock_update_status
[0m19:28:20.578157 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_idx.stock_update_status"
[0m19:28:20.584155 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stock_update_status"
[0m19:28:20.585155 [debug] [Thread-1 (]: On model.dbt_idx.stock_update_status: BEGIN
[0m19:28:20.585155 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:28:20.606814 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m19:28:20.607825 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stock_update_status"
[0m19:28:20.607825 [debug] [Thread-1 (]: On model.dbt_idx.stock_update_status: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stock_update_status"} */

  create view "IDX-Stock"."IDX-Schema"."stock_update_status__dbt_tmp"
    
    
  as (
    with stock as (select *
               from "IDX-Stock"."IDX-Schema"."fact_stocks")
select a.id,
       a.ticker,
       a.name,
       a.date,
       a.open,
       a.high,
       a.low,
       a.close,
       a.volume,
       rank() over (order by a.date desc) as rank,
       a.logo
from stock a
  );
[0m19:28:20.612362 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m19:28:20.616360 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stock_update_status"
[0m19:28:20.617325 [debug] [Thread-1 (]: On model.dbt_idx.stock_update_status: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stock_update_status"} */
alter table "IDX-Stock"."IDX-Schema"."stock_update_status__dbt_tmp" rename to "stock_update_status"
[0m19:28:20.619323 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:28:20.621324 [debug] [Thread-1 (]: On model.dbt_idx.stock_update_status: COMMIT
[0m19:28:20.622336 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stock_update_status"
[0m19:28:20.622336 [debug] [Thread-1 (]: On model.dbt_idx.stock_update_status: COMMIT
[0m19:28:20.626368 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m19:28:20.629393 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stock_update_status"
[0m19:28:20.630367 [debug] [Thread-1 (]: On model.dbt_idx.stock_update_status: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stock_update_status"} */
drop view if exists "IDX-Stock"."IDX-Schema"."stock_update_status__dbt_backup" cascade
[0m19:28:20.632369 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m19:28:20.634393 [debug] [Thread-1 (]: Timing info for model.dbt_idx.stock_update_status (execute): 19:28:20.572156 => 19:28:20.633383
[0m19:28:20.634393 [debug] [Thread-1 (]: On model.dbt_idx.stock_update_status: Close
[0m19:28:20.636376 [info ] [Thread-1 (]: 11 of 11 OK created sql view model IDX-Schema.stock_update_status .............. [[32mCREATE VIEW[0m in 0.08s]
[0m19:28:20.638385 [debug] [Thread-1 (]: Finished running node model.dbt_idx.stock_update_status
[0m19:28:20.641414 [debug] [MainThread]: Using postgres connection "master"
[0m19:28:20.642421 [debug] [MainThread]: On master: BEGIN
[0m19:28:20.642421 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m19:28:20.663703 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m19:28:20.664679 [debug] [MainThread]: On master: COMMIT
[0m19:28:20.665679 [debug] [MainThread]: Using postgres connection "master"
[0m19:28:20.665679 [debug] [MainThread]: On master: COMMIT
[0m19:28:20.667679 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m19:28:20.667679 [debug] [MainThread]: On master: Close
[0m19:28:20.669693 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:28:20.670682 [debug] [MainThread]: Connection 'list_IDX-Stock' was properly closed.
[0m19:28:20.671681 [debug] [MainThread]: Connection 'list_IDX-Stock_IDX-Schema' was properly closed.
[0m19:28:20.672685 [debug] [MainThread]: Connection 'model.dbt_idx.stock_update_status' was properly closed.
[0m19:28:20.673684 [info ] [MainThread]: 
[0m19:28:20.674690 [info ] [MainThread]: Finished running 8 view models, 3 table models in 0 hours 0 minutes and 1.51 seconds (1.51s).
[0m19:28:20.677364 [debug] [MainThread]: Command end result
[0m19:28:20.701396 [info ] [MainThread]: 
[0m19:28:20.703372 [info ] [MainThread]: [32mCompleted successfully[0m
[0m19:28:20.704365 [info ] [MainThread]: 
[0m19:28:20.705364 [info ] [MainThread]: Done. PASS=11 WARN=0 ERROR=0 SKIP=0 TOTAL=11
[0m19:28:20.707376 [debug] [MainThread]: Command `dbt run` succeeded at 19:28:20.707376 after 2.07 seconds
[0m19:28:20.708398 [debug] [MainThread]: Flushing usage events


============================== 19:30:36.818385 | ef79bfba-d8fe-4439-83bf-2d1a7dff2e1c ==============================
[0m19:30:36.818385 [info ] [MainThread]: Running with dbt=1.6.1
[0m19:30:36.824909 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': 'D:\\00 Project\\00 My Project\\IdeaProjects\\Py-DBT-IDX', 'log_path': 'D:\\00 Project\\00 My Project\\IdeaProjects\\Py-DBT-IDX\\logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'False'}
[0m19:30:36.971305 [info ] [MainThread]: Registered adapter: postgres=1.6.1
[0m19:30:36.982845 [debug] [MainThread]: checksum: efe19d9f5b93d1a98cc804fbfcdb6b3aced98b974af664946fee1cde8837deb7, vars: {}, profile: , target: , version: 1.6.1
[0m19:30:37.143753 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m19:30:37.144752 [debug] [MainThread]: Partial parsing: updated file: dbt_idx://models\marts\stock\stock_update_status.sql
[0m19:30:37.258057 [info ] [MainThread]: Found 11 models, 1 snapshot, 18 tests, 5 sources, 0 exposures, 0 metrics, 349 macros, 0 groups, 0 semantic models
[0m19:30:37.260091 [info ] [MainThread]: 
[0m19:30:37.262093 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m19:30:37.264621 [debug] [ThreadPool]: Acquiring new postgres connection 'list_IDX-Stock'
[0m19:30:37.275049 [debug] [ThreadPool]: Using postgres connection "list_IDX-Stock"
[0m19:30:37.276084 [debug] [ThreadPool]: On list_IDX-Stock: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "connection_name": "list_IDX-Stock"} */

    select distinct nspname from pg_namespace
  
[0m19:30:37.277082 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:30:37.312688 [debug] [ThreadPool]: SQL status: SELECT 12 in 0.0 seconds
[0m19:30:37.314721 [debug] [ThreadPool]: On list_IDX-Stock: Close
[0m19:30:37.318722 [debug] [ThreadPool]: Acquiring new postgres connection 'list_IDX-Stock_IDX-Schema'
[0m19:30:37.325305 [debug] [ThreadPool]: Using postgres connection "list_IDX-Stock_IDX-Schema"
[0m19:30:37.326306 [debug] [ThreadPool]: On list_IDX-Stock_IDX-Schema: BEGIN
[0m19:30:37.327270 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:30:37.347134 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m19:30:37.348169 [debug] [ThreadPool]: Using postgres connection "list_IDX-Stock_IDX-Schema"
[0m19:30:37.349179 [debug] [ThreadPool]: On list_IDX-Stock_IDX-Schema: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "connection_name": "list_IDX-Stock_IDX-Schema"} */
select
      'IDX-Stock' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'IDX-Schema'
    union all
    select
      'IDX-Stock' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'IDX-Schema'
    union all
    select
      'IDX-Stock' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'IDX-Schema'
  
[0m19:30:37.354133 [debug] [ThreadPool]: SQL status: SELECT 17 in 0.0 seconds
[0m19:30:37.355161 [debug] [ThreadPool]: On list_IDX-Stock_IDX-Schema: ROLLBACK
[0m19:30:37.357135 [debug] [ThreadPool]: On list_IDX-Stock_IDX-Schema: Close
[0m19:30:37.359138 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_IDX-Stock_IDX-Schema, now list_IDX-Stock_snapshots)
[0m19:30:37.365160 [debug] [ThreadPool]: Using postgres connection "list_IDX-Stock_snapshots"
[0m19:30:37.366133 [debug] [ThreadPool]: On list_IDX-Stock_snapshots: BEGIN
[0m19:30:37.366133 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:30:37.387028 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m19:30:37.388033 [debug] [ThreadPool]: Using postgres connection "list_IDX-Stock_snapshots"
[0m19:30:37.389033 [debug] [ThreadPool]: On list_IDX-Stock_snapshots: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "connection_name": "list_IDX-Stock_snapshots"} */
select
      'IDX-Stock' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'snapshots'
    union all
    select
      'IDX-Stock' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'snapshots'
    union all
    select
      'IDX-Stock' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'snapshots'
  
[0m19:30:37.393357 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.0 seconds
[0m19:30:37.394368 [debug] [ThreadPool]: On list_IDX-Stock_snapshots: ROLLBACK
[0m19:30:37.396881 [debug] [ThreadPool]: On list_IDX-Stock_snapshots: Close
[0m19:30:37.403918 [debug] [MainThread]: Using postgres connection "master"
[0m19:30:37.403918 [debug] [MainThread]: On master: BEGIN
[0m19:30:37.404915 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:30:37.425276 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m19:30:37.426274 [debug] [MainThread]: Using postgres connection "master"
[0m19:30:37.426274 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m19:30:37.434277 [debug] [MainThread]: SQL status: SELECT 9 in 0.0 seconds
[0m19:30:37.438282 [debug] [MainThread]: On master: ROLLBACK
[0m19:30:37.441292 [debug] [MainThread]: Using postgres connection "master"
[0m19:30:37.442294 [debug] [MainThread]: On master: BEGIN
[0m19:30:37.446290 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m19:30:37.447276 [debug] [MainThread]: On master: COMMIT
[0m19:30:37.448279 [debug] [MainThread]: Using postgres connection "master"
[0m19:30:37.449296 [debug] [MainThread]: On master: COMMIT
[0m19:30:37.451297 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m19:30:37.452294 [debug] [MainThread]: On master: Close
[0m19:30:37.454280 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m19:30:37.456282 [info ] [MainThread]: 
[0m19:30:37.461279 [debug] [Thread-1 (]: Began running node model.dbt_idx.stg_eltool__company
[0m19:30:37.463294 [info ] [Thread-1 (]: 1 of 11 START sql view model IDX-Schema.stg_eltool__company .................... [RUN]
[0m19:30:37.465284 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.dbt_idx.stg_eltool__company'
[0m19:30:37.466294 [debug] [Thread-1 (]: Began compiling node model.dbt_idx.stg_eltool__company
[0m19:30:37.479409 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_idx.stg_eltool__company"
[0m19:30:37.487844 [debug] [Thread-1 (]: Timing info for model.dbt_idx.stg_eltool__company (compile): 19:30:37.467294 => 19:30:37.486828
[0m19:30:37.488860 [debug] [Thread-1 (]: Began executing node model.dbt_idx.stg_eltool__company
[0m19:30:37.544157 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_idx.stg_eltool__company"
[0m19:30:37.552675 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__company"
[0m19:30:37.553678 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__company: BEGIN
[0m19:30:37.553678 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m19:30:37.577675 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m19:30:37.577675 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__company"
[0m19:30:37.578700 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__company: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__company"} */

  create view "IDX-Stock"."IDX-Schema"."stg_eltool__company__dbt_tmp"
    
    
  as (
    with source as (select *
                from "IDX-Stock"."IDX-Schema"."ksql-company-stream"),
     renamed as (select id,
                        ticker,
                        name,
                        logo
                 from source)
select *
from renamed
  );
[0m19:30:37.581699 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m19:30:37.589004 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__company"
[0m19:30:37.589968 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__company: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__company"} */
alter table "IDX-Stock"."IDX-Schema"."stg_eltool__company" rename to "stg_eltool__company__dbt_backup"
[0m19:30:37.593004 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:30:37.596545 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__company"
[0m19:30:37.597556 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__company: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__company"} */
alter table "IDX-Stock"."IDX-Schema"."stg_eltool__company__dbt_tmp" rename to "stg_eltool__company"
[0m19:30:37.599557 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:30:37.617126 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__company: COMMIT
[0m19:30:37.618159 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__company"
[0m19:30:37.619161 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__company: COMMIT
[0m19:30:37.622656 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m19:30:37.632725 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__company"
[0m19:30:37.633663 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__company: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__company"} */
drop view if exists "IDX-Stock"."IDX-Schema"."stg_eltool__company__dbt_backup" cascade
[0m19:30:37.637828 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m19:30:37.639665 [debug] [Thread-1 (]: Timing info for model.dbt_idx.stg_eltool__company (execute): 19:30:37.489866 => 19:30:37.639665
[0m19:30:37.640446 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__company: Close
[0m19:30:37.642216 [info ] [Thread-1 (]: 1 of 11 OK created sql view model IDX-Schema.stg_eltool__company ............... [[32mCREATE VIEW[0m in 0.18s]
[0m19:30:37.644216 [debug] [Thread-1 (]: Finished running node model.dbt_idx.stg_eltool__company
[0m19:30:37.645218 [debug] [Thread-1 (]: Began running node model.dbt_idx.stg_eltool__customers
[0m19:30:37.647216 [info ] [Thread-1 (]: 2 of 11 START sql view model IDX-Schema.stg_eltool__customers .................. [RUN]
[0m19:30:37.647216 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_idx.stg_eltool__company, now model.dbt_idx.stg_eltool__customers)
[0m19:30:37.648701 [debug] [Thread-1 (]: Began compiling node model.dbt_idx.stg_eltool__customers
[0m19:30:37.652708 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_idx.stg_eltool__customers"
[0m19:30:37.659704 [debug] [Thread-1 (]: Timing info for model.dbt_idx.stg_eltool__customers (compile): 19:30:37.649735 => 19:30:37.658734
[0m19:30:37.660704 [debug] [Thread-1 (]: Began executing node model.dbt_idx.stg_eltool__customers
[0m19:30:37.666706 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_idx.stg_eltool__customers"
[0m19:30:37.673256 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__customers"
[0m19:30:37.674264 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__customers: BEGIN
[0m19:30:37.675263 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:30:37.696193 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m19:30:37.696786 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__customers"
[0m19:30:37.697795 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__customers: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__customers"} */

  create view "IDX-Stock"."IDX-Schema"."stg_eltool__customers__dbt_tmp"
    
    
  as (
    with source as (select *
                from "IDX-Stock"."IDX-Schema"."customers"),
     renamed as (select
                     customer_id,
                    'This is Dummy' as dummy
                 from source
                 where customer_id = 1234567890)
select *
from renamed
  );
[0m19:30:37.700805 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m19:30:37.705829 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__customers"
[0m19:30:37.706795 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__customers: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__customers"} */
alter table "IDX-Stock"."IDX-Schema"."stg_eltool__customers" rename to "stg_eltool__customers__dbt_backup"
[0m19:30:37.708805 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:30:37.712827 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__customers"
[0m19:30:37.713827 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__customers: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__customers"} */
alter table "IDX-Stock"."IDX-Schema"."stg_eltool__customers__dbt_tmp" rename to "stg_eltool__customers"
[0m19:30:37.716797 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:30:37.719828 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__customers: COMMIT
[0m19:30:37.720799 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__customers"
[0m19:30:37.721794 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__customers: COMMIT
[0m19:30:37.725022 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m19:30:37.729019 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__customers"
[0m19:30:37.729019 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__customers: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__customers"} */
drop view if exists "IDX-Stock"."IDX-Schema"."stg_eltool__customers__dbt_backup" cascade
[0m19:30:37.733019 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m19:30:37.735055 [debug] [Thread-1 (]: Timing info for model.dbt_idx.stg_eltool__customers (execute): 19:30:37.660704 => 19:30:37.735055
[0m19:30:37.736054 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__customers: Close
[0m19:30:37.738024 [info ] [Thread-1 (]: 2 of 11 OK created sql view model IDX-Schema.stg_eltool__customers ............. [[32mCREATE VIEW[0m in 0.09s]
[0m19:30:37.739021 [debug] [Thread-1 (]: Finished running node model.dbt_idx.stg_eltool__customers
[0m19:30:37.740021 [debug] [Thread-1 (]: Began running node model.dbt_idx.stg_eltool__customers_snapshots
[0m19:30:37.741038 [info ] [Thread-1 (]: 3 of 11 START sql view model IDX-Schema.stg_eltool__customers_snapshots ........ [RUN]
[0m19:30:37.743056 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_idx.stg_eltool__customers, now model.dbt_idx.stg_eltool__customers_snapshots)
[0m19:30:37.743056 [debug] [Thread-1 (]: Began compiling node model.dbt_idx.stg_eltool__customers_snapshots
[0m19:30:37.746055 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_idx.stg_eltool__customers_snapshots"
[0m19:30:37.751915 [debug] [Thread-1 (]: Timing info for model.dbt_idx.stg_eltool__customers_snapshots (compile): 19:30:37.744054 => 19:30:37.751915
[0m19:30:37.752917 [debug] [Thread-1 (]: Began executing node model.dbt_idx.stg_eltool__customers_snapshots
[0m19:30:37.758914 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_idx.stg_eltool__customers_snapshots"
[0m19:30:37.764915 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__customers_snapshots"
[0m19:30:37.765944 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__customers_snapshots: BEGIN
[0m19:30:37.765944 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:30:37.787749 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m19:30:37.788769 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__customers_snapshots"
[0m19:30:37.789765 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__customers_snapshots: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__customers_snapshots"} */

  create view "IDX-Stock"."IDX-Schema"."stg_eltool__customers_snapshots__dbt_tmp"
    
    
  as (
    with source as (select *
                from "IDX-Stock"."snapshots"."customers_snapshot"),
     renamed as (select customer_id,
                        zipcode,
                        city,
                        state_code,
                        datetime_created::TIMESTAMP AS datetime_created,
                        datetime_updated::TIMESTAMP AS datetime_updated,
                        dbt_valid_from,
                        dbt_valid_to
                 from source)
select *
from renamed
  );
[0m19:30:37.793732 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m19:30:37.798287 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__customers_snapshots"
[0m19:30:37.799288 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__customers_snapshots: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__customers_snapshots"} */
alter table "IDX-Stock"."IDX-Schema"."stg_eltool__customers_snapshots" rename to "stg_eltool__customers_snapshots__dbt_backup"
[0m19:30:37.801288 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:30:37.804290 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__customers_snapshots"
[0m19:30:37.805289 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__customers_snapshots: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__customers_snapshots"} */
alter table "IDX-Stock"."IDX-Schema"."stg_eltool__customers_snapshots__dbt_tmp" rename to "stg_eltool__customers_snapshots"
[0m19:30:37.808256 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:30:37.812254 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__customers_snapshots: COMMIT
[0m19:30:37.813257 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__customers_snapshots"
[0m19:30:37.813257 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__customers_snapshots: COMMIT
[0m19:30:37.817008 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m19:30:37.820027 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__customers_snapshots"
[0m19:30:37.820027 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__customers_snapshots: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__customers_snapshots"} */
drop view if exists "IDX-Stock"."IDX-Schema"."stg_eltool__customers_snapshots__dbt_backup" cascade
[0m19:30:37.824143 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m19:30:37.826170 [debug] [Thread-1 (]: Timing info for model.dbt_idx.stg_eltool__customers_snapshots (execute): 19:30:37.753893 => 19:30:37.826170
[0m19:30:37.827144 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__customers_snapshots: Close
[0m19:30:37.828147 [info ] [Thread-1 (]: 3 of 11 OK created sql view model IDX-Schema.stg_eltool__customers_snapshots ... [[32mCREATE VIEW[0m in 0.09s]
[0m19:30:37.831176 [debug] [Thread-1 (]: Finished running node model.dbt_idx.stg_eltool__customers_snapshots
[0m19:30:37.832162 [debug] [Thread-1 (]: Began running node model.dbt_idx.stg_eltool__orders
[0m19:30:37.833144 [info ] [Thread-1 (]: 4 of 11 START sql view model IDX-Schema.stg_eltool__orders ..................... [RUN]
[0m19:30:37.834143 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_idx.stg_eltool__customers_snapshots, now model.dbt_idx.stg_eltool__orders)
[0m19:30:37.835144 [debug] [Thread-1 (]: Began compiling node model.dbt_idx.stg_eltool__orders
[0m19:30:37.838148 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_idx.stg_eltool__orders"
[0m19:30:37.848360 [debug] [Thread-1 (]: Timing info for model.dbt_idx.stg_eltool__orders (compile): 19:30:37.835144 => 19:30:37.848360
[0m19:30:37.849355 [debug] [Thread-1 (]: Began executing node model.dbt_idx.stg_eltool__orders
[0m19:30:37.855320 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_idx.stg_eltool__orders"
[0m19:30:37.865553 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__orders"
[0m19:30:37.866559 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__orders: BEGIN
[0m19:30:37.867554 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:30:37.887908 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m19:30:37.888908 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__orders"
[0m19:30:37.889875 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__orders: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__orders"} */

  create view "IDX-Stock"."IDX-Schema"."stg_eltool__orders__dbt_tmp"
    
    
  as (
    with source as (select *
                from "IDX-Stock"."IDX-Schema"."orders"),
     renamed as (select order_id,
                        cust_id AS customer_id,
                        order_status,
                        order_purchase_timestamp::TIMESTAMP,
                        order_approved_at::TIMESTAMP,
                        order_delivered_carrier_date::TIMESTAMP,
                        order_delivered_customer_date::TIMESTAMP,
                        order_estimated_delivery_date::TIMESTAMP
                 from source)
select *
from renamed
  );
[0m19:30:37.892900 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m19:30:37.896429 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__orders"
[0m19:30:37.897461 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__orders: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__orders"} */
alter table "IDX-Stock"."IDX-Schema"."stg_eltool__orders" rename to "stg_eltool__orders__dbt_backup"
[0m19:30:37.899436 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:30:37.903435 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__orders"
[0m19:30:37.904438 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__orders: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__orders"} */
alter table "IDX-Stock"."IDX-Schema"."stg_eltool__orders__dbt_tmp" rename to "stg_eltool__orders"
[0m19:30:37.906445 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:30:37.909463 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__orders: COMMIT
[0m19:30:37.909463 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__orders"
[0m19:30:37.910459 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__orders: COMMIT
[0m19:30:37.914436 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m19:30:37.917436 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__orders"
[0m19:30:37.918457 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__orders: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__orders"} */
drop view if exists "IDX-Stock"."IDX-Schema"."stg_eltool__orders__dbt_backup" cascade
[0m19:30:37.922435 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m19:30:37.924460 [debug] [Thread-1 (]: Timing info for model.dbt_idx.stg_eltool__orders (execute): 19:30:37.850334 => 19:30:37.924460
[0m19:30:37.925435 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__orders: Close
[0m19:30:37.926961 [info ] [Thread-1 (]: 4 of 11 OK created sql view model IDX-Schema.stg_eltool__orders ................ [[32mCREATE VIEW[0m in 0.09s]
[0m19:30:37.928972 [debug] [Thread-1 (]: Finished running node model.dbt_idx.stg_eltool__orders
[0m19:30:37.930992 [debug] [Thread-1 (]: Began running node model.dbt_idx.stg_eltool__state
[0m19:30:37.931969 [info ] [Thread-1 (]: 5 of 11 START sql view model IDX-Schema.stg_eltool__state ...................... [RUN]
[0m19:30:37.932989 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_idx.stg_eltool__orders, now model.dbt_idx.stg_eltool__state)
[0m19:30:37.933970 [debug] [Thread-1 (]: Began compiling node model.dbt_idx.stg_eltool__state
[0m19:30:37.937004 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_idx.stg_eltool__state"
[0m19:30:37.942596 [debug] [Thread-1 (]: Timing info for model.dbt_idx.stg_eltool__state (compile): 19:30:37.934968 => 19:30:37.942596
[0m19:30:37.943560 [debug] [Thread-1 (]: Began executing node model.dbt_idx.stg_eltool__state
[0m19:30:37.949556 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_idx.stg_eltool__state"
[0m19:30:37.956558 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__state"
[0m19:30:37.956558 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__state: BEGIN
[0m19:30:37.957595 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:30:37.978534 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m19:30:37.979543 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__state"
[0m19:30:37.980531 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__state: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__state"} */

  create view "IDX-Stock"."IDX-Schema"."stg_eltool__state__dbt_tmp"
    
    
  as (
    with source as (select *
                from "IDX-Stock"."IDX-Schema"."state"),
     renamed as (select state_identifier::INT AS state_id,
                         state_code::VARCHAR(2) AS state_code,
                         st_name::VARCHAR(30) AS state_name
                 from source)
select *
from renamed
  );
[0m19:30:37.983650 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m19:30:37.987663 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__state"
[0m19:30:37.988661 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__state: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__state"} */
alter table "IDX-Stock"."IDX-Schema"."stg_eltool__state" rename to "stg_eltool__state__dbt_backup"
[0m19:30:37.990720 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:30:37.994702 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__state"
[0m19:30:37.994702 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__state: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__state"} */
alter table "IDX-Stock"."IDX-Schema"."stg_eltool__state__dbt_tmp" rename to "stg_eltool__state"
[0m19:30:37.997757 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:30:37.999804 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__state: COMMIT
[0m19:30:38.000758 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__state"
[0m19:30:38.000758 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__state: COMMIT
[0m19:30:38.003809 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m19:30:38.008815 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__state"
[0m19:30:38.009839 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__state: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__state"} */
drop view if exists "IDX-Stock"."IDX-Schema"."stg_eltool__state__dbt_backup" cascade
[0m19:30:38.013652 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m19:30:38.015650 [debug] [Thread-1 (]: Timing info for model.dbt_idx.stg_eltool__state (execute): 19:30:37.944557 => 19:30:38.015650
[0m19:30:38.016650 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__state: Close
[0m19:30:38.017666 [info ] [Thread-1 (]: 5 of 11 OK created sql view model IDX-Schema.stg_eltool__state ................. [[32mCREATE VIEW[0m in 0.08s]
[0m19:30:38.019669 [debug] [Thread-1 (]: Finished running node model.dbt_idx.stg_eltool__state
[0m19:30:38.020687 [debug] [Thread-1 (]: Began running node model.dbt_idx.stg_eltool__stock
[0m19:30:38.022649 [info ] [Thread-1 (]: 6 of 11 START sql view model IDX-Schema.stg_eltool__stock ...................... [RUN]
[0m19:30:38.023667 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_idx.stg_eltool__state, now model.dbt_idx.stg_eltool__stock)
[0m19:30:38.024676 [debug] [Thread-1 (]: Began compiling node model.dbt_idx.stg_eltool__stock
[0m19:30:38.027650 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_idx.stg_eltool__stock"
[0m19:30:38.033136 [debug] [Thread-1 (]: Timing info for model.dbt_idx.stg_eltool__stock (compile): 19:30:38.024676 => 19:30:38.033136
[0m19:30:38.034171 [debug] [Thread-1 (]: Began executing node model.dbt_idx.stg_eltool__stock
[0m19:30:38.040164 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_idx.stg_eltool__stock"
[0m19:30:38.047927 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__stock"
[0m19:30:38.048925 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__stock: BEGIN
[0m19:30:38.048925 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:30:38.068925 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m19:30:38.069924 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__stock"
[0m19:30:38.070924 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__stock: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__stock"} */

  create view "IDX-Stock"."IDX-Schema"."stg_eltool__stock__dbt_tmp"
    
    
  as (
    with source as (select *
                from "IDX-Stock"."IDX-Schema"."ksql-stock-stream"),
     renamed as (select *
                 from source)
select *
from renamed
  );
[0m19:30:38.074925 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m19:30:38.078950 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__stock"
[0m19:30:38.079945 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__stock: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__stock"} */
alter table "IDX-Stock"."IDX-Schema"."stg_eltool__stock" rename to "stg_eltool__stock__dbt_backup"
[0m19:30:38.082577 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:30:38.085623 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__stock"
[0m19:30:38.086623 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__stock: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__stock"} */
alter table "IDX-Stock"."IDX-Schema"."stg_eltool__stock__dbt_tmp" rename to "stg_eltool__stock"
[0m19:30:38.088624 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:30:38.091628 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__stock: COMMIT
[0m19:30:38.092592 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__stock"
[0m19:30:38.093591 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__stock: COMMIT
[0m19:30:38.096613 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m19:30:38.099654 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__stock"
[0m19:30:38.099654 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__stock: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__stock"} */
drop view if exists "IDX-Stock"."IDX-Schema"."stg_eltool__stock__dbt_backup" cascade
[0m19:30:38.104013 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m19:30:38.106011 [debug] [Thread-1 (]: Timing info for model.dbt_idx.stg_eltool__stock (execute): 19:30:38.034171 => 19:30:38.106011
[0m19:30:38.107030 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__stock: Close
[0m19:30:38.109013 [info ] [Thread-1 (]: 6 of 11 OK created sql view model IDX-Schema.stg_eltool__stock ................. [[32mCREATE VIEW[0m in 0.08s]
[0m19:30:38.111045 [debug] [Thread-1 (]: Finished running node model.dbt_idx.stg_eltool__stock
[0m19:30:38.112017 [debug] [Thread-1 (]: Began running node model.dbt_idx.fact_orders
[0m19:30:38.113013 [info ] [Thread-1 (]: 7 of 11 START sql table model IDX-Schema.fact_orders ........................... [RUN]
[0m19:30:38.114014 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_idx.stg_eltool__stock, now model.dbt_idx.fact_orders)
[0m19:30:38.115052 [debug] [Thread-1 (]: Began compiling node model.dbt_idx.fact_orders
[0m19:30:38.118009 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_idx.fact_orders"
[0m19:30:38.123445 [debug] [Thread-1 (]: Timing info for model.dbt_idx.fact_orders (compile): 19:30:38.115052 => 19:30:38.123445
[0m19:30:38.124442 [debug] [Thread-1 (]: Began executing node model.dbt_idx.fact_orders
[0m19:30:38.147441 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_idx.fact_orders"
[0m19:30:38.154408 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.fact_orders"
[0m19:30:38.154408 [debug] [Thread-1 (]: On model.dbt_idx.fact_orders: BEGIN
[0m19:30:38.155445 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:30:38.176408 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m19:30:38.177407 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.fact_orders"
[0m19:30:38.178407 [debug] [Thread-1 (]: On model.dbt_idx.fact_orders: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.fact_orders"} */

  
    

  create  table "IDX-Stock"."IDX-Schema"."fact_orders__dbt_tmp"
  
  
    as
  
  (
    with orders as (
    select *
    from "IDX-Stock"."IDX-Schema"."stg_eltool__orders"
)
select * from orders
  );
  
[0m19:30:38.184814 [debug] [Thread-1 (]: SQL status: SELECT 999 in 0.0 seconds
[0m19:30:38.188824 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.fact_orders"
[0m19:30:38.189823 [debug] [Thread-1 (]: On model.dbt_idx.fact_orders: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.fact_orders"} */
alter table "IDX-Stock"."IDX-Schema"."fact_orders" rename to "fact_orders__dbt_backup"
[0m19:30:38.191828 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:30:38.195824 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.fact_orders"
[0m19:30:38.195824 [debug] [Thread-1 (]: On model.dbt_idx.fact_orders: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.fact_orders"} */
alter table "IDX-Stock"."IDX-Schema"."fact_orders__dbt_tmp" rename to "fact_orders"
[0m19:30:38.198337 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:30:38.204337 [debug] [Thread-1 (]: On model.dbt_idx.fact_orders: COMMIT
[0m19:30:38.205336 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.fact_orders"
[0m19:30:38.205336 [debug] [Thread-1 (]: On model.dbt_idx.fact_orders: COMMIT
[0m19:30:38.209428 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m19:30:38.214462 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.fact_orders"
[0m19:30:38.215465 [debug] [Thread-1 (]: On model.dbt_idx.fact_orders: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.fact_orders"} */
drop table if exists "IDX-Stock"."IDX-Schema"."fact_orders__dbt_backup" cascade
[0m19:30:38.219666 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m19:30:38.221699 [debug] [Thread-1 (]: Timing info for model.dbt_idx.fact_orders (execute): 19:30:38.124442 => 19:30:38.221699
[0m19:30:38.222698 [debug] [Thread-1 (]: On model.dbt_idx.fact_orders: Close
[0m19:30:38.224666 [info ] [Thread-1 (]: 7 of 11 OK created sql table model IDX-Schema.fact_orders ...................... [[32mSELECT 999[0m in 0.11s]
[0m19:30:38.226668 [debug] [Thread-1 (]: Finished running node model.dbt_idx.fact_orders
[0m19:30:38.228664 [debug] [Thread-1 (]: Began running node model.dbt_idx.dim_customers
[0m19:30:38.229670 [info ] [Thread-1 (]: 8 of 11 START sql table model IDX-Schema.dim_customers ......................... [RUN]
[0m19:30:38.230663 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_idx.fact_orders, now model.dbt_idx.dim_customers)
[0m19:30:38.231668 [debug] [Thread-1 (]: Began compiling node model.dbt_idx.dim_customers
[0m19:30:38.237700 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_idx.dim_customers"
[0m19:30:38.243667 [debug] [Thread-1 (]: Timing info for model.dbt_idx.dim_customers (compile): 19:30:38.232664 => 19:30:38.243667
[0m19:30:38.244680 [debug] [Thread-1 (]: Began executing node model.dbt_idx.dim_customers
[0m19:30:38.251702 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_idx.dim_customers"
[0m19:30:38.258144 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.dim_customers"
[0m19:30:38.259143 [debug] [Thread-1 (]: On model.dbt_idx.dim_customers: BEGIN
[0m19:30:38.259143 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:30:38.280343 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m19:30:38.281398 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.dim_customers"
[0m19:30:38.282406 [debug] [Thread-1 (]: On model.dbt_idx.dim_customers: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.dim_customers"} */

  
    

  create  table "IDX-Stock"."IDX-Schema"."dim_customers__dbt_tmp"
  
  
    as
  
  (
    -- noinspection SqlDialectInspectionForFile

with customers as (
    select *
    from "IDX-Stock"."IDX-Schema"."stg_eltool__customers_snapshots"
    ),
     state as (
         select *
         from "IDX-Stock"."IDX-Schema"."stg_eltool__state"
     )
select c.customer_id,
       c.zipcode,
       c.city,
       c.state_code,
       s.state_name,
       c.datetime_created,
       c.datetime_updated,
       c.dbt_valid_from::TIMESTAMP as valid_from,
        CASE WHEN c.dbt_valid_to IS NULL
            THEN '9999-12-31'::TIMESTAMP
            ELSE c.dbt_valid_to::TIMESTAMP
        END as valid_to
from customers c
    join state s on c.state_code = s.state_code
  );
  
[0m19:30:38.286408 [debug] [Thread-1 (]: SQL status: SELECT 100 in 0.0 seconds
[0m19:30:38.290442 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.dim_customers"
[0m19:30:38.291438 [debug] [Thread-1 (]: On model.dbt_idx.dim_customers: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.dim_customers"} */
alter table "IDX-Stock"."IDX-Schema"."dim_customers" rename to "dim_customers__dbt_backup"
[0m19:30:38.294406 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:30:38.338516 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.dim_customers"
[0m19:30:38.339512 [debug] [Thread-1 (]: On model.dbt_idx.dim_customers: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.dim_customers"} */
alter table "IDX-Stock"."IDX-Schema"."dim_customers__dbt_tmp" rename to "dim_customers"
[0m19:30:38.341509 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:30:38.345510 [debug] [Thread-1 (]: On model.dbt_idx.dim_customers: COMMIT
[0m19:30:38.346510 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.dim_customers"
[0m19:30:38.347522 [debug] [Thread-1 (]: On model.dbt_idx.dim_customers: COMMIT
[0m19:30:38.351510 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m19:30:38.355510 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.dim_customers"
[0m19:30:38.356517 [debug] [Thread-1 (]: On model.dbt_idx.dim_customers: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.dim_customers"} */
drop table if exists "IDX-Stock"."IDX-Schema"."dim_customers__dbt_backup" cascade
[0m19:30:38.360041 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m19:30:38.362041 [debug] [Thread-1 (]: Timing info for model.dbt_idx.dim_customers (execute): 19:30:38.244680 => 19:30:38.362041
[0m19:30:38.363073 [debug] [Thread-1 (]: On model.dbt_idx.dim_customers: Close
[0m19:30:38.365055 [info ] [Thread-1 (]: 8 of 11 OK created sql table model IDX-Schema.dim_customers .................... [[32mSELECT 100[0m in 0.13s]
[0m19:30:38.368046 [debug] [Thread-1 (]: Finished running node model.dbt_idx.dim_customers
[0m19:30:38.369052 [debug] [Thread-1 (]: Began running node model.dbt_idx.fact_stocks
[0m19:30:38.370042 [info ] [Thread-1 (]: 9 of 11 START sql table model IDX-Schema.fact_stocks ........................... [RUN]
[0m19:30:38.371061 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_idx.dim_customers, now model.dbt_idx.fact_stocks)
[0m19:30:38.372045 [debug] [Thread-1 (]: Began compiling node model.dbt_idx.fact_stocks
[0m19:30:38.375073 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_idx.fact_stocks"
[0m19:30:38.382039 [debug] [Thread-1 (]: Timing info for model.dbt_idx.fact_stocks (compile): 19:30:38.373042 => 19:30:38.381039
[0m19:30:38.383049 [debug] [Thread-1 (]: Began executing node model.dbt_idx.fact_stocks
[0m19:30:38.388079 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_idx.fact_stocks"
[0m19:30:38.393970 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.fact_stocks"
[0m19:30:38.394959 [debug] [Thread-1 (]: On model.dbt_idx.fact_stocks: BEGIN
[0m19:30:38.395963 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:30:38.416469 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m19:30:38.417465 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.fact_stocks"
[0m19:30:38.419724 [debug] [Thread-1 (]: On model.dbt_idx.fact_stocks: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.fact_stocks"} */

  
    

  create  table "IDX-Stock"."IDX-Schema"."fact_stocks__dbt_tmp"
  
  
    as
  
  (
    -- noinspection SqlDialectInspectionForFile

with stock as (
    select *
    from "IDX-Stock"."IDX-Schema"."stg_eltool__stock"
    ),
     company as (
         select *
         from "IDX-Stock"."IDX-Schema"."stg_eltool__company"
     )
select a.id,
       a.ticker,
       b.name,
       a.date,
       a.open,
       a.high,
       a.low,
       a.close,
       a.volume,
       b.logo
from stock a
    join company b on a.ticker = b.ticker
  );
  
[0m19:30:38.467858 [debug] [Thread-1 (]: SQL status: SELECT 26131 in 0.0 seconds
[0m19:30:38.471863 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.fact_stocks"
[0m19:30:38.472864 [debug] [Thread-1 (]: On model.dbt_idx.fact_stocks: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.fact_stocks"} */
alter table "IDX-Stock"."IDX-Schema"."fact_stocks" rename to "fact_stocks__dbt_backup"
[0m19:30:38.474868 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:30:38.478864 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.fact_stocks"
[0m19:30:38.479878 [debug] [Thread-1 (]: On model.dbt_idx.fact_stocks: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.fact_stocks"} */
alter table "IDX-Stock"."IDX-Schema"."fact_stocks__dbt_tmp" rename to "fact_stocks"
[0m19:30:38.482877 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:30:38.484877 [debug] [Thread-1 (]: On model.dbt_idx.fact_stocks: COMMIT
[0m19:30:38.485877 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.fact_stocks"
[0m19:30:38.486876 [debug] [Thread-1 (]: On model.dbt_idx.fact_stocks: COMMIT
[0m19:30:38.531820 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m19:30:38.539419 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.fact_stocks"
[0m19:30:38.541374 [debug] [Thread-1 (]: On model.dbt_idx.fact_stocks: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.fact_stocks"} */
drop table if exists "IDX-Stock"."IDX-Schema"."fact_stocks__dbt_backup" cascade
[0m19:30:38.550839 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m19:30:38.554217 [debug] [Thread-1 (]: Timing info for model.dbt_idx.fact_stocks (execute): 19:30:38.384047 => 19:30:38.553673
[0m19:30:38.554938 [debug] [Thread-1 (]: On model.dbt_idx.fact_stocks: Close
[0m19:30:38.556860 [info ] [Thread-1 (]: 9 of 11 OK created sql table model IDX-Schema.fact_stocks ...................... [[32mSELECT 26131[0m in 0.19s]
[0m19:30:38.558532 [debug] [Thread-1 (]: Finished running node model.dbt_idx.fact_stocks
[0m19:30:38.560147 [debug] [Thread-1 (]: Began running node model.dbt_idx.customer_orders_status
[0m19:30:38.561307 [info ] [Thread-1 (]: 10 of 11 START sql view model IDX-Schema.customer_orders_status ................ [RUN]
[0m19:30:38.563085 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_idx.fact_stocks, now model.dbt_idx.customer_orders_status)
[0m19:30:38.564115 [debug] [Thread-1 (]: Began compiling node model.dbt_idx.customer_orders_status
[0m19:30:38.570761 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_idx.customer_orders_status"
[0m19:30:38.577758 [debug] [Thread-1 (]: Timing info for model.dbt_idx.customer_orders_status (compile): 19:30:38.565233 => 19:30:38.577010
[0m19:30:38.578759 [debug] [Thread-1 (]: Began executing node model.dbt_idx.customer_orders_status
[0m19:30:38.583760 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_idx.customer_orders_status"
[0m19:30:38.589285 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.customer_orders_status"
[0m19:30:38.590283 [debug] [Thread-1 (]: On model.dbt_idx.customer_orders_status: BEGIN
[0m19:30:38.591284 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:30:38.618144 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m19:30:38.619429 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.customer_orders_status"
[0m19:30:38.620846 [debug] [Thread-1 (]: On model.dbt_idx.customer_orders_status: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.customer_orders_status"} */

  create view "IDX-Stock"."IDX-Schema"."customer_orders_status__dbt_tmp"
    
    
  as (
    with orders as (select *
                from "IDX-Stock"."IDX-Schema"."fact_orders"),
     customers as (select *
                   from "IDX-Stock"."IDX-Schema"."dim_customers")
select o.order_id,
       o.customer_id,
       o.order_status,
       o.order_purchase_timestamp,
       o.order_approved_at,
       o.order_delivered_carrier_date,
       o.order_delivered_customer_date,
       o.order_estimated_delivery_date,
       c.zipcode    as customer_zipcode,
       c.city       as customer_city,
       c.state_code as customer_state_code,
       c.state_name as customer_state_name
from orders o
    join customers c on o.customer_id = c.customer_id
    and o.order_purchase_timestamp >= c.valid_from
    and o.order_purchase_timestamp <= c.valid_to
  );
[0m19:30:38.624665 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m19:30:38.628100 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.customer_orders_status"
[0m19:30:38.628670 [debug] [Thread-1 (]: On model.dbt_idx.customer_orders_status: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.customer_orders_status"} */
alter table "IDX-Stock"."IDX-Schema"."customer_orders_status__dbt_tmp" rename to "customer_orders_status"
[0m19:30:38.632396 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:30:38.634392 [debug] [Thread-1 (]: On model.dbt_idx.customer_orders_status: COMMIT
[0m19:30:38.635391 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.customer_orders_status"
[0m19:30:38.636392 [debug] [Thread-1 (]: On model.dbt_idx.customer_orders_status: COMMIT
[0m19:30:38.639415 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m19:30:38.643424 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.customer_orders_status"
[0m19:30:38.644389 [debug] [Thread-1 (]: On model.dbt_idx.customer_orders_status: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.customer_orders_status"} */
drop view if exists "IDX-Stock"."IDX-Schema"."customer_orders_status__dbt_backup" cascade
[0m19:30:38.646391 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m19:30:38.648414 [debug] [Thread-1 (]: Timing info for model.dbt_idx.customer_orders_status (execute): 19:30:38.578759 => 19:30:38.648414
[0m19:30:38.649390 [debug] [Thread-1 (]: On model.dbt_idx.customer_orders_status: Close
[0m19:30:38.651391 [info ] [Thread-1 (]: 10 of 11 OK created sql view model IDX-Schema.customer_orders_status ........... [[32mCREATE VIEW[0m in 0.09s]
[0m19:30:38.653401 [debug] [Thread-1 (]: Finished running node model.dbt_idx.customer_orders_status
[0m19:30:38.654391 [debug] [Thread-1 (]: Began running node model.dbt_idx.stock_update_status
[0m19:30:38.655393 [info ] [Thread-1 (]: 11 of 11 START sql view model IDX-Schema.stock_update_status ................... [RUN]
[0m19:30:38.656394 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_idx.customer_orders_status, now model.dbt_idx.stock_update_status)
[0m19:30:38.657391 [debug] [Thread-1 (]: Began compiling node model.dbt_idx.stock_update_status
[0m19:30:38.661391 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_idx.stock_update_status"
[0m19:30:38.667424 [debug] [Thread-1 (]: Timing info for model.dbt_idx.stock_update_status (compile): 19:30:38.658389 => 19:30:38.666424
[0m19:30:38.667424 [debug] [Thread-1 (]: Began executing node model.dbt_idx.stock_update_status
[0m19:30:38.674387 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_idx.stock_update_status"
[0m19:30:38.682122 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stock_update_status"
[0m19:30:38.683138 [debug] [Thread-1 (]: On model.dbt_idx.stock_update_status: BEGIN
[0m19:30:38.684121 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:30:38.716636 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m19:30:38.717641 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stock_update_status"
[0m19:30:38.718634 [debug] [Thread-1 (]: On model.dbt_idx.stock_update_status: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stock_update_status"} */

  create view "IDX-Stock"."IDX-Schema"."stock_update_status__dbt_tmp"
    
    
  as (
    with stock as (select *
               from "IDX-Stock"."IDX-Schema"."fact_stocks")
select a.id,
       a.ticker,
       a.name,
       a.date,
       a.open,
       a.high,
       a.low,
       a.close,
       a.volume,
       rank() over (order by a.date desc) as rank,
       a.logo
from
    stock a
group by
    a.ticker
  );
[0m19:30:38.721640 [debug] [Thread-1 (]: Postgres adapter: Postgres error: column "a.id" must appear in the GROUP BY clause or be used in an aggregate function
LINE 9: select a.id,
               ^

[0m19:30:38.722635 [debug] [Thread-1 (]: On model.dbt_idx.stock_update_status: ROLLBACK
[0m19:30:38.725637 [debug] [Thread-1 (]: Timing info for model.dbt_idx.stock_update_status (execute): 19:30:38.668425 => 19:30:38.725637
[0m19:30:38.726635 [debug] [Thread-1 (]: On model.dbt_idx.stock_update_status: Close
[0m19:30:38.745170 [debug] [Thread-1 (]: Database Error in model stock_update_status (models\marts\stock\stock_update_status.sql)
  column "a.id" must appear in the GROUP BY clause or be used in an aggregate function
  LINE 9: select a.id,
                 ^
  compiled Code at target\run\dbt_idx\models\marts\stock\stock_update_status.sql
[0m19:30:38.746174 [error] [Thread-1 (]: 11 of 11 ERROR creating sql view model IDX-Schema.stock_update_status .......... [[31mERROR[0m in 0.09s]
[0m19:30:38.748203 [debug] [Thread-1 (]: Finished running node model.dbt_idx.stock_update_status
[0m19:30:38.750179 [debug] [MainThread]: Using postgres connection "master"
[0m19:30:38.751167 [debug] [MainThread]: On master: BEGIN
[0m19:30:38.752167 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m19:30:38.775690 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m19:30:38.776720 [debug] [MainThread]: On master: COMMIT
[0m19:30:38.777720 [debug] [MainThread]: Using postgres connection "master"
[0m19:30:38.778686 [debug] [MainThread]: On master: COMMIT
[0m19:30:38.780690 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m19:30:38.781727 [debug] [MainThread]: On master: Close
[0m19:30:38.782733 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:30:38.784737 [debug] [MainThread]: Connection 'list_IDX-Stock' was properly closed.
[0m19:30:38.786228 [debug] [MainThread]: Connection 'list_IDX-Stock_snapshots' was properly closed.
[0m19:30:38.786742 [debug] [MainThread]: Connection 'model.dbt_idx.stock_update_status' was properly closed.
[0m19:30:38.787732 [info ] [MainThread]: 
[0m19:30:38.788746 [info ] [MainThread]: Finished running 8 view models, 3 table models in 0 hours 0 minutes and 1.53 seconds (1.53s).
[0m19:30:38.792744 [debug] [MainThread]: Command end result
[0m19:30:38.825317 [info ] [MainThread]: 
[0m19:30:38.826249 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m19:30:38.828249 [info ] [MainThread]: 
[0m19:30:38.829260 [error] [MainThread]: [33mDatabase Error in model stock_update_status (models\marts\stock\stock_update_status.sql)[0m
[0m19:30:38.830262 [error] [MainThread]:   column "a.id" must appear in the GROUP BY clause or be used in an aggregate function
[0m19:30:38.831247 [error] [MainThread]:   LINE 9: select a.id,
[0m19:30:38.832249 [error] [MainThread]:                  ^
[0m19:30:38.833249 [error] [MainThread]:   compiled Code at target\run\dbt_idx\models\marts\stock\stock_update_status.sql
[0m19:30:38.834755 [info ] [MainThread]: 
[0m19:30:38.835775 [info ] [MainThread]: Done. PASS=10 WARN=0 ERROR=1 SKIP=0 TOTAL=11
[0m19:30:38.836767 [debug] [MainThread]: Command `dbt run` failed at 19:30:38.836767 after 2.06 seconds
[0m19:30:38.837762 [debug] [MainThread]: Flushing usage events


============================== 19:30:58.057835 | 68a7721a-c51c-4622-bbca-f0544958276d ==============================
[0m19:30:58.057835 [info ] [MainThread]: Running with dbt=1.6.1
[0m19:30:58.064809 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'D:\\00 Project\\00 My Project\\IdeaProjects\\Py-DBT-IDX', 'debug': 'False', 'version_check': 'True', 'log_path': 'D:\\00 Project\\00 My Project\\IdeaProjects\\Py-DBT-IDX\\logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'False'}
[0m19:30:58.213086 [info ] [MainThread]: Registered adapter: postgres=1.6.1
[0m19:30:58.223667 [debug] [MainThread]: checksum: efe19d9f5b93d1a98cc804fbfcdb6b3aced98b974af664946fee1cde8837deb7, vars: {}, profile: , target: , version: 1.6.1
[0m19:30:58.381383 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m19:30:58.382382 [debug] [MainThread]: Partial parsing: updated file: dbt_idx://models\marts\stock\stock_update_status.sql
[0m19:30:58.484526 [info ] [MainThread]: Found 11 models, 1 snapshot, 18 tests, 5 sources, 0 exposures, 0 metrics, 349 macros, 0 groups, 0 semantic models
[0m19:30:58.487445 [info ] [MainThread]: 
[0m19:30:58.488411 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m19:30:58.491411 [debug] [ThreadPool]: Acquiring new postgres connection 'list_IDX-Stock'
[0m19:30:58.500996 [debug] [ThreadPool]: Using postgres connection "list_IDX-Stock"
[0m19:30:58.502035 [debug] [ThreadPool]: On list_IDX-Stock: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "connection_name": "list_IDX-Stock"} */

    select distinct nspname from pg_namespace
  
[0m19:30:58.502993 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:30:58.530474 [debug] [ThreadPool]: SQL status: SELECT 12 in 0.0 seconds
[0m19:30:58.532476 [debug] [ThreadPool]: On list_IDX-Stock: Close
[0m19:30:58.536510 [debug] [ThreadPool]: Acquiring new postgres connection 'list_IDX-Stock_snapshots'
[0m19:30:58.543511 [debug] [ThreadPool]: Using postgres connection "list_IDX-Stock_snapshots"
[0m19:30:58.543511 [debug] [ThreadPool]: On list_IDX-Stock_snapshots: BEGIN
[0m19:30:58.544512 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:30:58.565119 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m19:30:58.565119 [debug] [ThreadPool]: Using postgres connection "list_IDX-Stock_snapshots"
[0m19:30:58.566153 [debug] [ThreadPool]: On list_IDX-Stock_snapshots: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "connection_name": "list_IDX-Stock_snapshots"} */
select
      'IDX-Stock' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'snapshots'
    union all
    select
      'IDX-Stock' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'snapshots'
    union all
    select
      'IDX-Stock' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'snapshots'
  
[0m19:30:58.570118 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.0 seconds
[0m19:30:58.572145 [debug] [ThreadPool]: On list_IDX-Stock_snapshots: ROLLBACK
[0m19:30:58.574117 [debug] [ThreadPool]: On list_IDX-Stock_snapshots: Close
[0m19:30:58.576122 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_IDX-Stock_snapshots, now list_IDX-Stock_IDX-Schema)
[0m19:30:58.579145 [debug] [ThreadPool]: Using postgres connection "list_IDX-Stock_IDX-Schema"
[0m19:30:58.580148 [debug] [ThreadPool]: On list_IDX-Stock_IDX-Schema: BEGIN
[0m19:30:58.581125 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:30:58.601926 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m19:30:58.601926 [debug] [ThreadPool]: Using postgres connection "list_IDX-Stock_IDX-Schema"
[0m19:30:58.602962 [debug] [ThreadPool]: On list_IDX-Stock_IDX-Schema: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "connection_name": "list_IDX-Stock_IDX-Schema"} */
select
      'IDX-Stock' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'IDX-Schema'
    union all
    select
      'IDX-Stock' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'IDX-Schema'
    union all
    select
      'IDX-Stock' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'IDX-Schema'
  
[0m19:30:58.606972 [debug] [ThreadPool]: SQL status: SELECT 16 in 0.0 seconds
[0m19:30:58.609003 [debug] [ThreadPool]: On list_IDX-Stock_IDX-Schema: ROLLBACK
[0m19:30:58.610972 [debug] [ThreadPool]: On list_IDX-Stock_IDX-Schema: Close
[0m19:30:58.619480 [debug] [MainThread]: Using postgres connection "master"
[0m19:30:58.620481 [debug] [MainThread]: On master: BEGIN
[0m19:30:58.621479 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:30:58.642034 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m19:30:58.642034 [debug] [MainThread]: Using postgres connection "master"
[0m19:30:58.643071 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m19:30:58.650032 [debug] [MainThread]: SQL status: SELECT 8 in 0.0 seconds
[0m19:30:58.653071 [debug] [MainThread]: On master: ROLLBACK
[0m19:30:58.655034 [debug] [MainThread]: Using postgres connection "master"
[0m19:30:58.656069 [debug] [MainThread]: On master: BEGIN
[0m19:30:58.660032 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m19:30:58.661056 [debug] [MainThread]: On master: COMMIT
[0m19:30:58.661056 [debug] [MainThread]: Using postgres connection "master"
[0m19:30:58.662071 [debug] [MainThread]: On master: COMMIT
[0m19:30:58.664072 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m19:30:58.664072 [debug] [MainThread]: On master: Close
[0m19:30:58.666075 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m19:30:58.667075 [info ] [MainThread]: 
[0m19:30:58.673069 [debug] [Thread-1 (]: Began running node model.dbt_idx.stg_eltool__company
[0m19:30:58.674591 [info ] [Thread-1 (]: 1 of 11 START sql view model IDX-Schema.stg_eltool__company .................... [RUN]
[0m19:30:58.676636 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.dbt_idx.stg_eltool__company'
[0m19:30:58.677611 [debug] [Thread-1 (]: Began compiling node model.dbt_idx.stg_eltool__company
[0m19:30:58.688599 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_idx.stg_eltool__company"
[0m19:30:58.695066 [debug] [Thread-1 (]: Timing info for model.dbt_idx.stg_eltool__company (compile): 19:30:58.678597 => 19:30:58.695066
[0m19:30:58.696075 [debug] [Thread-1 (]: Began executing node model.dbt_idx.stg_eltool__company
[0m19:30:58.753735 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_idx.stg_eltool__company"
[0m19:30:58.759700 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__company"
[0m19:30:58.760700 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__company: BEGIN
[0m19:30:58.761711 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m19:30:58.845199 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m19:30:58.846202 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__company"
[0m19:30:58.847210 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__company: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__company"} */

  create view "IDX-Stock"."IDX-Schema"."stg_eltool__company__dbt_tmp"
    
    
  as (
    with source as (select *
                from "IDX-Stock"."IDX-Schema"."ksql-company-stream"),
     renamed as (select id,
                        ticker,
                        name,
                        logo
                 from source)
select *
from renamed
  );
[0m19:30:58.852148 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m19:30:58.868917 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__company"
[0m19:30:58.870012 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__company: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__company"} */
alter table "IDX-Stock"."IDX-Schema"."stg_eltool__company" rename to "stg_eltool__company__dbt_backup"
[0m19:30:58.872865 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:30:58.877481 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__company"
[0m19:30:58.878092 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__company: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__company"} */
alter table "IDX-Stock"."IDX-Schema"."stg_eltool__company__dbt_tmp" rename to "stg_eltool__company"
[0m19:30:58.881037 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:30:58.913228 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__company: COMMIT
[0m19:30:58.914195 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__company"
[0m19:30:58.914195 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__company: COMMIT
[0m19:30:58.918781 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m19:30:58.936746 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__company"
[0m19:30:58.937827 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__company: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__company"} */
drop view if exists "IDX-Stock"."IDX-Schema"."stg_eltool__company__dbt_backup" cascade
[0m19:30:58.941786 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m19:30:58.943511 [debug] [Thread-1 (]: Timing info for model.dbt_idx.stg_eltool__company (execute): 19:30:58.696075 => 19:30:58.943511
[0m19:30:58.944105 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__company: Close
[0m19:30:58.946564 [info ] [Thread-1 (]: 1 of 11 OK created sql view model IDX-Schema.stg_eltool__company ............... [[32mCREATE VIEW[0m in 0.27s]
[0m19:30:58.948719 [debug] [Thread-1 (]: Finished running node model.dbt_idx.stg_eltool__company
[0m19:30:58.949716 [debug] [Thread-1 (]: Began running node model.dbt_idx.stg_eltool__customers
[0m19:30:58.951719 [info ] [Thread-1 (]: 2 of 11 START sql view model IDX-Schema.stg_eltool__customers .................. [RUN]
[0m19:30:58.952717 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_idx.stg_eltool__company, now model.dbt_idx.stg_eltool__customers)
[0m19:30:58.953715 [debug] [Thread-1 (]: Began compiling node model.dbt_idx.stg_eltool__customers
[0m19:30:58.957715 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_idx.stg_eltool__customers"
[0m19:30:58.963345 [debug] [Thread-1 (]: Timing info for model.dbt_idx.stg_eltool__customers (compile): 19:30:58.954713 => 19:30:58.963345
[0m19:30:58.964341 [debug] [Thread-1 (]: Began executing node model.dbt_idx.stg_eltool__customers
[0m19:30:58.969307 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_idx.stg_eltool__customers"
[0m19:30:58.975313 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__customers"
[0m19:30:58.976343 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__customers: BEGIN
[0m19:30:58.977309 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:30:58.997651 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m19:30:58.998658 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__customers"
[0m19:30:58.999640 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__customers: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__customers"} */

  create view "IDX-Stock"."IDX-Schema"."stg_eltool__customers__dbt_tmp"
    
    
  as (
    with source as (select *
                from "IDX-Stock"."IDX-Schema"."customers"),
     renamed as (select
                     customer_id,
                    'This is Dummy' as dummy
                 from source
                 where customer_id = 1234567890)
select *
from renamed
  );
[0m19:30:59.002624 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m19:30:59.007716 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__customers"
[0m19:30:59.007716 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__customers: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__customers"} */
alter table "IDX-Stock"."IDX-Schema"."stg_eltool__customers" rename to "stg_eltool__customers__dbt_backup"
[0m19:30:59.009676 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:30:59.013710 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__customers"
[0m19:30:59.013710 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__customers: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__customers"} */
alter table "IDX-Stock"."IDX-Schema"."stg_eltool__customers__dbt_tmp" rename to "stg_eltool__customers"
[0m19:30:59.016736 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:30:59.019291 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__customers: COMMIT
[0m19:30:59.019291 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__customers"
[0m19:30:59.020332 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__customers: COMMIT
[0m19:30:59.024319 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m19:30:59.027354 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__customers"
[0m19:30:59.028319 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__customers: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__customers"} */
drop view if exists "IDX-Stock"."IDX-Schema"."stg_eltool__customers__dbt_backup" cascade
[0m19:30:59.031324 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m19:30:59.033356 [debug] [Thread-1 (]: Timing info for model.dbt_idx.stg_eltool__customers (execute): 19:30:58.965341 => 19:30:59.033356
[0m19:30:59.034354 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__customers: Close
[0m19:30:59.036322 [info ] [Thread-1 (]: 2 of 11 OK created sql view model IDX-Schema.stg_eltool__customers ............. [[32mCREATE VIEW[0m in 0.08s]
[0m19:30:59.038323 [debug] [Thread-1 (]: Finished running node model.dbt_idx.stg_eltool__customers
[0m19:30:59.039319 [debug] [Thread-1 (]: Began running node model.dbt_idx.stg_eltool__customers_snapshots
[0m19:30:59.040319 [info ] [Thread-1 (]: 3 of 11 START sql view model IDX-Schema.stg_eltool__customers_snapshots ........ [RUN]
[0m19:30:59.041327 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_idx.stg_eltool__customers, now model.dbt_idx.stg_eltool__customers_snapshots)
[0m19:30:59.042323 [debug] [Thread-1 (]: Began compiling node model.dbt_idx.stg_eltool__customers_snapshots
[0m19:30:59.045358 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_idx.stg_eltool__customers_snapshots"
[0m19:30:59.051354 [debug] [Thread-1 (]: Timing info for model.dbt_idx.stg_eltool__customers_snapshots (compile): 19:30:59.042323 => 19:30:59.051354
[0m19:30:59.052322 [debug] [Thread-1 (]: Began executing node model.dbt_idx.stg_eltool__customers_snapshots
[0m19:30:59.059318 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_idx.stg_eltool__customers_snapshots"
[0m19:30:59.065236 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__customers_snapshots"
[0m19:30:59.066237 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__customers_snapshots: BEGIN
[0m19:30:59.066237 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:30:59.087557 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m19:30:59.088557 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__customers_snapshots"
[0m19:30:59.088557 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__customers_snapshots: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__customers_snapshots"} */

  create view "IDX-Stock"."IDX-Schema"."stg_eltool__customers_snapshots__dbt_tmp"
    
    
  as (
    with source as (select *
                from "IDX-Stock"."snapshots"."customers_snapshot"),
     renamed as (select customer_id,
                        zipcode,
                        city,
                        state_code,
                        datetime_created::TIMESTAMP AS datetime_created,
                        datetime_updated::TIMESTAMP AS datetime_updated,
                        dbt_valid_from,
                        dbt_valid_to
                 from source)
select *
from renamed
  );
[0m19:30:59.092558 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m19:30:59.096558 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__customers_snapshots"
[0m19:30:59.096558 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__customers_snapshots: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__customers_snapshots"} */
alter table "IDX-Stock"."IDX-Schema"."stg_eltool__customers_snapshots" rename to "stg_eltool__customers_snapshots__dbt_backup"
[0m19:30:59.099556 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:30:59.103556 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__customers_snapshots"
[0m19:30:59.104561 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__customers_snapshots: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__customers_snapshots"} */
alter table "IDX-Stock"."IDX-Schema"."stg_eltool__customers_snapshots__dbt_tmp" rename to "stg_eltool__customers_snapshots"
[0m19:30:59.106562 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:30:59.109597 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__customers_snapshots: COMMIT
[0m19:30:59.109597 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__customers_snapshots"
[0m19:30:59.110597 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__customers_snapshots: COMMIT
[0m19:30:59.115770 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m19:30:59.118786 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__customers_snapshots"
[0m19:30:59.119319 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__customers_snapshots: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__customers_snapshots"} */
drop view if exists "IDX-Stock"."IDX-Schema"."stg_eltool__customers_snapshots__dbt_backup" cascade
[0m19:30:59.123327 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m19:30:59.125326 [debug] [Thread-1 (]: Timing info for model.dbt_idx.stg_eltool__customers_snapshots (execute): 19:30:59.053321 => 19:30:59.125326
[0m19:30:59.126353 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__customers_snapshots: Close
[0m19:30:59.128357 [info ] [Thread-1 (]: 3 of 11 OK created sql view model IDX-Schema.stg_eltool__customers_snapshots ... [[32mCREATE VIEW[0m in 0.09s]
[0m19:30:59.129340 [debug] [Thread-1 (]: Finished running node model.dbt_idx.stg_eltool__customers_snapshots
[0m19:30:59.131329 [debug] [Thread-1 (]: Began running node model.dbt_idx.stg_eltool__orders
[0m19:30:59.132333 [info ] [Thread-1 (]: 4 of 11 START sql view model IDX-Schema.stg_eltool__orders ..................... [RUN]
[0m19:30:59.133331 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_idx.stg_eltool__customers_snapshots, now model.dbt_idx.stg_eltool__orders)
[0m19:30:59.134327 [debug] [Thread-1 (]: Began compiling node model.dbt_idx.stg_eltool__orders
[0m19:30:59.137349 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_idx.stg_eltool__orders"
[0m19:30:59.148325 [debug] [Thread-1 (]: Timing info for model.dbt_idx.stg_eltool__orders (compile): 19:30:59.134327 => 19:30:59.147355
[0m19:30:59.149325 [debug] [Thread-1 (]: Began executing node model.dbt_idx.stg_eltool__orders
[0m19:30:59.154352 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_idx.stg_eltool__orders"
[0m19:30:59.165208 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__orders"
[0m19:30:59.166241 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__orders: BEGIN
[0m19:30:59.166241 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:30:59.189218 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m19:30:59.190204 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__orders"
[0m19:30:59.191236 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__orders: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__orders"} */

  create view "IDX-Stock"."IDX-Schema"."stg_eltool__orders__dbt_tmp"
    
    
  as (
    with source as (select *
                from "IDX-Stock"."IDX-Schema"."orders"),
     renamed as (select order_id,
                        cust_id AS customer_id,
                        order_status,
                        order_purchase_timestamp::TIMESTAMP,
                        order_approved_at::TIMESTAMP,
                        order_delivered_carrier_date::TIMESTAMP,
                        order_delivered_customer_date::TIMESTAMP,
                        order_estimated_delivery_date::TIMESTAMP
                 from source)
select *
from renamed
  );
[0m19:30:59.195194 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m19:30:59.199240 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__orders"
[0m19:30:59.199240 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__orders: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__orders"} */
alter table "IDX-Stock"."IDX-Schema"."stg_eltool__orders" rename to "stg_eltool__orders__dbt_backup"
[0m19:30:59.202872 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:30:59.205890 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__orders"
[0m19:30:59.206890 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__orders: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__orders"} */
alter table "IDX-Stock"."IDX-Schema"."stg_eltool__orders__dbt_tmp" rename to "stg_eltool__orders"
[0m19:30:59.208928 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:30:59.211890 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__orders: COMMIT
[0m19:30:59.211890 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__orders"
[0m19:30:59.212890 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__orders: COMMIT
[0m19:30:59.215891 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m19:30:59.219395 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__orders"
[0m19:30:59.220401 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__orders: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__orders"} */
drop view if exists "IDX-Stock"."IDX-Schema"."stg_eltool__orders__dbt_backup" cascade
[0m19:30:59.223913 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m19:30:59.225913 [debug] [Thread-1 (]: Timing info for model.dbt_idx.stg_eltool__orders (execute): 19:30:59.149325 => 19:30:59.225913
[0m19:30:59.226939 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__orders: Close
[0m19:30:59.227914 [info ] [Thread-1 (]: 4 of 11 OK created sql view model IDX-Schema.stg_eltool__orders ................ [[32mCREATE VIEW[0m in 0.09s]
[0m19:30:59.229915 [debug] [Thread-1 (]: Finished running node model.dbt_idx.stg_eltool__orders
[0m19:30:59.231911 [debug] [Thread-1 (]: Began running node model.dbt_idx.stg_eltool__state
[0m19:30:59.232914 [info ] [Thread-1 (]: 5 of 11 START sql view model IDX-Schema.stg_eltool__state ...................... [RUN]
[0m19:30:59.235914 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_idx.stg_eltool__orders, now model.dbt_idx.stg_eltool__state)
[0m19:30:59.235914 [debug] [Thread-1 (]: Began compiling node model.dbt_idx.stg_eltool__state
[0m19:30:59.241919 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_idx.stg_eltool__state"
[0m19:30:59.249914 [debug] [Thread-1 (]: Timing info for model.dbt_idx.stg_eltool__state (compile): 19:30:59.236953 => 19:30:59.248932
[0m19:30:59.250913 [debug] [Thread-1 (]: Began executing node model.dbt_idx.stg_eltool__state
[0m19:30:59.255949 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_idx.stg_eltool__state"
[0m19:30:59.261489 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__state"
[0m19:30:59.262433 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__state: BEGIN
[0m19:30:59.262433 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:30:59.286106 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m19:30:59.287114 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__state"
[0m19:30:59.287114 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__state: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__state"} */

  create view "IDX-Stock"."IDX-Schema"."stg_eltool__state__dbt_tmp"
    
    
  as (
    with source as (select *
                from "IDX-Stock"."IDX-Schema"."state"),
     renamed as (select state_identifier::INT AS state_id,
                         state_code::VARCHAR(2) AS state_code,
                         st_name::VARCHAR(30) AS state_name
                 from source)
select *
from renamed
  );
[0m19:30:59.290746 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m19:30:59.294765 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__state"
[0m19:30:59.295732 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__state: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__state"} */
alter table "IDX-Stock"."IDX-Schema"."stg_eltool__state" rename to "stg_eltool__state__dbt_backup"
[0m19:30:59.297614 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:30:59.301660 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__state"
[0m19:30:59.301660 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__state: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__state"} */
alter table "IDX-Stock"."IDX-Schema"."stg_eltool__state__dbt_tmp" rename to "stg_eltool__state"
[0m19:30:59.303626 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:30:59.306668 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__state: COMMIT
[0m19:30:59.306668 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__state"
[0m19:30:59.307667 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__state: COMMIT
[0m19:30:59.310667 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m19:30:59.316633 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__state"
[0m19:30:59.317712 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__state: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__state"} */
drop view if exists "IDX-Stock"."IDX-Schema"."stg_eltool__state__dbt_backup" cascade
[0m19:30:59.322413 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m19:30:59.324432 [debug] [Thread-1 (]: Timing info for model.dbt_idx.stg_eltool__state (execute): 19:30:59.250913 => 19:30:59.323407
[0m19:30:59.324432 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__state: Close
[0m19:30:59.326406 [info ] [Thread-1 (]: 5 of 11 OK created sql view model IDX-Schema.stg_eltool__state ................. [[32mCREATE VIEW[0m in 0.09s]
[0m19:30:59.329426 [debug] [Thread-1 (]: Finished running node model.dbt_idx.stg_eltool__state
[0m19:30:59.330410 [debug] [Thread-1 (]: Began running node model.dbt_idx.stg_eltool__stock
[0m19:30:59.332409 [info ] [Thread-1 (]: 6 of 11 START sql view model IDX-Schema.stg_eltool__stock ...................... [RUN]
[0m19:30:59.334408 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_idx.stg_eltool__state, now model.dbt_idx.stg_eltool__stock)
[0m19:30:59.335418 [debug] [Thread-1 (]: Began compiling node model.dbt_idx.stg_eltool__stock
[0m19:30:59.338407 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_idx.stg_eltool__stock"
[0m19:30:59.345407 [debug] [Thread-1 (]: Timing info for model.dbt_idx.stg_eltool__stock (compile): 19:30:59.335418 => 19:30:59.344408
[0m19:30:59.346411 [debug] [Thread-1 (]: Began executing node model.dbt_idx.stg_eltool__stock
[0m19:30:59.352442 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_idx.stg_eltool__stock"
[0m19:30:59.360444 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__stock"
[0m19:30:59.361440 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__stock: BEGIN
[0m19:30:59.362444 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:30:59.382246 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m19:30:59.383288 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__stock"
[0m19:30:59.384291 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__stock: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__stock"} */

  create view "IDX-Stock"."IDX-Schema"."stg_eltool__stock__dbt_tmp"
    
    
  as (
    with source as (select *
                from "IDX-Stock"."IDX-Schema"."ksql-stock-stream"),
     renamed as (select *
                 from source)
select *
from renamed
  );
[0m19:30:59.387739 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m19:30:59.393735 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__stock"
[0m19:30:59.394739 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__stock: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__stock"} */
alter table "IDX-Stock"."IDX-Schema"."stg_eltool__stock" rename to "stg_eltool__stock__dbt_backup"
[0m19:30:59.398738 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:30:59.403733 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__stock"
[0m19:30:59.405740 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__stock: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__stock"} */
alter table "IDX-Stock"."IDX-Schema"."stg_eltool__stock__dbt_tmp" rename to "stg_eltool__stock"
[0m19:30:59.407742 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:30:59.410754 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__stock: COMMIT
[0m19:30:59.411740 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__stock"
[0m19:30:59.412739 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__stock: COMMIT
[0m19:30:59.417129 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m19:30:59.420651 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__stock"
[0m19:30:59.421658 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__stock: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__stock"} */
drop view if exists "IDX-Stock"."IDX-Schema"."stg_eltool__stock__dbt_backup" cascade
[0m19:30:59.426574 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m19:30:59.428591 [debug] [Thread-1 (]: Timing info for model.dbt_idx.stg_eltool__stock (execute): 19:30:59.346411 => 19:30:59.428591
[0m19:30:59.429555 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__stock: Close
[0m19:30:59.432644 [info ] [Thread-1 (]: 6 of 11 OK created sql view model IDX-Schema.stg_eltool__stock ................. [[32mCREATE VIEW[0m in 0.10s]
[0m19:30:59.434699 [debug] [Thread-1 (]: Finished running node model.dbt_idx.stg_eltool__stock
[0m19:30:59.435656 [debug] [Thread-1 (]: Began running node model.dbt_idx.fact_orders
[0m19:30:59.437674 [info ] [Thread-1 (]: 7 of 11 START sql table model IDX-Schema.fact_orders ........................... [RUN]
[0m19:30:59.439645 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_idx.stg_eltool__stock, now model.dbt_idx.fact_orders)
[0m19:30:59.441394 [debug] [Thread-1 (]: Began compiling node model.dbt_idx.fact_orders
[0m19:30:59.446405 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_idx.fact_orders"
[0m19:30:59.456014 [debug] [Thread-1 (]: Timing info for model.dbt_idx.fact_orders (compile): 19:30:59.442401 => 19:30:59.456014
[0m19:30:59.458027 [debug] [Thread-1 (]: Began executing node model.dbt_idx.fact_orders
[0m19:30:59.484043 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_idx.fact_orders"
[0m19:30:59.492758 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.fact_orders"
[0m19:30:59.493758 [debug] [Thread-1 (]: On model.dbt_idx.fact_orders: BEGIN
[0m19:30:59.494769 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:30:59.514765 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m19:30:59.515789 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.fact_orders"
[0m19:30:59.516792 [debug] [Thread-1 (]: On model.dbt_idx.fact_orders: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.fact_orders"} */

  
    

  create  table "IDX-Stock"."IDX-Schema"."fact_orders__dbt_tmp"
  
  
    as
  
  (
    with orders as (
    select *
    from "IDX-Stock"."IDX-Schema"."stg_eltool__orders"
)
select * from orders
  );
  
[0m19:30:59.522314 [debug] [Thread-1 (]: SQL status: SELECT 999 in 0.0 seconds
[0m19:30:59.526305 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.fact_orders"
[0m19:30:59.527300 [debug] [Thread-1 (]: On model.dbt_idx.fact_orders: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.fact_orders"} */
alter table "IDX-Stock"."IDX-Schema"."fact_orders" rename to "fact_orders__dbt_backup"
[0m19:30:59.529298 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:30:59.533324 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.fact_orders"
[0m19:30:59.533324 [debug] [Thread-1 (]: On model.dbt_idx.fact_orders: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.fact_orders"} */
alter table "IDX-Stock"."IDX-Schema"."fact_orders__dbt_tmp" rename to "fact_orders"
[0m19:30:59.535322 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:30:59.542300 [debug] [Thread-1 (]: On model.dbt_idx.fact_orders: COMMIT
[0m19:30:59.542300 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.fact_orders"
[0m19:30:59.543300 [debug] [Thread-1 (]: On model.dbt_idx.fact_orders: COMMIT
[0m19:30:59.547298 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m19:30:59.552323 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.fact_orders"
[0m19:30:59.553300 [debug] [Thread-1 (]: On model.dbt_idx.fact_orders: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.fact_orders"} */
drop table if exists "IDX-Stock"."IDX-Schema"."fact_orders__dbt_backup" cascade
[0m19:30:59.559146 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m19:30:59.561170 [debug] [Thread-1 (]: Timing info for model.dbt_idx.fact_orders (execute): 19:30:59.459045 => 19:30:59.561170
[0m19:30:59.562171 [debug] [Thread-1 (]: On model.dbt_idx.fact_orders: Close
[0m19:30:59.564148 [info ] [Thread-1 (]: 7 of 11 OK created sql table model IDX-Schema.fact_orders ...................... [[32mSELECT 999[0m in 0.12s]
[0m19:30:59.566144 [debug] [Thread-1 (]: Finished running node model.dbt_idx.fact_orders
[0m19:30:59.567146 [debug] [Thread-1 (]: Began running node model.dbt_idx.dim_customers
[0m19:30:59.568144 [info ] [Thread-1 (]: 8 of 11 START sql table model IDX-Schema.dim_customers ......................... [RUN]
[0m19:30:59.569146 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_idx.fact_orders, now model.dbt_idx.dim_customers)
[0m19:30:59.570145 [debug] [Thread-1 (]: Began compiling node model.dbt_idx.dim_customers
[0m19:30:59.574145 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_idx.dim_customers"
[0m19:30:59.581601 [debug] [Thread-1 (]: Timing info for model.dbt_idx.dim_customers (compile): 19:30:59.570145 => 19:30:59.581601
[0m19:30:59.582622 [debug] [Thread-1 (]: Began executing node model.dbt_idx.dim_customers
[0m19:30:59.589567 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_idx.dim_customers"
[0m19:30:59.596573 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.dim_customers"
[0m19:30:59.597569 [debug] [Thread-1 (]: On model.dbt_idx.dim_customers: BEGIN
[0m19:30:59.598574 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:30:59.619291 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m19:30:59.620353 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.dim_customers"
[0m19:30:59.621336 [debug] [Thread-1 (]: On model.dbt_idx.dim_customers: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.dim_customers"} */

  
    

  create  table "IDX-Stock"."IDX-Schema"."dim_customers__dbt_tmp"
  
  
    as
  
  (
    -- noinspection SqlDialectInspectionForFile

with customers as (
    select *
    from "IDX-Stock"."IDX-Schema"."stg_eltool__customers_snapshots"
    ),
     state as (
         select *
         from "IDX-Stock"."IDX-Schema"."stg_eltool__state"
     )
select c.customer_id,
       c.zipcode,
       c.city,
       c.state_code,
       s.state_name,
       c.datetime_created,
       c.datetime_updated,
       c.dbt_valid_from::TIMESTAMP as valid_from,
        CASE WHEN c.dbt_valid_to IS NULL
            THEN '9999-12-31'::TIMESTAMP
            ELSE c.dbt_valid_to::TIMESTAMP
        END as valid_to
from customers c
    join state s on c.state_code = s.state_code
  );
  
[0m19:30:59.625336 [debug] [Thread-1 (]: SQL status: SELECT 100 in 0.0 seconds
[0m19:30:59.629361 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.dim_customers"
[0m19:30:59.629361 [debug] [Thread-1 (]: On model.dbt_idx.dim_customers: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.dim_customers"} */
alter table "IDX-Stock"."IDX-Schema"."dim_customers" rename to "dim_customers__dbt_backup"
[0m19:30:59.632334 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:30:59.672966 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.dim_customers"
[0m19:30:59.673966 [debug] [Thread-1 (]: On model.dbt_idx.dim_customers: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.dim_customers"} */
alter table "IDX-Stock"."IDX-Schema"."dim_customers__dbt_tmp" rename to "dim_customers"
[0m19:30:59.675963 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:30:59.678998 [debug] [Thread-1 (]: On model.dbt_idx.dim_customers: COMMIT
[0m19:30:59.679998 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.dim_customers"
[0m19:30:59.680964 [debug] [Thread-1 (]: On model.dbt_idx.dim_customers: COMMIT
[0m19:30:59.684179 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m19:30:59.687406 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.dim_customers"
[0m19:30:59.688406 [debug] [Thread-1 (]: On model.dbt_idx.dim_customers: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.dim_customers"} */
drop table if exists "IDX-Stock"."IDX-Schema"."dim_customers__dbt_backup" cascade
[0m19:30:59.692410 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m19:30:59.694407 [debug] [Thread-1 (]: Timing info for model.dbt_idx.dim_customers (execute): 19:30:59.583567 => 19:30:59.694407
[0m19:30:59.695418 [debug] [Thread-1 (]: On model.dbt_idx.dim_customers: Close
[0m19:30:59.697408 [info ] [Thread-1 (]: 8 of 11 OK created sql table model IDX-Schema.dim_customers .................... [[32mSELECT 100[0m in 0.13s]
[0m19:30:59.699412 [debug] [Thread-1 (]: Finished running node model.dbt_idx.dim_customers
[0m19:30:59.700422 [debug] [Thread-1 (]: Began running node model.dbt_idx.fact_stocks
[0m19:30:59.701406 [info ] [Thread-1 (]: 9 of 11 START sql table model IDX-Schema.fact_stocks ........................... [RUN]
[0m19:30:59.703408 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_idx.dim_customers, now model.dbt_idx.fact_stocks)
[0m19:30:59.704407 [debug] [Thread-1 (]: Began compiling node model.dbt_idx.fact_stocks
[0m19:30:59.707413 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_idx.fact_stocks"
[0m19:30:59.713464 [debug] [Thread-1 (]: Timing info for model.dbt_idx.fact_stocks (compile): 19:30:59.705422 => 19:30:59.713464
[0m19:30:59.714463 [debug] [Thread-1 (]: Began executing node model.dbt_idx.fact_stocks
[0m19:30:59.720002 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_idx.fact_stocks"
[0m19:30:59.726279 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.fact_stocks"
[0m19:30:59.727272 [debug] [Thread-1 (]: On model.dbt_idx.fact_stocks: BEGIN
[0m19:30:59.728231 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:30:59.748810 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m19:30:59.749810 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.fact_stocks"
[0m19:30:59.750812 [debug] [Thread-1 (]: On model.dbt_idx.fact_stocks: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.fact_stocks"} */

  
    

  create  table "IDX-Stock"."IDX-Schema"."fact_stocks__dbt_tmp"
  
  
    as
  
  (
    -- noinspection SqlDialectInspectionForFile

with stock as (
    select *
    from "IDX-Stock"."IDX-Schema"."stg_eltool__stock"
    ),
     company as (
         select *
         from "IDX-Stock"."IDX-Schema"."stg_eltool__company"
     )
select a.id,
       a.ticker,
       b.name,
       a.date,
       a.open,
       a.high,
       a.low,
       a.close,
       a.volume,
       b.logo
from stock a
    join company b on a.ticker = b.ticker
  );
  
[0m19:30:59.790398 [debug] [Thread-1 (]: SQL status: SELECT 26131 in 0.0 seconds
[0m19:30:59.793409 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.fact_stocks"
[0m19:30:59.794410 [debug] [Thread-1 (]: On model.dbt_idx.fact_stocks: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.fact_stocks"} */
alter table "IDX-Stock"."IDX-Schema"."fact_stocks" rename to "fact_stocks__dbt_backup"
[0m19:30:59.796970 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:30:59.800976 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.fact_stocks"
[0m19:30:59.801978 [debug] [Thread-1 (]: On model.dbt_idx.fact_stocks: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.fact_stocks"} */
alter table "IDX-Stock"."IDX-Schema"."fact_stocks__dbt_tmp" rename to "fact_stocks"
[0m19:30:59.804374 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:30:59.807415 [debug] [Thread-1 (]: On model.dbt_idx.fact_stocks: COMMIT
[0m19:30:59.808385 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.fact_stocks"
[0m19:30:59.808385 [debug] [Thread-1 (]: On model.dbt_idx.fact_stocks: COMMIT
[0m19:30:59.817402 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m19:30:59.822450 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.fact_stocks"
[0m19:30:59.823449 [debug] [Thread-1 (]: On model.dbt_idx.fact_stocks: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.fact_stocks"} */
drop table if exists "IDX-Stock"."IDX-Schema"."fact_stocks__dbt_backup" cascade
[0m19:30:59.828299 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m19:30:59.830310 [debug] [Thread-1 (]: Timing info for model.dbt_idx.fact_stocks (execute): 19:30:59.715438 => 19:30:59.829310
[0m19:30:59.831309 [debug] [Thread-1 (]: On model.dbt_idx.fact_stocks: Close
[0m19:30:59.832311 [info ] [Thread-1 (]: 9 of 11 OK created sql table model IDX-Schema.fact_stocks ...................... [[32mSELECT 26131[0m in 0.13s]
[0m19:30:59.834318 [debug] [Thread-1 (]: Finished running node model.dbt_idx.fact_stocks
[0m19:30:59.835309 [debug] [Thread-1 (]: Began running node model.dbt_idx.customer_orders_status
[0m19:30:59.836313 [info ] [Thread-1 (]: 10 of 11 START sql view model IDX-Schema.customer_orders_status ................ [RUN]
[0m19:30:59.837310 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_idx.fact_stocks, now model.dbt_idx.customer_orders_status)
[0m19:30:59.838387 [debug] [Thread-1 (]: Began compiling node model.dbt_idx.customer_orders_status
[0m19:30:59.841344 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_idx.customer_orders_status"
[0m19:30:59.849313 [debug] [Thread-1 (]: Timing info for model.dbt_idx.customer_orders_status (compile): 19:30:59.839311 => 19:30:59.848322
[0m19:30:59.850312 [debug] [Thread-1 (]: Began executing node model.dbt_idx.customer_orders_status
[0m19:30:59.855344 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_idx.customer_orders_status"
[0m19:30:59.861346 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.customer_orders_status"
[0m19:30:59.862311 [debug] [Thread-1 (]: On model.dbt_idx.customer_orders_status: BEGIN
[0m19:30:59.863312 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:30:59.885316 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m19:30:59.886312 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.customer_orders_status"
[0m19:30:59.887333 [debug] [Thread-1 (]: On model.dbt_idx.customer_orders_status: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.customer_orders_status"} */

  create view "IDX-Stock"."IDX-Schema"."customer_orders_status__dbt_tmp"
    
    
  as (
    with orders as (select *
                from "IDX-Stock"."IDX-Schema"."fact_orders"),
     customers as (select *
                   from "IDX-Stock"."IDX-Schema"."dim_customers")
select o.order_id,
       o.customer_id,
       o.order_status,
       o.order_purchase_timestamp,
       o.order_approved_at,
       o.order_delivered_carrier_date,
       o.order_delivered_customer_date,
       o.order_estimated_delivery_date,
       c.zipcode    as customer_zipcode,
       c.city       as customer_city,
       c.state_code as customer_state_code,
       c.state_name as customer_state_name
from orders o
    join customers c on o.customer_id = c.customer_id
    and o.order_purchase_timestamp >= c.valid_from
    and o.order_purchase_timestamp <= c.valid_to
  );
[0m19:30:59.892310 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m19:30:59.895335 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.customer_orders_status"
[0m19:30:59.896309 [debug] [Thread-1 (]: On model.dbt_idx.customer_orders_status: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.customer_orders_status"} */
alter table "IDX-Stock"."IDX-Schema"."customer_orders_status__dbt_tmp" rename to "customer_orders_status"
[0m19:30:59.898311 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:30:59.900347 [debug] [Thread-1 (]: On model.dbt_idx.customer_orders_status: COMMIT
[0m19:30:59.901366 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.customer_orders_status"
[0m19:30:59.901366 [debug] [Thread-1 (]: On model.dbt_idx.customer_orders_status: COMMIT
[0m19:30:59.906361 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m19:30:59.909378 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.customer_orders_status"
[0m19:30:59.910344 [debug] [Thread-1 (]: On model.dbt_idx.customer_orders_status: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.customer_orders_status"} */
drop view if exists "IDX-Stock"."IDX-Schema"."customer_orders_status__dbt_backup" cascade
[0m19:30:59.912346 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m19:30:59.914380 [debug] [Thread-1 (]: Timing info for model.dbt_idx.customer_orders_status (execute): 19:30:59.851365 => 19:30:59.913356
[0m19:30:59.914380 [debug] [Thread-1 (]: On model.dbt_idx.customer_orders_status: Close
[0m19:30:59.916349 [info ] [Thread-1 (]: 10 of 11 OK created sql view model IDX-Schema.customer_orders_status ........... [[32mCREATE VIEW[0m in 0.08s]
[0m19:30:59.918345 [debug] [Thread-1 (]: Finished running node model.dbt_idx.customer_orders_status
[0m19:30:59.919359 [debug] [Thread-1 (]: Began running node model.dbt_idx.stock_update_status
[0m19:30:59.920532 [info ] [Thread-1 (]: 11 of 11 START sql view model IDX-Schema.stock_update_status ................... [RUN]
[0m19:30:59.921532 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_idx.customer_orders_status, now model.dbt_idx.stock_update_status)
[0m19:30:59.922563 [debug] [Thread-1 (]: Began compiling node model.dbt_idx.stock_update_status
[0m19:30:59.925553 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_idx.stock_update_status"
[0m19:30:59.931291 [debug] [Thread-1 (]: Timing info for model.dbt_idx.stock_update_status (compile): 19:30:59.923564 => 19:30:59.931291
[0m19:30:59.932283 [debug] [Thread-1 (]: Began executing node model.dbt_idx.stock_update_status
[0m19:30:59.938292 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_idx.stock_update_status"
[0m19:30:59.945295 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stock_update_status"
[0m19:30:59.946294 [debug] [Thread-1 (]: On model.dbt_idx.stock_update_status: BEGIN
[0m19:30:59.947257 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:30:59.967158 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m19:30:59.968194 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stock_update_status"
[0m19:30:59.969192 [debug] [Thread-1 (]: On model.dbt_idx.stock_update_status: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stock_update_status"} */

  create view "IDX-Stock"."IDX-Schema"."stock_update_status__dbt_tmp"
    
    
  as (
    with stock as (select *
               from "IDX-Stock"."IDX-Schema"."fact_stocks")
select a.id,
       a.ticker,
       a.name,
       a.date,
       a.open,
       a.high,
       a.low,
       a.close,
       a.volume,
       rank() over (order by a.date desc) as rank,
       a.logo
from
    stock a
group by
    a.id
  );
[0m19:30:59.972161 [debug] [Thread-1 (]: Postgres adapter: Postgres error: column "a.ticker" must appear in the GROUP BY clause or be used in an aggregate function
LINE 10:        a.ticker,
                ^

[0m19:30:59.973156 [debug] [Thread-1 (]: On model.dbt_idx.stock_update_status: ROLLBACK
[0m19:30:59.975155 [debug] [Thread-1 (]: Timing info for model.dbt_idx.stock_update_status (execute): 19:30:59.933278 => 19:30:59.975155
[0m19:30:59.976156 [debug] [Thread-1 (]: On model.dbt_idx.stock_update_status: Close
[0m19:30:59.988376 [debug] [Thread-1 (]: Database Error in model stock_update_status (models\marts\stock\stock_update_status.sql)
  column "a.ticker" must appear in the GROUP BY clause or be used in an aggregate function
  LINE 10:        a.ticker,
                  ^
  compiled Code at target\run\dbt_idx\models\marts\stock\stock_update_status.sql
[0m19:30:59.989374 [error] [Thread-1 (]: 11 of 11 ERROR creating sql view model IDX-Schema.stock_update_status .......... [[31mERROR[0m in 0.07s]
[0m19:30:59.991348 [debug] [Thread-1 (]: Finished running node model.dbt_idx.stock_update_status
[0m19:30:59.993276 [debug] [MainThread]: Using postgres connection "master"
[0m19:30:59.993276 [debug] [MainThread]: On master: BEGIN
[0m19:30:59.994284 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m19:31:00.018396 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m19:31:00.019426 [debug] [MainThread]: On master: COMMIT
[0m19:31:00.020740 [debug] [MainThread]: Using postgres connection "master"
[0m19:31:00.021758 [debug] [MainThread]: On master: COMMIT
[0m19:31:00.024774 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m19:31:00.025791 [debug] [MainThread]: On master: Close
[0m19:31:00.028745 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:31:00.029748 [debug] [MainThread]: Connection 'list_IDX-Stock' was properly closed.
[0m19:31:00.031754 [debug] [MainThread]: Connection 'list_IDX-Stock_IDX-Schema' was properly closed.
[0m19:31:00.032742 [debug] [MainThread]: Connection 'model.dbt_idx.stock_update_status' was properly closed.
[0m19:31:00.033742 [info ] [MainThread]: 
[0m19:31:00.034739 [info ] [MainThread]: Finished running 8 view models, 3 table models in 0 hours 0 minutes and 1.54 seconds (1.54s).
[0m19:31:00.037783 [debug] [MainThread]: Command end result
[0m19:31:00.067742 [info ] [MainThread]: 
[0m19:31:00.069761 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m19:31:00.070747 [info ] [MainThread]: 
[0m19:31:00.071777 [error] [MainThread]: [33mDatabase Error in model stock_update_status (models\marts\stock\stock_update_status.sql)[0m
[0m19:31:00.073741 [error] [MainThread]:   column "a.ticker" must appear in the GROUP BY clause or be used in an aggregate function
[0m19:31:00.074759 [error] [MainThread]:   LINE 10:        a.ticker,
[0m19:31:00.075742 [error] [MainThread]:                   ^
[0m19:31:00.076751 [error] [MainThread]:   compiled Code at target\run\dbt_idx\models\marts\stock\stock_update_status.sql
[0m19:31:00.077739 [info ] [MainThread]: 
[0m19:31:00.078739 [info ] [MainThread]: Done. PASS=10 WARN=0 ERROR=1 SKIP=0 TOTAL=11
[0m19:31:00.080743 [debug] [MainThread]: Command `dbt run` failed at 19:31:00.080743 after 2.06 seconds
[0m19:31:00.081750 [debug] [MainThread]: Flushing usage events


============================== 19:35:15.679588 | fca347cc-b858-4501-90eb-831dd000f117 ==============================
[0m19:35:15.679588 [info ] [MainThread]: Running with dbt=1.6.1
[0m19:35:15.684575 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'D:\\00 Project\\00 My Project\\IdeaProjects\\Py-DBT-IDX', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': 'D:\\00 Project\\00 My Project\\IdeaProjects\\Py-DBT-IDX\\logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'False'}
[0m19:35:15.828787 [info ] [MainThread]: Registered adapter: postgres=1.6.1
[0m19:35:15.838749 [debug] [MainThread]: checksum: efe19d9f5b93d1a98cc804fbfcdb6b3aced98b974af664946fee1cde8837deb7, vars: {}, profile: , target: , version: 1.6.1
[0m19:35:16.010298 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m19:35:16.011300 [debug] [MainThread]: Partial parsing: updated file: dbt_idx://models\marts\stock\stock_update_status.sql
[0m19:35:16.121037 [info ] [MainThread]: Found 11 models, 1 snapshot, 18 tests, 5 sources, 0 exposures, 0 metrics, 349 macros, 0 groups, 0 semantic models
[0m19:35:16.124072 [info ] [MainThread]: 
[0m19:35:16.126036 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m19:35:16.130037 [debug] [ThreadPool]: Acquiring new postgres connection 'list_IDX-Stock'
[0m19:35:16.140075 [debug] [ThreadPool]: Using postgres connection "list_IDX-Stock"
[0m19:35:16.141038 [debug] [ThreadPool]: On list_IDX-Stock: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "connection_name": "list_IDX-Stock"} */

    select distinct nspname from pg_namespace
  
[0m19:35:16.142074 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:35:16.171162 [debug] [ThreadPool]: SQL status: SELECT 12 in 0.0 seconds
[0m19:35:16.172150 [debug] [ThreadPool]: On list_IDX-Stock: Close
[0m19:35:16.176155 [debug] [ThreadPool]: Acquiring new postgres connection 'list_IDX-Stock_IDX-Schema'
[0m19:35:16.183185 [debug] [ThreadPool]: Using postgres connection "list_IDX-Stock_IDX-Schema"
[0m19:35:16.184187 [debug] [ThreadPool]: On list_IDX-Stock_IDX-Schema: BEGIN
[0m19:35:16.185151 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:35:16.205204 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m19:35:16.206240 [debug] [ThreadPool]: Using postgres connection "list_IDX-Stock_IDX-Schema"
[0m19:35:16.207277 [debug] [ThreadPool]: On list_IDX-Stock_IDX-Schema: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "connection_name": "list_IDX-Stock_IDX-Schema"} */
select
      'IDX-Stock' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'IDX-Schema'
    union all
    select
      'IDX-Stock' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'IDX-Schema'
    union all
    select
      'IDX-Stock' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'IDX-Schema'
  
[0m19:35:16.211989 [debug] [ThreadPool]: SQL status: SELECT 16 in 0.0 seconds
[0m19:35:16.214024 [debug] [ThreadPool]: On list_IDX-Stock_IDX-Schema: ROLLBACK
[0m19:35:16.216014 [debug] [ThreadPool]: On list_IDX-Stock_IDX-Schema: Close
[0m19:35:16.217018 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_IDX-Stock_IDX-Schema, now list_IDX-Stock_snapshots)
[0m19:35:16.224270 [debug] [ThreadPool]: Using postgres connection "list_IDX-Stock_snapshots"
[0m19:35:16.225269 [debug] [ThreadPool]: On list_IDX-Stock_snapshots: BEGIN
[0m19:35:16.225269 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:35:16.246135 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m19:35:16.247136 [debug] [ThreadPool]: Using postgres connection "list_IDX-Stock_snapshots"
[0m19:35:16.248131 [debug] [ThreadPool]: On list_IDX-Stock_snapshots: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "connection_name": "list_IDX-Stock_snapshots"} */
select
      'IDX-Stock' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'snapshots'
    union all
    select
      'IDX-Stock' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'snapshots'
    union all
    select
      'IDX-Stock' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'snapshots'
  
[0m19:35:16.252135 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.0 seconds
[0m19:35:16.254132 [debug] [ThreadPool]: On list_IDX-Stock_snapshots: ROLLBACK
[0m19:35:16.256746 [debug] [ThreadPool]: On list_IDX-Stock_snapshots: Close
[0m19:35:16.265748 [debug] [MainThread]: Using postgres connection "master"
[0m19:35:16.266749 [debug] [MainThread]: On master: BEGIN
[0m19:35:16.266749 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:35:16.286713 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m19:35:16.287740 [debug] [MainThread]: Using postgres connection "master"
[0m19:35:16.288716 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m19:35:16.295707 [debug] [MainThread]: SQL status: SELECT 8 in 0.0 seconds
[0m19:35:16.299709 [debug] [MainThread]: On master: ROLLBACK
[0m19:35:16.301704 [debug] [MainThread]: Using postgres connection "master"
[0m19:35:16.301704 [debug] [MainThread]: On master: BEGIN
[0m19:35:16.305736 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m19:35:16.306773 [debug] [MainThread]: On master: COMMIT
[0m19:35:16.306773 [debug] [MainThread]: Using postgres connection "master"
[0m19:35:16.307793 [debug] [MainThread]: On master: COMMIT
[0m19:35:16.309716 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m19:35:16.309716 [debug] [MainThread]: On master: Close
[0m19:35:16.311738 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m19:35:16.313750 [info ] [MainThread]: 
[0m19:35:16.319258 [debug] [Thread-1 (]: Began running node model.dbt_idx.stg_eltool__company
[0m19:35:16.320263 [info ] [Thread-1 (]: 1 of 11 START sql view model IDX-Schema.stg_eltool__company .................... [RUN]
[0m19:35:16.322301 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.dbt_idx.stg_eltool__company'
[0m19:35:16.322301 [debug] [Thread-1 (]: Began compiling node model.dbt_idx.stg_eltool__company
[0m19:35:16.331301 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_idx.stg_eltool__company"
[0m19:35:16.337356 [debug] [Thread-1 (]: Timing info for model.dbt_idx.stg_eltool__company (compile): 19:35:16.323302 => 19:35:16.337356
[0m19:35:16.338348 [debug] [Thread-1 (]: Began executing node model.dbt_idx.stg_eltool__company
[0m19:35:16.374315 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_idx.stg_eltool__company"
[0m19:35:16.381314 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__company"
[0m19:35:16.382367 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__company: BEGIN
[0m19:35:16.382367 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m19:35:16.403802 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m19:35:16.404808 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__company"
[0m19:35:16.405823 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__company: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__company"} */

  create view "IDX-Stock"."IDX-Schema"."stg_eltool__company__dbt_tmp"
    
    
  as (
    with source as (select *
                from "IDX-Stock"."IDX-Schema"."ksql-company-stream"),
     renamed as (select id,
                        ticker,
                        name,
                        logo
                 from source)
select *
from renamed
  );
[0m19:35:16.409811 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m19:35:16.417833 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__company"
[0m19:35:16.419339 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__company: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__company"} */
alter table "IDX-Stock"."IDX-Schema"."stg_eltool__company" rename to "stg_eltool__company__dbt_backup"
[0m19:35:16.422345 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:35:16.427346 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__company"
[0m19:35:16.427346 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__company: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__company"} */
alter table "IDX-Stock"."IDX-Schema"."stg_eltool__company__dbt_tmp" rename to "stg_eltool__company"
[0m19:35:16.430331 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:35:16.448306 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__company: COMMIT
[0m19:35:16.448306 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__company"
[0m19:35:16.449306 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__company: COMMIT
[0m19:35:16.452886 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m19:35:16.461923 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__company"
[0m19:35:16.462892 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__company: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__company"} */
drop view if exists "IDX-Stock"."IDX-Schema"."stg_eltool__company__dbt_backup" cascade
[0m19:35:16.466887 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m19:35:16.468885 [debug] [Thread-1 (]: Timing info for model.dbt_idx.stg_eltool__company (execute): 19:35:16.339336 => 19:35:16.468885
[0m19:35:16.469884 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__company: Close
[0m19:35:16.471889 [info ] [Thread-1 (]: 1 of 11 OK created sql view model IDX-Schema.stg_eltool__company ............... [[32mCREATE VIEW[0m in 0.15s]
[0m19:35:16.474887 [debug] [Thread-1 (]: Finished running node model.dbt_idx.stg_eltool__company
[0m19:35:16.475885 [debug] [Thread-1 (]: Began running node model.dbt_idx.stg_eltool__customers
[0m19:35:16.476886 [info ] [Thread-1 (]: 2 of 11 START sql view model IDX-Schema.stg_eltool__customers .................. [RUN]
[0m19:35:16.477889 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_idx.stg_eltool__company, now model.dbt_idx.stg_eltool__customers)
[0m19:35:16.478888 [debug] [Thread-1 (]: Began compiling node model.dbt_idx.stg_eltool__customers
[0m19:35:16.481886 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_idx.stg_eltool__customers"
[0m19:35:16.488903 [debug] [Thread-1 (]: Timing info for model.dbt_idx.stg_eltool__customers (compile): 19:35:16.479944 => 19:35:16.488903
[0m19:35:16.489893 [debug] [Thread-1 (]: Began executing node model.dbt_idx.stg_eltool__customers
[0m19:35:16.493884 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_idx.stg_eltool__customers"
[0m19:35:16.500793 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__customers"
[0m19:35:16.501797 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__customers: BEGIN
[0m19:35:16.502782 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:35:16.523555 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m19:35:16.524557 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__customers"
[0m19:35:16.525557 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__customers: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__customers"} */

  create view "IDX-Stock"."IDX-Schema"."stg_eltool__customers__dbt_tmp"
    
    
  as (
    with source as (select *
                from "IDX-Stock"."IDX-Schema"."customers"),
     renamed as (select
                     customer_id,
                    'This is Dummy' as dummy
                 from source
                 where customer_id = 1234567890)
select *
from renamed
  );
[0m19:35:16.528569 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m19:35:16.533581 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__customers"
[0m19:35:16.533581 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__customers: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__customers"} */
alter table "IDX-Stock"."IDX-Schema"."stg_eltool__customers" rename to "stg_eltool__customers__dbt_backup"
[0m19:35:16.536556 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:35:16.539583 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__customers"
[0m19:35:16.540556 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__customers: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__customers"} */
alter table "IDX-Stock"."IDX-Schema"."stg_eltool__customers__dbt_tmp" rename to "stg_eltool__customers"
[0m19:35:16.542960 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:35:16.544971 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__customers: COMMIT
[0m19:35:16.545971 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__customers"
[0m19:35:16.546971 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__customers: COMMIT
[0m19:35:16.550169 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m19:35:16.554169 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__customers"
[0m19:35:16.555168 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__customers: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__customers"} */
drop view if exists "IDX-Stock"."IDX-Schema"."stg_eltool__customers__dbt_backup" cascade
[0m19:35:16.559168 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m19:35:16.561168 [debug] [Thread-1 (]: Timing info for model.dbt_idx.stg_eltool__customers (execute): 19:35:16.489893 => 19:35:16.561168
[0m19:35:16.562167 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__customers: Close
[0m19:35:16.564169 [info ] [Thread-1 (]: 2 of 11 OK created sql view model IDX-Schema.stg_eltool__customers ............. [[32mCREATE VIEW[0m in 0.09s]
[0m19:35:16.565169 [debug] [Thread-1 (]: Finished running node model.dbt_idx.stg_eltool__customers
[0m19:35:16.567171 [debug] [Thread-1 (]: Began running node model.dbt_idx.stg_eltool__customers_snapshots
[0m19:35:16.567171 [info ] [Thread-1 (]: 3 of 11 START sql view model IDX-Schema.stg_eltool__customers_snapshots ........ [RUN]
[0m19:35:16.568259 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_idx.stg_eltool__customers, now model.dbt_idx.stg_eltool__customers_snapshots)
[0m19:35:16.569270 [debug] [Thread-1 (]: Began compiling node model.dbt_idx.stg_eltool__customers_snapshots
[0m19:35:16.573275 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_idx.stg_eltool__customers_snapshots"
[0m19:35:16.579277 [debug] [Thread-1 (]: Timing info for model.dbt_idx.stg_eltool__customers_snapshots (compile): 19:35:16.570284 => 19:35:16.579277
[0m19:35:16.580280 [debug] [Thread-1 (]: Began executing node model.dbt_idx.stg_eltool__customers_snapshots
[0m19:35:16.586304 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_idx.stg_eltool__customers_snapshots"
[0m19:35:16.592289 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__customers_snapshots"
[0m19:35:16.593271 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__customers_snapshots: BEGIN
[0m19:35:16.593271 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:35:16.615532 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m19:35:16.616542 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__customers_snapshots"
[0m19:35:16.616542 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__customers_snapshots: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__customers_snapshots"} */

  create view "IDX-Stock"."IDX-Schema"."stg_eltool__customers_snapshots__dbt_tmp"
    
    
  as (
    with source as (select *
                from "IDX-Stock"."snapshots"."customers_snapshot"),
     renamed as (select customer_id,
                        zipcode,
                        city,
                        state_code,
                        datetime_created::TIMESTAMP AS datetime_created,
                        datetime_updated::TIMESTAMP AS datetime_updated,
                        dbt_valid_from,
                        dbt_valid_to
                 from source)
select *
from renamed
  );
[0m19:35:16.619546 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m19:35:16.624007 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__customers_snapshots"
[0m19:35:16.624007 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__customers_snapshots: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__customers_snapshots"} */
alter table "IDX-Stock"."IDX-Schema"."stg_eltool__customers_snapshots" rename to "stg_eltool__customers_snapshots__dbt_backup"
[0m19:35:16.626976 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:35:16.630011 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__customers_snapshots"
[0m19:35:16.630971 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__customers_snapshots: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__customers_snapshots"} */
alter table "IDX-Stock"."IDX-Schema"."stg_eltool__customers_snapshots__dbt_tmp" rename to "stg_eltool__customers_snapshots"
[0m19:35:16.633688 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:35:16.635698 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__customers_snapshots: COMMIT
[0m19:35:16.636698 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__customers_snapshots"
[0m19:35:16.636698 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__customers_snapshots: COMMIT
[0m19:35:16.640064 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m19:35:16.644063 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__customers_snapshots"
[0m19:35:16.645062 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__customers_snapshots: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__customers_snapshots"} */
drop view if exists "IDX-Stock"."IDX-Schema"."stg_eltool__customers_snapshots__dbt_backup" cascade
[0m19:35:16.649064 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m19:35:16.651061 [debug] [Thread-1 (]: Timing info for model.dbt_idx.stg_eltool__customers_snapshots (execute): 19:35:16.581279 => 19:35:16.651061
[0m19:35:16.652085 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__customers_snapshots: Close
[0m19:35:16.654069 [info ] [Thread-1 (]: 3 of 11 OK created sql view model IDX-Schema.stg_eltool__customers_snapshots ... [[32mCREATE VIEW[0m in 0.08s]
[0m19:35:16.656065 [debug] [Thread-1 (]: Finished running node model.dbt_idx.stg_eltool__customers_snapshots
[0m19:35:16.657081 [debug] [Thread-1 (]: Began running node model.dbt_idx.stg_eltool__orders
[0m19:35:16.658065 [info ] [Thread-1 (]: 4 of 11 START sql view model IDX-Schema.stg_eltool__orders ..................... [RUN]
[0m19:35:16.659087 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_idx.stg_eltool__customers_snapshots, now model.dbt_idx.stg_eltool__orders)
[0m19:35:16.660065 [debug] [Thread-1 (]: Began compiling node model.dbt_idx.stg_eltool__orders
[0m19:35:16.664100 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_idx.stg_eltool__orders"
[0m19:35:16.674084 [debug] [Thread-1 (]: Timing info for model.dbt_idx.stg_eltool__orders (compile): 19:35:16.661098 => 19:35:16.674084
[0m19:35:16.675079 [debug] [Thread-1 (]: Began executing node model.dbt_idx.stg_eltool__orders
[0m19:35:16.679064 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_idx.stg_eltool__orders"
[0m19:35:16.690062 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__orders"
[0m19:35:16.691063 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__orders: BEGIN
[0m19:35:16.691063 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:35:16.713622 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m19:35:16.713622 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__orders"
[0m19:35:16.714622 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__orders: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__orders"} */

  create view "IDX-Stock"."IDX-Schema"."stg_eltool__orders__dbt_tmp"
    
    
  as (
    with source as (select *
                from "IDX-Stock"."IDX-Schema"."orders"),
     renamed as (select order_id,
                        cust_id AS customer_id,
                        order_status,
                        order_purchase_timestamp::TIMESTAMP,
                        order_approved_at::TIMESTAMP,
                        order_delivered_carrier_date::TIMESTAMP,
                        order_delivered_customer_date::TIMESTAMP,
                        order_estimated_delivery_date::TIMESTAMP
                 from source)
select *
from renamed
  );
[0m19:35:16.717657 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m19:35:16.723177 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__orders"
[0m19:35:16.724145 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__orders: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__orders"} */
alter table "IDX-Stock"."IDX-Schema"."stg_eltool__orders" rename to "stg_eltool__orders__dbt_backup"
[0m19:35:16.726178 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:35:16.730140 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__orders"
[0m19:35:16.730140 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__orders: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__orders"} */
alter table "IDX-Stock"."IDX-Schema"."stg_eltool__orders__dbt_tmp" rename to "stg_eltool__orders"
[0m19:35:16.733083 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:35:16.735108 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__orders: COMMIT
[0m19:35:16.736119 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__orders"
[0m19:35:16.737086 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__orders: COMMIT
[0m19:35:16.740663 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m19:35:16.743663 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__orders"
[0m19:35:16.744643 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__orders: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__orders"} */
drop view if exists "IDX-Stock"."IDX-Schema"."stg_eltool__orders__dbt_backup" cascade
[0m19:35:16.748649 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m19:35:16.750665 [debug] [Thread-1 (]: Timing info for model.dbt_idx.stg_eltool__orders (execute): 19:35:16.675079 => 19:35:16.750665
[0m19:35:16.751630 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__orders: Close
[0m19:35:16.753647 [info ] [Thread-1 (]: 4 of 11 OK created sql view model IDX-Schema.stg_eltool__orders ................ [[32mCREATE VIEW[0m in 0.09s]
[0m19:35:16.754632 [debug] [Thread-1 (]: Finished running node model.dbt_idx.stg_eltool__orders
[0m19:35:16.755633 [debug] [Thread-1 (]: Began running node model.dbt_idx.stg_eltool__state
[0m19:35:16.756633 [info ] [Thread-1 (]: 5 of 11 START sql view model IDX-Schema.stg_eltool__state ...................... [RUN]
[0m19:35:16.758663 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_idx.stg_eltool__orders, now model.dbt_idx.stg_eltool__state)
[0m19:35:16.759628 [debug] [Thread-1 (]: Began compiling node model.dbt_idx.stg_eltool__state
[0m19:35:16.762665 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_idx.stg_eltool__state"
[0m19:35:16.768633 [debug] [Thread-1 (]: Timing info for model.dbt_idx.stg_eltool__state (compile): 19:35:16.759628 => 19:35:16.768633
[0m19:35:16.769663 [debug] [Thread-1 (]: Began executing node model.dbt_idx.stg_eltool__state
[0m19:35:16.774663 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_idx.stg_eltool__state"
[0m19:35:16.780056 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__state"
[0m19:35:16.782056 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__state: BEGIN
[0m19:35:16.783057 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:35:16.804051 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m19:35:16.805057 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__state"
[0m19:35:16.805057 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__state: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__state"} */

  create view "IDX-Stock"."IDX-Schema"."stg_eltool__state__dbt_tmp"
    
    
  as (
    with source as (select *
                from "IDX-Stock"."IDX-Schema"."state"),
     renamed as (select state_identifier::INT AS state_id,
                         state_code::VARCHAR(2) AS state_code,
                         st_name::VARCHAR(30) AS state_name
                 from source)
select *
from renamed
  );
[0m19:35:16.808833 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m19:35:16.811867 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__state"
[0m19:35:16.812867 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__state: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__state"} */
alter table "IDX-Stock"."IDX-Schema"."stg_eltool__state" rename to "stg_eltool__state__dbt_backup"
[0m19:35:16.816833 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:35:16.821279 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__state"
[0m19:35:16.823284 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__state: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__state"} */
alter table "IDX-Stock"."IDX-Schema"."stg_eltool__state__dbt_tmp" rename to "stg_eltool__state"
[0m19:35:16.826297 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:35:16.829280 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__state: COMMIT
[0m19:35:16.830280 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__state"
[0m19:35:16.830280 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__state: COMMIT
[0m19:35:16.834714 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m19:35:16.839713 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__state"
[0m19:35:16.839713 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__state: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__state"} */
drop view if exists "IDX-Stock"."IDX-Schema"."stg_eltool__state__dbt_backup" cascade
[0m19:35:16.843715 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m19:35:16.845739 [debug] [Thread-1 (]: Timing info for model.dbt_idx.stg_eltool__state (execute): 19:35:16.770639 => 19:35:16.845739
[0m19:35:16.846727 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__state: Close
[0m19:35:16.848718 [info ] [Thread-1 (]: 5 of 11 OK created sql view model IDX-Schema.stg_eltool__state ................. [[32mCREATE VIEW[0m in 0.09s]
[0m19:35:16.849719 [debug] [Thread-1 (]: Finished running node model.dbt_idx.stg_eltool__state
[0m19:35:16.850718 [debug] [Thread-1 (]: Began running node model.dbt_idx.stg_eltool__stock
[0m19:35:16.852716 [info ] [Thread-1 (]: 6 of 11 START sql view model IDX-Schema.stg_eltool__stock ...................... [RUN]
[0m19:35:16.853714 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_idx.stg_eltool__state, now model.dbt_idx.stg_eltool__stock)
[0m19:35:16.854713 [debug] [Thread-1 (]: Began compiling node model.dbt_idx.stg_eltool__stock
[0m19:35:16.857749 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_idx.stg_eltool__stock"
[0m19:35:16.863729 [debug] [Thread-1 (]: Timing info for model.dbt_idx.stg_eltool__stock (compile): 19:35:16.854713 => 19:35:16.862762
[0m19:35:16.864713 [debug] [Thread-1 (]: Began executing node model.dbt_idx.stg_eltool__stock
[0m19:35:16.868747 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_idx.stg_eltool__stock"
[0m19:35:16.874428 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__stock"
[0m19:35:16.875428 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__stock: BEGIN
[0m19:35:16.876393 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:35:16.897545 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m19:35:16.898544 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__stock"
[0m19:35:16.898544 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__stock: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__stock"} */

  create view "IDX-Stock"."IDX-Schema"."stg_eltool__stock__dbt_tmp"
    
    
  as (
    with source as (select *
                from "IDX-Stock"."IDX-Schema"."ksql-stock-stream"),
     renamed as (select *
                 from source)
select *
from renamed
  );
[0m19:35:16.902544 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m19:35:16.906587 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__stock"
[0m19:35:16.906587 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__stock: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__stock"} */
alter table "IDX-Stock"."IDX-Schema"."stg_eltool__stock" rename to "stg_eltool__stock__dbt_backup"
[0m19:35:16.909606 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:35:16.914586 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__stock"
[0m19:35:16.915588 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__stock: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__stock"} */
alter table "IDX-Stock"."IDX-Schema"."stg_eltool__stock__dbt_tmp" rename to "stg_eltool__stock"
[0m19:35:16.918124 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:35:16.919702 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__stock: COMMIT
[0m19:35:16.920745 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__stock"
[0m19:35:16.921773 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__stock: COMMIT
[0m19:35:16.924706 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m19:35:16.927732 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__stock"
[0m19:35:16.928723 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__stock: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__stock"} */
drop view if exists "IDX-Stock"."IDX-Schema"."stg_eltool__stock__dbt_backup" cascade
[0m19:35:16.932707 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m19:35:16.934708 [debug] [Thread-1 (]: Timing info for model.dbt_idx.stg_eltool__stock (execute): 19:35:16.864713 => 19:35:16.933708
[0m19:35:16.934708 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__stock: Close
[0m19:35:16.936710 [info ] [Thread-1 (]: 6 of 11 OK created sql view model IDX-Schema.stg_eltool__stock ................. [[32mCREATE VIEW[0m in 0.08s]
[0m19:35:16.938708 [debug] [Thread-1 (]: Finished running node model.dbt_idx.stg_eltool__stock
[0m19:35:16.940709 [debug] [Thread-1 (]: Began running node model.dbt_idx.fact_orders
[0m19:35:16.941709 [info ] [Thread-1 (]: 7 of 11 START sql table model IDX-Schema.fact_orders ........................... [RUN]
[0m19:35:16.943714 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_idx.stg_eltool__stock, now model.dbt_idx.fact_orders)
[0m19:35:16.945707 [debug] [Thread-1 (]: Began compiling node model.dbt_idx.fact_orders
[0m19:35:16.948716 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_idx.fact_orders"
[0m19:35:16.955120 [debug] [Thread-1 (]: Timing info for model.dbt_idx.fact_orders (compile): 19:35:16.945707 => 19:35:16.954110
[0m19:35:16.956106 [debug] [Thread-1 (]: Began executing node model.dbt_idx.fact_orders
[0m19:35:16.981142 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_idx.fact_orders"
[0m19:35:16.986720 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.fact_orders"
[0m19:35:16.987690 [debug] [Thread-1 (]: On model.dbt_idx.fact_orders: BEGIN
[0m19:35:16.988681 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:35:17.008536 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m19:35:17.009542 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.fact_orders"
[0m19:35:17.009542 [debug] [Thread-1 (]: On model.dbt_idx.fact_orders: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.fact_orders"} */

  
    

  create  table "IDX-Stock"."IDX-Schema"."fact_orders__dbt_tmp"
  
  
    as
  
  (
    with orders as (
    select *
    from "IDX-Stock"."IDX-Schema"."stg_eltool__orders"
)
select * from orders
  );
  
[0m19:35:17.015563 [debug] [Thread-1 (]: SQL status: SELECT 999 in 0.0 seconds
[0m19:35:17.019568 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.fact_orders"
[0m19:35:17.020116 [debug] [Thread-1 (]: On model.dbt_idx.fact_orders: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.fact_orders"} */
alter table "IDX-Stock"."IDX-Schema"."fact_orders" rename to "fact_orders__dbt_backup"
[0m19:35:17.022127 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:35:17.025159 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.fact_orders"
[0m19:35:17.026161 [debug] [Thread-1 (]: On model.dbt_idx.fact_orders: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.fact_orders"} */
alter table "IDX-Stock"."IDX-Schema"."fact_orders__dbt_tmp" rename to "fact_orders"
[0m19:35:17.028385 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:35:17.034432 [debug] [Thread-1 (]: On model.dbt_idx.fact_orders: COMMIT
[0m19:35:17.035396 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.fact_orders"
[0m19:35:17.035396 [debug] [Thread-1 (]: On model.dbt_idx.fact_orders: COMMIT
[0m19:35:17.038998 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m19:35:17.045034 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.fact_orders"
[0m19:35:17.046024 [debug] [Thread-1 (]: On model.dbt_idx.fact_orders: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.fact_orders"} */
drop table if exists "IDX-Stock"."IDX-Schema"."fact_orders__dbt_backup" cascade
[0m19:35:17.050997 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m19:35:17.052028 [debug] [Thread-1 (]: Timing info for model.dbt_idx.fact_orders (execute): 19:35:16.956106 => 19:35:17.052028
[0m19:35:17.052997 [debug] [Thread-1 (]: On model.dbt_idx.fact_orders: Close
[0m19:35:17.055001 [info ] [Thread-1 (]: 7 of 11 OK created sql table model IDX-Schema.fact_orders ...................... [[32mSELECT 999[0m in 0.11s]
[0m19:35:17.057023 [debug] [Thread-1 (]: Finished running node model.dbt_idx.fact_orders
[0m19:35:17.058004 [debug] [Thread-1 (]: Began running node model.dbt_idx.dim_customers
[0m19:35:17.058999 [info ] [Thread-1 (]: 8 of 11 START sql table model IDX-Schema.dim_customers ......................... [RUN]
[0m19:35:17.061036 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_idx.fact_orders, now model.dbt_idx.dim_customers)
[0m19:35:17.061997 [debug] [Thread-1 (]: Began compiling node model.dbt_idx.dim_customers
[0m19:35:17.065024 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_idx.dim_customers"
[0m19:35:17.072141 [debug] [Thread-1 (]: Timing info for model.dbt_idx.dim_customers (compile): 19:35:17.061997 => 19:35:17.071144
[0m19:35:17.072141 [debug] [Thread-1 (]: Began executing node model.dbt_idx.dim_customers
[0m19:35:17.079140 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_idx.dim_customers"
[0m19:35:17.085116 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.dim_customers"
[0m19:35:17.086154 [debug] [Thread-1 (]: On model.dbt_idx.dim_customers: BEGIN
[0m19:35:17.087139 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:35:17.108047 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m19:35:17.109088 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.dim_customers"
[0m19:35:17.111090 [debug] [Thread-1 (]: On model.dbt_idx.dim_customers: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.dim_customers"} */

  
    

  create  table "IDX-Stock"."IDX-Schema"."dim_customers__dbt_tmp"
  
  
    as
  
  (
    -- noinspection SqlDialectInspectionForFile

with customers as (
    select *
    from "IDX-Stock"."IDX-Schema"."stg_eltool__customers_snapshots"
    ),
     state as (
         select *
         from "IDX-Stock"."IDX-Schema"."stg_eltool__state"
     )
select c.customer_id,
       c.zipcode,
       c.city,
       c.state_code,
       s.state_name,
       c.datetime_created,
       c.datetime_updated,
       c.dbt_valid_from::TIMESTAMP as valid_from,
        CASE WHEN c.dbt_valid_to IS NULL
            THEN '9999-12-31'::TIMESTAMP
            ELSE c.dbt_valid_to::TIMESTAMP
        END as valid_to
from customers c
    join state s on c.state_code = s.state_code
  );
  
[0m19:35:17.116054 [debug] [Thread-1 (]: SQL status: SELECT 100 in 0.0 seconds
[0m19:35:17.118095 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.dim_customers"
[0m19:35:17.119636 [debug] [Thread-1 (]: On model.dbt_idx.dim_customers: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.dim_customers"} */
alter table "IDX-Stock"."IDX-Schema"."dim_customers" rename to "dim_customers__dbt_backup"
[0m19:35:17.122679 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:35:17.162678 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.dim_customers"
[0m19:35:17.163643 [debug] [Thread-1 (]: On model.dbt_idx.dim_customers: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.dim_customers"} */
alter table "IDX-Stock"."IDX-Schema"."dim_customers__dbt_tmp" rename to "dim_customers"
[0m19:35:17.165642 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:35:17.167666 [debug] [Thread-1 (]: On model.dbt_idx.dim_customers: COMMIT
[0m19:35:17.168670 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.dim_customers"
[0m19:35:17.169643 [debug] [Thread-1 (]: On model.dbt_idx.dim_customers: COMMIT
[0m19:35:17.172643 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m19:35:17.175675 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.dim_customers"
[0m19:35:17.176674 [debug] [Thread-1 (]: On model.dbt_idx.dim_customers: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.dim_customers"} */
drop table if exists "IDX-Stock"."IDX-Schema"."dim_customers__dbt_backup" cascade
[0m19:35:17.180875 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m19:35:17.181898 [debug] [Thread-1 (]: Timing info for model.dbt_idx.dim_customers (execute): 19:35:17.073141 => 19:35:17.181898
[0m19:35:17.182895 [debug] [Thread-1 (]: On model.dbt_idx.dim_customers: Close
[0m19:35:17.184867 [info ] [Thread-1 (]: 8 of 11 OK created sql table model IDX-Schema.dim_customers .................... [[32mSELECT 100[0m in 0.12s]
[0m19:35:17.186867 [debug] [Thread-1 (]: Finished running node model.dbt_idx.dim_customers
[0m19:35:17.187864 [debug] [Thread-1 (]: Began running node model.dbt_idx.fact_stocks
[0m19:35:17.188876 [info ] [Thread-1 (]: 9 of 11 START sql table model IDX-Schema.fact_stocks ........................... [RUN]
[0m19:35:17.189861 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_idx.dim_customers, now model.dbt_idx.fact_stocks)
[0m19:35:17.190866 [debug] [Thread-1 (]: Began compiling node model.dbt_idx.fact_stocks
[0m19:35:17.193896 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_idx.fact_stocks"
[0m19:35:17.200469 [debug] [Thread-1 (]: Timing info for model.dbt_idx.fact_stocks (compile): 19:35:17.191906 => 19:35:17.199505
[0m19:35:17.200469 [debug] [Thread-1 (]: Began executing node model.dbt_idx.fact_stocks
[0m19:35:17.206533 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_idx.fact_stocks"
[0m19:35:17.212499 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.fact_stocks"
[0m19:35:17.213502 [debug] [Thread-1 (]: On model.dbt_idx.fact_stocks: BEGIN
[0m19:35:17.213502 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:35:17.236007 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m19:35:17.237038 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.fact_stocks"
[0m19:35:17.238006 [debug] [Thread-1 (]: On model.dbt_idx.fact_stocks: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.fact_stocks"} */

  
    

  create  table "IDX-Stock"."IDX-Schema"."fact_stocks__dbt_tmp"
  
  
    as
  
  (
    -- noinspection SqlDialectInspectionForFile

with stock as (
    select *
    from "IDX-Stock"."IDX-Schema"."stg_eltool__stock"
    ),
     company as (
         select *
         from "IDX-Stock"."IDX-Schema"."stg_eltool__company"
     )
select a.id,
       a.ticker,
       b.name,
       a.date,
       a.open,
       a.high,
       a.low,
       a.close,
       a.volume,
       b.logo
from stock a
    join company b on a.ticker = b.ticker
  );
  
[0m19:35:17.282604 [debug] [Thread-1 (]: SQL status: SELECT 26131 in 0.0 seconds
[0m19:35:17.287591 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.fact_stocks"
[0m19:35:17.288593 [debug] [Thread-1 (]: On model.dbt_idx.fact_stocks: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.fact_stocks"} */
alter table "IDX-Stock"."IDX-Schema"."fact_stocks" rename to "fact_stocks__dbt_backup"
[0m19:35:17.290594 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:35:17.294589 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.fact_stocks"
[0m19:35:17.295590 [debug] [Thread-1 (]: On model.dbt_idx.fact_stocks: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.fact_stocks"} */
alter table "IDX-Stock"."IDX-Schema"."fact_stocks__dbt_tmp" rename to "fact_stocks"
[0m19:35:17.297592 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:35:17.300594 [debug] [Thread-1 (]: On model.dbt_idx.fact_stocks: COMMIT
[0m19:35:17.301594 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.fact_stocks"
[0m19:35:17.301594 [debug] [Thread-1 (]: On model.dbt_idx.fact_stocks: COMMIT
[0m19:35:17.311608 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m19:35:17.315609 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.fact_stocks"
[0m19:35:17.316611 [debug] [Thread-1 (]: On model.dbt_idx.fact_stocks: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.fact_stocks"} */
drop table if exists "IDX-Stock"."IDX-Schema"."fact_stocks__dbt_backup" cascade
[0m19:35:17.321512 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m19:35:17.323560 [debug] [Thread-1 (]: Timing info for model.dbt_idx.fact_stocks (execute): 19:35:17.201505 => 19:35:17.322525
[0m19:35:17.323560 [debug] [Thread-1 (]: On model.dbt_idx.fact_stocks: Close
[0m19:35:17.325523 [info ] [Thread-1 (]: 9 of 11 OK created sql table model IDX-Schema.fact_stocks ...................... [[32mSELECT 26131[0m in 0.14s]
[0m19:35:17.327527 [debug] [Thread-1 (]: Finished running node model.dbt_idx.fact_stocks
[0m19:35:17.328532 [debug] [Thread-1 (]: Began running node model.dbt_idx.customer_orders_status
[0m19:35:17.329522 [info ] [Thread-1 (]: 10 of 11 START sql view model IDX-Schema.customer_orders_status ................ [RUN]
[0m19:35:17.331560 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_idx.fact_stocks, now model.dbt_idx.customer_orders_status)
[0m19:35:17.332522 [debug] [Thread-1 (]: Began compiling node model.dbt_idx.customer_orders_status
[0m19:35:17.335559 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_idx.customer_orders_status"
[0m19:35:17.341929 [debug] [Thread-1 (]: Timing info for model.dbt_idx.customer_orders_status (compile): 19:35:17.332522 => 19:35:17.341929
[0m19:35:17.342960 [debug] [Thread-1 (]: Began executing node model.dbt_idx.customer_orders_status
[0m19:35:17.350897 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_idx.customer_orders_status"
[0m19:35:17.356900 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.customer_orders_status"
[0m19:35:17.357929 [debug] [Thread-1 (]: On model.dbt_idx.customer_orders_status: BEGIN
[0m19:35:17.358941 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:35:17.379482 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m19:35:17.380465 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.customer_orders_status"
[0m19:35:17.381483 [debug] [Thread-1 (]: On model.dbt_idx.customer_orders_status: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.customer_orders_status"} */

  create view "IDX-Stock"."IDX-Schema"."customer_orders_status__dbt_tmp"
    
    
  as (
    with orders as (select *
                from "IDX-Stock"."IDX-Schema"."fact_orders"),
     customers as (select *
                   from "IDX-Stock"."IDX-Schema"."dim_customers")
select o.order_id,
       o.customer_id,
       o.order_status,
       o.order_purchase_timestamp,
       o.order_approved_at,
       o.order_delivered_carrier_date,
       o.order_delivered_customer_date,
       o.order_estimated_delivery_date,
       c.zipcode    as customer_zipcode,
       c.city       as customer_city,
       c.state_code as customer_state_code,
       c.state_name as customer_state_name
from orders o
    join customers c on o.customer_id = c.customer_id
    and o.order_purchase_timestamp >= c.valid_from
    and o.order_purchase_timestamp <= c.valid_to
  );
[0m19:35:17.385465 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m19:35:17.388489 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.customer_orders_status"
[0m19:35:17.388489 [debug] [Thread-1 (]: On model.dbt_idx.customer_orders_status: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.customer_orders_status"} */
alter table "IDX-Stock"."IDX-Schema"."customer_orders_status__dbt_tmp" rename to "customer_orders_status"
[0m19:35:17.391468 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:35:17.394491 [debug] [Thread-1 (]: On model.dbt_idx.customer_orders_status: COMMIT
[0m19:35:17.395496 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.customer_orders_status"
[0m19:35:17.395496 [debug] [Thread-1 (]: On model.dbt_idx.customer_orders_status: COMMIT
[0m19:35:17.399005 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m19:35:17.402002 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.customer_orders_status"
[0m19:35:17.403002 [debug] [Thread-1 (]: On model.dbt_idx.customer_orders_status: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.customer_orders_status"} */
drop view if exists "IDX-Stock"."IDX-Schema"."customer_orders_status__dbt_backup" cascade
[0m19:35:17.405016 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m19:35:17.407009 [debug] [Thread-1 (]: Timing info for model.dbt_idx.customer_orders_status (execute): 19:35:17.342960 => 19:35:17.406009
[0m19:35:17.407009 [debug] [Thread-1 (]: On model.dbt_idx.customer_orders_status: Close
[0m19:35:17.410027 [info ] [Thread-1 (]: 10 of 11 OK created sql view model IDX-Schema.customer_orders_status ........... [[32mCREATE VIEW[0m in 0.08s]
[0m19:35:17.412013 [debug] [Thread-1 (]: Finished running node model.dbt_idx.customer_orders_status
[0m19:35:17.413011 [debug] [Thread-1 (]: Began running node model.dbt_idx.stock_update_status
[0m19:35:17.415041 [info ] [Thread-1 (]: 11 of 11 START sql view model IDX-Schema.stock_update_status ................... [RUN]
[0m19:35:17.416012 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_idx.customer_orders_status, now model.dbt_idx.stock_update_status)
[0m19:35:17.417026 [debug] [Thread-1 (]: Began compiling node model.dbt_idx.stock_update_status
[0m19:35:17.419586 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_idx.stock_update_status"
[0m19:35:17.425889 [debug] [Thread-1 (]: Timing info for model.dbt_idx.stock_update_status (compile): 19:35:17.417026 => 19:35:17.425889
[0m19:35:17.426890 [debug] [Thread-1 (]: Began executing node model.dbt_idx.stock_update_status
[0m19:35:17.432921 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_idx.stock_update_status"
[0m19:35:17.438885 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stock_update_status"
[0m19:35:17.439885 [debug] [Thread-1 (]: On model.dbt_idx.stock_update_status: BEGIN
[0m19:35:17.440892 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:35:17.463410 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m19:35:17.464429 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stock_update_status"
[0m19:35:17.465397 [debug] [Thread-1 (]: On model.dbt_idx.stock_update_status: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stock_update_status"} */

  create view "IDX-Stock"."IDX-Schema"."stock_update_status__dbt_tmp"
    
    
  as (
    with stock as (select *
               from "IDX-Stock"."IDX-Schema"."fact_stocks")
select a.id,
       a.ticker,
       a.name,
       a.date,
       a.open,
       a.high,
       a.low,
       a.close,
       a.volume,
       rank() over (
       partition by a.ticker
       order by a.date desc
       ) as rank,
       a.logo
from
    stock a
  );
[0m19:35:17.469396 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m19:35:17.473427 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stock_update_status"
[0m19:35:17.474392 [debug] [Thread-1 (]: On model.dbt_idx.stock_update_status: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stock_update_status"} */
alter table "IDX-Stock"."IDX-Schema"."stock_update_status__dbt_tmp" rename to "stock_update_status"
[0m19:35:17.476395 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:35:17.478429 [debug] [Thread-1 (]: On model.dbt_idx.stock_update_status: COMMIT
[0m19:35:17.478429 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stock_update_status"
[0m19:35:17.479428 [debug] [Thread-1 (]: On model.dbt_idx.stock_update_status: COMMIT
[0m19:35:17.482392 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m19:35:17.485429 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stock_update_status"
[0m19:35:17.486395 [debug] [Thread-1 (]: On model.dbt_idx.stock_update_status: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stock_update_status"} */
drop view if exists "IDX-Stock"."IDX-Schema"."stock_update_status__dbt_backup" cascade
[0m19:35:17.488734 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m19:35:17.490817 [debug] [Thread-1 (]: Timing info for model.dbt_idx.stock_update_status (execute): 19:35:17.427916 => 19:35:17.489746
[0m19:35:17.490817 [debug] [Thread-1 (]: On model.dbt_idx.stock_update_status: Close
[0m19:35:17.492750 [info ] [Thread-1 (]: 11 of 11 OK created sql view model IDX-Schema.stock_update_status .............. [[32mCREATE VIEW[0m in 0.08s]
[0m19:35:17.494752 [debug] [Thread-1 (]: Finished running node model.dbt_idx.stock_update_status
[0m19:35:17.497781 [debug] [MainThread]: Using postgres connection "master"
[0m19:35:17.498755 [debug] [MainThread]: On master: BEGIN
[0m19:35:17.498755 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m19:35:17.518693 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m19:35:17.520173 [debug] [MainThread]: On master: COMMIT
[0m19:35:17.520173 [debug] [MainThread]: Using postgres connection "master"
[0m19:35:17.521183 [debug] [MainThread]: On master: COMMIT
[0m19:35:17.523185 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m19:35:17.524215 [debug] [MainThread]: On master: Close
[0m19:35:17.525197 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:35:17.526185 [debug] [MainThread]: Connection 'list_IDX-Stock' was properly closed.
[0m19:35:17.527204 [debug] [MainThread]: Connection 'list_IDX-Stock_snapshots' was properly closed.
[0m19:35:17.528199 [debug] [MainThread]: Connection 'model.dbt_idx.stock_update_status' was properly closed.
[0m19:35:17.529180 [info ] [MainThread]: 
[0m19:35:17.530197 [info ] [MainThread]: Finished running 8 view models, 3 table models in 0 hours 0 minutes and 1.40 seconds (1.40s).
[0m19:35:17.533180 [debug] [MainThread]: Command end result
[0m19:35:17.557230 [info ] [MainThread]: 
[0m19:35:17.558180 [info ] [MainThread]: [32mCompleted successfully[0m
[0m19:35:17.559216 [info ] [MainThread]: 
[0m19:35:17.560197 [info ] [MainThread]: Done. PASS=11 WARN=0 ERROR=0 SKIP=0 TOTAL=11
[0m19:35:17.561183 [debug] [MainThread]: Command `dbt run` succeeded at 19:35:17.561183 after 1.93 seconds
[0m19:35:17.562181 [debug] [MainThread]: Flushing usage events


============================== 19:36:37.126337 | 2779ad64-4493-4b81-b67c-48c919262ba3 ==============================
[0m19:36:37.126337 [info ] [MainThread]: Running with dbt=1.6.1
[0m19:36:37.131911 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'D:\\00 Project\\00 My Project\\IdeaProjects\\Py-DBT-IDX', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': 'D:\\00 Project\\00 My Project\\IdeaProjects\\Py-DBT-IDX\\logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'False'}
[0m19:36:37.288358 [info ] [MainThread]: Registered adapter: postgres=1.6.1
[0m19:36:37.298359 [debug] [MainThread]: checksum: efe19d9f5b93d1a98cc804fbfcdb6b3aced98b974af664946fee1cde8837deb7, vars: {}, profile: , target: , version: 1.6.1
[0m19:36:37.443952 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m19:36:37.444995 [debug] [MainThread]: Partial parsing: updated file: dbt_idx://models\marts\stock\stock_update_status.sql
[0m19:36:37.545503 [info ] [MainThread]: Found 11 models, 1 snapshot, 18 tests, 5 sources, 0 exposures, 0 metrics, 349 macros, 0 groups, 0 semantic models
[0m19:36:37.548467 [info ] [MainThread]: 
[0m19:36:37.550479 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m19:36:37.552441 [debug] [ThreadPool]: Acquiring new postgres connection 'list_IDX-Stock'
[0m19:36:37.562475 [debug] [ThreadPool]: Using postgres connection "list_IDX-Stock"
[0m19:36:37.563486 [debug] [ThreadPool]: On list_IDX-Stock: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "connection_name": "list_IDX-Stock"} */

    select distinct nspname from pg_namespace
  
[0m19:36:37.563486 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:36:37.594730 [debug] [ThreadPool]: SQL status: SELECT 12 in 0.0 seconds
[0m19:36:37.596731 [debug] [ThreadPool]: On list_IDX-Stock: Close
[0m19:36:37.601740 [debug] [ThreadPool]: Acquiring new postgres connection 'list_IDX-Stock_snapshots'
[0m19:36:37.608774 [debug] [ThreadPool]: Using postgres connection "list_IDX-Stock_snapshots"
[0m19:36:37.609748 [debug] [ThreadPool]: On list_IDX-Stock_snapshots: BEGIN
[0m19:36:37.610739 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:36:37.631463 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m19:36:37.631463 [debug] [ThreadPool]: Using postgres connection "list_IDX-Stock_snapshots"
[0m19:36:37.632486 [debug] [ThreadPool]: On list_IDX-Stock_snapshots: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "connection_name": "list_IDX-Stock_snapshots"} */
select
      'IDX-Stock' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'snapshots'
    union all
    select
      'IDX-Stock' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'snapshots'
    union all
    select
      'IDX-Stock' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'snapshots'
  
[0m19:36:37.636461 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.0 seconds
[0m19:36:37.638490 [debug] [ThreadPool]: On list_IDX-Stock_snapshots: ROLLBACK
[0m19:36:37.640462 [debug] [ThreadPool]: On list_IDX-Stock_snapshots: Close
[0m19:36:37.642480 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_IDX-Stock_snapshots, now list_IDX-Stock_IDX-Schema)
[0m19:36:37.645463 [debug] [ThreadPool]: Using postgres connection "list_IDX-Stock_IDX-Schema"
[0m19:36:37.646485 [debug] [ThreadPool]: On list_IDX-Stock_IDX-Schema: BEGIN
[0m19:36:37.647459 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:36:37.668244 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m19:36:37.669252 [debug] [ThreadPool]: Using postgres connection "list_IDX-Stock_IDX-Schema"
[0m19:36:37.670250 [debug] [ThreadPool]: On list_IDX-Stock_IDX-Schema: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "connection_name": "list_IDX-Stock_IDX-Schema"} */
select
      'IDX-Stock' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'IDX-Schema'
    union all
    select
      'IDX-Stock' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'IDX-Schema'
    union all
    select
      'IDX-Stock' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'IDX-Schema'
  
[0m19:36:37.675247 [debug] [ThreadPool]: SQL status: SELECT 17 in 0.0 seconds
[0m19:36:37.676244 [debug] [ThreadPool]: On list_IDX-Stock_IDX-Schema: ROLLBACK
[0m19:36:37.679462 [debug] [ThreadPool]: On list_IDX-Stock_IDX-Schema: Close
[0m19:36:37.690494 [debug] [MainThread]: Using postgres connection "master"
[0m19:36:37.691461 [debug] [MainThread]: On master: BEGIN
[0m19:36:37.692472 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:36:37.713107 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m19:36:37.713107 [debug] [MainThread]: Using postgres connection "master"
[0m19:36:37.714614 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m19:36:37.722629 [debug] [MainThread]: SQL status: SELECT 9 in 0.0 seconds
[0m19:36:37.725620 [debug] [MainThread]: On master: ROLLBACK
[0m19:36:37.727626 [debug] [MainThread]: Using postgres connection "master"
[0m19:36:37.728620 [debug] [MainThread]: On master: BEGIN
[0m19:36:37.732600 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m19:36:37.732600 [debug] [MainThread]: On master: COMMIT
[0m19:36:37.733611 [debug] [MainThread]: Using postgres connection "master"
[0m19:36:37.733611 [debug] [MainThread]: On master: COMMIT
[0m19:36:37.735613 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m19:36:37.736611 [debug] [MainThread]: On master: Close
[0m19:36:37.737611 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m19:36:37.739615 [info ] [MainThread]: 
[0m19:36:37.744612 [debug] [Thread-1 (]: Began running node model.dbt_idx.stg_eltool__company
[0m19:36:37.745611 [info ] [Thread-1 (]: 1 of 11 START sql view model IDX-Schema.stg_eltool__company .................... [RUN]
[0m19:36:37.746610 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.dbt_idx.stg_eltool__company'
[0m19:36:37.747639 [debug] [Thread-1 (]: Began compiling node model.dbt_idx.stg_eltool__company
[0m19:36:37.756635 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_idx.stg_eltool__company"
[0m19:36:37.763623 [debug] [Thread-1 (]: Timing info for model.dbt_idx.stg_eltool__company (compile): 19:36:37.748616 => 19:36:37.762636
[0m19:36:37.764610 [debug] [Thread-1 (]: Began executing node model.dbt_idx.stg_eltool__company
[0m19:36:37.802688 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_idx.stg_eltool__company"
[0m19:36:37.809143 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__company"
[0m19:36:37.810148 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__company: BEGIN
[0m19:36:37.811179 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m19:36:37.831140 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m19:36:37.832140 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__company"
[0m19:36:37.832140 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__company: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__company"} */

  create view "IDX-Stock"."IDX-Schema"."stg_eltool__company__dbt_tmp"
    
    
  as (
    with source as (select *
                from "IDX-Stock"."IDX-Schema"."ksql-company-stream"),
     renamed as (select id,
                        ticker,
                        name,
                        logo
                 from source)
select *
from renamed
  );
[0m19:36:37.837143 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m19:36:37.845176 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__company"
[0m19:36:37.846140 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__company: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__company"} */
alter table "IDX-Stock"."IDX-Schema"."stg_eltool__company" rename to "stg_eltool__company__dbt_backup"
[0m19:36:37.849140 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:36:37.852182 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__company"
[0m19:36:37.853175 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__company: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__company"} */
alter table "IDX-Stock"."IDX-Schema"."stg_eltool__company__dbt_tmp" rename to "stg_eltool__company"
[0m19:36:37.855143 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:36:37.872174 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__company: COMMIT
[0m19:36:37.873141 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__company"
[0m19:36:37.873141 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__company: COMMIT
[0m19:36:37.876140 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m19:36:37.885174 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__company"
[0m19:36:37.886161 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__company: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__company"} */
drop view if exists "IDX-Stock"."IDX-Schema"."stg_eltool__company__dbt_backup" cascade
[0m19:36:37.889829 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m19:36:37.891862 [debug] [Thread-1 (]: Timing info for model.dbt_idx.stg_eltool__company (execute): 19:36:37.764610 => 19:36:37.891862
[0m19:36:37.892886 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__company: Close
[0m19:36:37.894828 [info ] [Thread-1 (]: 1 of 11 OK created sql view model IDX-Schema.stg_eltool__company ............... [[32mCREATE VIEW[0m in 0.15s]
[0m19:36:37.895829 [debug] [Thread-1 (]: Finished running node model.dbt_idx.stg_eltool__company
[0m19:36:37.897831 [debug] [Thread-1 (]: Began running node model.dbt_idx.stg_eltool__customers
[0m19:36:37.897831 [info ] [Thread-1 (]: 2 of 11 START sql view model IDX-Schema.stg_eltool__customers .................. [RUN]
[0m19:36:37.899870 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_idx.stg_eltool__company, now model.dbt_idx.stg_eltool__customers)
[0m19:36:37.900882 [debug] [Thread-1 (]: Began compiling node model.dbt_idx.stg_eltool__customers
[0m19:36:37.903903 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_idx.stg_eltool__customers"
[0m19:36:37.909879 [debug] [Thread-1 (]: Timing info for model.dbt_idx.stg_eltool__customers (compile): 19:36:37.900882 => 19:36:37.908906
[0m19:36:37.910905 [debug] [Thread-1 (]: Began executing node model.dbt_idx.stg_eltool__customers
[0m19:36:37.914924 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_idx.stg_eltool__customers"
[0m19:36:37.922043 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__customers"
[0m19:36:37.923045 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__customers: BEGIN
[0m19:36:37.924009 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:36:37.945712 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m19:36:37.946722 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__customers"
[0m19:36:37.947706 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__customers: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__customers"} */

  create view "IDX-Stock"."IDX-Schema"."stg_eltool__customers__dbt_tmp"
    
    
  as (
    with source as (select *
                from "IDX-Stock"."IDX-Schema"."customers"),
     renamed as (select
                     customer_id,
                    'This is Dummy' as dummy
                 from source
                 where customer_id = 1234567890)
select *
from renamed
  );
[0m19:36:37.950694 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m19:36:37.954697 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__customers"
[0m19:36:37.954697 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__customers: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__customers"} */
alter table "IDX-Stock"."IDX-Schema"."stg_eltool__customers" rename to "stg_eltool__customers__dbt_backup"
[0m19:36:37.957638 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:36:37.960683 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__customers"
[0m19:36:37.961656 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__customers: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__customers"} */
alter table "IDX-Stock"."IDX-Schema"."stg_eltool__customers__dbt_tmp" rename to "stg_eltool__customers"
[0m19:36:37.963572 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:36:37.965556 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__customers: COMMIT
[0m19:36:37.966558 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__customers"
[0m19:36:37.967558 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__customers: COMMIT
[0m19:36:37.969996 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m19:36:37.973034 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__customers"
[0m19:36:37.974038 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__customers: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__customers"} */
drop view if exists "IDX-Stock"."IDX-Schema"."stg_eltool__customers__dbt_backup" cascade
[0m19:36:37.978013 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m19:36:37.979998 [debug] [Thread-1 (]: Timing info for model.dbt_idx.stg_eltool__customers (execute): 19:36:37.910905 => 19:36:37.979998
[0m19:36:37.981005 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__customers: Close
[0m19:36:37.983002 [info ] [Thread-1 (]: 2 of 11 OK created sql view model IDX-Schema.stg_eltool__customers ............. [[32mCREATE VIEW[0m in 0.08s]
[0m19:36:37.986022 [debug] [Thread-1 (]: Finished running node model.dbt_idx.stg_eltool__customers
[0m19:36:37.986999 [debug] [Thread-1 (]: Began running node model.dbt_idx.stg_eltool__customers_snapshots
[0m19:36:37.986999 [info ] [Thread-1 (]: 3 of 11 START sql view model IDX-Schema.stg_eltool__customers_snapshots ........ [RUN]
[0m19:36:37.989034 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_idx.stg_eltool__customers, now model.dbt_idx.stg_eltool__customers_snapshots)
[0m19:36:37.989999 [debug] [Thread-1 (]: Began compiling node model.dbt_idx.stg_eltool__customers_snapshots
[0m19:36:37.992035 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_idx.stg_eltool__customers_snapshots"
[0m19:36:37.998751 [debug] [Thread-1 (]: Timing info for model.dbt_idx.stg_eltool__customers_snapshots (compile): 19:36:37.989999 => 19:36:37.998751
[0m19:36:37.999753 [debug] [Thread-1 (]: Began executing node model.dbt_idx.stg_eltool__customers_snapshots
[0m19:36:38.005795 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_idx.stg_eltool__customers_snapshots"
[0m19:36:38.010776 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__customers_snapshots"
[0m19:36:38.011799 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__customers_snapshots: BEGIN
[0m19:36:38.012784 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:36:38.035335 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m19:36:38.036320 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__customers_snapshots"
[0m19:36:38.036320 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__customers_snapshots: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__customers_snapshots"} */

  create view "IDX-Stock"."IDX-Schema"."stg_eltool__customers_snapshots__dbt_tmp"
    
    
  as (
    with source as (select *
                from "IDX-Stock"."snapshots"."customers_snapshot"),
     renamed as (select customer_id,
                        zipcode,
                        city,
                        state_code,
                        datetime_created::TIMESTAMP AS datetime_created,
                        datetime_updated::TIMESTAMP AS datetime_updated,
                        dbt_valid_from,
                        dbt_valid_to
                 from source)
select *
from renamed
  );
[0m19:36:38.040318 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m19:36:38.045352 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__customers_snapshots"
[0m19:36:38.045352 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__customers_snapshots: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__customers_snapshots"} */
alter table "IDX-Stock"."IDX-Schema"."stg_eltool__customers_snapshots" rename to "stg_eltool__customers_snapshots__dbt_backup"
[0m19:36:38.048317 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:36:38.051342 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__customers_snapshots"
[0m19:36:38.052317 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__customers_snapshots: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__customers_snapshots"} */
alter table "IDX-Stock"."IDX-Schema"."stg_eltool__customers_snapshots__dbt_tmp" rename to "stg_eltool__customers_snapshots"
[0m19:36:38.054318 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:36:38.057321 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__customers_snapshots: COMMIT
[0m19:36:38.057321 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__customers_snapshots"
[0m19:36:38.058321 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__customers_snapshots: COMMIT
[0m19:36:38.061906 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m19:36:38.064939 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__customers_snapshots"
[0m19:36:38.065941 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__customers_snapshots: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__customers_snapshots"} */
drop view if exists "IDX-Stock"."IDX-Schema"."stg_eltool__customers_snapshots__dbt_backup" cascade
[0m19:36:38.069903 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m19:36:38.071939 [debug] [Thread-1 (]: Timing info for model.dbt_idx.stg_eltool__customers_snapshots (execute): 19:36:37.999753 => 19:36:38.071939
[0m19:36:38.072903 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__customers_snapshots: Close
[0m19:36:38.074908 [info ] [Thread-1 (]: 3 of 11 OK created sql view model IDX-Schema.stg_eltool__customers_snapshots ... [[32mCREATE VIEW[0m in 0.09s]
[0m19:36:38.075927 [debug] [Thread-1 (]: Finished running node model.dbt_idx.stg_eltool__customers_snapshots
[0m19:36:38.076907 [debug] [Thread-1 (]: Began running node model.dbt_idx.stg_eltool__orders
[0m19:36:38.077906 [info ] [Thread-1 (]: 4 of 11 START sql view model IDX-Schema.stg_eltool__orders ..................... [RUN]
[0m19:36:38.079910 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_idx.stg_eltool__customers_snapshots, now model.dbt_idx.stg_eltool__orders)
[0m19:36:38.079910 [debug] [Thread-1 (]: Began compiling node model.dbt_idx.stg_eltool__orders
[0m19:36:38.082938 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_idx.stg_eltool__orders"
[0m19:36:38.093723 [debug] [Thread-1 (]: Timing info for model.dbt_idx.stg_eltool__orders (compile): 19:36:38.080947 => 19:36:38.093723
[0m19:36:38.094757 [debug] [Thread-1 (]: Began executing node model.dbt_idx.stg_eltool__orders
[0m19:36:38.099788 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_idx.stg_eltool__orders"
[0m19:36:38.111815 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__orders"
[0m19:36:38.112816 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__orders: BEGIN
[0m19:36:38.113816 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:36:38.134889 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m19:36:38.135918 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__orders"
[0m19:36:38.136883 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__orders: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__orders"} */

  create view "IDX-Stock"."IDX-Schema"."stg_eltool__orders__dbt_tmp"
    
    
  as (
    with source as (select *
                from "IDX-Stock"."IDX-Schema"."orders"),
     renamed as (select order_id,
                        cust_id AS customer_id,
                        order_status,
                        order_purchase_timestamp::TIMESTAMP,
                        order_approved_at::TIMESTAMP,
                        order_delivered_carrier_date::TIMESTAMP,
                        order_delivered_customer_date::TIMESTAMP,
                        order_estimated_delivery_date::TIMESTAMP
                 from source)
select *
from renamed
  );
[0m19:36:38.140883 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m19:36:38.144882 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__orders"
[0m19:36:38.145881 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__orders: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__orders"} */
alter table "IDX-Stock"."IDX-Schema"."stg_eltool__orders" rename to "stg_eltool__orders__dbt_backup"
[0m19:36:38.147916 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:36:38.152920 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__orders"
[0m19:36:38.152920 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__orders: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__orders"} */
alter table "IDX-Stock"."IDX-Schema"."stg_eltool__orders__dbt_tmp" rename to "stg_eltool__orders"
[0m19:36:38.154882 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:36:38.157881 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__orders: COMMIT
[0m19:36:38.157881 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__orders"
[0m19:36:38.158880 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__orders: COMMIT
[0m19:36:38.162010 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m19:36:38.166055 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__orders"
[0m19:36:38.166055 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__orders: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__orders"} */
drop view if exists "IDX-Stock"."IDX-Schema"."stg_eltool__orders__dbt_backup" cascade
[0m19:36:38.171021 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m19:36:38.172062 [debug] [Thread-1 (]: Timing info for model.dbt_idx.stg_eltool__orders (execute): 19:36:38.095726 => 19:36:38.172062
[0m19:36:38.173056 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__orders: Close
[0m19:36:38.175023 [info ] [Thread-1 (]: 4 of 11 OK created sql view model IDX-Schema.stg_eltool__orders ................ [[32mCREATE VIEW[0m in 0.10s]
[0m19:36:38.177024 [debug] [Thread-1 (]: Finished running node model.dbt_idx.stg_eltool__orders
[0m19:36:38.178040 [debug] [Thread-1 (]: Began running node model.dbt_idx.stg_eltool__state
[0m19:36:38.179026 [info ] [Thread-1 (]: 5 of 11 START sql view model IDX-Schema.stg_eltool__state ...................... [RUN]
[0m19:36:38.181056 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_idx.stg_eltool__orders, now model.dbt_idx.stg_eltool__state)
[0m19:36:38.182023 [debug] [Thread-1 (]: Began compiling node model.dbt_idx.stg_eltool__state
[0m19:36:38.185020 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_idx.stg_eltool__state"
[0m19:36:38.191022 [debug] [Thread-1 (]: Timing info for model.dbt_idx.stg_eltool__state (compile): 19:36:38.182023 => 19:36:38.190021
[0m19:36:38.192021 [debug] [Thread-1 (]: Began executing node model.dbt_idx.stg_eltool__state
[0m19:36:38.196056 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_idx.stg_eltool__state"
[0m19:36:38.203084 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__state"
[0m19:36:38.204120 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__state: BEGIN
[0m19:36:38.204120 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:36:38.224802 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m19:36:38.225798 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__state"
[0m19:36:38.225798 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__state: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__state"} */

  create view "IDX-Stock"."IDX-Schema"."stg_eltool__state__dbt_tmp"
    
    
  as (
    with source as (select *
                from "IDX-Stock"."IDX-Schema"."state"),
     renamed as (select state_identifier::INT AS state_id,
                         state_code::VARCHAR(2) AS state_code,
                         st_name::VARCHAR(30) AS state_name
                 from source)
select *
from renamed
  );
[0m19:36:38.228834 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m19:36:38.233799 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__state"
[0m19:36:38.234804 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__state: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__state"} */
alter table "IDX-Stock"."IDX-Schema"."stg_eltool__state" rename to "stg_eltool__state__dbt_backup"
[0m19:36:38.238797 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:36:38.241832 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__state"
[0m19:36:38.242836 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__state: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__state"} */
alter table "IDX-Stock"."IDX-Schema"."stg_eltool__state__dbt_tmp" rename to "stg_eltool__state"
[0m19:36:38.245798 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:36:38.247833 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__state: COMMIT
[0m19:36:38.247833 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__state"
[0m19:36:38.248832 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__state: COMMIT
[0m19:36:38.252801 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m19:36:38.257836 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__state"
[0m19:36:38.257836 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__state: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__state"} */
drop view if exists "IDX-Stock"."IDX-Schema"."stg_eltool__state__dbt_backup" cascade
[0m19:36:38.262797 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m19:36:38.264797 [debug] [Thread-1 (]: Timing info for model.dbt_idx.stg_eltool__state (execute): 19:36:38.192021 => 19:36:38.263798
[0m19:36:38.264797 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__state: Close
[0m19:36:38.266822 [info ] [Thread-1 (]: 5 of 11 OK created sql view model IDX-Schema.stg_eltool__state ................. [[32mCREATE VIEW[0m in 0.09s]
[0m19:36:38.268799 [debug] [Thread-1 (]: Finished running node model.dbt_idx.stg_eltool__state
[0m19:36:38.269801 [debug] [Thread-1 (]: Began running node model.dbt_idx.stg_eltool__stock
[0m19:36:38.270797 [info ] [Thread-1 (]: 6 of 11 START sql view model IDX-Schema.stg_eltool__stock ...................... [RUN]
[0m19:36:38.271801 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_idx.stg_eltool__state, now model.dbt_idx.stg_eltool__stock)
[0m19:36:38.272799 [debug] [Thread-1 (]: Began compiling node model.dbt_idx.stg_eltool__stock
[0m19:36:38.276801 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_idx.stg_eltool__stock"
[0m19:36:38.282805 [debug] [Thread-1 (]: Timing info for model.dbt_idx.stg_eltool__stock (compile): 19:36:38.273810 => 19:36:38.282805
[0m19:36:38.283809 [debug] [Thread-1 (]: Began executing node model.dbt_idx.stg_eltool__stock
[0m19:36:38.288315 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_idx.stg_eltool__stock"
[0m19:36:38.295316 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__stock"
[0m19:36:38.296312 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__stock: BEGIN
[0m19:36:38.296312 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:36:38.319572 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m19:36:38.320615 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__stock"
[0m19:36:38.321571 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__stock: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__stock"} */

  create view "IDX-Stock"."IDX-Schema"."stg_eltool__stock__dbt_tmp"
    
    
  as (
    with source as (select *
                from "IDX-Stock"."IDX-Schema"."ksql-stock-stream"),
     renamed as (select *
                 from source)
select *
from renamed
  );
[0m19:36:38.324683 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m19:36:38.328747 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__stock"
[0m19:36:38.329777 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__stock: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__stock"} */
alter table "IDX-Stock"."IDX-Schema"."stg_eltool__stock" rename to "stg_eltool__stock__dbt_backup"
[0m19:36:38.331694 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:36:38.335718 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__stock"
[0m19:36:38.335718 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__stock: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__stock"} */
alter table "IDX-Stock"."IDX-Schema"."stg_eltool__stock__dbt_tmp" rename to "stg_eltool__stock"
[0m19:36:38.338695 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:36:38.341722 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__stock: COMMIT
[0m19:36:38.342695 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__stock"
[0m19:36:38.342695 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__stock: COMMIT
[0m19:36:38.346710 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m19:36:38.351693 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__stock"
[0m19:36:38.352695 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__stock: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__stock"} */
drop view if exists "IDX-Stock"."IDX-Schema"."stg_eltool__stock__dbt_backup" cascade
[0m19:36:38.356756 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m19:36:38.358804 [debug] [Thread-1 (]: Timing info for model.dbt_idx.stg_eltool__stock (execute): 19:36:38.283809 => 19:36:38.357767
[0m19:36:38.358804 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__stock: Close
[0m19:36:38.360773 [info ] [Thread-1 (]: 6 of 11 OK created sql view model IDX-Schema.stg_eltool__stock ................. [[32mCREATE VIEW[0m in 0.09s]
[0m19:36:38.362786 [debug] [Thread-1 (]: Finished running node model.dbt_idx.stg_eltool__stock
[0m19:36:38.363768 [debug] [Thread-1 (]: Began running node model.dbt_idx.fact_orders
[0m19:36:38.364766 [info ] [Thread-1 (]: 7 of 11 START sql table model IDX-Schema.fact_orders ........................... [RUN]
[0m19:36:38.365767 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_idx.stg_eltool__stock, now model.dbt_idx.fact_orders)
[0m19:36:38.366823 [debug] [Thread-1 (]: Began compiling node model.dbt_idx.fact_orders
[0m19:36:38.370765 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_idx.fact_orders"
[0m19:36:38.377322 [debug] [Thread-1 (]: Timing info for model.dbt_idx.fact_orders (compile): 19:36:38.367769 => 19:36:38.376290
[0m19:36:38.378283 [debug] [Thread-1 (]: Began executing node model.dbt_idx.fact_orders
[0m19:36:38.401360 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_idx.fact_orders"
[0m19:36:38.408117 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.fact_orders"
[0m19:36:38.409147 [debug] [Thread-1 (]: On model.dbt_idx.fact_orders: BEGIN
[0m19:36:38.409147 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:36:38.431613 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m19:36:38.432610 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.fact_orders"
[0m19:36:38.433614 [debug] [Thread-1 (]: On model.dbt_idx.fact_orders: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.fact_orders"} */

  
    

  create  table "IDX-Stock"."IDX-Schema"."fact_orders__dbt_tmp"
  
  
    as
  
  (
    with orders as (
    select *
    from "IDX-Stock"."IDX-Schema"."stg_eltool__orders"
)
select * from orders
  );
  
[0m19:36:38.441650 [debug] [Thread-1 (]: SQL status: SELECT 999 in 0.0 seconds
[0m19:36:38.445647 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.fact_orders"
[0m19:36:38.446651 [debug] [Thread-1 (]: On model.dbt_idx.fact_orders: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.fact_orders"} */
alter table "IDX-Stock"."IDX-Schema"."fact_orders" rename to "fact_orders__dbt_backup"
[0m19:36:38.449613 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:36:38.452646 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.fact_orders"
[0m19:36:38.453663 [debug] [Thread-1 (]: On model.dbt_idx.fact_orders: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.fact_orders"} */
alter table "IDX-Stock"."IDX-Schema"."fact_orders__dbt_tmp" rename to "fact_orders"
[0m19:36:38.455578 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:36:38.461611 [debug] [Thread-1 (]: On model.dbt_idx.fact_orders: COMMIT
[0m19:36:38.462589 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.fact_orders"
[0m19:36:38.462589 [debug] [Thread-1 (]: On model.dbt_idx.fact_orders: COMMIT
[0m19:36:38.466183 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m19:36:38.472196 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.fact_orders"
[0m19:36:38.472196 [debug] [Thread-1 (]: On model.dbt_idx.fact_orders: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.fact_orders"} */
drop table if exists "IDX-Stock"."IDX-Schema"."fact_orders__dbt_backup" cascade
[0m19:36:38.477212 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m19:36:38.479255 [debug] [Thread-1 (]: Timing info for model.dbt_idx.fact_orders (execute): 19:36:38.378283 => 19:36:38.478227
[0m19:36:38.480198 [debug] [Thread-1 (]: On model.dbt_idx.fact_orders: Close
[0m19:36:38.482197 [info ] [Thread-1 (]: 7 of 11 OK created sql table model IDX-Schema.fact_orders ...................... [[32mSELECT 999[0m in 0.12s]
[0m19:36:38.483199 [debug] [Thread-1 (]: Finished running node model.dbt_idx.fact_orders
[0m19:36:38.484231 [debug] [Thread-1 (]: Began running node model.dbt_idx.dim_customers
[0m19:36:38.485194 [info ] [Thread-1 (]: 8 of 11 START sql table model IDX-Schema.dim_customers ......................... [RUN]
[0m19:36:38.487231 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_idx.fact_orders, now model.dbt_idx.dim_customers)
[0m19:36:38.487231 [debug] [Thread-1 (]: Began compiling node model.dbt_idx.dim_customers
[0m19:36:38.491192 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_idx.dim_customers"
[0m19:36:38.497374 [debug] [Thread-1 (]: Timing info for model.dbt_idx.dim_customers (compile): 19:36:38.488228 => 19:36:38.496333
[0m19:36:38.498334 [debug] [Thread-1 (]: Began executing node model.dbt_idx.dim_customers
[0m19:36:38.504874 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_idx.dim_customers"
[0m19:36:38.510963 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.dim_customers"
[0m19:36:38.511994 [debug] [Thread-1 (]: On model.dbt_idx.dim_customers: BEGIN
[0m19:36:38.512960 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:36:38.534581 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m19:36:38.535588 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.dim_customers"
[0m19:36:38.536588 [debug] [Thread-1 (]: On model.dbt_idx.dim_customers: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.dim_customers"} */

  
    

  create  table "IDX-Stock"."IDX-Schema"."dim_customers__dbt_tmp"
  
  
    as
  
  (
    -- noinspection SqlDialectInspectionForFile

with customers as (
    select *
    from "IDX-Stock"."IDX-Schema"."stg_eltool__customers_snapshots"
    ),
     state as (
         select *
         from "IDX-Stock"."IDX-Schema"."stg_eltool__state"
     )
select c.customer_id,
       c.zipcode,
       c.city,
       c.state_code,
       s.state_name,
       c.datetime_created,
       c.datetime_updated,
       c.dbt_valid_from::TIMESTAMP as valid_from,
        CASE WHEN c.dbt_valid_to IS NULL
            THEN '9999-12-31'::TIMESTAMP
            ELSE c.dbt_valid_to::TIMESTAMP
        END as valid_to
from customers c
    join state s on c.state_code = s.state_code
  );
  
[0m19:36:38.541876 [debug] [Thread-1 (]: SQL status: SELECT 100 in 0.0 seconds
[0m19:36:38.545556 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.dim_customers"
[0m19:36:38.546558 [debug] [Thread-1 (]: On model.dbt_idx.dim_customers: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.dim_customers"} */
alter table "IDX-Stock"."IDX-Schema"."dim_customers" rename to "dim_customers__dbt_backup"
[0m19:36:38.547557 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:36:38.591086 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.dim_customers"
[0m19:36:38.592081 [debug] [Thread-1 (]: On model.dbt_idx.dim_customers: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.dim_customers"} */
alter table "IDX-Stock"."IDX-Schema"."dim_customers__dbt_tmp" rename to "dim_customers"
[0m19:36:38.594345 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:36:38.596379 [debug] [Thread-1 (]: On model.dbt_idx.dim_customers: COMMIT
[0m19:36:38.597382 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.dim_customers"
[0m19:36:38.598346 [debug] [Thread-1 (]: On model.dbt_idx.dim_customers: COMMIT
[0m19:36:38.601363 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m19:36:38.604363 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.dim_customers"
[0m19:36:38.605364 [debug] [Thread-1 (]: On model.dbt_idx.dim_customers: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.dim_customers"} */
drop table if exists "IDX-Stock"."IDX-Schema"."dim_customers__dbt_backup" cascade
[0m19:36:38.609363 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m19:36:38.611363 [debug] [Thread-1 (]: Timing info for model.dbt_idx.dim_customers (execute): 19:36:38.498334 => 19:36:38.611363
[0m19:36:38.612364 [debug] [Thread-1 (]: On model.dbt_idx.dim_customers: Close
[0m19:36:38.614367 [info ] [Thread-1 (]: 8 of 11 OK created sql table model IDX-Schema.dim_customers .................... [[32mSELECT 100[0m in 0.13s]
[0m19:36:38.615870 [debug] [Thread-1 (]: Finished running node model.dbt_idx.dim_customers
[0m19:36:38.616896 [debug] [Thread-1 (]: Began running node model.dbt_idx.fact_stocks
[0m19:36:38.617892 [info ] [Thread-1 (]: 9 of 11 START sql table model IDX-Schema.fact_stocks ........................... [RUN]
[0m19:36:38.619881 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_idx.dim_customers, now model.dbt_idx.fact_stocks)
[0m19:36:38.620880 [debug] [Thread-1 (]: Began compiling node model.dbt_idx.fact_stocks
[0m19:36:38.625879 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_idx.fact_stocks"
[0m19:36:38.632878 [debug] [Thread-1 (]: Timing info for model.dbt_idx.fact_stocks (compile): 19:36:38.621879 => 19:36:38.632878
[0m19:36:38.633878 [debug] [Thread-1 (]: Began executing node model.dbt_idx.fact_stocks
[0m19:36:38.639878 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_idx.fact_stocks"
[0m19:36:38.645394 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.fact_stocks"
[0m19:36:38.646430 [debug] [Thread-1 (]: On model.dbt_idx.fact_stocks: BEGIN
[0m19:36:38.647404 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:36:38.668134 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m19:36:38.669133 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.fact_stocks"
[0m19:36:38.670124 [debug] [Thread-1 (]: On model.dbt_idx.fact_stocks: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.fact_stocks"} */

  
    

  create  table "IDX-Stock"."IDX-Schema"."fact_stocks__dbt_tmp"
  
  
    as
  
  (
    -- noinspection SqlDialectInspectionForFile

with stock as (
    select *
    from "IDX-Stock"."IDX-Schema"."stg_eltool__stock"
    ),
     company as (
         select *
         from "IDX-Stock"."IDX-Schema"."stg_eltool__company"
     )
select a.id,
       a.ticker,
       b.name,
       a.date,
       a.open,
       a.high,
       a.low,
       a.close,
       a.volume,
       b.logo
from stock a
    join company b on a.ticker = b.ticker
  );
  
[0m19:36:38.707907 [debug] [Thread-1 (]: SQL status: SELECT 26131 in 0.0 seconds
[0m19:36:38.710918 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.fact_stocks"
[0m19:36:38.711918 [debug] [Thread-1 (]: On model.dbt_idx.fact_stocks: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.fact_stocks"} */
alter table "IDX-Stock"."IDX-Schema"."fact_stocks" rename to "fact_stocks__dbt_backup"
[0m19:36:38.713919 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:36:38.717429 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.fact_stocks"
[0m19:36:38.718433 [debug] [Thread-1 (]: On model.dbt_idx.fact_stocks: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.fact_stocks"} */
alter table "IDX-Stock"."IDX-Schema"."fact_stocks__dbt_tmp" rename to "fact_stocks"
[0m19:36:38.721159 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:36:38.723170 [debug] [Thread-1 (]: On model.dbt_idx.fact_stocks: COMMIT
[0m19:36:38.724169 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.fact_stocks"
[0m19:36:38.725170 [debug] [Thread-1 (]: On model.dbt_idx.fact_stocks: COMMIT
[0m19:36:38.737499 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m19:36:38.741517 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.fact_stocks"
[0m19:36:38.741517 [debug] [Thread-1 (]: On model.dbt_idx.fact_stocks: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.fact_stocks"} */
drop table if exists "IDX-Stock"."IDX-Schema"."fact_stocks__dbt_backup" cascade
[0m19:36:38.746811 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m19:36:38.748843 [debug] [Thread-1 (]: Timing info for model.dbt_idx.fact_stocks (execute): 19:36:38.634877 => 19:36:38.748843
[0m19:36:38.749818 [debug] [Thread-1 (]: On model.dbt_idx.fact_stocks: Close
[0m19:36:38.751813 [info ] [Thread-1 (]: 9 of 11 OK created sql table model IDX-Schema.fact_stocks ...................... [[32mSELECT 26131[0m in 0.13s]
[0m19:36:38.753811 [debug] [Thread-1 (]: Finished running node model.dbt_idx.fact_stocks
[0m19:36:38.754810 [debug] [Thread-1 (]: Began running node model.dbt_idx.customer_orders_status
[0m19:36:38.755808 [info ] [Thread-1 (]: 10 of 11 START sql view model IDX-Schema.customer_orders_status ................ [RUN]
[0m19:36:38.756812 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_idx.fact_stocks, now model.dbt_idx.customer_orders_status)
[0m19:36:38.757816 [debug] [Thread-1 (]: Began compiling node model.dbt_idx.customer_orders_status
[0m19:36:38.761811 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_idx.customer_orders_status"
[0m19:36:38.768154 [debug] [Thread-1 (]: Timing info for model.dbt_idx.customer_orders_status (compile): 19:36:38.757816 => 19:36:38.767158
[0m19:36:38.768154 [debug] [Thread-1 (]: Began executing node model.dbt_idx.customer_orders_status
[0m19:36:38.773154 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_idx.customer_orders_status"
[0m19:36:38.779664 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.customer_orders_status"
[0m19:36:38.780678 [debug] [Thread-1 (]: On model.dbt_idx.customer_orders_status: BEGIN
[0m19:36:38.780678 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:36:38.802424 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m19:36:38.802424 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.customer_orders_status"
[0m19:36:38.803453 [debug] [Thread-1 (]: On model.dbt_idx.customer_orders_status: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.customer_orders_status"} */

  create view "IDX-Stock"."IDX-Schema"."customer_orders_status__dbt_tmp"
    
    
  as (
    with orders as (select *
                from "IDX-Stock"."IDX-Schema"."fact_orders"),
     customers as (select *
                   from "IDX-Stock"."IDX-Schema"."dim_customers")
select o.order_id,
       o.customer_id,
       o.order_status,
       o.order_purchase_timestamp,
       o.order_approved_at,
       o.order_delivered_carrier_date,
       o.order_delivered_customer_date,
       o.order_estimated_delivery_date,
       c.zipcode    as customer_zipcode,
       c.city       as customer_city,
       c.state_code as customer_state_code,
       c.state_name as customer_state_name
from orders o
    join customers c on o.customer_id = c.customer_id
    and o.order_purchase_timestamp >= c.valid_from
    and o.order_purchase_timestamp <= c.valid_to
  );
[0m19:36:38.807425 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m19:36:38.811448 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.customer_orders_status"
[0m19:36:38.811448 [debug] [Thread-1 (]: On model.dbt_idx.customer_orders_status: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.customer_orders_status"} */
alter table "IDX-Stock"."IDX-Schema"."customer_orders_status__dbt_tmp" rename to "customer_orders_status"
[0m19:36:38.814314 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:36:38.815855 [debug] [Thread-1 (]: On model.dbt_idx.customer_orders_status: COMMIT
[0m19:36:38.816860 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.customer_orders_status"
[0m19:36:38.816860 [debug] [Thread-1 (]: On model.dbt_idx.customer_orders_status: COMMIT
[0m19:36:38.820316 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m19:36:38.825328 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.customer_orders_status"
[0m19:36:38.826322 [debug] [Thread-1 (]: On model.dbt_idx.customer_orders_status: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.customer_orders_status"} */
drop view if exists "IDX-Stock"."IDX-Schema"."customer_orders_status__dbt_backup" cascade
[0m19:36:38.829344 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m19:36:38.830354 [debug] [Thread-1 (]: Timing info for model.dbt_idx.customer_orders_status (execute): 19:36:38.769157 => 19:36:38.830354
[0m19:36:38.831353 [debug] [Thread-1 (]: On model.dbt_idx.customer_orders_status: Close
[0m19:36:38.833322 [info ] [Thread-1 (]: 10 of 11 OK created sql view model IDX-Schema.customer_orders_status ........... [[32mCREATE VIEW[0m in 0.08s]
[0m19:36:38.835321 [debug] [Thread-1 (]: Finished running node model.dbt_idx.customer_orders_status
[0m19:36:38.836321 [debug] [Thread-1 (]: Began running node model.dbt_idx.stock_update_status
[0m19:36:38.836321 [info ] [Thread-1 (]: 11 of 11 START sql view model IDX-Schema.stock_update_status ................... [RUN]
[0m19:36:38.838372 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_idx.customer_orders_status, now model.dbt_idx.stock_update_status)
[0m19:36:38.839335 [debug] [Thread-1 (]: Began compiling node model.dbt_idx.stock_update_status
[0m19:36:38.842354 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_idx.stock_update_status"
[0m19:36:38.848001 [debug] [Thread-1 (]: Timing info for model.dbt_idx.stock_update_status (compile): 19:36:38.840317 => 19:36:38.848001
[0m19:36:38.848999 [debug] [Thread-1 (]: Began executing node model.dbt_idx.stock_update_status
[0m19:36:38.855965 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_idx.stock_update_status"
[0m19:36:38.861965 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stock_update_status"
[0m19:36:38.862967 [debug] [Thread-1 (]: On model.dbt_idx.stock_update_status: BEGIN
[0m19:36:38.863966 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:36:38.886548 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m19:36:38.887514 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stock_update_status"
[0m19:36:38.887514 [debug] [Thread-1 (]: On model.dbt_idx.stock_update_status: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stock_update_status"} */

  create view "IDX-Stock"."IDX-Schema"."stock_update_status__dbt_tmp"
    
    
  as (
    with stock as (select *,
                      rank() over (
                       partition by a.ticker
                       order by a.date desc
                       ) as rank,
               from "IDX-Stock"."IDX-Schema"."fact_stocks")
select a.id,
       a.ticker,
       a.name,
       a.date,
       a.open,
       a.high,
       a.low,
       a.close,
       a.volume,
       a.rank,
       a.logo
from stock a
order by a.id desc
  );
[0m19:36:38.890513 [debug] [Thread-1 (]: Postgres adapter: Postgres error: syntax error at or near "from"
LINE 12:                from "IDX-Stock"."IDX-Schema"."fact_stocks")
                        ^

[0m19:36:38.890513 [debug] [Thread-1 (]: On model.dbt_idx.stock_update_status: ROLLBACK
[0m19:36:38.893547 [debug] [Thread-1 (]: Timing info for model.dbt_idx.stock_update_status (execute): 19:36:38.849967 => 19:36:38.893547
[0m19:36:38.894559 [debug] [Thread-1 (]: On model.dbt_idx.stock_update_status: Close
[0m19:36:38.907568 [debug] [Thread-1 (]: Database Error in model stock_update_status (models\marts\stock\stock_update_status.sql)
  syntax error at or near "from"
  LINE 12:                from "IDX-Stock"."IDX-Schema"."fact_stocks")
                          ^
  compiled Code at target\run\dbt_idx\models\marts\stock\stock_update_status.sql
[0m19:36:38.908604 [error] [Thread-1 (]: 11 of 11 ERROR creating sql view model IDX-Schema.stock_update_status .......... [[31mERROR[0m in 0.07s]
[0m19:36:38.910571 [debug] [Thread-1 (]: Finished running node model.dbt_idx.stock_update_status
[0m19:36:38.912573 [debug] [MainThread]: Using postgres connection "master"
[0m19:36:38.913566 [debug] [MainThread]: On master: BEGIN
[0m19:36:38.913566 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m19:36:38.935086 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m19:36:38.936089 [debug] [MainThread]: On master: COMMIT
[0m19:36:38.937104 [debug] [MainThread]: Using postgres connection "master"
[0m19:36:38.938084 [debug] [MainThread]: On master: COMMIT
[0m19:36:38.941088 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m19:36:38.942088 [debug] [MainThread]: On master: Close
[0m19:36:38.944087 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:36:38.946095 [debug] [MainThread]: Connection 'list_IDX-Stock' was properly closed.
[0m19:36:38.947097 [debug] [MainThread]: Connection 'list_IDX-Stock_IDX-Schema' was properly closed.
[0m19:36:38.948097 [debug] [MainThread]: Connection 'model.dbt_idx.stock_update_status' was properly closed.
[0m19:36:38.950091 [info ] [MainThread]: 
[0m19:36:38.951085 [info ] [MainThread]: Finished running 8 view models, 3 table models in 0 hours 0 minutes and 1.40 seconds (1.40s).
[0m19:36:38.954112 [debug] [MainThread]: Command end result
[0m19:36:38.977022 [info ] [MainThread]: 
[0m19:36:38.977986 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m19:36:38.978987 [info ] [MainThread]: 
[0m19:36:38.980009 [error] [MainThread]: [33mDatabase Error in model stock_update_status (models\marts\stock\stock_update_status.sql)[0m
[0m19:36:38.980987 [error] [MainThread]:   syntax error at or near "from"
[0m19:36:38.982027 [error] [MainThread]:   LINE 12:                from "IDX-Stock"."IDX-Schema"."fact_stocks")
[0m19:36:38.983045 [error] [MainThread]:                           ^
[0m19:36:38.984040 [error] [MainThread]:   compiled Code at target\run\dbt_idx\models\marts\stock\stock_update_status.sql
[0m19:36:38.985059 [info ] [MainThread]: 
[0m19:36:38.986039 [info ] [MainThread]: Done. PASS=10 WARN=0 ERROR=1 SKIP=0 TOTAL=11
[0m19:36:38.987038 [debug] [MainThread]: Command `dbt run` failed at 19:36:38.987038 after 1.91 seconds
[0m19:36:38.988039 [debug] [MainThread]: Flushing usage events


============================== 19:37:09.018907 | 7ab14a91-3ec7-46c0-ba6a-448ab4e62dfd ==============================
[0m19:37:09.018907 [info ] [MainThread]: Running with dbt=1.6.1
[0m19:37:09.023887 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'D:\\00 Project\\00 My Project\\IdeaProjects\\Py-DBT-IDX\\logs', 'version_check': 'True', 'profiles_dir': 'D:\\00 Project\\00 My Project\\IdeaProjects\\Py-DBT-IDX', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'False'}
[0m19:37:09.143421 [info ] [MainThread]: Registered adapter: postgres=1.6.1
[0m19:37:09.153908 [debug] [MainThread]: checksum: efe19d9f5b93d1a98cc804fbfcdb6b3aced98b974af664946fee1cde8837deb7, vars: {}, profile: , target: , version: 1.6.1
[0m19:37:09.309200 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m19:37:09.310227 [debug] [MainThread]: Partial parsing: updated file: dbt_idx://models\marts\stock\stock_update_status.sql
[0m19:37:09.410791 [info ] [MainThread]: Found 11 models, 1 snapshot, 18 tests, 5 sources, 0 exposures, 0 metrics, 349 macros, 0 groups, 0 semantic models
[0m19:37:09.412828 [info ] [MainThread]: 
[0m19:37:09.414827 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m19:37:09.417794 [debug] [ThreadPool]: Acquiring new postgres connection 'list_IDX-Stock'
[0m19:37:09.432796 [debug] [ThreadPool]: Using postgres connection "list_IDX-Stock"
[0m19:37:09.433800 [debug] [ThreadPool]: On list_IDX-Stock: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "connection_name": "list_IDX-Stock"} */

    select distinct nspname from pg_namespace
  
[0m19:37:09.434795 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:37:09.464848 [debug] [ThreadPool]: SQL status: SELECT 12 in 0.0 seconds
[0m19:37:09.466857 [debug] [ThreadPool]: On list_IDX-Stock: Close
[0m19:37:09.470846 [debug] [ThreadPool]: Acquiring new postgres connection 'list_IDX-Stock_IDX-Schema'
[0m19:37:09.479848 [debug] [ThreadPool]: Using postgres connection "list_IDX-Stock_IDX-Schema"
[0m19:37:09.480845 [debug] [ThreadPool]: On list_IDX-Stock_IDX-Schema: BEGIN
[0m19:37:09.480845 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:37:09.501268 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m19:37:09.502258 [debug] [ThreadPool]: Using postgres connection "list_IDX-Stock_IDX-Schema"
[0m19:37:09.502258 [debug] [ThreadPool]: On list_IDX-Stock_IDX-Schema: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "connection_name": "list_IDX-Stock_IDX-Schema"} */
select
      'IDX-Stock' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'IDX-Schema'
    union all
    select
      'IDX-Stock' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'IDX-Schema'
    union all
    select
      'IDX-Stock' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'IDX-Schema'
  
[0m19:37:09.506257 [debug] [ThreadPool]: SQL status: SELECT 16 in 0.0 seconds
[0m19:37:09.509283 [debug] [ThreadPool]: On list_IDX-Stock_IDX-Schema: ROLLBACK
[0m19:37:09.511265 [debug] [ThreadPool]: On list_IDX-Stock_IDX-Schema: Close
[0m19:37:09.513259 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_IDX-Stock_IDX-Schema, now list_IDX-Stock_snapshots)
[0m19:37:09.519257 [debug] [ThreadPool]: Using postgres connection "list_IDX-Stock_snapshots"
[0m19:37:09.519257 [debug] [ThreadPool]: On list_IDX-Stock_snapshots: BEGIN
[0m19:37:09.520258 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:37:09.541311 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m19:37:09.542297 [debug] [ThreadPool]: Using postgres connection "list_IDX-Stock_snapshots"
[0m19:37:09.543299 [debug] [ThreadPool]: On list_IDX-Stock_snapshots: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "connection_name": "list_IDX-Stock_snapshots"} */
select
      'IDX-Stock' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'snapshots'
    union all
    select
      'IDX-Stock' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'snapshots'
    union all
    select
      'IDX-Stock' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'snapshots'
  
[0m19:37:09.547315 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.0 seconds
[0m19:37:09.549300 [debug] [ThreadPool]: On list_IDX-Stock_snapshots: ROLLBACK
[0m19:37:09.551819 [debug] [ThreadPool]: On list_IDX-Stock_snapshots: Close
[0m19:37:09.558631 [debug] [MainThread]: Using postgres connection "master"
[0m19:37:09.559630 [debug] [MainThread]: On master: BEGIN
[0m19:37:09.560630 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:37:09.583399 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m19:37:09.584596 [debug] [MainThread]: Using postgres connection "master"
[0m19:37:09.585595 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m19:37:09.593599 [debug] [MainThread]: SQL status: SELECT 8 in 0.0 seconds
[0m19:37:09.597133 [debug] [MainThread]: On master: ROLLBACK
[0m19:37:09.599138 [debug] [MainThread]: Using postgres connection "master"
[0m19:37:09.600169 [debug] [MainThread]: On master: BEGIN
[0m19:37:09.603385 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m19:37:09.604386 [debug] [MainThread]: On master: COMMIT
[0m19:37:09.604386 [debug] [MainThread]: Using postgres connection "master"
[0m19:37:09.605382 [debug] [MainThread]: On master: COMMIT
[0m19:37:09.607385 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m19:37:09.608384 [debug] [MainThread]: On master: Close
[0m19:37:09.610428 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m19:37:09.611389 [info ] [MainThread]: 
[0m19:37:09.616491 [debug] [Thread-1 (]: Began running node model.dbt_idx.stg_eltool__company
[0m19:37:09.617503 [info ] [Thread-1 (]: 1 of 11 START sql view model IDX-Schema.stg_eltool__company .................... [RUN]
[0m19:37:09.619507 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.dbt_idx.stg_eltool__company'
[0m19:37:09.620506 [debug] [Thread-1 (]: Began compiling node model.dbt_idx.stg_eltool__company
[0m19:37:09.631054 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_idx.stg_eltool__company"
[0m19:37:09.638051 [debug] [Thread-1 (]: Timing info for model.dbt_idx.stg_eltool__company (compile): 19:37:09.621505 => 19:37:09.637034
[0m19:37:09.639038 [debug] [Thread-1 (]: Began executing node model.dbt_idx.stg_eltool__company
[0m19:37:09.673387 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_idx.stg_eltool__company"
[0m19:37:09.680386 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__company"
[0m19:37:09.680386 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__company: BEGIN
[0m19:37:09.681353 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m19:37:09.713355 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m19:37:09.714355 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__company"
[0m19:37:09.714355 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__company: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__company"} */

  create view "IDX-Stock"."IDX-Schema"."stg_eltool__company__dbt_tmp"
    
    
  as (
    with source as (select *
                from "IDX-Stock"."IDX-Schema"."ksql-company-stream"),
     renamed as (select id,
                        ticker,
                        name,
                        logo
                 from source)
select *
from renamed
  );
[0m19:37:09.718351 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m19:37:09.725865 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__company"
[0m19:37:09.725865 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__company: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__company"} */
alter table "IDX-Stock"."IDX-Schema"."stg_eltool__company" rename to "stg_eltool__company__dbt_backup"
[0m19:37:09.728867 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:37:09.732739 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__company"
[0m19:37:09.733739 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__company: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__company"} */
alter table "IDX-Stock"."IDX-Schema"."stg_eltool__company__dbt_tmp" rename to "stg_eltool__company"
[0m19:37:09.736738 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:37:09.753766 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__company: COMMIT
[0m19:37:09.754767 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__company"
[0m19:37:09.755766 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__company: COMMIT
[0m19:37:09.758767 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m19:37:09.769965 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__company"
[0m19:37:09.770565 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__company: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__company"} */
drop view if exists "IDX-Stock"."IDX-Schema"."stg_eltool__company__dbt_backup" cascade
[0m19:37:09.774623 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m19:37:09.776710 [debug] [Thread-1 (]: Timing info for model.dbt_idx.stg_eltool__company (execute): 19:37:09.639038 => 19:37:09.775701
[0m19:37:09.776710 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__company: Close
[0m19:37:09.778734 [info ] [Thread-1 (]: 1 of 11 OK created sql view model IDX-Schema.stg_eltool__company ............... [[32mCREATE VIEW[0m in 0.16s]
[0m19:37:09.781267 [debug] [Thread-1 (]: Finished running node model.dbt_idx.stg_eltool__company
[0m19:37:09.782256 [debug] [Thread-1 (]: Began running node model.dbt_idx.stg_eltool__customers
[0m19:37:09.783261 [info ] [Thread-1 (]: 2 of 11 START sql view model IDX-Schema.stg_eltool__customers .................. [RUN]
[0m19:37:09.784251 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_idx.stg_eltool__company, now model.dbt_idx.stg_eltool__customers)
[0m19:37:09.785252 [debug] [Thread-1 (]: Began compiling node model.dbt_idx.stg_eltool__customers
[0m19:37:09.788081 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_idx.stg_eltool__customers"
[0m19:37:09.795087 [debug] [Thread-1 (]: Timing info for model.dbt_idx.stg_eltool__customers (compile): 19:37:09.786266 => 19:37:09.795087
[0m19:37:09.796087 [debug] [Thread-1 (]: Began executing node model.dbt_idx.stg_eltool__customers
[0m19:37:09.800598 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_idx.stg_eltool__customers"
[0m19:37:09.806600 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__customers"
[0m19:37:09.807599 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__customers: BEGIN
[0m19:37:09.808599 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:37:09.837738 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m19:37:09.839727 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__customers"
[0m19:37:09.839727 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__customers: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__customers"} */

  create view "IDX-Stock"."IDX-Schema"."stg_eltool__customers__dbt_tmp"
    
    
  as (
    with source as (select *
                from "IDX-Stock"."IDX-Schema"."customers"),
     renamed as (select
                     customer_id,
                    'This is Dummy' as dummy
                 from source
                 where customer_id = 1234567890)
select *
from renamed
  );
[0m19:37:09.844730 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m19:37:09.848727 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__customers"
[0m19:37:09.849728 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__customers: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__customers"} */
alter table "IDX-Stock"."IDX-Schema"."stg_eltool__customers" rename to "stg_eltool__customers__dbt_backup"
[0m19:37:09.852240 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:37:09.855240 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__customers"
[0m19:37:09.855240 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__customers: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__customers"} */
alter table "IDX-Stock"."IDX-Schema"."stg_eltool__customers__dbt_tmp" rename to "stg_eltool__customers"
[0m19:37:09.857752 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:37:09.860751 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__customers: COMMIT
[0m19:37:09.860751 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__customers"
[0m19:37:09.861751 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__customers: COMMIT
[0m19:37:09.864706 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m19:37:09.867693 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__customers"
[0m19:37:09.868693 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__customers: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__customers"} */
drop view if exists "IDX-Stock"."IDX-Schema"."stg_eltool__customers__dbt_backup" cascade
[0m19:37:09.872695 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m19:37:09.874692 [debug] [Thread-1 (]: Timing info for model.dbt_idx.stg_eltool__customers (execute): 19:37:09.797090 => 19:37:09.874692
[0m19:37:09.875692 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__customers: Close
[0m19:37:09.876698 [info ] [Thread-1 (]: 2 of 11 OK created sql view model IDX-Schema.stg_eltool__customers ............. [[32mCREATE VIEW[0m in 0.09s]
[0m19:37:09.878710 [debug] [Thread-1 (]: Finished running node model.dbt_idx.stg_eltool__customers
[0m19:37:09.879695 [debug] [Thread-1 (]: Began running node model.dbt_idx.stg_eltool__customers_snapshots
[0m19:37:09.880695 [info ] [Thread-1 (]: 3 of 11 START sql view model IDX-Schema.stg_eltool__customers_snapshots ........ [RUN]
[0m19:37:09.882692 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_idx.stg_eltool__customers, now model.dbt_idx.stg_eltool__customers_snapshots)
[0m19:37:09.882692 [debug] [Thread-1 (]: Began compiling node model.dbt_idx.stg_eltool__customers_snapshots
[0m19:37:09.885692 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_idx.stg_eltool__customers_snapshots"
[0m19:37:09.892694 [debug] [Thread-1 (]: Timing info for model.dbt_idx.stg_eltool__customers_snapshots (compile): 19:37:09.883693 => 19:37:09.892694
[0m19:37:09.893694 [debug] [Thread-1 (]: Began executing node model.dbt_idx.stg_eltool__customers_snapshots
[0m19:37:09.899692 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_idx.stg_eltool__customers_snapshots"
[0m19:37:09.905390 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__customers_snapshots"
[0m19:37:09.906413 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__customers_snapshots: BEGIN
[0m19:37:09.907397 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:37:09.930905 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m19:37:09.931903 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__customers_snapshots"
[0m19:37:09.932906 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__customers_snapshots: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__customers_snapshots"} */

  create view "IDX-Stock"."IDX-Schema"."stg_eltool__customers_snapshots__dbt_tmp"
    
    
  as (
    with source as (select *
                from "IDX-Stock"."snapshots"."customers_snapshot"),
     renamed as (select customer_id,
                        zipcode,
                        city,
                        state_code,
                        datetime_created::TIMESTAMP AS datetime_created,
                        datetime_updated::TIMESTAMP AS datetime_updated,
                        dbt_valid_from,
                        dbt_valid_to
                 from source)
select *
from renamed
  );
[0m19:37:09.937913 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m19:37:09.941909 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__customers_snapshots"
[0m19:37:09.942942 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__customers_snapshots: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__customers_snapshots"} */
alter table "IDX-Stock"."IDX-Schema"."stg_eltool__customers_snapshots" rename to "stg_eltool__customers_snapshots__dbt_backup"
[0m19:37:09.945446 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:37:09.951949 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__customers_snapshots"
[0m19:37:09.952983 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__customers_snapshots: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__customers_snapshots"} */
alter table "IDX-Stock"."IDX-Schema"."stg_eltool__customers_snapshots__dbt_tmp" rename to "stg_eltool__customers_snapshots"
[0m19:37:09.954974 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:37:09.956971 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__customers_snapshots: COMMIT
[0m19:37:09.958021 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__customers_snapshots"
[0m19:37:09.958987 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__customers_snapshots: COMMIT
[0m19:37:09.961490 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m19:37:09.964536 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__customers_snapshots"
[0m19:37:09.965535 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__customers_snapshots: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__customers_snapshots"} */
drop view if exists "IDX-Stock"."IDX-Schema"."stg_eltool__customers_snapshots__dbt_backup" cascade
[0m19:37:09.969503 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m19:37:09.971502 [debug] [Thread-1 (]: Timing info for model.dbt_idx.stg_eltool__customers_snapshots (execute): 19:37:09.894693 => 19:37:09.970501
[0m19:37:09.971502 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__customers_snapshots: Close
[0m19:37:09.973502 [info ] [Thread-1 (]: 3 of 11 OK created sql view model IDX-Schema.stg_eltool__customers_snapshots ... [[32mCREATE VIEW[0m in 0.09s]
[0m19:37:09.975502 [debug] [Thread-1 (]: Finished running node model.dbt_idx.stg_eltool__customers_snapshots
[0m19:37:09.976507 [debug] [Thread-1 (]: Began running node model.dbt_idx.stg_eltool__orders
[0m19:37:09.977517 [info ] [Thread-1 (]: 4 of 11 START sql view model IDX-Schema.stg_eltool__orders ..................... [RUN]
[0m19:37:09.979042 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_idx.stg_eltool__customers_snapshots, now model.dbt_idx.stg_eltool__orders)
[0m19:37:09.979042 [debug] [Thread-1 (]: Began compiling node model.dbt_idx.stg_eltool__orders
[0m19:37:09.983071 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_idx.stg_eltool__orders"
[0m19:37:09.993067 [debug] [Thread-1 (]: Timing info for model.dbt_idx.stg_eltool__orders (compile): 19:37:09.980038 => 19:37:09.993067
[0m19:37:09.994048 [debug] [Thread-1 (]: Began executing node model.dbt_idx.stg_eltool__orders
[0m19:37:09.998074 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_idx.stg_eltool__orders"
[0m19:37:10.010037 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__orders"
[0m19:37:10.011035 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__orders: BEGIN
[0m19:37:10.011035 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:37:10.031097 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m19:37:10.032114 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__orders"
[0m19:37:10.032114 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__orders: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__orders"} */

  create view "IDX-Stock"."IDX-Schema"."stg_eltool__orders__dbt_tmp"
    
    
  as (
    with source as (select *
                from "IDX-Stock"."IDX-Schema"."orders"),
     renamed as (select order_id,
                        cust_id AS customer_id,
                        order_status,
                        order_purchase_timestamp::TIMESTAMP,
                        order_approved_at::TIMESTAMP,
                        order_delivered_carrier_date::TIMESTAMP,
                        order_delivered_customer_date::TIMESTAMP,
                        order_estimated_delivery_date::TIMESTAMP
                 from source)
select *
from renamed
  );
[0m19:37:10.036093 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m19:37:10.040136 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__orders"
[0m19:37:10.041135 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__orders: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__orders"} */
alter table "IDX-Stock"."IDX-Schema"."stg_eltool__orders" rename to "stg_eltool__orders__dbt_backup"
[0m19:37:10.043125 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:37:10.047102 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__orders"
[0m19:37:10.048107 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__orders: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__orders"} */
alter table "IDX-Stock"."IDX-Schema"."stg_eltool__orders__dbt_tmp" rename to "stg_eltool__orders"
[0m19:37:10.050104 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:37:10.052624 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__orders: COMMIT
[0m19:37:10.052624 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__orders"
[0m19:37:10.053625 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__orders: COMMIT
[0m19:37:10.057114 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m19:37:10.061144 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__orders"
[0m19:37:10.062160 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__orders: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__orders"} */
drop view if exists "IDX-Stock"."IDX-Schema"."stg_eltool__orders__dbt_backup" cascade
[0m19:37:10.065232 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m19:37:10.068210 [debug] [Thread-1 (]: Timing info for model.dbt_idx.stg_eltool__orders (execute): 19:37:09.994048 => 19:37:10.067223
[0m19:37:10.068210 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__orders: Close
[0m19:37:10.070214 [info ] [Thread-1 (]: 4 of 11 OK created sql view model IDX-Schema.stg_eltool__orders ................ [[32mCREATE VIEW[0m in 0.09s]
[0m19:37:10.072215 [debug] [Thread-1 (]: Finished running node model.dbt_idx.stg_eltool__orders
[0m19:37:10.073207 [debug] [Thread-1 (]: Began running node model.dbt_idx.stg_eltool__state
[0m19:37:10.074211 [info ] [Thread-1 (]: 5 of 11 START sql view model IDX-Schema.stg_eltool__state ...................... [RUN]
[0m19:37:10.076219 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_idx.stg_eltool__orders, now model.dbt_idx.stg_eltool__state)
[0m19:37:10.077208 [debug] [Thread-1 (]: Began compiling node model.dbt_idx.stg_eltool__state
[0m19:37:10.080246 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_idx.stg_eltool__state"
[0m19:37:10.087211 [debug] [Thread-1 (]: Timing info for model.dbt_idx.stg_eltool__state (compile): 19:37:10.078217 => 19:37:10.086245
[0m19:37:10.088211 [debug] [Thread-1 (]: Began executing node model.dbt_idx.stg_eltool__state
[0m19:37:10.093211 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_idx.stg_eltool__state"
[0m19:37:10.102210 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__state"
[0m19:37:10.102210 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__state: BEGIN
[0m19:37:10.103236 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:37:10.123279 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m19:37:10.124265 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__state"
[0m19:37:10.125285 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__state: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__state"} */

  create view "IDX-Stock"."IDX-Schema"."stg_eltool__state__dbt_tmp"
    
    
  as (
    with source as (select *
                from "IDX-Stock"."IDX-Schema"."state"),
     renamed as (select state_identifier::INT AS state_id,
                         state_code::VARCHAR(2) AS state_code,
                         st_name::VARCHAR(30) AS state_name
                 from source)
select *
from renamed
  );
[0m19:37:10.128261 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m19:37:10.132264 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__state"
[0m19:37:10.132264 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__state: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__state"} */
alter table "IDX-Stock"."IDX-Schema"."stg_eltool__state" rename to "stg_eltool__state__dbt_backup"
[0m19:37:10.135261 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:37:10.138267 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__state"
[0m19:37:10.139283 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__state: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__state"} */
alter table "IDX-Stock"."IDX-Schema"."stg_eltool__state__dbt_tmp" rename to "stg_eltool__state"
[0m19:37:10.141892 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:37:10.143926 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__state: COMMIT
[0m19:37:10.144911 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__state"
[0m19:37:10.144911 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__state: COMMIT
[0m19:37:10.149275 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m19:37:10.153860 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__state"
[0m19:37:10.153860 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__state: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__state"} */
drop view if exists "IDX-Stock"."IDX-Schema"."stg_eltool__state__dbt_backup" cascade
[0m19:37:10.158823 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m19:37:10.160824 [debug] [Thread-1 (]: Timing info for model.dbt_idx.stg_eltool__state (execute): 19:37:10.088211 => 19:37:10.159823
[0m19:37:10.160824 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__state: Close
[0m19:37:10.162825 [info ] [Thread-1 (]: 5 of 11 OK created sql view model IDX-Schema.stg_eltool__state ................. [[32mCREATE VIEW[0m in 0.09s]
[0m19:37:10.164829 [debug] [Thread-1 (]: Finished running node model.dbt_idx.stg_eltool__state
[0m19:37:10.165827 [debug] [Thread-1 (]: Began running node model.dbt_idx.stg_eltool__stock
[0m19:37:10.166827 [info ] [Thread-1 (]: 6 of 11 START sql view model IDX-Schema.stg_eltool__stock ...................... [RUN]
[0m19:37:10.167375 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_idx.stg_eltool__state, now model.dbt_idx.stg_eltool__stock)
[0m19:37:10.168832 [debug] [Thread-1 (]: Began compiling node model.dbt_idx.stg_eltool__stock
[0m19:37:10.171875 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_idx.stg_eltool__stock"
[0m19:37:10.177841 [debug] [Thread-1 (]: Timing info for model.dbt_idx.stg_eltool__stock (compile): 19:37:10.168832 => 19:37:10.176875
[0m19:37:10.177841 [debug] [Thread-1 (]: Began executing node model.dbt_idx.stg_eltool__stock
[0m19:37:10.182874 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_idx.stg_eltool__stock"
[0m19:37:10.189437 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__stock"
[0m19:37:10.190400 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__stock: BEGIN
[0m19:37:10.191400 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:37:10.211440 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m19:37:10.212442 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__stock"
[0m19:37:10.213451 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__stock: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__stock"} */

  create view "IDX-Stock"."IDX-Schema"."stg_eltool__stock__dbt_tmp"
    
    
  as (
    with source as (select *
                from "IDX-Stock"."IDX-Schema"."ksql-stock-stream"),
     renamed as (select *
                 from source)
select *
from renamed
  );
[0m19:37:10.218442 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m19:37:10.223443 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__stock"
[0m19:37:10.224440 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__stock: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__stock"} */
alter table "IDX-Stock"."IDX-Schema"."stg_eltool__stock" rename to "stg_eltool__stock__dbt_backup"
[0m19:37:10.227458 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:37:10.233439 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__stock"
[0m19:37:10.234434 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__stock: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__stock"} */
alter table "IDX-Stock"."IDX-Schema"."stg_eltool__stock__dbt_tmp" rename to "stg_eltool__stock"
[0m19:37:10.236620 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:37:10.238632 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__stock: COMMIT
[0m19:37:10.239660 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__stock"
[0m19:37:10.240633 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__stock: COMMIT
[0m19:37:10.242577 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m19:37:10.245601 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__stock"
[0m19:37:10.246611 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__stock: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__stock"} */
drop view if exists "IDX-Stock"."IDX-Schema"."stg_eltool__stock__dbt_backup" cascade
[0m19:37:10.250522 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m19:37:10.252056 [debug] [Thread-1 (]: Timing info for model.dbt_idx.stg_eltool__stock (execute): 19:37:10.178877 => 19:37:10.252056
[0m19:37:10.253087 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__stock: Close
[0m19:37:10.255085 [info ] [Thread-1 (]: 6 of 11 OK created sql view model IDX-Schema.stg_eltool__stock ................. [[32mCREATE VIEW[0m in 0.09s]
[0m19:37:10.257065 [debug] [Thread-1 (]: Finished running node model.dbt_idx.stg_eltool__stock
[0m19:37:10.257065 [debug] [Thread-1 (]: Began running node model.dbt_idx.fact_orders
[0m19:37:10.259065 [info ] [Thread-1 (]: 7 of 11 START sql table model IDX-Schema.fact_orders ........................... [RUN]
[0m19:37:10.260065 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_idx.stg_eltool__stock, now model.dbt_idx.fact_orders)
[0m19:37:10.261067 [debug] [Thread-1 (]: Began compiling node model.dbt_idx.fact_orders
[0m19:37:10.264104 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_idx.fact_orders"
[0m19:37:10.269066 [debug] [Thread-1 (]: Timing info for model.dbt_idx.fact_orders (compile): 19:37:10.261067 => 19:37:10.269066
[0m19:37:10.270086 [debug] [Thread-1 (]: Began executing node model.dbt_idx.fact_orders
[0m19:37:10.293097 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_idx.fact_orders"
[0m19:37:10.299067 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.fact_orders"
[0m19:37:10.300096 [debug] [Thread-1 (]: On model.dbt_idx.fact_orders: BEGIN
[0m19:37:10.300096 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:37:10.321279 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m19:37:10.322289 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.fact_orders"
[0m19:37:10.322289 [debug] [Thread-1 (]: On model.dbt_idx.fact_orders: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.fact_orders"} */

  
    

  create  table "IDX-Stock"."IDX-Schema"."fact_orders__dbt_tmp"
  
  
    as
  
  (
    with orders as (
    select *
    from "IDX-Stock"."IDX-Schema"."stg_eltool__orders"
)
select * from orders
  );
  
[0m19:37:10.328289 [debug] [Thread-1 (]: SQL status: SELECT 999 in 0.0 seconds
[0m19:37:10.332289 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.fact_orders"
[0m19:37:10.333288 [debug] [Thread-1 (]: On model.dbt_idx.fact_orders: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.fact_orders"} */
alter table "IDX-Stock"."IDX-Schema"."fact_orders" rename to "fact_orders__dbt_backup"
[0m19:37:10.335310 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:37:10.338295 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.fact_orders"
[0m19:37:10.339295 [debug] [Thread-1 (]: On model.dbt_idx.fact_orders: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.fact_orders"} */
alter table "IDX-Stock"."IDX-Schema"."fact_orders__dbt_tmp" rename to "fact_orders"
[0m19:37:10.341323 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:37:10.347295 [debug] [Thread-1 (]: On model.dbt_idx.fact_orders: COMMIT
[0m19:37:10.348295 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.fact_orders"
[0m19:37:10.348295 [debug] [Thread-1 (]: On model.dbt_idx.fact_orders: COMMIT
[0m19:37:10.351970 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m19:37:10.356983 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.fact_orders"
[0m19:37:10.357981 [debug] [Thread-1 (]: On model.dbt_idx.fact_orders: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.fact_orders"} */
drop table if exists "IDX-Stock"."IDX-Schema"."fact_orders__dbt_backup" cascade
[0m19:37:10.361662 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m19:37:10.363690 [debug] [Thread-1 (]: Timing info for model.dbt_idx.fact_orders (execute): 19:37:10.271098 => 19:37:10.363690
[0m19:37:10.364691 [debug] [Thread-1 (]: On model.dbt_idx.fact_orders: Close
[0m19:37:10.366659 [info ] [Thread-1 (]: 7 of 11 OK created sql table model IDX-Schema.fact_orders ...................... [[32mSELECT 999[0m in 0.11s]
[0m19:37:10.367661 [debug] [Thread-1 (]: Finished running node model.dbt_idx.fact_orders
[0m19:37:10.368660 [debug] [Thread-1 (]: Began running node model.dbt_idx.dim_customers
[0m19:37:10.370658 [info ] [Thread-1 (]: 8 of 11 START sql table model IDX-Schema.dim_customers ......................... [RUN]
[0m19:37:10.371662 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_idx.fact_orders, now model.dbt_idx.dim_customers)
[0m19:37:10.372659 [debug] [Thread-1 (]: Began compiling node model.dbt_idx.dim_customers
[0m19:37:10.376655 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_idx.dim_customers"
[0m19:37:10.384177 [debug] [Thread-1 (]: Timing info for model.dbt_idx.dim_customers (compile): 19:37:10.372659 => 19:37:10.384177
[0m19:37:10.385178 [debug] [Thread-1 (]: Began executing node model.dbt_idx.dim_customers
[0m19:37:10.391177 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_idx.dim_customers"
[0m19:37:10.397181 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.dim_customers"
[0m19:37:10.398178 [debug] [Thread-1 (]: On model.dbt_idx.dim_customers: BEGIN
[0m19:37:10.399143 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:37:10.420158 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m19:37:10.421149 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.dim_customers"
[0m19:37:10.422192 [debug] [Thread-1 (]: On model.dbt_idx.dim_customers: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.dim_customers"} */

  
    

  create  table "IDX-Stock"."IDX-Schema"."dim_customers__dbt_tmp"
  
  
    as
  
  (
    -- noinspection SqlDialectInspectionForFile

with customers as (
    select *
    from "IDX-Stock"."IDX-Schema"."stg_eltool__customers_snapshots"
    ),
     state as (
         select *
         from "IDX-Stock"."IDX-Schema"."stg_eltool__state"
     )
select c.customer_id,
       c.zipcode,
       c.city,
       c.state_code,
       s.state_name,
       c.datetime_created,
       c.datetime_updated,
       c.dbt_valid_from::TIMESTAMP as valid_from,
        CASE WHEN c.dbt_valid_to IS NULL
            THEN '9999-12-31'::TIMESTAMP
            ELSE c.dbt_valid_to::TIMESTAMP
        END as valid_to
from customers c
    join state s on c.state_code = s.state_code
  );
  
[0m19:37:10.427142 [debug] [Thread-1 (]: SQL status: SELECT 100 in 0.0 seconds
[0m19:37:10.431171 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.dim_customers"
[0m19:37:10.432163 [debug] [Thread-1 (]: On model.dbt_idx.dim_customers: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.dim_customers"} */
alter table "IDX-Stock"."IDX-Schema"."dim_customers" rename to "dim_customers__dbt_backup"
[0m19:37:10.434143 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:37:10.483353 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.dim_customers"
[0m19:37:10.484352 [debug] [Thread-1 (]: On model.dbt_idx.dim_customers: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.dim_customers"} */
alter table "IDX-Stock"."IDX-Schema"."dim_customers__dbt_tmp" rename to "dim_customers"
[0m19:37:10.486350 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:37:10.490317 [debug] [Thread-1 (]: On model.dbt_idx.dim_customers: COMMIT
[0m19:37:10.490317 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.dim_customers"
[0m19:37:10.491353 [debug] [Thread-1 (]: On model.dbt_idx.dim_customers: COMMIT
[0m19:37:10.494483 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m19:37:10.497527 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.dim_customers"
[0m19:37:10.498488 [debug] [Thread-1 (]: On model.dbt_idx.dim_customers: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.dim_customers"} */
drop table if exists "IDX-Stock"."IDX-Schema"."dim_customers__dbt_backup" cascade
[0m19:37:10.502549 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m19:37:10.504530 [debug] [Thread-1 (]: Timing info for model.dbt_idx.dim_customers (execute): 19:37:10.386162 => 19:37:10.504530
[0m19:37:10.505492 [debug] [Thread-1 (]: On model.dbt_idx.dim_customers: Close
[0m19:37:10.506490 [info ] [Thread-1 (]: 8 of 11 OK created sql table model IDX-Schema.dim_customers .................... [[32mSELECT 100[0m in 0.13s]
[0m19:37:10.508495 [debug] [Thread-1 (]: Finished running node model.dbt_idx.dim_customers
[0m19:37:10.509491 [debug] [Thread-1 (]: Began running node model.dbt_idx.fact_stocks
[0m19:37:10.510492 [info ] [Thread-1 (]: 9 of 11 START sql table model IDX-Schema.fact_stocks ........................... [RUN]
[0m19:37:10.511505 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_idx.dim_customers, now model.dbt_idx.fact_stocks)
[0m19:37:10.512532 [debug] [Thread-1 (]: Began compiling node model.dbt_idx.fact_stocks
[0m19:37:10.516494 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_idx.fact_stocks"
[0m19:37:10.522742 [debug] [Thread-1 (]: Timing info for model.dbt_idx.fact_stocks (compile): 19:37:10.513488 => 19:37:10.522742
[0m19:37:10.523693 [debug] [Thread-1 (]: Began executing node model.dbt_idx.fact_stocks
[0m19:37:10.528716 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_idx.fact_stocks"
[0m19:37:10.534501 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.fact_stocks"
[0m19:37:10.535471 [debug] [Thread-1 (]: On model.dbt_idx.fact_stocks: BEGIN
[0m19:37:10.536469 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:37:10.556843 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m19:37:10.557840 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.fact_stocks"
[0m19:37:10.558838 [debug] [Thread-1 (]: On model.dbt_idx.fact_stocks: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.fact_stocks"} */

  
    

  create  table "IDX-Stock"."IDX-Schema"."fact_stocks__dbt_tmp"
  
  
    as
  
  (
    -- noinspection SqlDialectInspectionForFile

with stock as (
    select *
    from "IDX-Stock"."IDX-Schema"."stg_eltool__stock"
    ),
     company as (
         select *
         from "IDX-Stock"."IDX-Schema"."stg_eltool__company"
     )
select a.id,
       a.ticker,
       b.name,
       a.date,
       a.open,
       a.high,
       a.low,
       a.close,
       a.volume,
       b.logo
from stock a
    join company b on a.ticker = b.ticker
  );
  
[0m19:37:10.596425 [debug] [Thread-1 (]: SQL status: SELECT 26131 in 0.0 seconds
[0m19:37:10.599425 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.fact_stocks"
[0m19:37:10.600460 [debug] [Thread-1 (]: On model.dbt_idx.fact_stocks: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.fact_stocks"} */
alter table "IDX-Stock"."IDX-Schema"."fact_stocks" rename to "fact_stocks__dbt_backup"
[0m19:37:10.602433 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:37:10.606005 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.fact_stocks"
[0m19:37:10.607000 [debug] [Thread-1 (]: On model.dbt_idx.fact_stocks: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.fact_stocks"} */
alter table "IDX-Stock"."IDX-Schema"."fact_stocks__dbt_tmp" rename to "fact_stocks"
[0m19:37:10.609973 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:37:10.612005 [debug] [Thread-1 (]: On model.dbt_idx.fact_stocks: COMMIT
[0m19:37:10.613004 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.fact_stocks"
[0m19:37:10.613971 [debug] [Thread-1 (]: On model.dbt_idx.fact_stocks: COMMIT
[0m19:37:10.620916 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m19:37:10.623942 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.fact_stocks"
[0m19:37:10.624941 [debug] [Thread-1 (]: On model.dbt_idx.fact_stocks: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.fact_stocks"} */
drop table if exists "IDX-Stock"."IDX-Schema"."fact_stocks__dbt_backup" cascade
[0m19:37:10.629942 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m19:37:10.631940 [debug] [Thread-1 (]: Timing info for model.dbt_idx.fact_stocks (execute): 19:37:10.524726 => 19:37:10.631940
[0m19:37:10.632939 [debug] [Thread-1 (]: On model.dbt_idx.fact_stocks: Close
[0m19:37:10.634931 [info ] [Thread-1 (]: 9 of 11 OK created sql table model IDX-Schema.fact_stocks ...................... [[32mSELECT 26131[0m in 0.12s]
[0m19:37:10.636943 [debug] [Thread-1 (]: Finished running node model.dbt_idx.fact_stocks
[0m19:37:10.637973 [debug] [Thread-1 (]: Began running node model.dbt_idx.customer_orders_status
[0m19:37:10.638953 [info ] [Thread-1 (]: 10 of 11 START sql view model IDX-Schema.customer_orders_status ................ [RUN]
[0m19:37:10.640975 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_idx.fact_stocks, now model.dbt_idx.customer_orders_status)
[0m19:37:10.640975 [debug] [Thread-1 (]: Began compiling node model.dbt_idx.customer_orders_status
[0m19:37:10.644977 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_idx.customer_orders_status"
[0m19:37:10.650885 [debug] [Thread-1 (]: Timing info for model.dbt_idx.customer_orders_status (compile): 19:37:10.641978 => 19:37:10.650885
[0m19:37:10.652412 [debug] [Thread-1 (]: Began executing node model.dbt_idx.customer_orders_status
[0m19:37:10.657418 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_idx.customer_orders_status"
[0m19:37:10.662359 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.customer_orders_status"
[0m19:37:10.663366 [debug] [Thread-1 (]: On model.dbt_idx.customer_orders_status: BEGIN
[0m19:37:10.664358 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:37:10.686093 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m19:37:10.686093 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.customer_orders_status"
[0m19:37:10.687093 [debug] [Thread-1 (]: On model.dbt_idx.customer_orders_status: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.customer_orders_status"} */

  create view "IDX-Stock"."IDX-Schema"."customer_orders_status__dbt_tmp"
    
    
  as (
    with orders as (select *
                from "IDX-Stock"."IDX-Schema"."fact_orders"),
     customers as (select *
                   from "IDX-Stock"."IDX-Schema"."dim_customers")
select o.order_id,
       o.customer_id,
       o.order_status,
       o.order_purchase_timestamp,
       o.order_approved_at,
       o.order_delivered_carrier_date,
       o.order_delivered_customer_date,
       o.order_estimated_delivery_date,
       c.zipcode    as customer_zipcode,
       c.city       as customer_city,
       c.state_code as customer_state_code,
       c.state_name as customer_state_name
from orders o
    join customers c on o.customer_id = c.customer_id
    and o.order_purchase_timestamp >= c.valid_from
    and o.order_purchase_timestamp <= c.valid_to
  );
[0m19:37:10.691491 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m19:37:10.694492 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.customer_orders_status"
[0m19:37:10.695491 [debug] [Thread-1 (]: On model.dbt_idx.customer_orders_status: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.customer_orders_status"} */
alter table "IDX-Stock"."IDX-Schema"."customer_orders_status__dbt_tmp" rename to "customer_orders_status"
[0m19:37:10.697490 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:37:10.699528 [debug] [Thread-1 (]: On model.dbt_idx.customer_orders_status: COMMIT
[0m19:37:10.700520 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.customer_orders_status"
[0m19:37:10.701493 [debug] [Thread-1 (]: On model.dbt_idx.customer_orders_status: COMMIT
[0m19:37:10.704492 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m19:37:10.707492 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.customer_orders_status"
[0m19:37:10.708491 [debug] [Thread-1 (]: On model.dbt_idx.customer_orders_status: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.customer_orders_status"} */
drop view if exists "IDX-Stock"."IDX-Schema"."customer_orders_status__dbt_backup" cascade
[0m19:37:10.710491 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m19:37:10.711492 [debug] [Thread-1 (]: Timing info for model.dbt_idx.customer_orders_status (execute): 19:37:10.652412 => 19:37:10.711492
[0m19:37:10.712492 [debug] [Thread-1 (]: On model.dbt_idx.customer_orders_status: Close
[0m19:37:10.714502 [info ] [Thread-1 (]: 10 of 11 OK created sql view model IDX-Schema.customer_orders_status ........... [[32mCREATE VIEW[0m in 0.07s]
[0m19:37:10.716498 [debug] [Thread-1 (]: Finished running node model.dbt_idx.customer_orders_status
[0m19:37:10.717504 [debug] [Thread-1 (]: Began running node model.dbt_idx.stock_update_status
[0m19:37:10.718506 [info ] [Thread-1 (]: 11 of 11 START sql view model IDX-Schema.stock_update_status ................... [RUN]
[0m19:37:10.719511 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_idx.customer_orders_status, now model.dbt_idx.stock_update_status)
[0m19:37:10.720491 [debug] [Thread-1 (]: Began compiling node model.dbt_idx.stock_update_status
[0m19:37:10.723492 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_idx.stock_update_status"
[0m19:37:10.730548 [debug] [Thread-1 (]: Timing info for model.dbt_idx.stock_update_status (compile): 19:37:10.720491 => 19:37:10.729550
[0m19:37:10.731550 [debug] [Thread-1 (]: Began executing node model.dbt_idx.stock_update_status
[0m19:37:10.741592 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_idx.stock_update_status"
[0m19:37:10.747556 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stock_update_status"
[0m19:37:10.748591 [debug] [Thread-1 (]: On model.dbt_idx.stock_update_status: BEGIN
[0m19:37:10.749622 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:37:10.772559 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m19:37:10.774728 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stock_update_status"
[0m19:37:10.776237 [debug] [Thread-1 (]: On model.dbt_idx.stock_update_status: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stock_update_status"} */

  create view "IDX-Stock"."IDX-Schema"."stock_update_status__dbt_tmp"
    
    
  as (
    with stock as (select *,
                        rank() over (
                        partition by a.ticker
                        order by a.date desc
                        ) as rank
               from "IDX-Stock"."IDX-Schema"."fact_stocks")
select a.id,
       a.ticker,
       a.name,
       a.date,
       a.open,
       a.high,
       a.low,
       a.close,
       a.volume,
       a.rank,
       a.logo
from stock a
order by a.id desc
  );
[0m19:37:10.779363 [debug] [Thread-1 (]: Postgres adapter: Postgres error: missing FROM-clause entry for table "a"
LINE 10:                         order by a.date desc
                                          ^

[0m19:37:10.780364 [debug] [Thread-1 (]: On model.dbt_idx.stock_update_status: ROLLBACK
[0m19:37:10.783432 [debug] [Thread-1 (]: Timing info for model.dbt_idx.stock_update_status (execute): 19:37:10.732581 => 19:37:10.782393
[0m19:37:10.783432 [debug] [Thread-1 (]: On model.dbt_idx.stock_update_status: Close
[0m19:37:10.796685 [debug] [Thread-1 (]: Database Error in model stock_update_status (models\marts\stock\stock_update_status.sql)
  missing FROM-clause entry for table "a"
  LINE 10:                         order by a.date desc
                                            ^
  compiled Code at target\run\dbt_idx\models\marts\stock\stock_update_status.sql
[0m19:37:10.798226 [error] [Thread-1 (]: 11 of 11 ERROR creating sql view model IDX-Schema.stock_update_status .......... [[31mERROR[0m in 0.08s]
[0m19:37:10.800268 [debug] [Thread-1 (]: Finished running node model.dbt_idx.stock_update_status
[0m19:37:10.802257 [debug] [MainThread]: Using postgres connection "master"
[0m19:37:10.802257 [debug] [MainThread]: On master: BEGIN
[0m19:37:10.803260 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m19:37:10.823167 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m19:37:10.824194 [debug] [MainThread]: On master: COMMIT
[0m19:37:10.824194 [debug] [MainThread]: Using postgres connection "master"
[0m19:37:10.825180 [debug] [MainThread]: On master: COMMIT
[0m19:37:10.828180 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m19:37:10.829179 [debug] [MainThread]: On master: Close
[0m19:37:10.830191 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:37:10.831195 [debug] [MainThread]: Connection 'list_IDX-Stock' was properly closed.
[0m19:37:10.832188 [debug] [MainThread]: Connection 'list_IDX-Stock_snapshots' was properly closed.
[0m19:37:10.833182 [debug] [MainThread]: Connection 'model.dbt_idx.stock_update_status' was properly closed.
[0m19:37:10.834182 [info ] [MainThread]: 
[0m19:37:10.835181 [info ] [MainThread]: Finished running 8 view models, 3 table models in 0 hours 0 minutes and 1.42 seconds (1.42s).
[0m19:37:10.838183 [debug] [MainThread]: Command end result
[0m19:37:10.862789 [info ] [MainThread]: 
[0m19:37:10.863773 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m19:37:10.865769 [info ] [MainThread]: 
[0m19:37:10.866772 [error] [MainThread]: [33mDatabase Error in model stock_update_status (models\marts\stock\stock_update_status.sql)[0m
[0m19:37:10.867774 [error] [MainThread]:   missing FROM-clause entry for table "a"
[0m19:37:10.868774 [error] [MainThread]:   LINE 10:                         order by a.date desc
[0m19:37:10.870768 [error] [MainThread]:                                             ^
[0m19:37:10.871770 [error] [MainThread]:   compiled Code at target\run\dbt_idx\models\marts\stock\stock_update_status.sql
[0m19:37:10.872774 [info ] [MainThread]: 
[0m19:37:10.873771 [info ] [MainThread]: Done. PASS=10 WARN=0 ERROR=1 SKIP=0 TOTAL=11
[0m19:37:10.875769 [debug] [MainThread]: Command `dbt run` failed at 19:37:10.875769 after 1.89 seconds
[0m19:37:10.876772 [debug] [MainThread]: Flushing usage events


============================== 19:37:35.540777 | e87b1f4e-fd6b-4703-a783-62ec9997865b ==============================
[0m19:37:35.540777 [info ] [MainThread]: Running with dbt=1.6.1
[0m19:37:35.545777 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'D:\\00 Project\\00 My Project\\IdeaProjects\\Py-DBT-IDX', 'version_check': 'True', 'warn_error': 'None', 'log_path': 'D:\\00 Project\\00 My Project\\IdeaProjects\\Py-DBT-IDX\\logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'False'}
[0m19:37:35.691774 [info ] [MainThread]: Registered adapter: postgres=1.6.1
[0m19:37:35.705771 [debug] [MainThread]: checksum: efe19d9f5b93d1a98cc804fbfcdb6b3aced98b974af664946fee1cde8837deb7, vars: {}, profile: , target: , version: 1.6.1
[0m19:37:35.909923 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m19:37:35.911946 [debug] [MainThread]: Partial parsing: updated file: dbt_idx://models\marts\stock\stock_update_status.sql
[0m19:37:36.050195 [info ] [MainThread]: Found 11 models, 1 snapshot, 18 tests, 5 sources, 0 exposures, 0 metrics, 349 macros, 0 groups, 0 semantic models
[0m19:37:36.054194 [info ] [MainThread]: 
[0m19:37:36.055730 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m19:37:36.059813 [debug] [ThreadPool]: Acquiring new postgres connection 'list_IDX-Stock'
[0m19:37:36.071737 [debug] [ThreadPool]: Using postgres connection "list_IDX-Stock"
[0m19:37:36.072738 [debug] [ThreadPool]: On list_IDX-Stock: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "connection_name": "list_IDX-Stock"} */

    select distinct nspname from pg_namespace
  
[0m19:37:36.072738 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:37:36.104346 [debug] [ThreadPool]: SQL status: SELECT 12 in 0.0 seconds
[0m19:37:36.106833 [debug] [ThreadPool]: On list_IDX-Stock: Close
[0m19:37:36.110796 [debug] [ThreadPool]: Acquiring new postgres connection 'list_IDX-Stock_IDX-Schema'
[0m19:37:36.117796 [debug] [ThreadPool]: Using postgres connection "list_IDX-Stock_IDX-Schema"
[0m19:37:36.118813 [debug] [ThreadPool]: On list_IDX-Stock_IDX-Schema: BEGIN
[0m19:37:36.119797 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:37:36.142003 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m19:37:36.143205 [debug] [ThreadPool]: Using postgres connection "list_IDX-Stock_IDX-Schema"
[0m19:37:36.144208 [debug] [ThreadPool]: On list_IDX-Stock_IDX-Schema: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "connection_name": "list_IDX-Stock_IDX-Schema"} */
select
      'IDX-Stock' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'IDX-Schema'
    union all
    select
      'IDX-Stock' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'IDX-Schema'
    union all
    select
      'IDX-Stock' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'IDX-Schema'
  
[0m19:37:36.150204 [debug] [ThreadPool]: SQL status: SELECT 16 in 0.0 seconds
[0m19:37:36.152204 [debug] [ThreadPool]: On list_IDX-Stock_IDX-Schema: ROLLBACK
[0m19:37:36.154203 [debug] [ThreadPool]: On list_IDX-Stock_IDX-Schema: Close
[0m19:37:36.156203 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_IDX-Stock_IDX-Schema, now list_IDX-Stock_snapshots)
[0m19:37:36.163307 [debug] [ThreadPool]: Using postgres connection "list_IDX-Stock_snapshots"
[0m19:37:36.164306 [debug] [ThreadPool]: On list_IDX-Stock_snapshots: BEGIN
[0m19:37:36.165307 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:37:36.187106 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m19:37:36.188108 [debug] [ThreadPool]: Using postgres connection "list_IDX-Stock_snapshots"
[0m19:37:36.188108 [debug] [ThreadPool]: On list_IDX-Stock_snapshots: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "connection_name": "list_IDX-Stock_snapshots"} */
select
      'IDX-Stock' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'snapshots'
    union all
    select
      'IDX-Stock' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'snapshots'
    union all
    select
      'IDX-Stock' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'snapshots'
  
[0m19:37:36.193103 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.0 seconds
[0m19:37:36.194105 [debug] [ThreadPool]: On list_IDX-Stock_snapshots: ROLLBACK
[0m19:37:36.197105 [debug] [ThreadPool]: On list_IDX-Stock_snapshots: Close
[0m19:37:36.203235 [debug] [MainThread]: Using postgres connection "master"
[0m19:37:36.204235 [debug] [MainThread]: On master: BEGIN
[0m19:37:36.205238 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:37:36.228571 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m19:37:36.229581 [debug] [MainThread]: Using postgres connection "master"
[0m19:37:36.230582 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m19:37:36.238115 [debug] [MainThread]: SQL status: SELECT 8 in 0.0 seconds
[0m19:37:36.241152 [debug] [MainThread]: On master: ROLLBACK
[0m19:37:36.244116 [debug] [MainThread]: Using postgres connection "master"
[0m19:37:36.244116 [debug] [MainThread]: On master: BEGIN
[0m19:37:36.248118 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m19:37:36.249115 [debug] [MainThread]: On master: COMMIT
[0m19:37:36.249115 [debug] [MainThread]: Using postgres connection "master"
[0m19:37:36.250115 [debug] [MainThread]: On master: COMMIT
[0m19:37:36.252127 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m19:37:36.253132 [debug] [MainThread]: On master: Close
[0m19:37:36.254306 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m19:37:36.256300 [info ] [MainThread]: 
[0m19:37:36.262297 [debug] [Thread-1 (]: Began running node model.dbt_idx.stg_eltool__company
[0m19:37:36.263301 [info ] [Thread-1 (]: 1 of 11 START sql view model IDX-Schema.stg_eltool__company .................... [RUN]
[0m19:37:36.265298 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.dbt_idx.stg_eltool__company'
[0m19:37:36.266297 [debug] [Thread-1 (]: Began compiling node model.dbt_idx.stg_eltool__company
[0m19:37:36.277998 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_idx.stg_eltool__company"
[0m19:37:36.286459 [debug] [Thread-1 (]: Timing info for model.dbt_idx.stg_eltool__company (compile): 19:37:36.267361 => 19:37:36.286459
[0m19:37:36.287467 [debug] [Thread-1 (]: Began executing node model.dbt_idx.stg_eltool__company
[0m19:37:36.325554 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_idx.stg_eltool__company"
[0m19:37:36.332970 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__company"
[0m19:37:36.333969 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__company: BEGIN
[0m19:37:36.334932 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m19:37:36.357057 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m19:37:36.358095 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__company"
[0m19:37:36.359320 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__company: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__company"} */

  create view "IDX-Stock"."IDX-Schema"."stg_eltool__company__dbt_tmp"
    
    
  as (
    with source as (select *
                from "IDX-Stock"."IDX-Schema"."ksql-company-stream"),
     renamed as (select id,
                        ticker,
                        name,
                        logo
                 from source)
select *
from renamed
  );
[0m19:37:36.362328 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m19:37:36.370323 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__company"
[0m19:37:36.370323 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__company: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__company"} */
alter table "IDX-Stock"."IDX-Schema"."stg_eltool__company" rename to "stg_eltool__company__dbt_backup"
[0m19:37:36.373326 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:37:36.377357 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__company"
[0m19:37:36.378365 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__company: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__company"} */
alter table "IDX-Stock"."IDX-Schema"."stg_eltool__company__dbt_tmp" rename to "stg_eltool__company"
[0m19:37:36.380368 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:37:36.406551 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__company: COMMIT
[0m19:37:36.407551 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__company"
[0m19:37:36.408554 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__company: COMMIT
[0m19:37:36.411548 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m19:37:36.428166 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__company"
[0m19:37:36.430137 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__company: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__company"} */
drop view if exists "IDX-Stock"."IDX-Schema"."stg_eltool__company__dbt_backup" cascade
[0m19:37:36.434173 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m19:37:36.436168 [debug] [Thread-1 (]: Timing info for model.dbt_idx.stg_eltool__company (execute): 19:37:36.288462 => 19:37:36.436168
[0m19:37:36.437130 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__company: Close
[0m19:37:36.439653 [info ] [Thread-1 (]: 1 of 11 OK created sql view model IDX-Schema.stg_eltool__company ............... [[32mCREATE VIEW[0m in 0.17s]
[0m19:37:36.441652 [debug] [Thread-1 (]: Finished running node model.dbt_idx.stg_eltool__company
[0m19:37:36.442647 [debug] [Thread-1 (]: Began running node model.dbt_idx.stg_eltool__customers
[0m19:37:36.443684 [info ] [Thread-1 (]: 2 of 11 START sql view model IDX-Schema.stg_eltool__customers .................. [RUN]
[0m19:37:36.445648 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_idx.stg_eltool__company, now model.dbt_idx.stg_eltool__customers)
[0m19:37:36.446694 [debug] [Thread-1 (]: Began compiling node model.dbt_idx.stg_eltool__customers
[0m19:37:36.450684 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_idx.stg_eltool__customers"
[0m19:37:36.458648 [debug] [Thread-1 (]: Timing info for model.dbt_idx.stg_eltool__customers (compile): 19:37:36.447655 => 19:37:36.458648
[0m19:37:36.459869 [debug] [Thread-1 (]: Began executing node model.dbt_idx.stg_eltool__customers
[0m19:37:36.468895 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_idx.stg_eltool__customers"
[0m19:37:36.476382 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__customers"
[0m19:37:36.477400 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__customers: BEGIN
[0m19:37:36.478385 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:37:36.507575 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m19:37:36.508550 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__customers"
[0m19:37:36.509550 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__customers: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__customers"} */

  create view "IDX-Stock"."IDX-Schema"."stg_eltool__customers__dbt_tmp"
    
    
  as (
    with source as (select *
                from "IDX-Stock"."IDX-Schema"."customers"),
     renamed as (select
                     customer_id,
                    'This is Dummy' as dummy
                 from source
                 where customer_id = 1234567890)
select *
from renamed
  );
[0m19:37:36.513601 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m19:37:36.517144 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__customers"
[0m19:37:36.518108 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__customers: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__customers"} */
alter table "IDX-Stock"."IDX-Schema"."stg_eltool__customers" rename to "stg_eltool__customers__dbt_backup"
[0m19:37:36.521126 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:37:36.525143 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__customers"
[0m19:37:36.526121 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__customers: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__customers"} */
alter table "IDX-Stock"."IDX-Schema"."stg_eltool__customers__dbt_tmp" rename to "stg_eltool__customers"
[0m19:37:36.528145 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:37:36.531144 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__customers: COMMIT
[0m19:37:36.531144 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__customers"
[0m19:37:36.532145 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__customers: COMMIT
[0m19:37:36.536168 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m19:37:36.540198 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__customers"
[0m19:37:36.541198 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__customers: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__customers"} */
drop view if exists "IDX-Stock"."IDX-Schema"."stg_eltool__customers__dbt_backup" cascade
[0m19:37:36.545197 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m19:37:36.547198 [debug] [Thread-1 (]: Timing info for model.dbt_idx.stg_eltool__customers (execute): 19:37:36.461876 => 19:37:36.547198
[0m19:37:36.548199 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__customers: Close
[0m19:37:36.550711 [info ] [Thread-1 (]: 2 of 11 OK created sql view model IDX-Schema.stg_eltool__customers ............. [[32mCREATE VIEW[0m in 0.10s]
[0m19:37:36.551746 [debug] [Thread-1 (]: Finished running node model.dbt_idx.stg_eltool__customers
[0m19:37:36.553750 [debug] [Thread-1 (]: Began running node model.dbt_idx.stg_eltool__customers_snapshots
[0m19:37:36.554772 [info ] [Thread-1 (]: 3 of 11 START sql view model IDX-Schema.stg_eltool__customers_snapshots ........ [RUN]
[0m19:37:36.556745 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_idx.stg_eltool__customers, now model.dbt_idx.stg_eltool__customers_snapshots)
[0m19:37:36.556745 [debug] [Thread-1 (]: Began compiling node model.dbt_idx.stg_eltool__customers_snapshots
[0m19:37:36.563501 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_idx.stg_eltool__customers_snapshots"
[0m19:37:36.569533 [debug] [Thread-1 (]: Timing info for model.dbt_idx.stg_eltool__customers_snapshots (compile): 19:37:36.557749 => 19:37:36.569533
[0m19:37:36.571135 [debug] [Thread-1 (]: Began executing node model.dbt_idx.stg_eltool__customers_snapshots
[0m19:37:36.578088 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_idx.stg_eltool__customers_snapshots"
[0m19:37:36.584091 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__customers_snapshots"
[0m19:37:36.585603 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__customers_snapshots: BEGIN
[0m19:37:36.586615 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:37:36.610877 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m19:37:36.611886 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__customers_snapshots"
[0m19:37:36.611886 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__customers_snapshots: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__customers_snapshots"} */

  create view "IDX-Stock"."IDX-Schema"."stg_eltool__customers_snapshots__dbt_tmp"
    
    
  as (
    with source as (select *
                from "IDX-Stock"."snapshots"."customers_snapshot"),
     renamed as (select customer_id,
                        zipcode,
                        city,
                        state_code,
                        datetime_created::TIMESTAMP AS datetime_created,
                        datetime_updated::TIMESTAMP AS datetime_updated,
                        dbt_valid_from,
                        dbt_valid_to
                 from source)
select *
from renamed
  );
[0m19:37:36.616425 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m19:37:36.621440 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__customers_snapshots"
[0m19:37:36.622427 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__customers_snapshots: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__customers_snapshots"} */
alter table "IDX-Stock"."IDX-Schema"."stg_eltool__customers_snapshots" rename to "stg_eltool__customers_snapshots__dbt_backup"
[0m19:37:36.624441 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:37:36.628111 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__customers_snapshots"
[0m19:37:36.629080 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__customers_snapshots: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__customers_snapshots"} */
alter table "IDX-Stock"."IDX-Schema"."stg_eltool__customers_snapshots__dbt_tmp" rename to "stg_eltool__customers_snapshots"
[0m19:37:36.632081 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:37:36.634114 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__customers_snapshots: COMMIT
[0m19:37:36.635617 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__customers_snapshots"
[0m19:37:36.636634 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__customers_snapshots: COMMIT
[0m19:37:36.639625 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m19:37:36.643661 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__customers_snapshots"
[0m19:37:36.644639 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__customers_snapshots: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__customers_snapshots"} */
drop view if exists "IDX-Stock"."IDX-Schema"."stg_eltool__customers_snapshots__dbt_backup" cascade
[0m19:37:36.648627 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m19:37:36.651624 [debug] [Thread-1 (]: Timing info for model.dbt_idx.stg_eltool__customers_snapshots (execute): 19:37:36.573105 => 19:37:36.650624
[0m19:37:36.651624 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__customers_snapshots: Close
[0m19:37:36.654640 [info ] [Thread-1 (]: 3 of 11 OK created sql view model IDX-Schema.stg_eltool__customers_snapshots ... [[32mCREATE VIEW[0m in 0.10s]
[0m19:37:36.656146 [debug] [Thread-1 (]: Finished running node model.dbt_idx.stg_eltool__customers_snapshots
[0m19:37:36.657176 [debug] [Thread-1 (]: Began running node model.dbt_idx.stg_eltool__orders
[0m19:37:36.658153 [info ] [Thread-1 (]: 4 of 11 START sql view model IDX-Schema.stg_eltool__orders ..................... [RUN]
[0m19:37:36.660157 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_idx.stg_eltool__customers_snapshots, now model.dbt_idx.stg_eltool__orders)
[0m19:37:36.662188 [debug] [Thread-1 (]: Began compiling node model.dbt_idx.stg_eltool__orders
[0m19:37:36.670128 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_idx.stg_eltool__orders"
[0m19:37:36.682633 [debug] [Thread-1 (]: Timing info for model.dbt_idx.stg_eltool__orders (compile): 19:37:36.663154 => 19:37:36.681630
[0m19:37:36.684667 [debug] [Thread-1 (]: Began executing node model.dbt_idx.stg_eltool__orders
[0m19:37:36.691159 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_idx.stg_eltool__orders"
[0m19:37:36.704673 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__orders"
[0m19:37:36.705674 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__orders: BEGIN
[0m19:37:36.705674 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:37:36.730188 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m19:37:36.731339 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__orders"
[0m19:37:36.732365 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__orders: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__orders"} */

  create view "IDX-Stock"."IDX-Schema"."stg_eltool__orders__dbt_tmp"
    
    
  as (
    with source as (select *
                from "IDX-Stock"."IDX-Schema"."orders"),
     renamed as (select order_id,
                        cust_id AS customer_id,
                        order_status,
                        order_purchase_timestamp::TIMESTAMP,
                        order_approved_at::TIMESTAMP,
                        order_delivered_carrier_date::TIMESTAMP,
                        order_delivered_customer_date::TIMESTAMP,
                        order_estimated_delivery_date::TIMESTAMP
                 from source)
select *
from renamed
  );
[0m19:37:36.736329 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m19:37:36.740363 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__orders"
[0m19:37:36.741993 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__orders: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__orders"} */
alter table "IDX-Stock"."IDX-Schema"."stg_eltool__orders" rename to "stg_eltool__orders__dbt_backup"
[0m19:37:36.744334 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:37:36.748364 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__orders"
[0m19:37:36.749332 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__orders: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__orders"} */
alter table "IDX-Stock"."IDX-Schema"."stg_eltool__orders__dbt_tmp" rename to "stg_eltool__orders"
[0m19:37:36.751887 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:37:36.753912 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__orders: COMMIT
[0m19:37:36.754915 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__orders"
[0m19:37:36.755911 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__orders: COMMIT
[0m19:37:36.759897 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m19:37:36.763912 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__orders"
[0m19:37:36.764883 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__orders: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__orders"} */
drop view if exists "IDX-Stock"."IDX-Schema"."stg_eltool__orders__dbt_backup" cascade
[0m19:37:36.768877 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m19:37:36.771553 [debug] [Thread-1 (]: Timing info for model.dbt_idx.stg_eltool__orders (execute): 19:37:36.685634 => 19:37:36.771553
[0m19:37:36.771933 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__orders: Close
[0m19:37:36.773937 [info ] [Thread-1 (]: 4 of 11 OK created sql view model IDX-Schema.stg_eltool__orders ................ [[32mCREATE VIEW[0m in 0.11s]
[0m19:37:36.775914 [debug] [Thread-1 (]: Finished running node model.dbt_idx.stg_eltool__orders
[0m19:37:36.776915 [debug] [Thread-1 (]: Began running node model.dbt_idx.stg_eltool__state
[0m19:37:36.777948 [info ] [Thread-1 (]: 5 of 11 START sql view model IDX-Schema.stg_eltool__state ...................... [RUN]
[0m19:37:36.780489 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_idx.stg_eltool__orders, now model.dbt_idx.stg_eltool__state)
[0m19:37:36.780489 [debug] [Thread-1 (]: Began compiling node model.dbt_idx.stg_eltool__state
[0m19:37:36.784497 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_idx.stg_eltool__state"
[0m19:37:36.792036 [debug] [Thread-1 (]: Timing info for model.dbt_idx.stg_eltool__state (compile): 19:37:36.781498 => 19:37:36.791045
[0m19:37:36.793007 [debug] [Thread-1 (]: Began executing node model.dbt_idx.stg_eltool__state
[0m19:37:36.798033 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_idx.stg_eltool__state"
[0m19:37:36.806009 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__state"
[0m19:37:36.807018 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__state: BEGIN
[0m19:37:36.808027 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:37:36.834123 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m19:37:36.835121 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__state"
[0m19:37:36.836123 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__state: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__state"} */

  create view "IDX-Stock"."IDX-Schema"."stg_eltool__state__dbt_tmp"
    
    
  as (
    with source as (select *
                from "IDX-Stock"."IDX-Schema"."state"),
     renamed as (select state_identifier::INT AS state_id,
                         state_code::VARCHAR(2) AS state_code,
                         st_name::VARCHAR(30) AS state_name
                 from source)
select *
from renamed
  );
[0m19:37:36.839125 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m19:37:36.843148 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__state"
[0m19:37:36.844146 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__state: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__state"} */
alter table "IDX-Stock"."IDX-Schema"."stg_eltool__state" rename to "stg_eltool__state__dbt_backup"
[0m19:37:36.846684 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:37:36.850726 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__state"
[0m19:37:36.852692 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__state: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__state"} */
alter table "IDX-Stock"."IDX-Schema"."stg_eltool__state__dbt_tmp" rename to "stg_eltool__state"
[0m19:37:36.856708 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:37:36.859731 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__state: COMMIT
[0m19:37:36.860730 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__state"
[0m19:37:36.861691 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__state: COMMIT
[0m19:37:36.865691 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m19:37:36.870246 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__state"
[0m19:37:36.871258 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__state: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__state"} */
drop view if exists "IDX-Stock"."IDX-Schema"."stg_eltool__state__dbt_backup" cascade
[0m19:37:36.875254 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m19:37:36.877294 [debug] [Thread-1 (]: Timing info for model.dbt_idx.stg_eltool__state (execute): 19:37:36.793007 => 19:37:36.877294
[0m19:37:36.878288 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__state: Close
[0m19:37:36.880253 [info ] [Thread-1 (]: 5 of 11 OK created sql view model IDX-Schema.stg_eltool__state ................. [[32mCREATE VIEW[0m in 0.10s]
[0m19:37:36.882258 [debug] [Thread-1 (]: Finished running node model.dbt_idx.stg_eltool__state
[0m19:37:36.884269 [debug] [Thread-1 (]: Began running node model.dbt_idx.stg_eltool__stock
[0m19:37:36.884269 [info ] [Thread-1 (]: 6 of 11 START sql view model IDX-Schema.stg_eltool__stock ...................... [RUN]
[0m19:37:36.886854 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_idx.stg_eltool__state, now model.dbt_idx.stg_eltool__stock)
[0m19:37:36.886854 [debug] [Thread-1 (]: Began compiling node model.dbt_idx.stg_eltool__stock
[0m19:37:36.890852 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_idx.stg_eltool__stock"
[0m19:37:36.896854 [debug] [Thread-1 (]: Timing info for model.dbt_idx.stg_eltool__stock (compile): 19:37:36.887853 => 19:37:36.896854
[0m19:37:36.898821 [debug] [Thread-1 (]: Began executing node model.dbt_idx.stg_eltool__stock
[0m19:37:36.904017 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_idx.stg_eltool__stock"
[0m19:37:36.911019 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__stock"
[0m19:37:36.911019 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__stock: BEGIN
[0m19:37:36.912021 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:37:36.934515 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m19:37:36.935537 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__stock"
[0m19:37:36.936534 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__stock: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__stock"} */

  create view "IDX-Stock"."IDX-Schema"."stg_eltool__stock__dbt_tmp"
    
    
  as (
    with source as (select *
                from "IDX-Stock"."IDX-Schema"."ksql-stock-stream"),
     renamed as (select *
                 from source)
select *
from renamed
  );
[0m19:37:36.940499 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m19:37:36.944084 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__stock"
[0m19:37:36.945051 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__stock: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__stock"} */
alter table "IDX-Stock"."IDX-Schema"."stg_eltool__stock" rename to "stg_eltool__stock__dbt_backup"
[0m19:37:36.947049 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:37:36.951084 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__stock"
[0m19:37:36.952072 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__stock: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__stock"} */
alter table "IDX-Stock"."IDX-Schema"."stg_eltool__stock__dbt_tmp" rename to "stg_eltool__stock"
[0m19:37:36.954053 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:37:36.958052 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__stock: COMMIT
[0m19:37:36.959056 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__stock"
[0m19:37:36.960062 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__stock: COMMIT
[0m19:37:36.964582 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m19:37:36.968610 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__stock"
[0m19:37:36.969612 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__stock: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__stock"} */
drop view if exists "IDX-Stock"."IDX-Schema"."stg_eltool__stock__dbt_backup" cascade
[0m19:37:36.974821 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m19:37:36.978621 [debug] [Thread-1 (]: Timing info for model.dbt_idx.stg_eltool__stock (execute): 19:37:36.899818 => 19:37:36.977600
[0m19:37:36.979612 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__stock: Close
[0m19:37:36.982603 [info ] [Thread-1 (]: 6 of 11 OK created sql view model IDX-Schema.stg_eltool__stock ................. [[32mCREATE VIEW[0m in 0.10s]
[0m19:37:36.986329 [debug] [Thread-1 (]: Finished running node model.dbt_idx.stg_eltool__stock
[0m19:37:36.987355 [debug] [Thread-1 (]: Began running node model.dbt_idx.fact_orders
[0m19:37:36.989374 [info ] [Thread-1 (]: 7 of 11 START sql table model IDX-Schema.fact_orders ........................... [RUN]
[0m19:37:36.990485 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_idx.stg_eltool__stock, now model.dbt_idx.fact_orders)
[0m19:37:36.992357 [debug] [Thread-1 (]: Began compiling node model.dbt_idx.fact_orders
[0m19:37:36.997363 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_idx.fact_orders"
[0m19:37:37.007479 [debug] [Thread-1 (]: Timing info for model.dbt_idx.fact_orders (compile): 19:37:36.993354 => 19:37:37.006481
[0m19:37:37.009479 [debug] [Thread-1 (]: Began executing node model.dbt_idx.fact_orders
[0m19:37:37.043180 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_idx.fact_orders"
[0m19:37:37.050190 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.fact_orders"
[0m19:37:37.051191 [debug] [Thread-1 (]: On model.dbt_idx.fact_orders: BEGIN
[0m19:37:37.052222 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:37:37.076724 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m19:37:37.077724 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.fact_orders"
[0m19:37:37.078715 [debug] [Thread-1 (]: On model.dbt_idx.fact_orders: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.fact_orders"} */

  
    

  create  table "IDX-Stock"."IDX-Schema"."fact_orders__dbt_tmp"
  
  
    as
  
  (
    with orders as (
    select *
    from "IDX-Stock"."IDX-Schema"."stg_eltool__orders"
)
select * from orders
  );
  
[0m19:37:37.084536 [debug] [Thread-1 (]: SQL status: SELECT 999 in 0.0 seconds
[0m19:37:37.090729 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.fact_orders"
[0m19:37:37.091728 [debug] [Thread-1 (]: On model.dbt_idx.fact_orders: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.fact_orders"} */
alter table "IDX-Stock"."IDX-Schema"."fact_orders" rename to "fact_orders__dbt_backup"
[0m19:37:37.094701 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:37:37.099367 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.fact_orders"
[0m19:37:37.100311 [debug] [Thread-1 (]: On model.dbt_idx.fact_orders: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.fact_orders"} */
alter table "IDX-Stock"."IDX-Schema"."fact_orders__dbt_tmp" rename to "fact_orders"
[0m19:37:37.102734 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:37:37.109767 [debug] [Thread-1 (]: On model.dbt_idx.fact_orders: COMMIT
[0m19:37:37.110732 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.fact_orders"
[0m19:37:37.111734 [debug] [Thread-1 (]: On model.dbt_idx.fact_orders: COMMIT
[0m19:37:37.114928 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m19:37:37.122475 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.fact_orders"
[0m19:37:37.123477 [debug] [Thread-1 (]: On model.dbt_idx.fact_orders: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.fact_orders"} */
drop table if exists "IDX-Stock"."IDX-Schema"."fact_orders__dbt_backup" cascade
[0m19:37:37.128481 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m19:37:37.131527 [debug] [Thread-1 (]: Timing info for model.dbt_idx.fact_orders (execute): 19:37:37.010992 => 19:37:37.131527
[0m19:37:37.132478 [debug] [Thread-1 (]: On model.dbt_idx.fact_orders: Close
[0m19:37:37.135555 [info ] [Thread-1 (]: 7 of 11 OK created sql table model IDX-Schema.fact_orders ...................... [[32mSELECT 999[0m in 0.14s]
[0m19:37:37.137558 [debug] [Thread-1 (]: Finished running node model.dbt_idx.fact_orders
[0m19:37:37.139087 [debug] [Thread-1 (]: Began running node model.dbt_idx.dim_customers
[0m19:37:37.140087 [info ] [Thread-1 (]: 8 of 11 START sql table model IDX-Schema.dim_customers ......................... [RUN]
[0m19:37:37.141095 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_idx.fact_orders, now model.dbt_idx.dim_customers)
[0m19:37:37.142087 [debug] [Thread-1 (]: Began compiling node model.dbt_idx.dim_customers
[0m19:37:37.146120 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_idx.dim_customers"
[0m19:37:37.156931 [debug] [Thread-1 (]: Timing info for model.dbt_idx.dim_customers (compile): 19:37:37.143529 => 19:37:37.156384
[0m19:37:37.158677 [debug] [Thread-1 (]: Began executing node model.dbt_idx.dim_customers
[0m19:37:37.172522 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_idx.dim_customers"
[0m19:37:37.179098 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.dim_customers"
[0m19:37:37.180097 [debug] [Thread-1 (]: On model.dbt_idx.dim_customers: BEGIN
[0m19:37:37.181098 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:37:37.204136 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m19:37:37.205138 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.dim_customers"
[0m19:37:37.205138 [debug] [Thread-1 (]: On model.dbt_idx.dim_customers: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.dim_customers"} */

  
    

  create  table "IDX-Stock"."IDX-Schema"."dim_customers__dbt_tmp"
  
  
    as
  
  (
    -- noinspection SqlDialectInspectionForFile

with customers as (
    select *
    from "IDX-Stock"."IDX-Schema"."stg_eltool__customers_snapshots"
    ),
     state as (
         select *
         from "IDX-Stock"."IDX-Schema"."stg_eltool__state"
     )
select c.customer_id,
       c.zipcode,
       c.city,
       c.state_code,
       s.state_name,
       c.datetime_created,
       c.datetime_updated,
       c.dbt_valid_from::TIMESTAMP as valid_from,
        CASE WHEN c.dbt_valid_to IS NULL
            THEN '9999-12-31'::TIMESTAMP
            ELSE c.dbt_valid_to::TIMESTAMP
        END as valid_to
from customers c
    join state s on c.state_code = s.state_code
  );
  
[0m19:37:37.210138 [debug] [Thread-1 (]: SQL status: SELECT 100 in 0.0 seconds
[0m19:37:37.215173 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.dim_customers"
[0m19:37:37.216173 [debug] [Thread-1 (]: On model.dbt_idx.dim_customers: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.dim_customers"} */
alter table "IDX-Stock"."IDX-Schema"."dim_customers" rename to "dim_customers__dbt_backup"
[0m19:37:37.218154 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:37:37.261142 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.dim_customers"
[0m19:37:37.262142 [debug] [Thread-1 (]: On model.dbt_idx.dim_customers: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.dim_customers"} */
alter table "IDX-Stock"."IDX-Schema"."dim_customers__dbt_tmp" rename to "dim_customers"
[0m19:37:37.265141 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:37:37.268171 [debug] [Thread-1 (]: On model.dbt_idx.dim_customers: COMMIT
[0m19:37:37.269139 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.dim_customers"
[0m19:37:37.270137 [debug] [Thread-1 (]: On model.dbt_idx.dim_customers: COMMIT
[0m19:37:37.273146 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m19:37:37.276180 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.dim_customers"
[0m19:37:37.277177 [debug] [Thread-1 (]: On model.dbt_idx.dim_customers: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.dim_customers"} */
drop table if exists "IDX-Stock"."IDX-Schema"."dim_customers__dbt_backup" cascade
[0m19:37:37.280746 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m19:37:37.282772 [debug] [Thread-1 (]: Timing info for model.dbt_idx.dim_customers (execute): 19:37:37.159807 => 19:37:37.282772
[0m19:37:37.283743 [debug] [Thread-1 (]: On model.dbt_idx.dim_customers: Close
[0m19:37:37.284782 [info ] [Thread-1 (]: 8 of 11 OK created sql table model IDX-Schema.dim_customers .................... [[32mSELECT 100[0m in 0.14s]
[0m19:37:37.287338 [debug] [Thread-1 (]: Finished running node model.dbt_idx.dim_customers
[0m19:37:37.288331 [debug] [Thread-1 (]: Began running node model.dbt_idx.fact_stocks
[0m19:37:37.290329 [info ] [Thread-1 (]: 9 of 11 START sql table model IDX-Schema.fact_stocks ........................... [RUN]
[0m19:37:37.291327 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_idx.dim_customers, now model.dbt_idx.fact_stocks)
[0m19:37:37.292327 [debug] [Thread-1 (]: Began compiling node model.dbt_idx.fact_stocks
[0m19:37:37.295328 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_idx.fact_stocks"
[0m19:37:37.302347 [debug] [Thread-1 (]: Timing info for model.dbt_idx.fact_stocks (compile): 19:37:37.292327 => 19:37:37.302347
[0m19:37:37.303330 [debug] [Thread-1 (]: Began executing node model.dbt_idx.fact_stocks
[0m19:37:37.309332 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_idx.fact_stocks"
[0m19:37:37.317366 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.fact_stocks"
[0m19:37:37.317366 [debug] [Thread-1 (]: On model.dbt_idx.fact_stocks: BEGIN
[0m19:37:37.318363 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:37:37.340646 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m19:37:37.341187 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.fact_stocks"
[0m19:37:37.342194 [debug] [Thread-1 (]: On model.dbt_idx.fact_stocks: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.fact_stocks"} */

  
    

  create  table "IDX-Stock"."IDX-Schema"."fact_stocks__dbt_tmp"
  
  
    as
  
  (
    -- noinspection SqlDialectInspectionForFile

with stock as (
    select *
    from "IDX-Stock"."IDX-Schema"."stg_eltool__stock"
    ),
     company as (
         select *
         from "IDX-Stock"."IDX-Schema"."stg_eltool__company"
     )
select a.id,
       a.ticker,
       b.name,
       a.date,
       a.open,
       a.high,
       a.low,
       a.close,
       a.volume,
       b.logo
from stock a
    join company b on a.ticker = b.ticker
  );
  
[0m19:37:37.381240 [debug] [Thread-1 (]: SQL status: SELECT 26131 in 0.0 seconds
[0m19:37:37.386272 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.fact_stocks"
[0m19:37:37.386785 [debug] [Thread-1 (]: On model.dbt_idx.fact_stocks: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.fact_stocks"} */
alter table "IDX-Stock"."IDX-Schema"."fact_stocks" rename to "fact_stocks__dbt_backup"
[0m19:37:37.389088 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:37:37.392079 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.fact_stocks"
[0m19:37:37.393104 [debug] [Thread-1 (]: On model.dbt_idx.fact_stocks: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.fact_stocks"} */
alter table "IDX-Stock"."IDX-Schema"."fact_stocks__dbt_tmp" rename to "fact_stocks"
[0m19:37:37.395056 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:37:37.398092 [debug] [Thread-1 (]: On model.dbt_idx.fact_stocks: COMMIT
[0m19:37:37.398092 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.fact_stocks"
[0m19:37:37.399088 [debug] [Thread-1 (]: On model.dbt_idx.fact_stocks: COMMIT
[0m19:37:37.407851 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m19:37:37.410875 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.fact_stocks"
[0m19:37:37.410875 [debug] [Thread-1 (]: On model.dbt_idx.fact_stocks: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.fact_stocks"} */
drop table if exists "IDX-Stock"."IDX-Schema"."fact_stocks__dbt_backup" cascade
[0m19:37:37.416851 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m19:37:37.418851 [debug] [Thread-1 (]: Timing info for model.dbt_idx.fact_stocks (execute): 19:37:37.303330 => 19:37:37.417879
[0m19:37:37.418851 [debug] [Thread-1 (]: On model.dbt_idx.fact_stocks: Close
[0m19:37:37.420857 [info ] [Thread-1 (]: 9 of 11 OK created sql table model IDX-Schema.fact_stocks ...................... [[32mSELECT 26131[0m in 0.13s]
[0m19:37:37.422880 [debug] [Thread-1 (]: Finished running node model.dbt_idx.fact_stocks
[0m19:37:37.422880 [debug] [Thread-1 (]: Began running node model.dbt_idx.customer_orders_status
[0m19:37:37.424851 [info ] [Thread-1 (]: 10 of 11 START sql view model IDX-Schema.customer_orders_status ................ [RUN]
[0m19:37:37.425245 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_idx.fact_stocks, now model.dbt_idx.customer_orders_status)
[0m19:37:37.426293 [debug] [Thread-1 (]: Began compiling node model.dbt_idx.customer_orders_status
[0m19:37:37.430332 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_idx.customer_orders_status"
[0m19:37:37.437065 [debug] [Thread-1 (]: Timing info for model.dbt_idx.customer_orders_status (compile): 19:37:37.427272 => 19:37:37.437065
[0m19:37:37.438065 [debug] [Thread-1 (]: Began executing node model.dbt_idx.customer_orders_status
[0m19:37:37.443031 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_idx.customer_orders_status"
[0m19:37:37.449060 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.customer_orders_status"
[0m19:37:37.450056 [debug] [Thread-1 (]: On model.dbt_idx.customer_orders_status: BEGIN
[0m19:37:37.450056 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:37:37.473996 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m19:37:37.474988 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.customer_orders_status"
[0m19:37:37.475972 [debug] [Thread-1 (]: On model.dbt_idx.customer_orders_status: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.customer_orders_status"} */

  create view "IDX-Stock"."IDX-Schema"."customer_orders_status__dbt_tmp"
    
    
  as (
    with orders as (select *
                from "IDX-Stock"."IDX-Schema"."fact_orders"),
     customers as (select *
                   from "IDX-Stock"."IDX-Schema"."dim_customers")
select o.order_id,
       o.customer_id,
       o.order_status,
       o.order_purchase_timestamp,
       o.order_approved_at,
       o.order_delivered_carrier_date,
       o.order_delivered_customer_date,
       o.order_estimated_delivery_date,
       c.zipcode    as customer_zipcode,
       c.city       as customer_city,
       c.state_code as customer_state_code,
       c.state_name as customer_state_name
from orders o
    join customers c on o.customer_id = c.customer_id
    and o.order_purchase_timestamp >= c.valid_from
    and o.order_purchase_timestamp <= c.valid_to
  );
[0m19:37:37.479738 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m19:37:37.482750 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.customer_orders_status"
[0m19:37:37.483752 [debug] [Thread-1 (]: On model.dbt_idx.customer_orders_status: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.customer_orders_status"} */
alter table "IDX-Stock"."IDX-Schema"."customer_orders_status__dbt_tmp" rename to "customer_orders_status"
[0m19:37:37.486272 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:37:37.488317 [debug] [Thread-1 (]: On model.dbt_idx.customer_orders_status: COMMIT
[0m19:37:37.489314 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.customer_orders_status"
[0m19:37:37.490315 [debug] [Thread-1 (]: On model.dbt_idx.customer_orders_status: COMMIT
[0m19:37:37.493280 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m19:37:37.496280 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.customer_orders_status"
[0m19:37:37.497305 [debug] [Thread-1 (]: On model.dbt_idx.customer_orders_status: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.customer_orders_status"} */
drop view if exists "IDX-Stock"."IDX-Schema"."customer_orders_status__dbt_backup" cascade
[0m19:37:37.499299 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m19:37:37.501303 [debug] [Thread-1 (]: Timing info for model.dbt_idx.customer_orders_status (execute): 19:37:37.439065 => 19:37:37.501303
[0m19:37:37.502278 [debug] [Thread-1 (]: On model.dbt_idx.customer_orders_status: Close
[0m19:37:37.503282 [info ] [Thread-1 (]: 10 of 11 OK created sql view model IDX-Schema.customer_orders_status ........... [[32mCREATE VIEW[0m in 0.08s]
[0m19:37:37.505280 [debug] [Thread-1 (]: Finished running node model.dbt_idx.customer_orders_status
[0m19:37:37.507286 [debug] [Thread-1 (]: Began running node model.dbt_idx.stock_update_status
[0m19:37:37.508301 [info ] [Thread-1 (]: 11 of 11 START sql view model IDX-Schema.stock_update_status ................... [RUN]
[0m19:37:37.510284 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_idx.customer_orders_status, now model.dbt_idx.stock_update_status)
[0m19:37:37.510284 [debug] [Thread-1 (]: Began compiling node model.dbt_idx.stock_update_status
[0m19:37:37.513305 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_idx.stock_update_status"
[0m19:37:37.520302 [debug] [Thread-1 (]: Timing info for model.dbt_idx.stock_update_status (compile): 19:37:37.511316 => 19:37:37.519305
[0m19:37:37.520302 [debug] [Thread-1 (]: Began executing node model.dbt_idx.stock_update_status
[0m19:37:37.526304 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_idx.stock_update_status"
[0m19:37:37.533277 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stock_update_status"
[0m19:37:37.533277 [debug] [Thread-1 (]: On model.dbt_idx.stock_update_status: BEGIN
[0m19:37:37.534316 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:37:37.554870 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m19:37:37.556876 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stock_update_status"
[0m19:37:37.557868 [debug] [Thread-1 (]: On model.dbt_idx.stock_update_status: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stock_update_status"} */

  create view "IDX-Stock"."IDX-Schema"."stock_update_status__dbt_tmp"
    
    
  as (
    with stock as (select *,
                        rank() over (
                        partition by ticker
                        order by date desc
                        ) as rank
               from "IDX-Stock"."IDX-Schema"."fact_stocks")
select a.id,
       a.ticker,
       a.name,
       a.date,
       a.open,
       a.high,
       a.low,
       a.close,
       a.volume,
       a.rank,
       a.logo
from stock a
order by a.id desc
  );
[0m19:37:37.560907 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m19:37:37.565910 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stock_update_status"
[0m19:37:37.566922 [debug] [Thread-1 (]: On model.dbt_idx.stock_update_status: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stock_update_status"} */
alter table "IDX-Stock"."IDX-Schema"."stock_update_status__dbt_tmp" rename to "stock_update_status"
[0m19:37:37.569886 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:37:37.571910 [debug] [Thread-1 (]: On model.dbt_idx.stock_update_status: COMMIT
[0m19:37:37.572875 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stock_update_status"
[0m19:37:37.572875 [debug] [Thread-1 (]: On model.dbt_idx.stock_update_status: COMMIT
[0m19:37:37.576440 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m19:37:37.580463 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stock_update_status"
[0m19:37:37.580463 [debug] [Thread-1 (]: On model.dbt_idx.stock_update_status: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stock_update_status"} */
drop view if exists "IDX-Stock"."IDX-Schema"."stock_update_status__dbt_backup" cascade
[0m19:37:37.583439 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m19:37:37.585467 [debug] [Thread-1 (]: Timing info for model.dbt_idx.stock_update_status (execute): 19:37:37.521294 => 19:37:37.584440
[0m19:37:37.585467 [debug] [Thread-1 (]: On model.dbt_idx.stock_update_status: Close
[0m19:37:37.587695 [info ] [Thread-1 (]: 11 of 11 OK created sql view model IDX-Schema.stock_update_status .............. [[32mCREATE VIEW[0m in 0.08s]
[0m19:37:37.589679 [debug] [Thread-1 (]: Finished running node model.dbt_idx.stock_update_status
[0m19:37:37.591680 [debug] [MainThread]: Using postgres connection "master"
[0m19:37:37.592679 [debug] [MainThread]: On master: BEGIN
[0m19:37:37.592679 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m19:37:37.613741 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m19:37:37.614788 [debug] [MainThread]: On master: COMMIT
[0m19:37:37.615741 [debug] [MainThread]: Using postgres connection "master"
[0m19:37:37.615741 [debug] [MainThread]: On master: COMMIT
[0m19:37:37.618758 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m19:37:37.619736 [debug] [MainThread]: On master: Close
[0m19:37:37.620741 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:37:37.621741 [debug] [MainThread]: Connection 'list_IDX-Stock' was properly closed.
[0m19:37:37.622735 [debug] [MainThread]: Connection 'list_IDX-Stock_snapshots' was properly closed.
[0m19:37:37.623736 [debug] [MainThread]: Connection 'model.dbt_idx.stock_update_status' was properly closed.
[0m19:37:37.624735 [info ] [MainThread]: 
[0m19:37:37.625750 [info ] [MainThread]: Finished running 8 view models, 3 table models in 0 hours 0 minutes and 1.57 seconds (1.57s).
[0m19:37:37.628211 [debug] [MainThread]: Command end result
[0m19:37:37.654251 [info ] [MainThread]: 
[0m19:37:37.655213 [info ] [MainThread]: [32mCompleted successfully[0m
[0m19:37:37.656213 [info ] [MainThread]: 
[0m19:37:37.657215 [info ] [MainThread]: Done. PASS=11 WARN=0 ERROR=0 SKIP=0 TOTAL=11
[0m19:37:37.658212 [debug] [MainThread]: Command `dbt run` succeeded at 19:37:37.658212 after 2.16 seconds
[0m19:37:37.658212 [debug] [MainThread]: Flushing usage events


============================== 19:38:31.507657 | efa5d03a-7207-4760-950c-549edfcc8ef3 ==============================
[0m19:38:31.507657 [info ] [MainThread]: Running with dbt=1.6.1
[0m19:38:31.512641 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'D:\\00 Project\\00 My Project\\IdeaProjects\\Py-DBT-IDX', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'D:\\00 Project\\00 My Project\\IdeaProjects\\Py-DBT-IDX\\logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'False'}
[0m19:38:31.637212 [info ] [MainThread]: Registered adapter: postgres=1.6.1
[0m19:38:31.646581 [debug] [MainThread]: checksum: efe19d9f5b93d1a98cc804fbfcdb6b3aced98b974af664946fee1cde8837deb7, vars: {}, profile: , target: , version: 1.6.1
[0m19:38:31.810233 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m19:38:31.812232 [debug] [MainThread]: Partial parsing: updated file: dbt_idx://models\marts\stock\stock_update_status.sql
[0m19:38:31.934995 [info ] [MainThread]: Found 11 models, 1 snapshot, 18 tests, 5 sources, 0 exposures, 0 metrics, 349 macros, 0 groups, 0 semantic models
[0m19:38:31.937995 [info ] [MainThread]: 
[0m19:38:31.939507 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m19:38:31.941507 [debug] [ThreadPool]: Acquiring new postgres connection 'list_IDX-Stock'
[0m19:38:31.952019 [debug] [ThreadPool]: Using postgres connection "list_IDX-Stock"
[0m19:38:31.953021 [debug] [ThreadPool]: On list_IDX-Stock: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "connection_name": "list_IDX-Stock"} */

    select distinct nspname from pg_namespace
  
[0m19:38:31.954021 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:38:31.987646 [debug] [ThreadPool]: SQL status: SELECT 12 in 0.0 seconds
[0m19:38:31.989682 [debug] [ThreadPool]: On list_IDX-Stock: Close
[0m19:38:31.994153 [debug] [ThreadPool]: Acquiring new postgres connection 'list_IDX-Stock_IDX-Schema'
[0m19:38:32.001160 [debug] [ThreadPool]: Using postgres connection "list_IDX-Stock_IDX-Schema"
[0m19:38:32.002160 [debug] [ThreadPool]: On list_IDX-Stock_IDX-Schema: BEGIN
[0m19:38:32.002160 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:38:32.024666 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m19:38:32.025709 [debug] [ThreadPool]: Using postgres connection "list_IDX-Stock_IDX-Schema"
[0m19:38:32.026711 [debug] [ThreadPool]: On list_IDX-Stock_IDX-Schema: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "connection_name": "list_IDX-Stock_IDX-Schema"} */
select
      'IDX-Stock' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'IDX-Schema'
    union all
    select
      'IDX-Stock' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'IDX-Schema'
    union all
    select
      'IDX-Stock' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'IDX-Schema'
  
[0m19:38:32.030703 [debug] [ThreadPool]: SQL status: SELECT 17 in 0.0 seconds
[0m19:38:32.032701 [debug] [ThreadPool]: On list_IDX-Stock_IDX-Schema: ROLLBACK
[0m19:38:32.035689 [debug] [ThreadPool]: On list_IDX-Stock_IDX-Schema: Close
[0m19:38:32.037669 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_IDX-Stock_IDX-Schema, now list_IDX-Stock_snapshots)
[0m19:38:32.045968 [debug] [ThreadPool]: Using postgres connection "list_IDX-Stock_snapshots"
[0m19:38:32.046915 [debug] [ThreadPool]: On list_IDX-Stock_snapshots: BEGIN
[0m19:38:32.048117 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:38:32.073565 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m19:38:32.075557 [debug] [ThreadPool]: Using postgres connection "list_IDX-Stock_snapshots"
[0m19:38:32.075557 [debug] [ThreadPool]: On list_IDX-Stock_snapshots: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "connection_name": "list_IDX-Stock_snapshots"} */
select
      'IDX-Stock' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'snapshots'
    union all
    select
      'IDX-Stock' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'snapshots'
    union all
    select
      'IDX-Stock' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'snapshots'
  
[0m19:38:32.080602 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.0 seconds
[0m19:38:32.083120 [debug] [ThreadPool]: On list_IDX-Stock_snapshots: ROLLBACK
[0m19:38:32.085314 [debug] [ThreadPool]: On list_IDX-Stock_snapshots: Close
[0m19:38:32.093314 [debug] [MainThread]: Using postgres connection "master"
[0m19:38:32.094325 [debug] [MainThread]: On master: BEGIN
[0m19:38:32.094325 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:38:32.117841 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m19:38:32.118826 [debug] [MainThread]: Using postgres connection "master"
[0m19:38:32.119824 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m19:38:32.129345 [debug] [MainThread]: SQL status: SELECT 9 in 0.0 seconds
[0m19:38:32.132356 [debug] [MainThread]: On master: ROLLBACK
[0m19:38:32.135033 [debug] [MainThread]: Using postgres connection "master"
[0m19:38:32.136046 [debug] [MainThread]: On master: BEGIN
[0m19:38:32.140061 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m19:38:32.141045 [debug] [MainThread]: On master: COMMIT
[0m19:38:32.142043 [debug] [MainThread]: Using postgres connection "master"
[0m19:38:32.143061 [debug] [MainThread]: On master: COMMIT
[0m19:38:32.144556 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m19:38:32.145567 [debug] [MainThread]: On master: Close
[0m19:38:32.147077 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m19:38:32.149091 [info ] [MainThread]: 
[0m19:38:32.156084 [debug] [Thread-1 (]: Began running node model.dbt_idx.stg_eltool__company
[0m19:38:32.157124 [info ] [Thread-1 (]: 1 of 11 START sql view model IDX-Schema.stg_eltool__company .................... [RUN]
[0m19:38:32.159085 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.dbt_idx.stg_eltool__company'
[0m19:38:32.160144 [debug] [Thread-1 (]: Began compiling node model.dbt_idx.stg_eltool__company
[0m19:38:32.168680 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_idx.stg_eltool__company"
[0m19:38:32.175660 [debug] [Thread-1 (]: Timing info for model.dbt_idx.stg_eltool__company (compile): 19:38:32.161085 => 19:38:32.175660
[0m19:38:32.176644 [debug] [Thread-1 (]: Began executing node model.dbt_idx.stg_eltool__company
[0m19:38:32.217766 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_idx.stg_eltool__company"
[0m19:38:32.225782 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__company"
[0m19:38:32.227297 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__company: BEGIN
[0m19:38:32.228320 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m19:38:32.255527 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m19:38:32.257530 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__company"
[0m19:38:32.258526 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__company: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__company"} */

  create view "IDX-Stock"."IDX-Schema"."stg_eltool__company__dbt_tmp"
    
    
  as (
    with source as (select *
                from "IDX-Stock"."IDX-Schema"."ksql-company-stream"),
     renamed as (select id,
                        ticker,
                        name,
                        logo
                 from source)
select *
from renamed
  );
[0m19:38:32.264100 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m19:38:32.273433 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__company"
[0m19:38:32.274433 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__company: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__company"} */
alter table "IDX-Stock"."IDX-Schema"."stg_eltool__company" rename to "stg_eltool__company__dbt_backup"
[0m19:38:32.278466 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:38:32.283658 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__company"
[0m19:38:32.284662 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__company: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__company"} */
alter table "IDX-Stock"."IDX-Schema"."stg_eltool__company__dbt_tmp" rename to "stg_eltool__company"
[0m19:38:32.287650 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:38:32.307693 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__company: COMMIT
[0m19:38:32.308691 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__company"
[0m19:38:32.309690 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__company: COMMIT
[0m19:38:32.313693 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m19:38:32.324252 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__company"
[0m19:38:32.325252 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__company: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__company"} */
drop view if exists "IDX-Stock"."IDX-Schema"."stg_eltool__company__dbt_backup" cascade
[0m19:38:32.330214 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m19:38:32.332214 [debug] [Thread-1 (]: Timing info for model.dbt_idx.stg_eltool__company (execute): 19:38:32.177654 => 19:38:32.331214
[0m19:38:32.332214 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__company: Close
[0m19:38:32.334221 [info ] [Thread-1 (]: 1 of 11 OK created sql view model IDX-Schema.stg_eltool__company ............... [[32mCREATE VIEW[0m in 0.18s]
[0m19:38:32.336721 [debug] [Thread-1 (]: Finished running node model.dbt_idx.stg_eltool__company
[0m19:38:32.337731 [debug] [Thread-1 (]: Began running node model.dbt_idx.stg_eltool__customers
[0m19:38:32.339731 [info ] [Thread-1 (]: 2 of 11 START sql view model IDX-Schema.stg_eltool__customers .................. [RUN]
[0m19:38:32.341766 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_idx.stg_eltool__company, now model.dbt_idx.stg_eltool__customers)
[0m19:38:32.342764 [debug] [Thread-1 (]: Began compiling node model.dbt_idx.stg_eltool__customers
[0m19:38:32.350288 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_idx.stg_eltool__customers"
[0m19:38:32.358119 [debug] [Thread-1 (]: Timing info for model.dbt_idx.stg_eltool__customers (compile): 19:38:32.344753 => 19:38:32.358119
[0m19:38:32.360138 [debug] [Thread-1 (]: Began executing node model.dbt_idx.stg_eltool__customers
[0m19:38:32.365117 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_idx.stg_eltool__customers"
[0m19:38:32.372632 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__customers"
[0m19:38:32.373657 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__customers: BEGIN
[0m19:38:32.374640 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:38:32.400198 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m19:38:32.401226 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__customers"
[0m19:38:32.402229 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__customers: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__customers"} */

  create view "IDX-Stock"."IDX-Schema"."stg_eltool__customers__dbt_tmp"
    
    
  as (
    with source as (select *
                from "IDX-Stock"."IDX-Schema"."customers"),
     renamed as (select
                     customer_id,
                    'This is Dummy' as dummy
                 from source
                 where customer_id = 1234567890)
select *
from renamed
  );
[0m19:38:32.406747 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m19:38:32.410740 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__customers"
[0m19:38:32.411739 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__customers: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__customers"} */
alter table "IDX-Stock"."IDX-Schema"."stg_eltool__customers" rename to "stg_eltool__customers__dbt_backup"
[0m19:38:32.414556 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:38:32.419151 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__customers"
[0m19:38:32.419151 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__customers: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__customers"} */
alter table "IDX-Stock"."IDX-Schema"."stg_eltool__customers__dbt_tmp" rename to "stg_eltool__customers"
[0m19:38:32.422129 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:38:32.424154 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__customers: COMMIT
[0m19:38:32.425121 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__customers"
[0m19:38:32.425121 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__customers: COMMIT
[0m19:38:32.428117 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m19:38:32.431153 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__customers"
[0m19:38:32.432151 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__customers: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__customers"} */
drop view if exists "IDX-Stock"."IDX-Schema"."stg_eltool__customers__dbt_backup" cascade
[0m19:38:32.436547 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m19:38:32.438587 [debug] [Thread-1 (]: Timing info for model.dbt_idx.stg_eltool__customers (execute): 19:38:32.360138 => 19:38:32.437617
[0m19:38:32.438587 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__customers: Close
[0m19:38:32.440546 [info ] [Thread-1 (]: 2 of 11 OK created sql view model IDX-Schema.stg_eltool__customers ............. [[32mCREATE VIEW[0m in 0.10s]
[0m19:38:32.442554 [debug] [Thread-1 (]: Finished running node model.dbt_idx.stg_eltool__customers
[0m19:38:32.443547 [debug] [Thread-1 (]: Began running node model.dbt_idx.stg_eltool__customers_snapshots
[0m19:38:32.444586 [info ] [Thread-1 (]: 3 of 11 START sql view model IDX-Schema.stg_eltool__customers_snapshots ........ [RUN]
[0m19:38:32.445548 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_idx.stg_eltool__customers, now model.dbt_idx.stg_eltool__customers_snapshots)
[0m19:38:32.446584 [debug] [Thread-1 (]: Began compiling node model.dbt_idx.stg_eltool__customers_snapshots
[0m19:38:32.450168 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_idx.stg_eltool__customers_snapshots"
[0m19:38:32.456036 [debug] [Thread-1 (]: Timing info for model.dbt_idx.stg_eltool__customers_snapshots (compile): 19:38:32.448125 => 19:38:32.456036
[0m19:38:32.456982 [debug] [Thread-1 (]: Began executing node model.dbt_idx.stg_eltool__customers_snapshots
[0m19:38:32.463016 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_idx.stg_eltool__customers_snapshots"
[0m19:38:32.470019 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__customers_snapshots"
[0m19:38:32.471023 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__customers_snapshots: BEGIN
[0m19:38:32.471980 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:38:32.492977 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m19:38:32.493999 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__customers_snapshots"
[0m19:38:32.494975 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__customers_snapshots: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__customers_snapshots"} */

  create view "IDX-Stock"."IDX-Schema"."stg_eltool__customers_snapshots__dbt_tmp"
    
    
  as (
    with source as (select *
                from "IDX-Stock"."snapshots"."customers_snapshot"),
     renamed as (select customer_id,
                        zipcode,
                        city,
                        state_code,
                        datetime_created::TIMESTAMP AS datetime_created,
                        datetime_updated::TIMESTAMP AS datetime_updated,
                        dbt_valid_from,
                        dbt_valid_to
                 from source)
select *
from renamed
  );
[0m19:38:32.498964 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m19:38:32.502973 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__customers_snapshots"
[0m19:38:32.503966 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__customers_snapshots: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__customers_snapshots"} */
alter table "IDX-Stock"."IDX-Schema"."stg_eltool__customers_snapshots" rename to "stg_eltool__customers_snapshots__dbt_backup"
[0m19:38:32.506999 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:38:32.510997 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__customers_snapshots"
[0m19:38:32.510997 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__customers_snapshots: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__customers_snapshots"} */
alter table "IDX-Stock"."IDX-Schema"."stg_eltool__customers_snapshots__dbt_tmp" rename to "stg_eltool__customers_snapshots"
[0m19:38:32.514599 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:38:32.516597 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__customers_snapshots: COMMIT
[0m19:38:32.517567 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__customers_snapshots"
[0m19:38:32.518566 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__customers_snapshots: COMMIT
[0m19:38:32.522003 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m19:38:32.525006 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__customers_snapshots"
[0m19:38:32.525977 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__customers_snapshots: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__customers_snapshots"} */
drop view if exists "IDX-Stock"."IDX-Schema"."stg_eltool__customers_snapshots__dbt_backup" cascade
[0m19:38:32.529501 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m19:38:32.531526 [debug] [Thread-1 (]: Timing info for model.dbt_idx.stg_eltool__customers_snapshots (execute): 19:38:32.456982 => 19:38:32.531526
[0m19:38:32.532516 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__customers_snapshots: Close
[0m19:38:32.534528 [info ] [Thread-1 (]: 3 of 11 OK created sql view model IDX-Schema.stg_eltool__customers_snapshots ... [[32mCREATE VIEW[0m in 0.09s]
[0m19:38:32.536529 [debug] [Thread-1 (]: Finished running node model.dbt_idx.stg_eltool__customers_snapshots
[0m19:38:32.537528 [debug] [Thread-1 (]: Began running node model.dbt_idx.stg_eltool__orders
[0m19:38:32.538546 [info ] [Thread-1 (]: 4 of 11 START sql view model IDX-Schema.stg_eltool__orders ..................... [RUN]
[0m19:38:32.540545 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_idx.stg_eltool__customers_snapshots, now model.dbt_idx.stg_eltool__orders)
[0m19:38:32.541521 [debug] [Thread-1 (]: Began compiling node model.dbt_idx.stg_eltool__orders
[0m19:38:32.543558 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_idx.stg_eltool__orders"
[0m19:38:32.554059 [debug] [Thread-1 (]: Timing info for model.dbt_idx.stg_eltool__orders (compile): 19:38:32.541521 => 19:38:32.553058
[0m19:38:32.554059 [debug] [Thread-1 (]: Began executing node model.dbt_idx.stg_eltool__orders
[0m19:38:32.562097 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_idx.stg_eltool__orders"
[0m19:38:32.574094 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__orders"
[0m19:38:32.575070 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__orders: BEGIN
[0m19:38:32.576089 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:38:32.598063 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m19:38:32.599064 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__orders"
[0m19:38:32.599064 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__orders: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__orders"} */

  create view "IDX-Stock"."IDX-Schema"."stg_eltool__orders__dbt_tmp"
    
    
  as (
    with source as (select *
                from "IDX-Stock"."IDX-Schema"."orders"),
     renamed as (select order_id,
                        cust_id AS customer_id,
                        order_status,
                        order_purchase_timestamp::TIMESTAMP,
                        order_approved_at::TIMESTAMP,
                        order_delivered_carrier_date::TIMESTAMP,
                        order_delivered_customer_date::TIMESTAMP,
                        order_estimated_delivery_date::TIMESTAMP
                 from source)
select *
from renamed
  );
[0m19:38:32.603083 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m19:38:32.607099 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__orders"
[0m19:38:32.607099 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__orders: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__orders"} */
alter table "IDX-Stock"."IDX-Schema"."stg_eltool__orders" rename to "stg_eltool__orders__dbt_backup"
[0m19:38:32.610019 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:38:32.613031 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__orders"
[0m19:38:32.614031 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__orders: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__orders"} */
alter table "IDX-Stock"."IDX-Schema"."stg_eltool__orders__dbt_tmp" rename to "stg_eltool__orders"
[0m19:38:32.616036 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:38:32.619036 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__orders: COMMIT
[0m19:38:32.620070 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__orders"
[0m19:38:32.621034 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__orders: COMMIT
[0m19:38:32.623760 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m19:38:32.627760 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__orders"
[0m19:38:32.627760 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__orders: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__orders"} */
drop view if exists "IDX-Stock"."IDX-Schema"."stg_eltool__orders__dbt_backup" cascade
[0m19:38:32.631766 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m19:38:32.633814 [debug] [Thread-1 (]: Timing info for model.dbt_idx.stg_eltool__orders (execute): 19:38:32.556061 => 19:38:32.633814
[0m19:38:32.634817 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__orders: Close
[0m19:38:32.636783 [info ] [Thread-1 (]: 4 of 11 OK created sql view model IDX-Schema.stg_eltool__orders ................ [[32mCREATE VIEW[0m in 0.10s]
[0m19:38:32.638781 [debug] [Thread-1 (]: Finished running node model.dbt_idx.stg_eltool__orders
[0m19:38:32.639788 [debug] [Thread-1 (]: Began running node model.dbt_idx.stg_eltool__state
[0m19:38:32.640781 [info ] [Thread-1 (]: 5 of 11 START sql view model IDX-Schema.stg_eltool__state ...................... [RUN]
[0m19:38:32.641779 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_idx.stg_eltool__orders, now model.dbt_idx.stg_eltool__state)
[0m19:38:32.642795 [debug] [Thread-1 (]: Began compiling node model.dbt_idx.stg_eltool__state
[0m19:38:32.644813 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_idx.stg_eltool__state"
[0m19:38:32.651357 [debug] [Thread-1 (]: Timing info for model.dbt_idx.stg_eltool__state (compile): 19:38:32.642795 => 19:38:32.651357
[0m19:38:32.652379 [debug] [Thread-1 (]: Began executing node model.dbt_idx.stg_eltool__state
[0m19:38:32.657355 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_idx.stg_eltool__state"
[0m19:38:32.664028 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__state"
[0m19:38:32.665027 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__state: BEGIN
[0m19:38:32.665027 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:38:32.690042 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m19:38:32.691038 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__state"
[0m19:38:32.692059 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__state: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__state"} */

  create view "IDX-Stock"."IDX-Schema"."stg_eltool__state__dbt_tmp"
    
    
  as (
    with source as (select *
                from "IDX-Stock"."IDX-Schema"."state"),
     renamed as (select state_identifier::INT AS state_id,
                         state_code::VARCHAR(2) AS state_code,
                         st_name::VARCHAR(30) AS state_name
                 from source)
select *
from renamed
  );
[0m19:38:32.695030 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m19:38:32.699064 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__state"
[0m19:38:32.700086 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__state: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__state"} */
alter table "IDX-Stock"."IDX-Schema"."stg_eltool__state" rename to "stg_eltool__state__dbt_backup"
[0m19:38:32.702254 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:38:32.705296 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__state"
[0m19:38:32.706290 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__state: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__state"} */
alter table "IDX-Stock"."IDX-Schema"."stg_eltool__state__dbt_tmp" rename to "stg_eltool__state"
[0m19:38:32.707946 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:38:32.709983 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__state: COMMIT
[0m19:38:32.710940 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__state"
[0m19:38:32.711941 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__state: COMMIT
[0m19:38:32.714951 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m19:38:32.718989 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__state"
[0m19:38:32.719953 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__state: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__state"} */
drop view if exists "IDX-Stock"."IDX-Schema"."stg_eltool__state__dbt_backup" cascade
[0m19:38:32.722953 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m19:38:32.724976 [debug] [Thread-1 (]: Timing info for model.dbt_idx.stg_eltool__state (execute): 19:38:32.652379 => 19:38:32.724976
[0m19:38:32.725976 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__state: Close
[0m19:38:32.727958 [info ] [Thread-1 (]: 5 of 11 OK created sql view model IDX-Schema.stg_eltool__state ................. [[32mCREATE VIEW[0m in 0.09s]
[0m19:38:32.729951 [debug] [Thread-1 (]: Finished running node model.dbt_idx.stg_eltool__state
[0m19:38:32.731952 [debug] [Thread-1 (]: Began running node model.dbt_idx.stg_eltool__stock
[0m19:38:32.732953 [info ] [Thread-1 (]: 6 of 11 START sql view model IDX-Schema.stg_eltool__stock ...................... [RUN]
[0m19:38:32.733959 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_idx.stg_eltool__state, now model.dbt_idx.stg_eltool__stock)
[0m19:38:32.734960 [debug] [Thread-1 (]: Began compiling node model.dbt_idx.stg_eltool__stock
[0m19:38:32.737984 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_idx.stg_eltool__stock"
[0m19:38:32.743958 [debug] [Thread-1 (]: Timing info for model.dbt_idx.stg_eltool__stock (compile): 19:38:32.734960 => 19:38:32.742983
[0m19:38:32.743958 [debug] [Thread-1 (]: Began executing node model.dbt_idx.stg_eltool__stock
[0m19:38:32.750470 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_idx.stg_eltool__stock"
[0m19:38:32.756469 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__stock"
[0m19:38:32.757481 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__stock: BEGIN
[0m19:38:32.758469 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:38:32.782470 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m19:38:32.783484 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__stock"
[0m19:38:32.783484 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__stock: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__stock"} */

  create view "IDX-Stock"."IDX-Schema"."stg_eltool__stock__dbt_tmp"
    
    
  as (
    with source as (select *
                from "IDX-Stock"."IDX-Schema"."ksql-stock-stream"),
     renamed as (select *
                 from source)
select *
from renamed
  );
[0m19:38:32.787313 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m19:38:32.791312 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__stock"
[0m19:38:32.792312 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__stock: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__stock"} */
alter table "IDX-Stock"."IDX-Schema"."stg_eltool__stock" rename to "stg_eltool__stock__dbt_backup"
[0m19:38:32.794759 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:38:32.798795 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__stock"
[0m19:38:32.799758 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__stock: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__stock"} */
alter table "IDX-Stock"."IDX-Schema"."stg_eltool__stock__dbt_tmp" rename to "stg_eltool__stock"
[0m19:38:32.801755 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:38:32.803757 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__stock: COMMIT
[0m19:38:32.805791 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__stock"
[0m19:38:32.805791 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__stock: COMMIT
[0m19:38:32.809756 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m19:38:32.812783 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__stock"
[0m19:38:32.813756 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__stock: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__stock"} */
drop view if exists "IDX-Stock"."IDX-Schema"."stg_eltool__stock__dbt_backup" cascade
[0m19:38:32.817757 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m19:38:32.819782 [debug] [Thread-1 (]: Timing info for model.dbt_idx.stg_eltool__stock (execute): 19:38:32.744977 => 19:38:32.818757
[0m19:38:32.820768 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__stock: Close
[0m19:38:32.822761 [info ] [Thread-1 (]: 6 of 11 OK created sql view model IDX-Schema.stg_eltool__stock ................. [[32mCREATE VIEW[0m in 0.09s]
[0m19:38:32.824786 [debug] [Thread-1 (]: Finished running node model.dbt_idx.stg_eltool__stock
[0m19:38:32.825757 [debug] [Thread-1 (]: Began running node model.dbt_idx.fact_orders
[0m19:38:32.825757 [info ] [Thread-1 (]: 7 of 11 START sql table model IDX-Schema.fact_orders ........................... [RUN]
[0m19:38:32.827756 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_idx.stg_eltool__stock, now model.dbt_idx.fact_orders)
[0m19:38:32.827756 [debug] [Thread-1 (]: Began compiling node model.dbt_idx.fact_orders
[0m19:38:32.830783 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_idx.fact_orders"
[0m19:38:32.839362 [debug] [Thread-1 (]: Timing info for model.dbt_idx.fact_orders (compile): 19:38:32.828781 => 19:38:32.838321
[0m19:38:32.839362 [debug] [Thread-1 (]: Began executing node model.dbt_idx.fact_orders
[0m19:38:32.861944 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_idx.fact_orders"
[0m19:38:32.869517 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.fact_orders"
[0m19:38:32.869517 [debug] [Thread-1 (]: On model.dbt_idx.fact_orders: BEGIN
[0m19:38:32.870517 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:38:32.892571 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m19:38:32.893597 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.fact_orders"
[0m19:38:32.894565 [debug] [Thread-1 (]: On model.dbt_idx.fact_orders: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.fact_orders"} */

  
    

  create  table "IDX-Stock"."IDX-Schema"."fact_orders__dbt_tmp"
  
  
    as
  
  (
    with orders as (
    select *
    from "IDX-Stock"."IDX-Schema"."stg_eltool__orders"
)
select * from orders
  );
  
[0m19:38:32.899600 [debug] [Thread-1 (]: SQL status: SELECT 999 in 0.0 seconds
[0m19:38:32.903602 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.fact_orders"
[0m19:38:32.903602 [debug] [Thread-1 (]: On model.dbt_idx.fact_orders: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.fact_orders"} */
alter table "IDX-Stock"."IDX-Schema"."fact_orders" rename to "fact_orders__dbt_backup"
[0m19:38:32.906565 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:38:32.910605 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.fact_orders"
[0m19:38:32.910605 [debug] [Thread-1 (]: On model.dbt_idx.fact_orders: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.fact_orders"} */
alter table "IDX-Stock"."IDX-Schema"."fact_orders__dbt_tmp" rename to "fact_orders"
[0m19:38:32.912587 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:38:32.919602 [debug] [Thread-1 (]: On model.dbt_idx.fact_orders: COMMIT
[0m19:38:32.920566 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.fact_orders"
[0m19:38:32.920566 [debug] [Thread-1 (]: On model.dbt_idx.fact_orders: COMMIT
[0m19:38:32.924569 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m19:38:32.929600 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.fact_orders"
[0m19:38:32.930567 [debug] [Thread-1 (]: On model.dbt_idx.fact_orders: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.fact_orders"} */
drop table if exists "IDX-Stock"."IDX-Schema"."fact_orders__dbt_backup" cascade
[0m19:38:32.933990 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m19:38:32.935998 [debug] [Thread-1 (]: Timing info for model.dbt_idx.fact_orders (execute): 19:38:32.840357 => 19:38:32.935998
[0m19:38:32.937034 [debug] [Thread-1 (]: On model.dbt_idx.fact_orders: Close
[0m19:38:32.939011 [info ] [Thread-1 (]: 7 of 11 OK created sql table model IDX-Schema.fact_orders ...................... [[32mSELECT 999[0m in 0.11s]
[0m19:38:32.941001 [debug] [Thread-1 (]: Finished running node model.dbt_idx.fact_orders
[0m19:38:32.942999 [debug] [Thread-1 (]: Began running node model.dbt_idx.dim_customers
[0m19:38:32.942999 [info ] [Thread-1 (]: 8 of 11 START sql table model IDX-Schema.dim_customers ......................... [RUN]
[0m19:38:32.945038 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_idx.fact_orders, now model.dbt_idx.dim_customers)
[0m19:38:32.946000 [debug] [Thread-1 (]: Began compiling node model.dbt_idx.dim_customers
[0m19:38:32.949621 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_idx.dim_customers"
[0m19:38:32.955524 [debug] [Thread-1 (]: Timing info for model.dbt_idx.dim_customers (compile): 19:38:32.947039 => 19:38:32.955524
[0m19:38:32.956535 [debug] [Thread-1 (]: Began executing node model.dbt_idx.dim_customers
[0m19:38:32.963522 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_idx.dim_customers"
[0m19:38:32.969045 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.dim_customers"
[0m19:38:32.971082 [debug] [Thread-1 (]: On model.dbt_idx.dim_customers: BEGIN
[0m19:38:32.971082 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:38:32.997008 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m19:38:32.998005 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.dim_customers"
[0m19:38:32.999005 [debug] [Thread-1 (]: On model.dbt_idx.dim_customers: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.dim_customers"} */

  
    

  create  table "IDX-Stock"."IDX-Schema"."dim_customers__dbt_tmp"
  
  
    as
  
  (
    -- noinspection SqlDialectInspectionForFile

with customers as (
    select *
    from "IDX-Stock"."IDX-Schema"."stg_eltool__customers_snapshots"
    ),
     state as (
         select *
         from "IDX-Stock"."IDX-Schema"."stg_eltool__state"
     )
select c.customer_id,
       c.zipcode,
       c.city,
       c.state_code,
       s.state_name,
       c.datetime_created,
       c.datetime_updated,
       c.dbt_valid_from::TIMESTAMP as valid_from,
        CASE WHEN c.dbt_valid_to IS NULL
            THEN '9999-12-31'::TIMESTAMP
            ELSE c.dbt_valid_to::TIMESTAMP
        END as valid_to
from customers c
    join state s on c.state_code = s.state_code
  );
  
[0m19:38:33.006011 [debug] [Thread-1 (]: SQL status: SELECT 100 in 0.0 seconds
[0m19:38:33.010007 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.dim_customers"
[0m19:38:33.011007 [debug] [Thread-1 (]: On model.dbt_idx.dim_customers: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.dim_customers"} */
alter table "IDX-Stock"."IDX-Schema"."dim_customers" rename to "dim_customers__dbt_backup"
[0m19:38:33.014022 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:38:33.059534 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.dim_customers"
[0m19:38:33.060534 [debug] [Thread-1 (]: On model.dbt_idx.dim_customers: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.dim_customers"} */
alter table "IDX-Stock"."IDX-Schema"."dim_customers__dbt_tmp" rename to "dim_customers"
[0m19:38:33.063532 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:38:33.067535 [debug] [Thread-1 (]: On model.dbt_idx.dim_customers: COMMIT
[0m19:38:33.069531 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.dim_customers"
[0m19:38:33.069531 [debug] [Thread-1 (]: On model.dbt_idx.dim_customers: COMMIT
[0m19:38:33.074161 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m19:38:33.077152 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.dim_customers"
[0m19:38:33.078152 [debug] [Thread-1 (]: On model.dbt_idx.dim_customers: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.dim_customers"} */
drop table if exists "IDX-Stock"."IDX-Schema"."dim_customers__dbt_backup" cascade
[0m19:38:33.082154 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m19:38:33.085169 [debug] [Thread-1 (]: Timing info for model.dbt_idx.dim_customers (execute): 19:38:32.957485 => 19:38:33.084157
[0m19:38:33.086170 [debug] [Thread-1 (]: On model.dbt_idx.dim_customers: Close
[0m19:38:33.089157 [info ] [Thread-1 (]: 8 of 11 OK created sql table model IDX-Schema.dim_customers .................... [[32mSELECT 100[0m in 0.14s]
[0m19:38:33.092196 [debug] [Thread-1 (]: Finished running node model.dbt_idx.dim_customers
[0m19:38:33.094159 [debug] [Thread-1 (]: Began running node model.dbt_idx.fact_stocks
[0m19:38:33.096157 [info ] [Thread-1 (]: 9 of 11 START sql table model IDX-Schema.fact_stocks ........................... [RUN]
[0m19:38:33.098165 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_idx.dim_customers, now model.dbt_idx.fact_stocks)
[0m19:38:33.099152 [debug] [Thread-1 (]: Began compiling node model.dbt_idx.fact_stocks
[0m19:38:33.104189 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_idx.fact_stocks"
[0m19:38:33.113375 [debug] [Thread-1 (]: Timing info for model.dbt_idx.fact_stocks (compile): 19:38:33.100155 => 19:38:33.112394
[0m19:38:33.114373 [debug] [Thread-1 (]: Began executing node model.dbt_idx.fact_stocks
[0m19:38:33.121360 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_idx.fact_stocks"
[0m19:38:33.128936 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.fact_stocks"
[0m19:38:33.129937 [debug] [Thread-1 (]: On model.dbt_idx.fact_stocks: BEGIN
[0m19:38:33.130968 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:38:33.156922 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m19:38:33.157934 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.fact_stocks"
[0m19:38:33.159934 [debug] [Thread-1 (]: On model.dbt_idx.fact_stocks: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.fact_stocks"} */

  
    

  create  table "IDX-Stock"."IDX-Schema"."fact_stocks__dbt_tmp"
  
  
    as
  
  (
    -- noinspection SqlDialectInspectionForFile

with stock as (
    select *
    from "IDX-Stock"."IDX-Schema"."stg_eltool__stock"
    ),
     company as (
         select *
         from "IDX-Stock"."IDX-Schema"."stg_eltool__company"
     )
select a.id,
       a.ticker,
       b.name,
       a.date,
       a.open,
       a.high,
       a.low,
       a.close,
       a.volume,
       b.logo
from stock a
    join company b on a.ticker = b.ticker
  );
  
[0m19:38:33.211075 [debug] [Thread-1 (]: SQL status: SELECT 26131 in 0.0 seconds
[0m19:38:33.214067 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.fact_stocks"
[0m19:38:33.215069 [debug] [Thread-1 (]: On model.dbt_idx.fact_stocks: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.fact_stocks"} */
alter table "IDX-Stock"."IDX-Schema"."fact_stocks" rename to "fact_stocks__dbt_backup"
[0m19:38:33.217907 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:38:33.224439 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.fact_stocks"
[0m19:38:33.225441 [debug] [Thread-1 (]: On model.dbt_idx.fact_stocks: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.fact_stocks"} */
alter table "IDX-Stock"."IDX-Schema"."fact_stocks__dbt_tmp" rename to "fact_stocks"
[0m19:38:33.227441 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:38:33.232445 [debug] [Thread-1 (]: On model.dbt_idx.fact_stocks: COMMIT
[0m19:38:33.233459 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.fact_stocks"
[0m19:38:33.234477 [debug] [Thread-1 (]: On model.dbt_idx.fact_stocks: COMMIT
[0m19:38:33.250014 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m19:38:33.257011 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.fact_stocks"
[0m19:38:33.258031 [debug] [Thread-1 (]: On model.dbt_idx.fact_stocks: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.fact_stocks"} */
drop table if exists "IDX-Stock"."IDX-Schema"."fact_stocks__dbt_backup" cascade
[0m19:38:33.266020 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m19:38:33.269998 [debug] [Thread-1 (]: Timing info for model.dbt_idx.fact_stocks (execute): 19:38:33.115370 => 19:38:33.268988
[0m19:38:33.271015 [debug] [Thread-1 (]: On model.dbt_idx.fact_stocks: Close
[0m19:38:33.273002 [info ] [Thread-1 (]: 9 of 11 OK created sql table model IDX-Schema.fact_stocks ...................... [[32mSELECT 26131[0m in 0.17s]
[0m19:38:33.275999 [debug] [Thread-1 (]: Finished running node model.dbt_idx.fact_stocks
[0m19:38:33.277522 [debug] [Thread-1 (]: Began running node model.dbt_idx.customer_orders_status
[0m19:38:33.278568 [info ] [Thread-1 (]: 10 of 11 START sql view model IDX-Schema.customer_orders_status ................ [RUN]
[0m19:38:33.280570 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_idx.fact_stocks, now model.dbt_idx.customer_orders_status)
[0m19:38:33.281589 [debug] [Thread-1 (]: Began compiling node model.dbt_idx.customer_orders_status
[0m19:38:33.289570 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_idx.customer_orders_status"
[0m19:38:33.299140 [debug] [Thread-1 (]: Timing info for model.dbt_idx.customer_orders_status (compile): 19:38:33.282609 => 19:38:33.299140
[0m19:38:33.301112 [debug] [Thread-1 (]: Began executing node model.dbt_idx.customer_orders_status
[0m19:38:33.306114 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_idx.customer_orders_status"
[0m19:38:33.312582 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.customer_orders_status"
[0m19:38:33.313584 [debug] [Thread-1 (]: On model.dbt_idx.customer_orders_status: BEGIN
[0m19:38:33.314581 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:38:33.337625 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m19:38:33.338663 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.customer_orders_status"
[0m19:38:33.339634 [debug] [Thread-1 (]: On model.dbt_idx.customer_orders_status: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.customer_orders_status"} */

  create view "IDX-Stock"."IDX-Schema"."customer_orders_status__dbt_tmp"
    
    
  as (
    with orders as (select *
                from "IDX-Stock"."IDX-Schema"."fact_orders"),
     customers as (select *
                   from "IDX-Stock"."IDX-Schema"."dim_customers")
select o.order_id,
       o.customer_id,
       o.order_status,
       o.order_purchase_timestamp,
       o.order_approved_at,
       o.order_delivered_carrier_date,
       o.order_delivered_customer_date,
       o.order_estimated_delivery_date,
       c.zipcode    as customer_zipcode,
       c.city       as customer_city,
       c.state_code as customer_state_code,
       c.state_name as customer_state_name
from orders o
    join customers c on o.customer_id = c.customer_id
    and o.order_purchase_timestamp >= c.valid_from
    and o.order_purchase_timestamp <= c.valid_to
  );
[0m19:38:33.343664 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m19:38:33.347619 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.customer_orders_status"
[0m19:38:33.349164 [debug] [Thread-1 (]: On model.dbt_idx.customer_orders_status: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.customer_orders_status"} */
alter table "IDX-Stock"."IDX-Schema"."customer_orders_status__dbt_tmp" rename to "customer_orders_status"
[0m19:38:33.352178 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:38:33.354211 [debug] [Thread-1 (]: On model.dbt_idx.customer_orders_status: COMMIT
[0m19:38:33.355207 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.customer_orders_status"
[0m19:38:33.356208 [debug] [Thread-1 (]: On model.dbt_idx.customer_orders_status: COMMIT
[0m19:38:33.360174 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m19:38:33.364173 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.customer_orders_status"
[0m19:38:33.365190 [debug] [Thread-1 (]: On model.dbt_idx.customer_orders_status: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.customer_orders_status"} */
drop view if exists "IDX-Stock"."IDX-Schema"."customer_orders_status__dbt_backup" cascade
[0m19:38:33.367174 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m19:38:33.369207 [debug] [Thread-1 (]: Timing info for model.dbt_idx.customer_orders_status (execute): 19:38:33.301112 => 19:38:33.369207
[0m19:38:33.370210 [debug] [Thread-1 (]: On model.dbt_idx.customer_orders_status: Close
[0m19:38:33.373177 [info ] [Thread-1 (]: 10 of 11 OK created sql view model IDX-Schema.customer_orders_status ........... [[32mCREATE VIEW[0m in 0.09s]
[0m19:38:33.375206 [debug] [Thread-1 (]: Finished running node model.dbt_idx.customer_orders_status
[0m19:38:33.376176 [debug] [Thread-1 (]: Began running node model.dbt_idx.stock_update_status
[0m19:38:33.377179 [info ] [Thread-1 (]: 11 of 11 START sql view model IDX-Schema.stock_update_status ................... [RUN]
[0m19:38:33.379182 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_idx.customer_orders_status, now model.dbt_idx.stock_update_status)
[0m19:38:33.380187 [debug] [Thread-1 (]: Began compiling node model.dbt_idx.stock_update_status
[0m19:38:33.384206 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_idx.stock_update_status"
[0m19:38:33.392221 [debug] [Thread-1 (]: Timing info for model.dbt_idx.stock_update_status (compile): 19:38:33.381209 => 19:38:33.391207
[0m19:38:33.393207 [debug] [Thread-1 (]: Began executing node model.dbt_idx.stock_update_status
[0m19:38:33.400735 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_idx.stock_update_status"
[0m19:38:33.416709 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stock_update_status"
[0m19:38:33.418709 [debug] [Thread-1 (]: On model.dbt_idx.stock_update_status: BEGIN
[0m19:38:33.420238 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:38:33.462333 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m19:38:33.464347 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stock_update_status"
[0m19:38:33.465347 [debug] [Thread-1 (]: On model.dbt_idx.stock_update_status: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stock_update_status"} */

  create view "IDX-Stock"."IDX-Schema"."stock_update_status__dbt_tmp"
    
    
  as (
    with stock as (select *,
                        rank() over (
                        partition by ticker
                        order by date desc
                        ) as rank
               from "IDX-Stock"."IDX-Schema"."fact_stocks")
select a.id,
       a.ticker,
       a.name,
       a.date,
       a.open,
       a.high,
       a.low,
       a.close,
       a.volume,
       a.rank,
       a.logo
from stock a
order by a.date, a.ticker desc
  );
[0m19:38:33.470928 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m19:38:33.483613 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stock_update_status"
[0m19:38:33.484626 [debug] [Thread-1 (]: On model.dbt_idx.stock_update_status: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stock_update_status"} */
alter table "IDX-Stock"."IDX-Schema"."stock_update_status__dbt_tmp" rename to "stock_update_status"
[0m19:38:33.488158 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:38:33.493691 [debug] [Thread-1 (]: On model.dbt_idx.stock_update_status: COMMIT
[0m19:38:33.496219 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stock_update_status"
[0m19:38:33.497256 [debug] [Thread-1 (]: On model.dbt_idx.stock_update_status: COMMIT
[0m19:38:33.503412 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m19:38:33.511455 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stock_update_status"
[0m19:38:33.513982 [debug] [Thread-1 (]: On model.dbt_idx.stock_update_status: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stock_update_status"} */
drop view if exists "IDX-Stock"."IDX-Schema"."stock_update_status__dbt_backup" cascade
[0m19:38:33.516030 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m19:38:33.521616 [debug] [Thread-1 (]: Timing info for model.dbt_idx.stock_update_status (execute): 19:38:33.393207 => 19:38:33.521616
[0m19:38:33.524141 [debug] [Thread-1 (]: On model.dbt_idx.stock_update_status: Close
[0m19:38:33.527142 [info ] [Thread-1 (]: 11 of 11 OK created sql view model IDX-Schema.stock_update_status .............. [[32mCREATE VIEW[0m in 0.15s]
[0m19:38:33.529887 [debug] [Thread-1 (]: Finished running node model.dbt_idx.stock_update_status
[0m19:38:33.532427 [debug] [MainThread]: Using postgres connection "master"
[0m19:38:33.533429 [debug] [MainThread]: On master: BEGIN
[0m19:38:33.535086 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m19:38:33.562784 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m19:38:33.563792 [debug] [MainThread]: On master: COMMIT
[0m19:38:33.564782 [debug] [MainThread]: Using postgres connection "master"
[0m19:38:33.565782 [debug] [MainThread]: On master: COMMIT
[0m19:38:33.570897 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m19:38:33.571898 [debug] [MainThread]: On master: Close
[0m19:38:33.572885 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:38:33.574419 [debug] [MainThread]: Connection 'list_IDX-Stock' was properly closed.
[0m19:38:33.575432 [debug] [MainThread]: Connection 'list_IDX-Stock_snapshots' was properly closed.
[0m19:38:33.576457 [debug] [MainThread]: Connection 'model.dbt_idx.stock_update_status' was properly closed.
[0m19:38:33.577433 [info ] [MainThread]: 
[0m19:38:33.580432 [info ] [MainThread]: Finished running 8 view models, 3 table models in 0 hours 0 minutes and 1.64 seconds (1.64s).
[0m19:38:33.587052 [debug] [MainThread]: Command end result
[0m19:38:33.641689 [info ] [MainThread]: 
[0m19:38:33.642656 [info ] [MainThread]: [32mCompleted successfully[0m
[0m19:38:33.643657 [info ] [MainThread]: 
[0m19:38:33.645656 [info ] [MainThread]: Done. PASS=11 WARN=0 ERROR=0 SKIP=0 TOTAL=11
[0m19:38:33.647650 [debug] [MainThread]: Command `dbt run` succeeded at 19:38:33.647650 after 2.18 seconds
[0m19:38:33.649163 [debug] [MainThread]: Flushing usage events


============================== 19:39:07.432749 | bdd1d900-8694-4c56-8575-3c84afb92211 ==============================
[0m19:39:07.432749 [info ] [MainThread]: Running with dbt=1.6.1
[0m19:39:07.439987 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': 'D:\\00 Project\\00 My Project\\IdeaProjects\\Py-DBT-IDX', 'log_path': 'D:\\00 Project\\00 My Project\\IdeaProjects\\Py-DBT-IDX\\logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'False'}
[0m19:39:07.599379 [info ] [MainThread]: Registered adapter: postgres=1.6.1
[0m19:39:07.610942 [debug] [MainThread]: checksum: efe19d9f5b93d1a98cc804fbfcdb6b3aced98b974af664946fee1cde8837deb7, vars: {}, profile: , target: , version: 1.6.1
[0m19:39:07.779915 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m19:39:07.780912 [debug] [MainThread]: Partial parsing: updated file: dbt_idx://models\marts\stock\stock_update_status.sql
[0m19:39:07.909193 [info ] [MainThread]: Found 11 models, 1 snapshot, 18 tests, 5 sources, 0 exposures, 0 metrics, 349 macros, 0 groups, 0 semantic models
[0m19:39:07.912237 [info ] [MainThread]: 
[0m19:39:07.914221 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m19:39:07.918219 [debug] [ThreadPool]: Acquiring new postgres connection 'list_IDX-Stock'
[0m19:39:07.937035 [debug] [ThreadPool]: Using postgres connection "list_IDX-Stock"
[0m19:39:07.938994 [debug] [ThreadPool]: On list_IDX-Stock: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "connection_name": "list_IDX-Stock"} */

    select distinct nspname from pg_namespace
  
[0m19:39:07.941004 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:39:07.981774 [debug] [ThreadPool]: SQL status: SELECT 12 in 0.0 seconds
[0m19:39:07.983315 [debug] [ThreadPool]: On list_IDX-Stock: Close
[0m19:39:07.989856 [debug] [ThreadPool]: Acquiring new postgres connection 'list_IDX-Stock_snapshots'
[0m19:39:07.997355 [debug] [ThreadPool]: Using postgres connection "list_IDX-Stock_snapshots"
[0m19:39:07.998364 [debug] [ThreadPool]: On list_IDX-Stock_snapshots: BEGIN
[0m19:39:07.999367 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:39:08.023457 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m19:39:08.024430 [debug] [ThreadPool]: Using postgres connection "list_IDX-Stock_snapshots"
[0m19:39:08.025429 [debug] [ThreadPool]: On list_IDX-Stock_snapshots: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "connection_name": "list_IDX-Stock_snapshots"} */
select
      'IDX-Stock' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'snapshots'
    union all
    select
      'IDX-Stock' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'snapshots'
    union all
    select
      'IDX-Stock' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'snapshots'
  
[0m19:39:08.030157 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.0 seconds
[0m19:39:08.033169 [debug] [ThreadPool]: On list_IDX-Stock_snapshots: ROLLBACK
[0m19:39:08.035867 [debug] [ThreadPool]: On list_IDX-Stock_snapshots: Close
[0m19:39:08.037861 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_IDX-Stock_snapshots, now list_IDX-Stock_IDX-Schema)
[0m19:39:08.043390 [debug] [ThreadPool]: Using postgres connection "list_IDX-Stock_IDX-Schema"
[0m19:39:08.043390 [debug] [ThreadPool]: On list_IDX-Stock_IDX-Schema: BEGIN
[0m19:39:08.044405 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:39:08.068169 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m19:39:08.069169 [debug] [ThreadPool]: Using postgres connection "list_IDX-Stock_IDX-Schema"
[0m19:39:08.070193 [debug] [ThreadPool]: On list_IDX-Stock_IDX-Schema: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "connection_name": "list_IDX-Stock_IDX-Schema"} */
select
      'IDX-Stock' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'IDX-Schema'
    union all
    select
      'IDX-Stock' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'IDX-Schema'
    union all
    select
      'IDX-Stock' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'IDX-Schema'
  
[0m19:39:08.075693 [debug] [ThreadPool]: SQL status: SELECT 17 in 0.0 seconds
[0m19:39:08.078693 [debug] [ThreadPool]: On list_IDX-Stock_IDX-Schema: ROLLBACK
[0m19:39:08.081705 [debug] [ThreadPool]: On list_IDX-Stock_IDX-Schema: Close
[0m19:39:08.095754 [debug] [MainThread]: Using postgres connection "master"
[0m19:39:08.097749 [debug] [MainThread]: On master: BEGIN
[0m19:39:08.098749 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:39:08.121871 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m19:39:08.124192 [debug] [MainThread]: Using postgres connection "master"
[0m19:39:08.124192 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m19:39:08.136699 [debug] [MainThread]: SQL status: SELECT 9 in 0.0 seconds
[0m19:39:08.142214 [debug] [MainThread]: On master: ROLLBACK
[0m19:39:08.144726 [debug] [MainThread]: Using postgres connection "master"
[0m19:39:08.145752 [debug] [MainThread]: On master: BEGIN
[0m19:39:08.151291 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m19:39:08.151291 [debug] [MainThread]: On master: COMMIT
[0m19:39:08.152268 [debug] [MainThread]: Using postgres connection "master"
[0m19:39:08.153279 [debug] [MainThread]: On master: COMMIT
[0m19:39:08.155266 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m19:39:08.156266 [debug] [MainThread]: On master: Close
[0m19:39:08.158267 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m19:39:08.160268 [info ] [MainThread]: 
[0m19:39:08.166269 [debug] [Thread-1 (]: Began running node model.dbt_idx.stg_eltool__company
[0m19:39:08.168371 [info ] [Thread-1 (]: 1 of 11 START sql view model IDX-Schema.stg_eltool__company .................... [RUN]
[0m19:39:08.171345 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.dbt_idx.stg_eltool__company'
[0m19:39:08.172324 [debug] [Thread-1 (]: Began compiling node model.dbt_idx.stg_eltool__company
[0m19:39:08.185357 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_idx.stg_eltool__company"
[0m19:39:08.192871 [debug] [Thread-1 (]: Timing info for model.dbt_idx.stg_eltool__company (compile): 19:39:08.173900 => 19:39:08.192871
[0m19:39:08.193871 [debug] [Thread-1 (]: Began executing node model.dbt_idx.stg_eltool__company
[0m19:39:08.238076 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_idx.stg_eltool__company"
[0m19:39:08.244617 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__company"
[0m19:39:08.245626 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__company: BEGIN
[0m19:39:08.246625 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m19:39:08.273680 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m19:39:08.274675 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__company"
[0m19:39:08.275673 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__company: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__company"} */

  create view "IDX-Stock"."IDX-Schema"."stg_eltool__company__dbt_tmp"
    
    
  as (
    with source as (select *
                from "IDX-Stock"."IDX-Schema"."ksql-company-stream"),
     renamed as (select id,
                        ticker,
                        name,
                        logo
                 from source)
select *
from renamed
  );
[0m19:39:08.279731 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m19:39:08.288405 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__company"
[0m19:39:08.289354 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__company: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__company"} */
alter table "IDX-Stock"."IDX-Schema"."stg_eltool__company" rename to "stg_eltool__company__dbt_backup"
[0m19:39:08.292362 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:39:08.296391 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__company"
[0m19:39:08.297412 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__company: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__company"} */
alter table "IDX-Stock"."IDX-Schema"."stg_eltool__company__dbt_tmp" rename to "stg_eltool__company"
[0m19:39:08.300901 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:39:08.319925 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__company: COMMIT
[0m19:39:08.321950 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__company"
[0m19:39:08.322932 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__company: COMMIT
[0m19:39:08.325952 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m19:39:08.336485 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__company"
[0m19:39:08.337510 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__company: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__company"} */
drop view if exists "IDX-Stock"."IDX-Schema"."stg_eltool__company__dbt_backup" cascade
[0m19:39:08.341447 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m19:39:08.344450 [debug] [Thread-1 (]: Timing info for model.dbt_idx.stg_eltool__company (execute): 19:39:08.194870 => 19:39:08.343451
[0m19:39:08.344450 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__company: Close
[0m19:39:08.347463 [info ] [Thread-1 (]: 1 of 11 OK created sql view model IDX-Schema.stg_eltool__company ............... [[32mCREATE VIEW[0m in 0.18s]
[0m19:39:08.349486 [debug] [Thread-1 (]: Finished running node model.dbt_idx.stg_eltool__company
[0m19:39:08.350451 [debug] [Thread-1 (]: Began running node model.dbt_idx.stg_eltool__customers
[0m19:39:08.352451 [info ] [Thread-1 (]: 2 of 11 START sql view model IDX-Schema.stg_eltool__customers .................. [RUN]
[0m19:39:08.353447 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_idx.stg_eltool__company, now model.dbt_idx.stg_eltool__customers)
[0m19:39:08.354460 [debug] [Thread-1 (]: Began compiling node model.dbt_idx.stg_eltool__customers
[0m19:39:08.357447 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_idx.stg_eltool__customers"
[0m19:39:08.364320 [debug] [Thread-1 (]: Timing info for model.dbt_idx.stg_eltool__customers (compile): 19:39:08.354460 => 19:39:08.363372
[0m19:39:08.365333 [debug] [Thread-1 (]: Began executing node model.dbt_idx.stg_eltool__customers
[0m19:39:08.371423 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_idx.stg_eltool__customers"
[0m19:39:08.378725 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__customers"
[0m19:39:08.379727 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__customers: BEGIN
[0m19:39:08.379727 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:39:08.404272 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m19:39:08.405313 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__customers"
[0m19:39:08.406276 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__customers: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__customers"} */

  create view "IDX-Stock"."IDX-Schema"."stg_eltool__customers__dbt_tmp"
    
    
  as (
    with source as (select *
                from "IDX-Stock"."IDX-Schema"."customers"),
     renamed as (select
                     customer_id,
                    'This is Dummy' as dummy
                 from source
                 where customer_id = 1234567890)
select *
from renamed
  );
[0m19:39:08.409838 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m19:39:08.413887 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__customers"
[0m19:39:08.414850 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__customers: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__customers"} */
alter table "IDX-Stock"."IDX-Schema"."stg_eltool__customers" rename to "stg_eltool__customers__dbt_backup"
[0m19:39:08.416851 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:39:08.419884 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__customers"
[0m19:39:08.420853 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__customers: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__customers"} */
alter table "IDX-Stock"."IDX-Schema"."stg_eltool__customers__dbt_tmp" rename to "stg_eltool__customers"
[0m19:39:08.422852 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:39:08.424851 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__customers: COMMIT
[0m19:39:08.425850 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__customers"
[0m19:39:08.426861 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__customers: COMMIT
[0m19:39:08.429428 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m19:39:08.433473 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__customers"
[0m19:39:08.433473 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__customers: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__customers"} */
drop view if exists "IDX-Stock"."IDX-Schema"."stg_eltool__customers__dbt_backup" cascade
[0m19:39:08.437455 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m19:39:08.439442 [debug] [Thread-1 (]: Timing info for model.dbt_idx.stg_eltool__customers (execute): 19:39:08.366325 => 19:39:08.439442
[0m19:39:08.440443 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__customers: Close
[0m19:39:08.442440 [info ] [Thread-1 (]: 2 of 11 OK created sql view model IDX-Schema.stg_eltool__customers ............. [[32mCREATE VIEW[0m in 0.09s]
[0m19:39:08.445464 [debug] [Thread-1 (]: Finished running node model.dbt_idx.stg_eltool__customers
[0m19:39:08.446447 [debug] [Thread-1 (]: Began running node model.dbt_idx.stg_eltool__customers_snapshots
[0m19:39:08.447440 [info ] [Thread-1 (]: 3 of 11 START sql view model IDX-Schema.stg_eltool__customers_snapshots ........ [RUN]
[0m19:39:08.449475 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_idx.stg_eltool__customers, now model.dbt_idx.stg_eltool__customers_snapshots)
[0m19:39:08.450441 [debug] [Thread-1 (]: Began compiling node model.dbt_idx.stg_eltool__customers_snapshots
[0m19:39:08.453442 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_idx.stg_eltool__customers_snapshots"
[0m19:39:08.462020 [debug] [Thread-1 (]: Timing info for model.dbt_idx.stg_eltool__customers_snapshots (compile): 19:39:08.450441 => 19:39:08.460991
[0m19:39:08.463003 [debug] [Thread-1 (]: Began executing node model.dbt_idx.stg_eltool__customers_snapshots
[0m19:39:08.472062 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_idx.stg_eltool__customers_snapshots"
[0m19:39:08.479064 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__customers_snapshots"
[0m19:39:08.480083 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__customers_snapshots: BEGIN
[0m19:39:08.481080 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:39:08.504558 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m19:39:08.505569 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__customers_snapshots"
[0m19:39:08.505569 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__customers_snapshots: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__customers_snapshots"} */

  create view "IDX-Stock"."IDX-Schema"."stg_eltool__customers_snapshots__dbt_tmp"
    
    
  as (
    with source as (select *
                from "IDX-Stock"."snapshots"."customers_snapshot"),
     renamed as (select customer_id,
                        zipcode,
                        city,
                        state_code,
                        datetime_created::TIMESTAMP AS datetime_created,
                        datetime_updated::TIMESTAMP AS datetime_updated,
                        dbt_valid_from,
                        dbt_valid_to
                 from source)
select *
from renamed
  );
[0m19:39:08.509585 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m19:39:08.512598 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__customers_snapshots"
[0m19:39:08.513593 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__customers_snapshots: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__customers_snapshots"} */
alter table "IDX-Stock"."IDX-Schema"."stg_eltool__customers_snapshots" rename to "stg_eltool__customers_snapshots__dbt_backup"
[0m19:39:08.516569 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:39:08.520595 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__customers_snapshots"
[0m19:39:08.521569 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__customers_snapshots: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__customers_snapshots"} */
alter table "IDX-Stock"."IDX-Schema"."stg_eltool__customers_snapshots__dbt_tmp" rename to "stg_eltool__customers_snapshots"
[0m19:39:08.523581 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:39:08.526606 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__customers_snapshots: COMMIT
[0m19:39:08.526606 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__customers_snapshots"
[0m19:39:08.527604 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__customers_snapshots: COMMIT
[0m19:39:08.530615 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m19:39:08.533657 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__customers_snapshots"
[0m19:39:08.534658 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__customers_snapshots: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__customers_snapshots"} */
drop view if exists "IDX-Stock"."IDX-Schema"."stg_eltool__customers_snapshots__dbt_backup" cascade
[0m19:39:08.538625 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m19:39:08.540650 [debug] [Thread-1 (]: Timing info for model.dbt_idx.stg_eltool__customers_snapshots (execute): 19:39:08.464005 => 19:39:08.539623
[0m19:39:08.540650 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__customers_snapshots: Close
[0m19:39:08.542635 [info ] [Thread-1 (]: 3 of 11 OK created sql view model IDX-Schema.stg_eltool__customers_snapshots ... [[32mCREATE VIEW[0m in 0.09s]
[0m19:39:08.544651 [debug] [Thread-1 (]: Finished running node model.dbt_idx.stg_eltool__customers_snapshots
[0m19:39:08.545653 [debug] [Thread-1 (]: Began running node model.dbt_idx.stg_eltool__orders
[0m19:39:08.546624 [info ] [Thread-1 (]: 4 of 11 START sql view model IDX-Schema.stg_eltool__orders ..................... [RUN]
[0m19:39:08.547645 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_idx.stg_eltool__customers_snapshots, now model.dbt_idx.stg_eltool__orders)
[0m19:39:08.548663 [debug] [Thread-1 (]: Began compiling node model.dbt_idx.stg_eltool__orders
[0m19:39:08.551658 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_idx.stg_eltool__orders"
[0m19:39:08.561622 [debug] [Thread-1 (]: Timing info for model.dbt_idx.stg_eltool__orders (compile): 19:39:08.548663 => 19:39:08.561622
[0m19:39:08.562626 [debug] [Thread-1 (]: Began executing node model.dbt_idx.stg_eltool__orders
[0m19:39:08.568661 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_idx.stg_eltool__orders"
[0m19:39:08.578673 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__orders"
[0m19:39:08.580668 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__orders: BEGIN
[0m19:39:08.580668 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:39:08.601908 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m19:39:08.602876 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__orders"
[0m19:39:08.603876 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__orders: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__orders"} */

  create view "IDX-Stock"."IDX-Schema"."stg_eltool__orders__dbt_tmp"
    
    
  as (
    with source as (select *
                from "IDX-Stock"."IDX-Schema"."orders"),
     renamed as (select order_id,
                        cust_id AS customer_id,
                        order_status,
                        order_purchase_timestamp::TIMESTAMP,
                        order_approved_at::TIMESTAMP,
                        order_delivered_carrier_date::TIMESTAMP,
                        order_delivered_customer_date::TIMESTAMP,
                        order_estimated_delivery_date::TIMESTAMP
                 from source)
select *
from renamed
  );
[0m19:39:08.606891 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m19:39:08.610910 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__orders"
[0m19:39:08.611908 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__orders: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__orders"} */
alter table "IDX-Stock"."IDX-Schema"."stg_eltool__orders" rename to "stg_eltool__orders__dbt_backup"
[0m19:39:08.613873 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:39:08.617875 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__orders"
[0m19:39:08.617875 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__orders: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__orders"} */
alter table "IDX-Stock"."IDX-Schema"."stg_eltool__orders__dbt_tmp" rename to "stg_eltool__orders"
[0m19:39:08.620736 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:39:08.622775 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__orders: COMMIT
[0m19:39:08.623771 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__orders"
[0m19:39:08.624746 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__orders: COMMIT
[0m19:39:08.627759 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m19:39:08.630769 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__orders"
[0m19:39:08.631769 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__orders: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__orders"} */
drop view if exists "IDX-Stock"."IDX-Schema"."stg_eltool__orders__dbt_backup" cascade
[0m19:39:08.635769 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m19:39:08.637734 [debug] [Thread-1 (]: Timing info for model.dbt_idx.stg_eltool__orders (execute): 19:39:08.562626 => 19:39:08.637734
[0m19:39:08.638734 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__orders: Close
[0m19:39:08.640741 [info ] [Thread-1 (]: 4 of 11 OK created sql view model IDX-Schema.stg_eltool__orders ................ [[32mCREATE VIEW[0m in 0.09s]
[0m19:39:08.642738 [debug] [Thread-1 (]: Finished running node model.dbt_idx.stg_eltool__orders
[0m19:39:08.643752 [debug] [Thread-1 (]: Began running node model.dbt_idx.stg_eltool__state
[0m19:39:08.644734 [info ] [Thread-1 (]: 5 of 11 START sql view model IDX-Schema.stg_eltool__state ...................... [RUN]
[0m19:39:08.645734 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_idx.stg_eltool__orders, now model.dbt_idx.stg_eltool__state)
[0m19:39:08.646734 [debug] [Thread-1 (]: Began compiling node model.dbt_idx.stg_eltool__state
[0m19:39:08.649738 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_idx.stg_eltool__state"
[0m19:39:08.655771 [debug] [Thread-1 (]: Timing info for model.dbt_idx.stg_eltool__state (compile): 19:39:08.647753 => 19:39:08.655771
[0m19:39:08.656733 [debug] [Thread-1 (]: Began executing node model.dbt_idx.stg_eltool__state
[0m19:39:08.662734 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_idx.stg_eltool__state"
[0m19:39:08.669778 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__state"
[0m19:39:08.669778 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__state: BEGIN
[0m19:39:08.670777 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:39:08.691629 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m19:39:08.692627 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__state"
[0m19:39:08.693629 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__state: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__state"} */

  create view "IDX-Stock"."IDX-Schema"."stg_eltool__state__dbt_tmp"
    
    
  as (
    with source as (select *
                from "IDX-Stock"."IDX-Schema"."state"),
     renamed as (select state_identifier::INT AS state_id,
                         state_code::VARCHAR(2) AS state_code,
                         st_name::VARCHAR(30) AS state_name
                 from source)
select *
from renamed
  );
[0m19:39:08.696570 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m19:39:08.700617 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__state"
[0m19:39:08.700617 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__state: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__state"} */
alter table "IDX-Stock"."IDX-Schema"."stg_eltool__state" rename to "stg_eltool__state__dbt_backup"
[0m19:39:08.703583 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:39:08.707587 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__state"
[0m19:39:08.708585 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__state: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__state"} */
alter table "IDX-Stock"."IDX-Schema"."stg_eltool__state__dbt_tmp" rename to "stg_eltool__state"
[0m19:39:08.711296 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:39:08.713319 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__state: COMMIT
[0m19:39:08.714319 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__state"
[0m19:39:08.714319 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__state: COMMIT
[0m19:39:08.718296 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m19:39:08.723292 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__state"
[0m19:39:08.724292 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__state: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__state"} */
drop view if exists "IDX-Stock"."IDX-Schema"."stg_eltool__state__dbt_backup" cascade
[0m19:39:08.727822 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m19:39:08.729858 [debug] [Thread-1 (]: Timing info for model.dbt_idx.stg_eltool__state (execute): 19:39:08.657734 => 19:39:08.729858
[0m19:39:08.730833 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__state: Close
[0m19:39:08.731821 [info ] [Thread-1 (]: 5 of 11 OK created sql view model IDX-Schema.stg_eltool__state ................. [[32mCREATE VIEW[0m in 0.09s]
[0m19:39:08.734827 [debug] [Thread-1 (]: Finished running node model.dbt_idx.stg_eltool__state
[0m19:39:08.735842 [debug] [Thread-1 (]: Began running node model.dbt_idx.stg_eltool__stock
[0m19:39:08.737843 [info ] [Thread-1 (]: 6 of 11 START sql view model IDX-Schema.stg_eltool__stock ...................... [RUN]
[0m19:39:08.738849 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_idx.stg_eltool__state, now model.dbt_idx.stg_eltool__stock)
[0m19:39:08.739860 [debug] [Thread-1 (]: Began compiling node model.dbt_idx.stg_eltool__stock
[0m19:39:08.742853 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_idx.stg_eltool__stock"
[0m19:39:08.748510 [debug] [Thread-1 (]: Timing info for model.dbt_idx.stg_eltool__stock (compile): 19:39:08.740819 => 19:39:08.748510
[0m19:39:08.749476 [debug] [Thread-1 (]: Began executing node model.dbt_idx.stg_eltool__stock
[0m19:39:08.755512 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_idx.stg_eltool__stock"
[0m19:39:08.761473 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__stock"
[0m19:39:08.762477 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__stock: BEGIN
[0m19:39:08.763476 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:39:08.783891 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m19:39:08.785058 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__stock"
[0m19:39:08.785058 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__stock: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__stock"} */

  create view "IDX-Stock"."IDX-Schema"."stg_eltool__stock__dbt_tmp"
    
    
  as (
    with source as (select *
                from "IDX-Stock"."IDX-Schema"."ksql-stock-stream"),
     renamed as (select *
                 from source)
select *
from renamed
  );
[0m19:39:08.789767 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m19:39:08.793767 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__stock"
[0m19:39:08.794770 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__stock: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__stock"} */
alter table "IDX-Stock"."IDX-Schema"."stg_eltool__stock" rename to "stg_eltool__stock__dbt_backup"
[0m19:39:08.796767 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:39:08.799769 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__stock"
[0m19:39:08.800807 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__stock: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__stock"} */
alter table "IDX-Stock"."IDX-Schema"."stg_eltool__stock__dbt_tmp" rename to "stg_eltool__stock"
[0m19:39:08.802804 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:39:08.805793 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__stock: COMMIT
[0m19:39:08.805793 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__stock"
[0m19:39:08.806796 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__stock: COMMIT
[0m19:39:08.809706 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m19:39:08.813708 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__stock"
[0m19:39:08.813708 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__stock: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__stock"} */
drop view if exists "IDX-Stock"."IDX-Schema"."stg_eltool__stock__dbt_backup" cascade
[0m19:39:08.818308 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m19:39:08.820329 [debug] [Thread-1 (]: Timing info for model.dbt_idx.stg_eltool__stock (execute): 19:39:08.750478 => 19:39:08.819331
[0m19:39:08.820329 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__stock: Close
[0m19:39:08.822315 [info ] [Thread-1 (]: 6 of 11 OK created sql view model IDX-Schema.stg_eltool__stock ................. [[32mCREATE VIEW[0m in 0.08s]
[0m19:39:08.824306 [debug] [Thread-1 (]: Finished running node model.dbt_idx.stg_eltool__stock
[0m19:39:08.825307 [debug] [Thread-1 (]: Began running node model.dbt_idx.fact_orders
[0m19:39:08.826303 [info ] [Thread-1 (]: 7 of 11 START sql table model IDX-Schema.fact_orders ........................... [RUN]
[0m19:39:08.828330 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_idx.stg_eltool__stock, now model.dbt_idx.fact_orders)
[0m19:39:08.829302 [debug] [Thread-1 (]: Began compiling node model.dbt_idx.fact_orders
[0m19:39:08.831333 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_idx.fact_orders"
[0m19:39:08.837417 [debug] [Thread-1 (]: Timing info for model.dbt_idx.fact_orders (compile): 19:39:08.829302 => 19:39:08.837417
[0m19:39:08.838415 [debug] [Thread-1 (]: Began executing node model.dbt_idx.fact_orders
[0m19:39:08.861423 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_idx.fact_orders"
[0m19:39:08.867706 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.fact_orders"
[0m19:39:08.868721 [debug] [Thread-1 (]: On model.dbt_idx.fact_orders: BEGIN
[0m19:39:08.869733 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:39:08.892511 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m19:39:08.893525 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.fact_orders"
[0m19:39:08.894506 [debug] [Thread-1 (]: On model.dbt_idx.fact_orders: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.fact_orders"} */

  
    

  create  table "IDX-Stock"."IDX-Schema"."fact_orders__dbt_tmp"
  
  
    as
  
  (
    with orders as (
    select *
    from "IDX-Stock"."IDX-Schema"."stg_eltool__orders"
)
select * from orders
  );
  
[0m19:39:08.900615 [debug] [Thread-1 (]: SQL status: SELECT 999 in 0.0 seconds
[0m19:39:08.903579 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.fact_orders"
[0m19:39:08.904580 [debug] [Thread-1 (]: On model.dbt_idx.fact_orders: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.fact_orders"} */
alter table "IDX-Stock"."IDX-Schema"."fact_orders" rename to "fact_orders__dbt_backup"
[0m19:39:08.906580 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:39:08.911581 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.fact_orders"
[0m19:39:08.912591 [debug] [Thread-1 (]: On model.dbt_idx.fact_orders: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.fact_orders"} */
alter table "IDX-Stock"."IDX-Schema"."fact_orders__dbt_tmp" rename to "fact_orders"
[0m19:39:08.914616 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:39:08.921577 [debug] [Thread-1 (]: On model.dbt_idx.fact_orders: COMMIT
[0m19:39:08.922579 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.fact_orders"
[0m19:39:08.923585 [debug] [Thread-1 (]: On model.dbt_idx.fact_orders: COMMIT
[0m19:39:08.926496 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m19:39:08.932500 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.fact_orders"
[0m19:39:08.932500 [debug] [Thread-1 (]: On model.dbt_idx.fact_orders: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.fact_orders"} */
drop table if exists "IDX-Stock"."IDX-Schema"."fact_orders__dbt_backup" cascade
[0m19:39:08.937496 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m19:39:08.939522 [debug] [Thread-1 (]: Timing info for model.dbt_idx.fact_orders (execute): 19:39:08.839388 => 19:39:08.939522
[0m19:39:08.940520 [debug] [Thread-1 (]: On model.dbt_idx.fact_orders: Close
[0m19:39:08.941527 [info ] [Thread-1 (]: 7 of 11 OK created sql table model IDX-Schema.fact_orders ...................... [[32mSELECT 999[0m in 0.11s]
[0m19:39:08.943502 [debug] [Thread-1 (]: Finished running node model.dbt_idx.fact_orders
[0m19:39:08.944539 [debug] [Thread-1 (]: Began running node model.dbt_idx.dim_customers
[0m19:39:08.945504 [info ] [Thread-1 (]: 8 of 11 START sql table model IDX-Schema.dim_customers ......................... [RUN]
[0m19:39:08.947495 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_idx.fact_orders, now model.dbt_idx.dim_customers)
[0m19:39:08.948498 [debug] [Thread-1 (]: Began compiling node model.dbt_idx.dim_customers
[0m19:39:08.951540 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_idx.dim_customers"
[0m19:39:08.958514 [debug] [Thread-1 (]: Timing info for model.dbt_idx.dim_customers (compile): 19:39:08.949518 => 19:39:08.958514
[0m19:39:08.959550 [debug] [Thread-1 (]: Began executing node model.dbt_idx.dim_customers
[0m19:39:08.969571 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_idx.dim_customers"
[0m19:39:08.975888 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.dim_customers"
[0m19:39:08.976883 [debug] [Thread-1 (]: On model.dbt_idx.dim_customers: BEGIN
[0m19:39:08.977880 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:39:09.000104 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m19:39:09.001105 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.dim_customers"
[0m19:39:09.002091 [debug] [Thread-1 (]: On model.dbt_idx.dim_customers: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.dim_customers"} */

  
    

  create  table "IDX-Stock"."IDX-Schema"."dim_customers__dbt_tmp"
  
  
    as
  
  (
    -- noinspection SqlDialectInspectionForFile

with customers as (
    select *
    from "IDX-Stock"."IDX-Schema"."stg_eltool__customers_snapshots"
    ),
     state as (
         select *
         from "IDX-Stock"."IDX-Schema"."stg_eltool__state"
     )
select c.customer_id,
       c.zipcode,
       c.city,
       c.state_code,
       s.state_name,
       c.datetime_created,
       c.datetime_updated,
       c.dbt_valid_from::TIMESTAMP as valid_from,
        CASE WHEN c.dbt_valid_to IS NULL
            THEN '9999-12-31'::TIMESTAMP
            ELSE c.dbt_valid_to::TIMESTAMP
        END as valid_to
from customers c
    join state s on c.state_code = s.state_code
  );
  
[0m19:39:09.005929 [debug] [Thread-1 (]: SQL status: SELECT 100 in 0.0 seconds
[0m19:39:09.009976 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.dim_customers"
[0m19:39:09.009976 [debug] [Thread-1 (]: On model.dbt_idx.dim_customers: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.dim_customers"} */
alter table "IDX-Stock"."IDX-Schema"."dim_customers" rename to "dim_customers__dbt_backup"
[0m19:39:09.012515 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:39:09.053535 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.dim_customers"
[0m19:39:09.053535 [debug] [Thread-1 (]: On model.dbt_idx.dim_customers: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.dim_customers"} */
alter table "IDX-Stock"."IDX-Schema"."dim_customers__dbt_tmp" rename to "dim_customers"
[0m19:39:09.056310 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:39:09.058310 [debug] [Thread-1 (]: On model.dbt_idx.dim_customers: COMMIT
[0m19:39:09.059310 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.dim_customers"
[0m19:39:09.060310 [debug] [Thread-1 (]: On model.dbt_idx.dim_customers: COMMIT
[0m19:39:09.063725 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m19:39:09.067736 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.dim_customers"
[0m19:39:09.068736 [debug] [Thread-1 (]: On model.dbt_idx.dim_customers: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.dim_customers"} */
drop table if exists "IDX-Stock"."IDX-Schema"."dim_customers__dbt_backup" cascade
[0m19:39:09.072744 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m19:39:09.074743 [debug] [Thread-1 (]: Timing info for model.dbt_idx.dim_customers (execute): 19:39:08.960504 => 19:39:09.074743
[0m19:39:09.075743 [debug] [Thread-1 (]: On model.dbt_idx.dim_customers: Close
[0m19:39:09.077763 [info ] [Thread-1 (]: 8 of 11 OK created sql table model IDX-Schema.dim_customers .................... [[32mSELECT 100[0m in 0.13s]
[0m19:39:09.078742 [debug] [Thread-1 (]: Finished running node model.dbt_idx.dim_customers
[0m19:39:09.079761 [debug] [Thread-1 (]: Began running node model.dbt_idx.fact_stocks
[0m19:39:09.080743 [info ] [Thread-1 (]: 9 of 11 START sql table model IDX-Schema.fact_stocks ........................... [RUN]
[0m19:39:09.082743 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_idx.dim_customers, now model.dbt_idx.fact_stocks)
[0m19:39:09.082743 [debug] [Thread-1 (]: Began compiling node model.dbt_idx.fact_stocks
[0m19:39:09.086255 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_idx.fact_stocks"
[0m19:39:09.092433 [debug] [Thread-1 (]: Timing info for model.dbt_idx.fact_stocks (compile): 19:39:09.082743 => 19:39:09.092433
[0m19:39:09.093450 [debug] [Thread-1 (]: Began executing node model.dbt_idx.fact_stocks
[0m19:39:09.098449 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_idx.fact_stocks"
[0m19:39:09.104417 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.fact_stocks"
[0m19:39:09.105415 [debug] [Thread-1 (]: On model.dbt_idx.fact_stocks: BEGIN
[0m19:39:09.105415 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:39:09.128353 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m19:39:09.129364 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.fact_stocks"
[0m19:39:09.129364 [debug] [Thread-1 (]: On model.dbt_idx.fact_stocks: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.fact_stocks"} */

  
    

  create  table "IDX-Stock"."IDX-Schema"."fact_stocks__dbt_tmp"
  
  
    as
  
  (
    -- noinspection SqlDialectInspectionForFile

with stock as (
    select *
    from "IDX-Stock"."IDX-Schema"."stg_eltool__stock"
    ),
     company as (
         select *
         from "IDX-Stock"."IDX-Schema"."stg_eltool__company"
     )
select a.id,
       a.ticker,
       b.name,
       a.date,
       a.open,
       a.high,
       a.low,
       a.close,
       a.volume,
       b.logo
from stock a
    join company b on a.ticker = b.ticker
  );
  
[0m19:39:09.167443 [debug] [Thread-1 (]: SQL status: SELECT 26131 in 0.0 seconds
[0m19:39:09.171457 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.fact_stocks"
[0m19:39:09.172472 [debug] [Thread-1 (]: On model.dbt_idx.fact_stocks: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.fact_stocks"} */
alter table "IDX-Stock"."IDX-Schema"."fact_stocks" rename to "fact_stocks__dbt_backup"
[0m19:39:09.175460 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:39:09.181459 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.fact_stocks"
[0m19:39:09.182514 [debug] [Thread-1 (]: On model.dbt_idx.fact_stocks: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.fact_stocks"} */
alter table "IDX-Stock"."IDX-Schema"."fact_stocks__dbt_tmp" rename to "fact_stocks"
[0m19:39:09.185479 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:39:09.188505 [debug] [Thread-1 (]: On model.dbt_idx.fact_stocks: COMMIT
[0m19:39:09.189480 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.fact_stocks"
[0m19:39:09.189480 [debug] [Thread-1 (]: On model.dbt_idx.fact_stocks: COMMIT
[0m19:39:09.199185 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m19:39:09.203219 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.fact_stocks"
[0m19:39:09.204184 [debug] [Thread-1 (]: On model.dbt_idx.fact_stocks: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.fact_stocks"} */
drop table if exists "IDX-Stock"."IDX-Schema"."fact_stocks__dbt_backup" cascade
[0m19:39:09.209205 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m19:39:09.211209 [debug] [Thread-1 (]: Timing info for model.dbt_idx.fact_stocks (execute): 19:39:09.094414 => 19:39:09.211209
[0m19:39:09.212209 [debug] [Thread-1 (]: On model.dbt_idx.fact_stocks: Close
[0m19:39:09.214184 [info ] [Thread-1 (]: 9 of 11 OK created sql table model IDX-Schema.fact_stocks ...................... [[32mSELECT 26131[0m in 0.13s]
[0m19:39:09.216216 [debug] [Thread-1 (]: Finished running node model.dbt_idx.fact_stocks
[0m19:39:09.218186 [debug] [Thread-1 (]: Began running node model.dbt_idx.customer_orders_status
[0m19:39:09.219183 [info ] [Thread-1 (]: 10 of 11 START sql view model IDX-Schema.customer_orders_status ................ [RUN]
[0m19:39:09.220184 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_idx.fact_stocks, now model.dbt_idx.customer_orders_status)
[0m19:39:09.221213 [debug] [Thread-1 (]: Began compiling node model.dbt_idx.customer_orders_status
[0m19:39:09.224213 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_idx.customer_orders_status"
[0m19:39:09.230185 [debug] [Thread-1 (]: Timing info for model.dbt_idx.customer_orders_status (compile): 19:39:09.222185 => 19:39:09.230185
[0m19:39:09.231211 [debug] [Thread-1 (]: Began executing node model.dbt_idx.customer_orders_status
[0m19:39:09.236218 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_idx.customer_orders_status"
[0m19:39:09.243185 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.customer_orders_status"
[0m19:39:09.244220 [debug] [Thread-1 (]: On model.dbt_idx.customer_orders_status: BEGIN
[0m19:39:09.245210 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:39:09.269190 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m19:39:09.270199 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.customer_orders_status"
[0m19:39:09.272219 [debug] [Thread-1 (]: On model.dbt_idx.customer_orders_status: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.customer_orders_status"} */

  create view "IDX-Stock"."IDX-Schema"."customer_orders_status__dbt_tmp"
    
    
  as (
    with orders as (select *
                from "IDX-Stock"."IDX-Schema"."fact_orders"),
     customers as (select *
                   from "IDX-Stock"."IDX-Schema"."dim_customers")
select o.order_id,
       o.customer_id,
       o.order_status,
       o.order_purchase_timestamp,
       o.order_approved_at,
       o.order_delivered_carrier_date,
       o.order_delivered_customer_date,
       o.order_estimated_delivery_date,
       c.zipcode    as customer_zipcode,
       c.city       as customer_city,
       c.state_code as customer_state_code,
       c.state_name as customer_state_name
from orders o
    join customers c on o.customer_id = c.customer_id
    and o.order_purchase_timestamp >= c.valid_from
    and o.order_purchase_timestamp <= c.valid_to
  );
[0m19:39:09.276236 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m19:39:09.281221 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.customer_orders_status"
[0m19:39:09.282195 [debug] [Thread-1 (]: On model.dbt_idx.customer_orders_status: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.customer_orders_status"} */
alter table "IDX-Stock"."IDX-Schema"."customer_orders_status__dbt_tmp" rename to "customer_orders_status"
[0m19:39:09.284727 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:39:09.286774 [debug] [Thread-1 (]: On model.dbt_idx.customer_orders_status: COMMIT
[0m19:39:09.287744 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.customer_orders_status"
[0m19:39:09.287744 [debug] [Thread-1 (]: On model.dbt_idx.customer_orders_status: COMMIT
[0m19:39:09.291789 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m19:39:09.294821 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.customer_orders_status"
[0m19:39:09.295797 [debug] [Thread-1 (]: On model.dbt_idx.customer_orders_status: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.customer_orders_status"} */
drop view if exists "IDX-Stock"."IDX-Schema"."customer_orders_status__dbt_backup" cascade
[0m19:39:09.297794 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m19:39:09.299830 [debug] [Thread-1 (]: Timing info for model.dbt_idx.customer_orders_status (execute): 19:39:09.232193 => 19:39:09.299830
[0m19:39:09.300796 [debug] [Thread-1 (]: On model.dbt_idx.customer_orders_status: Close
[0m19:39:09.301806 [info ] [Thread-1 (]: 10 of 11 OK created sql view model IDX-Schema.customer_orders_status ........... [[32mCREATE VIEW[0m in 0.08s]
[0m19:39:09.303800 [debug] [Thread-1 (]: Finished running node model.dbt_idx.customer_orders_status
[0m19:39:09.304820 [debug] [Thread-1 (]: Began running node model.dbt_idx.stock_update_status
[0m19:39:09.305796 [info ] [Thread-1 (]: 11 of 11 START sql view model IDX-Schema.stock_update_status ................... [RUN]
[0m19:39:09.306615 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_idx.customer_orders_status, now model.dbt_idx.stock_update_status)
[0m19:39:09.307679 [debug] [Thread-1 (]: Began compiling node model.dbt_idx.stock_update_status
[0m19:39:09.310662 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_idx.stock_update_status"
[0m19:39:09.317625 [debug] [Thread-1 (]: Timing info for model.dbt_idx.stock_update_status (compile): 19:39:09.308661 => 19:39:09.316651
[0m19:39:09.318642 [debug] [Thread-1 (]: Began executing node model.dbt_idx.stock_update_status
[0m19:39:09.324664 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_idx.stock_update_status"
[0m19:39:09.333658 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stock_update_status"
[0m19:39:09.334634 [debug] [Thread-1 (]: On model.dbt_idx.stock_update_status: BEGIN
[0m19:39:09.336628 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:39:09.362184 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m19:39:09.363194 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stock_update_status"
[0m19:39:09.364148 [debug] [Thread-1 (]: On model.dbt_idx.stock_update_status: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stock_update_status"} */

  create view "IDX-Stock"."IDX-Schema"."stock_update_status__dbt_tmp"
    
    
  as (
    with stock as (select *,
                        rank() over (
                        partition by ticker
                        order by date desc
                        ) as rank
               from "IDX-Stock"."IDX-Schema"."fact_stocks")
select a.id,
       a.ticker,
       a.name,
       a.date,
       a.open,
       a.high,
       a.low,
       a.close,
       a.volume,
       a.rank,
       a.logo
from stock a
order by a.date desc, a.ticker desc
  );
[0m19:39:09.370168 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m19:39:09.375804 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stock_update_status"
[0m19:39:09.376776 [debug] [Thread-1 (]: On model.dbt_idx.stock_update_status: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stock_update_status"} */
alter table "IDX-Stock"."IDX-Schema"."stock_update_status__dbt_tmp" rename to "stock_update_status"
[0m19:39:09.379807 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m19:39:09.381768 [debug] [Thread-1 (]: On model.dbt_idx.stock_update_status: COMMIT
[0m19:39:09.382850 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stock_update_status"
[0m19:39:09.383806 [debug] [Thread-1 (]: On model.dbt_idx.stock_update_status: COMMIT
[0m19:39:09.388060 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m19:39:09.392059 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stock_update_status"
[0m19:39:09.393060 [debug] [Thread-1 (]: On model.dbt_idx.stock_update_status: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stock_update_status"} */
drop view if exists "IDX-Stock"."IDX-Schema"."stock_update_status__dbt_backup" cascade
[0m19:39:09.395056 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m19:39:09.398090 [debug] [Thread-1 (]: Timing info for model.dbt_idx.stock_update_status (execute): 19:39:09.318642 => 19:39:09.398090
[0m19:39:09.399055 [debug] [Thread-1 (]: On model.dbt_idx.stock_update_status: Close
[0m19:39:09.401060 [info ] [Thread-1 (]: 11 of 11 OK created sql view model IDX-Schema.stock_update_status .............. [[32mCREATE VIEW[0m in 0.09s]
[0m19:39:09.403170 [debug] [Thread-1 (]: Finished running node model.dbt_idx.stock_update_status
[0m19:39:09.406173 [debug] [MainThread]: Using postgres connection "master"
[0m19:39:09.407218 [debug] [MainThread]: On master: BEGIN
[0m19:39:09.408180 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m19:39:09.432200 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m19:39:09.433169 [debug] [MainThread]: On master: COMMIT
[0m19:39:09.433169 [debug] [MainThread]: Using postgres connection "master"
[0m19:39:09.434710 [debug] [MainThread]: On master: COMMIT
[0m19:39:09.437718 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m19:39:09.438716 [debug] [MainThread]: On master: Close
[0m19:39:09.440721 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:39:09.442716 [debug] [MainThread]: Connection 'list_IDX-Stock' was properly closed.
[0m19:39:09.444222 [debug] [MainThread]: Connection 'list_IDX-Stock_IDX-Schema' was properly closed.
[0m19:39:09.445265 [debug] [MainThread]: Connection 'model.dbt_idx.stock_update_status' was properly closed.
[0m19:39:09.446266 [info ] [MainThread]: 
[0m19:39:09.448230 [info ] [MainThread]: Finished running 8 view models, 3 table models in 0 hours 0 minutes and 1.53 seconds (1.53s).
[0m19:39:09.451265 [debug] [MainThread]: Command end result
[0m19:39:09.481241 [info ] [MainThread]: 
[0m19:39:09.483242 [info ] [MainThread]: [32mCompleted successfully[0m
[0m19:39:09.484750 [info ] [MainThread]: 
[0m19:39:09.486773 [info ] [MainThread]: Done. PASS=11 WARN=0 ERROR=0 SKIP=0 TOTAL=11
[0m19:39:09.488777 [debug] [MainThread]: Command `dbt run` succeeded at 19:39:09.488777 after 2.13 seconds
[0m19:39:09.489809 [debug] [MainThread]: Flushing usage events


============================== 19:40:37.782729 | e6758d0e-162c-412f-9512-7fa981ec5d5d ==============================
[0m19:40:37.782729 [info ] [MainThread]: Running with dbt=1.6.1
[0m19:40:37.787764 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': 'D:\\00 Project\\00 My Project\\IdeaProjects\\Py-DBT-IDX', 'log_path': 'D:\\00 Project\\00 My Project\\IdeaProjects\\Py-DBT-IDX\\logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt docs generate', 'send_anonymous_usage_stats': 'False'}
[0m19:40:37.940225 [info ] [MainThread]: Registered adapter: postgres=1.6.1
[0m19:40:37.955231 [debug] [MainThread]: checksum: efe19d9f5b93d1a98cc804fbfcdb6b3aced98b974af664946fee1cde8837deb7, vars: {}, profile: , target: , version: 1.6.1
[0m19:40:38.132056 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m19:40:38.132056 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m19:40:38.154066 [info ] [MainThread]: Found 11 models, 1 snapshot, 18 tests, 5 sources, 0 exposures, 0 metrics, 349 macros, 0 groups, 0 semantic models
[0m19:40:38.158272 [info ] [MainThread]: 
[0m19:40:38.159238 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m19:40:38.162193 [debug] [ThreadPool]: Acquiring new postgres connection 'list_IDX-Stock_IDX-Schema'
[0m19:40:38.174194 [debug] [ThreadPool]: Using postgres connection "list_IDX-Stock_IDX-Schema"
[0m19:40:38.175199 [debug] [ThreadPool]: On list_IDX-Stock_IDX-Schema: BEGIN
[0m19:40:38.176211 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:40:38.209386 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m19:40:38.210375 [debug] [ThreadPool]: Using postgres connection "list_IDX-Stock_IDX-Schema"
[0m19:40:38.211378 [debug] [ThreadPool]: On list_IDX-Stock_IDX-Schema: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "connection_name": "list_IDX-Stock_IDX-Schema"} */
select
      'IDX-Stock' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'IDX-Schema'
    union all
    select
      'IDX-Stock' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'IDX-Schema'
    union all
    select
      'IDX-Stock' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'IDX-Schema'
  
[0m19:40:38.218413 [debug] [ThreadPool]: SQL status: SELECT 17 in 0.0 seconds
[0m19:40:38.221376 [debug] [ThreadPool]: On list_IDX-Stock_IDX-Schema: ROLLBACK
[0m19:40:38.223336 [debug] [ThreadPool]: On list_IDX-Stock_IDX-Schema: Close
[0m19:40:38.225360 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_IDX-Stock_IDX-Schema, now list_IDX-Stock_snapshots)
[0m19:40:38.232346 [debug] [ThreadPool]: Using postgres connection "list_IDX-Stock_snapshots"
[0m19:40:38.233346 [debug] [ThreadPool]: On list_IDX-Stock_snapshots: BEGIN
[0m19:40:38.234347 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:40:38.257204 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m19:40:38.258202 [debug] [ThreadPool]: Using postgres connection "list_IDX-Stock_snapshots"
[0m19:40:38.259202 [debug] [ThreadPool]: On list_IDX-Stock_snapshots: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "connection_name": "list_IDX-Stock_snapshots"} */
select
      'IDX-Stock' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'snapshots'
    union all
    select
      'IDX-Stock' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'snapshots'
    union all
    select
      'IDX-Stock' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'snapshots'
  
[0m19:40:38.263203 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.0 seconds
[0m19:40:38.265206 [debug] [ThreadPool]: On list_IDX-Stock_snapshots: ROLLBACK
[0m19:40:38.267208 [debug] [ThreadPool]: On list_IDX-Stock_snapshots: Close
[0m19:40:38.276211 [debug] [MainThread]: Using postgres connection "master"
[0m19:40:38.277211 [debug] [MainThread]: On master: BEGIN
[0m19:40:38.278215 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:40:38.300996 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m19:40:38.300996 [debug] [MainThread]: Using postgres connection "master"
[0m19:40:38.302020 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m19:40:38.311341 [debug] [MainThread]: SQL status: SELECT 9 in 0.0 seconds
[0m19:40:38.314352 [debug] [MainThread]: On master: ROLLBACK
[0m19:40:38.316684 [debug] [MainThread]: On master: Close
[0m19:40:38.317694 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m19:40:38.319696 [info ] [MainThread]: 
[0m19:40:38.324744 [debug] [Thread-1 (]: Began running node model.dbt_idx.stg_eltool__company
[0m19:40:38.326739 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.dbt_idx.stg_eltool__company'
[0m19:40:38.326739 [debug] [Thread-1 (]: Began compiling node model.dbt_idx.stg_eltool__company
[0m19:40:38.333738 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_idx.stg_eltool__company"
[0m19:40:38.341754 [debug] [Thread-1 (]: Timing info for model.dbt_idx.stg_eltool__company (compile): 19:40:38.327772 => 19:40:38.341754
[0m19:40:38.343765 [debug] [Thread-1 (]: Began executing node model.dbt_idx.stg_eltool__company
[0m19:40:38.344755 [debug] [Thread-1 (]: Timing info for model.dbt_idx.stg_eltool__company (execute): 19:40:38.344755 => 19:40:38.344755
[0m19:40:38.346754 [debug] [Thread-1 (]: Finished running node model.dbt_idx.stg_eltool__company
[0m19:40:38.347761 [debug] [Thread-1 (]: Began running node model.dbt_idx.stg_eltool__customers
[0m19:40:38.348762 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_idx.stg_eltool__company, now model.dbt_idx.stg_eltool__customers)
[0m19:40:38.349930 [debug] [Thread-1 (]: Began compiling node model.dbt_idx.stg_eltool__customers
[0m19:40:38.352798 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_idx.stg_eltool__customers"
[0m19:40:38.360289 [debug] [Thread-1 (]: Timing info for model.dbt_idx.stg_eltool__customers (compile): 19:40:38.349930 => 19:40:38.359328
[0m19:40:38.360289 [debug] [Thread-1 (]: Began executing node model.dbt_idx.stg_eltool__customers
[0m19:40:38.362290 [debug] [Thread-1 (]: Timing info for model.dbt_idx.stg_eltool__customers (execute): 19:40:38.361290 => 19:40:38.361290
[0m19:40:38.363289 [debug] [Thread-1 (]: Finished running node model.dbt_idx.stg_eltool__customers
[0m19:40:38.364292 [debug] [Thread-1 (]: Began running node model.dbt_idx.stg_eltool__orders
[0m19:40:38.365291 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_idx.stg_eltool__customers, now model.dbt_idx.stg_eltool__orders)
[0m19:40:38.366289 [debug] [Thread-1 (]: Began compiling node model.dbt_idx.stg_eltool__orders
[0m19:40:38.369319 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_idx.stg_eltool__orders"
[0m19:40:38.380814 [debug] [Thread-1 (]: Timing info for model.dbt_idx.stg_eltool__orders (compile): 19:40:38.366289 => 19:40:38.379845
[0m19:40:38.380814 [debug] [Thread-1 (]: Began executing node model.dbt_idx.stg_eltool__orders
[0m19:40:38.381814 [debug] [Thread-1 (]: Timing info for model.dbt_idx.stg_eltool__orders (execute): 19:40:38.381814 => 19:40:38.381814
[0m19:40:38.382819 [debug] [Thread-1 (]: Finished running node model.dbt_idx.stg_eltool__orders
[0m19:40:38.383815 [debug] [Thread-1 (]: Began running node model.dbt_idx.stg_eltool__state
[0m19:40:38.384830 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_idx.stg_eltool__orders, now model.dbt_idx.stg_eltool__state)
[0m19:40:38.385813 [debug] [Thread-1 (]: Began compiling node model.dbt_idx.stg_eltool__state
[0m19:40:38.388811 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_idx.stg_eltool__state"
[0m19:40:38.395387 [debug] [Thread-1 (]: Timing info for model.dbt_idx.stg_eltool__state (compile): 19:40:38.385813 => 19:40:38.395387
[0m19:40:38.396392 [debug] [Thread-1 (]: Began executing node model.dbt_idx.stg_eltool__state
[0m19:40:38.397392 [debug] [Thread-1 (]: Timing info for model.dbt_idx.stg_eltool__state (execute): 19:40:38.397392 => 19:40:38.397392
[0m19:40:38.399380 [debug] [Thread-1 (]: Finished running node model.dbt_idx.stg_eltool__state
[0m19:40:38.400378 [debug] [Thread-1 (]: Began running node model.dbt_idx.stg_eltool__stock
[0m19:40:38.402385 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_idx.stg_eltool__state, now model.dbt_idx.stg_eltool__stock)
[0m19:40:38.402385 [debug] [Thread-1 (]: Began compiling node model.dbt_idx.stg_eltool__stock
[0m19:40:38.405378 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_idx.stg_eltool__stock"
[0m19:40:38.413027 [debug] [Thread-1 (]: Timing info for model.dbt_idx.stg_eltool__stock (compile): 19:40:38.403379 => 19:40:38.412053
[0m19:40:38.414053 [debug] [Thread-1 (]: Began executing node model.dbt_idx.stg_eltool__stock
[0m19:40:38.415025 [debug] [Thread-1 (]: Timing info for model.dbt_idx.stg_eltool__stock (execute): 19:40:38.414053 => 19:40:38.414053
[0m19:40:38.416025 [debug] [Thread-1 (]: Finished running node model.dbt_idx.stg_eltool__stock
[0m19:40:38.417056 [debug] [Thread-1 (]: Began running node snapshot.dbt_idx.customers_snapshot
[0m19:40:38.419034 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_idx.stg_eltool__stock, now snapshot.dbt_idx.customers_snapshot)
[0m19:40:38.420039 [debug] [Thread-1 (]: Began compiling node snapshot.dbt_idx.customers_snapshot
[0m19:40:38.426030 [debug] [Thread-1 (]: Timing info for snapshot.dbt_idx.customers_snapshot (compile): 19:40:38.421033 => 19:40:38.426030
[0m19:40:38.427034 [debug] [Thread-1 (]: Began executing node snapshot.dbt_idx.customers_snapshot
[0m19:40:38.428065 [debug] [Thread-1 (]: Timing info for snapshot.dbt_idx.customers_snapshot (execute): 19:40:38.428065 => 19:40:38.428065
[0m19:40:38.430039 [debug] [Thread-1 (]: Finished running node snapshot.dbt_idx.customers_snapshot
[0m19:40:38.431042 [debug] [Thread-1 (]: Began running node test.dbt_idx.source_not_null_IDX-Schema_customers_customer_id.8525798d49
[0m19:40:38.432042 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly snapshot.dbt_idx.customers_snapshot, now test.dbt_idx.source_not_null_IDX-Schema_customers_customer_id.8525798d49)
[0m19:40:38.433029 [debug] [Thread-1 (]: Began compiling node test.dbt_idx.source_not_null_IDX-Schema_customers_customer_id.8525798d49
[0m19:40:38.452031 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_idx.source_not_null_IDX-Schema_customers_customer_id.8525798d49"
[0m19:40:38.457025 [debug] [Thread-1 (]: Timing info for test.dbt_idx.source_not_null_IDX-Schema_customers_customer_id.8525798d49 (compile): 19:40:38.434032 => 19:40:38.457025
[0m19:40:38.459049 [debug] [Thread-1 (]: Began executing node test.dbt_idx.source_not_null_IDX-Schema_customers_customer_id.8525798d49
[0m19:40:38.461034 [debug] [Thread-1 (]: Timing info for test.dbt_idx.source_not_null_IDX-Schema_customers_customer_id.8525798d49 (execute): 19:40:38.460032 => 19:40:38.460032
[0m19:40:38.463034 [debug] [Thread-1 (]: Finished running node test.dbt_idx.source_not_null_IDX-Schema_customers_customer_id.8525798d49
[0m19:40:38.465028 [debug] [Thread-1 (]: Began running node test.dbt_idx.source_not_null_IDX-Schema_ksql-company-stream_id.d088b78209
[0m19:40:38.466042 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_idx.source_not_null_IDX-Schema_customers_customer_id.8525798d49, now test.dbt_idx.source_not_null_IDX-Schema_ksql-company-stream_id.d088b78209)
[0m19:40:38.468027 [debug] [Thread-1 (]: Began compiling node test.dbt_idx.source_not_null_IDX-Schema_ksql-company-stream_id.d088b78209
[0m19:40:38.478063 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_idx.source_not_null_IDX-Schema_ksql-company-stream_id.d088b78209"
[0m19:40:38.482455 [debug] [Thread-1 (]: Timing info for test.dbt_idx.source_not_null_IDX-Schema_ksql-company-stream_id.d088b78209 (compile): 19:40:38.470028 => 19:40:38.482455
[0m19:40:38.483470 [debug] [Thread-1 (]: Began executing node test.dbt_idx.source_not_null_IDX-Schema_ksql-company-stream_id.d088b78209
[0m19:40:38.485466 [debug] [Thread-1 (]: Timing info for test.dbt_idx.source_not_null_IDX-Schema_ksql-company-stream_id.d088b78209 (execute): 19:40:38.484483 => 19:40:38.484483
[0m19:40:38.487455 [debug] [Thread-1 (]: Finished running node test.dbt_idx.source_not_null_IDX-Schema_ksql-company-stream_id.d088b78209
[0m19:40:38.488479 [debug] [Thread-1 (]: Began running node test.dbt_idx.source_not_null_IDX-Schema_ksql-stock-stream_id.b3b44ecba6
[0m19:40:38.490010 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_idx.source_not_null_IDX-Schema_ksql-company-stream_id.d088b78209, now test.dbt_idx.source_not_null_IDX-Schema_ksql-stock-stream_id.b3b44ecba6)
[0m19:40:38.490010 [debug] [Thread-1 (]: Began compiling node test.dbt_idx.source_not_null_IDX-Schema_ksql-stock-stream_id.b3b44ecba6
[0m19:40:38.497026 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_idx.source_not_null_IDX-Schema_ksql-stock-stream_id.b3b44ecba6"
[0m19:40:38.502541 [debug] [Thread-1 (]: Timing info for test.dbt_idx.source_not_null_IDX-Schema_ksql-stock-stream_id.b3b44ecba6 (compile): 19:40:38.491045 => 19:40:38.501023
[0m19:40:38.503553 [debug] [Thread-1 (]: Began executing node test.dbt_idx.source_not_null_IDX-Schema_ksql-stock-stream_id.b3b44ecba6
[0m19:40:38.505551 [debug] [Thread-1 (]: Timing info for test.dbt_idx.source_not_null_IDX-Schema_ksql-stock-stream_id.b3b44ecba6 (execute): 19:40:38.504552 => 19:40:38.504552
[0m19:40:38.506551 [debug] [Thread-1 (]: Finished running node test.dbt_idx.source_not_null_IDX-Schema_ksql-stock-stream_id.b3b44ecba6
[0m19:40:38.507564 [debug] [Thread-1 (]: Began running node test.dbt_idx.source_not_null_IDX-Schema_orders_order_id.f2383dcca5
[0m19:40:38.509549 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_idx.source_not_null_IDX-Schema_ksql-stock-stream_id.b3b44ecba6, now test.dbt_idx.source_not_null_IDX-Schema_orders_order_id.f2383dcca5)
[0m19:40:38.510556 [debug] [Thread-1 (]: Began compiling node test.dbt_idx.source_not_null_IDX-Schema_orders_order_id.f2383dcca5
[0m19:40:38.516561 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_idx.source_not_null_IDX-Schema_orders_order_id.f2383dcca5"
[0m19:40:38.523547 [debug] [Thread-1 (]: Timing info for test.dbt_idx.source_not_null_IDX-Schema_orders_order_id.f2383dcca5 (compile): 19:40:38.511551 => 19:40:38.522574
[0m19:40:38.524564 [debug] [Thread-1 (]: Began executing node test.dbt_idx.source_not_null_IDX-Schema_orders_order_id.f2383dcca5
[0m19:40:38.525566 [debug] [Thread-1 (]: Timing info for test.dbt_idx.source_not_null_IDX-Schema_orders_order_id.f2383dcca5 (execute): 19:40:38.525566 => 19:40:38.525566
[0m19:40:38.527555 [debug] [Thread-1 (]: Finished running node test.dbt_idx.source_not_null_IDX-Schema_orders_order_id.f2383dcca5
[0m19:40:38.528550 [debug] [Thread-1 (]: Began running node test.dbt_idx.source_relationships_IDX-Schema_orders_cust_id__customer_id__source_IDX_Schema_customers_.dc582657bc
[0m19:40:38.529551 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_idx.source_not_null_IDX-Schema_orders_order_id.f2383dcca5, now test.dbt_idx.source_relationships_IDX-Schema_orders_cust_id__customer_id__source_IDX_Schema_customers_.dc582657bc)
[0m19:40:38.530557 [debug] [Thread-1 (]: Began compiling node test.dbt_idx.source_relationships_IDX-Schema_orders_cust_id__customer_id__source_IDX_Schema_customers_.dc582657bc
[0m19:40:38.542550 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_idx.source_relationships_IDX-Schema_orders_cust_id__customer_id__source_IDX_Schema_customers_.dc582657bc"
[0m19:40:38.548558 [debug] [Thread-1 (]: Timing info for test.dbt_idx.source_relationships_IDX-Schema_orders_cust_id__customer_id__source_IDX_Schema_customers_.dc582657bc (compile): 19:40:38.531553 => 19:40:38.547551
[0m19:40:38.548558 [debug] [Thread-1 (]: Began executing node test.dbt_idx.source_relationships_IDX-Schema_orders_cust_id__customer_id__source_IDX_Schema_customers_.dc582657bc
[0m19:40:38.550568 [debug] [Thread-1 (]: Timing info for test.dbt_idx.source_relationships_IDX-Schema_orders_cust_id__customer_id__source_IDX_Schema_customers_.dc582657bc (execute): 19:40:38.549553 => 19:40:38.549553
[0m19:40:38.553558 [debug] [Thread-1 (]: Finished running node test.dbt_idx.source_relationships_IDX-Schema_orders_cust_id__customer_id__source_IDX_Schema_customers_.dc582657bc
[0m19:40:38.554552 [debug] [Thread-1 (]: Began running node test.dbt_idx.source_unique_IDX-Schema_ksql-company-stream_id.09232074f4
[0m19:40:38.556550 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_idx.source_relationships_IDX-Schema_orders_cust_id__customer_id__source_IDX_Schema_customers_.dc582657bc, now test.dbt_idx.source_unique_IDX-Schema_ksql-company-stream_id.09232074f4)
[0m19:40:38.557552 [debug] [Thread-1 (]: Began compiling node test.dbt_idx.source_unique_IDX-Schema_ksql-company-stream_id.09232074f4
[0m19:40:38.568584 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_idx.source_unique_IDX-Schema_ksql-company-stream_id.09232074f4"
[0m19:40:38.574465 [debug] [Thread-1 (]: Timing info for test.dbt_idx.source_unique_IDX-Schema_ksql-company-stream_id.09232074f4 (compile): 19:40:38.558550 => 19:40:38.574465
[0m19:40:38.575478 [debug] [Thread-1 (]: Began executing node test.dbt_idx.source_unique_IDX-Schema_ksql-company-stream_id.09232074f4
[0m19:40:38.577474 [debug] [Thread-1 (]: Timing info for test.dbt_idx.source_unique_IDX-Schema_ksql-company-stream_id.09232074f4 (execute): 19:40:38.577474 => 19:40:38.577474
[0m19:40:38.580471 [debug] [Thread-1 (]: Finished running node test.dbt_idx.source_unique_IDX-Schema_ksql-company-stream_id.09232074f4
[0m19:40:38.580471 [debug] [Thread-1 (]: Began running node test.dbt_idx.source_unique_IDX-Schema_ksql-stock-stream_id.2119c5c33b
[0m19:40:38.581470 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_idx.source_unique_IDX-Schema_ksql-company-stream_id.09232074f4, now test.dbt_idx.source_unique_IDX-Schema_ksql-stock-stream_id.2119c5c33b)
[0m19:40:38.582510 [debug] [Thread-1 (]: Began compiling node test.dbt_idx.source_unique_IDX-Schema_ksql-stock-stream_id.2119c5c33b
[0m19:40:38.590009 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_idx.source_unique_IDX-Schema_ksql-stock-stream_id.2119c5c33b"
[0m19:40:38.595019 [debug] [Thread-1 (]: Timing info for test.dbt_idx.source_unique_IDX-Schema_ksql-stock-stream_id.2119c5c33b (compile): 19:40:38.583502 => 19:40:38.594015
[0m19:40:38.596017 [debug] [Thread-1 (]: Began executing node test.dbt_idx.source_unique_IDX-Schema_ksql-stock-stream_id.2119c5c33b
[0m19:40:38.597016 [debug] [Thread-1 (]: Timing info for test.dbt_idx.source_unique_IDX-Schema_ksql-stock-stream_id.2119c5c33b (execute): 19:40:38.596017 => 19:40:38.596017
[0m19:40:38.598019 [debug] [Thread-1 (]: Finished running node test.dbt_idx.source_unique_IDX-Schema_ksql-stock-stream_id.2119c5c33b
[0m19:40:38.599042 [debug] [Thread-1 (]: Began running node test.dbt_idx.source_unique_IDX-Schema_orders_order_id.5a8ef486ee
[0m19:40:38.600016 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_idx.source_unique_IDX-Schema_ksql-stock-stream_id.2119c5c33b, now test.dbt_idx.source_unique_IDX-Schema_orders_order_id.5a8ef486ee)
[0m19:40:38.602019 [debug] [Thread-1 (]: Began compiling node test.dbt_idx.source_unique_IDX-Schema_orders_order_id.5a8ef486ee
[0m19:40:38.609016 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_idx.source_unique_IDX-Schema_orders_order_id.5a8ef486ee"
[0m19:40:38.613040 [debug] [Thread-1 (]: Timing info for test.dbt_idx.source_unique_IDX-Schema_orders_order_id.5a8ef486ee (compile): 19:40:38.604020 => 19:40:38.613040
[0m19:40:38.614041 [debug] [Thread-1 (]: Began executing node test.dbt_idx.source_unique_IDX-Schema_orders_order_id.5a8ef486ee
[0m19:40:38.615016 [debug] [Thread-1 (]: Timing info for test.dbt_idx.source_unique_IDX-Schema_orders_order_id.5a8ef486ee (execute): 19:40:38.615016 => 19:40:38.615016
[0m19:40:38.616028 [debug] [Thread-1 (]: Finished running node test.dbt_idx.source_unique_IDX-Schema_orders_order_id.5a8ef486ee
[0m19:40:38.618018 [debug] [Thread-1 (]: Began running node test.dbt_idx.not_null_stg_eltool__company_id.632831b79c
[0m19:40:38.620016 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_idx.source_unique_IDX-Schema_orders_order_id.5a8ef486ee, now test.dbt_idx.not_null_stg_eltool__company_id.632831b79c)
[0m19:40:38.621019 [debug] [Thread-1 (]: Began compiling node test.dbt_idx.not_null_stg_eltool__company_id.632831b79c
[0m19:40:38.626018 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_idx.not_null_stg_eltool__company_id.632831b79c"
[0m19:40:38.631016 [debug] [Thread-1 (]: Timing info for test.dbt_idx.not_null_stg_eltool__company_id.632831b79c (compile): 19:40:38.622017 => 19:40:38.630018
[0m19:40:38.632016 [debug] [Thread-1 (]: Began executing node test.dbt_idx.not_null_stg_eltool__company_id.632831b79c
[0m19:40:38.634039 [debug] [Thread-1 (]: Timing info for test.dbt_idx.not_null_stg_eltool__company_id.632831b79c (execute): 19:40:38.633015 => 19:40:38.633015
[0m19:40:38.637029 [debug] [Thread-1 (]: Finished running node test.dbt_idx.not_null_stg_eltool__company_id.632831b79c
[0m19:40:38.638018 [debug] [Thread-1 (]: Began running node model.dbt_idx.fact_orders
[0m19:40:38.640038 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_idx.not_null_stg_eltool__company_id.632831b79c, now model.dbt_idx.fact_orders)
[0m19:40:38.641016 [debug] [Thread-1 (]: Began compiling node model.dbt_idx.fact_orders
[0m19:40:38.645017 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_idx.fact_orders"
[0m19:40:38.653016 [debug] [Thread-1 (]: Timing info for model.dbt_idx.fact_orders (compile): 19:40:38.641016 => 19:40:38.653016
[0m19:40:38.654025 [debug] [Thread-1 (]: Began executing node model.dbt_idx.fact_orders
[0m19:40:38.655045 [debug] [Thread-1 (]: Timing info for model.dbt_idx.fact_orders (execute): 19:40:38.655045 => 19:40:38.655045
[0m19:40:38.657038 [debug] [Thread-1 (]: Finished running node model.dbt_idx.fact_orders
[0m19:40:38.658057 [debug] [Thread-1 (]: Began running node model.dbt_idx.fact_stocks
[0m19:40:38.660036 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_idx.fact_orders, now model.dbt_idx.fact_stocks)
[0m19:40:38.661017 [debug] [Thread-1 (]: Began compiling node model.dbt_idx.fact_stocks
[0m19:40:38.666051 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_idx.fact_stocks"
[0m19:40:38.674088 [debug] [Thread-1 (]: Timing info for model.dbt_idx.fact_stocks (compile): 19:40:38.662026 => 19:40:38.674088
[0m19:40:38.675117 [debug] [Thread-1 (]: Began executing node model.dbt_idx.fact_stocks
[0m19:40:38.676127 [debug] [Thread-1 (]: Timing info for model.dbt_idx.fact_stocks (execute): 19:40:38.676127 => 19:40:38.676127
[0m19:40:38.679125 [debug] [Thread-1 (]: Finished running node model.dbt_idx.fact_stocks
[0m19:40:38.680126 [debug] [Thread-1 (]: Began running node test.dbt_idx.not_null_stg_eltool__stock_id.68f6d1d89a
[0m19:40:38.682143 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_idx.fact_stocks, now test.dbt_idx.not_null_stg_eltool__stock_id.68f6d1d89a)
[0m19:40:38.683139 [debug] [Thread-1 (]: Began compiling node test.dbt_idx.not_null_stg_eltool__stock_id.68f6d1d89a
[0m19:40:38.691638 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_idx.not_null_stg_eltool__stock_id.68f6d1d89a"
[0m19:40:38.697659 [debug] [Thread-1 (]: Timing info for test.dbt_idx.not_null_stg_eltool__stock_id.68f6d1d89a (compile): 19:40:38.683139 => 19:40:38.697659
[0m19:40:38.698639 [debug] [Thread-1 (]: Began executing node test.dbt_idx.not_null_stg_eltool__stock_id.68f6d1d89a
[0m19:40:38.698639 [debug] [Thread-1 (]: Timing info for test.dbt_idx.not_null_stg_eltool__stock_id.68f6d1d89a (execute): 19:40:38.698639 => 19:40:38.698639
[0m19:40:38.700649 [debug] [Thread-1 (]: Finished running node test.dbt_idx.not_null_stg_eltool__stock_id.68f6d1d89a
[0m19:40:38.703643 [debug] [Thread-1 (]: Began running node model.dbt_idx.stg_eltool__customers_snapshots
[0m19:40:38.704689 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_idx.not_null_stg_eltool__stock_id.68f6d1d89a, now model.dbt_idx.stg_eltool__customers_snapshots)
[0m19:40:38.705694 [debug] [Thread-1 (]: Began compiling node model.dbt_idx.stg_eltool__customers_snapshots
[0m19:40:38.711640 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_idx.stg_eltool__customers_snapshots"
[0m19:40:38.721649 [debug] [Thread-1 (]: Timing info for model.dbt_idx.stg_eltool__customers_snapshots (compile): 19:40:38.706647 => 19:40:38.721649
[0m19:40:38.723644 [debug] [Thread-1 (]: Began executing node model.dbt_idx.stg_eltool__customers_snapshots
[0m19:40:38.725641 [debug] [Thread-1 (]: Timing info for model.dbt_idx.stg_eltool__customers_snapshots (execute): 19:40:38.724651 => 19:40:38.724651
[0m19:40:38.728655 [debug] [Thread-1 (]: Finished running node model.dbt_idx.stg_eltool__customers_snapshots
[0m19:40:38.730645 [debug] [Thread-1 (]: Began running node model.dbt_idx.stock_update_status
[0m19:40:38.731641 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_idx.stg_eltool__customers_snapshots, now model.dbt_idx.stock_update_status)
[0m19:40:38.732662 [debug] [Thread-1 (]: Began compiling node model.dbt_idx.stock_update_status
[0m19:40:38.739643 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_idx.stock_update_status"
[0m19:40:38.747641 [debug] [Thread-1 (]: Timing info for model.dbt_idx.stock_update_status (compile): 19:40:38.734646 => 19:40:38.747641
[0m19:40:38.748649 [debug] [Thread-1 (]: Began executing node model.dbt_idx.stock_update_status
[0m19:40:38.750646 [debug] [Thread-1 (]: Timing info for model.dbt_idx.stock_update_status (execute): 19:40:38.749709 => 19:40:38.749709
[0m19:40:38.753640 [debug] [Thread-1 (]: Finished running node model.dbt_idx.stock_update_status
[0m19:40:38.754644 [debug] [Thread-1 (]: Began running node test.dbt_idx.not_null_fact_stocks_id.e7b7e788fa
[0m19:40:38.756640 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_idx.stock_update_status, now test.dbt_idx.not_null_fact_stocks_id.e7b7e788fa)
[0m19:40:38.757648 [debug] [Thread-1 (]: Began compiling node test.dbt_idx.not_null_fact_stocks_id.e7b7e788fa
[0m19:40:38.768667 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_idx.not_null_fact_stocks_id.e7b7e788fa"
[0m19:40:38.774641 [debug] [Thread-1 (]: Timing info for test.dbt_idx.not_null_fact_stocks_id.e7b7e788fa (compile): 19:40:38.758645 => 19:40:38.773644
[0m19:40:38.775652 [debug] [Thread-1 (]: Began executing node test.dbt_idx.not_null_fact_stocks_id.e7b7e788fa
[0m19:40:38.777670 [debug] [Thread-1 (]: Timing info for test.dbt_idx.not_null_fact_stocks_id.e7b7e788fa (execute): 19:40:38.776652 => 19:40:38.776652
[0m19:40:38.778648 [debug] [Thread-1 (]: Finished running node test.dbt_idx.not_null_fact_stocks_id.e7b7e788fa
[0m19:40:38.780661 [debug] [Thread-1 (]: Began running node model.dbt_idx.dim_customers
[0m19:40:38.781648 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_idx.not_null_fact_stocks_id.e7b7e788fa, now model.dbt_idx.dim_customers)
[0m19:40:38.782647 [debug] [Thread-1 (]: Began compiling node model.dbt_idx.dim_customers
[0m19:40:38.786684 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_idx.dim_customers"
[0m19:40:38.795195 [debug] [Thread-1 (]: Timing info for model.dbt_idx.dim_customers (compile): 19:40:38.782647 => 19:40:38.794210
[0m19:40:38.796202 [debug] [Thread-1 (]: Began executing node model.dbt_idx.dim_customers
[0m19:40:38.797191 [debug] [Thread-1 (]: Timing info for model.dbt_idx.dim_customers (execute): 19:40:38.797191 => 19:40:38.797191
[0m19:40:38.799200 [debug] [Thread-1 (]: Finished running node model.dbt_idx.dim_customers
[0m19:40:38.800203 [debug] [Thread-1 (]: Began running node test.dbt_idx.not_null_stg_eltool__customers_snapshots_customer_id.ea4fc4ca86
[0m19:40:38.801208 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_idx.dim_customers, now test.dbt_idx.not_null_stg_eltool__customers_snapshots_customer_id.ea4fc4ca86)
[0m19:40:38.802221 [debug] [Thread-1 (]: Began compiling node test.dbt_idx.not_null_stg_eltool__customers_snapshots_customer_id.ea4fc4ca86
[0m19:40:38.808216 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_idx.not_null_stg_eltool__customers_snapshots_customer_id.ea4fc4ca86"
[0m19:40:38.814215 [debug] [Thread-1 (]: Timing info for test.dbt_idx.not_null_stg_eltool__customers_snapshots_customer_id.ea4fc4ca86 (compile): 19:40:38.803197 => 19:40:38.814215
[0m19:40:38.815193 [debug] [Thread-1 (]: Began executing node test.dbt_idx.not_null_stg_eltool__customers_snapshots_customer_id.ea4fc4ca86
[0m19:40:38.816209 [debug] [Thread-1 (]: Timing info for test.dbt_idx.not_null_stg_eltool__customers_snapshots_customer_id.ea4fc4ca86 (execute): 19:40:38.816209 => 19:40:38.816209
[0m19:40:38.818190 [debug] [Thread-1 (]: Finished running node test.dbt_idx.not_null_stg_eltool__customers_snapshots_customer_id.ea4fc4ca86
[0m19:40:38.818190 [debug] [Thread-1 (]: Began running node test.dbt_idx.not_null_stock_update_status_id.633bc8afe3
[0m19:40:38.819216 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_idx.not_null_stg_eltool__customers_snapshots_customer_id.ea4fc4ca86, now test.dbt_idx.not_null_stock_update_status_id.633bc8afe3)
[0m19:40:38.820193 [debug] [Thread-1 (]: Began compiling node test.dbt_idx.not_null_stock_update_status_id.633bc8afe3
[0m19:40:38.826215 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_idx.not_null_stock_update_status_id.633bc8afe3"
[0m19:40:38.893445 [debug] [Thread-1 (]: Timing info for test.dbt_idx.not_null_stock_update_status_id.633bc8afe3 (compile): 19:40:38.821198 => 19:40:38.893445
[0m19:40:38.894430 [debug] [Thread-1 (]: Began executing node test.dbt_idx.not_null_stock_update_status_id.633bc8afe3
[0m19:40:38.895429 [debug] [Thread-1 (]: Timing info for test.dbt_idx.not_null_stock_update_status_id.633bc8afe3 (execute): 19:40:38.895429 => 19:40:38.895429
[0m19:40:38.896460 [debug] [Thread-1 (]: Finished running node test.dbt_idx.not_null_stock_update_status_id.633bc8afe3
[0m19:40:38.897447 [debug] [Thread-1 (]: Began running node model.dbt_idx.customer_orders_status
[0m19:40:38.898464 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_idx.not_null_stock_update_status_id.633bc8afe3, now model.dbt_idx.customer_orders_status)
[0m19:40:38.899427 [debug] [Thread-1 (]: Began compiling node model.dbt_idx.customer_orders_status
[0m19:40:38.902449 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_idx.customer_orders_status"
[0m19:40:38.910429 [debug] [Thread-1 (]: Timing info for model.dbt_idx.customer_orders_status (compile): 19:40:38.900463 => 19:40:38.909461
[0m19:40:38.910429 [debug] [Thread-1 (]: Began executing node model.dbt_idx.customer_orders_status
[0m19:40:38.911429 [debug] [Thread-1 (]: Timing info for model.dbt_idx.customer_orders_status (execute): 19:40:38.911429 => 19:40:38.911429
[0m19:40:38.913430 [debug] [Thread-1 (]: Finished running node model.dbt_idx.customer_orders_status
[0m19:40:38.914430 [debug] [Thread-1 (]: Began running node test.dbt_idx.assert_customer_dimension_has_no_row_loss.sql
[0m19:40:38.915431 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_idx.customer_orders_status, now test.dbt_idx.assert_customer_dimension_has_no_row_loss.sql)
[0m19:40:38.915431 [debug] [Thread-1 (]: Began compiling node test.dbt_idx.assert_customer_dimension_has_no_row_loss.sql
[0m19:40:38.919429 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_idx.assert_customer_dimension_has_no_row_loss.sql"
[0m19:40:38.925959 [debug] [Thread-1 (]: Timing info for test.dbt_idx.assert_customer_dimension_has_no_row_loss.sql (compile): 19:40:38.916430 => 19:40:38.925959
[0m19:40:38.926963 [debug] [Thread-1 (]: Began executing node test.dbt_idx.assert_customer_dimension_has_no_row_loss.sql
[0m19:40:38.928973 [debug] [Thread-1 (]: Timing info for test.dbt_idx.assert_customer_dimension_has_no_row_loss.sql (execute): 19:40:38.927962 => 19:40:38.927962
[0m19:40:38.929959 [debug] [Thread-1 (]: Finished running node test.dbt_idx.assert_customer_dimension_has_no_row_loss.sql
[0m19:40:38.930998 [debug] [Thread-1 (]: Began running node test.dbt_idx.not_null_dim_customers_customer_id.dd91cd1c8d
[0m19:40:38.931960 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_idx.assert_customer_dimension_has_no_row_loss.sql, now test.dbt_idx.not_null_dim_customers_customer_id.dd91cd1c8d)
[0m19:40:38.932960 [debug] [Thread-1 (]: Began compiling node test.dbt_idx.not_null_dim_customers_customer_id.dd91cd1c8d
[0m19:40:38.937960 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_idx.not_null_dim_customers_customer_id.dd91cd1c8d"
[0m19:40:38.942961 [debug] [Thread-1 (]: Timing info for test.dbt_idx.not_null_dim_customers_customer_id.dd91cd1c8d (compile): 19:40:38.933975 => 19:40:38.942961
[0m19:40:38.943958 [debug] [Thread-1 (]: Began executing node test.dbt_idx.not_null_dim_customers_customer_id.dd91cd1c8d
[0m19:40:38.944960 [debug] [Thread-1 (]: Timing info for test.dbt_idx.not_null_dim_customers_customer_id.dd91cd1c8d (execute): 19:40:38.944960 => 19:40:38.944960
[0m19:40:38.946054 [debug] [Thread-1 (]: Finished running node test.dbt_idx.not_null_dim_customers_customer_id.dd91cd1c8d
[0m19:40:38.947069 [debug] [Thread-1 (]: Began running node test.dbt_idx.accepted_values_customer_orders_status_order_status__delivered__invoiced__shipped__processing__canceled__unavailable.ea8c296d27
[0m19:40:38.948067 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_idx.not_null_dim_customers_customer_id.dd91cd1c8d, now test.dbt_idx.accepted_values_customer_orders_status_order_status__delivered__invoiced__shipped__processing__canceled__unavailable.ea8c296d27)
[0m19:40:38.949054 [debug] [Thread-1 (]: Began compiling node test.dbt_idx.accepted_values_customer_orders_status_order_status__delivered__invoiced__shipped__processing__canceled__unavailable.ea8c296d27
[0m19:40:38.960053 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_idx.accepted_values_customer_orders_status_order_status__delivered__invoiced__shipped__processing__canceled__unavailable.ea8c296d27"
[0m19:40:38.967501 [debug] [Thread-1 (]: Timing info for test.dbt_idx.accepted_values_customer_orders_status_order_status__delivered__invoiced__shipped__processing__canceled__unavailable.ea8c296d27 (compile): 19:40:38.949054 => 19:40:38.966539
[0m19:40:38.968501 [debug] [Thread-1 (]: Began executing node test.dbt_idx.accepted_values_customer_orders_status_order_status__delivered__invoiced__shipped__processing__canceled__unavailable.ea8c296d27
[0m19:40:38.968501 [debug] [Thread-1 (]: Timing info for test.dbt_idx.accepted_values_customer_orders_status_order_status__delivered__invoiced__shipped__processing__canceled__unavailable.ea8c296d27 (execute): 19:40:38.968501 => 19:40:38.968501
[0m19:40:38.969536 [debug] [Thread-1 (]: Finished running node test.dbt_idx.accepted_values_customer_orders_status_order_status__delivered__invoiced__shipped__processing__canceled__unavailable.ea8c296d27
[0m19:40:38.970537 [debug] [Thread-1 (]: Began running node test.dbt_idx.not_null_customer_orders_status_customer_id.3915c814eb
[0m19:40:38.971512 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_idx.accepted_values_customer_orders_status_order_status__delivered__invoiced__shipped__processing__canceled__unavailable.ea8c296d27, now test.dbt_idx.not_null_customer_orders_status_customer_id.3915c814eb)
[0m19:40:38.972530 [debug] [Thread-1 (]: Began compiling node test.dbt_idx.not_null_customer_orders_status_customer_id.3915c814eb
[0m19:40:38.977569 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_idx.not_null_customer_orders_status_customer_id.3915c814eb"
[0m19:40:38.983580 [debug] [Thread-1 (]: Timing info for test.dbt_idx.not_null_customer_orders_status_customer_id.3915c814eb (compile): 19:40:38.972530 => 19:40:38.983580
[0m19:40:38.984534 [debug] [Thread-1 (]: Began executing node test.dbt_idx.not_null_customer_orders_status_customer_id.3915c814eb
[0m19:40:38.985532 [debug] [Thread-1 (]: Timing info for test.dbt_idx.not_null_customer_orders_status_customer_id.3915c814eb (execute): 19:40:38.985532 => 19:40:38.985532
[0m19:40:38.986532 [debug] [Thread-1 (]: Finished running node test.dbt_idx.not_null_customer_orders_status_customer_id.3915c814eb
[0m19:40:38.987531 [debug] [Thread-1 (]: Began running node test.dbt_idx.unique_customer_orders_status_order_id.b7a45e83ee
[0m19:40:38.988535 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_idx.not_null_customer_orders_status_customer_id.3915c814eb, now test.dbt_idx.unique_customer_orders_status_order_id.b7a45e83ee)
[0m19:40:38.989532 [debug] [Thread-1 (]: Began compiling node test.dbt_idx.unique_customer_orders_status_order_id.b7a45e83ee
[0m19:40:38.993044 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_idx.unique_customer_orders_status_order_id.b7a45e83ee"
[0m19:40:39.033388 [debug] [Thread-1 (]: Timing info for test.dbt_idx.unique_customer_orders_status_order_id.b7a45e83ee (compile): 19:40:38.989532 => 19:40:39.032359
[0m19:40:39.033388 [debug] [Thread-1 (]: Began executing node test.dbt_idx.unique_customer_orders_status_order_id.b7a45e83ee
[0m19:40:39.034385 [debug] [Thread-1 (]: Timing info for test.dbt_idx.unique_customer_orders_status_order_id.b7a45e83ee (execute): 19:40:39.034385 => 19:40:39.034385
[0m19:40:39.035361 [debug] [Thread-1 (]: Finished running node test.dbt_idx.unique_customer_orders_status_order_id.b7a45e83ee
[0m19:40:39.037367 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:40:39.038389 [debug] [MainThread]: Connection 'list_IDX-Stock_snapshots' was properly closed.
[0m19:40:39.039369 [debug] [MainThread]: Connection 'test.dbt_idx.unique_customer_orders_status_order_id.b7a45e83ee' was properly closed.
[0m19:40:39.044386 [debug] [MainThread]: Command end result
[0m19:40:39.500399 [debug] [MainThread]: Acquiring new postgres connection 'generate_catalog'
[0m19:40:39.500906 [info ] [MainThread]: Building catalog
[0m19:40:39.506917 [debug] [ThreadPool]: Acquiring new postgres connection 'IDX-Stock.information_schema'
[0m19:40:39.516456 [debug] [ThreadPool]: Using postgres connection "IDX-Stock.information_schema"
[0m19:40:39.518441 [debug] [ThreadPool]: On IDX-Stock.information_schema: BEGIN
[0m19:40:39.519446 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:40:39.550155 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m19:40:39.551142 [debug] [ThreadPool]: Using postgres connection "IDX-Stock.information_schema"
[0m19:40:39.553030 [debug] [ThreadPool]: On IDX-Stock.information_schema: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "connection_name": "IDX-Stock.information_schema"} */

    
    

    select
        'IDX-Stock' as table_database,
        sch.nspname as table_schema,
        tbl.relname as table_name,
        case tbl.relkind
            when 'v' then 'VIEW'
            else 'BASE TABLE'
        end as table_type,
        tbl_desc.description as table_comment,
        col.attname as column_name,
        col.attnum as column_index,
        pg_catalog.format_type(col.atttypid, col.atttypmod) as column_type,
        col_desc.description as column_comment,
        pg_get_userbyid(tbl.relowner) as table_owner

    from pg_catalog.pg_namespace sch
    join pg_catalog.pg_class tbl on tbl.relnamespace = sch.oid
    join pg_catalog.pg_attribute col on col.attrelid = tbl.oid
    left outer join pg_catalog.pg_description tbl_desc on (tbl_desc.objoid = tbl.oid and tbl_desc.objsubid = 0)
    left outer join pg_catalog.pg_description col_desc on (col_desc.objoid = tbl.oid and col_desc.objsubid = col.attnum)

    where (upper(sch.nspname) = upper('snapshots') or upper(sch.nspname) = upper('idx-schema'))
      and not pg_is_other_temp_schema(sch.oid) -- not a temporary schema belonging to another session
      and tbl.relpersistence in ('p', 'u') -- [p]ermanent table or [u]nlogged table. Exclude [t]emporary tables
      and tbl.relkind in ('r', 'v', 'f', 'p') -- o[r]dinary table, [v]iew, [f]oreign table, [p]artitioned table. Other values are [i]ndex, [S]equence, [c]omposite type, [t]OAST table, [m]aterialized view
      and col.attnum > 0 -- negative numbers are used for system columns such as oid
      and not col.attisdropped -- column as not been dropped

    order by
        sch.nspname,
        tbl.relname,
        col.attnum
[0m19:40:39.564595 [debug] [ThreadPool]: SQL status: SELECT 130 in 0.0 seconds
[0m19:40:39.581640 [debug] [ThreadPool]: On IDX-Stock.information_schema: ROLLBACK
[0m19:40:39.585157 [debug] [ThreadPool]: On IDX-Stock.information_schema: Close
[0m19:40:39.632592 [info ] [MainThread]: Catalog written to D:\00 Project\00 My Project\IdeaProjects\Py-DBT-IDX\target\catalog.json
[0m19:40:39.634613 [debug] [MainThread]: Command `dbt docs generate` succeeded at 19:40:39.634613 after 1.89 seconds
[0m19:40:39.635598 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
[0m19:40:39.637221 [debug] [MainThread]: Connection 'IDX-Stock.information_schema' was properly closed.
[0m19:40:39.638610 [debug] [MainThread]: Flushing usage events


============================== 19:40:47.606214 | 1252a438-fa74-4d23-a9ca-053da4bd3d6d ==============================
[0m19:40:47.606214 [info ] [MainThread]: Running with dbt=1.6.1
[0m19:40:47.612269 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'D:\\00 Project\\00 My Project\\IdeaProjects\\Py-DBT-IDX\\logs', 'profiles_dir': 'D:\\00 Project\\00 My Project\\IdeaProjects\\Py-DBT-IDX', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt docs serve', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'False'}
[0m19:43:41.506374 [error] [MainThread]: Encountered an error:

[0m19:43:41.515565 [error] [MainThread]: Traceback (most recent call last):
  File "C:\Users\dmitr\Py-DBT-IDX\Lib\site-packages\dbt\cli\requires.py", line 87, in wrapper
    result, success = func(*args, **kwargs)
                      ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\dmitr\Py-DBT-IDX\Lib\site-packages\dbt\cli\requires.py", line 72, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\dmitr\Py-DBT-IDX\Lib\site-packages\dbt\cli\requires.py", line 143, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\dmitr\Py-DBT-IDX\Lib\site-packages\dbt\cli\requires.py", line 172, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\dmitr\Py-DBT-IDX\Lib\site-packages\dbt\cli\requires.py", line 219, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\dmitr\Py-DBT-IDX\Lib\site-packages\dbt\cli\main.py", line 307, in docs_serve
    results = task.run()
              ^^^^^^^^^^
  File "C:\Users\dmitr\Py-DBT-IDX\Lib\site-packages\dbt\task\serve.py", line 28, in run
    httpd.serve_forever()
  File "C:\Python311\Lib\socketserver.py", line 233, in serve_forever
    ready = selector.select(poll_interval)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Python311\Lib\selectors.py", line 323, in select
    r, w, _ = self._select(self._readers, self._writers, [], timeout)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Python311\Lib\selectors.py", line 314, in _select
    r, w, x = select.select(r, w, w, timeout)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
KeyboardInterrupt

[0m19:43:41.517564 [debug] [MainThread]: Command `dbt docs serve` failed at 19:43:41.517564 after 173.96 seconds
[0m19:43:41.519587 [debug] [MainThread]: Flushing usage events


============================== 19:43:49.135168 | efd1bb90-61e9-441c-8c4a-77614610c115 ==============================
[0m19:43:49.135168 [info ] [MainThread]: Running with dbt=1.6.1
[0m19:43:49.141693 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': 'D:\\00 Project\\00 My Project\\IdeaProjects\\Py-DBT-IDX', 'log_path': 'D:\\00 Project\\00 My Project\\IdeaProjects\\Py-DBT-IDX\\logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt test', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'False'}
[0m19:43:49.316113 [info ] [MainThread]: Registered adapter: postgres=1.6.1
[0m19:43:49.334210 [debug] [MainThread]: checksum: efe19d9f5b93d1a98cc804fbfcdb6b3aced98b974af664946fee1cde8837deb7, vars: {}, profile: , target: , version: 1.6.1
[0m19:43:49.526159 [debug] [MainThread]: Partial parsing enabled: 1 files deleted, 2 files added, 0 files changed.
[0m19:43:49.527161 [debug] [MainThread]: Partial parsing: added file: dbt_idx://tests\assert_customer_fact_has_no_row_loss.sql.sql
[0m19:43:49.528162 [debug] [MainThread]: Partial parsing: added file: dbt_idx://tests\assert_stock_dimension_has_no_row_loss.sql.sql
[0m19:43:49.529159 [debug] [MainThread]: Partial parsing: deleted file: dbt_idx://tests\assert_customer_dimension_has_no_row_loss.sql.sql
[0m19:43:49.613366 [info ] [MainThread]: Found 11 models, 1 snapshot, 19 tests, 5 sources, 0 exposures, 0 metrics, 349 macros, 0 groups, 0 semantic models
[0m19:43:49.617403 [info ] [MainThread]: 
[0m19:43:49.618406 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m19:43:49.621401 [debug] [ThreadPool]: Acquiring new postgres connection 'list_IDX-Stock_IDX-Schema'
[0m19:43:49.631402 [debug] [ThreadPool]: Using postgres connection "list_IDX-Stock_IDX-Schema"
[0m19:43:49.632401 [debug] [ThreadPool]: On list_IDX-Stock_IDX-Schema: BEGIN
[0m19:43:49.633403 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:43:49.664366 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m19:43:49.664366 [debug] [ThreadPool]: Using postgres connection "list_IDX-Stock_IDX-Schema"
[0m19:43:49.665402 [debug] [ThreadPool]: On list_IDX-Stock_IDX-Schema: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "connection_name": "list_IDX-Stock_IDX-Schema"} */
select
      'IDX-Stock' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'IDX-Schema'
    union all
    select
      'IDX-Stock' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'IDX-Schema'
    union all
    select
      'IDX-Stock' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'IDX-Schema'
  
[0m19:43:49.670482 [debug] [ThreadPool]: SQL status: SELECT 17 in 0.0 seconds
[0m19:43:49.672997 [debug] [ThreadPool]: On list_IDX-Stock_IDX-Schema: ROLLBACK
[0m19:43:49.675355 [debug] [ThreadPool]: On list_IDX-Stock_IDX-Schema: Close
[0m19:43:49.677392 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_IDX-Stock_IDX-Schema, now list_IDX-Stock_snapshots)
[0m19:43:49.684403 [debug] [ThreadPool]: Using postgres connection "list_IDX-Stock_snapshots"
[0m19:43:49.684403 [debug] [ThreadPool]: On list_IDX-Stock_snapshots: BEGIN
[0m19:43:49.685403 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:43:49.706604 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m19:43:49.707630 [debug] [ThreadPool]: Using postgres connection "list_IDX-Stock_snapshots"
[0m19:43:49.708615 [debug] [ThreadPool]: On list_IDX-Stock_snapshots: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "connection_name": "list_IDX-Stock_snapshots"} */
select
      'IDX-Stock' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'snapshots'
    union all
    select
      'IDX-Stock' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'snapshots'
    union all
    select
      'IDX-Stock' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'snapshots'
  
[0m19:43:49.712855 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.0 seconds
[0m19:43:49.713869 [debug] [ThreadPool]: On list_IDX-Stock_snapshots: ROLLBACK
[0m19:43:49.715868 [debug] [ThreadPool]: On list_IDX-Stock_snapshots: Close
[0m19:43:49.726490 [debug] [MainThread]: Using postgres connection "master"
[0m19:43:49.727490 [debug] [MainThread]: On master: BEGIN
[0m19:43:49.728552 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:43:49.751159 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m19:43:49.751159 [debug] [MainThread]: Using postgres connection "master"
[0m19:43:49.752171 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m19:43:49.760058 [debug] [MainThread]: SQL status: SELECT 9 in 0.0 seconds
[0m19:43:49.763851 [debug] [MainThread]: On master: ROLLBACK
[0m19:43:49.766966 [debug] [MainThread]: Using postgres connection "master"
[0m19:43:49.767470 [debug] [MainThread]: On master: BEGIN
[0m19:43:49.770976 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m19:43:49.772181 [debug] [MainThread]: On master: COMMIT
[0m19:43:49.772855 [debug] [MainThread]: Using postgres connection "master"
[0m19:43:49.773374 [debug] [MainThread]: On master: COMMIT
[0m19:43:49.775110 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m19:43:49.775653 [debug] [MainThread]: On master: Close
[0m19:43:49.776720 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m19:43:49.778741 [info ] [MainThread]: 
[0m19:43:49.784751 [debug] [Thread-1 (]: Began running node test.dbt_idx.accepted_values_customer_orders_status_order_status__delivered__invoiced__shipped__processing__canceled__unavailable.ea8c296d27
[0m19:43:49.784751 [info ] [Thread-1 (]: 1 of 19 START test accepted_values_customer_orders_status_order_status__delivered__invoiced__shipped__processing__canceled__unavailable  [RUN]
[0m19:43:49.786755 [debug] [Thread-1 (]: Acquiring new postgres connection 'test.dbt_idx.accepted_values_customer_orders_status_order_status__delivered__invoiced__shipped__processing__canceled__unavailable.ea8c296d27'
[0m19:43:49.787753 [debug] [Thread-1 (]: Began compiling node test.dbt_idx.accepted_values_customer_orders_status_order_status__delivered__invoiced__shipped__processing__canceled__unavailable.ea8c296d27
[0m19:43:49.807298 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_idx.accepted_values_customer_orders_status_order_status__delivered__invoiced__shipped__processing__canceled__unavailable.ea8c296d27"
[0m19:43:49.816192 [debug] [Thread-1 (]: Timing info for test.dbt_idx.accepted_values_customer_orders_status_order_status__delivered__invoiced__shipped__processing__canceled__unavailable.ea8c296d27 (compile): 19:43:49.787753 => 19:43:49.815213
[0m19:43:49.817154 [debug] [Thread-1 (]: Began executing node test.dbt_idx.accepted_values_customer_orders_status_order_status__delivered__invoiced__shipped__processing__canceled__unavailable.ea8c296d27
[0m19:43:49.833154 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_idx.accepted_values_customer_orders_status_order_status__delivered__invoiced__shipped__processing__canceled__unavailable.ea8c296d27"
[0m19:43:49.839948 [debug] [Thread-1 (]: Using postgres connection "test.dbt_idx.accepted_values_customer_orders_status_order_status__delivered__invoiced__shipped__processing__canceled__unavailable.ea8c296d27"
[0m19:43:49.840974 [debug] [Thread-1 (]: On test.dbt_idx.accepted_values_customer_orders_status_order_status__delivered__invoiced__shipped__processing__canceled__unavailable.ea8c296d27: BEGIN
[0m19:43:49.841958 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m19:43:49.862436 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m19:43:49.863470 [debug] [Thread-1 (]: Using postgres connection "test.dbt_idx.accepted_values_customer_orders_status_order_status__delivered__invoiced__shipped__processing__canceled__unavailable.ea8c296d27"
[0m19:43:49.864482 [debug] [Thread-1 (]: On test.dbt_idx.accepted_values_customer_orders_status_order_status__delivered__invoiced__shipped__processing__canceled__unavailable.ea8c296d27: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "test.dbt_idx.accepted_values_customer_orders_status_order_status__delivered__invoiced__shipped__processing__canceled__unavailable.ea8c296d27"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        order_status as value_field,
        count(*) as n_records

    from "IDX-Stock"."IDX-Schema"."customer_orders_status"
    group by order_status

)

select *
from all_values
where value_field not in (
    'delivered','invoiced','shipped','processing','canceled','unavailable'
)



      
    ) dbt_internal_test
[0m19:43:49.869917 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m19:43:49.871928 [debug] [Thread-1 (]: Timing info for test.dbt_idx.accepted_values_customer_orders_status_order_status__delivered__invoiced__shipped__processing__canceled__unavailable.ea8c296d27 (execute): 19:43:49.817154 => 19:43:49.871928
[0m19:43:49.872927 [debug] [Thread-1 (]: On test.dbt_idx.accepted_values_customer_orders_status_order_status__delivered__invoiced__shipped__processing__canceled__unavailable.ea8c296d27: ROLLBACK
[0m19:43:49.875928 [debug] [Thread-1 (]: On test.dbt_idx.accepted_values_customer_orders_status_order_status__delivered__invoiced__shipped__processing__canceled__unavailable.ea8c296d27: Close
[0m19:43:49.877937 [info ] [Thread-1 (]: 1 of 19 PASS accepted_values_customer_orders_status_order_status__delivered__invoiced__shipped__processing__canceled__unavailable  [[32mPASS[0m in 0.09s]
[0m19:43:49.879941 [debug] [Thread-1 (]: Finished running node test.dbt_idx.accepted_values_customer_orders_status_order_status__delivered__invoiced__shipped__processing__canceled__unavailable.ea8c296d27
[0m19:43:49.880944 [debug] [Thread-1 (]: Began running node test.dbt_idx.assert_customer_fact_has_no_row_loss.sql
[0m19:43:49.881951 [info ] [Thread-1 (]: 2 of 19 START test assert_customer_fact_has_no_row_loss.sql .................... [RUN]
[0m19:43:49.883953 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_idx.accepted_values_customer_orders_status_order_status__delivered__invoiced__shipped__processing__canceled__unavailable.ea8c296d27, now test.dbt_idx.assert_customer_fact_has_no_row_loss.sql)
[0m19:43:49.884950 [debug] [Thread-1 (]: Began compiling node test.dbt_idx.assert_customer_fact_has_no_row_loss.sql
[0m19:43:49.888951 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_idx.assert_customer_fact_has_no_row_loss.sql"
[0m19:43:49.892949 [debug] [Thread-1 (]: Timing info for test.dbt_idx.assert_customer_fact_has_no_row_loss.sql (compile): 19:43:49.884950 => 19:43:49.892949
[0m19:43:49.893950 [debug] [Thread-1 (]: Began executing node test.dbt_idx.assert_customer_fact_has_no_row_loss.sql
[0m19:43:49.897464 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_idx.assert_customer_fact_has_no_row_loss.sql"
[0m19:43:49.902909 [debug] [Thread-1 (]: Using postgres connection "test.dbt_idx.assert_customer_fact_has_no_row_loss.sql"
[0m19:43:49.905243 [debug] [Thread-1 (]: On test.dbt_idx.assert_customer_fact_has_no_row_loss.sql: BEGIN
[0m19:43:49.907461 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:43:49.939595 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m19:43:49.940609 [debug] [Thread-1 (]: Using postgres connection "test.dbt_idx.assert_customer_fact_has_no_row_loss.sql"
[0m19:43:49.940609 [debug] [Thread-1 (]: On test.dbt_idx.assert_customer_fact_has_no_row_loss.sql: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "test.dbt_idx.assert_customer_fact_has_no_row_loss.sql"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      -- dim_customers must have the same number of rows as its staging counterpart
-- Therefore return records where this isn't true to make the test fail
select *
from (
    select dim_cust.customer_id
    from "IDX-Stock"."IDX-Schema"."dim_customers" dim_cust
        left join "IDX-Stock"."IDX-Schema"."stg_eltool__customers_snapshots" stg_cust
    on dim_cust.customer_id = stg_cust.customer_id
    where stg_cust.customer_id is null
    UNION ALL
    select stg_cust.customer_id
    from "IDX-Stock"."IDX-Schema"."stg_eltool__customers_snapshots" stg_cust
      left join "IDX-Stock"."IDX-Schema"."dim_customers" dim_cust
    on stg_cust.customer_id = dim_cust.customer_id
    where dim_cust.customer_id is null
) tmp
      
    ) dbt_internal_test
[0m19:43:49.944627 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m19:43:49.947640 [debug] [Thread-1 (]: Timing info for test.dbt_idx.assert_customer_fact_has_no_row_loss.sql (execute): 19:43:49.893950 => 19:43:49.946638
[0m19:43:49.948643 [debug] [Thread-1 (]: On test.dbt_idx.assert_customer_fact_has_no_row_loss.sql: ROLLBACK
[0m19:43:49.950633 [debug] [Thread-1 (]: On test.dbt_idx.assert_customer_fact_has_no_row_loss.sql: Close
[0m19:43:49.952639 [info ] [Thread-1 (]: 2 of 19 PASS assert_customer_fact_has_no_row_loss.sql .......................... [[32mPASS[0m in 0.07s]
[0m19:43:49.953657 [debug] [Thread-1 (]: Finished running node test.dbt_idx.assert_customer_fact_has_no_row_loss.sql
[0m19:43:49.955649 [debug] [Thread-1 (]: Began running node test.dbt_idx.assert_stock_dimension_has_no_row_loss.sql
[0m19:43:49.958496 [info ] [Thread-1 (]: 3 of 19 START test assert_stock_dimension_has_no_row_loss.sql .................. [RUN]
[0m19:43:49.962020 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_idx.assert_customer_fact_has_no_row_loss.sql, now test.dbt_idx.assert_stock_dimension_has_no_row_loss.sql)
[0m19:43:49.963765 [debug] [Thread-1 (]: Began compiling node test.dbt_idx.assert_stock_dimension_has_no_row_loss.sql
[0m19:43:49.973545 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_idx.assert_stock_dimension_has_no_row_loss.sql"
[0m19:43:49.980230 [debug] [Thread-1 (]: Timing info for test.dbt_idx.assert_stock_dimension_has_no_row_loss.sql (compile): 19:43:49.965019 => 19:43:49.979679
[0m19:43:49.982686 [debug] [Thread-1 (]: Began executing node test.dbt_idx.assert_stock_dimension_has_no_row_loss.sql
[0m19:43:49.988107 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_idx.assert_stock_dimension_has_no_row_loss.sql"
[0m19:43:49.993572 [debug] [Thread-1 (]: Using postgres connection "test.dbt_idx.assert_stock_dimension_has_no_row_loss.sql"
[0m19:43:49.994589 [debug] [Thread-1 (]: On test.dbt_idx.assert_stock_dimension_has_no_row_loss.sql: BEGIN
[0m19:43:49.996587 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:43:50.029980 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m19:43:50.031063 [debug] [Thread-1 (]: Using postgres connection "test.dbt_idx.assert_stock_dimension_has_no_row_loss.sql"
[0m19:43:50.032296 [debug] [Thread-1 (]: On test.dbt_idx.assert_stock_dimension_has_no_row_loss.sql: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "test.dbt_idx.assert_stock_dimension_has_no_row_loss.sql"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      -- fact_stocks must have the same number of rows as its staging counterpart
-- Therefore return records where this isn't true to make the test fail
select *
from (
    select stock.id
    from "IDX-Stock"."IDX-Schema"."fact_stocks" stock
    where stock.id is null
) tmp
      
    ) dbt_internal_test
[0m19:43:50.040874 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m19:43:50.043842 [debug] [Thread-1 (]: Timing info for test.dbt_idx.assert_stock_dimension_has_no_row_loss.sql (execute): 19:43:49.983959 => 19:43:50.043842
[0m19:43:50.044856 [debug] [Thread-1 (]: On test.dbt_idx.assert_stock_dimension_has_no_row_loss.sql: ROLLBACK
[0m19:43:50.047411 [debug] [Thread-1 (]: On test.dbt_idx.assert_stock_dimension_has_no_row_loss.sql: Close
[0m19:43:50.050033 [info ] [Thread-1 (]: 3 of 19 PASS assert_stock_dimension_has_no_row_loss.sql ........................ [[32mPASS[0m in 0.09s]
[0m19:43:50.051575 [debug] [Thread-1 (]: Finished running node test.dbt_idx.assert_stock_dimension_has_no_row_loss.sql
[0m19:43:50.052596 [debug] [Thread-1 (]: Began running node test.dbt_idx.not_null_customer_orders_status_customer_id.3915c814eb
[0m19:43:50.053582 [info ] [Thread-1 (]: 4 of 19 START test not_null_customer_orders_status_customer_id ................. [RUN]
[0m19:43:50.054583 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_idx.assert_stock_dimension_has_no_row_loss.sql, now test.dbt_idx.not_null_customer_orders_status_customer_id.3915c814eb)
[0m19:43:50.055583 [debug] [Thread-1 (]: Began compiling node test.dbt_idx.not_null_customer_orders_status_customer_id.3915c814eb
[0m19:43:50.063146 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_idx.not_null_customer_orders_status_customer_id.3915c814eb"
[0m19:43:50.071153 [debug] [Thread-1 (]: Timing info for test.dbt_idx.not_null_customer_orders_status_customer_id.3915c814eb (compile): 19:43:50.056589 => 19:43:50.071153
[0m19:43:50.073822 [debug] [Thread-1 (]: Began executing node test.dbt_idx.not_null_customer_orders_status_customer_id.3915c814eb
[0m19:43:50.081422 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_idx.not_null_customer_orders_status_customer_id.3915c814eb"
[0m19:43:50.091307 [debug] [Thread-1 (]: Using postgres connection "test.dbt_idx.not_null_customer_orders_status_customer_id.3915c814eb"
[0m19:43:50.092462 [debug] [Thread-1 (]: On test.dbt_idx.not_null_customer_orders_status_customer_id.3915c814eb: BEGIN
[0m19:43:50.093048 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:43:50.115870 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m19:43:50.116880 [debug] [Thread-1 (]: Using postgres connection "test.dbt_idx.not_null_customer_orders_status_customer_id.3915c814eb"
[0m19:43:50.117846 [debug] [Thread-1 (]: On test.dbt_idx.not_null_customer_orders_status_customer_id.3915c814eb: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "test.dbt_idx.not_null_customer_orders_status_customer_id.3915c814eb"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select customer_id
from "IDX-Stock"."IDX-Schema"."customer_orders_status"
where customer_id is null



      
    ) dbt_internal_test
[0m19:43:50.120846 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m19:43:50.122870 [debug] [Thread-1 (]: Timing info for test.dbt_idx.not_null_customer_orders_status_customer_id.3915c814eb (execute): 19:43:50.075431 => 19:43:50.122870
[0m19:43:50.123845 [debug] [Thread-1 (]: On test.dbt_idx.not_null_customer_orders_status_customer_id.3915c814eb: ROLLBACK
[0m19:43:50.126088 [debug] [Thread-1 (]: On test.dbt_idx.not_null_customer_orders_status_customer_id.3915c814eb: Close
[0m19:43:50.127103 [info ] [Thread-1 (]: 4 of 19 PASS not_null_customer_orders_status_customer_id ....................... [[32mPASS[0m in 0.07s]
[0m19:43:50.129102 [debug] [Thread-1 (]: Finished running node test.dbt_idx.not_null_customer_orders_status_customer_id.3915c814eb
[0m19:43:50.130101 [debug] [Thread-1 (]: Began running node test.dbt_idx.not_null_dim_customers_customer_id.dd91cd1c8d
[0m19:43:50.131100 [info ] [Thread-1 (]: 5 of 19 START test not_null_dim_customers_customer_id .......................... [RUN]
[0m19:43:50.132118 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_idx.not_null_customer_orders_status_customer_id.3915c814eb, now test.dbt_idx.not_null_dim_customers_customer_id.dd91cd1c8d)
[0m19:43:50.133100 [debug] [Thread-1 (]: Began compiling node test.dbt_idx.not_null_dim_customers_customer_id.dd91cd1c8d
[0m19:43:50.138098 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_idx.not_null_dim_customers_customer_id.dd91cd1c8d"
[0m19:43:50.143477 [debug] [Thread-1 (]: Timing info for test.dbt_idx.not_null_dim_customers_customer_id.dd91cd1c8d (compile): 19:43:50.134102 => 19:43:50.143477
[0m19:43:50.144511 [debug] [Thread-1 (]: Began executing node test.dbt_idx.not_null_dim_customers_customer_id.dd91cd1c8d
[0m19:43:50.147508 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_idx.not_null_dim_customers_customer_id.dd91cd1c8d"
[0m19:43:50.152511 [debug] [Thread-1 (]: Using postgres connection "test.dbt_idx.not_null_dim_customers_customer_id.dd91cd1c8d"
[0m19:43:50.153509 [debug] [Thread-1 (]: On test.dbt_idx.not_null_dim_customers_customer_id.dd91cd1c8d: BEGIN
[0m19:43:50.154476 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:43:50.176359 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m19:43:50.177348 [debug] [Thread-1 (]: Using postgres connection "test.dbt_idx.not_null_dim_customers_customer_id.dd91cd1c8d"
[0m19:43:50.178349 [debug] [Thread-1 (]: On test.dbt_idx.not_null_dim_customers_customer_id.dd91cd1c8d: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "test.dbt_idx.not_null_dim_customers_customer_id.dd91cd1c8d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select customer_id
from "IDX-Stock"."IDX-Schema"."dim_customers"
where customer_id is null



      
    ) dbt_internal_test
[0m19:43:50.181348 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m19:43:50.183355 [debug] [Thread-1 (]: Timing info for test.dbt_idx.not_null_dim_customers_customer_id.dd91cd1c8d (execute): 19:43:50.145507 => 19:43:50.183355
[0m19:43:50.185355 [debug] [Thread-1 (]: On test.dbt_idx.not_null_dim_customers_customer_id.dd91cd1c8d: ROLLBACK
[0m19:43:50.188356 [debug] [Thread-1 (]: On test.dbt_idx.not_null_dim_customers_customer_id.dd91cd1c8d: Close
[0m19:43:50.191406 [info ] [Thread-1 (]: 5 of 19 PASS not_null_dim_customers_customer_id ................................ [[32mPASS[0m in 0.06s]
[0m19:43:50.193367 [debug] [Thread-1 (]: Finished running node test.dbt_idx.not_null_dim_customers_customer_id.dd91cd1c8d
[0m19:43:50.196356 [debug] [Thread-1 (]: Began running node test.dbt_idx.not_null_fact_stocks_id.e7b7e788fa
[0m19:43:50.197405 [info ] [Thread-1 (]: 6 of 19 START test not_null_fact_stocks_id ..................................... [RUN]
[0m19:43:50.199425 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_idx.not_null_dim_customers_customer_id.dd91cd1c8d, now test.dbt_idx.not_null_fact_stocks_id.e7b7e788fa)
[0m19:43:50.200395 [debug] [Thread-1 (]: Began compiling node test.dbt_idx.not_null_fact_stocks_id.e7b7e788fa
[0m19:43:50.205428 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_idx.not_null_fact_stocks_id.e7b7e788fa"
[0m19:43:50.211423 [debug] [Thread-1 (]: Timing info for test.dbt_idx.not_null_fact_stocks_id.e7b7e788fa (compile): 19:43:50.201428 => 19:43:50.211423
[0m19:43:50.212394 [debug] [Thread-1 (]: Began executing node test.dbt_idx.not_null_fact_stocks_id.e7b7e788fa
[0m19:43:50.215405 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_idx.not_null_fact_stocks_id.e7b7e788fa"
[0m19:43:50.219437 [debug] [Thread-1 (]: Using postgres connection "test.dbt_idx.not_null_fact_stocks_id.e7b7e788fa"
[0m19:43:50.220390 [debug] [Thread-1 (]: On test.dbt_idx.not_null_fact_stocks_id.e7b7e788fa: BEGIN
[0m19:43:50.221440 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:43:50.243428 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m19:43:50.244430 [debug] [Thread-1 (]: Using postgres connection "test.dbt_idx.not_null_fact_stocks_id.e7b7e788fa"
[0m19:43:50.245418 [debug] [Thread-1 (]: On test.dbt_idx.not_null_fact_stocks_id.e7b7e788fa: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "test.dbt_idx.not_null_fact_stocks_id.e7b7e788fa"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from "IDX-Stock"."IDX-Schema"."fact_stocks"
where id is null



      
    ) dbt_internal_test
[0m19:43:50.252432 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m19:43:50.253432 [debug] [Thread-1 (]: Timing info for test.dbt_idx.not_null_fact_stocks_id.e7b7e788fa (execute): 19:43:50.212394 => 19:43:50.253432
[0m19:43:50.254429 [debug] [Thread-1 (]: On test.dbt_idx.not_null_fact_stocks_id.e7b7e788fa: ROLLBACK
[0m19:43:50.257397 [debug] [Thread-1 (]: On test.dbt_idx.not_null_fact_stocks_id.e7b7e788fa: Close
[0m19:43:50.259393 [info ] [Thread-1 (]: 6 of 19 PASS not_null_fact_stocks_id ........................................... [[32mPASS[0m in 0.06s]
[0m19:43:50.261402 [debug] [Thread-1 (]: Finished running node test.dbt_idx.not_null_fact_stocks_id.e7b7e788fa
[0m19:43:50.263393 [debug] [Thread-1 (]: Began running node test.dbt_idx.not_null_stg_eltool__company_id.632831b79c
[0m19:43:50.264398 [info ] [Thread-1 (]: 7 of 19 START test not_null_stg_eltool__company_id ............................. [RUN]
[0m19:43:50.265404 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_idx.not_null_fact_stocks_id.e7b7e788fa, now test.dbt_idx.not_null_stg_eltool__company_id.632831b79c)
[0m19:43:50.266417 [debug] [Thread-1 (]: Began compiling node test.dbt_idx.not_null_stg_eltool__company_id.632831b79c
[0m19:43:50.270431 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_idx.not_null_stg_eltool__company_id.632831b79c"
[0m19:43:50.276855 [debug] [Thread-1 (]: Timing info for test.dbt_idx.not_null_stg_eltool__company_id.632831b79c (compile): 19:43:50.266417 => 19:43:50.276855
[0m19:43:50.277875 [debug] [Thread-1 (]: Began executing node test.dbt_idx.not_null_stg_eltool__company_id.632831b79c
[0m19:43:50.280877 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_idx.not_null_stg_eltool__company_id.632831b79c"
[0m19:43:50.285894 [debug] [Thread-1 (]: Using postgres connection "test.dbt_idx.not_null_stg_eltool__company_id.632831b79c"
[0m19:43:50.286910 [debug] [Thread-1 (]: On test.dbt_idx.not_null_stg_eltool__company_id.632831b79c: BEGIN
[0m19:43:50.287885 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:43:50.308824 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m19:43:50.309826 [debug] [Thread-1 (]: Using postgres connection "test.dbt_idx.not_null_stg_eltool__company_id.632831b79c"
[0m19:43:50.309826 [debug] [Thread-1 (]: On test.dbt_idx.not_null_stg_eltool__company_id.632831b79c: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "test.dbt_idx.not_null_stg_eltool__company_id.632831b79c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from "IDX-Stock"."IDX-Schema"."stg_eltool__company"
where id is null



      
    ) dbt_internal_test
[0m19:43:50.312824 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m19:43:50.314823 [debug] [Thread-1 (]: Timing info for test.dbt_idx.not_null_stg_eltool__company_id.632831b79c (execute): 19:43:50.278842 => 19:43:50.313797
[0m19:43:50.315823 [debug] [Thread-1 (]: On test.dbt_idx.not_null_stg_eltool__company_id.632831b79c: ROLLBACK
[0m19:43:50.317797 [debug] [Thread-1 (]: On test.dbt_idx.not_null_stg_eltool__company_id.632831b79c: Close
[0m19:43:50.319800 [info ] [Thread-1 (]: 7 of 19 PASS not_null_stg_eltool__company_id ................................... [[32mPASS[0m in 0.05s]
[0m19:43:50.321802 [debug] [Thread-1 (]: Finished running node test.dbt_idx.not_null_stg_eltool__company_id.632831b79c
[0m19:43:50.322801 [debug] [Thread-1 (]: Began running node test.dbt_idx.not_null_stg_eltool__customers_snapshots_customer_id.ea4fc4ca86
[0m19:43:50.323806 [info ] [Thread-1 (]: 8 of 19 START test not_null_stg_eltool__customers_snapshots_customer_id ........ [RUN]
[0m19:43:50.324817 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_idx.not_null_stg_eltool__company_id.632831b79c, now test.dbt_idx.not_null_stg_eltool__customers_snapshots_customer_id.ea4fc4ca86)
[0m19:43:50.325798 [debug] [Thread-1 (]: Began compiling node test.dbt_idx.not_null_stg_eltool__customers_snapshots_customer_id.ea4fc4ca86
[0m19:43:50.329834 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_idx.not_null_stg_eltool__customers_snapshots_customer_id.ea4fc4ca86"
[0m19:43:50.336712 [debug] [Thread-1 (]: Timing info for test.dbt_idx.not_null_stg_eltool__customers_snapshots_customer_id.ea4fc4ca86 (compile): 19:43:50.326847 => 19:43:50.335744
[0m19:43:50.337710 [debug] [Thread-1 (]: Began executing node test.dbt_idx.not_null_stg_eltool__customers_snapshots_customer_id.ea4fc4ca86
[0m19:43:50.339746 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_idx.not_null_stg_eltool__customers_snapshots_customer_id.ea4fc4ca86"
[0m19:43:50.346710 [debug] [Thread-1 (]: Using postgres connection "test.dbt_idx.not_null_stg_eltool__customers_snapshots_customer_id.ea4fc4ca86"
[0m19:43:50.347744 [debug] [Thread-1 (]: On test.dbt_idx.not_null_stg_eltool__customers_snapshots_customer_id.ea4fc4ca86: BEGIN
[0m19:43:50.348712 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:43:50.370895 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m19:43:50.371907 [debug] [Thread-1 (]: Using postgres connection "test.dbt_idx.not_null_stg_eltool__customers_snapshots_customer_id.ea4fc4ca86"
[0m19:43:50.372898 [debug] [Thread-1 (]: On test.dbt_idx.not_null_stg_eltool__customers_snapshots_customer_id.ea4fc4ca86: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "test.dbt_idx.not_null_stg_eltool__customers_snapshots_customer_id.ea4fc4ca86"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select customer_id
from "IDX-Stock"."IDX-Schema"."stg_eltool__customers_snapshots"
where customer_id is null



      
    ) dbt_internal_test
[0m19:43:50.376898 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m19:43:50.377899 [debug] [Thread-1 (]: Timing info for test.dbt_idx.not_null_stg_eltool__customers_snapshots_customer_id.ea4fc4ca86 (execute): 19:43:50.337710 => 19:43:50.377899
[0m19:43:50.378901 [debug] [Thread-1 (]: On test.dbt_idx.not_null_stg_eltool__customers_snapshots_customer_id.ea4fc4ca86: ROLLBACK
[0m19:43:50.381918 [debug] [Thread-1 (]: On test.dbt_idx.not_null_stg_eltool__customers_snapshots_customer_id.ea4fc4ca86: Close
[0m19:43:50.383917 [info ] [Thread-1 (]: 8 of 19 PASS not_null_stg_eltool__customers_snapshots_customer_id .............. [[32mPASS[0m in 0.06s]
[0m19:43:50.385916 [debug] [Thread-1 (]: Finished running node test.dbt_idx.not_null_stg_eltool__customers_snapshots_customer_id.ea4fc4ca86
[0m19:43:50.387915 [debug] [Thread-1 (]: Began running node test.dbt_idx.not_null_stg_eltool__stock_id.68f6d1d89a
[0m19:43:50.388919 [info ] [Thread-1 (]: 9 of 19 START test not_null_stg_eltool__stock_id ............................... [RUN]
[0m19:43:50.391917 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_idx.not_null_stg_eltool__customers_snapshots_customer_id.ea4fc4ca86, now test.dbt_idx.not_null_stg_eltool__stock_id.68f6d1d89a)
[0m19:43:50.392913 [debug] [Thread-1 (]: Began compiling node test.dbt_idx.not_null_stg_eltool__stock_id.68f6d1d89a
[0m19:43:50.397482 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_idx.not_null_stg_eltool__stock_id.68f6d1d89a"
[0m19:43:50.404490 [debug] [Thread-1 (]: Timing info for test.dbt_idx.not_null_stg_eltool__stock_id.68f6d1d89a (compile): 19:43:50.393918 => 19:43:50.403484
[0m19:43:50.404490 [debug] [Thread-1 (]: Began executing node test.dbt_idx.not_null_stg_eltool__stock_id.68f6d1d89a
[0m19:43:50.408480 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_idx.not_null_stg_eltool__stock_id.68f6d1d89a"
[0m19:43:50.412749 [debug] [Thread-1 (]: Using postgres connection "test.dbt_idx.not_null_stg_eltool__stock_id.68f6d1d89a"
[0m19:43:50.413666 [debug] [Thread-1 (]: On test.dbt_idx.not_null_stg_eltool__stock_id.68f6d1d89a: BEGIN
[0m19:43:50.414666 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:43:50.442197 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m19:43:50.443205 [debug] [Thread-1 (]: Using postgres connection "test.dbt_idx.not_null_stg_eltool__stock_id.68f6d1d89a"
[0m19:43:50.444218 [debug] [Thread-1 (]: On test.dbt_idx.not_null_stg_eltool__stock_id.68f6d1d89a: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "test.dbt_idx.not_null_stg_eltool__stock_id.68f6d1d89a"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from "IDX-Stock"."IDX-Schema"."stg_eltool__stock"
where id is null



      
    ) dbt_internal_test
[0m19:43:50.452613 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m19:43:50.455607 [debug] [Thread-1 (]: Timing info for test.dbt_idx.not_null_stg_eltool__stock_id.68f6d1d89a (execute): 19:43:50.405487 => 19:43:50.454607
[0m19:43:50.456607 [debug] [Thread-1 (]: On test.dbt_idx.not_null_stg_eltool__stock_id.68f6d1d89a: ROLLBACK
[0m19:43:50.459606 [debug] [Thread-1 (]: On test.dbt_idx.not_null_stg_eltool__stock_id.68f6d1d89a: Close
[0m19:43:50.461617 [info ] [Thread-1 (]: 9 of 19 PASS not_null_stg_eltool__stock_id ..................................... [[32mPASS[0m in 0.07s]
[0m19:43:50.465617 [debug] [Thread-1 (]: Finished running node test.dbt_idx.not_null_stg_eltool__stock_id.68f6d1d89a
[0m19:43:50.465617 [debug] [Thread-1 (]: Began running node test.dbt_idx.not_null_stock_update_status_id.633bc8afe3
[0m19:43:50.468150 [info ] [Thread-1 (]: 10 of 19 START test not_null_stock_update_status_id ............................ [RUN]
[0m19:43:50.470134 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_idx.not_null_stg_eltool__stock_id.68f6d1d89a, now test.dbt_idx.not_null_stock_update_status_id.633bc8afe3)
[0m19:43:50.470134 [debug] [Thread-1 (]: Began compiling node test.dbt_idx.not_null_stock_update_status_id.633bc8afe3
[0m19:43:50.477134 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_idx.not_null_stock_update_status_id.633bc8afe3"
[0m19:43:50.484651 [debug] [Thread-1 (]: Timing info for test.dbt_idx.not_null_stock_update_status_id.633bc8afe3 (compile): 19:43:50.471134 => 19:43:50.484651
[0m19:43:50.486159 [debug] [Thread-1 (]: Began executing node test.dbt_idx.not_null_stock_update_status_id.633bc8afe3
[0m19:43:50.491174 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_idx.not_null_stock_update_status_id.633bc8afe3"
[0m19:43:50.496684 [debug] [Thread-1 (]: Using postgres connection "test.dbt_idx.not_null_stock_update_status_id.633bc8afe3"
[0m19:43:50.498695 [debug] [Thread-1 (]: On test.dbt_idx.not_null_stock_update_status_id.633bc8afe3: BEGIN
[0m19:43:50.499697 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:43:50.524290 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m19:43:50.525273 [debug] [Thread-1 (]: Using postgres connection "test.dbt_idx.not_null_stock_update_status_id.633bc8afe3"
[0m19:43:50.527273 [debug] [Thread-1 (]: On test.dbt_idx.not_null_stock_update_status_id.633bc8afe3: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "test.dbt_idx.not_null_stock_update_status_id.633bc8afe3"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from "IDX-Stock"."IDX-Schema"."stock_update_status"
where id is null



      
    ) dbt_internal_test
[0m19:43:50.537820 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m19:43:50.540841 [debug] [Thread-1 (]: Timing info for test.dbt_idx.not_null_stock_update_status_id.633bc8afe3 (execute): 19:43:50.487186 => 19:43:50.539828
[0m19:43:50.541826 [debug] [Thread-1 (]: On test.dbt_idx.not_null_stock_update_status_id.633bc8afe3: ROLLBACK
[0m19:43:50.544833 [debug] [Thread-1 (]: On test.dbt_idx.not_null_stock_update_status_id.633bc8afe3: Close
[0m19:43:50.548355 [info ] [Thread-1 (]: 10 of 19 PASS not_null_stock_update_status_id .................................. [[32mPASS[0m in 0.08s]
[0m19:43:50.550349 [debug] [Thread-1 (]: Finished running node test.dbt_idx.not_null_stock_update_status_id.633bc8afe3
[0m19:43:50.552354 [debug] [Thread-1 (]: Began running node test.dbt_idx.source_not_null_IDX-Schema_customers_customer_id.8525798d49
[0m19:43:50.552354 [info ] [Thread-1 (]: 11 of 19 START test source_not_null_IDX-Schema_customers_customer_id ........... [RUN]
[0m19:43:50.554380 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_idx.not_null_stock_update_status_id.633bc8afe3, now test.dbt_idx.source_not_null_IDX-Schema_customers_customer_id.8525798d49)
[0m19:43:50.555389 [debug] [Thread-1 (]: Began compiling node test.dbt_idx.source_not_null_IDX-Schema_customers_customer_id.8525798d49
[0m19:43:50.562920 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_idx.source_not_null_IDX-Schema_customers_customer_id.8525798d49"
[0m19:43:50.570840 [debug] [Thread-1 (]: Timing info for test.dbt_idx.source_not_null_IDX-Schema_customers_customer_id.8525798d49 (compile): 19:43:50.556390 => 19:43:50.569826
[0m19:43:50.571843 [debug] [Thread-1 (]: Began executing node test.dbt_idx.source_not_null_IDX-Schema_customers_customer_id.8525798d49
[0m19:43:50.575332 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_idx.source_not_null_IDX-Schema_customers_customer_id.8525798d49"
[0m19:43:50.579341 [debug] [Thread-1 (]: Using postgres connection "test.dbt_idx.source_not_null_IDX-Schema_customers_customer_id.8525798d49"
[0m19:43:50.580341 [debug] [Thread-1 (]: On test.dbt_idx.source_not_null_IDX-Schema_customers_customer_id.8525798d49: BEGIN
[0m19:43:50.581340 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:43:50.608460 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m19:43:50.609442 [debug] [Thread-1 (]: Using postgres connection "test.dbt_idx.source_not_null_IDX-Schema_customers_customer_id.8525798d49"
[0m19:43:50.610948 [debug] [Thread-1 (]: On test.dbt_idx.source_not_null_IDX-Schema_customers_customer_id.8525798d49: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "test.dbt_idx.source_not_null_IDX-Schema_customers_customer_id.8525798d49"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select customer_id
from "IDX-Stock"."IDX-Schema"."customers"
where customer_id is null



      
    ) dbt_internal_test
[0m19:43:50.614996 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m19:43:50.617983 [debug] [Thread-1 (]: Timing info for test.dbt_idx.source_not_null_IDX-Schema_customers_customer_id.8525798d49 (execute): 19:43:50.572826 => 19:43:50.616955
[0m19:43:50.618971 [debug] [Thread-1 (]: On test.dbt_idx.source_not_null_IDX-Schema_customers_customer_id.8525798d49: ROLLBACK
[0m19:43:50.621971 [debug] [Thread-1 (]: On test.dbt_idx.source_not_null_IDX-Schema_customers_customer_id.8525798d49: Close
[0m19:43:50.623964 [info ] [Thread-1 (]: 11 of 19 PASS source_not_null_IDX-Schema_customers_customer_id ................. [[32mPASS[0m in 0.07s]
[0m19:43:50.626477 [debug] [Thread-1 (]: Finished running node test.dbt_idx.source_not_null_IDX-Schema_customers_customer_id.8525798d49
[0m19:43:50.627822 [debug] [Thread-1 (]: Began running node test.dbt_idx.source_not_null_IDX-Schema_ksql-company-stream_id.d088b78209
[0m19:43:50.628489 [info ] [Thread-1 (]: 12 of 19 START test source_not_null_IDX-Schema_ksql-company-stream_id .......... [RUN]
[0m19:43:50.630487 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_idx.source_not_null_IDX-Schema_customers_customer_id.8525798d49, now test.dbt_idx.source_not_null_IDX-Schema_ksql-company-stream_id.d088b78209)
[0m19:43:50.630487 [debug] [Thread-1 (]: Began compiling node test.dbt_idx.source_not_null_IDX-Schema_ksql-company-stream_id.d088b78209
[0m19:43:50.637486 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_idx.source_not_null_IDX-Schema_ksql-company-stream_id.d088b78209"
[0m19:43:50.645121 [debug] [Thread-1 (]: Timing info for test.dbt_idx.source_not_null_IDX-Schema_ksql-company-stream_id.d088b78209 (compile): 19:43:50.631487 => 19:43:50.645121
[0m19:43:50.647118 [debug] [Thread-1 (]: Began executing node test.dbt_idx.source_not_null_IDX-Schema_ksql-company-stream_id.d088b78209
[0m19:43:50.651122 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_idx.source_not_null_IDX-Schema_ksql-company-stream_id.d088b78209"
[0m19:43:50.657122 [debug] [Thread-1 (]: Using postgres connection "test.dbt_idx.source_not_null_IDX-Schema_ksql-company-stream_id.d088b78209"
[0m19:43:50.658128 [debug] [Thread-1 (]: On test.dbt_idx.source_not_null_IDX-Schema_ksql-company-stream_id.d088b78209: BEGIN
[0m19:43:50.659126 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:43:50.682950 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m19:43:50.684946 [debug] [Thread-1 (]: Using postgres connection "test.dbt_idx.source_not_null_IDX-Schema_ksql-company-stream_id.d088b78209"
[0m19:43:50.684946 [debug] [Thread-1 (]: On test.dbt_idx.source_not_null_IDX-Schema_ksql-company-stream_id.d088b78209: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "test.dbt_idx.source_not_null_IDX-Schema_ksql-company-stream_id.d088b78209"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from "IDX-Stock"."IDX-Schema"."ksql-company-stream"
where id is null



      
    ) dbt_internal_test
[0m19:43:50.687971 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m19:43:50.690947 [debug] [Thread-1 (]: Timing info for test.dbt_idx.source_not_null_IDX-Schema_ksql-company-stream_id.d088b78209 (execute): 19:43:50.647118 => 19:43:50.690947
[0m19:43:50.691946 [debug] [Thread-1 (]: On test.dbt_idx.source_not_null_IDX-Schema_ksql-company-stream_id.d088b78209: ROLLBACK
[0m19:43:50.693949 [debug] [Thread-1 (]: On test.dbt_idx.source_not_null_IDX-Schema_ksql-company-stream_id.d088b78209: Close
[0m19:43:50.695949 [info ] [Thread-1 (]: 12 of 19 PASS source_not_null_IDX-Schema_ksql-company-stream_id ................ [[32mPASS[0m in 0.07s]
[0m19:43:50.698473 [debug] [Thread-1 (]: Finished running node test.dbt_idx.source_not_null_IDX-Schema_ksql-company-stream_id.d088b78209
[0m19:43:50.699476 [debug] [Thread-1 (]: Began running node test.dbt_idx.source_not_null_IDX-Schema_ksql-stock-stream_id.b3b44ecba6
[0m19:43:50.699986 [info ] [Thread-1 (]: 13 of 19 START test source_not_null_IDX-Schema_ksql-stock-stream_id ............ [RUN]
[0m19:43:50.702000 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_idx.source_not_null_IDX-Schema_ksql-company-stream_id.d088b78209, now test.dbt_idx.source_not_null_IDX-Schema_ksql-stock-stream_id.b3b44ecba6)
[0m19:43:50.702000 [debug] [Thread-1 (]: Began compiling node test.dbt_idx.source_not_null_IDX-Schema_ksql-stock-stream_id.b3b44ecba6
[0m19:43:50.707997 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_idx.source_not_null_IDX-Schema_ksql-stock-stream_id.b3b44ecba6"
[0m19:43:50.714989 [debug] [Thread-1 (]: Timing info for test.dbt_idx.source_not_null_IDX-Schema_ksql-stock-stream_id.b3b44ecba6 (compile): 19:43:50.702998 => 19:43:50.714989
[0m19:43:50.716991 [debug] [Thread-1 (]: Began executing node test.dbt_idx.source_not_null_IDX-Schema_ksql-stock-stream_id.b3b44ecba6
[0m19:43:50.719990 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_idx.source_not_null_IDX-Schema_ksql-stock-stream_id.b3b44ecba6"
[0m19:43:50.723514 [debug] [Thread-1 (]: Using postgres connection "test.dbt_idx.source_not_null_IDX-Schema_ksql-stock-stream_id.b3b44ecba6"
[0m19:43:50.724515 [debug] [Thread-1 (]: On test.dbt_idx.source_not_null_IDX-Schema_ksql-stock-stream_id.b3b44ecba6: BEGIN
[0m19:43:50.725512 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:43:50.749024 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m19:43:50.750024 [debug] [Thread-1 (]: Using postgres connection "test.dbt_idx.source_not_null_IDX-Schema_ksql-stock-stream_id.b3b44ecba6"
[0m19:43:50.751020 [debug] [Thread-1 (]: On test.dbt_idx.source_not_null_IDX-Schema_ksql-stock-stream_id.b3b44ecba6: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "test.dbt_idx.source_not_null_IDX-Schema_ksql-stock-stream_id.b3b44ecba6"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from "IDX-Stock"."IDX-Schema"."ksql-stock-stream"
where id is null



      
    ) dbt_internal_test
[0m19:43:50.756043 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m19:43:50.759023 [debug] [Thread-1 (]: Timing info for test.dbt_idx.source_not_null_IDX-Schema_ksql-stock-stream_id.b3b44ecba6 (execute): 19:43:50.716991 => 19:43:50.758023
[0m19:43:50.759023 [debug] [Thread-1 (]: On test.dbt_idx.source_not_null_IDX-Schema_ksql-stock-stream_id.b3b44ecba6: ROLLBACK
[0m19:43:50.761531 [debug] [Thread-1 (]: On test.dbt_idx.source_not_null_IDX-Schema_ksql-stock-stream_id.b3b44ecba6: Close
[0m19:43:50.763538 [info ] [Thread-1 (]: 13 of 19 PASS source_not_null_IDX-Schema_ksql-stock-stream_id .................. [[32mPASS[0m in 0.06s]
[0m19:43:50.767406 [debug] [Thread-1 (]: Finished running node test.dbt_idx.source_not_null_IDX-Schema_ksql-stock-stream_id.b3b44ecba6
[0m19:43:50.769058 [debug] [Thread-1 (]: Began running node test.dbt_idx.source_not_null_IDX-Schema_orders_order_id.f2383dcca5
[0m19:43:50.770085 [info ] [Thread-1 (]: 14 of 19 START test source_not_null_IDX-Schema_orders_order_id ................. [RUN]
[0m19:43:50.772070 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_idx.source_not_null_IDX-Schema_ksql-stock-stream_id.b3b44ecba6, now test.dbt_idx.source_not_null_IDX-Schema_orders_order_id.f2383dcca5)
[0m19:43:50.774633 [debug] [Thread-1 (]: Began compiling node test.dbt_idx.source_not_null_IDX-Schema_orders_order_id.f2383dcca5
[0m19:43:50.785029 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_idx.source_not_null_IDX-Schema_orders_order_id.f2383dcca5"
[0m19:43:50.792036 [debug] [Thread-1 (]: Timing info for test.dbt_idx.source_not_null_IDX-Schema_orders_order_id.f2383dcca5 (compile): 19:43:50.775657 => 19:43:50.792036
[0m19:43:50.793029 [debug] [Thread-1 (]: Began executing node test.dbt_idx.source_not_null_IDX-Schema_orders_order_id.f2383dcca5
[0m19:43:50.796029 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_idx.source_not_null_IDX-Schema_orders_order_id.f2383dcca5"
[0m19:43:50.801561 [debug] [Thread-1 (]: Using postgres connection "test.dbt_idx.source_not_null_IDX-Schema_orders_order_id.f2383dcca5"
[0m19:43:50.802562 [debug] [Thread-1 (]: On test.dbt_idx.source_not_null_IDX-Schema_orders_order_id.f2383dcca5: BEGIN
[0m19:43:50.802562 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:43:50.828613 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m19:43:50.829641 [debug] [Thread-1 (]: Using postgres connection "test.dbt_idx.source_not_null_IDX-Schema_orders_order_id.f2383dcca5"
[0m19:43:50.829641 [debug] [Thread-1 (]: On test.dbt_idx.source_not_null_IDX-Schema_orders_order_id.f2383dcca5: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "test.dbt_idx.source_not_null_IDX-Schema_orders_order_id.f2383dcca5"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select order_id
from "IDX-Stock"."IDX-Schema"."orders"
where order_id is null



      
    ) dbt_internal_test
[0m19:43:50.833258 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m19:43:50.836260 [debug] [Thread-1 (]: Timing info for test.dbt_idx.source_not_null_IDX-Schema_orders_order_id.f2383dcca5 (execute): 19:43:50.794044 => 19:43:50.835294
[0m19:43:50.837260 [debug] [Thread-1 (]: On test.dbt_idx.source_not_null_IDX-Schema_orders_order_id.f2383dcca5: ROLLBACK
[0m19:43:50.839261 [debug] [Thread-1 (]: On test.dbt_idx.source_not_null_IDX-Schema_orders_order_id.f2383dcca5: Close
[0m19:43:50.841261 [info ] [Thread-1 (]: 14 of 19 PASS source_not_null_IDX-Schema_orders_order_id ....................... [[32mPASS[0m in 0.07s]
[0m19:43:50.842261 [debug] [Thread-1 (]: Finished running node test.dbt_idx.source_not_null_IDX-Schema_orders_order_id.f2383dcca5
[0m19:43:50.843318 [debug] [Thread-1 (]: Began running node test.dbt_idx.source_relationships_IDX-Schema_orders_cust_id__customer_id__source_IDX_Schema_customers_.dc582657bc
[0m19:43:50.844278 [info ] [Thread-1 (]: 15 of 19 START test source_relationships_IDX-Schema_orders_cust_id__customer_id__source_IDX_Schema_customers_  [RUN]
[0m19:43:50.845274 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_idx.source_not_null_IDX-Schema_orders_order_id.f2383dcca5, now test.dbt_idx.source_relationships_IDX-Schema_orders_cust_id__customer_id__source_IDX_Schema_customers_.dc582657bc)
[0m19:43:50.847260 [debug] [Thread-1 (]: Began compiling node test.dbt_idx.source_relationships_IDX-Schema_orders_cust_id__customer_id__source_IDX_Schema_customers_.dc582657bc
[0m19:43:50.856293 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_idx.source_relationships_IDX-Schema_orders_cust_id__customer_id__source_IDX_Schema_customers_.dc582657bc"
[0m19:43:50.862311 [debug] [Thread-1 (]: Timing info for test.dbt_idx.source_relationships_IDX-Schema_orders_cust_id__customer_id__source_IDX_Schema_customers_.dc582657bc (compile): 19:43:50.847260 => 19:43:50.861305
[0m19:43:50.862311 [debug] [Thread-1 (]: Began executing node test.dbt_idx.source_relationships_IDX-Schema_orders_cust_id__customer_id__source_IDX_Schema_customers_.dc582657bc
[0m19:43:50.865306 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_idx.source_relationships_IDX-Schema_orders_cust_id__customer_id__source_IDX_Schema_customers_.dc582657bc"
[0m19:43:50.870305 [debug] [Thread-1 (]: Using postgres connection "test.dbt_idx.source_relationships_IDX-Schema_orders_cust_id__customer_id__source_IDX_Schema_customers_.dc582657bc"
[0m19:43:50.871307 [debug] [Thread-1 (]: On test.dbt_idx.source_relationships_IDX-Schema_orders_cust_id__customer_id__source_IDX_Schema_customers_.dc582657bc: BEGIN
[0m19:43:50.872307 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:43:50.894625 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m19:43:50.895600 [debug] [Thread-1 (]: Using postgres connection "test.dbt_idx.source_relationships_IDX-Schema_orders_cust_id__customer_id__source_IDX_Schema_customers_.dc582657bc"
[0m19:43:50.895600 [debug] [Thread-1 (]: On test.dbt_idx.source_relationships_IDX-Schema_orders_cust_id__customer_id__source_IDX_Schema_customers_.dc582657bc: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "test.dbt_idx.source_relationships_IDX-Schema_orders_cust_id__customer_id__source_IDX_Schema_customers_.dc582657bc"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select cust_id as from_field
    from "IDX-Stock"."IDX-Schema"."orders"
    where cust_id is not null
),

parent as (
    select customer_id as to_field
    from "IDX-Stock"."IDX-Schema"."customers"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m19:43:50.900149 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m19:43:50.901183 [debug] [Thread-1 (]: Timing info for test.dbt_idx.source_relationships_IDX-Schema_orders_cust_id__customer_id__source_IDX_Schema_customers_.dc582657bc (execute): 19:43:50.863344 => 19:43:50.901183
[0m19:43:50.902183 [debug] [Thread-1 (]: On test.dbt_idx.source_relationships_IDX-Schema_orders_cust_id__customer_id__source_IDX_Schema_customers_.dc582657bc: ROLLBACK
[0m19:43:50.905148 [debug] [Thread-1 (]: On test.dbt_idx.source_relationships_IDX-Schema_orders_cust_id__customer_id__source_IDX_Schema_customers_.dc582657bc: Close
[0m19:43:50.906153 [info ] [Thread-1 (]: 15 of 19 PASS source_relationships_IDX-Schema_orders_cust_id__customer_id__source_IDX_Schema_customers_  [[32mPASS[0m in 0.06s]
[0m19:43:50.908153 [debug] [Thread-1 (]: Finished running node test.dbt_idx.source_relationships_IDX-Schema_orders_cust_id__customer_id__source_IDX_Schema_customers_.dc582657bc
[0m19:43:50.909168 [debug] [Thread-1 (]: Began running node test.dbt_idx.source_unique_IDX-Schema_ksql-company-stream_id.09232074f4
[0m19:43:50.910152 [info ] [Thread-1 (]: 16 of 19 START test source_unique_IDX-Schema_ksql-company-stream_id ............ [RUN]
[0m19:43:50.911151 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_idx.source_relationships_IDX-Schema_orders_cust_id__customer_id__source_IDX_Schema_customers_.dc582657bc, now test.dbt_idx.source_unique_IDX-Schema_ksql-company-stream_id.09232074f4)
[0m19:43:50.912157 [debug] [Thread-1 (]: Began compiling node test.dbt_idx.source_unique_IDX-Schema_ksql-company-stream_id.09232074f4
[0m19:43:50.920182 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_idx.source_unique_IDX-Schema_ksql-company-stream_id.09232074f4"
[0m19:43:50.926917 [debug] [Thread-1 (]: Timing info for test.dbt_idx.source_unique_IDX-Schema_ksql-company-stream_id.09232074f4 (compile): 19:43:50.912157 => 19:43:50.925880
[0m19:43:50.926917 [debug] [Thread-1 (]: Began executing node test.dbt_idx.source_unique_IDX-Schema_ksql-company-stream_id.09232074f4
[0m19:43:50.929917 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_idx.source_unique_IDX-Schema_ksql-company-stream_id.09232074f4"
[0m19:43:50.934917 [debug] [Thread-1 (]: Using postgres connection "test.dbt_idx.source_unique_IDX-Schema_ksql-company-stream_id.09232074f4"
[0m19:43:50.935920 [debug] [Thread-1 (]: On test.dbt_idx.source_unique_IDX-Schema_ksql-company-stream_id.09232074f4: BEGIN
[0m19:43:50.937881 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:43:50.959887 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m19:43:50.960882 [debug] [Thread-1 (]: Using postgres connection "test.dbt_idx.source_unique_IDX-Schema_ksql-company-stream_id.09232074f4"
[0m19:43:50.961885 [debug] [Thread-1 (]: On test.dbt_idx.source_unique_IDX-Schema_ksql-company-stream_id.09232074f4: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "test.dbt_idx.source_unique_IDX-Schema_ksql-company-stream_id.09232074f4"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from "IDX-Stock"."IDX-Schema"."ksql-company-stream"
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
[0m19:43:50.965881 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m19:43:50.967916 [debug] [Thread-1 (]: Timing info for test.dbt_idx.source_unique_IDX-Schema_ksql-company-stream_id.09232074f4 (execute): 19:43:50.927880 => 19:43:50.967916
[0m19:43:50.968916 [debug] [Thread-1 (]: On test.dbt_idx.source_unique_IDX-Schema_ksql-company-stream_id.09232074f4: ROLLBACK
[0m19:43:50.970881 [debug] [Thread-1 (]: On test.dbt_idx.source_unique_IDX-Schema_ksql-company-stream_id.09232074f4: Close
[0m19:43:50.973887 [info ] [Thread-1 (]: 16 of 19 PASS source_unique_IDX-Schema_ksql-company-stream_id .................. [[32mPASS[0m in 0.06s]
[0m19:43:50.975400 [debug] [Thread-1 (]: Finished running node test.dbt_idx.source_unique_IDX-Schema_ksql-company-stream_id.09232074f4
[0m19:43:50.977408 [debug] [Thread-1 (]: Began running node test.dbt_idx.source_unique_IDX-Schema_ksql-stock-stream_id.2119c5c33b
[0m19:43:50.978414 [info ] [Thread-1 (]: 17 of 19 START test source_unique_IDX-Schema_ksql-stock-stream_id .............. [RUN]
[0m19:43:50.980425 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_idx.source_unique_IDX-Schema_ksql-company-stream_id.09232074f4, now test.dbt_idx.source_unique_IDX-Schema_ksql-stock-stream_id.2119c5c33b)
[0m19:43:50.981445 [debug] [Thread-1 (]: Began compiling node test.dbt_idx.source_unique_IDX-Schema_ksql-stock-stream_id.2119c5c33b
[0m19:43:50.985487 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_idx.source_unique_IDX-Schema_ksql-stock-stream_id.2119c5c33b"
[0m19:43:50.992452 [debug] [Thread-1 (]: Timing info for test.dbt_idx.source_unique_IDX-Schema_ksql-stock-stream_id.2119c5c33b (compile): 19:43:50.982495 => 19:43:50.991455
[0m19:43:50.992452 [debug] [Thread-1 (]: Began executing node test.dbt_idx.source_unique_IDX-Schema_ksql-stock-stream_id.2119c5c33b
[0m19:43:50.998032 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_idx.source_unique_IDX-Schema_ksql-stock-stream_id.2119c5c33b"
[0m19:43:51.002003 [debug] [Thread-1 (]: Using postgres connection "test.dbt_idx.source_unique_IDX-Schema_ksql-stock-stream_id.2119c5c33b"
[0m19:43:51.003013 [debug] [Thread-1 (]: On test.dbt_idx.source_unique_IDX-Schema_ksql-stock-stream_id.2119c5c33b: BEGIN
[0m19:43:51.004037 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:43:51.027998 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m19:43:51.029003 [debug] [Thread-1 (]: Using postgres connection "test.dbt_idx.source_unique_IDX-Schema_ksql-stock-stream_id.2119c5c33b"
[0m19:43:51.029003 [debug] [Thread-1 (]: On test.dbt_idx.source_unique_IDX-Schema_ksql-stock-stream_id.2119c5c33b: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "test.dbt_idx.source_unique_IDX-Schema_ksql-stock-stream_id.2119c5c33b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from "IDX-Stock"."IDX-Schema"."ksql-stock-stream"
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
[0m19:43:51.044838 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m19:43:51.048959 [debug] [Thread-1 (]: Timing info for test.dbt_idx.source_unique_IDX-Schema_ksql-stock-stream_id.2119c5c33b (execute): 19:43:50.994453 => 19:43:51.047831
[0m19:43:51.049994 [debug] [Thread-1 (]: On test.dbt_idx.source_unique_IDX-Schema_ksql-stock-stream_id.2119c5c33b: ROLLBACK
[0m19:43:51.052964 [debug] [Thread-1 (]: On test.dbt_idx.source_unique_IDX-Schema_ksql-stock-stream_id.2119c5c33b: Close
[0m19:43:51.054972 [info ] [Thread-1 (]: 17 of 19 PASS source_unique_IDX-Schema_ksql-stock-stream_id .................... [[32mPASS[0m in 0.08s]
[0m19:43:51.058058 [debug] [Thread-1 (]: Finished running node test.dbt_idx.source_unique_IDX-Schema_ksql-stock-stream_id.2119c5c33b
[0m19:43:51.060024 [debug] [Thread-1 (]: Began running node test.dbt_idx.source_unique_IDX-Schema_orders_order_id.5a8ef486ee
[0m19:43:51.062031 [info ] [Thread-1 (]: 18 of 19 START test source_unique_IDX-Schema_orders_order_id ................... [RUN]
[0m19:43:51.063034 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_idx.source_unique_IDX-Schema_ksql-stock-stream_id.2119c5c33b, now test.dbt_idx.source_unique_IDX-Schema_orders_order_id.5a8ef486ee)
[0m19:43:51.065081 [debug] [Thread-1 (]: Began compiling node test.dbt_idx.source_unique_IDX-Schema_orders_order_id.5a8ef486ee
[0m19:43:51.069644 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_idx.source_unique_IDX-Schema_orders_order_id.5a8ef486ee"
[0m19:43:51.076616 [debug] [Thread-1 (]: Timing info for test.dbt_idx.source_unique_IDX-Schema_orders_order_id.5a8ef486ee (compile): 19:43:51.065081 => 19:43:51.076616
[0m19:43:51.077644 [debug] [Thread-1 (]: Began executing node test.dbt_idx.source_unique_IDX-Schema_orders_order_id.5a8ef486ee
[0m19:43:51.080647 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_idx.source_unique_IDX-Schema_orders_order_id.5a8ef486ee"
[0m19:43:51.084617 [debug] [Thread-1 (]: Using postgres connection "test.dbt_idx.source_unique_IDX-Schema_orders_order_id.5a8ef486ee"
[0m19:43:51.086617 [debug] [Thread-1 (]: On test.dbt_idx.source_unique_IDX-Schema_orders_order_id.5a8ef486ee: BEGIN
[0m19:43:51.087626 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:43:51.112155 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m19:43:51.113157 [debug] [Thread-1 (]: Using postgres connection "test.dbt_idx.source_unique_IDX-Schema_orders_order_id.5a8ef486ee"
[0m19:43:51.113157 [debug] [Thread-1 (]: On test.dbt_idx.source_unique_IDX-Schema_orders_order_id.5a8ef486ee: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "test.dbt_idx.source_unique_IDX-Schema_orders_order_id.5a8ef486ee"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    order_id as unique_field,
    count(*) as n_records

from "IDX-Stock"."IDX-Schema"."orders"
where order_id is not null
group by order_id
having count(*) > 1



      
    ) dbt_internal_test
[0m19:43:51.118155 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m19:43:51.120493 [debug] [Thread-1 (]: Timing info for test.dbt_idx.source_unique_IDX-Schema_orders_order_id.5a8ef486ee (execute): 19:43:51.078611 => 19:43:51.120190
[0m19:43:51.121154 [debug] [Thread-1 (]: On test.dbt_idx.source_unique_IDX-Schema_orders_order_id.5a8ef486ee: ROLLBACK
[0m19:43:51.123157 [debug] [Thread-1 (]: On test.dbt_idx.source_unique_IDX-Schema_orders_order_id.5a8ef486ee: Close
[0m19:43:51.125160 [info ] [Thread-1 (]: 18 of 19 PASS source_unique_IDX-Schema_orders_order_id ......................... [[32mPASS[0m in 0.06s]
[0m19:43:51.127695 [debug] [Thread-1 (]: Finished running node test.dbt_idx.source_unique_IDX-Schema_orders_order_id.5a8ef486ee
[0m19:43:51.128704 [debug] [Thread-1 (]: Began running node test.dbt_idx.unique_customer_orders_status_order_id.b7a45e83ee
[0m19:43:51.129728 [info ] [Thread-1 (]: 19 of 19 START test unique_customer_orders_status_order_id ..................... [RUN]
[0m19:43:51.130702 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_idx.source_unique_IDX-Schema_orders_order_id.5a8ef486ee, now test.dbt_idx.unique_customer_orders_status_order_id.b7a45e83ee)
[0m19:43:51.131715 [debug] [Thread-1 (]: Began compiling node test.dbt_idx.unique_customer_orders_status_order_id.b7a45e83ee
[0m19:43:51.136718 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_idx.unique_customer_orders_status_order_id.b7a45e83ee"
[0m19:43:51.142704 [debug] [Thread-1 (]: Timing info for test.dbt_idx.unique_customer_orders_status_order_id.b7a45e83ee (compile): 19:43:51.132703 => 19:43:51.141701
[0m19:43:51.143701 [debug] [Thread-1 (]: Began executing node test.dbt_idx.unique_customer_orders_status_order_id.b7a45e83ee
[0m19:43:51.145735 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_idx.unique_customer_orders_status_order_id.b7a45e83ee"
[0m19:43:51.152753 [debug] [Thread-1 (]: Using postgres connection "test.dbt_idx.unique_customer_orders_status_order_id.b7a45e83ee"
[0m19:43:51.153748 [debug] [Thread-1 (]: On test.dbt_idx.unique_customer_orders_status_order_id.b7a45e83ee: BEGIN
[0m19:43:51.153748 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:43:51.175697 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m19:43:51.176664 [debug] [Thread-1 (]: Using postgres connection "test.dbt_idx.unique_customer_orders_status_order_id.b7a45e83ee"
[0m19:43:51.177686 [debug] [Thread-1 (]: On test.dbt_idx.unique_customer_orders_status_order_id.b7a45e83ee: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "test.dbt_idx.unique_customer_orders_status_order_id.b7a45e83ee"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    order_id as unique_field,
    count(*) as n_records

from "IDX-Stock"."IDX-Schema"."customer_orders_status"
where order_id is not null
group by order_id
having count(*) > 1



      
    ) dbt_internal_test
[0m19:43:51.181692 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m19:43:51.186703 [debug] [Thread-1 (]: Timing info for test.dbt_idx.unique_customer_orders_status_order_id.b7a45e83ee (execute): 19:43:51.143701 => 19:43:51.185736
[0m19:43:51.186703 [debug] [Thread-1 (]: On test.dbt_idx.unique_customer_orders_status_order_id.b7a45e83ee: ROLLBACK
[0m19:43:51.189699 [debug] [Thread-1 (]: On test.dbt_idx.unique_customer_orders_status_order_id.b7a45e83ee: Close
[0m19:43:51.191700 [info ] [Thread-1 (]: 19 of 19 PASS unique_customer_orders_status_order_id ........................... [[32mPASS[0m in 0.06s]
[0m19:43:51.193733 [debug] [Thread-1 (]: Finished running node test.dbt_idx.unique_customer_orders_status_order_id.b7a45e83ee
[0m19:43:51.196285 [debug] [MainThread]: Using postgres connection "master"
[0m19:43:51.197303 [debug] [MainThread]: On master: BEGIN
[0m19:43:51.197303 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m19:43:51.219844 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m19:43:51.219844 [debug] [MainThread]: On master: COMMIT
[0m19:43:51.220844 [debug] [MainThread]: Using postgres connection "master"
[0m19:43:51.221843 [debug] [MainThread]: On master: COMMIT
[0m19:43:51.224064 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m19:43:51.224064 [debug] [MainThread]: On master: Close
[0m19:43:51.226082 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:43:51.227076 [debug] [MainThread]: Connection 'list_IDX-Stock_snapshots' was properly closed.
[0m19:43:51.229088 [debug] [MainThread]: Connection 'test.dbt_idx.unique_customer_orders_status_order_id.b7a45e83ee' was properly closed.
[0m19:43:51.229088 [info ] [MainThread]: 
[0m19:43:51.231077 [info ] [MainThread]: Finished running 19 tests in 0 hours 0 minutes and 1.61 seconds (1.61s).
[0m19:43:51.235073 [debug] [MainThread]: Command end result
[0m19:43:51.260732 [info ] [MainThread]: 
[0m19:43:51.261243 [info ] [MainThread]: [32mCompleted successfully[0m
[0m19:43:51.262289 [info ] [MainThread]: 
[0m19:43:51.263389 [info ] [MainThread]: Done. PASS=19 WARN=0 ERROR=0 SKIP=0 TOTAL=19
[0m19:43:51.263899 [debug] [MainThread]: Command `dbt test` succeeded at 19:43:51.263899 after 2.19 seconds
[0m19:43:51.264940 [debug] [MainThread]: Flushing usage events


============================== 19:44:01.729058 | baedaee9-e42b-4a70-bc88-736b0caa4837 ==============================
[0m19:44:01.729058 [info ] [MainThread]: Running with dbt=1.6.1
[0m19:44:01.735062 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'D:\\00 Project\\00 My Project\\IdeaProjects\\Py-DBT-IDX\\logs', 'debug': 'False', 'profiles_dir': 'D:\\00 Project\\00 My Project\\IdeaProjects\\Py-DBT-IDX', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt docs generate', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'False'}
[0m19:44:01.956429 [info ] [MainThread]: Registered adapter: postgres=1.6.1
[0m19:44:01.977516 [debug] [MainThread]: checksum: efe19d9f5b93d1a98cc804fbfcdb6b3aced98b974af664946fee1cde8837deb7, vars: {}, profile: , target: , version: 1.6.1
[0m19:44:02.192807 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m19:44:02.193815 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m19:44:02.235139 [info ] [MainThread]: Found 11 models, 1 snapshot, 19 tests, 5 sources, 0 exposures, 0 metrics, 349 macros, 0 groups, 0 semantic models
[0m19:44:02.242424 [info ] [MainThread]: 
[0m19:44:02.245416 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m19:44:02.250938 [debug] [ThreadPool]: Acquiring new postgres connection 'list_IDX-Stock_snapshots'
[0m19:44:02.270500 [debug] [ThreadPool]: Using postgres connection "list_IDX-Stock_snapshots"
[0m19:44:02.271501 [debug] [ThreadPool]: On list_IDX-Stock_snapshots: BEGIN
[0m19:44:02.272503 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:44:02.311132 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m19:44:02.312144 [debug] [ThreadPool]: Using postgres connection "list_IDX-Stock_snapshots"
[0m19:44:02.313147 [debug] [ThreadPool]: On list_IDX-Stock_snapshots: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "connection_name": "list_IDX-Stock_snapshots"} */
select
      'IDX-Stock' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'snapshots'
    union all
    select
      'IDX-Stock' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'snapshots'
    union all
    select
      'IDX-Stock' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'snapshots'
  
[0m19:44:02.319675 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.0 seconds
[0m19:44:02.321662 [debug] [ThreadPool]: On list_IDX-Stock_snapshots: ROLLBACK
[0m19:44:02.325662 [debug] [ThreadPool]: On list_IDX-Stock_snapshots: Close
[0m19:44:02.328192 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_IDX-Stock_snapshots, now list_IDX-Stock_IDX-Schema)
[0m19:44:02.334177 [debug] [ThreadPool]: Using postgres connection "list_IDX-Stock_IDX-Schema"
[0m19:44:02.335179 [debug] [ThreadPool]: On list_IDX-Stock_IDX-Schema: BEGIN
[0m19:44:02.336177 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:44:02.361651 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m19:44:02.362653 [debug] [ThreadPool]: Using postgres connection "list_IDX-Stock_IDX-Schema"
[0m19:44:02.363653 [debug] [ThreadPool]: On list_IDX-Stock_IDX-Schema: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "connection_name": "list_IDX-Stock_IDX-Schema"} */
select
      'IDX-Stock' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'IDX-Schema'
    union all
    select
      'IDX-Stock' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'IDX-Schema'
    union all
    select
      'IDX-Stock' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'IDX-Schema'
  
[0m19:44:02.370173 [debug] [ThreadPool]: SQL status: SELECT 17 in 0.0 seconds
[0m19:44:02.373174 [debug] [ThreadPool]: On list_IDX-Stock_IDX-Schema: ROLLBACK
[0m19:44:02.376199 [debug] [ThreadPool]: On list_IDX-Stock_IDX-Schema: Close
[0m19:44:02.389738 [debug] [MainThread]: Using postgres connection "master"
[0m19:44:02.390739 [debug] [MainThread]: On master: BEGIN
[0m19:44:02.391736 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:44:02.415503 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m19:44:02.417494 [debug] [MainThread]: Using postgres connection "master"
[0m19:44:02.418494 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m19:44:02.428551 [debug] [MainThread]: SQL status: SELECT 9 in 0.0 seconds
[0m19:44:02.433831 [debug] [MainThread]: On master: ROLLBACK
[0m19:44:02.436554 [debug] [MainThread]: On master: Close
[0m19:44:02.438552 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m19:44:02.439549 [info ] [MainThread]: 
[0m19:44:02.445068 [debug] [Thread-1 (]: Began running node model.dbt_idx.stg_eltool__company
[0m19:44:02.447069 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.dbt_idx.stg_eltool__company'
[0m19:44:02.448069 [debug] [Thread-1 (]: Began compiling node model.dbt_idx.stg_eltool__company
[0m19:44:02.456067 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_idx.stg_eltool__company"
[0m19:44:02.462066 [debug] [Thread-1 (]: Timing info for model.dbt_idx.stg_eltool__company (compile): 19:44:02.449067 => 19:44:02.461070
[0m19:44:02.463066 [debug] [Thread-1 (]: Began executing node model.dbt_idx.stg_eltool__company
[0m19:44:02.464095 [debug] [Thread-1 (]: Timing info for model.dbt_idx.stg_eltool__company (execute): 19:44:02.464095 => 19:44:02.464095
[0m19:44:02.466093 [debug] [Thread-1 (]: Finished running node model.dbt_idx.stg_eltool__company
[0m19:44:02.467098 [debug] [Thread-1 (]: Began running node model.dbt_idx.stg_eltool__customers
[0m19:44:02.468094 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_idx.stg_eltool__company, now model.dbt_idx.stg_eltool__customers)
[0m19:44:02.468094 [debug] [Thread-1 (]: Began compiling node model.dbt_idx.stg_eltool__customers
[0m19:44:02.472092 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_idx.stg_eltool__customers"
[0m19:44:02.479092 [debug] [Thread-1 (]: Timing info for model.dbt_idx.stg_eltool__customers (compile): 19:44:02.469091 => 19:44:02.478093
[0m19:44:02.480091 [debug] [Thread-1 (]: Began executing node model.dbt_idx.stg_eltool__customers
[0m19:44:02.481092 [debug] [Thread-1 (]: Timing info for model.dbt_idx.stg_eltool__customers (execute): 19:44:02.480091 => 19:44:02.480091
[0m19:44:02.482091 [debug] [Thread-1 (]: Finished running node model.dbt_idx.stg_eltool__customers
[0m19:44:02.482091 [debug] [Thread-1 (]: Began running node model.dbt_idx.stg_eltool__orders
[0m19:44:02.483597 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_idx.stg_eltool__customers, now model.dbt_idx.stg_eltool__orders)
[0m19:44:02.484603 [debug] [Thread-1 (]: Began compiling node model.dbt_idx.stg_eltool__orders
[0m19:44:02.487603 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_idx.stg_eltool__orders"
[0m19:44:02.499605 [debug] [Thread-1 (]: Timing info for model.dbt_idx.stg_eltool__orders (compile): 19:44:02.485604 => 19:44:02.498612
[0m19:44:02.500604 [debug] [Thread-1 (]: Began executing node model.dbt_idx.stg_eltool__orders
[0m19:44:02.500604 [debug] [Thread-1 (]: Timing info for model.dbt_idx.stg_eltool__orders (execute): 19:44:02.500604 => 19:44:02.500604
[0m19:44:02.501639 [debug] [Thread-1 (]: Finished running node model.dbt_idx.stg_eltool__orders
[0m19:44:02.503161 [debug] [Thread-1 (]: Began running node model.dbt_idx.stg_eltool__state
[0m19:44:02.504169 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_idx.stg_eltool__orders, now model.dbt_idx.stg_eltool__state)
[0m19:44:02.505167 [debug] [Thread-1 (]: Began compiling node model.dbt_idx.stg_eltool__state
[0m19:44:02.510704 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_idx.stg_eltool__state"
[0m19:44:02.517748 [debug] [Thread-1 (]: Timing info for model.dbt_idx.stg_eltool__state (compile): 19:44:02.506169 => 19:44:02.516716
[0m19:44:02.517748 [debug] [Thread-1 (]: Began executing node model.dbt_idx.stg_eltool__state
[0m19:44:02.518745 [debug] [Thread-1 (]: Timing info for model.dbt_idx.stg_eltool__state (execute): 19:44:02.518745 => 19:44:02.518745
[0m19:44:02.520713 [debug] [Thread-1 (]: Finished running node model.dbt_idx.stg_eltool__state
[0m19:44:02.521718 [debug] [Thread-1 (]: Began running node model.dbt_idx.stg_eltool__stock
[0m19:44:02.522710 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_idx.stg_eltool__state, now model.dbt_idx.stg_eltool__stock)
[0m19:44:02.523711 [debug] [Thread-1 (]: Began compiling node model.dbt_idx.stg_eltool__stock
[0m19:44:02.526988 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_idx.stg_eltool__stock"
[0m19:44:02.533753 [debug] [Thread-1 (]: Timing info for model.dbt_idx.stg_eltool__stock (compile): 19:44:02.524955 => 19:44:02.533753
[0m19:44:02.534734 [debug] [Thread-1 (]: Began executing node model.dbt_idx.stg_eltool__stock
[0m19:44:02.535789 [debug] [Thread-1 (]: Timing info for model.dbt_idx.stg_eltool__stock (execute): 19:44:02.534734 => 19:44:02.534734
[0m19:44:02.536732 [debug] [Thread-1 (]: Finished running node model.dbt_idx.stg_eltool__stock
[0m19:44:02.537734 [debug] [Thread-1 (]: Began running node snapshot.dbt_idx.customers_snapshot
[0m19:44:02.538737 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_idx.stg_eltool__stock, now snapshot.dbt_idx.customers_snapshot)
[0m19:44:02.539733 [debug] [Thread-1 (]: Began compiling node snapshot.dbt_idx.customers_snapshot
[0m19:44:02.544259 [debug] [Thread-1 (]: Timing info for snapshot.dbt_idx.customers_snapshot (compile): 19:44:02.540731 => 19:44:02.543258
[0m19:44:02.545259 [debug] [Thread-1 (]: Began executing node snapshot.dbt_idx.customers_snapshot
[0m19:44:02.546258 [debug] [Thread-1 (]: Timing info for snapshot.dbt_idx.customers_snapshot (execute): 19:44:02.545259 => 19:44:02.545259
[0m19:44:02.547269 [debug] [Thread-1 (]: Finished running node snapshot.dbt_idx.customers_snapshot
[0m19:44:02.548282 [debug] [Thread-1 (]: Began running node test.dbt_idx.source_not_null_IDX-Schema_customers_customer_id.8525798d49
[0m19:44:02.549260 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly snapshot.dbt_idx.customers_snapshot, now test.dbt_idx.source_not_null_IDX-Schema_customers_customer_id.8525798d49)
[0m19:44:02.550622 [debug] [Thread-1 (]: Began compiling node test.dbt_idx.source_not_null_IDX-Schema_customers_customer_id.8525798d49
[0m19:44:02.561875 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_idx.source_not_null_IDX-Schema_customers_customer_id.8525798d49"
[0m19:44:02.567844 [debug] [Thread-1 (]: Timing info for test.dbt_idx.source_not_null_IDX-Schema_customers_customer_id.8525798d49 (compile): 19:44:02.551260 => 19:44:02.567844
[0m19:44:02.568874 [debug] [Thread-1 (]: Began executing node test.dbt_idx.source_not_null_IDX-Schema_customers_customer_id.8525798d49
[0m19:44:02.569873 [debug] [Thread-1 (]: Timing info for test.dbt_idx.source_not_null_IDX-Schema_customers_customer_id.8525798d49 (execute): 19:44:02.569873 => 19:44:02.569873
[0m19:44:02.570841 [debug] [Thread-1 (]: Finished running node test.dbt_idx.source_not_null_IDX-Schema_customers_customer_id.8525798d49
[0m19:44:02.572844 [debug] [Thread-1 (]: Began running node test.dbt_idx.source_not_null_IDX-Schema_ksql-company-stream_id.d088b78209
[0m19:44:02.573883 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_idx.source_not_null_IDX-Schema_customers_customer_id.8525798d49, now test.dbt_idx.source_not_null_IDX-Schema_ksql-company-stream_id.d088b78209)
[0m19:44:02.573883 [debug] [Thread-1 (]: Began compiling node test.dbt_idx.source_not_null_IDX-Schema_ksql-company-stream_id.d088b78209
[0m19:44:02.579886 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_idx.source_not_null_IDX-Schema_ksql-company-stream_id.d088b78209"
[0m19:44:02.586051 [debug] [Thread-1 (]: Timing info for test.dbt_idx.source_not_null_IDX-Schema_ksql-company-stream_id.d088b78209 (compile): 19:44:02.574884 => 19:44:02.586051
[0m19:44:02.588057 [debug] [Thread-1 (]: Began executing node test.dbt_idx.source_not_null_IDX-Schema_ksql-company-stream_id.d088b78209
[0m19:44:02.589061 [debug] [Thread-1 (]: Timing info for test.dbt_idx.source_not_null_IDX-Schema_ksql-company-stream_id.d088b78209 (execute): 19:44:02.589061 => 19:44:02.589061
[0m19:44:02.592062 [debug] [Thread-1 (]: Finished running node test.dbt_idx.source_not_null_IDX-Schema_ksql-company-stream_id.d088b78209
[0m19:44:02.593047 [debug] [Thread-1 (]: Began running node test.dbt_idx.source_not_null_IDX-Schema_ksql-stock-stream_id.b3b44ecba6
[0m19:44:02.594048 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_idx.source_not_null_IDX-Schema_ksql-company-stream_id.d088b78209, now test.dbt_idx.source_not_null_IDX-Schema_ksql-stock-stream_id.b3b44ecba6)
[0m19:44:02.595048 [debug] [Thread-1 (]: Began compiling node test.dbt_idx.source_not_null_IDX-Schema_ksql-stock-stream_id.b3b44ecba6
[0m19:44:02.599047 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_idx.source_not_null_IDX-Schema_ksql-stock-stream_id.b3b44ecba6"
[0m19:44:02.606573 [debug] [Thread-1 (]: Timing info for test.dbt_idx.source_not_null_IDX-Schema_ksql-stock-stream_id.b3b44ecba6 (compile): 19:44:02.596046 => 19:44:02.606573
[0m19:44:02.607562 [debug] [Thread-1 (]: Began executing node test.dbt_idx.source_not_null_IDX-Schema_ksql-stock-stream_id.b3b44ecba6
[0m19:44:02.608561 [debug] [Thread-1 (]: Timing info for test.dbt_idx.source_not_null_IDX-Schema_ksql-stock-stream_id.b3b44ecba6 (execute): 19:44:02.607562 => 19:44:02.607562
[0m19:44:02.609562 [debug] [Thread-1 (]: Finished running node test.dbt_idx.source_not_null_IDX-Schema_ksql-stock-stream_id.b3b44ecba6
[0m19:44:02.610561 [debug] [Thread-1 (]: Began running node test.dbt_idx.source_not_null_IDX-Schema_orders_order_id.f2383dcca5
[0m19:44:02.611071 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_idx.source_not_null_IDX-Schema_ksql-stock-stream_id.b3b44ecba6, now test.dbt_idx.source_not_null_IDX-Schema_orders_order_id.f2383dcca5)
[0m19:44:02.612082 [debug] [Thread-1 (]: Began compiling node test.dbt_idx.source_not_null_IDX-Schema_orders_order_id.f2383dcca5
[0m19:44:02.616625 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_idx.source_not_null_IDX-Schema_orders_order_id.f2383dcca5"
[0m19:44:02.623635 [debug] [Thread-1 (]: Timing info for test.dbt_idx.source_not_null_IDX-Schema_orders_order_id.f2383dcca5 (compile): 19:44:02.612082 => 19:44:02.622638
[0m19:44:02.624636 [debug] [Thread-1 (]: Began executing node test.dbt_idx.source_not_null_IDX-Schema_orders_order_id.f2383dcca5
[0m19:44:02.625669 [debug] [Thread-1 (]: Timing info for test.dbt_idx.source_not_null_IDX-Schema_orders_order_id.f2383dcca5 (execute): 19:44:02.624636 => 19:44:02.624636
[0m19:44:02.626634 [debug] [Thread-1 (]: Finished running node test.dbt_idx.source_not_null_IDX-Schema_orders_order_id.f2383dcca5
[0m19:44:02.627633 [debug] [Thread-1 (]: Began running node test.dbt_idx.source_relationships_IDX-Schema_orders_cust_id__customer_id__source_IDX_Schema_customers_.dc582657bc
[0m19:44:02.628666 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_idx.source_not_null_IDX-Schema_orders_order_id.f2383dcca5, now test.dbt_idx.source_relationships_IDX-Schema_orders_cust_id__customer_id__source_IDX_Schema_customers_.dc582657bc)
[0m19:44:02.628666 [debug] [Thread-1 (]: Began compiling node test.dbt_idx.source_relationships_IDX-Schema_orders_cust_id__customer_id__source_IDX_Schema_customers_.dc582657bc
[0m19:44:02.638270 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_idx.source_relationships_IDX-Schema_orders_cust_id__customer_id__source_IDX_Schema_customers_.dc582657bc"
[0m19:44:02.645216 [debug] [Thread-1 (]: Timing info for test.dbt_idx.source_relationships_IDX-Schema_orders_cust_id__customer_id__source_IDX_Schema_customers_.dc582657bc (compile): 19:44:02.629668 => 19:44:02.644254
[0m19:44:02.646251 [debug] [Thread-1 (]: Began executing node test.dbt_idx.source_relationships_IDX-Schema_orders_cust_id__customer_id__source_IDX_Schema_customers_.dc582657bc
[0m19:44:02.647053 [debug] [Thread-1 (]: Timing info for test.dbt_idx.source_relationships_IDX-Schema_orders_cust_id__customer_id__source_IDX_Schema_customers_.dc582657bc (execute): 19:44:02.647053 => 19:44:02.647053
[0m19:44:02.649062 [debug] [Thread-1 (]: Finished running node test.dbt_idx.source_relationships_IDX-Schema_orders_cust_id__customer_id__source_IDX_Schema_customers_.dc582657bc
[0m19:44:02.649062 [debug] [Thread-1 (]: Began running node test.dbt_idx.source_unique_IDX-Schema_ksql-company-stream_id.09232074f4
[0m19:44:02.650063 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_idx.source_relationships_IDX-Schema_orders_cust_id__customer_id__source_IDX_Schema_customers_.dc582657bc, now test.dbt_idx.source_unique_IDX-Schema_ksql-company-stream_id.09232074f4)
[0m19:44:02.651060 [debug] [Thread-1 (]: Began compiling node test.dbt_idx.source_unique_IDX-Schema_ksql-company-stream_id.09232074f4
[0m19:44:02.658599 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_idx.source_unique_IDX-Schema_ksql-company-stream_id.09232074f4"
[0m19:44:02.664602 [debug] [Thread-1 (]: Timing info for test.dbt_idx.source_unique_IDX-Schema_ksql-company-stream_id.09232074f4 (compile): 19:44:02.652592 => 19:44:02.664602
[0m19:44:02.665600 [debug] [Thread-1 (]: Began executing node test.dbt_idx.source_unique_IDX-Schema_ksql-company-stream_id.09232074f4
[0m19:44:02.667599 [debug] [Thread-1 (]: Timing info for test.dbt_idx.source_unique_IDX-Schema_ksql-company-stream_id.09232074f4 (execute): 19:44:02.667599 => 19:44:02.667599
[0m19:44:02.668600 [debug] [Thread-1 (]: Finished running node test.dbt_idx.source_unique_IDX-Schema_ksql-company-stream_id.09232074f4
[0m19:44:02.669603 [debug] [Thread-1 (]: Began running node test.dbt_idx.source_unique_IDX-Schema_ksql-stock-stream_id.2119c5c33b
[0m19:44:02.670617 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_idx.source_unique_IDX-Schema_ksql-company-stream_id.09232074f4, now test.dbt_idx.source_unique_IDX-Schema_ksql-stock-stream_id.2119c5c33b)
[0m19:44:02.671617 [debug] [Thread-1 (]: Began compiling node test.dbt_idx.source_unique_IDX-Schema_ksql-stock-stream_id.2119c5c33b
[0m19:44:02.675559 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_idx.source_unique_IDX-Schema_ksql-stock-stream_id.2119c5c33b"
[0m19:44:02.682107 [debug] [Thread-1 (]: Timing info for test.dbt_idx.source_unique_IDX-Schema_ksql-stock-stream_id.2119c5c33b (compile): 19:44:02.671617 => 19:44:02.681094
[0m19:44:02.683115 [debug] [Thread-1 (]: Began executing node test.dbt_idx.source_unique_IDX-Schema_ksql-stock-stream_id.2119c5c33b
[0m19:44:02.684113 [debug] [Thread-1 (]: Timing info for test.dbt_idx.source_unique_IDX-Schema_ksql-stock-stream_id.2119c5c33b (execute): 19:44:02.683115 => 19:44:02.683115
[0m19:44:02.684864 [debug] [Thread-1 (]: Finished running node test.dbt_idx.source_unique_IDX-Schema_ksql-stock-stream_id.2119c5c33b
[0m19:44:02.685870 [debug] [Thread-1 (]: Began running node test.dbt_idx.source_unique_IDX-Schema_orders_order_id.5a8ef486ee
[0m19:44:02.686870 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_idx.source_unique_IDX-Schema_ksql-stock-stream_id.2119c5c33b, now test.dbt_idx.source_unique_IDX-Schema_orders_order_id.5a8ef486ee)
[0m19:44:02.687871 [debug] [Thread-1 (]: Began compiling node test.dbt_idx.source_unique_IDX-Schema_orders_order_id.5a8ef486ee
[0m19:44:02.691906 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_idx.source_unique_IDX-Schema_orders_order_id.5a8ef486ee"
[0m19:44:02.698389 [debug] [Thread-1 (]: Timing info for test.dbt_idx.source_unique_IDX-Schema_orders_order_id.5a8ef486ee (compile): 19:44:02.687871 => 19:44:02.698389
[0m19:44:02.699413 [debug] [Thread-1 (]: Began executing node test.dbt_idx.source_unique_IDX-Schema_orders_order_id.5a8ef486ee
[0m19:44:02.700426 [debug] [Thread-1 (]: Timing info for test.dbt_idx.source_unique_IDX-Schema_orders_order_id.5a8ef486ee (execute): 19:44:02.699413 => 19:44:02.699413
[0m19:44:02.701425 [debug] [Thread-1 (]: Finished running node test.dbt_idx.source_unique_IDX-Schema_orders_order_id.5a8ef486ee
[0m19:44:02.702387 [debug] [Thread-1 (]: Began running node test.dbt_idx.not_null_stg_eltool__company_id.632831b79c
[0m19:44:02.703388 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_idx.source_unique_IDX-Schema_orders_order_id.5a8ef486ee, now test.dbt_idx.not_null_stg_eltool__company_id.632831b79c)
[0m19:44:02.703388 [debug] [Thread-1 (]: Began compiling node test.dbt_idx.not_null_stg_eltool__company_id.632831b79c
[0m19:44:02.708413 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_idx.not_null_stg_eltool__company_id.632831b79c"
[0m19:44:02.715916 [debug] [Thread-1 (]: Timing info for test.dbt_idx.not_null_stg_eltool__company_id.632831b79c (compile): 19:44:02.704425 => 19:44:02.714932
[0m19:44:02.715916 [debug] [Thread-1 (]: Began executing node test.dbt_idx.not_null_stg_eltool__company_id.632831b79c
[0m19:44:02.716962 [debug] [Thread-1 (]: Timing info for test.dbt_idx.not_null_stg_eltool__company_id.632831b79c (execute): 19:44:02.716962 => 19:44:02.716962
[0m19:44:02.717957 [debug] [Thread-1 (]: Finished running node test.dbt_idx.not_null_stg_eltool__company_id.632831b79c
[0m19:44:02.718959 [debug] [Thread-1 (]: Began running node model.dbt_idx.fact_orders
[0m19:44:02.719938 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_idx.not_null_stg_eltool__company_id.632831b79c, now model.dbt_idx.fact_orders)
[0m19:44:02.720932 [debug] [Thread-1 (]: Began compiling node model.dbt_idx.fact_orders
[0m19:44:02.722958 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_idx.fact_orders"
[0m19:44:02.731470 [debug] [Thread-1 (]: Timing info for model.dbt_idx.fact_orders (compile): 19:44:02.721944 => 19:44:02.730470
[0m19:44:02.732471 [debug] [Thread-1 (]: Began executing node model.dbt_idx.fact_orders
[0m19:44:02.733471 [debug] [Thread-1 (]: Timing info for model.dbt_idx.fact_orders (execute): 19:44:02.732471 => 19:44:02.732471
[0m19:44:02.734497 [debug] [Thread-1 (]: Finished running node model.dbt_idx.fact_orders
[0m19:44:02.736473 [debug] [Thread-1 (]: Began running node model.dbt_idx.fact_stocks
[0m19:44:02.738484 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_idx.fact_orders, now model.dbt_idx.fact_stocks)
[0m19:44:02.739416 [debug] [Thread-1 (]: Began compiling node model.dbt_idx.fact_stocks
[0m19:44:02.743425 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_idx.fact_stocks"
[0m19:44:02.750733 [debug] [Thread-1 (]: Timing info for model.dbt_idx.fact_stocks (compile): 19:44:02.740428 => 19:44:02.749732
[0m19:44:02.751731 [debug] [Thread-1 (]: Began executing node model.dbt_idx.fact_stocks
[0m19:44:02.751731 [debug] [Thread-1 (]: Timing info for model.dbt_idx.fact_stocks (execute): 19:44:02.751731 => 19:44:02.751731
[0m19:44:02.753731 [debug] [Thread-1 (]: Finished running node model.dbt_idx.fact_stocks
[0m19:44:02.754731 [debug] [Thread-1 (]: Began running node test.dbt_idx.not_null_stg_eltool__stock_id.68f6d1d89a
[0m19:44:02.755731 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_idx.fact_stocks, now test.dbt_idx.not_null_stg_eltool__stock_id.68f6d1d89a)
[0m19:44:02.756732 [debug] [Thread-1 (]: Began compiling node test.dbt_idx.not_null_stg_eltool__stock_id.68f6d1d89a
[0m19:44:02.762728 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_idx.not_null_stg_eltool__stock_id.68f6d1d89a"
[0m19:44:02.769313 [debug] [Thread-1 (]: Timing info for test.dbt_idx.not_null_stg_eltool__stock_id.68f6d1d89a (compile): 19:44:02.757740 => 19:44:02.769313
[0m19:44:02.771321 [debug] [Thread-1 (]: Began executing node test.dbt_idx.not_null_stg_eltool__stock_id.68f6d1d89a
[0m19:44:02.772320 [debug] [Thread-1 (]: Timing info for test.dbt_idx.not_null_stg_eltool__stock_id.68f6d1d89a (execute): 19:44:02.771321 => 19:44:02.771321
[0m19:44:02.773321 [debug] [Thread-1 (]: Finished running node test.dbt_idx.not_null_stg_eltool__stock_id.68f6d1d89a
[0m19:44:02.774319 [debug] [Thread-1 (]: Began running node model.dbt_idx.stg_eltool__customers_snapshots
[0m19:44:02.777182 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_idx.not_null_stg_eltool__stock_id.68f6d1d89a, now model.dbt_idx.stg_eltool__customers_snapshots)
[0m19:44:02.778702 [debug] [Thread-1 (]: Began compiling node model.dbt_idx.stg_eltool__customers_snapshots
[0m19:44:02.785290 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_idx.stg_eltool__customers_snapshots"
[0m19:44:02.794441 [debug] [Thread-1 (]: Timing info for model.dbt_idx.stg_eltool__customers_snapshots (compile): 19:44:02.779704 => 19:44:02.793285
[0m19:44:02.795439 [debug] [Thread-1 (]: Began executing node model.dbt_idx.stg_eltool__customers_snapshots
[0m19:44:02.796446 [debug] [Thread-1 (]: Timing info for model.dbt_idx.stg_eltool__customers_snapshots (execute): 19:44:02.796446 => 19:44:02.796446
[0m19:44:02.798446 [debug] [Thread-1 (]: Finished running node model.dbt_idx.stg_eltool__customers_snapshots
[0m19:44:02.799445 [debug] [Thread-1 (]: Began running node model.dbt_idx.stock_update_status
[0m19:44:02.801483 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_idx.stg_eltool__customers_snapshots, now model.dbt_idx.stock_update_status)
[0m19:44:02.801483 [debug] [Thread-1 (]: Began compiling node model.dbt_idx.stock_update_status
[0m19:44:02.805445 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_idx.stock_update_status"
[0m19:44:02.814514 [debug] [Thread-1 (]: Timing info for model.dbt_idx.stock_update_status (compile): 19:44:02.802479 => 19:44:02.814514
[0m19:44:02.815535 [debug] [Thread-1 (]: Began executing node model.dbt_idx.stock_update_status
[0m19:44:02.816540 [debug] [Thread-1 (]: Timing info for model.dbt_idx.stock_update_status (execute): 19:44:02.816540 => 19:44:02.816540
[0m19:44:02.818560 [debug] [Thread-1 (]: Finished running node model.dbt_idx.stock_update_status
[0m19:44:02.819533 [debug] [Thread-1 (]: Began running node test.dbt_idx.assert_stock_dimension_has_no_row_loss.sql
[0m19:44:02.820537 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_idx.stock_update_status, now test.dbt_idx.assert_stock_dimension_has_no_row_loss.sql)
[0m19:44:02.822549 [debug] [Thread-1 (]: Began compiling node test.dbt_idx.assert_stock_dimension_has_no_row_loss.sql
[0m19:44:02.825552 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_idx.assert_stock_dimension_has_no_row_loss.sql"
[0m19:44:02.833562 [debug] [Thread-1 (]: Timing info for test.dbt_idx.assert_stock_dimension_has_no_row_loss.sql (compile): 19:44:02.822549 => 19:44:02.832560
[0m19:44:02.833562 [debug] [Thread-1 (]: Began executing node test.dbt_idx.assert_stock_dimension_has_no_row_loss.sql
[0m19:44:02.834534 [debug] [Thread-1 (]: Timing info for test.dbt_idx.assert_stock_dimension_has_no_row_loss.sql (execute): 19:44:02.834534 => 19:44:02.834534
[0m19:44:02.835561 [debug] [Thread-1 (]: Finished running node test.dbt_idx.assert_stock_dimension_has_no_row_loss.sql
[0m19:44:02.836545 [debug] [Thread-1 (]: Began running node test.dbt_idx.not_null_fact_stocks_id.e7b7e788fa
[0m19:44:02.840859 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_idx.assert_stock_dimension_has_no_row_loss.sql, now test.dbt_idx.not_null_fact_stocks_id.e7b7e788fa)
[0m19:44:02.841858 [debug] [Thread-1 (]: Began compiling node test.dbt_idx.not_null_fact_stocks_id.e7b7e788fa
[0m19:44:02.847866 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_idx.not_null_fact_stocks_id.e7b7e788fa"
[0m19:44:02.854884 [debug] [Thread-1 (]: Timing info for test.dbt_idx.not_null_fact_stocks_id.e7b7e788fa (compile): 19:44:02.842863 => 19:44:02.853882
[0m19:44:02.855858 [debug] [Thread-1 (]: Began executing node test.dbt_idx.not_null_fact_stocks_id.e7b7e788fa
[0m19:44:02.856883 [debug] [Thread-1 (]: Timing info for test.dbt_idx.not_null_fact_stocks_id.e7b7e788fa (execute): 19:44:02.855858 => 19:44:02.855858
[0m19:44:02.857887 [debug] [Thread-1 (]: Finished running node test.dbt_idx.not_null_fact_stocks_id.e7b7e788fa
[0m19:44:02.858420 [debug] [Thread-1 (]: Began running node model.dbt_idx.dim_customers
[0m19:44:02.859447 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_idx.not_null_fact_stocks_id.e7b7e788fa, now model.dbt_idx.dim_customers)
[0m19:44:02.860431 [debug] [Thread-1 (]: Began compiling node model.dbt_idx.dim_customers
[0m19:44:02.863432 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_idx.dim_customers"
[0m19:44:02.870427 [debug] [Thread-1 (]: Timing info for model.dbt_idx.dim_customers (compile): 19:44:02.860431 => 19:44:02.870427
[0m19:44:02.871426 [debug] [Thread-1 (]: Began executing node model.dbt_idx.dim_customers
[0m19:44:02.872428 [debug] [Thread-1 (]: Timing info for model.dbt_idx.dim_customers (execute): 19:44:02.872428 => 19:44:02.872428
[0m19:44:02.874449 [debug] [Thread-1 (]: Finished running node model.dbt_idx.dim_customers
[0m19:44:02.874449 [debug] [Thread-1 (]: Began running node test.dbt_idx.not_null_stg_eltool__customers_snapshots_customer_id.ea4fc4ca86
[0m19:44:02.876449 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_idx.dim_customers, now test.dbt_idx.not_null_stg_eltool__customers_snapshots_customer_id.ea4fc4ca86)
[0m19:44:02.876449 [debug] [Thread-1 (]: Began compiling node test.dbt_idx.not_null_stg_eltool__customers_snapshots_customer_id.ea4fc4ca86
[0m19:44:02.881993 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_idx.not_null_stg_eltool__customers_snapshots_customer_id.ea4fc4ca86"
[0m19:44:02.887981 [debug] [Thread-1 (]: Timing info for test.dbt_idx.not_null_stg_eltool__customers_snapshots_customer_id.ea4fc4ca86 (compile): 19:44:02.877960 => 19:44:02.886970
[0m19:44:02.888970 [debug] [Thread-1 (]: Began executing node test.dbt_idx.not_null_stg_eltool__customers_snapshots_customer_id.ea4fc4ca86
[0m19:44:02.889967 [debug] [Thread-1 (]: Timing info for test.dbt_idx.not_null_stg_eltool__customers_snapshots_customer_id.ea4fc4ca86 (execute): 19:44:02.888970 => 19:44:02.888970
[0m19:44:02.890997 [debug] [Thread-1 (]: Finished running node test.dbt_idx.not_null_stg_eltool__customers_snapshots_customer_id.ea4fc4ca86
[0m19:44:02.891970 [debug] [Thread-1 (]: Began running node test.dbt_idx.not_null_stock_update_status_id.633bc8afe3
[0m19:44:02.892995 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_idx.not_null_stg_eltool__customers_snapshots_customer_id.ea4fc4ca86, now test.dbt_idx.not_null_stock_update_status_id.633bc8afe3)
[0m19:44:02.893967 [debug] [Thread-1 (]: Began compiling node test.dbt_idx.not_null_stock_update_status_id.633bc8afe3
[0m19:44:02.899173 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_idx.not_null_stock_update_status_id.633bc8afe3"
[0m19:44:02.906198 [debug] [Thread-1 (]: Timing info for test.dbt_idx.not_null_stock_update_status_id.633bc8afe3 (compile): 19:44:02.893967 => 19:44:02.905198
[0m19:44:02.906198 [debug] [Thread-1 (]: Began executing node test.dbt_idx.not_null_stock_update_status_id.633bc8afe3
[0m19:44:02.907198 [debug] [Thread-1 (]: Timing info for test.dbt_idx.not_null_stock_update_status_id.633bc8afe3 (execute): 19:44:02.907198 => 19:44:02.907198
[0m19:44:02.908195 [debug] [Thread-1 (]: Finished running node test.dbt_idx.not_null_stock_update_status_id.633bc8afe3
[0m19:44:02.909194 [debug] [Thread-1 (]: Began running node model.dbt_idx.customer_orders_status
[0m19:44:02.910184 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_idx.not_null_stock_update_status_id.633bc8afe3, now model.dbt_idx.customer_orders_status)
[0m19:44:02.911213 [debug] [Thread-1 (]: Began compiling node model.dbt_idx.customer_orders_status
[0m19:44:02.914603 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_idx.customer_orders_status"
[0m19:44:02.921578 [debug] [Thread-1 (]: Timing info for model.dbt_idx.customer_orders_status (compile): 19:44:02.912362 => 19:44:02.920578
[0m19:44:02.922578 [debug] [Thread-1 (]: Began executing node model.dbt_idx.customer_orders_status
[0m19:44:02.923439 [debug] [Thread-1 (]: Timing info for model.dbt_idx.customer_orders_status (execute): 19:44:02.922578 => 19:44:02.922578
[0m19:44:02.924606 [debug] [Thread-1 (]: Finished running node model.dbt_idx.customer_orders_status
[0m19:44:02.924606 [debug] [Thread-1 (]: Began running node test.dbt_idx.assert_customer_fact_has_no_row_loss.sql
[0m19:44:02.926576 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_idx.customer_orders_status, now test.dbt_idx.assert_customer_fact_has_no_row_loss.sql)
[0m19:44:02.927578 [debug] [Thread-1 (]: Began compiling node test.dbt_idx.assert_customer_fact_has_no_row_loss.sql
[0m19:44:02.931582 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_idx.assert_customer_fact_has_no_row_loss.sql"
[0m19:44:02.939109 [debug] [Thread-1 (]: Timing info for test.dbt_idx.assert_customer_fact_has_no_row_loss.sql (compile): 19:44:02.927578 => 19:44:02.938110
[0m19:44:02.940110 [debug] [Thread-1 (]: Began executing node test.dbt_idx.assert_customer_fact_has_no_row_loss.sql
[0m19:44:02.941108 [debug] [Thread-1 (]: Timing info for test.dbt_idx.assert_customer_fact_has_no_row_loss.sql (execute): 19:44:02.940110 => 19:44:02.940110
[0m19:44:02.942108 [debug] [Thread-1 (]: Finished running node test.dbt_idx.assert_customer_fact_has_no_row_loss.sql
[0m19:44:02.943120 [debug] [Thread-1 (]: Began running node test.dbt_idx.not_null_dim_customers_customer_id.dd91cd1c8d
[0m19:44:02.944107 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_idx.assert_customer_fact_has_no_row_loss.sql, now test.dbt_idx.not_null_dim_customers_customer_id.dd91cd1c8d)
[0m19:44:02.945108 [debug] [Thread-1 (]: Began compiling node test.dbt_idx.not_null_dim_customers_customer_id.dd91cd1c8d
[0m19:44:02.955653 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_idx.not_null_dim_customers_customer_id.dd91cd1c8d"
[0m19:44:02.967154 [debug] [Thread-1 (]: Timing info for test.dbt_idx.not_null_dim_customers_customer_id.dd91cd1c8d (compile): 19:44:02.945108 => 19:44:02.966151
[0m19:44:02.969165 [debug] [Thread-1 (]: Began executing node test.dbt_idx.not_null_dim_customers_customer_id.dd91cd1c8d
[0m19:44:02.971679 [debug] [Thread-1 (]: Timing info for test.dbt_idx.not_null_dim_customers_customer_id.dd91cd1c8d (execute): 19:44:02.971679 => 19:44:02.971679
[0m19:44:02.976199 [debug] [Thread-1 (]: Finished running node test.dbt_idx.not_null_dim_customers_customer_id.dd91cd1c8d
[0m19:44:02.979222 [debug] [Thread-1 (]: Began running node test.dbt_idx.accepted_values_customer_orders_status_order_status__delivered__invoiced__shipped__processing__canceled__unavailable.ea8c296d27
[0m19:44:02.980214 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_idx.not_null_dim_customers_customer_id.dd91cd1c8d, now test.dbt_idx.accepted_values_customer_orders_status_order_status__delivered__invoiced__shipped__processing__canceled__unavailable.ea8c296d27)
[0m19:44:02.981213 [debug] [Thread-1 (]: Began compiling node test.dbt_idx.accepted_values_customer_orders_status_order_status__delivered__invoiced__shipped__processing__canceled__unavailable.ea8c296d27
[0m19:44:02.997347 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_idx.accepted_values_customer_orders_status_order_status__delivered__invoiced__shipped__processing__canceled__unavailable.ea8c296d27"
[0m19:44:03.004889 [debug] [Thread-1 (]: Timing info for test.dbt_idx.accepted_values_customer_orders_status_order_status__delivered__invoiced__shipped__processing__canceled__unavailable.ea8c296d27 (compile): 19:44:02.982212 => 19:44:03.004889
[0m19:44:03.006883 [debug] [Thread-1 (]: Began executing node test.dbt_idx.accepted_values_customer_orders_status_order_status__delivered__invoiced__shipped__processing__canceled__unavailable.ea8c296d27
[0m19:44:03.007901 [debug] [Thread-1 (]: Timing info for test.dbt_idx.accepted_values_customer_orders_status_order_status__delivered__invoiced__shipped__processing__canceled__unavailable.ea8c296d27 (execute): 19:44:03.007901 => 19:44:03.007901
[0m19:44:03.009887 [debug] [Thread-1 (]: Finished running node test.dbt_idx.accepted_values_customer_orders_status_order_status__delivered__invoiced__shipped__processing__canceled__unavailable.ea8c296d27
[0m19:44:03.011493 [debug] [Thread-1 (]: Began running node test.dbt_idx.not_null_customer_orders_status_customer_id.3915c814eb
[0m19:44:03.013932 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_idx.accepted_values_customer_orders_status_order_status__delivered__invoiced__shipped__processing__canceled__unavailable.ea8c296d27, now test.dbt_idx.not_null_customer_orders_status_customer_id.3915c814eb)
[0m19:44:03.015460 [debug] [Thread-1 (]: Began compiling node test.dbt_idx.not_null_customer_orders_status_customer_id.3915c814eb
[0m19:44:03.026014 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_idx.not_null_customer_orders_status_customer_id.3915c814eb"
[0m19:44:03.034523 [debug] [Thread-1 (]: Timing info for test.dbt_idx.not_null_customer_orders_status_customer_id.3915c814eb (compile): 19:44:03.016471 => 19:44:03.033515
[0m19:44:03.034523 [debug] [Thread-1 (]: Began executing node test.dbt_idx.not_null_customer_orders_status_customer_id.3915c814eb
[0m19:44:03.037384 [debug] [Thread-1 (]: Timing info for test.dbt_idx.not_null_customer_orders_status_customer_id.3915c814eb (execute): 19:44:03.036369 => 19:44:03.036369
[0m19:44:03.039384 [debug] [Thread-1 (]: Finished running node test.dbt_idx.not_null_customer_orders_status_customer_id.3915c814eb
[0m19:44:03.040384 [debug] [Thread-1 (]: Began running node test.dbt_idx.unique_customer_orders_status_order_id.b7a45e83ee
[0m19:44:03.042389 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_idx.not_null_customer_orders_status_customer_id.3915c814eb, now test.dbt_idx.unique_customer_orders_status_order_id.b7a45e83ee)
[0m19:44:03.043382 [debug] [Thread-1 (]: Began compiling node test.dbt_idx.unique_customer_orders_status_order_id.b7a45e83ee
[0m19:44:03.048411 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_idx.unique_customer_orders_status_order_id.b7a45e83ee"
[0m19:44:03.055968 [debug] [Thread-1 (]: Timing info for test.dbt_idx.unique_customer_orders_status_order_id.b7a45e83ee (compile): 19:44:03.043382 => 19:44:03.055968
[0m19:44:03.057977 [debug] [Thread-1 (]: Began executing node test.dbt_idx.unique_customer_orders_status_order_id.b7a45e83ee
[0m19:44:03.058983 [debug] [Thread-1 (]: Timing info for test.dbt_idx.unique_customer_orders_status_order_id.b7a45e83ee (execute): 19:44:03.058983 => 19:44:03.058983
[0m19:44:03.060978 [debug] [Thread-1 (]: Finished running node test.dbt_idx.unique_customer_orders_status_order_id.b7a45e83ee
[0m19:44:03.062985 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:44:03.063983 [debug] [MainThread]: Connection 'list_IDX-Stock_IDX-Schema' was properly closed.
[0m19:44:03.063983 [debug] [MainThread]: Connection 'test.dbt_idx.unique_customer_orders_status_order_id.b7a45e83ee' was properly closed.
[0m19:44:03.072003 [debug] [MainThread]: Command end result
[0m19:44:03.586784 [debug] [MainThread]: Acquiring new postgres connection 'generate_catalog'
[0m19:44:03.587785 [info ] [MainThread]: Building catalog
[0m19:44:03.595782 [debug] [ThreadPool]: Acquiring new postgres connection 'IDX-Stock.information_schema'
[0m19:44:03.611319 [debug] [ThreadPool]: Using postgres connection "IDX-Stock.information_schema"
[0m19:44:03.612318 [debug] [ThreadPool]: On IDX-Stock.information_schema: BEGIN
[0m19:44:03.613992 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:44:03.643693 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m19:44:03.645271 [debug] [ThreadPool]: Using postgres connection "IDX-Stock.information_schema"
[0m19:44:03.647279 [debug] [ThreadPool]: On IDX-Stock.information_schema: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "connection_name": "IDX-Stock.information_schema"} */

    
    

    select
        'IDX-Stock' as table_database,
        sch.nspname as table_schema,
        tbl.relname as table_name,
        case tbl.relkind
            when 'v' then 'VIEW'
            else 'BASE TABLE'
        end as table_type,
        tbl_desc.description as table_comment,
        col.attname as column_name,
        col.attnum as column_index,
        pg_catalog.format_type(col.atttypid, col.atttypmod) as column_type,
        col_desc.description as column_comment,
        pg_get_userbyid(tbl.relowner) as table_owner

    from pg_catalog.pg_namespace sch
    join pg_catalog.pg_class tbl on tbl.relnamespace = sch.oid
    join pg_catalog.pg_attribute col on col.attrelid = tbl.oid
    left outer join pg_catalog.pg_description tbl_desc on (tbl_desc.objoid = tbl.oid and tbl_desc.objsubid = 0)
    left outer join pg_catalog.pg_description col_desc on (col_desc.objoid = tbl.oid and col_desc.objsubid = col.attnum)

    where (upper(sch.nspname) = upper('idx-schema') or upper(sch.nspname) = upper('snapshots'))
      and not pg_is_other_temp_schema(sch.oid) -- not a temporary schema belonging to another session
      and tbl.relpersistence in ('p', 'u') -- [p]ermanent table or [u]nlogged table. Exclude [t]emporary tables
      and tbl.relkind in ('r', 'v', 'f', 'p') -- o[r]dinary table, [v]iew, [f]oreign table, [p]artitioned table. Other values are [i]ndex, [S]equence, [c]omposite type, [t]OAST table, [m]aterialized view
      and col.attnum > 0 -- negative numbers are used for system columns such as oid
      and not col.attisdropped -- column as not been dropped

    order by
        sch.nspname,
        tbl.relname,
        col.attnum
[0m19:44:03.657329 [debug] [ThreadPool]: SQL status: SELECT 130 in 0.0 seconds
[0m19:44:03.671405 [debug] [ThreadPool]: On IDX-Stock.information_schema: ROLLBACK
[0m19:44:03.674404 [debug] [ThreadPool]: On IDX-Stock.information_schema: Close
[0m19:44:03.736544 [info ] [MainThread]: Catalog written to D:\00 Project\00 My Project\IdeaProjects\Py-DBT-IDX\target\catalog.json
[0m19:44:03.739549 [debug] [MainThread]: Command `dbt docs generate` succeeded at 19:44:03.738541 after 2.05 seconds
[0m19:44:03.740545 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
[0m19:44:03.741543 [debug] [MainThread]: Connection 'IDX-Stock.information_schema' was properly closed.
[0m19:44:03.741543 [debug] [MainThread]: Flushing usage events


============================== 19:44:10.500262 | 3c5b62a3-313a-4305-9823-1a1705550670 ==============================
[0m19:44:10.500262 [info ] [MainThread]: Running with dbt=1.6.1
[0m19:44:10.506694 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'D:\\00 Project\\00 My Project\\IdeaProjects\\Py-DBT-IDX', 'version_check': 'True', 'warn_error': 'None', 'log_path': 'D:\\00 Project\\00 My Project\\IdeaProjects\\Py-DBT-IDX\\logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt docs serve', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'False'}
[0m19:45:05.747352 [error] [MainThread]: Encountered an error:

[0m19:45:05.754182 [error] [MainThread]: Traceback (most recent call last):
  File "C:\Users\dmitr\Py-DBT-IDX\Lib\site-packages\dbt\cli\requires.py", line 87, in wrapper
    result, success = func(*args, **kwargs)
                      ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\dmitr\Py-DBT-IDX\Lib\site-packages\dbt\cli\requires.py", line 72, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\dmitr\Py-DBT-IDX\Lib\site-packages\dbt\cli\requires.py", line 143, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\dmitr\Py-DBT-IDX\Lib\site-packages\dbt\cli\requires.py", line 172, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\dmitr\Py-DBT-IDX\Lib\site-packages\dbt\cli\requires.py", line 219, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\dmitr\Py-DBT-IDX\Lib\site-packages\dbt\cli\main.py", line 307, in docs_serve
    results = task.run()
              ^^^^^^^^^^
  File "C:\Users\dmitr\Py-DBT-IDX\Lib\site-packages\dbt\task\serve.py", line 28, in run
    httpd.serve_forever()
  File "C:\Python311\Lib\socketserver.py", line 233, in serve_forever
    ready = selector.select(poll_interval)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Python311\Lib\selectors.py", line 323, in select
    r, w, _ = self._select(self._readers, self._writers, [], timeout)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Python311\Lib\selectors.py", line 314, in _select
    r, w, x = select.select(r, w, w, timeout)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
KeyboardInterrupt

[0m19:45:05.757186 [debug] [MainThread]: Command `dbt docs serve` failed at 19:45:05.756186 after 55.30 seconds
[0m19:45:05.758509 [debug] [MainThread]: Flushing usage events


============================== 19:45:14.157858 | 11d94d28-73cb-4c85-9b2f-57adde409a24 ==============================
[0m19:45:14.157858 [info ] [MainThread]: Running with dbt=1.6.1
[0m19:45:14.166856 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'D:\\00 Project\\00 My Project\\IdeaProjects\\Py-DBT-IDX\\logs', 'debug': 'False', 'profiles_dir': 'D:\\00 Project\\00 My Project\\IdeaProjects\\Py-DBT-IDX', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt test', 'send_anonymous_usage_stats': 'False'}
[0m19:45:14.375400 [info ] [MainThread]: Registered adapter: postgres=1.6.1
[0m19:45:14.390925 [debug] [MainThread]: checksum: efe19d9f5b93d1a98cc804fbfcdb6b3aced98b974af664946fee1cde8837deb7, vars: {}, profile: , target: , version: 1.6.1
[0m19:45:14.596215 [debug] [MainThread]: Partial parsing enabled: 2 files deleted, 2 files added, 0 files changed.
[0m19:45:14.598630 [debug] [MainThread]: Partial parsing: added file: dbt_idx://tests\assert_customer_dimension_has_no_row_loss.sql.sql
[0m19:45:14.599629 [debug] [MainThread]: Partial parsing: added file: dbt_idx://tests\assert_stock_fact_has_no_row_loss.sql.sql
[0m19:45:14.601628 [debug] [MainThread]: Partial parsing: deleted file: dbt_idx://tests\assert_stock_dimension_has_no_row_loss.sql.sql
[0m19:45:14.602611 [debug] [MainThread]: Partial parsing: deleted file: dbt_idx://tests\assert_customer_fact_has_no_row_loss.sql.sql
[0m19:45:14.784843 [info ] [MainThread]: Found 11 models, 1 snapshot, 19 tests, 5 sources, 0 exposures, 0 metrics, 349 macros, 0 groups, 0 semantic models
[0m19:45:14.793346 [info ] [MainThread]: 
[0m19:45:14.796317 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m19:45:14.806843 [debug] [ThreadPool]: Acquiring new postgres connection 'list_IDX-Stock_snapshots'
[0m19:45:14.828768 [debug] [ThreadPool]: Using postgres connection "list_IDX-Stock_snapshots"
[0m19:45:14.829772 [debug] [ThreadPool]: On list_IDX-Stock_snapshots: BEGIN
[0m19:45:14.831281 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:45:14.875921 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m19:45:14.876922 [debug] [ThreadPool]: Using postgres connection "list_IDX-Stock_snapshots"
[0m19:45:14.877922 [debug] [ThreadPool]: On list_IDX-Stock_snapshots: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "connection_name": "list_IDX-Stock_snapshots"} */
select
      'IDX-Stock' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'snapshots'
    union all
    select
      'IDX-Stock' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'snapshots'
    union all
    select
      'IDX-Stock' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'snapshots'
  
[0m19:45:14.883446 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.0 seconds
[0m19:45:14.886966 [debug] [ThreadPool]: On list_IDX-Stock_snapshots: ROLLBACK
[0m19:45:14.890792 [debug] [ThreadPool]: On list_IDX-Stock_snapshots: Close
[0m19:45:14.893730 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_IDX-Stock_snapshots, now list_IDX-Stock_IDX-Schema)
[0m19:45:14.899032 [debug] [ThreadPool]: Using postgres connection "list_IDX-Stock_IDX-Schema"
[0m19:45:14.900040 [debug] [ThreadPool]: On list_IDX-Stock_IDX-Schema: BEGIN
[0m19:45:14.900548 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:45:14.924857 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m19:45:14.925852 [debug] [ThreadPool]: Using postgres connection "list_IDX-Stock_IDX-Schema"
[0m19:45:14.926852 [debug] [ThreadPool]: On list_IDX-Stock_IDX-Schema: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "connection_name": "list_IDX-Stock_IDX-Schema"} */
select
      'IDX-Stock' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'IDX-Schema'
    union all
    select
      'IDX-Stock' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'IDX-Schema'
    union all
    select
      'IDX-Stock' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'IDX-Schema'
  
[0m19:45:14.932814 [debug] [ThreadPool]: SQL status: SELECT 17 in 0.0 seconds
[0m19:45:14.934382 [debug] [ThreadPool]: On list_IDX-Stock_IDX-Schema: ROLLBACK
[0m19:45:14.937398 [debug] [ThreadPool]: On list_IDX-Stock_IDX-Schema: Close
[0m19:45:14.949952 [debug] [MainThread]: Using postgres connection "master"
[0m19:45:14.950938 [debug] [MainThread]: On master: BEGIN
[0m19:45:14.951073 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:45:14.975479 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m19:45:14.976476 [debug] [MainThread]: Using postgres connection "master"
[0m19:45:14.977477 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m19:45:14.989800 [debug] [MainThread]: SQL status: SELECT 9 in 0.0 seconds
[0m19:45:14.993796 [debug] [MainThread]: On master: ROLLBACK
[0m19:45:14.995800 [debug] [MainThread]: Using postgres connection "master"
[0m19:45:14.996800 [debug] [MainThread]: On master: BEGIN
[0m19:45:15.001183 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m19:45:15.002210 [debug] [MainThread]: On master: COMMIT
[0m19:45:15.004194 [debug] [MainThread]: Using postgres connection "master"
[0m19:45:15.005224 [debug] [MainThread]: On master: COMMIT
[0m19:45:15.008201 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m19:45:15.009192 [debug] [MainThread]: On master: Close
[0m19:45:15.011195 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m19:45:15.013195 [info ] [MainThread]: 
[0m19:45:15.020767 [debug] [Thread-1 (]: Began running node test.dbt_idx.accepted_values_customer_orders_status_order_status__delivered__invoiced__shipped__processing__canceled__unavailable.ea8c296d27
[0m19:45:15.022766 [info ] [Thread-1 (]: 1 of 19 START test accepted_values_customer_orders_status_order_status__delivered__invoiced__shipped__processing__canceled__unavailable  [RUN]
[0m19:45:15.024788 [debug] [Thread-1 (]: Acquiring new postgres connection 'test.dbt_idx.accepted_values_customer_orders_status_order_status__delivered__invoiced__shipped__processing__canceled__unavailable.ea8c296d27'
[0m19:45:15.025786 [debug] [Thread-1 (]: Began compiling node test.dbt_idx.accepted_values_customer_orders_status_order_status__delivered__invoiced__shipped__processing__canceled__unavailable.ea8c296d27
[0m19:45:15.055533 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_idx.accepted_values_customer_orders_status_order_status__delivered__invoiced__shipped__processing__canceled__unavailable.ea8c296d27"
[0m19:45:15.064535 [debug] [Thread-1 (]: Timing info for test.dbt_idx.accepted_values_customer_orders_status_order_status__delivered__invoiced__shipped__processing__canceled__unavailable.ea8c296d27 (compile): 19:45:15.027797 => 19:45:15.063533
[0m19:45:15.065576 [debug] [Thread-1 (]: Began executing node test.dbt_idx.accepted_values_customer_orders_status_order_status__delivered__invoiced__shipped__processing__canceled__unavailable.ea8c296d27
[0m19:45:15.087543 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_idx.accepted_values_customer_orders_status_order_status__delivered__invoiced__shipped__processing__canceled__unavailable.ea8c296d27"
[0m19:45:15.098253 [debug] [Thread-1 (]: Using postgres connection "test.dbt_idx.accepted_values_customer_orders_status_order_status__delivered__invoiced__shipped__processing__canceled__unavailable.ea8c296d27"
[0m19:45:15.099267 [debug] [Thread-1 (]: On test.dbt_idx.accepted_values_customer_orders_status_order_status__delivered__invoiced__shipped__processing__canceled__unavailable.ea8c296d27: BEGIN
[0m19:45:15.100264 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m19:45:15.127917 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m19:45:15.128918 [debug] [Thread-1 (]: Using postgres connection "test.dbt_idx.accepted_values_customer_orders_status_order_status__delivered__invoiced__shipped__processing__canceled__unavailable.ea8c296d27"
[0m19:45:15.129915 [debug] [Thread-1 (]: On test.dbt_idx.accepted_values_customer_orders_status_order_status__delivered__invoiced__shipped__processing__canceled__unavailable.ea8c296d27: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "test.dbt_idx.accepted_values_customer_orders_status_order_status__delivered__invoiced__shipped__processing__canceled__unavailable.ea8c296d27"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        order_status as value_field,
        count(*) as n_records

    from "IDX-Stock"."IDX-Schema"."customer_orders_status"
    group by order_status

)

select *
from all_values
where value_field not in (
    'delivered','invoiced','shipped','processing','canceled','unavailable'
)



      
    ) dbt_internal_test
[0m19:45:15.137004 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m19:45:15.141006 [debug] [Thread-1 (]: Timing info for test.dbt_idx.accepted_values_customer_orders_status_order_status__delivered__invoiced__shipped__processing__canceled__unavailable.ea8c296d27 (execute): 19:45:15.066330 => 19:45:15.141006
[0m19:45:15.142007 [debug] [Thread-1 (]: On test.dbt_idx.accepted_values_customer_orders_status_order_status__delivered__invoiced__shipped__processing__canceled__unavailable.ea8c296d27: ROLLBACK
[0m19:45:15.145004 [debug] [Thread-1 (]: On test.dbt_idx.accepted_values_customer_orders_status_order_status__delivered__invoiced__shipped__processing__canceled__unavailable.ea8c296d27: Close
[0m19:45:15.148002 [info ] [Thread-1 (]: 1 of 19 PASS accepted_values_customer_orders_status_order_status__delivered__invoiced__shipped__processing__canceled__unavailable  [[32mPASS[0m in 0.12s]
[0m19:45:15.150140 [debug] [Thread-1 (]: Finished running node test.dbt_idx.accepted_values_customer_orders_status_order_status__delivered__invoiced__shipped__processing__canceled__unavailable.ea8c296d27
[0m19:45:15.151138 [debug] [Thread-1 (]: Began running node test.dbt_idx.assert_customer_dimension_has_no_row_loss.sql
[0m19:45:15.153142 [info ] [Thread-1 (]: 2 of 19 START test assert_customer_dimension_has_no_row_loss.sql ............... [RUN]
[0m19:45:15.155660 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_idx.accepted_values_customer_orders_status_order_status__delivered__invoiced__shipped__processing__canceled__unavailable.ea8c296d27, now test.dbt_idx.assert_customer_dimension_has_no_row_loss.sql)
[0m19:45:15.156666 [debug] [Thread-1 (]: Began compiling node test.dbt_idx.assert_customer_dimension_has_no_row_loss.sql
[0m19:45:15.160693 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_idx.assert_customer_dimension_has_no_row_loss.sql"
[0m19:45:15.171763 [debug] [Thread-1 (]: Timing info for test.dbt_idx.assert_customer_dimension_has_no_row_loss.sql (compile): 19:45:15.157691 => 19:45:15.170777
[0m19:45:15.172784 [debug] [Thread-1 (]: Began executing node test.dbt_idx.assert_customer_dimension_has_no_row_loss.sql
[0m19:45:15.176796 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_idx.assert_customer_dimension_has_no_row_loss.sql"
[0m19:45:15.185282 [debug] [Thread-1 (]: Using postgres connection "test.dbt_idx.assert_customer_dimension_has_no_row_loss.sql"
[0m19:45:15.186821 [debug] [Thread-1 (]: On test.dbt_idx.assert_customer_dimension_has_no_row_loss.sql: BEGIN
[0m19:45:15.187820 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:45:15.213146 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m19:45:15.214653 [debug] [Thread-1 (]: Using postgres connection "test.dbt_idx.assert_customer_dimension_has_no_row_loss.sql"
[0m19:45:15.215662 [debug] [Thread-1 (]: On test.dbt_idx.assert_customer_dimension_has_no_row_loss.sql: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "test.dbt_idx.assert_customer_dimension_has_no_row_loss.sql"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      -- dim_customers must have the same number of rows as its staging counterpart
-- Therefore return records where this isn't true to make the test fail
select *
from (
    select dim_cust.customer_id
    from "IDX-Stock"."IDX-Schema"."dim_customers" dim_cust
        left join "IDX-Stock"."IDX-Schema"."stg_eltool__customers_snapshots" stg_cust
    on dim_cust.customer_id = stg_cust.customer_id
    where stg_cust.customer_id is null
    UNION ALL
    select stg_cust.customer_id
    from "IDX-Stock"."IDX-Schema"."stg_eltool__customers_snapshots" stg_cust
      left join "IDX-Stock"."IDX-Schema"."dim_customers" dim_cust
    on stg_cust.customer_id = dim_cust.customer_id
    where dim_cust.customer_id is null
) tmp
      
    ) dbt_internal_test
[0m19:45:15.223659 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m19:45:15.227263 [debug] [Thread-1 (]: Timing info for test.dbt_idx.assert_customer_dimension_has_no_row_loss.sql (execute): 19:45:15.173762 => 19:45:15.226254
[0m19:45:15.228262 [debug] [Thread-1 (]: On test.dbt_idx.assert_customer_dimension_has_no_row_loss.sql: ROLLBACK
[0m19:45:15.232296 [debug] [Thread-1 (]: On test.dbt_idx.assert_customer_dimension_has_no_row_loss.sql: Close
[0m19:45:15.234297 [info ] [Thread-1 (]: 2 of 19 PASS assert_customer_dimension_has_no_row_loss.sql ..................... [[32mPASS[0m in 0.08s]
[0m19:45:15.236289 [debug] [Thread-1 (]: Finished running node test.dbt_idx.assert_customer_dimension_has_no_row_loss.sql
[0m19:45:15.238303 [debug] [Thread-1 (]: Began running node test.dbt_idx.assert_stock_fact_has_no_row_loss.sql
[0m19:45:15.239294 [info ] [Thread-1 (]: 3 of 19 START test assert_stock_fact_has_no_row_loss.sql ....................... [RUN]
[0m19:45:15.241293 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_idx.assert_customer_dimension_has_no_row_loss.sql, now test.dbt_idx.assert_stock_fact_has_no_row_loss.sql)
[0m19:45:15.242289 [debug] [Thread-1 (]: Began compiling node test.dbt_idx.assert_stock_fact_has_no_row_loss.sql
[0m19:45:15.247832 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_idx.assert_stock_fact_has_no_row_loss.sql"
[0m19:45:15.253844 [debug] [Thread-1 (]: Timing info for test.dbt_idx.assert_stock_fact_has_no_row_loss.sql (compile): 19:45:15.242289 => 19:45:15.252877
[0m19:45:15.255847 [debug] [Thread-1 (]: Began executing node test.dbt_idx.assert_stock_fact_has_no_row_loss.sql
[0m19:45:15.259875 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_idx.assert_stock_fact_has_no_row_loss.sql"
[0m19:45:15.265382 [debug] [Thread-1 (]: Using postgres connection "test.dbt_idx.assert_stock_fact_has_no_row_loss.sql"
[0m19:45:15.267391 [debug] [Thread-1 (]: On test.dbt_idx.assert_stock_fact_has_no_row_loss.sql: BEGIN
[0m19:45:15.268409 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:45:15.294693 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m19:45:15.296692 [debug] [Thread-1 (]: Using postgres connection "test.dbt_idx.assert_stock_fact_has_no_row_loss.sql"
[0m19:45:15.297691 [debug] [Thread-1 (]: On test.dbt_idx.assert_stock_fact_has_no_row_loss.sql: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "test.dbt_idx.assert_stock_fact_has_no_row_loss.sql"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      -- fact_stocks must have the same number of rows as its staging counterpart
-- Therefore return records where this isn't true to make the test fail
select *
from (
    select stock.id
    from "IDX-Stock"."IDX-Schema"."fact_stocks" stock
    where stock.id is null
) tmp
      
    ) dbt_internal_test
[0m19:45:15.304211 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m19:45:15.307240 [debug] [Thread-1 (]: Timing info for test.dbt_idx.assert_stock_fact_has_no_row_loss.sql (execute): 19:45:15.257878 => 19:45:15.306226
[0m19:45:15.308218 [debug] [Thread-1 (]: On test.dbt_idx.assert_stock_fact_has_no_row_loss.sql: ROLLBACK
[0m19:45:15.310204 [debug] [Thread-1 (]: On test.dbt_idx.assert_stock_fact_has_no_row_loss.sql: Close
[0m19:45:15.312220 [info ] [Thread-1 (]: 3 of 19 PASS assert_stock_fact_has_no_row_loss.sql ............................. [[32mPASS[0m in 0.07s]
[0m19:45:15.314207 [debug] [Thread-1 (]: Finished running node test.dbt_idx.assert_stock_fact_has_no_row_loss.sql
[0m19:45:15.315211 [debug] [Thread-1 (]: Began running node test.dbt_idx.not_null_customer_orders_status_customer_id.3915c814eb
[0m19:45:15.316236 [info ] [Thread-1 (]: 4 of 19 START test not_null_customer_orders_status_customer_id ................. [RUN]
[0m19:45:15.318238 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_idx.assert_stock_fact_has_no_row_loss.sql, now test.dbt_idx.not_null_customer_orders_status_customer_id.3915c814eb)
[0m19:45:15.318238 [debug] [Thread-1 (]: Began compiling node test.dbt_idx.not_null_customer_orders_status_customer_id.3915c814eb
[0m19:45:15.328254 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_idx.not_null_customer_orders_status_customer_id.3915c814eb"
[0m19:45:15.335299 [debug] [Thread-1 (]: Timing info for test.dbt_idx.not_null_customer_orders_status_customer_id.3915c814eb (compile): 19:45:15.319235 => 19:45:15.334300
[0m19:45:15.335299 [debug] [Thread-1 (]: Began executing node test.dbt_idx.not_null_customer_orders_status_customer_id.3915c814eb
[0m19:45:15.339301 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_idx.not_null_customer_orders_status_customer_id.3915c814eb"
[0m19:45:15.348326 [debug] [Thread-1 (]: Using postgres connection "test.dbt_idx.not_null_customer_orders_status_customer_id.3915c814eb"
[0m19:45:15.349301 [debug] [Thread-1 (]: On test.dbt_idx.not_null_customer_orders_status_customer_id.3915c814eb: BEGIN
[0m19:45:15.349301 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:45:15.372327 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m19:45:15.373355 [debug] [Thread-1 (]: Using postgres connection "test.dbt_idx.not_null_customer_orders_status_customer_id.3915c814eb"
[0m19:45:15.374349 [debug] [Thread-1 (]: On test.dbt_idx.not_null_customer_orders_status_customer_id.3915c814eb: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "test.dbt_idx.not_null_customer_orders_status_customer_id.3915c814eb"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select customer_id
from "IDX-Stock"."IDX-Schema"."customer_orders_status"
where customer_id is null



      
    ) dbt_internal_test
[0m19:45:15.378313 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m19:45:15.381349 [debug] [Thread-1 (]: Timing info for test.dbt_idx.not_null_customer_orders_status_customer_id.3915c814eb (execute): 19:45:15.336299 => 19:45:15.380314
[0m19:45:15.381349 [debug] [Thread-1 (]: On test.dbt_idx.not_null_customer_orders_status_customer_id.3915c814eb: ROLLBACK
[0m19:45:15.383910 [debug] [Thread-1 (]: On test.dbt_idx.not_null_customer_orders_status_customer_id.3915c814eb: Close
[0m19:45:15.385435 [info ] [Thread-1 (]: 4 of 19 PASS not_null_customer_orders_status_customer_id ....................... [[32mPASS[0m in 0.07s]
[0m19:45:15.388446 [debug] [Thread-1 (]: Finished running node test.dbt_idx.not_null_customer_orders_status_customer_id.3915c814eb
[0m19:45:15.390445 [debug] [Thread-1 (]: Began running node test.dbt_idx.not_null_dim_customers_customer_id.dd91cd1c8d
[0m19:45:15.390445 [info ] [Thread-1 (]: 5 of 19 START test not_null_dim_customers_customer_id .......................... [RUN]
[0m19:45:15.392442 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_idx.not_null_customer_orders_status_customer_id.3915c814eb, now test.dbt_idx.not_null_dim_customers_customer_id.dd91cd1c8d)
[0m19:45:15.392442 [debug] [Thread-1 (]: Began compiling node test.dbt_idx.not_null_dim_customers_customer_id.dd91cd1c8d
[0m19:45:15.399443 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_idx.not_null_dim_customers_customer_id.dd91cd1c8d"
[0m19:45:15.407450 [debug] [Thread-1 (]: Timing info for test.dbt_idx.not_null_dim_customers_customer_id.dd91cd1c8d (compile): 19:45:15.393442 => 19:45:15.407450
[0m19:45:15.408458 [debug] [Thread-1 (]: Began executing node test.dbt_idx.not_null_dim_customers_customer_id.dd91cd1c8d
[0m19:45:15.410440 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_idx.not_null_dim_customers_customer_id.dd91cd1c8d"
[0m19:45:15.418443 [debug] [Thread-1 (]: Using postgres connection "test.dbt_idx.not_null_dim_customers_customer_id.dd91cd1c8d"
[0m19:45:15.420443 [debug] [Thread-1 (]: On test.dbt_idx.not_null_dim_customers_customer_id.dd91cd1c8d: BEGIN
[0m19:45:15.421444 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:45:15.447850 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m19:45:15.448862 [debug] [Thread-1 (]: Using postgres connection "test.dbt_idx.not_null_dim_customers_customer_id.dd91cd1c8d"
[0m19:45:15.449878 [debug] [Thread-1 (]: On test.dbt_idx.not_null_dim_customers_customer_id.dd91cd1c8d: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "test.dbt_idx.not_null_dim_customers_customer_id.dd91cd1c8d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select customer_id
from "IDX-Stock"."IDX-Schema"."dim_customers"
where customer_id is null



      
    ) dbt_internal_test
[0m19:45:15.454845 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m19:45:15.457845 [debug] [Thread-1 (]: Timing info for test.dbt_idx.not_null_dim_customers_customer_id.dd91cd1c8d (execute): 19:45:15.408458 => 19:45:15.456847
[0m19:45:15.458848 [debug] [Thread-1 (]: On test.dbt_idx.not_null_dim_customers_customer_id.dd91cd1c8d: ROLLBACK
[0m19:45:15.460847 [debug] [Thread-1 (]: On test.dbt_idx.not_null_dim_customers_customer_id.dd91cd1c8d: Close
[0m19:45:15.463868 [info ] [Thread-1 (]: 5 of 19 PASS not_null_dim_customers_customer_id ................................ [[32mPASS[0m in 0.07s]
[0m19:45:15.466843 [debug] [Thread-1 (]: Finished running node test.dbt_idx.not_null_dim_customers_customer_id.dd91cd1c8d
[0m19:45:15.468846 [debug] [Thread-1 (]: Began running node test.dbt_idx.not_null_fact_stocks_id.e7b7e788fa
[0m19:45:15.470856 [info ] [Thread-1 (]: 6 of 19 START test not_null_fact_stocks_id ..................................... [RUN]
[0m19:45:15.472854 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_idx.not_null_dim_customers_customer_id.dd91cd1c8d, now test.dbt_idx.not_null_fact_stocks_id.e7b7e788fa)
[0m19:45:15.473850 [debug] [Thread-1 (]: Began compiling node test.dbt_idx.not_null_fact_stocks_id.e7b7e788fa
[0m19:45:15.480864 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_idx.not_null_fact_stocks_id.e7b7e788fa"
[0m19:45:15.489363 [debug] [Thread-1 (]: Timing info for test.dbt_idx.not_null_fact_stocks_id.e7b7e788fa (compile): 19:45:15.474865 => 19:45:15.488369
[0m19:45:15.490366 [debug] [Thread-1 (]: Began executing node test.dbt_idx.not_null_fact_stocks_id.e7b7e788fa
[0m19:45:15.494369 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_idx.not_null_fact_stocks_id.e7b7e788fa"
[0m19:45:15.504366 [debug] [Thread-1 (]: Using postgres connection "test.dbt_idx.not_null_fact_stocks_id.e7b7e788fa"
[0m19:45:15.506367 [debug] [Thread-1 (]: On test.dbt_idx.not_null_fact_stocks_id.e7b7e788fa: BEGIN
[0m19:45:15.507365 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:45:15.535520 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m19:45:15.536504 [debug] [Thread-1 (]: Using postgres connection "test.dbt_idx.not_null_fact_stocks_id.e7b7e788fa"
[0m19:45:15.538508 [debug] [Thread-1 (]: On test.dbt_idx.not_null_fact_stocks_id.e7b7e788fa: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "test.dbt_idx.not_null_fact_stocks_id.e7b7e788fa"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from "IDX-Stock"."IDX-Schema"."fact_stocks"
where id is null



      
    ) dbt_internal_test
[0m19:45:15.546504 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m19:45:15.548545 [debug] [Thread-1 (]: Timing info for test.dbt_idx.not_null_fact_stocks_id.e7b7e788fa (execute): 19:45:15.491374 => 19:45:15.548545
[0m19:45:15.549504 [debug] [Thread-1 (]: On test.dbt_idx.not_null_fact_stocks_id.e7b7e788fa: ROLLBACK
[0m19:45:15.551506 [debug] [Thread-1 (]: On test.dbt_idx.not_null_fact_stocks_id.e7b7e788fa: Close
[0m19:45:15.554509 [info ] [Thread-1 (]: 6 of 19 PASS not_null_fact_stocks_id ........................................... [[32mPASS[0m in 0.08s]
[0m19:45:15.557513 [debug] [Thread-1 (]: Finished running node test.dbt_idx.not_null_fact_stocks_id.e7b7e788fa
[0m19:45:15.559543 [debug] [Thread-1 (]: Began running node test.dbt_idx.not_null_stg_eltool__company_id.632831b79c
[0m19:45:15.561502 [info ] [Thread-1 (]: 7 of 19 START test not_null_stg_eltool__company_id ............................. [RUN]
[0m19:45:15.564509 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_idx.not_null_fact_stocks_id.e7b7e788fa, now test.dbt_idx.not_null_stg_eltool__company_id.632831b79c)
[0m19:45:15.565510 [debug] [Thread-1 (]: Began compiling node test.dbt_idx.not_null_stg_eltool__company_id.632831b79c
[0m19:45:15.573519 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_idx.not_null_stg_eltool__company_id.632831b79c"
[0m19:45:15.582522 [debug] [Thread-1 (]: Timing info for test.dbt_idx.not_null_stg_eltool__company_id.632831b79c (compile): 19:45:15.566504 => 19:45:15.581536
[0m19:45:15.584518 [debug] [Thread-1 (]: Began executing node test.dbt_idx.not_null_stg_eltool__company_id.632831b79c
[0m19:45:15.589629 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_idx.not_null_stg_eltool__company_id.632831b79c"
[0m19:45:15.599631 [debug] [Thread-1 (]: Using postgres connection "test.dbt_idx.not_null_stg_eltool__company_id.632831b79c"
[0m19:45:15.600629 [debug] [Thread-1 (]: On test.dbt_idx.not_null_stg_eltool__company_id.632831b79c: BEGIN
[0m19:45:15.601630 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:45:15.629373 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m19:45:15.630380 [debug] [Thread-1 (]: Using postgres connection "test.dbt_idx.not_null_stg_eltool__company_id.632831b79c"
[0m19:45:15.631374 [debug] [Thread-1 (]: On test.dbt_idx.not_null_stg_eltool__company_id.632831b79c: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "test.dbt_idx.not_null_stg_eltool__company_id.632831b79c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from "IDX-Stock"."IDX-Schema"."stg_eltool__company"
where id is null



      
    ) dbt_internal_test
[0m19:45:15.634415 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m19:45:15.637375 [debug] [Thread-1 (]: Timing info for test.dbt_idx.not_null_stg_eltool__company_id.632831b79c (execute): 19:45:15.585514 => 19:45:15.636394
[0m19:45:15.638376 [debug] [Thread-1 (]: On test.dbt_idx.not_null_stg_eltool__company_id.632831b79c: ROLLBACK
[0m19:45:15.642374 [debug] [Thread-1 (]: On test.dbt_idx.not_null_stg_eltool__company_id.632831b79c: Close
[0m19:45:15.645971 [info ] [Thread-1 (]: 7 of 19 PASS not_null_stg_eltool__company_id ................................... [[32mPASS[0m in 0.08s]
[0m19:45:15.649455 [debug] [Thread-1 (]: Finished running node test.dbt_idx.not_null_stg_eltool__company_id.632831b79c
[0m19:45:15.651730 [debug] [Thread-1 (]: Began running node test.dbt_idx.not_null_stg_eltool__customers_snapshots_customer_id.ea4fc4ca86
[0m19:45:15.653720 [info ] [Thread-1 (]: 8 of 19 START test not_null_stg_eltool__customers_snapshots_customer_id ........ [RUN]
[0m19:45:15.657036 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_idx.not_null_stg_eltool__company_id.632831b79c, now test.dbt_idx.not_null_stg_eltool__customers_snapshots_customer_id.ea4fc4ca86)
[0m19:45:15.658889 [debug] [Thread-1 (]: Began compiling node test.dbt_idx.not_null_stg_eltool__customers_snapshots_customer_id.ea4fc4ca86
[0m19:45:15.672035 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_idx.not_null_stg_eltool__customers_snapshots_customer_id.ea4fc4ca86"
[0m19:45:15.681494 [debug] [Thread-1 (]: Timing info for test.dbt_idx.not_null_stg_eltool__customers_snapshots_customer_id.ea4fc4ca86 (compile): 19:45:15.659888 => 19:45:15.681494
[0m19:45:15.683350 [debug] [Thread-1 (]: Began executing node test.dbt_idx.not_null_stg_eltool__customers_snapshots_customer_id.ea4fc4ca86
[0m19:45:15.688904 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_idx.not_null_stg_eltool__customers_snapshots_customer_id.ea4fc4ca86"
[0m19:45:15.699901 [debug] [Thread-1 (]: Using postgres connection "test.dbt_idx.not_null_stg_eltool__customers_snapshots_customer_id.ea4fc4ca86"
[0m19:45:15.701899 [debug] [Thread-1 (]: On test.dbt_idx.not_null_stg_eltool__customers_snapshots_customer_id.ea4fc4ca86: BEGIN
[0m19:45:15.703911 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:45:15.739519 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m19:45:15.740517 [debug] [Thread-1 (]: Using postgres connection "test.dbt_idx.not_null_stg_eltool__customers_snapshots_customer_id.ea4fc4ca86"
[0m19:45:15.741512 [debug] [Thread-1 (]: On test.dbt_idx.not_null_stg_eltool__customers_snapshots_customer_id.ea4fc4ca86: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "test.dbt_idx.not_null_stg_eltool__customers_snapshots_customer_id.ea4fc4ca86"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select customer_id
from "IDX-Stock"."IDX-Schema"."stg_eltool__customers_snapshots"
where customer_id is null



      
    ) dbt_internal_test
[0m19:45:15.745525 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m19:45:15.749756 [debug] [Thread-1 (]: Timing info for test.dbt_idx.not_null_stg_eltool__customers_snapshots_customer_id.ea4fc4ca86 (execute): 19:45:15.684361 => 19:45:15.749057
[0m19:45:15.751100 [debug] [Thread-1 (]: On test.dbt_idx.not_null_stg_eltool__customers_snapshots_customer_id.ea4fc4ca86: ROLLBACK
[0m19:45:15.754054 [debug] [Thread-1 (]: On test.dbt_idx.not_null_stg_eltool__customers_snapshots_customer_id.ea4fc4ca86: Close
[0m19:45:15.757401 [info ] [Thread-1 (]: 8 of 19 PASS not_null_stg_eltool__customers_snapshots_customer_id .............. [[32mPASS[0m in 0.10s]
[0m19:45:15.760617 [debug] [Thread-1 (]: Finished running node test.dbt_idx.not_null_stg_eltool__customers_snapshots_customer_id.ea4fc4ca86
[0m19:45:15.762632 [debug] [Thread-1 (]: Began running node test.dbt_idx.not_null_stg_eltool__stock_id.68f6d1d89a
[0m19:45:15.764807 [info ] [Thread-1 (]: 9 of 19 START test not_null_stg_eltool__stock_id ............................... [RUN]
[0m19:45:15.767565 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_idx.not_null_stg_eltool__customers_snapshots_customer_id.ea4fc4ca86, now test.dbt_idx.not_null_stg_eltool__stock_id.68f6d1d89a)
[0m19:45:15.769467 [debug] [Thread-1 (]: Began compiling node test.dbt_idx.not_null_stg_eltool__stock_id.68f6d1d89a
[0m19:45:15.782481 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_idx.not_null_stg_eltool__stock_id.68f6d1d89a"
[0m19:45:15.793683 [debug] [Thread-1 (]: Timing info for test.dbt_idx.not_null_stg_eltool__stock_id.68f6d1d89a (compile): 19:45:15.771199 => 19:45:15.792683
[0m19:45:15.794688 [debug] [Thread-1 (]: Began executing node test.dbt_idx.not_null_stg_eltool__stock_id.68f6d1d89a
[0m19:45:15.809626 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_idx.not_null_stg_eltool__stock_id.68f6d1d89a"
[0m19:45:15.819814 [debug] [Thread-1 (]: Using postgres connection "test.dbt_idx.not_null_stg_eltool__stock_id.68f6d1d89a"
[0m19:45:15.821814 [debug] [Thread-1 (]: On test.dbt_idx.not_null_stg_eltool__stock_id.68f6d1d89a: BEGIN
[0m19:45:15.823806 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:45:15.856119 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m19:45:15.857122 [debug] [Thread-1 (]: Using postgres connection "test.dbt_idx.not_null_stg_eltool__stock_id.68f6d1d89a"
[0m19:45:15.858373 [debug] [Thread-1 (]: On test.dbt_idx.not_null_stg_eltool__stock_id.68f6d1d89a: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "test.dbt_idx.not_null_stg_eltool__stock_id.68f6d1d89a"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from "IDX-Stock"."IDX-Schema"."stg_eltool__stock"
where id is null



      
    ) dbt_internal_test
[0m19:45:15.866123 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m19:45:15.868121 [debug] [Thread-1 (]: Timing info for test.dbt_idx.not_null_stg_eltool__stock_id.68f6d1d89a (execute): 19:45:15.796676 => 19:45:15.868121
[0m19:45:15.869593 [debug] [Thread-1 (]: On test.dbt_idx.not_null_stg_eltool__stock_id.68f6d1d89a: ROLLBACK
[0m19:45:15.872620 [debug] [Thread-1 (]: On test.dbt_idx.not_null_stg_eltool__stock_id.68f6d1d89a: Close
[0m19:45:15.874624 [info ] [Thread-1 (]: 9 of 19 PASS not_null_stg_eltool__stock_id ..................................... [[32mPASS[0m in 0.11s]
[0m19:45:15.877597 [debug] [Thread-1 (]: Finished running node test.dbt_idx.not_null_stg_eltool__stock_id.68f6d1d89a
[0m19:45:15.878597 [debug] [Thread-1 (]: Began running node test.dbt_idx.not_null_stock_update_status_id.633bc8afe3
[0m19:45:15.879601 [info ] [Thread-1 (]: 10 of 19 START test not_null_stock_update_status_id ............................ [RUN]
[0m19:45:15.881594 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_idx.not_null_stg_eltool__stock_id.68f6d1d89a, now test.dbt_idx.not_null_stock_update_status_id.633bc8afe3)
[0m19:45:15.882615 [debug] [Thread-1 (]: Began compiling node test.dbt_idx.not_null_stock_update_status_id.633bc8afe3
[0m19:45:15.891493 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_idx.not_null_stock_update_status_id.633bc8afe3"
[0m19:45:15.899487 [debug] [Thread-1 (]: Timing info for test.dbt_idx.not_null_stock_update_status_id.633bc8afe3 (compile): 19:45:15.883618 => 19:45:15.899487
[0m19:45:15.900491 [debug] [Thread-1 (]: Began executing node test.dbt_idx.not_null_stock_update_status_id.633bc8afe3
[0m19:45:15.907009 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_idx.not_null_stock_update_status_id.633bc8afe3"
[0m19:45:15.915220 [debug] [Thread-1 (]: Using postgres connection "test.dbt_idx.not_null_stock_update_status_id.633bc8afe3"
[0m19:45:15.916202 [debug] [Thread-1 (]: On test.dbt_idx.not_null_stock_update_status_id.633bc8afe3: BEGIN
[0m19:45:15.917199 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:45:15.941105 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m19:45:15.942103 [debug] [Thread-1 (]: Using postgres connection "test.dbt_idx.not_null_stock_update_status_id.633bc8afe3"
[0m19:45:15.943103 [debug] [Thread-1 (]: On test.dbt_idx.not_null_stock_update_status_id.633bc8afe3: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "test.dbt_idx.not_null_stock_update_status_id.633bc8afe3"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from "IDX-Stock"."IDX-Schema"."stock_update_status"
where id is null



      
    ) dbt_internal_test
[0m19:45:15.956151 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m19:45:15.959154 [debug] [Thread-1 (]: Timing info for test.dbt_idx.not_null_stock_update_status_id.633bc8afe3 (execute): 19:45:15.901489 => 19:45:15.958158
[0m19:45:15.960154 [debug] [Thread-1 (]: On test.dbt_idx.not_null_stock_update_status_id.633bc8afe3: ROLLBACK
[0m19:45:15.961668 [debug] [Thread-1 (]: On test.dbt_idx.not_null_stock_update_status_id.633bc8afe3: Close
[0m19:45:15.964684 [info ] [Thread-1 (]: 10 of 19 PASS not_null_stock_update_status_id .................................. [[32mPASS[0m in 0.08s]
[0m19:45:15.967685 [debug] [Thread-1 (]: Finished running node test.dbt_idx.not_null_stock_update_status_id.633bc8afe3
[0m19:45:15.968685 [debug] [Thread-1 (]: Began running node test.dbt_idx.source_not_null_IDX-Schema_customers_customer_id.8525798d49
[0m19:45:15.970212 [info ] [Thread-1 (]: 11 of 19 START test source_not_null_IDX-Schema_customers_customer_id ........... [RUN]
[0m19:45:15.971218 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_idx.not_null_stock_update_status_id.633bc8afe3, now test.dbt_idx.source_not_null_IDX-Schema_customers_customer_id.8525798d49)
[0m19:45:15.972735 [debug] [Thread-1 (]: Began compiling node test.dbt_idx.source_not_null_IDX-Schema_customers_customer_id.8525798d49
[0m19:45:15.980753 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_idx.source_not_null_IDX-Schema_customers_customer_id.8525798d49"
[0m19:45:15.988886 [debug] [Thread-1 (]: Timing info for test.dbt_idx.source_not_null_IDX-Schema_customers_customer_id.8525798d49 (compile): 19:45:15.973754 => 19:45:15.988886
[0m19:45:15.990403 [debug] [Thread-1 (]: Began executing node test.dbt_idx.source_not_null_IDX-Schema_customers_customer_id.8525798d49
[0m19:45:15.997941 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_idx.source_not_null_IDX-Schema_customers_customer_id.8525798d49"
[0m19:45:16.006677 [debug] [Thread-1 (]: Using postgres connection "test.dbt_idx.source_not_null_IDX-Schema_customers_customer_id.8525798d49"
[0m19:45:16.007674 [debug] [Thread-1 (]: On test.dbt_idx.source_not_null_IDX-Schema_customers_customer_id.8525798d49: BEGIN
[0m19:45:16.008679 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:45:16.034263 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m19:45:16.035786 [debug] [Thread-1 (]: Using postgres connection "test.dbt_idx.source_not_null_IDX-Schema_customers_customer_id.8525798d49"
[0m19:45:16.037794 [debug] [Thread-1 (]: On test.dbt_idx.source_not_null_IDX-Schema_customers_customer_id.8525798d49: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "test.dbt_idx.source_not_null_IDX-Schema_customers_customer_id.8525798d49"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select customer_id
from "IDX-Stock"."IDX-Schema"."customers"
where customer_id is null



      
    ) dbt_internal_test
[0m19:45:16.040802 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m19:45:16.043797 [debug] [Thread-1 (]: Timing info for test.dbt_idx.source_not_null_IDX-Schema_customers_customer_id.8525798d49 (execute): 19:45:15.992412 => 19:45:16.042796
[0m19:45:16.044796 [debug] [Thread-1 (]: On test.dbt_idx.source_not_null_IDX-Schema_customers_customer_id.8525798d49: ROLLBACK
[0m19:45:16.047799 [debug] [Thread-1 (]: On test.dbt_idx.source_not_null_IDX-Schema_customers_customer_id.8525798d49: Close
[0m19:45:16.050331 [info ] [Thread-1 (]: 11 of 19 PASS source_not_null_IDX-Schema_customers_customer_id ................. [[32mPASS[0m in 0.08s]
[0m19:45:16.052329 [debug] [Thread-1 (]: Finished running node test.dbt_idx.source_not_null_IDX-Schema_customers_customer_id.8525798d49
[0m19:45:16.054328 [debug] [Thread-1 (]: Began running node test.dbt_idx.source_not_null_IDX-Schema_ksql-company-stream_id.d088b78209
[0m19:45:16.055325 [info ] [Thread-1 (]: 12 of 19 START test source_not_null_IDX-Schema_ksql-company-stream_id .......... [RUN]
[0m19:45:16.057328 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_idx.source_not_null_IDX-Schema_customers_customer_id.8525798d49, now test.dbt_idx.source_not_null_IDX-Schema_ksql-company-stream_id.d088b78209)
[0m19:45:16.057843 [debug] [Thread-1 (]: Began compiling node test.dbt_idx.source_not_null_IDX-Schema_ksql-company-stream_id.d088b78209
[0m19:45:16.065859 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_idx.source_not_null_IDX-Schema_ksql-company-stream_id.d088b78209"
[0m19:45:16.074997 [debug] [Thread-1 (]: Timing info for test.dbt_idx.source_not_null_IDX-Schema_ksql-company-stream_id.d088b78209 (compile): 19:45:16.057843 => 19:45:16.074405
[0m19:45:16.075402 [debug] [Thread-1 (]: Began executing node test.dbt_idx.source_not_null_IDX-Schema_ksql-company-stream_id.d088b78209
[0m19:45:16.080407 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_idx.source_not_null_IDX-Schema_ksql-company-stream_id.d088b78209"
[0m19:45:16.085925 [debug] [Thread-1 (]: Using postgres connection "test.dbt_idx.source_not_null_IDX-Schema_ksql-company-stream_id.d088b78209"
[0m19:45:16.087465 [debug] [Thread-1 (]: On test.dbt_idx.source_not_null_IDX-Schema_ksql-company-stream_id.d088b78209: BEGIN
[0m19:45:16.088435 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:45:16.109961 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m19:45:16.111966 [debug] [Thread-1 (]: Using postgres connection "test.dbt_idx.source_not_null_IDX-Schema_ksql-company-stream_id.d088b78209"
[0m19:45:16.112970 [debug] [Thread-1 (]: On test.dbt_idx.source_not_null_IDX-Schema_ksql-company-stream_id.d088b78209: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "test.dbt_idx.source_not_null_IDX-Schema_ksql-company-stream_id.d088b78209"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from "IDX-Stock"."IDX-Schema"."ksql-company-stream"
where id is null



      
    ) dbt_internal_test
[0m19:45:16.115962 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m19:45:16.118963 [debug] [Thread-1 (]: Timing info for test.dbt_idx.source_not_null_IDX-Schema_ksql-company-stream_id.d088b78209 (execute): 19:45:16.076406 => 19:45:16.117963
[0m19:45:16.119962 [debug] [Thread-1 (]: On test.dbt_idx.source_not_null_IDX-Schema_ksql-company-stream_id.d088b78209: ROLLBACK
[0m19:45:16.122967 [debug] [Thread-1 (]: On test.dbt_idx.source_not_null_IDX-Schema_ksql-company-stream_id.d088b78209: Close
[0m19:45:16.125476 [info ] [Thread-1 (]: 12 of 19 PASS source_not_null_IDX-Schema_ksql-company-stream_id ................ [[32mPASS[0m in 0.07s]
[0m19:45:16.127487 [debug] [Thread-1 (]: Finished running node test.dbt_idx.source_not_null_IDX-Schema_ksql-company-stream_id.d088b78209
[0m19:45:16.129486 [debug] [Thread-1 (]: Began running node test.dbt_idx.source_not_null_IDX-Schema_ksql-stock-stream_id.b3b44ecba6
[0m19:45:16.130484 [info ] [Thread-1 (]: 13 of 19 START test source_not_null_IDX-Schema_ksql-stock-stream_id ............ [RUN]
[0m19:45:16.132491 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_idx.source_not_null_IDX-Schema_ksql-company-stream_id.d088b78209, now test.dbt_idx.source_not_null_IDX-Schema_ksql-stock-stream_id.b3b44ecba6)
[0m19:45:16.132491 [debug] [Thread-1 (]: Began compiling node test.dbt_idx.source_not_null_IDX-Schema_ksql-stock-stream_id.b3b44ecba6
[0m19:45:16.139489 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_idx.source_not_null_IDX-Schema_ksql-stock-stream_id.b3b44ecba6"
[0m19:45:16.147024 [debug] [Thread-1 (]: Timing info for test.dbt_idx.source_not_null_IDX-Schema_ksql-stock-stream_id.b3b44ecba6 (compile): 19:45:16.133490 => 19:45:16.145499
[0m19:45:16.148037 [debug] [Thread-1 (]: Began executing node test.dbt_idx.source_not_null_IDX-Schema_ksql-stock-stream_id.b3b44ecba6
[0m19:45:16.151034 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_idx.source_not_null_IDX-Schema_ksql-stock-stream_id.b3b44ecba6"
[0m19:45:16.159036 [debug] [Thread-1 (]: Using postgres connection "test.dbt_idx.source_not_null_IDX-Schema_ksql-stock-stream_id.b3b44ecba6"
[0m19:45:16.160038 [debug] [Thread-1 (]: On test.dbt_idx.source_not_null_IDX-Schema_ksql-stock-stream_id.b3b44ecba6: BEGIN
[0m19:45:16.161040 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:45:16.183053 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m19:45:16.184052 [debug] [Thread-1 (]: Using postgres connection "test.dbt_idx.source_not_null_IDX-Schema_ksql-stock-stream_id.b3b44ecba6"
[0m19:45:16.185050 [debug] [Thread-1 (]: On test.dbt_idx.source_not_null_IDX-Schema_ksql-stock-stream_id.b3b44ecba6: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "test.dbt_idx.source_not_null_IDX-Schema_ksql-stock-stream_id.b3b44ecba6"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from "IDX-Stock"."IDX-Schema"."ksql-stock-stream"
where id is null



      
    ) dbt_internal_test
[0m19:45:16.190135 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m19:45:16.192664 [debug] [Thread-1 (]: Timing info for test.dbt_idx.source_not_null_IDX-Schema_ksql-stock-stream_id.b3b44ecba6 (execute): 19:45:16.148037 => 19:45:16.192664
[0m19:45:16.193656 [debug] [Thread-1 (]: On test.dbt_idx.source_not_null_IDX-Schema_ksql-stock-stream_id.b3b44ecba6: ROLLBACK
[0m19:45:16.196657 [debug] [Thread-1 (]: On test.dbt_idx.source_not_null_IDX-Schema_ksql-stock-stream_id.b3b44ecba6: Close
[0m19:45:16.198660 [info ] [Thread-1 (]: 13 of 19 PASS source_not_null_IDX-Schema_ksql-stock-stream_id .................. [[32mPASS[0m in 0.07s]
[0m19:45:16.200660 [debug] [Thread-1 (]: Finished running node test.dbt_idx.source_not_null_IDX-Schema_ksql-stock-stream_id.b3b44ecba6
[0m19:45:16.201402 [debug] [Thread-1 (]: Began running node test.dbt_idx.source_not_null_IDX-Schema_orders_order_id.f2383dcca5
[0m19:45:16.202414 [info ] [Thread-1 (]: 14 of 19 START test source_not_null_IDX-Schema_orders_order_id ................. [RUN]
[0m19:45:16.204417 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_idx.source_not_null_IDX-Schema_ksql-stock-stream_id.b3b44ecba6, now test.dbt_idx.source_not_null_IDX-Schema_orders_order_id.f2383dcca5)
[0m19:45:16.206415 [debug] [Thread-1 (]: Began compiling node test.dbt_idx.source_not_null_IDX-Schema_orders_order_id.f2383dcca5
[0m19:45:16.212965 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_idx.source_not_null_IDX-Schema_orders_order_id.f2383dcca5"
[0m19:45:16.220967 [debug] [Thread-1 (]: Timing info for test.dbt_idx.source_not_null_IDX-Schema_orders_order_id.f2383dcca5 (compile): 19:45:16.207434 => 19:45:16.219968
[0m19:45:16.221969 [debug] [Thread-1 (]: Began executing node test.dbt_idx.source_not_null_IDX-Schema_orders_order_id.f2383dcca5
[0m19:45:16.224964 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_idx.source_not_null_IDX-Schema_orders_order_id.f2383dcca5"
[0m19:45:16.231732 [debug] [Thread-1 (]: Using postgres connection "test.dbt_idx.source_not_null_IDX-Schema_orders_order_id.f2383dcca5"
[0m19:45:16.232733 [debug] [Thread-1 (]: On test.dbt_idx.source_not_null_IDX-Schema_orders_order_id.f2383dcca5: BEGIN
[0m19:45:16.233733 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:45:16.258692 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m19:45:16.258692 [debug] [Thread-1 (]: Using postgres connection "test.dbt_idx.source_not_null_IDX-Schema_orders_order_id.f2383dcca5"
[0m19:45:16.259690 [debug] [Thread-1 (]: On test.dbt_idx.source_not_null_IDX-Schema_orders_order_id.f2383dcca5: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "test.dbt_idx.source_not_null_IDX-Schema_orders_order_id.f2383dcca5"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select order_id
from "IDX-Stock"."IDX-Schema"."orders"
where order_id is null



      
    ) dbt_internal_test
[0m19:45:16.263695 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m19:45:16.266692 [debug] [Thread-1 (]: Timing info for test.dbt_idx.source_not_null_IDX-Schema_orders_order_id.f2383dcca5 (execute): 19:45:16.222965 => 19:45:16.265756
[0m19:45:16.267694 [debug] [Thread-1 (]: On test.dbt_idx.source_not_null_IDX-Schema_orders_order_id.f2383dcca5: ROLLBACK
[0m19:45:16.269695 [debug] [Thread-1 (]: On test.dbt_idx.source_not_null_IDX-Schema_orders_order_id.f2383dcca5: Close
[0m19:45:16.272708 [info ] [Thread-1 (]: 14 of 19 PASS source_not_null_IDX-Schema_orders_order_id ....................... [[32mPASS[0m in 0.07s]
[0m19:45:16.274707 [debug] [Thread-1 (]: Finished running node test.dbt_idx.source_not_null_IDX-Schema_orders_order_id.f2383dcca5
[0m19:45:16.276699 [debug] [Thread-1 (]: Began running node test.dbt_idx.source_relationships_IDX-Schema_orders_cust_id__customer_id__source_IDX_Schema_customers_.dc582657bc
[0m19:45:16.277700 [info ] [Thread-1 (]: 15 of 19 START test source_relationships_IDX-Schema_orders_cust_id__customer_id__source_IDX_Schema_customers_  [RUN]
[0m19:45:16.280698 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_idx.source_not_null_IDX-Schema_orders_order_id.f2383dcca5, now test.dbt_idx.source_relationships_IDX-Schema_orders_cust_id__customer_id__source_IDX_Schema_customers_.dc582657bc)
[0m19:45:16.281703 [debug] [Thread-1 (]: Began compiling node test.dbt_idx.source_relationships_IDX-Schema_orders_cust_id__customer_id__source_IDX_Schema_customers_.dc582657bc
[0m19:45:16.301212 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_idx.source_relationships_IDX-Schema_orders_cust_id__customer_id__source_IDX_Schema_customers_.dc582657bc"
[0m19:45:16.312218 [debug] [Thread-1 (]: Timing info for test.dbt_idx.source_relationships_IDX-Schema_orders_cust_id__customer_id__source_IDX_Schema_customers_.dc582657bc (compile): 19:45:16.282699 => 19:45:16.311229
[0m19:45:16.315224 [debug] [Thread-1 (]: Began executing node test.dbt_idx.source_relationships_IDX-Schema_orders_cust_id__customer_id__source_IDX_Schema_customers_.dc582657bc
[0m19:45:16.321216 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_idx.source_relationships_IDX-Schema_orders_cust_id__customer_id__source_IDX_Schema_customers_.dc582657bc"
[0m19:45:16.329762 [debug] [Thread-1 (]: Using postgres connection "test.dbt_idx.source_relationships_IDX-Schema_orders_cust_id__customer_id__source_IDX_Schema_customers_.dc582657bc"
[0m19:45:16.332784 [debug] [Thread-1 (]: On test.dbt_idx.source_relationships_IDX-Schema_orders_cust_id__customer_id__source_IDX_Schema_customers_.dc582657bc: BEGIN
[0m19:45:16.333764 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:45:16.368959 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m19:45:16.369932 [debug] [Thread-1 (]: Using postgres connection "test.dbt_idx.source_relationships_IDX-Schema_orders_cust_id__customer_id__source_IDX_Schema_customers_.dc582657bc"
[0m19:45:16.373943 [debug] [Thread-1 (]: On test.dbt_idx.source_relationships_IDX-Schema_orders_cust_id__customer_id__source_IDX_Schema_customers_.dc582657bc: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "test.dbt_idx.source_relationships_IDX-Schema_orders_cust_id__customer_id__source_IDX_Schema_customers_.dc582657bc"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select cust_id as from_field
    from "IDX-Stock"."IDX-Schema"."orders"
    where cust_id is not null
),

parent as (
    select customer_id as to_field
    from "IDX-Stock"."IDX-Schema"."customers"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m19:45:16.378269 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m19:45:16.382364 [debug] [Thread-1 (]: Timing info for test.dbt_idx.source_relationships_IDX-Schema_orders_cust_id__customer_id__source_IDX_Schema_customers_.dc582657bc (execute): 19:45:16.316215 => 19:45:16.381320
[0m19:45:16.383328 [debug] [Thread-1 (]: On test.dbt_idx.source_relationships_IDX-Schema_orders_cust_id__customer_id__source_IDX_Schema_customers_.dc582657bc: ROLLBACK
[0m19:45:16.386848 [debug] [Thread-1 (]: On test.dbt_idx.source_relationships_IDX-Schema_orders_cust_id__customer_id__source_IDX_Schema_customers_.dc582657bc: Close
[0m19:45:16.390859 [info ] [Thread-1 (]: 15 of 19 PASS source_relationships_IDX-Schema_orders_cust_id__customer_id__source_IDX_Schema_customers_  [[32mPASS[0m in 0.11s]
[0m19:45:16.393866 [debug] [Thread-1 (]: Finished running node test.dbt_idx.source_relationships_IDX-Schema_orders_cust_id__customer_id__source_IDX_Schema_customers_.dc582657bc
[0m19:45:16.395886 [debug] [Thread-1 (]: Began running node test.dbt_idx.source_unique_IDX-Schema_ksql-company-stream_id.09232074f4
[0m19:45:16.396864 [info ] [Thread-1 (]: 16 of 19 START test source_unique_IDX-Schema_ksql-company-stream_id ............ [RUN]
[0m19:45:16.399906 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_idx.source_relationships_IDX-Schema_orders_cust_id__customer_id__source_IDX_Schema_customers_.dc582657bc, now test.dbt_idx.source_unique_IDX-Schema_ksql-company-stream_id.09232074f4)
[0m19:45:16.400904 [debug] [Thread-1 (]: Began compiling node test.dbt_idx.source_unique_IDX-Schema_ksql-company-stream_id.09232074f4
[0m19:45:16.416995 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_idx.source_unique_IDX-Schema_ksql-company-stream_id.09232074f4"
[0m19:45:16.429979 [debug] [Thread-1 (]: Timing info for test.dbt_idx.source_unique_IDX-Schema_ksql-company-stream_id.09232074f4 (compile): 19:45:16.400904 => 19:45:16.428986
[0m19:45:16.431486 [debug] [Thread-1 (]: Began executing node test.dbt_idx.source_unique_IDX-Schema_ksql-company-stream_id.09232074f4
[0m19:45:16.441496 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_idx.source_unique_IDX-Schema_ksql-company-stream_id.09232074f4"
[0m19:45:16.449493 [debug] [Thread-1 (]: Using postgres connection "test.dbt_idx.source_unique_IDX-Schema_ksql-company-stream_id.09232074f4"
[0m19:45:16.450493 [debug] [Thread-1 (]: On test.dbt_idx.source_unique_IDX-Schema_ksql-company-stream_id.09232074f4: BEGIN
[0m19:45:16.452501 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:45:16.480507 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m19:45:16.482500 [debug] [Thread-1 (]: Using postgres connection "test.dbt_idx.source_unique_IDX-Schema_ksql-company-stream_id.09232074f4"
[0m19:45:16.482500 [debug] [Thread-1 (]: On test.dbt_idx.source_unique_IDX-Schema_ksql-company-stream_id.09232074f4: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "test.dbt_idx.source_unique_IDX-Schema_ksql-company-stream_id.09232074f4"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from "IDX-Stock"."IDX-Schema"."ksql-company-stream"
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
[0m19:45:16.489044 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m19:45:16.492028 [debug] [Thread-1 (]: Timing info for test.dbt_idx.source_unique_IDX-Schema_ksql-company-stream_id.09232074f4 (execute): 19:45:16.432496 => 19:45:16.491031
[0m19:45:16.493031 [debug] [Thread-1 (]: On test.dbt_idx.source_unique_IDX-Schema_ksql-company-stream_id.09232074f4: ROLLBACK
[0m19:45:16.498031 [debug] [Thread-1 (]: On test.dbt_idx.source_unique_IDX-Schema_ksql-company-stream_id.09232074f4: Close
[0m19:45:16.501032 [info ] [Thread-1 (]: 16 of 19 PASS source_unique_IDX-Schema_ksql-company-stream_id .................. [[32mPASS[0m in 0.10s]
[0m19:45:16.504030 [debug] [Thread-1 (]: Finished running node test.dbt_idx.source_unique_IDX-Schema_ksql-company-stream_id.09232074f4
[0m19:45:16.506043 [debug] [Thread-1 (]: Began running node test.dbt_idx.source_unique_IDX-Schema_ksql-stock-stream_id.2119c5c33b
[0m19:45:16.508028 [info ] [Thread-1 (]: 17 of 19 START test source_unique_IDX-Schema_ksql-stock-stream_id .............. [RUN]
[0m19:45:16.511030 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_idx.source_unique_IDX-Schema_ksql-company-stream_id.09232074f4, now test.dbt_idx.source_unique_IDX-Schema_ksql-stock-stream_id.2119c5c33b)
[0m19:45:16.513028 [debug] [Thread-1 (]: Began compiling node test.dbt_idx.source_unique_IDX-Schema_ksql-stock-stream_id.2119c5c33b
[0m19:45:16.522028 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_idx.source_unique_IDX-Schema_ksql-stock-stream_id.2119c5c33b"
[0m19:45:16.533028 [debug] [Thread-1 (]: Timing info for test.dbt_idx.source_unique_IDX-Schema_ksql-stock-stream_id.2119c5c33b (compile): 19:45:16.515029 => 19:45:16.532028
[0m19:45:16.534030 [debug] [Thread-1 (]: Began executing node test.dbt_idx.source_unique_IDX-Schema_ksql-stock-stream_id.2119c5c33b
[0m19:45:16.542029 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_idx.source_unique_IDX-Schema_ksql-stock-stream_id.2119c5c33b"
[0m19:45:16.549028 [debug] [Thread-1 (]: Using postgres connection "test.dbt_idx.source_unique_IDX-Schema_ksql-stock-stream_id.2119c5c33b"
[0m19:45:16.550029 [debug] [Thread-1 (]: On test.dbt_idx.source_unique_IDX-Schema_ksql-stock-stream_id.2119c5c33b: BEGIN
[0m19:45:16.551029 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:45:16.579041 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m19:45:16.582049 [debug] [Thread-1 (]: Using postgres connection "test.dbt_idx.source_unique_IDX-Schema_ksql-stock-stream_id.2119c5c33b"
[0m19:45:16.583045 [debug] [Thread-1 (]: On test.dbt_idx.source_unique_IDX-Schema_ksql-stock-stream_id.2119c5c33b: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "test.dbt_idx.source_unique_IDX-Schema_ksql-stock-stream_id.2119c5c33b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from "IDX-Stock"."IDX-Schema"."ksql-stock-stream"
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
[0m19:45:16.603088 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m19:45:16.607086 [debug] [Thread-1 (]: Timing info for test.dbt_idx.source_unique_IDX-Schema_ksql-stock-stream_id.2119c5c33b (execute): 19:45:16.535033 => 19:45:16.607086
[0m19:45:16.608085 [debug] [Thread-1 (]: On test.dbt_idx.source_unique_IDX-Schema_ksql-stock-stream_id.2119c5c33b: ROLLBACK
[0m19:45:16.610087 [debug] [Thread-1 (]: On test.dbt_idx.source_unique_IDX-Schema_ksql-stock-stream_id.2119c5c33b: Close
[0m19:45:16.611085 [info ] [Thread-1 (]: 17 of 19 PASS source_unique_IDX-Schema_ksql-stock-stream_id .................... [[32mPASS[0m in 0.10s]
[0m19:45:16.614094 [debug] [Thread-1 (]: Finished running node test.dbt_idx.source_unique_IDX-Schema_ksql-stock-stream_id.2119c5c33b
[0m19:45:16.615088 [debug] [Thread-1 (]: Began running node test.dbt_idx.source_unique_IDX-Schema_orders_order_id.5a8ef486ee
[0m19:45:16.616090 [info ] [Thread-1 (]: 18 of 19 START test source_unique_IDX-Schema_orders_order_id ................... [RUN]
[0m19:45:16.617086 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_idx.source_unique_IDX-Schema_ksql-stock-stream_id.2119c5c33b, now test.dbt_idx.source_unique_IDX-Schema_orders_order_id.5a8ef486ee)
[0m19:45:16.618116 [debug] [Thread-1 (]: Began compiling node test.dbt_idx.source_unique_IDX-Schema_orders_order_id.5a8ef486ee
[0m19:45:16.625084 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_idx.source_unique_IDX-Schema_orders_order_id.5a8ef486ee"
[0m19:45:16.631741 [debug] [Thread-1 (]: Timing info for test.dbt_idx.source_unique_IDX-Schema_orders_order_id.5a8ef486ee (compile): 19:45:16.619086 => 19:45:16.631741
[0m19:45:16.632758 [debug] [Thread-1 (]: Began executing node test.dbt_idx.source_unique_IDX-Schema_orders_order_id.5a8ef486ee
[0m19:45:16.634736 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_idx.source_unique_IDX-Schema_orders_order_id.5a8ef486ee"
[0m19:45:16.642742 [debug] [Thread-1 (]: Using postgres connection "test.dbt_idx.source_unique_IDX-Schema_orders_order_id.5a8ef486ee"
[0m19:45:16.643759 [debug] [Thread-1 (]: On test.dbt_idx.source_unique_IDX-Schema_orders_order_id.5a8ef486ee: BEGIN
[0m19:45:16.644743 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:45:16.668743 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m19:45:16.670740 [debug] [Thread-1 (]: Using postgres connection "test.dbt_idx.source_unique_IDX-Schema_orders_order_id.5a8ef486ee"
[0m19:45:16.671753 [debug] [Thread-1 (]: On test.dbt_idx.source_unique_IDX-Schema_orders_order_id.5a8ef486ee: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "test.dbt_idx.source_unique_IDX-Schema_orders_order_id.5a8ef486ee"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    order_id as unique_field,
    count(*) as n_records

from "IDX-Stock"."IDX-Schema"."orders"
where order_id is not null
group by order_id
having count(*) > 1



      
    ) dbt_internal_test
[0m19:45:16.675765 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m19:45:16.678763 [debug] [Thread-1 (]: Timing info for test.dbt_idx.source_unique_IDX-Schema_orders_order_id.5a8ef486ee (execute): 19:45:16.632758 => 19:45:16.678763
[0m19:45:16.680767 [debug] [Thread-1 (]: On test.dbt_idx.source_unique_IDX-Schema_orders_order_id.5a8ef486ee: ROLLBACK
[0m19:45:16.682764 [debug] [Thread-1 (]: On test.dbt_idx.source_unique_IDX-Schema_orders_order_id.5a8ef486ee: Close
[0m19:45:16.684779 [info ] [Thread-1 (]: 18 of 19 PASS source_unique_IDX-Schema_orders_order_id ......................... [[32mPASS[0m in 0.07s]
[0m19:45:16.686764 [debug] [Thread-1 (]: Finished running node test.dbt_idx.source_unique_IDX-Schema_orders_order_id.5a8ef486ee
[0m19:45:16.688319 [debug] [Thread-1 (]: Began running node test.dbt_idx.unique_customer_orders_status_order_id.b7a45e83ee
[0m19:45:16.690304 [info ] [Thread-1 (]: 19 of 19 START test unique_customer_orders_status_order_id ..................... [RUN]
[0m19:45:16.691326 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_idx.source_unique_IDX-Schema_orders_order_id.5a8ef486ee, now test.dbt_idx.unique_customer_orders_status_order_id.b7a45e83ee)
[0m19:45:16.692301 [debug] [Thread-1 (]: Began compiling node test.dbt_idx.unique_customer_orders_status_order_id.b7a45e83ee
[0m19:45:16.697323 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_idx.unique_customer_orders_status_order_id.b7a45e83ee"
[0m19:45:16.704755 [debug] [Thread-1 (]: Timing info for test.dbt_idx.unique_customer_orders_status_order_id.b7a45e83ee (compile): 19:45:16.692301 => 19:45:16.704755
[0m19:45:16.706767 [debug] [Thread-1 (]: Began executing node test.dbt_idx.unique_customer_orders_status_order_id.b7a45e83ee
[0m19:45:16.708753 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_idx.unique_customer_orders_status_order_id.b7a45e83ee"
[0m19:45:16.716723 [debug] [Thread-1 (]: Using postgres connection "test.dbt_idx.unique_customer_orders_status_order_id.b7a45e83ee"
[0m19:45:16.717754 [debug] [Thread-1 (]: On test.dbt_idx.unique_customer_orders_status_order_id.b7a45e83ee: BEGIN
[0m19:45:16.717754 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:45:16.742722 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m19:45:16.742722 [debug] [Thread-1 (]: Using postgres connection "test.dbt_idx.unique_customer_orders_status_order_id.b7a45e83ee"
[0m19:45:16.743758 [debug] [Thread-1 (]: On test.dbt_idx.unique_customer_orders_status_order_id.b7a45e83ee: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "test.dbt_idx.unique_customer_orders_status_order_id.b7a45e83ee"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    order_id as unique_field,
    count(*) as n_records

from "IDX-Stock"."IDX-Schema"."customer_orders_status"
where order_id is not null
group by order_id
having count(*) > 1



      
    ) dbt_internal_test
[0m19:45:16.749755 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m19:45:16.752824 [debug] [Thread-1 (]: Timing info for test.dbt_idx.unique_customer_orders_status_order_id.b7a45e83ee (execute): 19:45:16.706767 => 19:45:16.751808
[0m19:45:16.754778 [debug] [Thread-1 (]: On test.dbt_idx.unique_customer_orders_status_order_id.b7a45e83ee: ROLLBACK
[0m19:45:16.757891 [debug] [Thread-1 (]: On test.dbt_idx.unique_customer_orders_status_order_id.b7a45e83ee: Close
[0m19:45:16.759911 [info ] [Thread-1 (]: 19 of 19 PASS unique_customer_orders_status_order_id ........................... [[32mPASS[0m in 0.07s]
[0m19:45:16.761905 [debug] [Thread-1 (]: Finished running node test.dbt_idx.unique_customer_orders_status_order_id.b7a45e83ee
[0m19:45:16.764910 [debug] [MainThread]: Using postgres connection "master"
[0m19:45:16.765897 [debug] [MainThread]: On master: BEGIN
[0m19:45:16.766896 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m19:45:16.792441 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m19:45:16.793474 [debug] [MainThread]: On master: COMMIT
[0m19:45:16.794438 [debug] [MainThread]: Using postgres connection "master"
[0m19:45:16.795438 [debug] [MainThread]: On master: COMMIT
[0m19:45:16.798436 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m19:45:16.799445 [debug] [MainThread]: On master: Close
[0m19:45:16.800441 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:45:16.801440 [debug] [MainThread]: Connection 'list_IDX-Stock_IDX-Schema' was properly closed.
[0m19:45:16.802440 [debug] [MainThread]: Connection 'test.dbt_idx.unique_customer_orders_status_order_id.b7a45e83ee' was properly closed.
[0m19:45:16.803437 [info ] [MainThread]: 
[0m19:45:16.804439 [info ] [MainThread]: Finished running 19 tests in 0 hours 0 minutes and 2.01 seconds (2.01s).
[0m19:45:16.810439 [debug] [MainThread]: Command end result
[0m19:45:16.844479 [info ] [MainThread]: 
[0m19:45:16.846441 [info ] [MainThread]: [32mCompleted successfully[0m
[0m19:45:16.848444 [info ] [MainThread]: 
[0m19:45:16.849474 [info ] [MainThread]: Done. PASS=19 WARN=0 ERROR=0 SKIP=0 TOTAL=19
[0m19:45:16.851438 [debug] [MainThread]: Command `dbt test` succeeded at 19:45:16.851438 after 2.75 seconds
[0m19:45:16.851438 [debug] [MainThread]: Flushing usage events


============================== 19:45:24.422028 | 5849d725-2e26-4421-9b58-06a67f51e82b ==============================
[0m19:45:24.422028 [info ] [MainThread]: Running with dbt=1.6.1
[0m19:45:24.427366 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'D:\\00 Project\\00 My Project\\IdeaProjects\\Py-DBT-IDX\\logs', 'profiles_dir': 'D:\\00 Project\\00 My Project\\IdeaProjects\\Py-DBT-IDX', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt docs generate', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'False'}
[0m19:45:24.590018 [info ] [MainThread]: Registered adapter: postgres=1.6.1
[0m19:45:24.605543 [debug] [MainThread]: checksum: efe19d9f5b93d1a98cc804fbfcdb6b3aced98b974af664946fee1cde8837deb7, vars: {}, profile: , target: , version: 1.6.1
[0m19:45:24.782885 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m19:45:24.783886 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m19:45:24.816462 [info ] [MainThread]: Found 11 models, 1 snapshot, 19 tests, 5 sources, 0 exposures, 0 metrics, 349 macros, 0 groups, 0 semantic models
[0m19:45:24.821479 [info ] [MainThread]: 
[0m19:45:24.823474 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m19:45:24.830982 [debug] [ThreadPool]: Acquiring new postgres connection 'list_IDX-Stock_IDX-Schema'
[0m19:45:24.848781 [debug] [ThreadPool]: Using postgres connection "list_IDX-Stock_IDX-Schema"
[0m19:45:24.849784 [debug] [ThreadPool]: On list_IDX-Stock_IDX-Schema: BEGIN
[0m19:45:24.849784 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:45:24.882455 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m19:45:24.883432 [debug] [ThreadPool]: Using postgres connection "list_IDX-Stock_IDX-Schema"
[0m19:45:24.884430 [debug] [ThreadPool]: On list_IDX-Stock_IDX-Schema: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "connection_name": "list_IDX-Stock_IDX-Schema"} */
select
      'IDX-Stock' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'IDX-Schema'
    union all
    select
      'IDX-Stock' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'IDX-Schema'
    union all
    select
      'IDX-Stock' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'IDX-Schema'
  
[0m19:45:24.889431 [debug] [ThreadPool]: SQL status: SELECT 17 in 0.0 seconds
[0m19:45:24.890431 [debug] [ThreadPool]: On list_IDX-Stock_IDX-Schema: ROLLBACK
[0m19:45:24.892435 [debug] [ThreadPool]: On list_IDX-Stock_IDX-Schema: Close
[0m19:45:24.895953 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_IDX-Stock_IDX-Schema, now list_IDX-Stock_snapshots)
[0m19:45:24.901956 [debug] [ThreadPool]: Using postgres connection "list_IDX-Stock_snapshots"
[0m19:45:24.902948 [debug] [ThreadPool]: On list_IDX-Stock_snapshots: BEGIN
[0m19:45:24.903948 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:45:24.925782 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m19:45:24.926777 [debug] [ThreadPool]: Using postgres connection "list_IDX-Stock_snapshots"
[0m19:45:24.927785 [debug] [ThreadPool]: On list_IDX-Stock_snapshots: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "connection_name": "list_IDX-Stock_snapshots"} */
select
      'IDX-Stock' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'snapshots'
    union all
    select
      'IDX-Stock' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'snapshots'
    union all
    select
      'IDX-Stock' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'snapshots'
  
[0m19:45:24.933783 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.0 seconds
[0m19:45:24.935774 [debug] [ThreadPool]: On list_IDX-Stock_snapshots: ROLLBACK
[0m19:45:24.940084 [debug] [ThreadPool]: On list_IDX-Stock_snapshots: Close
[0m19:45:24.951474 [debug] [MainThread]: Using postgres connection "master"
[0m19:45:24.952474 [debug] [MainThread]: On master: BEGIN
[0m19:45:24.953478 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:45:24.987481 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m19:45:24.989496 [debug] [MainThread]: Using postgres connection "master"
[0m19:45:24.990483 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m19:45:25.010078 [debug] [MainThread]: SQL status: SELECT 9 in 0.0 seconds
[0m19:45:25.017351 [debug] [MainThread]: On master: ROLLBACK
[0m19:45:25.021240 [debug] [MainThread]: On master: Close
[0m19:45:25.026274 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m19:45:25.030265 [info ] [MainThread]: 
[0m19:45:25.042436 [debug] [Thread-1 (]: Began running node model.dbt_idx.stg_eltool__company
[0m19:45:25.047441 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.dbt_idx.stg_eltool__company'
[0m19:45:25.049451 [debug] [Thread-1 (]: Began compiling node model.dbt_idx.stg_eltool__company
[0m19:45:25.070589 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_idx.stg_eltool__company"
[0m19:45:25.082438 [debug] [Thread-1 (]: Timing info for model.dbt_idx.stg_eltool__company (compile): 19:45:25.051456 => 19:45:25.080176
[0m19:45:25.085429 [debug] [Thread-1 (]: Began executing node model.dbt_idx.stg_eltool__company
[0m19:45:25.088431 [debug] [Thread-1 (]: Timing info for model.dbt_idx.stg_eltool__company (execute): 19:45:25.087429 => 19:45:25.087429
[0m19:45:25.092433 [debug] [Thread-1 (]: Finished running node model.dbt_idx.stg_eltool__company
[0m19:45:25.093944 [debug] [Thread-1 (]: Began running node model.dbt_idx.stg_eltool__customers
[0m19:45:25.095960 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_idx.stg_eltool__company, now model.dbt_idx.stg_eltool__customers)
[0m19:45:25.097962 [debug] [Thread-1 (]: Began compiling node model.dbt_idx.stg_eltool__customers
[0m19:45:25.106058 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_idx.stg_eltool__customers"
[0m19:45:25.117257 [debug] [Thread-1 (]: Timing info for model.dbt_idx.stg_eltool__customers (compile): 19:45:25.099058 => 19:45:25.116240
[0m19:45:25.118238 [debug] [Thread-1 (]: Began executing node model.dbt_idx.stg_eltool__customers
[0m19:45:25.121106 [debug] [Thread-1 (]: Timing info for model.dbt_idx.stg_eltool__customers (execute): 19:45:25.119258 => 19:45:25.119258
[0m19:45:25.124153 [debug] [Thread-1 (]: Finished running node model.dbt_idx.stg_eltool__customers
[0m19:45:25.125669 [debug] [Thread-1 (]: Began running node model.dbt_idx.stg_eltool__orders
[0m19:45:25.128276 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_idx.stg_eltool__customers, now model.dbt_idx.stg_eltool__orders)
[0m19:45:25.130364 [debug] [Thread-1 (]: Began compiling node model.dbt_idx.stg_eltool__orders
[0m19:45:25.136476 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_idx.stg_eltool__orders"
[0m19:45:25.155625 [debug] [Thread-1 (]: Timing info for model.dbt_idx.stg_eltool__orders (compile): 19:45:25.132392 => 19:45:25.153585
[0m19:45:25.158602 [debug] [Thread-1 (]: Began executing node model.dbt_idx.stg_eltool__orders
[0m19:45:25.161114 [debug] [Thread-1 (]: Timing info for model.dbt_idx.stg_eltool__orders (execute): 19:45:25.159602 => 19:45:25.159602
[0m19:45:25.165718 [debug] [Thread-1 (]: Finished running node model.dbt_idx.stg_eltool__orders
[0m19:45:25.168693 [debug] [Thread-1 (]: Began running node model.dbt_idx.stg_eltool__state
[0m19:45:25.173399 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_idx.stg_eltool__orders, now model.dbt_idx.stg_eltool__state)
[0m19:45:25.175400 [debug] [Thread-1 (]: Began compiling node model.dbt_idx.stg_eltool__state
[0m19:45:25.184165 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_idx.stg_eltool__state"
[0m19:45:25.196739 [debug] [Thread-1 (]: Timing info for model.dbt_idx.stg_eltool__state (compile): 19:45:25.177398 => 19:45:25.196739
[0m19:45:25.199272 [debug] [Thread-1 (]: Began executing node model.dbt_idx.stg_eltool__state
[0m19:45:25.204293 [debug] [Thread-1 (]: Timing info for model.dbt_idx.stg_eltool__state (execute): 19:45:25.201287 => 19:45:25.202294
[0m19:45:25.208272 [debug] [Thread-1 (]: Finished running node model.dbt_idx.stg_eltool__state
[0m19:45:25.209269 [debug] [Thread-1 (]: Began running node model.dbt_idx.stg_eltool__stock
[0m19:45:25.211273 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_idx.stg_eltool__state, now model.dbt_idx.stg_eltool__stock)
[0m19:45:25.212271 [debug] [Thread-1 (]: Began compiling node model.dbt_idx.stg_eltool__stock
[0m19:45:25.218793 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_idx.stg_eltool__stock"
[0m19:45:25.227329 [debug] [Thread-1 (]: Timing info for model.dbt_idx.stg_eltool__stock (compile): 19:45:25.213271 => 19:45:25.226328
[0m19:45:25.231342 [debug] [Thread-1 (]: Began executing node model.dbt_idx.stg_eltool__stock
[0m19:45:25.235585 [debug] [Thread-1 (]: Timing info for model.dbt_idx.stg_eltool__stock (execute): 19:45:25.233602 => 19:45:25.233602
[0m19:45:25.238603 [debug] [Thread-1 (]: Finished running node model.dbt_idx.stg_eltool__stock
[0m19:45:25.241585 [debug] [Thread-1 (]: Began running node snapshot.dbt_idx.customers_snapshot
[0m19:45:25.244586 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_idx.stg_eltool__stock, now snapshot.dbt_idx.customers_snapshot)
[0m19:45:25.245585 [debug] [Thread-1 (]: Began compiling node snapshot.dbt_idx.customers_snapshot
[0m19:45:25.259368 [debug] [Thread-1 (]: Timing info for snapshot.dbt_idx.customers_snapshot (compile): 19:45:25.247913 => 19:45:25.259368
[0m19:45:25.261385 [debug] [Thread-1 (]: Began executing node snapshot.dbt_idx.customers_snapshot
[0m19:45:25.263889 [debug] [Thread-1 (]: Timing info for snapshot.dbt_idx.customers_snapshot (execute): 19:45:25.263381 => 19:45:25.263381
[0m19:45:25.269939 [debug] [Thread-1 (]: Finished running node snapshot.dbt_idx.customers_snapshot
[0m19:45:25.272963 [debug] [Thread-1 (]: Began running node test.dbt_idx.source_not_null_IDX-Schema_customers_customer_id.8525798d49
[0m19:45:25.274935 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly snapshot.dbt_idx.customers_snapshot, now test.dbt_idx.source_not_null_IDX-Schema_customers_customer_id.8525798d49)
[0m19:45:25.276187 [debug] [Thread-1 (]: Began compiling node test.dbt_idx.source_not_null_IDX-Schema_customers_customer_id.8525798d49
[0m19:45:25.306703 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_idx.source_not_null_IDX-Schema_customers_customer_id.8525798d49"
[0m19:45:25.317292 [debug] [Thread-1 (]: Timing info for test.dbt_idx.source_not_null_IDX-Schema_customers_customer_id.8525798d49 (compile): 19:45:25.278943 => 19:45:25.317292
[0m19:45:25.318291 [debug] [Thread-1 (]: Began executing node test.dbt_idx.source_not_null_IDX-Schema_customers_customer_id.8525798d49
[0m19:45:25.320292 [debug] [Thread-1 (]: Timing info for test.dbt_idx.source_not_null_IDX-Schema_customers_customer_id.8525798d49 (execute): 19:45:25.319292 => 19:45:25.319292
[0m19:45:25.323292 [debug] [Thread-1 (]: Finished running node test.dbt_idx.source_not_null_IDX-Schema_customers_customer_id.8525798d49
[0m19:45:25.325293 [debug] [Thread-1 (]: Began running node test.dbt_idx.source_not_null_IDX-Schema_ksql-company-stream_id.d088b78209
[0m19:45:25.329312 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_idx.source_not_null_IDX-Schema_customers_customer_id.8525798d49, now test.dbt_idx.source_not_null_IDX-Schema_ksql-company-stream_id.d088b78209)
[0m19:45:25.330302 [debug] [Thread-1 (]: Began compiling node test.dbt_idx.source_not_null_IDX-Schema_ksql-company-stream_id.d088b78209
[0m19:45:25.344291 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_idx.source_not_null_IDX-Schema_ksql-company-stream_id.d088b78209"
[0m19:45:25.355820 [debug] [Thread-1 (]: Timing info for test.dbt_idx.source_not_null_IDX-Schema_ksql-company-stream_id.d088b78209 (compile): 19:45:25.331295 => 19:45:25.354818
[0m19:45:25.357816 [debug] [Thread-1 (]: Began executing node test.dbt_idx.source_not_null_IDX-Schema_ksql-company-stream_id.d088b78209
[0m19:45:25.358817 [debug] [Thread-1 (]: Timing info for test.dbt_idx.source_not_null_IDX-Schema_ksql-company-stream_id.d088b78209 (execute): 19:45:25.358817 => 19:45:25.358817
[0m19:45:25.363829 [debug] [Thread-1 (]: Finished running node test.dbt_idx.source_not_null_IDX-Schema_ksql-company-stream_id.d088b78209
[0m19:45:25.366015 [debug] [Thread-1 (]: Began running node test.dbt_idx.source_not_null_IDX-Schema_ksql-stock-stream_id.b3b44ecba6
[0m19:45:25.368025 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_idx.source_not_null_IDX-Schema_ksql-company-stream_id.d088b78209, now test.dbt_idx.source_not_null_IDX-Schema_ksql-stock-stream_id.b3b44ecba6)
[0m19:45:25.370031 [debug] [Thread-1 (]: Began compiling node test.dbt_idx.source_not_null_IDX-Schema_ksql-stock-stream_id.b3b44ecba6
[0m19:45:25.382569 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_idx.source_not_null_IDX-Schema_ksql-stock-stream_id.b3b44ecba6"
[0m19:45:25.392576 [debug] [Thread-1 (]: Timing info for test.dbt_idx.source_not_null_IDX-Schema_ksql-stock-stream_id.b3b44ecba6 (compile): 19:45:25.370031 => 19:45:25.390586
[0m19:45:25.393572 [debug] [Thread-1 (]: Began executing node test.dbt_idx.source_not_null_IDX-Schema_ksql-stock-stream_id.b3b44ecba6
[0m19:45:25.395094 [debug] [Thread-1 (]: Timing info for test.dbt_idx.source_not_null_IDX-Schema_ksql-stock-stream_id.b3b44ecba6 (execute): 19:45:25.395094 => 19:45:25.395094
[0m19:45:25.397105 [debug] [Thread-1 (]: Finished running node test.dbt_idx.source_not_null_IDX-Schema_ksql-stock-stream_id.b3b44ecba6
[0m19:45:25.400303 [debug] [Thread-1 (]: Began running node test.dbt_idx.source_not_null_IDX-Schema_orders_order_id.f2383dcca5
[0m19:45:25.404294 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_idx.source_not_null_IDX-Schema_ksql-stock-stream_id.b3b44ecba6, now test.dbt_idx.source_not_null_IDX-Schema_orders_order_id.f2383dcca5)
[0m19:45:25.406292 [debug] [Thread-1 (]: Began compiling node test.dbt_idx.source_not_null_IDX-Schema_orders_order_id.f2383dcca5
[0m19:45:25.416860 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_idx.source_not_null_IDX-Schema_orders_order_id.f2383dcca5"
[0m19:45:25.427858 [debug] [Thread-1 (]: Timing info for test.dbt_idx.source_not_null_IDX-Schema_orders_order_id.f2383dcca5 (compile): 19:45:25.407295 => 19:45:25.426852
[0m19:45:25.429872 [debug] [Thread-1 (]: Began executing node test.dbt_idx.source_not_null_IDX-Schema_orders_order_id.f2383dcca5
[0m19:45:25.433405 [debug] [Thread-1 (]: Timing info for test.dbt_idx.source_not_null_IDX-Schema_orders_order_id.f2383dcca5 (execute): 19:45:25.432406 => 19:45:25.432406
[0m19:45:25.436403 [debug] [Thread-1 (]: Finished running node test.dbt_idx.source_not_null_IDX-Schema_orders_order_id.f2383dcca5
[0m19:45:25.438410 [debug] [Thread-1 (]: Began running node test.dbt_idx.source_relationships_IDX-Schema_orders_cust_id__customer_id__source_IDX_Schema_customers_.dc582657bc
[0m19:45:25.442421 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_idx.source_not_null_IDX-Schema_orders_order_id.f2383dcca5, now test.dbt_idx.source_relationships_IDX-Schema_orders_cust_id__customer_id__source_IDX_Schema_customers_.dc582657bc)
[0m19:45:25.444407 [debug] [Thread-1 (]: Began compiling node test.dbt_idx.source_relationships_IDX-Schema_orders_cust_id__customer_id__source_IDX_Schema_customers_.dc582657bc
[0m19:45:25.465483 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_idx.source_relationships_IDX-Schema_orders_cust_id__customer_id__source_IDX_Schema_customers_.dc582657bc"
[0m19:45:25.475309 [debug] [Thread-1 (]: Timing info for test.dbt_idx.source_relationships_IDX-Schema_orders_cust_id__customer_id__source_IDX_Schema_customers_.dc582657bc (compile): 19:45:25.446409 => 19:45:25.474306
[0m19:45:25.477303 [debug] [Thread-1 (]: Began executing node test.dbt_idx.source_relationships_IDX-Schema_orders_cust_id__customer_id__source_IDX_Schema_customers_.dc582657bc
[0m19:45:25.478302 [debug] [Thread-1 (]: Timing info for test.dbt_idx.source_relationships_IDX-Schema_orders_cust_id__customer_id__source_IDX_Schema_customers_.dc582657bc (execute): 19:45:25.478302 => 19:45:25.478302
[0m19:45:25.480303 [debug] [Thread-1 (]: Finished running node test.dbt_idx.source_relationships_IDX-Schema_orders_cust_id__customer_id__source_IDX_Schema_customers_.dc582657bc
[0m19:45:25.482499 [debug] [Thread-1 (]: Began running node test.dbt_idx.source_unique_IDX-Schema_ksql-company-stream_id.09232074f4
[0m19:45:25.483499 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_idx.source_relationships_IDX-Schema_orders_cust_id__customer_id__source_IDX_Schema_customers_.dc582657bc, now test.dbt_idx.source_unique_IDX-Schema_ksql-company-stream_id.09232074f4)
[0m19:45:25.484499 [debug] [Thread-1 (]: Began compiling node test.dbt_idx.source_unique_IDX-Schema_ksql-company-stream_id.09232074f4
[0m19:45:25.500054 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_idx.source_unique_IDX-Schema_ksql-company-stream_id.09232074f4"
[0m19:45:25.508053 [debug] [Thread-1 (]: Timing info for test.dbt_idx.source_unique_IDX-Schema_ksql-company-stream_id.09232074f4 (compile): 19:45:25.486498 => 19:45:25.507051
[0m19:45:25.508053 [debug] [Thread-1 (]: Began executing node test.dbt_idx.source_unique_IDX-Schema_ksql-company-stream_id.09232074f4
[0m19:45:25.509053 [debug] [Thread-1 (]: Timing info for test.dbt_idx.source_unique_IDX-Schema_ksql-company-stream_id.09232074f4 (execute): 19:45:25.509053 => 19:45:25.509053
[0m19:45:25.511057 [debug] [Thread-1 (]: Finished running node test.dbt_idx.source_unique_IDX-Schema_ksql-company-stream_id.09232074f4
[0m19:45:25.512056 [debug] [Thread-1 (]: Began running node test.dbt_idx.source_unique_IDX-Schema_ksql-stock-stream_id.2119c5c33b
[0m19:45:25.513055 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_idx.source_unique_IDX-Schema_ksql-company-stream_id.09232074f4, now test.dbt_idx.source_unique_IDX-Schema_ksql-stock-stream_id.2119c5c33b)
[0m19:45:25.514567 [debug] [Thread-1 (]: Began compiling node test.dbt_idx.source_unique_IDX-Schema_ksql-stock-stream_id.2119c5c33b
[0m19:45:25.521587 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_idx.source_unique_IDX-Schema_ksql-stock-stream_id.2119c5c33b"
[0m19:45:25.528592 [debug] [Thread-1 (]: Timing info for test.dbt_idx.source_unique_IDX-Schema_ksql-stock-stream_id.2119c5c33b (compile): 19:45:25.515579 => 19:45:25.527588
[0m19:45:25.529590 [debug] [Thread-1 (]: Began executing node test.dbt_idx.source_unique_IDX-Schema_ksql-stock-stream_id.2119c5c33b
[0m19:45:25.531098 [debug] [Thread-1 (]: Timing info for test.dbt_idx.source_unique_IDX-Schema_ksql-stock-stream_id.2119c5c33b (execute): 19:45:25.530588 => 19:45:25.530588
[0m19:45:25.534116 [debug] [Thread-1 (]: Finished running node test.dbt_idx.source_unique_IDX-Schema_ksql-stock-stream_id.2119c5c33b
[0m19:45:25.535115 [debug] [Thread-1 (]: Began running node test.dbt_idx.source_unique_IDX-Schema_orders_order_id.5a8ef486ee
[0m19:45:25.538122 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_idx.source_unique_IDX-Schema_ksql-stock-stream_id.2119c5c33b, now test.dbt_idx.source_unique_IDX-Schema_orders_order_id.5a8ef486ee)
[0m19:45:25.539132 [debug] [Thread-1 (]: Began compiling node test.dbt_idx.source_unique_IDX-Schema_orders_order_id.5a8ef486ee
[0m19:45:25.551240 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_idx.source_unique_IDX-Schema_orders_order_id.5a8ef486ee"
[0m19:45:25.562245 [debug] [Thread-1 (]: Timing info for test.dbt_idx.source_unique_IDX-Schema_orders_order_id.5a8ef486ee (compile): 19:45:25.540118 => 19:45:25.560251
[0m19:45:25.564760 [debug] [Thread-1 (]: Began executing node test.dbt_idx.source_unique_IDX-Schema_orders_order_id.5a8ef486ee
[0m19:45:25.566788 [debug] [Thread-1 (]: Timing info for test.dbt_idx.source_unique_IDX-Schema_orders_order_id.5a8ef486ee (execute): 19:45:25.565775 => 19:45:25.565775
[0m19:45:25.568787 [debug] [Thread-1 (]: Finished running node test.dbt_idx.source_unique_IDX-Schema_orders_order_id.5a8ef486ee
[0m19:45:25.569784 [debug] [Thread-1 (]: Began running node test.dbt_idx.not_null_stg_eltool__company_id.632831b79c
[0m19:45:25.572796 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_idx.source_unique_IDX-Schema_orders_order_id.5a8ef486ee, now test.dbt_idx.not_null_stg_eltool__company_id.632831b79c)
[0m19:45:25.573787 [debug] [Thread-1 (]: Began compiling node test.dbt_idx.not_null_stg_eltool__company_id.632831b79c
[0m19:45:25.581294 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_idx.not_null_stg_eltool__company_id.632831b79c"
[0m19:45:25.589303 [debug] [Thread-1 (]: Timing info for test.dbt_idx.not_null_stg_eltool__company_id.632831b79c (compile): 19:45:25.573787 => 19:45:25.589303
[0m19:45:25.590305 [debug] [Thread-1 (]: Began executing node test.dbt_idx.not_null_stg_eltool__company_id.632831b79c
[0m19:45:25.592303 [debug] [Thread-1 (]: Timing info for test.dbt_idx.not_null_stg_eltool__company_id.632831b79c (execute): 19:45:25.591303 => 19:45:25.591303
[0m19:45:25.594818 [debug] [Thread-1 (]: Finished running node test.dbt_idx.not_null_stg_eltool__company_id.632831b79c
[0m19:45:25.596831 [debug] [Thread-1 (]: Began running node model.dbt_idx.fact_orders
[0m19:45:25.597830 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_idx.not_null_stg_eltool__company_id.632831b79c, now model.dbt_idx.fact_orders)
[0m19:45:25.597830 [debug] [Thread-1 (]: Began compiling node model.dbt_idx.fact_orders
[0m19:45:25.602346 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_idx.fact_orders"
[0m19:45:25.608347 [debug] [Thread-1 (]: Timing info for model.dbt_idx.fact_orders (compile): 19:45:25.599336 => 19:45:25.608347
[0m19:45:25.610348 [debug] [Thread-1 (]: Began executing node model.dbt_idx.fact_orders
[0m19:45:25.611348 [debug] [Thread-1 (]: Timing info for model.dbt_idx.fact_orders (execute): 19:45:25.611348 => 19:45:25.611348
[0m19:45:25.613345 [debug] [Thread-1 (]: Finished running node model.dbt_idx.fact_orders
[0m19:45:25.613345 [debug] [Thread-1 (]: Began running node model.dbt_idx.fact_stocks
[0m19:45:25.615345 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_idx.fact_orders, now model.dbt_idx.fact_stocks)
[0m19:45:25.615345 [debug] [Thread-1 (]: Began compiling node model.dbt_idx.fact_stocks
[0m19:45:25.619349 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_idx.fact_stocks"
[0m19:45:25.628347 [debug] [Thread-1 (]: Timing info for model.dbt_idx.fact_stocks (compile): 19:45:25.616347 => 19:45:25.627349
[0m19:45:25.629345 [debug] [Thread-1 (]: Began executing node model.dbt_idx.fact_stocks
[0m19:45:25.629345 [debug] [Thread-1 (]: Timing info for model.dbt_idx.fact_stocks (execute): 19:45:25.629345 => 19:45:25.629345
[0m19:45:25.631345 [debug] [Thread-1 (]: Finished running node model.dbt_idx.fact_stocks
[0m19:45:25.632344 [debug] [Thread-1 (]: Began running node test.dbt_idx.not_null_stg_eltool__stock_id.68f6d1d89a
[0m19:45:25.633348 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_idx.fact_stocks, now test.dbt_idx.not_null_stg_eltool__stock_id.68f6d1d89a)
[0m19:45:25.634361 [debug] [Thread-1 (]: Began compiling node test.dbt_idx.not_null_stg_eltool__stock_id.68f6d1d89a
[0m19:45:25.641349 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_idx.not_null_stg_eltool__stock_id.68f6d1d89a"
[0m19:45:25.647346 [debug] [Thread-1 (]: Timing info for test.dbt_idx.not_null_stg_eltool__stock_id.68f6d1d89a (compile): 19:45:25.635345 => 19:45:25.647346
[0m19:45:25.648347 [debug] [Thread-1 (]: Began executing node test.dbt_idx.not_null_stg_eltool__stock_id.68f6d1d89a
[0m19:45:25.649344 [debug] [Thread-1 (]: Timing info for test.dbt_idx.not_null_stg_eltool__stock_id.68f6d1d89a (execute): 19:45:25.649344 => 19:45:25.649344
[0m19:45:25.650344 [debug] [Thread-1 (]: Finished running node test.dbt_idx.not_null_stg_eltool__stock_id.68f6d1d89a
[0m19:45:25.651343 [debug] [Thread-1 (]: Began running node model.dbt_idx.stg_eltool__customers_snapshots
[0m19:45:25.652344 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_idx.not_null_stg_eltool__stock_id.68f6d1d89a, now model.dbt_idx.stg_eltool__customers_snapshots)
[0m19:45:25.653346 [debug] [Thread-1 (]: Began compiling node model.dbt_idx.stg_eltool__customers_snapshots
[0m19:45:25.658344 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_idx.stg_eltool__customers_snapshots"
[0m19:45:25.665346 [debug] [Thread-1 (]: Timing info for model.dbt_idx.stg_eltool__customers_snapshots (compile): 19:45:25.655349 => 19:45:25.664349
[0m19:45:25.666343 [debug] [Thread-1 (]: Began executing node model.dbt_idx.stg_eltool__customers_snapshots
[0m19:45:25.667344 [debug] [Thread-1 (]: Timing info for model.dbt_idx.stg_eltool__customers_snapshots (execute): 19:45:25.666343 => 19:45:25.666343
[0m19:45:25.668345 [debug] [Thread-1 (]: Finished running node model.dbt_idx.stg_eltool__customers_snapshots
[0m19:45:25.669348 [debug] [Thread-1 (]: Began running node model.dbt_idx.stock_update_status
[0m19:45:25.671348 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_idx.stg_eltool__customers_snapshots, now model.dbt_idx.stock_update_status)
[0m19:45:25.672359 [debug] [Thread-1 (]: Began compiling node model.dbt_idx.stock_update_status
[0m19:45:25.675343 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_idx.stock_update_status"
[0m19:45:25.682354 [debug] [Thread-1 (]: Timing info for model.dbt_idx.stock_update_status (compile): 19:45:25.672359 => 19:45:25.682354
[0m19:45:25.683350 [debug] [Thread-1 (]: Began executing node model.dbt_idx.stock_update_status
[0m19:45:25.684376 [debug] [Thread-1 (]: Timing info for model.dbt_idx.stock_update_status (execute): 19:45:25.684376 => 19:45:25.684376
[0m19:45:25.687357 [debug] [Thread-1 (]: Finished running node model.dbt_idx.stock_update_status
[0m19:45:25.688358 [debug] [Thread-1 (]: Began running node test.dbt_idx.assert_stock_fact_has_no_row_loss.sql
[0m19:45:25.690361 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_idx.stock_update_status, now test.dbt_idx.assert_stock_fact_has_no_row_loss.sql)
[0m19:45:25.692350 [debug] [Thread-1 (]: Began compiling node test.dbt_idx.assert_stock_fact_has_no_row_loss.sql
[0m19:45:25.697889 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_idx.assert_stock_fact_has_no_row_loss.sql"
[0m19:45:25.704553 [debug] [Thread-1 (]: Timing info for test.dbt_idx.assert_stock_fact_has_no_row_loss.sql (compile): 19:45:25.692350 => 19:45:25.703552
[0m19:45:25.705553 [debug] [Thread-1 (]: Began executing node test.dbt_idx.assert_stock_fact_has_no_row_loss.sql
[0m19:45:25.706557 [debug] [Thread-1 (]: Timing info for test.dbt_idx.assert_stock_fact_has_no_row_loss.sql (execute): 19:45:25.705553 => 19:45:25.705553
[0m19:45:25.707587 [debug] [Thread-1 (]: Finished running node test.dbt_idx.assert_stock_fact_has_no_row_loss.sql
[0m19:45:25.708552 [debug] [Thread-1 (]: Began running node test.dbt_idx.not_null_fact_stocks_id.e7b7e788fa
[0m19:45:25.711584 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_idx.assert_stock_fact_has_no_row_loss.sql, now test.dbt_idx.not_null_fact_stocks_id.e7b7e788fa)
[0m19:45:25.712609 [debug] [Thread-1 (]: Began compiling node test.dbt_idx.not_null_fact_stocks_id.e7b7e788fa
[0m19:45:25.718566 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_idx.not_null_fact_stocks_id.e7b7e788fa"
[0m19:45:25.725615 [debug] [Thread-1 (]: Timing info for test.dbt_idx.not_null_fact_stocks_id.e7b7e788fa (compile): 19:45:25.713551 => 19:45:25.724617
[0m19:45:25.726611 [debug] [Thread-1 (]: Began executing node test.dbt_idx.not_null_fact_stocks_id.e7b7e788fa
[0m19:45:25.727654 [debug] [Thread-1 (]: Timing info for test.dbt_idx.not_null_fact_stocks_id.e7b7e788fa (execute): 19:45:25.726611 => 19:45:25.726611
[0m19:45:25.728610 [debug] [Thread-1 (]: Finished running node test.dbt_idx.not_null_fact_stocks_id.e7b7e788fa
[0m19:45:25.729610 [debug] [Thread-1 (]: Began running node model.dbt_idx.dim_customers
[0m19:45:25.730611 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_idx.not_null_fact_stocks_id.e7b7e788fa, now model.dbt_idx.dim_customers)
[0m19:45:25.730611 [debug] [Thread-1 (]: Began compiling node model.dbt_idx.dim_customers
[0m19:45:25.736619 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_idx.dim_customers"
[0m19:45:25.745614 [debug] [Thread-1 (]: Timing info for model.dbt_idx.dim_customers (compile): 19:45:25.731639 => 19:45:25.744612
[0m19:45:25.746612 [debug] [Thread-1 (]: Began executing node model.dbt_idx.dim_customers
[0m19:45:25.747617 [debug] [Thread-1 (]: Timing info for model.dbt_idx.dim_customers (execute): 19:45:25.746612 => 19:45:25.746612
[0m19:45:25.749617 [debug] [Thread-1 (]: Finished running node model.dbt_idx.dim_customers
[0m19:45:25.749617 [debug] [Thread-1 (]: Began running node test.dbt_idx.not_null_stg_eltool__customers_snapshots_customer_id.ea4fc4ca86
[0m19:45:25.751625 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_idx.dim_customers, now test.dbt_idx.not_null_stg_eltool__customers_snapshots_customer_id.ea4fc4ca86)
[0m19:45:25.752611 [debug] [Thread-1 (]: Began compiling node test.dbt_idx.not_null_stg_eltool__customers_snapshots_customer_id.ea4fc4ca86
[0m19:45:25.758614 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_idx.not_null_stg_eltool__customers_snapshots_customer_id.ea4fc4ca86"
[0m19:45:25.766011 [debug] [Thread-1 (]: Timing info for test.dbt_idx.not_null_stg_eltool__customers_snapshots_customer_id.ea4fc4ca86 (compile): 19:45:25.753612 => 19:45:25.765009
[0m19:45:25.767026 [debug] [Thread-1 (]: Began executing node test.dbt_idx.not_null_stg_eltool__customers_snapshots_customer_id.ea4fc4ca86
[0m19:45:25.767026 [debug] [Thread-1 (]: Timing info for test.dbt_idx.not_null_stg_eltool__customers_snapshots_customer_id.ea4fc4ca86 (execute): 19:45:25.767026 => 19:45:25.767026
[0m19:45:25.769031 [debug] [Thread-1 (]: Finished running node test.dbt_idx.not_null_stg_eltool__customers_snapshots_customer_id.ea4fc4ca86
[0m19:45:25.770918 [debug] [Thread-1 (]: Began running node test.dbt_idx.not_null_stock_update_status_id.633bc8afe3
[0m19:45:25.772134 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_idx.not_null_stg_eltool__customers_snapshots_customer_id.ea4fc4ca86, now test.dbt_idx.not_null_stock_update_status_id.633bc8afe3)
[0m19:45:25.773285 [debug] [Thread-1 (]: Began compiling node test.dbt_idx.not_null_stock_update_status_id.633bc8afe3
[0m19:45:25.780914 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_idx.not_null_stock_update_status_id.633bc8afe3"
[0m19:45:25.787921 [debug] [Thread-1 (]: Timing info for test.dbt_idx.not_null_stock_update_status_id.633bc8afe3 (compile): 19:45:25.773822 => 19:45:25.787921
[0m19:45:25.788921 [debug] [Thread-1 (]: Began executing node test.dbt_idx.not_null_stock_update_status_id.633bc8afe3
[0m19:45:25.789922 [debug] [Thread-1 (]: Timing info for test.dbt_idx.not_null_stock_update_status_id.633bc8afe3 (execute): 19:45:25.789922 => 19:45:25.789922
[0m19:45:25.790921 [debug] [Thread-1 (]: Finished running node test.dbt_idx.not_null_stock_update_status_id.633bc8afe3
[0m19:45:25.791946 [debug] [Thread-1 (]: Began running node model.dbt_idx.customer_orders_status
[0m19:45:25.792919 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_idx.not_null_stock_update_status_id.633bc8afe3, now model.dbt_idx.customer_orders_status)
[0m19:45:25.793923 [debug] [Thread-1 (]: Began compiling node model.dbt_idx.customer_orders_status
[0m19:45:25.800473 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_idx.customer_orders_status"
[0m19:45:25.806480 [debug] [Thread-1 (]: Timing info for model.dbt_idx.customer_orders_status (compile): 19:45:25.794926 => 19:45:25.806480
[0m19:45:25.807475 [debug] [Thread-1 (]: Began executing node model.dbt_idx.customer_orders_status
[0m19:45:25.808479 [debug] [Thread-1 (]: Timing info for model.dbt_idx.customer_orders_status (execute): 19:45:25.808479 => 19:45:25.808479
[0m19:45:25.810501 [debug] [Thread-1 (]: Finished running node model.dbt_idx.customer_orders_status
[0m19:45:25.811479 [debug] [Thread-1 (]: Began running node test.dbt_idx.assert_customer_dimension_has_no_row_loss.sql
[0m19:45:25.812474 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_idx.customer_orders_status, now test.dbt_idx.assert_customer_dimension_has_no_row_loss.sql)
[0m19:45:25.813478 [debug] [Thread-1 (]: Began compiling node test.dbt_idx.assert_customer_dimension_has_no_row_loss.sql
[0m19:45:25.817473 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_idx.assert_customer_dimension_has_no_row_loss.sql"
[0m19:45:25.823477 [debug] [Thread-1 (]: Timing info for test.dbt_idx.assert_customer_dimension_has_no_row_loss.sql (compile): 19:45:25.813478 => 19:45:25.822506
[0m19:45:25.823477 [debug] [Thread-1 (]: Began executing node test.dbt_idx.assert_customer_dimension_has_no_row_loss.sql
[0m19:45:25.824473 [debug] [Thread-1 (]: Timing info for test.dbt_idx.assert_customer_dimension_has_no_row_loss.sql (execute): 19:45:25.824473 => 19:45:25.824473
[0m19:45:25.826481 [debug] [Thread-1 (]: Finished running node test.dbt_idx.assert_customer_dimension_has_no_row_loss.sql
[0m19:45:25.827504 [debug] [Thread-1 (]: Began running node test.dbt_idx.not_null_dim_customers_customer_id.dd91cd1c8d
[0m19:45:25.828476 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_idx.assert_customer_dimension_has_no_row_loss.sql, now test.dbt_idx.not_null_dim_customers_customer_id.dd91cd1c8d)
[0m19:45:25.829501 [debug] [Thread-1 (]: Began compiling node test.dbt_idx.not_null_dim_customers_customer_id.dd91cd1c8d
[0m19:45:25.834473 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_idx.not_null_dim_customers_customer_id.dd91cd1c8d"
[0m19:45:25.842490 [debug] [Thread-1 (]: Timing info for test.dbt_idx.not_null_dim_customers_customer_id.dd91cd1c8d (compile): 19:45:25.830500 => 19:45:25.842490
[0m19:45:25.843474 [debug] [Thread-1 (]: Began executing node test.dbt_idx.not_null_dim_customers_customer_id.dd91cd1c8d
[0m19:45:25.844474 [debug] [Thread-1 (]: Timing info for test.dbt_idx.not_null_dim_customers_customer_id.dd91cd1c8d (execute): 19:45:25.844474 => 19:45:25.844474
[0m19:45:25.846475 [debug] [Thread-1 (]: Finished running node test.dbt_idx.not_null_dim_customers_customer_id.dd91cd1c8d
[0m19:45:25.847510 [debug] [Thread-1 (]: Began running node test.dbt_idx.accepted_values_customer_orders_status_order_status__delivered__invoiced__shipped__processing__canceled__unavailable.ea8c296d27
[0m19:45:25.848474 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_idx.not_null_dim_customers_customer_id.dd91cd1c8d, now test.dbt_idx.accepted_values_customer_orders_status_order_status__delivered__invoiced__shipped__processing__canceled__unavailable.ea8c296d27)
[0m19:45:25.849499 [debug] [Thread-1 (]: Began compiling node test.dbt_idx.accepted_values_customer_orders_status_order_status__delivered__invoiced__shipped__processing__canceled__unavailable.ea8c296d27
[0m19:45:25.866487 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_idx.accepted_values_customer_orders_status_order_status__delivered__invoiced__shipped__processing__canceled__unavailable.ea8c296d27"
[0m19:45:25.872600 [debug] [Thread-1 (]: Timing info for test.dbt_idx.accepted_values_customer_orders_status_order_status__delivered__invoiced__shipped__processing__canceled__unavailable.ea8c296d27 (compile): 19:45:25.850474 => 19:45:25.871582
[0m19:45:25.873550 [debug] [Thread-1 (]: Began executing node test.dbt_idx.accepted_values_customer_orders_status_order_status__delivered__invoiced__shipped__processing__canceled__unavailable.ea8c296d27
[0m19:45:25.874551 [debug] [Thread-1 (]: Timing info for test.dbt_idx.accepted_values_customer_orders_status_order_status__delivered__invoiced__shipped__processing__canceled__unavailable.ea8c296d27 (execute): 19:45:25.874551 => 19:45:25.874551
[0m19:45:25.875585 [debug] [Thread-1 (]: Finished running node test.dbt_idx.accepted_values_customer_orders_status_order_status__delivered__invoiced__shipped__processing__canceled__unavailable.ea8c296d27
[0m19:45:25.876550 [debug] [Thread-1 (]: Began running node test.dbt_idx.not_null_customer_orders_status_customer_id.3915c814eb
[0m19:45:25.877573 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_idx.accepted_values_customer_orders_status_order_status__delivered__invoiced__shipped__processing__canceled__unavailable.ea8c296d27, now test.dbt_idx.not_null_customer_orders_status_customer_id.3915c814eb)
[0m19:45:25.878595 [debug] [Thread-1 (]: Began compiling node test.dbt_idx.not_null_customer_orders_status_customer_id.3915c814eb
[0m19:45:25.882595 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_idx.not_null_customer_orders_status_customer_id.3915c814eb"
[0m19:45:25.890625 [debug] [Thread-1 (]: Timing info for test.dbt_idx.not_null_customer_orders_status_customer_id.3915c814eb (compile): 19:45:25.879550 => 19:45:25.889593
[0m19:45:25.891564 [debug] [Thread-1 (]: Began executing node test.dbt_idx.not_null_customer_orders_status_customer_id.3915c814eb
[0m19:45:25.892558 [debug] [Thread-1 (]: Timing info for test.dbt_idx.not_null_customer_orders_status_customer_id.3915c814eb (execute): 19:45:25.891564 => 19:45:25.891564
[0m19:45:25.893557 [debug] [Thread-1 (]: Finished running node test.dbt_idx.not_null_customer_orders_status_customer_id.3915c814eb
[0m19:45:25.895063 [debug] [Thread-1 (]: Began running node test.dbt_idx.unique_customer_orders_status_order_id.b7a45e83ee
[0m19:45:25.897073 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_idx.not_null_customer_orders_status_customer_id.3915c814eb, now test.dbt_idx.unique_customer_orders_status_order_id.b7a45e83ee)
[0m19:45:25.898072 [debug] [Thread-1 (]: Began compiling node test.dbt_idx.unique_customer_orders_status_order_id.b7a45e83ee
[0m19:45:25.902070 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_idx.unique_customer_orders_status_order_id.b7a45e83ee"
[0m19:45:25.911267 [debug] [Thread-1 (]: Timing info for test.dbt_idx.unique_customer_orders_status_order_id.b7a45e83ee (compile): 19:45:25.898072 => 19:45:25.911267
[0m19:45:25.912269 [debug] [Thread-1 (]: Began executing node test.dbt_idx.unique_customer_orders_status_order_id.b7a45e83ee
[0m19:45:25.913268 [debug] [Thread-1 (]: Timing info for test.dbt_idx.unique_customer_orders_status_order_id.b7a45e83ee (execute): 19:45:25.913268 => 19:45:25.913268
[0m19:45:25.915270 [debug] [Thread-1 (]: Finished running node test.dbt_idx.unique_customer_orders_status_order_id.b7a45e83ee
[0m19:45:25.918277 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:45:25.920267 [debug] [MainThread]: Connection 'list_IDX-Stock_snapshots' was properly closed.
[0m19:45:25.921267 [debug] [MainThread]: Connection 'test.dbt_idx.unique_customer_orders_status_order_id.b7a45e83ee' was properly closed.
[0m19:45:25.931782 [debug] [MainThread]: Command end result
[0m19:45:26.393153 [debug] [MainThread]: Acquiring new postgres connection 'generate_catalog'
[0m19:45:26.394180 [info ] [MainThread]: Building catalog
[0m19:45:26.397719 [debug] [ThreadPool]: Acquiring new postgres connection 'IDX-Stock.information_schema'
[0m19:45:26.407700 [debug] [ThreadPool]: Using postgres connection "IDX-Stock.information_schema"
[0m19:45:26.408697 [debug] [ThreadPool]: On IDX-Stock.information_schema: BEGIN
[0m19:45:26.409728 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:45:26.437702 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m19:45:26.438700 [debug] [ThreadPool]: Using postgres connection "IDX-Stock.information_schema"
[0m19:45:26.440701 [debug] [ThreadPool]: On IDX-Stock.information_schema: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "connection_name": "IDX-Stock.information_schema"} */

    
    

    select
        'IDX-Stock' as table_database,
        sch.nspname as table_schema,
        tbl.relname as table_name,
        case tbl.relkind
            when 'v' then 'VIEW'
            else 'BASE TABLE'
        end as table_type,
        tbl_desc.description as table_comment,
        col.attname as column_name,
        col.attnum as column_index,
        pg_catalog.format_type(col.atttypid, col.atttypmod) as column_type,
        col_desc.description as column_comment,
        pg_get_userbyid(tbl.relowner) as table_owner

    from pg_catalog.pg_namespace sch
    join pg_catalog.pg_class tbl on tbl.relnamespace = sch.oid
    join pg_catalog.pg_attribute col on col.attrelid = tbl.oid
    left outer join pg_catalog.pg_description tbl_desc on (tbl_desc.objoid = tbl.oid and tbl_desc.objsubid = 0)
    left outer join pg_catalog.pg_description col_desc on (col_desc.objoid = tbl.oid and col_desc.objsubid = col.attnum)

    where (upper(sch.nspname) = upper('idx-schema') or upper(sch.nspname) = upper('snapshots'))
      and not pg_is_other_temp_schema(sch.oid) -- not a temporary schema belonging to another session
      and tbl.relpersistence in ('p', 'u') -- [p]ermanent table or [u]nlogged table. Exclude [t]emporary tables
      and tbl.relkind in ('r', 'v', 'f', 'p') -- o[r]dinary table, [v]iew, [f]oreign table, [p]artitioned table. Other values are [i]ndex, [S]equence, [c]omposite type, [t]OAST table, [m]aterialized view
      and col.attnum > 0 -- negative numbers are used for system columns such as oid
      and not col.attisdropped -- column as not been dropped

    order by
        sch.nspname,
        tbl.relname,
        col.attnum
[0m19:45:26.449717 [debug] [ThreadPool]: SQL status: SELECT 130 in 0.0 seconds
[0m19:45:26.461696 [debug] [ThreadPool]: On IDX-Stock.information_schema: ROLLBACK
[0m19:45:26.464700 [debug] [ThreadPool]: On IDX-Stock.information_schema: Close
[0m19:45:26.519926 [info ] [MainThread]: Catalog written to D:\00 Project\00 My Project\IdeaProjects\Py-DBT-IDX\target\catalog.json
[0m19:45:26.521925 [debug] [MainThread]: Command `dbt docs generate` succeeded at 19:45:26.521925 after 2.14 seconds
[0m19:45:26.522978 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
[0m19:45:26.523927 [debug] [MainThread]: Connection 'IDX-Stock.information_schema' was properly closed.
[0m19:45:26.524928 [debug] [MainThread]: Flushing usage events


============================== 19:45:46.050973 | 9428969f-4685-43ba-9a4e-de0beb631ebe ==============================
[0m19:45:46.050973 [info ] [MainThread]: Running with dbt=1.6.1
[0m19:45:46.056972 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'D:\\00 Project\\00 My Project\\IdeaProjects\\Py-DBT-IDX', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': 'D:\\00 Project\\00 My Project\\IdeaProjects\\Py-DBT-IDX\\logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt docs serve', 'send_anonymous_usage_stats': 'False'}
[0m22:26:07.510497 [error] [MainThread]: Encountered an error:

[0m22:26:07.560045 [error] [MainThread]: Traceback (most recent call last):
  File "C:\Users\dmitr\Py-DBT-IDX\Lib\site-packages\dbt\cli\requires.py", line 87, in wrapper
    result, success = func(*args, **kwargs)
                      ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\dmitr\Py-DBT-IDX\Lib\site-packages\dbt\cli\requires.py", line 72, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\dmitr\Py-DBT-IDX\Lib\site-packages\dbt\cli\requires.py", line 143, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\dmitr\Py-DBT-IDX\Lib\site-packages\dbt\cli\requires.py", line 172, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\dmitr\Py-DBT-IDX\Lib\site-packages\dbt\cli\requires.py", line 219, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\dmitr\Py-DBT-IDX\Lib\site-packages\dbt\cli\main.py", line 307, in docs_serve
    results = task.run()
              ^^^^^^^^^^
  File "C:\Users\dmitr\Py-DBT-IDX\Lib\site-packages\dbt\task\serve.py", line 28, in run
    httpd.serve_forever()
  File "C:\Python311\Lib\socketserver.py", line 233, in serve_forever
    ready = selector.select(poll_interval)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Python311\Lib\selectors.py", line 323, in select
    r, w, _ = self._select(self._readers, self._writers, [], timeout)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Python311\Lib\selectors.py", line 314, in _select
    r, w, x = select.select(r, w, w, timeout)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
KeyboardInterrupt

[0m22:26:07.569047 [debug] [MainThread]: Command `dbt docs serve` failed at 22:26:07.568048 after 9621.56 seconds
[0m22:26:07.577047 [debug] [MainThread]: Flushing usage events


============================== 22:27:09.662234 | 5f71d263-1f2b-4f59-933b-ac4e4a3e843c ==============================
[0m22:27:09.662234 [info ] [MainThread]: Running with dbt=1.6.1
[0m22:27:09.666873 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'D:\\00 Project\\00 My Project\\IdeaProjects\\Py-DBT-IDX', 'version_check': 'True', 'debug': 'False', 'log_path': 'D:\\00 Project\\00 My Project\\IdeaProjects\\Py-DBT-IDX\\logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'False'}
[0m22:27:09.786126 [info ] [MainThread]: Registered adapter: postgres=1.6.1
[0m22:27:09.796092 [debug] [MainThread]: checksum: efe19d9f5b93d1a98cc804fbfcdb6b3aced98b974af664946fee1cde8837deb7, vars: {}, profile: , target: , version: 1.6.1
[0m22:27:09.806125 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m22:27:10.760102 [info ] [MainThread]: Found 11 models, 1 snapshot, 19 tests, 5 sources, 0 exposures, 0 metrics, 349 macros, 0 groups, 0 semantic models
[0m22:27:10.764145 [info ] [MainThread]: 
[0m22:27:10.766363 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m22:27:10.770979 [debug] [ThreadPool]: Acquiring new postgres connection 'list_IDX-Stock'
[0m22:27:10.781569 [debug] [ThreadPool]: Using postgres connection "list_IDX-Stock"
[0m22:27:10.782575 [debug] [ThreadPool]: On list_IDX-Stock: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "connection_name": "list_IDX-Stock"} */

    select distinct nspname from pg_namespace
  
[0m22:27:10.783574 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:27:13.507050 [debug] [ThreadPool]: Postgres adapter: Got a retryable error when attempting to open a postgres connection.
1 attempts remaining. Retrying in 0 seconds.
Error:
could not translate host name "postgres" to address: Unknown host

[0m22:27:16.211259 [debug] [ThreadPool]: Postgres adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "connection_name": "list_IDX-Stock"} */

    select distinct nspname from pg_namespace
  
[0m22:27:16.212230 [debug] [ThreadPool]: Postgres adapter: Rolling back transaction.
[0m22:27:16.213232 [debug] [ThreadPool]: Postgres adapter: Error running SQL: macro list_schemas
[0m22:27:16.213232 [debug] [ThreadPool]: Postgres adapter: Rolling back transaction.
[0m22:27:16.214231 [debug] [ThreadPool]: On list_IDX-Stock: No close available on handle
[0m22:27:16.215230 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:27:16.216263 [debug] [MainThread]: Connection 'list_IDX-Stock' was properly closed.
[0m22:27:16.217227 [info ] [MainThread]: 
[0m22:27:16.218233 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 5.45 seconds (5.45s).
[0m22:27:16.219244 [error] [MainThread]: Encountered an error:
Database Error
  could not translate host name "postgres" to address: Unknown host
  
[0m22:27:16.220250 [debug] [MainThread]: Command `dbt run` failed at 22:27:16.220250 after 6.60 seconds
[0m22:27:16.221240 [debug] [MainThread]: Flushing usage events


============================== 15:59:23.654460 | 3018f7a8-1214-4447-b4fa-601da8da4f4c ==============================
[0m15:59:23.654460 [info ] [MainThread]: Running with dbt=1.5.6
[0m15:59:23.684257 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/dags/Py-DBT-IDX/logs', 'profiles_dir': '/opt/airflow/dags/Py-DBT-IDX', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'False'}
[0m15:59:24.129688 [info ] [MainThread]: Registered adapter: postgres=1.5.6
[0m15:59:24.187951 [debug] [MainThread]: checksum: 36b91491eb2b55e69ff526c98e337edadb953c9826242889489b2fea40332ad6, vars: {}, profile: , target: , version: 1.5.6
[0m15:59:24.231353 [info ] [MainThread]: Unable to do partial parsing because of a version mismatch
[0m15:59:27.443664 [debug] [MainThread]: 1699: static parser successfully parsed marts/core/dim_customers.sql
[0m15:59:27.488731 [debug] [MainThread]: 1699: static parser successfully parsed marts/core/fact_orders.sql
[0m15:59:27.500146 [debug] [MainThread]: 1699: static parser successfully parsed marts/core/fact_stocks.sql
[0m15:59:27.509787 [debug] [MainThread]: 1699: static parser successfully parsed marts/marketing/customer_orders_status.sql
[0m15:59:27.519517 [debug] [MainThread]: 1699: static parser successfully parsed marts/stock/stock_update_status.sql
[0m15:59:27.529600 [debug] [MainThread]: 1699: static parser successfully parsed staging/stg_eltool__company.sql
[0m15:59:27.538866 [debug] [MainThread]: 1699: static parser successfully parsed staging/stg_eltool__customers.sql
[0m15:59:27.552506 [debug] [MainThread]: 1699: static parser successfully parsed staging/stg_eltool__customers_snapshots.sql
[0m15:59:27.562416 [debug] [MainThread]: 1699: static parser successfully parsed staging/stg_eltool__orders.sql
[0m15:59:27.572787 [debug] [MainThread]: 1699: static parser successfully parsed staging/stg_eltool__state.sql
[0m15:59:27.582165 [debug] [MainThread]: 1699: static parser successfully parsed staging/stg_eltool__stock.sql
[0m15:59:28.291204 [info ] [MainThread]: Found 11 models, 19 tests, 1 snapshot, 0 analyses, 307 macros, 0 operations, 0 seed files, 5 sources, 0 exposures, 0 metrics, 0 groups
[0m15:59:28.295076 [info ] [MainThread]: 
[0m15:59:28.296363 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m15:59:28.298125 [debug] [MainThread]: Command end result
[0m15:59:28.343117 [info ] [MainThread]: 
[0m15:59:28.344737 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:59:28.346072 [info ] [MainThread]: 
[0m15:59:28.347364 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=0 SKIP=0 TOTAL=0
[0m15:59:28.349991 [debug] [MainThread]: Command `dbt seed` succeeded at 15:59:28.349710 after 4.78 seconds
[0m15:59:28.351888 [debug] [MainThread]: Flushing usage events


============================== 15:59:35.466472 | b09840b0-35d1-4498-9e4e-e3a3b12b1179 ==============================
[0m15:59:35.466472 [info ] [MainThread]: Running with dbt=1.5.6
[0m15:59:35.482699 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/opt/airflow/dags/Py-DBT-IDX', 'log_path': '/opt/airflow/dags/Py-DBT-IDX/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'send_anonymous_usage_stats': 'False'}
[0m15:59:35.797195 [info ] [MainThread]: Registered adapter: postgres=1.5.6
[0m15:59:35.831817 [debug] [MainThread]: checksum: 36b91491eb2b55e69ff526c98e337edadb953c9826242889489b2fea40332ad6, vars: {}, profile: , target: , version: 1.5.6
[0m15:59:36.926244 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:59:36.927328 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:59:36.989212 [info ] [MainThread]: Found 11 models, 19 tests, 1 snapshot, 0 analyses, 307 macros, 0 operations, 0 seed files, 5 sources, 0 exposures, 0 metrics, 0 groups
[0m15:59:36.993484 [info ] [MainThread]: 
[0m15:59:36.995260 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m15:59:36.997566 [debug] [ThreadPool]: Acquiring new postgres connection 'list_IDX-Stock'
[0m15:59:37.014761 [debug] [ThreadPool]: Using postgres connection "list_IDX-Stock"
[0m15:59:37.016129 [debug] [ThreadPool]: On list_IDX-Stock: /* {"app": "dbt", "dbt_version": "1.5.6", "profile_name": "dbt_idx", "target_name": "dev", "connection_name": "list_IDX-Stock"} */

    select distinct nspname from pg_namespace
  
[0m15:59:37.017093 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:59:37.023087 [debug] [ThreadPool]: Postgres adapter: Got a retryable error when attempting to open a postgres connection.
1 attempts remaining. Retrying in 0 seconds.
Error:
connection to server at "postgres" (172.30.0.2), port 5432 failed: FATAL:  password authentication failed for user "postgres"

[0m15:59:37.028168 [debug] [ThreadPool]: Postgres adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.5.6", "profile_name": "dbt_idx", "target_name": "dev", "connection_name": "list_IDX-Stock"} */

    select distinct nspname from pg_namespace
  
[0m15:59:37.029357 [debug] [ThreadPool]: Postgres adapter: Rolling back transaction.
[0m15:59:37.030727 [debug] [ThreadPool]: Postgres adapter: Error running SQL: macro list_schemas
[0m15:59:37.032216 [debug] [ThreadPool]: Postgres adapter: Rolling back transaction.
[0m15:59:37.033267 [debug] [ThreadPool]: On list_IDX-Stock: No close available on handle
[0m15:59:37.035639 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:59:37.036970 [debug] [MainThread]: Connection 'list_IDX-Stock' was properly closed.
[0m15:59:37.038643 [info ] [MainThread]: 
[0m15:59:37.041305 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 0.04 seconds (0.04s).
[0m15:59:37.043229 [error] [MainThread]: Encountered an error:
Database Error
  connection to server at "postgres" (172.30.0.2), port 5432 failed: FATAL:  password authentication failed for user "postgres"
  
[0m15:59:37.045674 [debug] [MainThread]: Command `dbt snapshot` failed at 15:59:37.045263 after 1.62 seconds
[0m15:59:37.047779 [debug] [MainThread]: Flushing usage events


============================== 16:04:02.966422 | b8481432-2b69-4773-8154-129e2ad3c3a9 ==============================
[0m16:04:02.966422 [info ] [MainThread]: Running with dbt=1.5.6
[0m16:04:02.975234 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/opt/airflow/dags/Py-DBT-IDX/logs', 'profiles_dir': '/opt/airflow/dags/Py-DBT-IDX', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'send_anonymous_usage_stats': 'False'}
[0m16:04:03.183443 [info ] [MainThread]: Registered adapter: postgres=1.5.6
[0m16:04:03.220493 [debug] [MainThread]: checksum: 36b91491eb2b55e69ff526c98e337edadb953c9826242889489b2fea40332ad6, vars: {}, profile: , target: , version: 1.5.6
[0m16:04:04.437660 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:04:04.438789 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:04:04.515591 [info ] [MainThread]: Found 11 models, 19 tests, 1 snapshot, 0 analyses, 307 macros, 0 operations, 0 seed files, 5 sources, 0 exposures, 0 metrics, 0 groups
[0m16:04:04.522491 [info ] [MainThread]: 
[0m16:04:04.525798 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m16:04:04.529962 [debug] [ThreadPool]: Acquiring new postgres connection 'list_IDX-Stock'
[0m16:04:04.553575 [debug] [ThreadPool]: Using postgres connection "list_IDX-Stock"
[0m16:04:04.555469 [debug] [ThreadPool]: On list_IDX-Stock: /* {"app": "dbt", "dbt_version": "1.5.6", "profile_name": "dbt_idx", "target_name": "dev", "connection_name": "list_IDX-Stock"} */

    select distinct nspname from pg_namespace
  
[0m16:04:04.557517 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:04:04.566243 [debug] [ThreadPool]: Postgres adapter: Got a retryable error when attempting to open a postgres connection.
1 attempts remaining. Retrying in 0 seconds.
Error:
connection to server at "postgres" (172.30.0.2), port 5432 failed: FATAL:  password authentication failed for user "postgres"

[0m16:04:04.573198 [debug] [ThreadPool]: Postgres adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.5.6", "profile_name": "dbt_idx", "target_name": "dev", "connection_name": "list_IDX-Stock"} */

    select distinct nspname from pg_namespace
  
[0m16:04:04.574468 [debug] [ThreadPool]: Postgres adapter: Rolling back transaction.
[0m16:04:04.575764 [debug] [ThreadPool]: Postgres adapter: Error running SQL: macro list_schemas
[0m16:04:04.577254 [debug] [ThreadPool]: Postgres adapter: Rolling back transaction.
[0m16:04:04.579351 [debug] [ThreadPool]: On list_IDX-Stock: No close available on handle
[0m16:04:04.581868 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:04:04.582893 [debug] [MainThread]: Connection 'list_IDX-Stock' was properly closed.
[0m16:04:04.584075 [info ] [MainThread]: 
[0m16:04:04.586671 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 0.06 seconds (0.06s).
[0m16:04:04.589679 [error] [MainThread]: Encountered an error:
Database Error
  connection to server at "postgres" (172.30.0.2), port 5432 failed: FATAL:  password authentication failed for user "postgres"
  
[0m16:04:04.591409 [debug] [MainThread]: Command `dbt snapshot` failed at 16:04:04.591212 after 1.67 seconds
[0m16:04:04.592755 [debug] [MainThread]: Flushing usage events


============================== 16:14:08.721252 | 70595482-c760-4d86-b905-1eeb8c5af65d ==============================
[0m16:14:08.721252 [info ] [MainThread]: Running with dbt=1.5.6
[0m16:14:08.735923 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dags/Py-DBT-IDX', 'debug': 'False', 'warn_error': 'None', 'log_path': '/opt/airflow/dags/Py-DBT-IDX/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'send_anonymous_usage_stats': 'False'}
[0m16:14:09.015578 [info ] [MainThread]: Registered adapter: postgres=1.5.6
[0m16:14:09.052565 [debug] [MainThread]: checksum: 36b91491eb2b55e69ff526c98e337edadb953c9826242889489b2fea40332ad6, vars: {}, profile: , target: , version: 1.5.6
[0m16:14:09.103624 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m16:14:11.830051 [debug] [MainThread]: 1699: static parser successfully parsed marts/core/dim_customers.sql
[0m16:14:11.855565 [debug] [MainThread]: 1699: static parser successfully parsed marts/core/fact_orders.sql
[0m16:14:11.865240 [debug] [MainThread]: 1699: static parser successfully parsed marts/core/fact_stocks.sql
[0m16:14:11.874710 [debug] [MainThread]: 1699: static parser successfully parsed marts/marketing/customer_orders_status.sql
[0m16:14:11.883833 [debug] [MainThread]: 1699: static parser successfully parsed marts/stock/stock_update_status.sql
[0m16:14:11.892750 [debug] [MainThread]: 1699: static parser successfully parsed staging/stg_eltool__company.sql
[0m16:14:11.901989 [debug] [MainThread]: 1699: static parser successfully parsed staging/stg_eltool__customers.sql
[0m16:14:11.910753 [debug] [MainThread]: 1699: static parser successfully parsed staging/stg_eltool__customers_snapshots.sql
[0m16:14:11.919599 [debug] [MainThread]: 1699: static parser successfully parsed staging/stg_eltool__orders.sql
[0m16:14:11.928164 [debug] [MainThread]: 1699: static parser successfully parsed staging/stg_eltool__state.sql
[0m16:14:11.937151 [debug] [MainThread]: 1699: static parser successfully parsed staging/stg_eltool__stock.sql
[0m16:14:12.389333 [info ] [MainThread]: Found 11 models, 19 tests, 1 snapshot, 0 analyses, 307 macros, 0 operations, 0 seed files, 5 sources, 0 exposures, 0 metrics, 0 groups
[0m16:14:12.395611 [info ] [MainThread]: 
[0m16:14:12.398059 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m16:14:12.401681 [debug] [MainThread]: Command end result
[0m16:14:12.457007 [info ] [MainThread]: 
[0m16:14:12.459881 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:14:12.462958 [info ] [MainThread]: 
[0m16:14:12.464773 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=0 SKIP=0 TOTAL=0
[0m16:14:12.467863 [debug] [MainThread]: Command `dbt seed` succeeded at 16:14:12.467503 after 3.79 seconds
[0m16:14:12.469545 [debug] [MainThread]: Flushing usage events


============================== 16:14:18.531082 | 6fae72df-6ba9-4b2d-a797-0cac54d6e6d6 ==============================
[0m16:14:18.531082 [info ] [MainThread]: Running with dbt=1.5.6
[0m16:14:18.543499 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dags/Py-DBT-IDX', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/opt/airflow/dags/Py-DBT-IDX/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'False'}
[0m16:14:18.811412 [info ] [MainThread]: Registered adapter: postgres=1.5.6
[0m16:14:18.871404 [debug] [MainThread]: checksum: 36b91491eb2b55e69ff526c98e337edadb953c9826242889489b2fea40332ad6, vars: {}, profile: , target: , version: 1.5.6
[0m16:14:20.205740 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:14:20.207367 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:14:20.286332 [info ] [MainThread]: Found 11 models, 19 tests, 1 snapshot, 0 analyses, 307 macros, 0 operations, 0 seed files, 5 sources, 0 exposures, 0 metrics, 0 groups
[0m16:14:20.292554 [info ] [MainThread]: 
[0m16:14:20.295042 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m16:14:20.298111 [debug] [ThreadPool]: Acquiring new postgres connection 'list_IDX-Stock'
[0m16:14:20.325300 [debug] [ThreadPool]: Using postgres connection "list_IDX-Stock"
[0m16:14:20.327180 [debug] [ThreadPool]: On list_IDX-Stock: /* {"app": "dbt", "dbt_version": "1.5.6", "profile_name": "dbt_idx", "target_name": "dev", "connection_name": "list_IDX-Stock"} */

    select distinct nspname from pg_namespace
  
[0m16:14:20.328243 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:14:20.346867 [debug] [ThreadPool]: SQL status: SELECT 12 in 0.0 seconds
[0m16:14:20.351406 [debug] [ThreadPool]: On list_IDX-Stock: Close
[0m16:14:20.357729 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_IDX-Stock, now list_IDX-Stock_IDX-Schema)
[0m16:14:20.371502 [debug] [ThreadPool]: Using postgres connection "list_IDX-Stock_IDX-Schema"
[0m16:14:20.372889 [debug] [ThreadPool]: On list_IDX-Stock_IDX-Schema: BEGIN
[0m16:14:20.374467 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:14:20.386965 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m16:14:20.389307 [debug] [ThreadPool]: Using postgres connection "list_IDX-Stock_IDX-Schema"
[0m16:14:20.392222 [debug] [ThreadPool]: On list_IDX-Stock_IDX-Schema: /* {"app": "dbt", "dbt_version": "1.5.6", "profile_name": "dbt_idx", "target_name": "dev", "connection_name": "list_IDX-Stock_IDX-Schema"} */
select
      'IDX-Stock' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'IDX-Schema'
    union all
    select
      'IDX-Stock' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'IDX-Schema'
  
[0m16:14:20.403191 [debug] [ThreadPool]: SQL status: SELECT 17 in 0.0 seconds
[0m16:14:20.410822 [debug] [ThreadPool]: On list_IDX-Stock_IDX-Schema: ROLLBACK
[0m16:14:20.414285 [debug] [ThreadPool]: On list_IDX-Stock_IDX-Schema: Close
[0m16:14:20.418603 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_IDX-Stock_IDX-Schema, now list_IDX-Stock_snapshots)
[0m16:14:20.438202 [debug] [ThreadPool]: Using postgres connection "list_IDX-Stock_snapshots"
[0m16:14:20.440905 [debug] [ThreadPool]: On list_IDX-Stock_snapshots: BEGIN
[0m16:14:20.443268 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:14:20.456141 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m16:14:20.458705 [debug] [ThreadPool]: Using postgres connection "list_IDX-Stock_snapshots"
[0m16:14:20.461480 [debug] [ThreadPool]: On list_IDX-Stock_snapshots: /* {"app": "dbt", "dbt_version": "1.5.6", "profile_name": "dbt_idx", "target_name": "dev", "connection_name": "list_IDX-Stock_snapshots"} */
select
      'IDX-Stock' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'snapshots'
    union all
    select
      'IDX-Stock' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'snapshots'
  
[0m16:14:20.470453 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.0 seconds
[0m16:14:20.476181 [debug] [ThreadPool]: On list_IDX-Stock_snapshots: ROLLBACK
[0m16:14:20.480521 [debug] [ThreadPool]: On list_IDX-Stock_snapshots: Close
[0m16:14:20.497509 [debug] [MainThread]: Using postgres connection "master"
[0m16:14:20.499351 [debug] [MainThread]: On master: BEGIN
[0m16:14:20.501410 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:14:20.517538 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m16:14:20.519775 [debug] [MainThread]: Using postgres connection "master"
[0m16:14:20.521992 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.5.6", "profile_name": "dbt_idx", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m16:14:20.547156 [debug] [MainThread]: SQL status: SELECT 9 in 0.0 seconds
[0m16:14:20.558933 [debug] [MainThread]: On master: ROLLBACK
[0m16:14:20.561230 [debug] [MainThread]: Using postgres connection "master"
[0m16:14:20.563032 [debug] [MainThread]: On master: BEGIN
[0m16:14:20.565244 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m16:14:20.567550 [debug] [MainThread]: On master: COMMIT
[0m16:14:20.570969 [debug] [MainThread]: Using postgres connection "master"
[0m16:14:20.573384 [debug] [MainThread]: On master: COMMIT
[0m16:14:20.576158 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m16:14:20.578670 [debug] [MainThread]: On master: Close
[0m16:14:20.583471 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:14:20.586681 [info ] [MainThread]: 
[0m16:14:20.605710 [debug] [Thread-1  ]: Began running node model.dbt_idx.stg_eltool__company
[0m16:14:20.609745 [info ] [Thread-1  ]: 1 of 11 START sql view model IDX-Schema.stg_eltool__company .................... [RUN]
[0m16:14:20.614416 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_IDX-Stock_snapshots, now model.dbt_idx.stg_eltool__company)
[0m16:14:20.617634 [debug] [Thread-1  ]: Began compiling node model.dbt_idx.stg_eltool__company
[0m16:14:20.636392 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_idx.stg_eltool__company"
[0m16:14:20.666284 [debug] [Thread-1  ]: Timing info for model.dbt_idx.stg_eltool__company (compile): 16:14:20.619944 => 16:14:20.665546
[0m16:14:20.668154 [debug] [Thread-1  ]: Began executing node model.dbt_idx.stg_eltool__company
[0m16:14:20.741718 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_idx.stg_eltool__company"
[0m16:14:20.767625 [debug] [Thread-1  ]: Using postgres connection "model.dbt_idx.stg_eltool__company"
[0m16:14:20.769685 [debug] [Thread-1  ]: On model.dbt_idx.stg_eltool__company: BEGIN
[0m16:14:20.771920 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m16:14:20.784503 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m16:14:20.787244 [debug] [Thread-1  ]: Using postgres connection "model.dbt_idx.stg_eltool__company"
[0m16:14:20.789501 [debug] [Thread-1  ]: On model.dbt_idx.stg_eltool__company: /* {"app": "dbt", "dbt_version": "1.5.6", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__company"} */

  create view "IDX-Stock"."IDX-Schema"."stg_eltool__company__dbt_tmp"
    
    
  as (
    with source as (select *
                from "IDX-Stock"."IDX-Schema"."ksql-company-stream"),
     renamed as (select id,
                        ticker,
                        name,
                        logo
                 from source)
select *
from renamed
  );
[0m16:14:20.806179 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m16:14:20.827937 [debug] [Thread-1  ]: Using postgres connection "model.dbt_idx.stg_eltool__company"
[0m16:14:20.829257 [debug] [Thread-1  ]: On model.dbt_idx.stg_eltool__company: /* {"app": "dbt", "dbt_version": "1.5.6", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__company"} */
alter table "IDX-Stock"."IDX-Schema"."stg_eltool__company" rename to "stg_eltool__company__dbt_backup"
[0m16:14:20.832237 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m16:14:20.842894 [debug] [Thread-1  ]: Using postgres connection "model.dbt_idx.stg_eltool__company"
[0m16:14:20.844257 [debug] [Thread-1  ]: On model.dbt_idx.stg_eltool__company: /* {"app": "dbt", "dbt_version": "1.5.6", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__company"} */
alter table "IDX-Stock"."IDX-Schema"."stg_eltool__company__dbt_tmp" rename to "stg_eltool__company"
[0m16:14:20.845981 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m16:14:20.876626 [debug] [Thread-1  ]: On model.dbt_idx.stg_eltool__company: COMMIT
[0m16:14:20.877776 [debug] [Thread-1  ]: Using postgres connection "model.dbt_idx.stg_eltool__company"
[0m16:14:20.878784 [debug] [Thread-1  ]: On model.dbt_idx.stg_eltool__company: COMMIT
[0m16:14:20.883521 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m16:14:20.892131 [debug] [Thread-1  ]: Using postgres connection "model.dbt_idx.stg_eltool__company"
[0m16:14:20.893340 [debug] [Thread-1  ]: On model.dbt_idx.stg_eltool__company: /* {"app": "dbt", "dbt_version": "1.5.6", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__company"} */
drop view if exists "IDX-Stock"."IDX-Schema"."stg_eltool__company__dbt_backup" cascade
[0m16:14:20.898461 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
[0m16:14:20.902182 [debug] [Thread-1  ]: Timing info for model.dbt_idx.stg_eltool__company (execute): 16:14:20.669240 => 16:14:20.901919
[0m16:14:20.903314 [debug] [Thread-1  ]: On model.dbt_idx.stg_eltool__company: Close
[0m16:14:20.905548 [info ] [Thread-1  ]: 1 of 11 OK created sql view model IDX-Schema.stg_eltool__company ............... [[32mCREATE VIEW[0m in 0.29s]
[0m16:14:20.908660 [debug] [Thread-1  ]: Finished running node model.dbt_idx.stg_eltool__company
[0m16:14:20.910155 [debug] [Thread-1  ]: Began running node model.dbt_idx.stg_eltool__customers
[0m16:14:20.911347 [info ] [Thread-1  ]: 2 of 11 START sql view model IDX-Schema.stg_eltool__customers .................. [RUN]
[0m16:14:20.914465 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_idx.stg_eltool__company, now model.dbt_idx.stg_eltool__customers)
[0m16:14:20.916709 [debug] [Thread-1  ]: Began compiling node model.dbt_idx.stg_eltool__customers
[0m16:14:20.922936 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_idx.stg_eltool__customers"
[0m16:14:20.952658 [debug] [Thread-1  ]: Timing info for model.dbt_idx.stg_eltool__customers (compile): 16:14:20.918102 => 16:14:20.951721
[0m16:14:20.955242 [debug] [Thread-1  ]: Began executing node model.dbt_idx.stg_eltool__customers
[0m16:14:20.969991 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_idx.stg_eltool__customers"
[0m16:14:21.003104 [debug] [Thread-1  ]: Using postgres connection "model.dbt_idx.stg_eltool__customers"
[0m16:14:21.005150 [debug] [Thread-1  ]: On model.dbt_idx.stg_eltool__customers: BEGIN
[0m16:14:21.006788 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m16:14:21.018113 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m16:14:21.020124 [debug] [Thread-1  ]: Using postgres connection "model.dbt_idx.stg_eltool__customers"
[0m16:14:21.022082 [debug] [Thread-1  ]: On model.dbt_idx.stg_eltool__customers: /* {"app": "dbt", "dbt_version": "1.5.6", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__customers"} */

  create view "IDX-Stock"."IDX-Schema"."stg_eltool__customers__dbt_tmp"
    
    
  as (
    with source as (select *
                from "IDX-Stock"."IDX-Schema"."customers"),
     renamed as (select
                     customer_id,
                    'This is Dummy' as dummy
                 from source
                 where customer_id = 1234567890)
select *
from renamed
  );
[0m16:14:21.028207 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m16:14:21.038873 [debug] [Thread-1  ]: Using postgres connection "model.dbt_idx.stg_eltool__customers"
[0m16:14:21.042511 [debug] [Thread-1  ]: On model.dbt_idx.stg_eltool__customers: /* {"app": "dbt", "dbt_version": "1.5.6", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__customers"} */
alter table "IDX-Stock"."IDX-Schema"."stg_eltool__customers" rename to "stg_eltool__customers__dbt_backup"
[0m16:14:21.045388 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m16:14:21.057443 [debug] [Thread-1  ]: Using postgres connection "model.dbt_idx.stg_eltool__customers"
[0m16:14:21.059475 [debug] [Thread-1  ]: On model.dbt_idx.stg_eltool__customers: /* {"app": "dbt", "dbt_version": "1.5.6", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__customers"} */
alter table "IDX-Stock"."IDX-Schema"."stg_eltool__customers__dbt_tmp" rename to "stg_eltool__customers"
[0m16:14:21.061642 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m16:14:21.067884 [debug] [Thread-1  ]: On model.dbt_idx.stg_eltool__customers: COMMIT
[0m16:14:21.071265 [debug] [Thread-1  ]: Using postgres connection "model.dbt_idx.stg_eltool__customers"
[0m16:14:21.073677 [debug] [Thread-1  ]: On model.dbt_idx.stg_eltool__customers: COMMIT
[0m16:14:21.079545 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m16:14:21.086985 [debug] [Thread-1  ]: Using postgres connection "model.dbt_idx.stg_eltool__customers"
[0m16:14:21.088786 [debug] [Thread-1  ]: On model.dbt_idx.stg_eltool__customers: /* {"app": "dbt", "dbt_version": "1.5.6", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__customers"} */
drop view if exists "IDX-Stock"."IDX-Schema"."stg_eltool__customers__dbt_backup" cascade
[0m16:14:21.094071 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
[0m16:14:21.097439 [debug] [Thread-1  ]: Timing info for model.dbt_idx.stg_eltool__customers (execute): 16:14:20.957158 => 16:14:21.096847
[0m16:14:21.099766 [debug] [Thread-1  ]: On model.dbt_idx.stg_eltool__customers: Close
[0m16:14:21.103282 [info ] [Thread-1  ]: 2 of 11 OK created sql view model IDX-Schema.stg_eltool__customers ............. [[32mCREATE VIEW[0m in 0.19s]
[0m16:14:21.106871 [debug] [Thread-1  ]: Finished running node model.dbt_idx.stg_eltool__customers
[0m16:14:21.108989 [debug] [Thread-1  ]: Began running node model.dbt_idx.stg_eltool__customers_snapshots
[0m16:14:21.111054 [info ] [Thread-1  ]: 3 of 11 START sql view model IDX-Schema.stg_eltool__customers_snapshots ........ [RUN]
[0m16:14:21.115114 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_idx.stg_eltool__customers, now model.dbt_idx.stg_eltool__customers_snapshots)
[0m16:14:21.118162 [debug] [Thread-1  ]: Began compiling node model.dbt_idx.stg_eltool__customers_snapshots
[0m16:14:21.126293 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_idx.stg_eltool__customers_snapshots"
[0m16:14:21.161331 [debug] [Thread-1  ]: Timing info for model.dbt_idx.stg_eltool__customers_snapshots (compile): 16:14:21.120132 => 16:14:21.160829
[0m16:14:21.163078 [debug] [Thread-1  ]: Began executing node model.dbt_idx.stg_eltool__customers_snapshots
[0m16:14:21.178809 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_idx.stg_eltool__customers_snapshots"
[0m16:14:21.210017 [debug] [Thread-1  ]: Using postgres connection "model.dbt_idx.stg_eltool__customers_snapshots"
[0m16:14:21.211538 [debug] [Thread-1  ]: On model.dbt_idx.stg_eltool__customers_snapshots: BEGIN
[0m16:14:21.212942 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m16:14:21.224971 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m16:14:21.227535 [debug] [Thread-1  ]: Using postgres connection "model.dbt_idx.stg_eltool__customers_snapshots"
[0m16:14:21.229944 [debug] [Thread-1  ]: On model.dbt_idx.stg_eltool__customers_snapshots: /* {"app": "dbt", "dbt_version": "1.5.6", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__customers_snapshots"} */

  create view "IDX-Stock"."IDX-Schema"."stg_eltool__customers_snapshots__dbt_tmp"
    
    
  as (
    with source as (select *
                from "IDX-Stock"."snapshots"."customers_snapshot"),
     renamed as (select customer_id,
                        zipcode,
                        city,
                        state_code,
                        datetime_created::TIMESTAMP AS datetime_created,
                        datetime_updated::TIMESTAMP AS datetime_updated,
                        dbt_valid_from,
                        dbt_valid_to
                 from source)
select *
from renamed
  );
[0m16:14:21.238821 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m16:14:21.258536 [debug] [Thread-1  ]: Using postgres connection "model.dbt_idx.stg_eltool__customers_snapshots"
[0m16:14:21.260816 [debug] [Thread-1  ]: On model.dbt_idx.stg_eltool__customers_snapshots: /* {"app": "dbt", "dbt_version": "1.5.6", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__customers_snapshots"} */
alter table "IDX-Stock"."IDX-Schema"."stg_eltool__customers_snapshots" rename to "stg_eltool__customers_snapshots__dbt_backup"
[0m16:14:21.263160 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m16:14:21.275264 [debug] [Thread-1  ]: Using postgres connection "model.dbt_idx.stg_eltool__customers_snapshots"
[0m16:14:21.277320 [debug] [Thread-1  ]: On model.dbt_idx.stg_eltool__customers_snapshots: /* {"app": "dbt", "dbt_version": "1.5.6", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__customers_snapshots"} */
alter table "IDX-Stock"."IDX-Schema"."stg_eltool__customers_snapshots__dbt_tmp" rename to "stg_eltool__customers_snapshots"
[0m16:14:21.279673 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m16:14:21.287297 [debug] [Thread-1  ]: On model.dbt_idx.stg_eltool__customers_snapshots: COMMIT
[0m16:14:21.288618 [debug] [Thread-1  ]: Using postgres connection "model.dbt_idx.stg_eltool__customers_snapshots"
[0m16:14:21.290224 [debug] [Thread-1  ]: On model.dbt_idx.stg_eltool__customers_snapshots: COMMIT
[0m16:14:21.294532 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m16:14:21.304643 [debug] [Thread-1  ]: Using postgres connection "model.dbt_idx.stg_eltool__customers_snapshots"
[0m16:14:21.306096 [debug] [Thread-1  ]: On model.dbt_idx.stg_eltool__customers_snapshots: /* {"app": "dbt", "dbt_version": "1.5.6", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__customers_snapshots"} */
drop view if exists "IDX-Stock"."IDX-Schema"."stg_eltool__customers_snapshots__dbt_backup" cascade
[0m16:14:21.310734 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
[0m16:14:21.313512 [debug] [Thread-1  ]: Timing info for model.dbt_idx.stg_eltool__customers_snapshots (execute): 16:14:21.164687 => 16:14:21.313255
[0m16:14:21.314964 [debug] [Thread-1  ]: On model.dbt_idx.stg_eltool__customers_snapshots: Close
[0m16:14:21.318318 [info ] [Thread-1  ]: 3 of 11 OK created sql view model IDX-Schema.stg_eltool__customers_snapshots ... [[32mCREATE VIEW[0m in 0.20s]
[0m16:14:21.320510 [debug] [Thread-1  ]: Finished running node model.dbt_idx.stg_eltool__customers_snapshots
[0m16:14:21.321822 [debug] [Thread-1  ]: Began running node model.dbt_idx.stg_eltool__orders
[0m16:14:21.323394 [info ] [Thread-1  ]: 4 of 11 START sql view model IDX-Schema.stg_eltool__orders ..................... [RUN]
[0m16:14:21.325602 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_idx.stg_eltool__customers_snapshots, now model.dbt_idx.stg_eltool__orders)
[0m16:14:21.326732 [debug] [Thread-1  ]: Began compiling node model.dbt_idx.stg_eltool__orders
[0m16:14:21.383615 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_idx.stg_eltool__orders"
[0m16:14:21.410323 [debug] [Thread-1  ]: Timing info for model.dbt_idx.stg_eltool__orders (compile): 16:14:21.327575 => 16:14:21.409921
[0m16:14:21.411877 [debug] [Thread-1  ]: Began executing node model.dbt_idx.stg_eltool__orders
[0m16:14:21.419767 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_idx.stg_eltool__orders"
[0m16:14:21.448649 [debug] [Thread-1  ]: Using postgres connection "model.dbt_idx.stg_eltool__orders"
[0m16:14:21.450213 [debug] [Thread-1  ]: On model.dbt_idx.stg_eltool__orders: BEGIN
[0m16:14:21.451334 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m16:14:21.460534 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m16:14:21.462715 [debug] [Thread-1  ]: Using postgres connection "model.dbt_idx.stg_eltool__orders"
[0m16:14:21.465344 [debug] [Thread-1  ]: On model.dbt_idx.stg_eltool__orders: /* {"app": "dbt", "dbt_version": "1.5.6", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__orders"} */

  create view "IDX-Stock"."IDX-Schema"."stg_eltool__orders__dbt_tmp"
    
    
  as (
    with source as (select *
                from "IDX-Stock"."IDX-Schema"."orders"),
     renamed as (select order_id,
                        cust_id AS customer_id,
                        order_status,
                        order_purchase_timestamp::TIMESTAMP,
                        order_approved_at::TIMESTAMP,
                        order_delivered_carrier_date::TIMESTAMP,
                        order_delivered_customer_date::TIMESTAMP,
                        order_estimated_delivery_date::TIMESTAMP
                 from source)
select *
from renamed
  );
[0m16:14:21.469967 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m16:14:21.476552 [debug] [Thread-1  ]: Using postgres connection "model.dbt_idx.stg_eltool__orders"
[0m16:14:21.477733 [debug] [Thread-1  ]: On model.dbt_idx.stg_eltool__orders: /* {"app": "dbt", "dbt_version": "1.5.6", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__orders"} */
alter table "IDX-Stock"."IDX-Schema"."stg_eltool__orders" rename to "stg_eltool__orders__dbt_backup"
[0m16:14:21.479491 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m16:14:21.485964 [debug] [Thread-1  ]: Using postgres connection "model.dbt_idx.stg_eltool__orders"
[0m16:14:21.487255 [debug] [Thread-1  ]: On model.dbt_idx.stg_eltool__orders: /* {"app": "dbt", "dbt_version": "1.5.6", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__orders"} */
alter table "IDX-Stock"."IDX-Schema"."stg_eltool__orders__dbt_tmp" rename to "stg_eltool__orders"
[0m16:14:21.490221 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m16:14:21.495780 [debug] [Thread-1  ]: On model.dbt_idx.stg_eltool__orders: COMMIT
[0m16:14:21.496991 [debug] [Thread-1  ]: Using postgres connection "model.dbt_idx.stg_eltool__orders"
[0m16:14:21.498369 [debug] [Thread-1  ]: On model.dbt_idx.stg_eltool__orders: COMMIT
[0m16:14:21.502833 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m16:14:21.513152 [debug] [Thread-1  ]: Using postgres connection "model.dbt_idx.stg_eltool__orders"
[0m16:14:21.515716 [debug] [Thread-1  ]: On model.dbt_idx.stg_eltool__orders: /* {"app": "dbt", "dbt_version": "1.5.6", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__orders"} */
drop view if exists "IDX-Stock"."IDX-Schema"."stg_eltool__orders__dbt_backup" cascade
[0m16:14:21.521847 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
[0m16:14:21.526421 [debug] [Thread-1  ]: Timing info for model.dbt_idx.stg_eltool__orders (execute): 16:14:21.412727 => 16:14:21.526154
[0m16:14:21.527632 [debug] [Thread-1  ]: On model.dbt_idx.stg_eltool__orders: Close
[0m16:14:21.529472 [info ] [Thread-1  ]: 4 of 11 OK created sql view model IDX-Schema.stg_eltool__orders ................ [[32mCREATE VIEW[0m in 0.20s]
[0m16:14:21.531788 [debug] [Thread-1  ]: Finished running node model.dbt_idx.stg_eltool__orders
[0m16:14:21.533604 [debug] [Thread-1  ]: Began running node model.dbt_idx.stg_eltool__state
[0m16:14:21.536021 [info ] [Thread-1  ]: 5 of 11 START sql view model IDX-Schema.stg_eltool__state ...................... [RUN]
[0m16:14:21.538067 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_idx.stg_eltool__orders, now model.dbt_idx.stg_eltool__state)
[0m16:14:21.539672 [debug] [Thread-1  ]: Began compiling node model.dbt_idx.stg_eltool__state
[0m16:14:21.545142 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_idx.stg_eltool__state"
[0m16:14:21.579265 [debug] [Thread-1  ]: Timing info for model.dbt_idx.stg_eltool__state (compile): 16:14:21.541226 => 16:14:21.578631
[0m16:14:21.581122 [debug] [Thread-1  ]: Began executing node model.dbt_idx.stg_eltool__state
[0m16:14:21.593399 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_idx.stg_eltool__state"
[0m16:14:21.629008 [debug] [Thread-1  ]: Using postgres connection "model.dbt_idx.stg_eltool__state"
[0m16:14:21.631282 [debug] [Thread-1  ]: On model.dbt_idx.stg_eltool__state: BEGIN
[0m16:14:21.634168 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m16:14:21.648336 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m16:14:21.651386 [debug] [Thread-1  ]: Using postgres connection "model.dbt_idx.stg_eltool__state"
[0m16:14:21.653752 [debug] [Thread-1  ]: On model.dbt_idx.stg_eltool__state: /* {"app": "dbt", "dbt_version": "1.5.6", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__state"} */

  create view "IDX-Stock"."IDX-Schema"."stg_eltool__state__dbt_tmp"
    
    
  as (
    with source as (select *
                from "IDX-Stock"."IDX-Schema"."state"),
     renamed as (select state_identifier::INT AS state_id,
                         state_code::VARCHAR(2) AS state_code,
                         st_name::VARCHAR(30) AS state_name
                 from source)
select *
from renamed
  );
[0m16:14:21.662924 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m16:14:21.682499 [debug] [Thread-1  ]: Using postgres connection "model.dbt_idx.stg_eltool__state"
[0m16:14:21.685537 [debug] [Thread-1  ]: On model.dbt_idx.stg_eltool__state: /* {"app": "dbt", "dbt_version": "1.5.6", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__state"} */
alter table "IDX-Stock"."IDX-Schema"."stg_eltool__state" rename to "stg_eltool__state__dbt_backup"
[0m16:14:21.690108 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m16:14:21.703324 [debug] [Thread-1  ]: Using postgres connection "model.dbt_idx.stg_eltool__state"
[0m16:14:21.705832 [debug] [Thread-1  ]: On model.dbt_idx.stg_eltool__state: /* {"app": "dbt", "dbt_version": "1.5.6", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__state"} */
alter table "IDX-Stock"."IDX-Schema"."stg_eltool__state__dbt_tmp" rename to "stg_eltool__state"
[0m16:14:21.710558 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m16:14:21.718785 [debug] [Thread-1  ]: On model.dbt_idx.stg_eltool__state: COMMIT
[0m16:14:21.721324 [debug] [Thread-1  ]: Using postgres connection "model.dbt_idx.stg_eltool__state"
[0m16:14:21.724130 [debug] [Thread-1  ]: On model.dbt_idx.stg_eltool__state: COMMIT
[0m16:14:21.730248 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m16:14:21.744381 [debug] [Thread-1  ]: Using postgres connection "model.dbt_idx.stg_eltool__state"
[0m16:14:21.746605 [debug] [Thread-1  ]: On model.dbt_idx.stg_eltool__state: /* {"app": "dbt", "dbt_version": "1.5.6", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__state"} */
drop view if exists "IDX-Stock"."IDX-Schema"."stg_eltool__state__dbt_backup" cascade
[0m16:14:21.752639 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
[0m16:14:21.759345 [debug] [Thread-1  ]: Timing info for model.dbt_idx.stg_eltool__state (execute): 16:14:21.583170 => 16:14:21.758570
[0m16:14:21.761727 [debug] [Thread-1  ]: On model.dbt_idx.stg_eltool__state: Close
[0m16:14:21.765774 [info ] [Thread-1  ]: 5 of 11 OK created sql view model IDX-Schema.stg_eltool__state ................. [[32mCREATE VIEW[0m in 0.23s]
[0m16:14:21.769412 [debug] [Thread-1  ]: Finished running node model.dbt_idx.stg_eltool__state
[0m16:14:21.771725 [debug] [Thread-1  ]: Began running node model.dbt_idx.stg_eltool__stock
[0m16:14:21.774841 [info ] [Thread-1  ]: 6 of 11 START sql view model IDX-Schema.stg_eltool__stock ...................... [RUN]
[0m16:14:21.778205 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_idx.stg_eltool__state, now model.dbt_idx.stg_eltool__stock)
[0m16:14:21.780190 [debug] [Thread-1  ]: Began compiling node model.dbt_idx.stg_eltool__stock
[0m16:14:21.793060 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_idx.stg_eltool__stock"
[0m16:14:21.828862 [debug] [Thread-1  ]: Timing info for model.dbt_idx.stg_eltool__stock (compile): 16:14:21.782115 => 16:14:21.828207
[0m16:14:21.830657 [debug] [Thread-1  ]: Began executing node model.dbt_idx.stg_eltool__stock
[0m16:14:21.855811 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_idx.stg_eltool__stock"
[0m16:14:21.889502 [debug] [Thread-1  ]: Using postgres connection "model.dbt_idx.stg_eltool__stock"
[0m16:14:21.891070 [debug] [Thread-1  ]: On model.dbt_idx.stg_eltool__stock: BEGIN
[0m16:14:21.892271 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m16:14:21.904953 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m16:14:21.907218 [debug] [Thread-1  ]: Using postgres connection "model.dbt_idx.stg_eltool__stock"
[0m16:14:21.910015 [debug] [Thread-1  ]: On model.dbt_idx.stg_eltool__stock: /* {"app": "dbt", "dbt_version": "1.5.6", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__stock"} */

  create view "IDX-Stock"."IDX-Schema"."stg_eltool__stock__dbt_tmp"
    
    
  as (
    with source as (select *
                from "IDX-Stock"."IDX-Schema"."ksql-stock-stream"),
     renamed as (select *
                 from source)
select *
from renamed
  );
[0m16:14:21.918476 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m16:14:21.935484 [debug] [Thread-1  ]: Using postgres connection "model.dbt_idx.stg_eltool__stock"
[0m16:14:21.936947 [debug] [Thread-1  ]: On model.dbt_idx.stg_eltool__stock: /* {"app": "dbt", "dbt_version": "1.5.6", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__stock"} */
alter table "IDX-Stock"."IDX-Schema"."stg_eltool__stock" rename to "stg_eltool__stock__dbt_backup"
[0m16:14:21.939007 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m16:14:21.952430 [debug] [Thread-1  ]: Using postgres connection "model.dbt_idx.stg_eltool__stock"
[0m16:14:21.954121 [debug] [Thread-1  ]: On model.dbt_idx.stg_eltool__stock: /* {"app": "dbt", "dbt_version": "1.5.6", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__stock"} */
alter table "IDX-Stock"."IDX-Schema"."stg_eltool__stock__dbt_tmp" rename to "stg_eltool__stock"
[0m16:14:21.956068 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m16:14:21.964361 [debug] [Thread-1  ]: On model.dbt_idx.stg_eltool__stock: COMMIT
[0m16:14:21.967108 [debug] [Thread-1  ]: Using postgres connection "model.dbt_idx.stg_eltool__stock"
[0m16:14:21.969147 [debug] [Thread-1  ]: On model.dbt_idx.stg_eltool__stock: COMMIT
[0m16:14:21.974151 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m16:14:21.981767 [debug] [Thread-1  ]: Using postgres connection "model.dbt_idx.stg_eltool__stock"
[0m16:14:21.983896 [debug] [Thread-1  ]: On model.dbt_idx.stg_eltool__stock: /* {"app": "dbt", "dbt_version": "1.5.6", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__stock"} */
drop view if exists "IDX-Stock"."IDX-Schema"."stg_eltool__stock__dbt_backup" cascade
[0m16:14:21.988486 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
[0m16:14:21.993657 [debug] [Thread-1  ]: Timing info for model.dbt_idx.stg_eltool__stock (execute): 16:14:21.832680 => 16:14:21.993063
[0m16:14:21.995568 [debug] [Thread-1  ]: On model.dbt_idx.stg_eltool__stock: Close
[0m16:14:21.998230 [info ] [Thread-1  ]: 6 of 11 OK created sql view model IDX-Schema.stg_eltool__stock ................. [[32mCREATE VIEW[0m in 0.22s]
[0m16:14:22.001372 [debug] [Thread-1  ]: Finished running node model.dbt_idx.stg_eltool__stock
[0m16:14:22.003303 [debug] [Thread-1  ]: Began running node model.dbt_idx.fact_orders
[0m16:14:22.005159 [info ] [Thread-1  ]: 7 of 11 START sql table model IDX-Schema.fact_orders ........................... [RUN]
[0m16:14:22.008481 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_idx.stg_eltool__stock, now model.dbt_idx.fact_orders)
[0m16:14:22.010319 [debug] [Thread-1  ]: Began compiling node model.dbt_idx.fact_orders
[0m16:14:22.017117 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_idx.fact_orders"
[0m16:14:22.043420 [debug] [Thread-1  ]: Timing info for model.dbt_idx.fact_orders (compile): 16:14:22.011568 => 16:14:22.042950
[0m16:14:22.044764 [debug] [Thread-1  ]: Began executing node model.dbt_idx.fact_orders
[0m16:14:22.089667 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_idx.fact_orders"
[0m16:14:22.122596 [debug] [Thread-1  ]: Using postgres connection "model.dbt_idx.fact_orders"
[0m16:14:22.124224 [debug] [Thread-1  ]: On model.dbt_idx.fact_orders: BEGIN
[0m16:14:22.125481 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m16:14:22.134259 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m16:14:22.135782 [debug] [Thread-1  ]: Using postgres connection "model.dbt_idx.fact_orders"
[0m16:14:22.137098 [debug] [Thread-1  ]: On model.dbt_idx.fact_orders: /* {"app": "dbt", "dbt_version": "1.5.6", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.fact_orders"} */

  
    

  create  table "IDX-Stock"."IDX-Schema"."fact_orders__dbt_tmp"
  
  
    as
  
  (
    with orders as (
    select *
    from "IDX-Stock"."IDX-Schema"."stg_eltool__orders"
)
select * from orders
  );
  
[0m16:14:22.155077 [debug] [Thread-1  ]: SQL status: SELECT 999 in 0.0 seconds
[0m16:14:22.163028 [debug] [Thread-1  ]: Using postgres connection "model.dbt_idx.fact_orders"
[0m16:14:22.165729 [debug] [Thread-1  ]: On model.dbt_idx.fact_orders: /* {"app": "dbt", "dbt_version": "1.5.6", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.fact_orders"} */
alter table "IDX-Stock"."IDX-Schema"."fact_orders" rename to "fact_orders__dbt_backup"
[0m16:14:22.169362 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m16:14:22.179071 [debug] [Thread-1  ]: Using postgres connection "model.dbt_idx.fact_orders"
[0m16:14:22.180613 [debug] [Thread-1  ]: On model.dbt_idx.fact_orders: /* {"app": "dbt", "dbt_version": "1.5.6", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.fact_orders"} */
alter table "IDX-Stock"."IDX-Schema"."fact_orders__dbt_tmp" rename to "fact_orders"
[0m16:14:22.183248 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m16:14:22.196056 [debug] [Thread-1  ]: On model.dbt_idx.fact_orders: COMMIT
[0m16:14:22.197977 [debug] [Thread-1  ]: Using postgres connection "model.dbt_idx.fact_orders"
[0m16:14:22.200747 [debug] [Thread-1  ]: On model.dbt_idx.fact_orders: COMMIT
[0m16:14:22.208110 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m16:14:22.215717 [debug] [Thread-1  ]: Using postgres connection "model.dbt_idx.fact_orders"
[0m16:14:22.218036 [debug] [Thread-1  ]: On model.dbt_idx.fact_orders: /* {"app": "dbt", "dbt_version": "1.5.6", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.fact_orders"} */
drop table if exists "IDX-Stock"."IDX-Schema"."fact_orders__dbt_backup" cascade
[0m16:14:22.233311 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
[0m16:14:22.236974 [debug] [Thread-1  ]: Timing info for model.dbt_idx.fact_orders (execute): 16:14:22.045689 => 16:14:22.236361
[0m16:14:22.239052 [debug] [Thread-1  ]: On model.dbt_idx.fact_orders: Close
[0m16:14:22.242673 [info ] [Thread-1  ]: 7 of 11 OK created sql table model IDX-Schema.fact_orders ...................... [[32mSELECT 999[0m in 0.23s]
[0m16:14:22.246130 [debug] [Thread-1  ]: Finished running node model.dbt_idx.fact_orders
[0m16:14:22.247830 [debug] [Thread-1  ]: Began running node model.dbt_idx.dim_customers
[0m16:14:22.250156 [info ] [Thread-1  ]: 8 of 11 START sql table model IDX-Schema.dim_customers ......................... [RUN]
[0m16:14:22.253426 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_idx.fact_orders, now model.dbt_idx.dim_customers)
[0m16:14:22.255312 [debug] [Thread-1  ]: Began compiling node model.dbt_idx.dim_customers
[0m16:14:22.263115 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_idx.dim_customers"
[0m16:14:22.303466 [debug] [Thread-1  ]: Timing info for model.dbt_idx.dim_customers (compile): 16:14:22.256843 => 16:14:22.302901
[0m16:14:22.306118 [debug] [Thread-1  ]: Began executing node model.dbt_idx.dim_customers
[0m16:14:22.319693 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_idx.dim_customers"
[0m16:14:22.364542 [debug] [Thread-1  ]: Using postgres connection "model.dbt_idx.dim_customers"
[0m16:14:22.366574 [debug] [Thread-1  ]: On model.dbt_idx.dim_customers: BEGIN
[0m16:14:22.368813 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m16:14:22.381989 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m16:14:22.384432 [debug] [Thread-1  ]: Using postgres connection "model.dbt_idx.dim_customers"
[0m16:14:22.386606 [debug] [Thread-1  ]: On model.dbt_idx.dim_customers: /* {"app": "dbt", "dbt_version": "1.5.6", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.dim_customers"} */

  
    

  create  table "IDX-Stock"."IDX-Schema"."dim_customers__dbt_tmp"
  
  
    as
  
  (
    -- noinspection SqlDialectInspectionForFile

with customers as (
    select *
    from "IDX-Stock"."IDX-Schema"."stg_eltool__customers_snapshots"
    ),
     state as (
         select *
         from "IDX-Stock"."IDX-Schema"."stg_eltool__state"
     )
select c.customer_id,
       c.zipcode,
       c.city,
       c.state_code,
       s.state_name,
       c.datetime_created,
       c.datetime_updated,
       c.dbt_valid_from::TIMESTAMP as valid_from,
        CASE WHEN c.dbt_valid_to IS NULL
            THEN '9999-12-31'::TIMESTAMP
            ELSE c.dbt_valid_to::TIMESTAMP
        END as valid_to
from customers c
    join state s on c.state_code = s.state_code
  );
  
[0m16:14:22.399174 [debug] [Thread-1  ]: SQL status: SELECT 100 in 0.0 seconds
[0m16:14:22.414857 [debug] [Thread-1  ]: Using postgres connection "model.dbt_idx.dim_customers"
[0m16:14:22.419156 [debug] [Thread-1  ]: On model.dbt_idx.dim_customers: /* {"app": "dbt", "dbt_version": "1.5.6", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.dim_customers"} */
alter table "IDX-Stock"."IDX-Schema"."dim_customers" rename to "dim_customers__dbt_backup"
[0m16:14:22.422120 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m16:14:22.432814 [debug] [Thread-1  ]: Using postgres connection "model.dbt_idx.dim_customers"
[0m16:14:22.435513 [debug] [Thread-1  ]: On model.dbt_idx.dim_customers: /* {"app": "dbt", "dbt_version": "1.5.6", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.dim_customers"} */
alter table "IDX-Stock"."IDX-Schema"."dim_customers__dbt_tmp" rename to "dim_customers"
[0m16:14:22.438176 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m16:14:22.445452 [debug] [Thread-1  ]: On model.dbt_idx.dim_customers: COMMIT
[0m16:14:22.446712 [debug] [Thread-1  ]: Using postgres connection "model.dbt_idx.dim_customers"
[0m16:14:22.448118 [debug] [Thread-1  ]: On model.dbt_idx.dim_customers: COMMIT
[0m16:14:22.452880 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m16:14:22.460113 [debug] [Thread-1  ]: Using postgres connection "model.dbt_idx.dim_customers"
[0m16:14:22.461425 [debug] [Thread-1  ]: On model.dbt_idx.dim_customers: /* {"app": "dbt", "dbt_version": "1.5.6", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.dim_customers"} */
drop table if exists "IDX-Stock"."IDX-Schema"."dim_customers__dbt_backup" cascade
[0m16:14:22.466061 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
[0m16:14:22.468914 [debug] [Thread-1  ]: Timing info for model.dbt_idx.dim_customers (execute): 16:14:22.307966 => 16:14:22.468668
[0m16:14:22.469976 [debug] [Thread-1  ]: On model.dbt_idx.dim_customers: Close
[0m16:14:22.472026 [info ] [Thread-1  ]: 8 of 11 OK created sql table model IDX-Schema.dim_customers .................... [[32mSELECT 100[0m in 0.22s]
[0m16:14:22.474799 [debug] [Thread-1  ]: Finished running node model.dbt_idx.dim_customers
[0m16:14:22.477067 [debug] [Thread-1  ]: Began running node model.dbt_idx.fact_stocks
[0m16:14:22.478906 [info ] [Thread-1  ]: 9 of 11 START sql table model IDX-Schema.fact_stocks ........................... [RUN]
[0m16:14:22.481004 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_idx.dim_customers, now model.dbt_idx.fact_stocks)
[0m16:14:22.483154 [debug] [Thread-1  ]: Began compiling node model.dbt_idx.fact_stocks
[0m16:14:22.489918 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_idx.fact_stocks"
[0m16:14:22.521834 [debug] [Thread-1  ]: Timing info for model.dbt_idx.fact_stocks (compile): 16:14:22.484871 => 16:14:22.521410
[0m16:14:22.524097 [debug] [Thread-1  ]: Began executing node model.dbt_idx.fact_stocks
[0m16:14:22.533827 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_idx.fact_stocks"
[0m16:14:22.569523 [debug] [Thread-1  ]: Using postgres connection "model.dbt_idx.fact_stocks"
[0m16:14:22.571564 [debug] [Thread-1  ]: On model.dbt_idx.fact_stocks: BEGIN
[0m16:14:22.574514 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m16:14:22.587776 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m16:14:22.590415 [debug] [Thread-1  ]: Using postgres connection "model.dbt_idx.fact_stocks"
[0m16:14:22.593414 [debug] [Thread-1  ]: On model.dbt_idx.fact_stocks: /* {"app": "dbt", "dbt_version": "1.5.6", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.fact_stocks"} */

  
    

  create  table "IDX-Stock"."IDX-Schema"."fact_stocks__dbt_tmp"
  
  
    as
  
  (
    -- noinspection SqlDialectInspectionForFile

with stock as (
    select *
    from "IDX-Stock"."IDX-Schema"."stg_eltool__stock"
    ),
     company as (
         select *
         from "IDX-Stock"."IDX-Schema"."stg_eltool__company"
     )
select a.id,
       a.ticker,
       b.name,
       a.date,
       a.open,
       a.high,
       a.low,
       a.close,
       a.volume,
       b.logo
from stock a
    join company b on a.ticker = b.ticker
  );
  
[0m16:14:22.820781 [debug] [Thread-1  ]: SQL status: SELECT 26131 in 0.0 seconds
[0m16:14:22.832830 [debug] [Thread-1  ]: Using postgres connection "model.dbt_idx.fact_stocks"
[0m16:14:22.834811 [debug] [Thread-1  ]: On model.dbt_idx.fact_stocks: /* {"app": "dbt", "dbt_version": "1.5.6", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.fact_stocks"} */
alter table "IDX-Stock"."IDX-Schema"."fact_stocks" rename to "fact_stocks__dbt_backup"
[0m16:14:22.837652 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m16:14:22.846290 [debug] [Thread-1  ]: Using postgres connection "model.dbt_idx.fact_stocks"
[0m16:14:22.847949 [debug] [Thread-1  ]: On model.dbt_idx.fact_stocks: /* {"app": "dbt", "dbt_version": "1.5.6", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.fact_stocks"} */
alter table "IDX-Stock"."IDX-Schema"."fact_stocks__dbt_tmp" rename to "fact_stocks"
[0m16:14:22.850617 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m16:14:22.857069 [debug] [Thread-1  ]: On model.dbt_idx.fact_stocks: COMMIT
[0m16:14:22.859679 [debug] [Thread-1  ]: Using postgres connection "model.dbt_idx.fact_stocks"
[0m16:14:22.861388 [debug] [Thread-1  ]: On model.dbt_idx.fact_stocks: COMMIT
[0m16:14:22.896826 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m16:14:22.904638 [debug] [Thread-1  ]: Using postgres connection "model.dbt_idx.fact_stocks"
[0m16:14:22.906904 [debug] [Thread-1  ]: On model.dbt_idx.fact_stocks: /* {"app": "dbt", "dbt_version": "1.5.6", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.fact_stocks"} */
drop table if exists "IDX-Stock"."IDX-Schema"."fact_stocks__dbt_backup" cascade
[0m16:14:22.919771 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
[0m16:14:22.925795 [debug] [Thread-1  ]: Timing info for model.dbt_idx.fact_stocks (execute): 16:14:22.525974 => 16:14:22.925351
[0m16:14:22.927695 [debug] [Thread-1  ]: On model.dbt_idx.fact_stocks: Close
[0m16:14:22.932232 [info ] [Thread-1  ]: 9 of 11 OK created sql table model IDX-Schema.fact_stocks ...................... [[32mSELECT 26131[0m in 0.45s]
[0m16:14:22.937260 [debug] [Thread-1  ]: Finished running node model.dbt_idx.fact_stocks
[0m16:14:22.940168 [debug] [Thread-1  ]: Began running node model.dbt_idx.customer_orders_status
[0m16:14:22.943333 [info ] [Thread-1  ]: 10 of 11 START sql view model IDX-Schema.customer_orders_status ................ [RUN]
[0m16:14:22.946808 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_idx.fact_stocks, now model.dbt_idx.customer_orders_status)
[0m16:14:22.949751 [debug] [Thread-1  ]: Began compiling node model.dbt_idx.customer_orders_status
[0m16:14:22.959932 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_idx.customer_orders_status"
[0m16:14:22.995099 [debug] [Thread-1  ]: Timing info for model.dbt_idx.customer_orders_status (compile): 16:14:22.952167 => 16:14:22.994618
[0m16:14:22.996465 [debug] [Thread-1  ]: Began executing node model.dbt_idx.customer_orders_status
[0m16:14:23.008977 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_idx.customer_orders_status"
[0m16:14:23.037554 [debug] [Thread-1  ]: Using postgres connection "model.dbt_idx.customer_orders_status"
[0m16:14:23.038897 [debug] [Thread-1  ]: On model.dbt_idx.customer_orders_status: BEGIN
[0m16:14:23.040419 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m16:14:23.054004 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m16:14:23.056047 [debug] [Thread-1  ]: Using postgres connection "model.dbt_idx.customer_orders_status"
[0m16:14:23.059079 [debug] [Thread-1  ]: On model.dbt_idx.customer_orders_status: /* {"app": "dbt", "dbt_version": "1.5.6", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.customer_orders_status"} */

  create view "IDX-Stock"."IDX-Schema"."customer_orders_status__dbt_tmp"
    
    
  as (
    with orders as (select *
                from "IDX-Stock"."IDX-Schema"."fact_orders"),
     customers as (select *
                   from "IDX-Stock"."IDX-Schema"."dim_customers")
select o.order_id,
       o.customer_id,
       o.order_status,
       o.order_purchase_timestamp,
       o.order_approved_at,
       o.order_delivered_carrier_date,
       o.order_delivered_customer_date,
       o.order_estimated_delivery_date,
       c.zipcode    as customer_zipcode,
       c.city       as customer_city,
       c.state_code as customer_state_code,
       c.state_name as customer_state_name
from orders o
    join customers c on o.customer_id = c.customer_id
    and o.order_purchase_timestamp >= c.valid_from
    and o.order_purchase_timestamp <= c.valid_to
  );
[0m16:14:23.065815 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m16:14:23.073392 [debug] [Thread-1  ]: Using postgres connection "model.dbt_idx.customer_orders_status"
[0m16:14:23.077018 [debug] [Thread-1  ]: On model.dbt_idx.customer_orders_status: /* {"app": "dbt", "dbt_version": "1.5.6", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.customer_orders_status"} */
alter table "IDX-Stock"."IDX-Schema"."customer_orders_status__dbt_tmp" rename to "customer_orders_status"
[0m16:14:23.081194 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m16:14:23.087317 [debug] [Thread-1  ]: On model.dbt_idx.customer_orders_status: COMMIT
[0m16:14:23.089322 [debug] [Thread-1  ]: Using postgres connection "model.dbt_idx.customer_orders_status"
[0m16:14:23.091883 [debug] [Thread-1  ]: On model.dbt_idx.customer_orders_status: COMMIT
[0m16:14:23.095226 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m16:14:23.102394 [debug] [Thread-1  ]: Using postgres connection "model.dbt_idx.customer_orders_status"
[0m16:14:23.104298 [debug] [Thread-1  ]: On model.dbt_idx.customer_orders_status: /* {"app": "dbt", "dbt_version": "1.5.6", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.customer_orders_status"} */
drop view if exists "IDX-Stock"."IDX-Schema"."customer_orders_status__dbt_backup" cascade
[0m16:14:23.106377 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
[0m16:14:23.109919 [debug] [Thread-1  ]: Timing info for model.dbt_idx.customer_orders_status (execute): 16:14:22.997947 => 16:14:23.109641
[0m16:14:23.111191 [debug] [Thread-1  ]: On model.dbt_idx.customer_orders_status: Close
[0m16:14:23.113356 [info ] [Thread-1  ]: 10 of 11 OK created sql view model IDX-Schema.customer_orders_status ........... [[32mCREATE VIEW[0m in 0.17s]
[0m16:14:23.116119 [debug] [Thread-1  ]: Finished running node model.dbt_idx.customer_orders_status
[0m16:14:23.117682 [debug] [Thread-1  ]: Began running node model.dbt_idx.stock_update_status
[0m16:14:23.119182 [info ] [Thread-1  ]: 11 of 11 START sql view model IDX-Schema.stock_update_status ................... [RUN]
[0m16:14:23.121085 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_idx.customer_orders_status, now model.dbt_idx.stock_update_status)
[0m16:14:23.122371 [debug] [Thread-1  ]: Began compiling node model.dbt_idx.stock_update_status
[0m16:14:23.128146 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_idx.stock_update_status"
[0m16:14:23.155127 [debug] [Thread-1  ]: Timing info for model.dbt_idx.stock_update_status (compile): 16:14:23.123818 => 16:14:23.154646
[0m16:14:23.157059 [debug] [Thread-1  ]: Began executing node model.dbt_idx.stock_update_status
[0m16:14:23.166806 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_idx.stock_update_status"
[0m16:14:23.193249 [debug] [Thread-1  ]: Using postgres connection "model.dbt_idx.stock_update_status"
[0m16:14:23.194726 [debug] [Thread-1  ]: On model.dbt_idx.stock_update_status: BEGIN
[0m16:14:23.196415 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m16:14:23.207763 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m16:14:23.209625 [debug] [Thread-1  ]: Using postgres connection "model.dbt_idx.stock_update_status"
[0m16:14:23.211041 [debug] [Thread-1  ]: On model.dbt_idx.stock_update_status: /* {"app": "dbt", "dbt_version": "1.5.6", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stock_update_status"} */

  create view "IDX-Stock"."IDX-Schema"."stock_update_status__dbt_tmp"
    
    
  as (
    with stock as (select *,
                        rank() over (
                        partition by ticker
                        order by date desc
                        ) as rank
               from "IDX-Stock"."IDX-Schema"."fact_stocks")
select a.id,
       a.ticker,
       a.name,
       a.date,
       a.open,
       a.high,
       a.low,
       a.close,
       a.volume,
       a.rank,
       a.logo
from stock a
order by a.date desc, a.ticker desc
  );
[0m16:14:23.219183 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m16:14:23.231795 [debug] [Thread-1  ]: Using postgres connection "model.dbt_idx.stock_update_status"
[0m16:14:23.234133 [debug] [Thread-1  ]: On model.dbt_idx.stock_update_status: /* {"app": "dbt", "dbt_version": "1.5.6", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stock_update_status"} */
alter table "IDX-Stock"."IDX-Schema"."stock_update_status__dbt_tmp" rename to "stock_update_status"
[0m16:14:23.237007 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m16:14:23.242889 [debug] [Thread-1  ]: On model.dbt_idx.stock_update_status: COMMIT
[0m16:14:23.244392 [debug] [Thread-1  ]: Using postgres connection "model.dbt_idx.stock_update_status"
[0m16:14:23.245371 [debug] [Thread-1  ]: On model.dbt_idx.stock_update_status: COMMIT
[0m16:14:23.248877 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m16:14:23.255472 [debug] [Thread-1  ]: Using postgres connection "model.dbt_idx.stock_update_status"
[0m16:14:23.257208 [debug] [Thread-1  ]: On model.dbt_idx.stock_update_status: /* {"app": "dbt", "dbt_version": "1.5.6", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stock_update_status"} */
drop view if exists "IDX-Stock"."IDX-Schema"."stock_update_status__dbt_backup" cascade
[0m16:14:23.259249 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
[0m16:14:23.261804 [debug] [Thread-1  ]: Timing info for model.dbt_idx.stock_update_status (execute): 16:14:23.158196 => 16:14:23.261560
[0m16:14:23.263038 [debug] [Thread-1  ]: On model.dbt_idx.stock_update_status: Close
[0m16:14:23.266019 [info ] [Thread-1  ]: 11 of 11 OK created sql view model IDX-Schema.stock_update_status .............. [[32mCREATE VIEW[0m in 0.14s]
[0m16:14:23.268452 [debug] [Thread-1  ]: Finished running node model.dbt_idx.stock_update_status
[0m16:14:23.339644 [debug] [MainThread]: Using postgres connection "master"
[0m16:14:23.342020 [debug] [MainThread]: On master: BEGIN
[0m16:14:23.343450 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:14:23.354656 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m16:14:23.356934 [debug] [MainThread]: On master: COMMIT
[0m16:14:23.359188 [debug] [MainThread]: Using postgres connection "master"
[0m16:14:23.361320 [debug] [MainThread]: On master: COMMIT
[0m16:14:23.365091 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m16:14:23.368301 [debug] [MainThread]: On master: Close
[0m16:14:23.371990 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:14:23.376012 [debug] [MainThread]: Connection 'model.dbt_idx.stock_update_status' was properly closed.
[0m16:14:23.378596 [info ] [MainThread]: 
[0m16:14:23.382572 [info ] [MainThread]: Finished running 8 view models, 3 table models in 0 hours 0 minutes and 3.08 seconds (3.08s).
[0m16:14:23.395590 [debug] [MainThread]: Command end result
[0m16:14:23.458334 [info ] [MainThread]: 
[0m16:14:23.460413 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:14:23.462410 [info ] [MainThread]: 
[0m16:14:23.465048 [info ] [MainThread]: Done. PASS=11 WARN=0 ERROR=0 SKIP=0 TOTAL=11
[0m16:14:23.468351 [debug] [MainThread]: Command `dbt run` succeeded at 16:14:23.467907 after 4.99 seconds
[0m16:14:23.470486 [debug] [MainThread]: Flushing usage events


============================== 16:14:29.858778 | 6ab8ca58-af2e-4b5d-8934-46fae6ac2b9e ==============================
[0m16:14:29.858778 [info ] [MainThread]: Running with dbt=1.5.6
[0m16:14:29.867750 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/opt/airflow/dags/Py-DBT-IDX', 'log_path': '/opt/airflow/dags/Py-DBT-IDX/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'False'}
[0m16:14:30.077703 [info ] [MainThread]: Registered adapter: postgres=1.5.6
[0m16:14:30.117524 [debug] [MainThread]: checksum: 36b91491eb2b55e69ff526c98e337edadb953c9826242889489b2fea40332ad6, vars: {}, profile: , target: , version: 1.5.6
[0m16:14:31.302115 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:14:31.303641 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:14:31.403548 [info ] [MainThread]: Found 11 models, 19 tests, 1 snapshot, 0 analyses, 307 macros, 0 operations, 0 seed files, 5 sources, 0 exposures, 0 metrics, 0 groups
[0m16:14:31.410975 [info ] [MainThread]: 
[0m16:14:31.413544 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m16:14:31.417949 [debug] [ThreadPool]: Acquiring new postgres connection 'list_IDX-Stock_IDX-Schema'
[0m16:14:31.441245 [debug] [ThreadPool]: Using postgres connection "list_IDX-Stock_IDX-Schema"
[0m16:14:31.442841 [debug] [ThreadPool]: On list_IDX-Stock_IDX-Schema: BEGIN
[0m16:14:31.444497 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:14:31.458464 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m16:14:31.460527 [debug] [ThreadPool]: Using postgres connection "list_IDX-Stock_IDX-Schema"
[0m16:14:31.462083 [debug] [ThreadPool]: On list_IDX-Stock_IDX-Schema: /* {"app": "dbt", "dbt_version": "1.5.6", "profile_name": "dbt_idx", "target_name": "dev", "connection_name": "list_IDX-Stock_IDX-Schema"} */
select
      'IDX-Stock' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'IDX-Schema'
    union all
    select
      'IDX-Stock' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'IDX-Schema'
  
[0m16:14:31.469785 [debug] [ThreadPool]: SQL status: SELECT 17 in 0.0 seconds
[0m16:14:31.477250 [debug] [ThreadPool]: On list_IDX-Stock_IDX-Schema: ROLLBACK
[0m16:14:31.480337 [debug] [ThreadPool]: On list_IDX-Stock_IDX-Schema: Close
[0m16:14:31.484358 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_IDX-Stock_IDX-Schema, now list_IDX-Stock_snapshots)
[0m16:14:31.504993 [debug] [ThreadPool]: Using postgres connection "list_IDX-Stock_snapshots"
[0m16:14:31.507197 [debug] [ThreadPool]: On list_IDX-Stock_snapshots: BEGIN
[0m16:14:31.508988 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:14:31.521034 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m16:14:31.523365 [debug] [ThreadPool]: Using postgres connection "list_IDX-Stock_snapshots"
[0m16:14:31.526212 [debug] [ThreadPool]: On list_IDX-Stock_snapshots: /* {"app": "dbt", "dbt_version": "1.5.6", "profile_name": "dbt_idx", "target_name": "dev", "connection_name": "list_IDX-Stock_snapshots"} */
select
      'IDX-Stock' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'snapshots'
    union all
    select
      'IDX-Stock' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'snapshots'
  
[0m16:14:31.535356 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.0 seconds
[0m16:14:31.542124 [debug] [ThreadPool]: On list_IDX-Stock_snapshots: ROLLBACK
[0m16:14:31.546217 [debug] [ThreadPool]: On list_IDX-Stock_snapshots: Close
[0m16:14:31.573198 [debug] [MainThread]: Using postgres connection "master"
[0m16:14:31.575478 [debug] [MainThread]: On master: BEGIN
[0m16:14:31.577117 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:14:31.588838 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m16:14:31.591175 [debug] [MainThread]: Using postgres connection "master"
[0m16:14:31.593150 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.5.6", "profile_name": "dbt_idx", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m16:14:31.606104 [debug] [MainThread]: SQL status: SELECT 9 in 0.0 seconds
[0m16:14:31.616517 [debug] [MainThread]: On master: ROLLBACK
[0m16:14:31.619147 [debug] [MainThread]: Using postgres connection "master"
[0m16:14:31.620791 [debug] [MainThread]: On master: BEGIN
[0m16:14:31.624378 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m16:14:31.626199 [debug] [MainThread]: On master: COMMIT
[0m16:14:31.627679 [debug] [MainThread]: Using postgres connection "master"
[0m16:14:31.628785 [debug] [MainThread]: On master: COMMIT
[0m16:14:31.630568 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m16:14:31.632383 [debug] [MainThread]: On master: Close
[0m16:14:31.635714 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:14:31.638469 [info ] [MainThread]: 
[0m16:14:31.656431 [debug] [Thread-1  ]: Began running node test.dbt_idx.accepted_values_customer_orders_status_order_status__delivered__invoiced__shipped__processing__canceled__unavailable.ea8c296d27
[0m16:14:31.659314 [info ] [Thread-1  ]: 1 of 19 START test accepted_values_customer_orders_status_order_status__delivered__invoiced__shipped__processing__canceled__unavailable  [RUN]
[0m16:14:31.661672 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_IDX-Stock_snapshots, now test.dbt_idx.accepted_values_customer_orders_status_order_status__delivered__invoiced__shipped__processing__canceled__unavailable.ea8c296d27)
[0m16:14:31.663214 [debug] [Thread-1  ]: Began compiling node test.dbt_idx.accepted_values_customer_orders_status_order_status__delivered__invoiced__shipped__processing__canceled__unavailable.ea8c296d27
[0m16:14:31.702546 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_idx.accepted_values_customer_orders_status_order_status__delivered__invoiced__shipped__processing__canceled__unavailable.ea8c296d27"
[0m16:14:31.730861 [debug] [Thread-1  ]: Timing info for test.dbt_idx.accepted_values_customer_orders_status_order_status__delivered__invoiced__shipped__processing__canceled__unavailable.ea8c296d27 (compile): 16:14:31.664712 => 16:14:31.730077
[0m16:14:31.732451 [debug] [Thread-1  ]: Began executing node test.dbt_idx.accepted_values_customer_orders_status_order_status__delivered__invoiced__shipped__processing__canceled__unavailable.ea8c296d27
[0m16:14:31.762495 [debug] [Thread-1  ]: Writing runtime sql for node "test.dbt_idx.accepted_values_customer_orders_status_order_status__delivered__invoiced__shipped__processing__canceled__unavailable.ea8c296d27"
[0m16:14:31.795493 [debug] [Thread-1  ]: Using postgres connection "test.dbt_idx.accepted_values_customer_orders_status_order_status__delivered__invoiced__shipped__processing__canceled__unavailable.ea8c296d27"
[0m16:14:31.797108 [debug] [Thread-1  ]: On test.dbt_idx.accepted_values_customer_orders_status_order_status__delivered__invoiced__shipped__processing__canceled__unavailable.ea8c296d27: BEGIN
[0m16:14:31.798784 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m16:14:31.808711 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m16:14:31.810153 [debug] [Thread-1  ]: Using postgres connection "test.dbt_idx.accepted_values_customer_orders_status_order_status__delivered__invoiced__shipped__processing__canceled__unavailable.ea8c296d27"
[0m16:14:31.811583 [debug] [Thread-1  ]: On test.dbt_idx.accepted_values_customer_orders_status_order_status__delivered__invoiced__shipped__processing__canceled__unavailable.ea8c296d27: /* {"app": "dbt", "dbt_version": "1.5.6", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "test.dbt_idx.accepted_values_customer_orders_status_order_status__delivered__invoiced__shipped__processing__canceled__unavailable.ea8c296d27"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        order_status as value_field,
        count(*) as n_records

    from "IDX-Stock"."IDX-Schema"."customer_orders_status"
    group by order_status

)

select *
from all_values
where value_field not in (
    'delivered','invoiced','shipped','processing','canceled','unavailable'
)



      
    ) dbt_internal_test
[0m16:14:31.819450 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.0 seconds
[0m16:14:31.827182 [debug] [Thread-1  ]: Timing info for test.dbt_idx.accepted_values_customer_orders_status_order_status__delivered__invoiced__shipped__processing__canceled__unavailable.ea8c296d27 (execute): 16:14:31.733660 => 16:14:31.826462
[0m16:14:31.828768 [debug] [Thread-1  ]: On test.dbt_idx.accepted_values_customer_orders_status_order_status__delivered__invoiced__shipped__processing__canceled__unavailable.ea8c296d27: ROLLBACK
[0m16:14:31.831023 [debug] [Thread-1  ]: On test.dbt_idx.accepted_values_customer_orders_status_order_status__delivered__invoiced__shipped__processing__canceled__unavailable.ea8c296d27: Close
[0m16:14:31.834809 [info ] [Thread-1  ]: 1 of 19 PASS accepted_values_customer_orders_status_order_status__delivered__invoiced__shipped__processing__canceled__unavailable  [[32mPASS[0m in 0.17s]
[0m16:14:31.837130 [debug] [Thread-1  ]: Finished running node test.dbt_idx.accepted_values_customer_orders_status_order_status__delivered__invoiced__shipped__processing__canceled__unavailable.ea8c296d27
[0m16:14:31.838855 [debug] [Thread-1  ]: Began running node test.dbt_idx.assert_customer_dimension_has_no_row_loss.sql
[0m16:14:31.840654 [info ] [Thread-1  ]: 2 of 19 START test assert_customer_dimension_has_no_row_loss.sql ............... [RUN]
[0m16:14:31.842685 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.dbt_idx.accepted_values_customer_orders_status_order_status__delivered__invoiced__shipped__processing__canceled__unavailable.ea8c296d27, now test.dbt_idx.assert_customer_dimension_has_no_row_loss.sql)
[0m16:14:31.843957 [debug] [Thread-1  ]: Began compiling node test.dbt_idx.assert_customer_dimension_has_no_row_loss.sql
[0m16:14:31.852670 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_idx.assert_customer_dimension_has_no_row_loss.sql"
[0m16:14:31.874424 [debug] [Thread-1  ]: Timing info for test.dbt_idx.assert_customer_dimension_has_no_row_loss.sql (compile): 16:14:31.845141 => 16:14:31.873846
[0m16:14:31.875802 [debug] [Thread-1  ]: Began executing node test.dbt_idx.assert_customer_dimension_has_no_row_loss.sql
[0m16:14:31.881232 [debug] [Thread-1  ]: Writing runtime sql for node "test.dbt_idx.assert_customer_dimension_has_no_row_loss.sql"
[0m16:14:31.903097 [debug] [Thread-1  ]: Using postgres connection "test.dbt_idx.assert_customer_dimension_has_no_row_loss.sql"
[0m16:14:31.904629 [debug] [Thread-1  ]: On test.dbt_idx.assert_customer_dimension_has_no_row_loss.sql: BEGIN
[0m16:14:31.906477 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m16:14:31.917460 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m16:14:31.919148 [debug] [Thread-1  ]: Using postgres connection "test.dbt_idx.assert_customer_dimension_has_no_row_loss.sql"
[0m16:14:31.920471 [debug] [Thread-1  ]: On test.dbt_idx.assert_customer_dimension_has_no_row_loss.sql: /* {"app": "dbt", "dbt_version": "1.5.6", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "test.dbt_idx.assert_customer_dimension_has_no_row_loss.sql"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      -- dim_customers must have the same number of rows as its staging counterpart
-- Therefore return records where this isn't true to make the test fail
select *
from (
    select dim_cust.customer_id
    from "IDX-Stock"."IDX-Schema"."dim_customers" dim_cust
        left join "IDX-Stock"."IDX-Schema"."stg_eltool__customers_snapshots" stg_cust
    on dim_cust.customer_id = stg_cust.customer_id
    where stg_cust.customer_id is null
    UNION ALL
    select stg_cust.customer_id
    from "IDX-Stock"."IDX-Schema"."stg_eltool__customers_snapshots" stg_cust
      left join "IDX-Stock"."IDX-Schema"."dim_customers" dim_cust
    on stg_cust.customer_id = dim_cust.customer_id
    where dim_cust.customer_id is null
) tmp
      
    ) dbt_internal_test
[0m16:14:31.924885 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.0 seconds
[0m16:14:31.928504 [debug] [Thread-1  ]: Timing info for test.dbt_idx.assert_customer_dimension_has_no_row_loss.sql (execute): 16:14:31.876849 => 16:14:31.928179
[0m16:14:31.929913 [debug] [Thread-1  ]: On test.dbt_idx.assert_customer_dimension_has_no_row_loss.sql: ROLLBACK
[0m16:14:31.932456 [debug] [Thread-1  ]: On test.dbt_idx.assert_customer_dimension_has_no_row_loss.sql: Close
[0m16:14:31.935738 [info ] [Thread-1  ]: 2 of 19 PASS assert_customer_dimension_has_no_row_loss.sql ..................... [[32mPASS[0m in 0.09s]
[0m16:14:31.938683 [debug] [Thread-1  ]: Finished running node test.dbt_idx.assert_customer_dimension_has_no_row_loss.sql
[0m16:14:31.942375 [debug] [Thread-1  ]: Began running node test.dbt_idx.assert_stock_fact_has_no_row_loss.sql
[0m16:14:31.944424 [info ] [Thread-1  ]: 3 of 19 START test assert_stock_fact_has_no_row_loss.sql ....................... [RUN]
[0m16:14:31.946980 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.dbt_idx.assert_customer_dimension_has_no_row_loss.sql, now test.dbt_idx.assert_stock_fact_has_no_row_loss.sql)
[0m16:14:31.949465 [debug] [Thread-1  ]: Began compiling node test.dbt_idx.assert_stock_fact_has_no_row_loss.sql
[0m16:14:31.956897 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_idx.assert_stock_fact_has_no_row_loss.sql"
[0m16:14:31.979018 [debug] [Thread-1  ]: Timing info for test.dbt_idx.assert_stock_fact_has_no_row_loss.sql (compile): 16:14:31.951034 => 16:14:31.978599
[0m16:14:31.980477 [debug] [Thread-1  ]: Began executing node test.dbt_idx.assert_stock_fact_has_no_row_loss.sql
[0m16:14:31.986281 [debug] [Thread-1  ]: Writing runtime sql for node "test.dbt_idx.assert_stock_fact_has_no_row_loss.sql"
[0m16:14:32.008413 [debug] [Thread-1  ]: Using postgres connection "test.dbt_idx.assert_stock_fact_has_no_row_loss.sql"
[0m16:14:32.009642 [debug] [Thread-1  ]: On test.dbt_idx.assert_stock_fact_has_no_row_loss.sql: BEGIN
[0m16:14:32.010718 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m16:14:32.021376 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m16:14:32.023660 [debug] [Thread-1  ]: Using postgres connection "test.dbt_idx.assert_stock_fact_has_no_row_loss.sql"
[0m16:14:32.025788 [debug] [Thread-1  ]: On test.dbt_idx.assert_stock_fact_has_no_row_loss.sql: /* {"app": "dbt", "dbt_version": "1.5.6", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "test.dbt_idx.assert_stock_fact_has_no_row_loss.sql"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      -- fact_stocks must have the same number of rows as its staging counterpart
-- Therefore return records where this isn't true to make the test fail
select *
from (
    select stock.id
    from "IDX-Stock"."IDX-Schema"."fact_stocks" stock
    where stock.id is null
) tmp
      
    ) dbt_internal_test
[0m16:14:32.036592 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.0 seconds
[0m16:14:32.043233 [debug] [Thread-1  ]: Timing info for test.dbt_idx.assert_stock_fact_has_no_row_loss.sql (execute): 16:14:31.982162 => 16:14:32.042211
[0m16:14:32.046367 [debug] [Thread-1  ]: On test.dbt_idx.assert_stock_fact_has_no_row_loss.sql: ROLLBACK
[0m16:14:32.049345 [debug] [Thread-1  ]: On test.dbt_idx.assert_stock_fact_has_no_row_loss.sql: Close
[0m16:14:32.055226 [info ] [Thread-1  ]: 3 of 19 PASS assert_stock_fact_has_no_row_loss.sql ............................. [[32mPASS[0m in 0.11s]
[0m16:14:32.058963 [debug] [Thread-1  ]: Finished running node test.dbt_idx.assert_stock_fact_has_no_row_loss.sql
[0m16:14:32.060936 [debug] [Thread-1  ]: Began running node test.dbt_idx.not_null_customer_orders_status_customer_id.3915c814eb
[0m16:14:32.062175 [info ] [Thread-1  ]: 4 of 19 START test not_null_customer_orders_status_customer_id ................. [RUN]
[0m16:14:32.065612 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.dbt_idx.assert_stock_fact_has_no_row_loss.sql, now test.dbt_idx.not_null_customer_orders_status_customer_id.3915c814eb)
[0m16:14:32.068046 [debug] [Thread-1  ]: Began compiling node test.dbt_idx.not_null_customer_orders_status_customer_id.3915c814eb
[0m16:14:32.088536 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_idx.not_null_customer_orders_status_customer_id.3915c814eb"
[0m16:14:32.119089 [debug] [Thread-1  ]: Timing info for test.dbt_idx.not_null_customer_orders_status_customer_id.3915c814eb (compile): 16:14:32.069294 => 16:14:32.118693
[0m16:14:32.120106 [debug] [Thread-1  ]: Began executing node test.dbt_idx.not_null_customer_orders_status_customer_id.3915c814eb
[0m16:14:32.126060 [debug] [Thread-1  ]: Writing runtime sql for node "test.dbt_idx.not_null_customer_orders_status_customer_id.3915c814eb"
[0m16:14:32.151958 [debug] [Thread-1  ]: Using postgres connection "test.dbt_idx.not_null_customer_orders_status_customer_id.3915c814eb"
[0m16:14:32.152981 [debug] [Thread-1  ]: On test.dbt_idx.not_null_customer_orders_status_customer_id.3915c814eb: BEGIN
[0m16:14:32.153885 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m16:14:32.162896 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m16:14:32.165166 [debug] [Thread-1  ]: Using postgres connection "test.dbt_idx.not_null_customer_orders_status_customer_id.3915c814eb"
[0m16:14:32.166876 [debug] [Thread-1  ]: On test.dbt_idx.not_null_customer_orders_status_customer_id.3915c814eb: /* {"app": "dbt", "dbt_version": "1.5.6", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "test.dbt_idx.not_null_customer_orders_status_customer_id.3915c814eb"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select customer_id
from "IDX-Stock"."IDX-Schema"."customer_orders_status"
where customer_id is null



      
    ) dbt_internal_test
[0m16:14:32.171311 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.0 seconds
[0m16:14:32.176886 [debug] [Thread-1  ]: Timing info for test.dbt_idx.not_null_customer_orders_status_customer_id.3915c814eb (execute): 16:14:32.120894 => 16:14:32.176524
[0m16:14:32.178077 [debug] [Thread-1  ]: On test.dbt_idx.not_null_customer_orders_status_customer_id.3915c814eb: ROLLBACK
[0m16:14:32.179541 [debug] [Thread-1  ]: On test.dbt_idx.not_null_customer_orders_status_customer_id.3915c814eb: Close
[0m16:14:32.184607 [info ] [Thread-1  ]: 4 of 19 PASS not_null_customer_orders_status_customer_id ....................... [[32mPASS[0m in 0.12s]
[0m16:14:32.188310 [debug] [Thread-1  ]: Finished running node test.dbt_idx.not_null_customer_orders_status_customer_id.3915c814eb
[0m16:14:32.190349 [debug] [Thread-1  ]: Began running node test.dbt_idx.not_null_dim_customers_customer_id.dd91cd1c8d
[0m16:14:32.192796 [info ] [Thread-1  ]: 5 of 19 START test not_null_dim_customers_customer_id .......................... [RUN]
[0m16:14:32.195584 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.dbt_idx.not_null_customer_orders_status_customer_id.3915c814eb, now test.dbt_idx.not_null_dim_customers_customer_id.dd91cd1c8d)
[0m16:14:32.197657 [debug] [Thread-1  ]: Began compiling node test.dbt_idx.not_null_dim_customers_customer_id.dd91cd1c8d
[0m16:14:32.210992 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_idx.not_null_dim_customers_customer_id.dd91cd1c8d"
[0m16:14:32.239273 [debug] [Thread-1  ]: Timing info for test.dbt_idx.not_null_dim_customers_customer_id.dd91cd1c8d (compile): 16:14:32.199653 => 16:14:32.238773
[0m16:14:32.240643 [debug] [Thread-1  ]: Began executing node test.dbt_idx.not_null_dim_customers_customer_id.dd91cd1c8d
[0m16:14:32.244588 [debug] [Thread-1  ]: Writing runtime sql for node "test.dbt_idx.not_null_dim_customers_customer_id.dd91cd1c8d"
[0m16:14:32.271555 [debug] [Thread-1  ]: Using postgres connection "test.dbt_idx.not_null_dim_customers_customer_id.dd91cd1c8d"
[0m16:14:32.273170 [debug] [Thread-1  ]: On test.dbt_idx.not_null_dim_customers_customer_id.dd91cd1c8d: BEGIN
[0m16:14:32.274441 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m16:14:32.283223 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m16:14:32.284790 [debug] [Thread-1  ]: Using postgres connection "test.dbt_idx.not_null_dim_customers_customer_id.dd91cd1c8d"
[0m16:14:32.286100 [debug] [Thread-1  ]: On test.dbt_idx.not_null_dim_customers_customer_id.dd91cd1c8d: /* {"app": "dbt", "dbt_version": "1.5.6", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "test.dbt_idx.not_null_dim_customers_customer_id.dd91cd1c8d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select customer_id
from "IDX-Stock"."IDX-Schema"."dim_customers"
where customer_id is null



      
    ) dbt_internal_test
[0m16:14:32.289496 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.0 seconds
[0m16:14:32.295104 [debug] [Thread-1  ]: Timing info for test.dbt_idx.not_null_dim_customers_customer_id.dd91cd1c8d (execute): 16:14:32.241420 => 16:14:32.294701
[0m16:14:32.296691 [debug] [Thread-1  ]: On test.dbt_idx.not_null_dim_customers_customer_id.dd91cd1c8d: ROLLBACK
[0m16:14:32.300762 [debug] [Thread-1  ]: On test.dbt_idx.not_null_dim_customers_customer_id.dd91cd1c8d: Close
[0m16:14:32.305012 [info ] [Thread-1  ]: 5 of 19 PASS not_null_dim_customers_customer_id ................................ [[32mPASS[0m in 0.11s]
[0m16:14:32.308992 [debug] [Thread-1  ]: Finished running node test.dbt_idx.not_null_dim_customers_customer_id.dd91cd1c8d
[0m16:14:32.311054 [debug] [Thread-1  ]: Began running node test.dbt_idx.not_null_fact_stocks_id.e7b7e788fa
[0m16:14:32.312263 [info ] [Thread-1  ]: 6 of 19 START test not_null_fact_stocks_id ..................................... [RUN]
[0m16:14:32.316411 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.dbt_idx.not_null_dim_customers_customer_id.dd91cd1c8d, now test.dbt_idx.not_null_fact_stocks_id.e7b7e788fa)
[0m16:14:32.318773 [debug] [Thread-1  ]: Began compiling node test.dbt_idx.not_null_fact_stocks_id.e7b7e788fa
[0m16:14:32.327945 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_idx.not_null_fact_stocks_id.e7b7e788fa"
[0m16:14:32.359549 [debug] [Thread-1  ]: Timing info for test.dbt_idx.not_null_fact_stocks_id.e7b7e788fa (compile): 16:14:32.320009 => 16:14:32.359166
[0m16:14:32.360598 [debug] [Thread-1  ]: Began executing node test.dbt_idx.not_null_fact_stocks_id.e7b7e788fa
[0m16:14:32.365488 [debug] [Thread-1  ]: Writing runtime sql for node "test.dbt_idx.not_null_fact_stocks_id.e7b7e788fa"
[0m16:14:32.393070 [debug] [Thread-1  ]: Using postgres connection "test.dbt_idx.not_null_fact_stocks_id.e7b7e788fa"
[0m16:14:32.394250 [debug] [Thread-1  ]: On test.dbt_idx.not_null_fact_stocks_id.e7b7e788fa: BEGIN
[0m16:14:32.395158 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m16:14:32.405167 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m16:14:32.407516 [debug] [Thread-1  ]: Using postgres connection "test.dbt_idx.not_null_fact_stocks_id.e7b7e788fa"
[0m16:14:32.409947 [debug] [Thread-1  ]: On test.dbt_idx.not_null_fact_stocks_id.e7b7e788fa: /* {"app": "dbt", "dbt_version": "1.5.6", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "test.dbt_idx.not_null_fact_stocks_id.e7b7e788fa"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from "IDX-Stock"."IDX-Schema"."fact_stocks"
where id is null



      
    ) dbt_internal_test
[0m16:14:32.418529 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.0 seconds
[0m16:14:32.424618 [debug] [Thread-1  ]: Timing info for test.dbt_idx.not_null_fact_stocks_id.e7b7e788fa (execute): 16:14:32.361425 => 16:14:32.423124
[0m16:14:32.428376 [debug] [Thread-1  ]: On test.dbt_idx.not_null_fact_stocks_id.e7b7e788fa: ROLLBACK
[0m16:14:32.431446 [debug] [Thread-1  ]: On test.dbt_idx.not_null_fact_stocks_id.e7b7e788fa: Close
[0m16:14:32.435806 [info ] [Thread-1  ]: 6 of 19 PASS not_null_fact_stocks_id ........................................... [[32mPASS[0m in 0.12s]
[0m16:14:32.439677 [debug] [Thread-1  ]: Finished running node test.dbt_idx.not_null_fact_stocks_id.e7b7e788fa
[0m16:14:32.442305 [debug] [Thread-1  ]: Began running node test.dbt_idx.not_null_stg_eltool__company_id.632831b79c
[0m16:14:32.443718 [info ] [Thread-1  ]: 7 of 19 START test not_null_stg_eltool__company_id ............................. [RUN]
[0m16:14:32.445889 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.dbt_idx.not_null_fact_stocks_id.e7b7e788fa, now test.dbt_idx.not_null_stg_eltool__company_id.632831b79c)
[0m16:14:32.447636 [debug] [Thread-1  ]: Began compiling node test.dbt_idx.not_null_stg_eltool__company_id.632831b79c
[0m16:14:32.458064 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_idx.not_null_stg_eltool__company_id.632831b79c"
[0m16:14:32.484004 [debug] [Thread-1  ]: Timing info for test.dbt_idx.not_null_stg_eltool__company_id.632831b79c (compile): 16:14:32.449806 => 16:14:32.483603
[0m16:14:32.485287 [debug] [Thread-1  ]: Began executing node test.dbt_idx.not_null_stg_eltool__company_id.632831b79c
[0m16:14:32.489757 [debug] [Thread-1  ]: Writing runtime sql for node "test.dbt_idx.not_null_stg_eltool__company_id.632831b79c"
[0m16:14:32.514684 [debug] [Thread-1  ]: Using postgres connection "test.dbt_idx.not_null_stg_eltool__company_id.632831b79c"
[0m16:14:32.516390 [debug] [Thread-1  ]: On test.dbt_idx.not_null_stg_eltool__company_id.632831b79c: BEGIN
[0m16:14:32.517326 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m16:14:32.525811 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m16:14:32.527425 [debug] [Thread-1  ]: Using postgres connection "test.dbt_idx.not_null_stg_eltool__company_id.632831b79c"
[0m16:14:32.528958 [debug] [Thread-1  ]: On test.dbt_idx.not_null_stg_eltool__company_id.632831b79c: /* {"app": "dbt", "dbt_version": "1.5.6", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "test.dbt_idx.not_null_stg_eltool__company_id.632831b79c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from "IDX-Stock"."IDX-Schema"."stg_eltool__company"
where id is null



      
    ) dbt_internal_test
[0m16:14:32.533297 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.0 seconds
[0m16:14:32.537581 [debug] [Thread-1  ]: Timing info for test.dbt_idx.not_null_stg_eltool__company_id.632831b79c (execute): 16:14:32.486087 => 16:14:32.537142
[0m16:14:32.540004 [debug] [Thread-1  ]: On test.dbt_idx.not_null_stg_eltool__company_id.632831b79c: ROLLBACK
[0m16:14:32.542434 [debug] [Thread-1  ]: On test.dbt_idx.not_null_stg_eltool__company_id.632831b79c: Close
[0m16:14:32.544239 [info ] [Thread-1  ]: 7 of 19 PASS not_null_stg_eltool__company_id ................................... [[32mPASS[0m in 0.10s]
[0m16:14:32.547574 [debug] [Thread-1  ]: Finished running node test.dbt_idx.not_null_stg_eltool__company_id.632831b79c
[0m16:14:32.550450 [debug] [Thread-1  ]: Began running node test.dbt_idx.not_null_stg_eltool__customers_snapshots_customer_id.ea4fc4ca86
[0m16:14:32.552991 [info ] [Thread-1  ]: 8 of 19 START test not_null_stg_eltool__customers_snapshots_customer_id ........ [RUN]
[0m16:14:32.556025 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.dbt_idx.not_null_stg_eltool__company_id.632831b79c, now test.dbt_idx.not_null_stg_eltool__customers_snapshots_customer_id.ea4fc4ca86)
[0m16:14:32.558838 [debug] [Thread-1  ]: Began compiling node test.dbt_idx.not_null_stg_eltool__customers_snapshots_customer_id.ea4fc4ca86
[0m16:14:32.569840 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_idx.not_null_stg_eltool__customers_snapshots_customer_id.ea4fc4ca86"
[0m16:14:32.600681 [debug] [Thread-1  ]: Timing info for test.dbt_idx.not_null_stg_eltool__customers_snapshots_customer_id.ea4fc4ca86 (compile): 16:14:32.560725 => 16:14:32.600252
[0m16:14:32.601751 [debug] [Thread-1  ]: Began executing node test.dbt_idx.not_null_stg_eltool__customers_snapshots_customer_id.ea4fc4ca86
[0m16:14:32.606400 [debug] [Thread-1  ]: Writing runtime sql for node "test.dbt_idx.not_null_stg_eltool__customers_snapshots_customer_id.ea4fc4ca86"
[0m16:14:32.629263 [debug] [Thread-1  ]: Using postgres connection "test.dbt_idx.not_null_stg_eltool__customers_snapshots_customer_id.ea4fc4ca86"
[0m16:14:32.630860 [debug] [Thread-1  ]: On test.dbt_idx.not_null_stg_eltool__customers_snapshots_customer_id.ea4fc4ca86: BEGIN
[0m16:14:32.632005 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m16:14:32.641373 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m16:14:32.643056 [debug] [Thread-1  ]: Using postgres connection "test.dbt_idx.not_null_stg_eltool__customers_snapshots_customer_id.ea4fc4ca86"
[0m16:14:32.644558 [debug] [Thread-1  ]: On test.dbt_idx.not_null_stg_eltool__customers_snapshots_customer_id.ea4fc4ca86: /* {"app": "dbt", "dbt_version": "1.5.6", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "test.dbt_idx.not_null_stg_eltool__customers_snapshots_customer_id.ea4fc4ca86"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select customer_id
from "IDX-Stock"."IDX-Schema"."stg_eltool__customers_snapshots"
where customer_id is null



      
    ) dbt_internal_test
[0m16:14:32.648725 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.0 seconds
[0m16:14:32.652535 [debug] [Thread-1  ]: Timing info for test.dbt_idx.not_null_stg_eltool__customers_snapshots_customer_id.ea4fc4ca86 (execute): 16:14:32.602519 => 16:14:32.652067
[0m16:14:32.653744 [debug] [Thread-1  ]: On test.dbt_idx.not_null_stg_eltool__customers_snapshots_customer_id.ea4fc4ca86: ROLLBACK
[0m16:14:32.656263 [debug] [Thread-1  ]: On test.dbt_idx.not_null_stg_eltool__customers_snapshots_customer_id.ea4fc4ca86: Close
[0m16:14:32.659923 [info ] [Thread-1  ]: 8 of 19 PASS not_null_stg_eltool__customers_snapshots_customer_id .............. [[32mPASS[0m in 0.10s]
[0m16:14:32.663473 [debug] [Thread-1  ]: Finished running node test.dbt_idx.not_null_stg_eltool__customers_snapshots_customer_id.ea4fc4ca86
[0m16:14:32.666335 [debug] [Thread-1  ]: Began running node test.dbt_idx.not_null_stg_eltool__stock_id.68f6d1d89a
[0m16:14:32.668766 [info ] [Thread-1  ]: 9 of 19 START test not_null_stg_eltool__stock_id ............................... [RUN]
[0m16:14:32.671426 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.dbt_idx.not_null_stg_eltool__customers_snapshots_customer_id.ea4fc4ca86, now test.dbt_idx.not_null_stg_eltool__stock_id.68f6d1d89a)
[0m16:14:32.674813 [debug] [Thread-1  ]: Began compiling node test.dbt_idx.not_null_stg_eltool__stock_id.68f6d1d89a
[0m16:14:32.686714 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_idx.not_null_stg_eltool__stock_id.68f6d1d89a"
[0m16:14:32.724975 [debug] [Thread-1  ]: Timing info for test.dbt_idx.not_null_stg_eltool__stock_id.68f6d1d89a (compile): 16:14:32.677099 => 16:14:32.724518
[0m16:14:32.726371 [debug] [Thread-1  ]: Began executing node test.dbt_idx.not_null_stg_eltool__stock_id.68f6d1d89a
[0m16:14:32.781274 [debug] [Thread-1  ]: Writing runtime sql for node "test.dbt_idx.not_null_stg_eltool__stock_id.68f6d1d89a"
[0m16:14:32.823557 [debug] [Thread-1  ]: Using postgres connection "test.dbt_idx.not_null_stg_eltool__stock_id.68f6d1d89a"
[0m16:14:32.826159 [debug] [Thread-1  ]: On test.dbt_idx.not_null_stg_eltool__stock_id.68f6d1d89a: BEGIN
[0m16:14:32.828455 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m16:14:32.840682 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m16:14:32.842819 [debug] [Thread-1  ]: Using postgres connection "test.dbt_idx.not_null_stg_eltool__stock_id.68f6d1d89a"
[0m16:14:32.844813 [debug] [Thread-1  ]: On test.dbt_idx.not_null_stg_eltool__stock_id.68f6d1d89a: /* {"app": "dbt", "dbt_version": "1.5.6", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "test.dbt_idx.not_null_stg_eltool__stock_id.68f6d1d89a"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from "IDX-Stock"."IDX-Schema"."stg_eltool__stock"
where id is null



      
    ) dbt_internal_test
[0m16:14:32.854722 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.0 seconds
[0m16:14:32.862328 [debug] [Thread-1  ]: Timing info for test.dbt_idx.not_null_stg_eltool__stock_id.68f6d1d89a (execute): 16:14:32.727458 => 16:14:32.861249
[0m16:14:32.865123 [debug] [Thread-1  ]: On test.dbt_idx.not_null_stg_eltool__stock_id.68f6d1d89a: ROLLBACK
[0m16:14:32.867601 [debug] [Thread-1  ]: On test.dbt_idx.not_null_stg_eltool__stock_id.68f6d1d89a: Close
[0m16:14:32.870316 [info ] [Thread-1  ]: 9 of 19 PASS not_null_stg_eltool__stock_id ..................................... [[32mPASS[0m in 0.20s]
[0m16:14:32.875029 [debug] [Thread-1  ]: Finished running node test.dbt_idx.not_null_stg_eltool__stock_id.68f6d1d89a
[0m16:14:32.877863 [debug] [Thread-1  ]: Began running node test.dbt_idx.not_null_stock_update_status_id.633bc8afe3
[0m16:14:32.880282 [info ] [Thread-1  ]: 10 of 19 START test not_null_stock_update_status_id ............................ [RUN]
[0m16:14:32.884513 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.dbt_idx.not_null_stg_eltool__stock_id.68f6d1d89a, now test.dbt_idx.not_null_stock_update_status_id.633bc8afe3)
[0m16:14:32.886697 [debug] [Thread-1  ]: Began compiling node test.dbt_idx.not_null_stock_update_status_id.633bc8afe3
[0m16:14:32.896385 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_idx.not_null_stock_update_status_id.633bc8afe3"
[0m16:14:32.933848 [debug] [Thread-1  ]: Timing info for test.dbt_idx.not_null_stock_update_status_id.633bc8afe3 (compile): 16:14:32.888559 => 16:14:32.933407
[0m16:14:32.935336 [debug] [Thread-1  ]: Began executing node test.dbt_idx.not_null_stock_update_status_id.633bc8afe3
[0m16:14:32.939861 [debug] [Thread-1  ]: Writing runtime sql for node "test.dbt_idx.not_null_stock_update_status_id.633bc8afe3"
[0m16:14:32.967416 [debug] [Thread-1  ]: Using postgres connection "test.dbt_idx.not_null_stock_update_status_id.633bc8afe3"
[0m16:14:32.968467 [debug] [Thread-1  ]: On test.dbt_idx.not_null_stock_update_status_id.633bc8afe3: BEGIN
[0m16:14:32.969470 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m16:14:32.978894 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m16:14:32.981329 [debug] [Thread-1  ]: Using postgres connection "test.dbt_idx.not_null_stock_update_status_id.633bc8afe3"
[0m16:14:32.983502 [debug] [Thread-1  ]: On test.dbt_idx.not_null_stock_update_status_id.633bc8afe3: /* {"app": "dbt", "dbt_version": "1.5.6", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "test.dbt_idx.not_null_stock_update_status_id.633bc8afe3"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from "IDX-Stock"."IDX-Schema"."stock_update_status"
where id is null



      
    ) dbt_internal_test
[0m16:14:32.995591 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.0 seconds
[0m16:14:33.003237 [debug] [Thread-1  ]: Timing info for test.dbt_idx.not_null_stock_update_status_id.633bc8afe3 (execute): 16:14:32.936097 => 16:14:33.002057
[0m16:14:33.006017 [debug] [Thread-1  ]: On test.dbt_idx.not_null_stock_update_status_id.633bc8afe3: ROLLBACK
[0m16:14:33.008599 [debug] [Thread-1  ]: On test.dbt_idx.not_null_stock_update_status_id.633bc8afe3: Close
[0m16:14:33.012325 [info ] [Thread-1  ]: 10 of 19 PASS not_null_stock_update_status_id .................................. [[32mPASS[0m in 0.13s]
[0m16:14:33.016303 [debug] [Thread-1  ]: Finished running node test.dbt_idx.not_null_stock_update_status_id.633bc8afe3
[0m16:14:33.018907 [debug] [Thread-1  ]: Began running node test.dbt_idx.source_not_null_IDX-Schema_customers_customer_id.8525798d49
[0m16:14:33.020503 [info ] [Thread-1  ]: 11 of 19 START test source_not_null_IDX-Schema_customers_customer_id ........... [RUN]
[0m16:14:33.024519 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.dbt_idx.not_null_stock_update_status_id.633bc8afe3, now test.dbt_idx.source_not_null_IDX-Schema_customers_customer_id.8525798d49)
[0m16:14:33.025946 [debug] [Thread-1  ]: Began compiling node test.dbt_idx.source_not_null_IDX-Schema_customers_customer_id.8525798d49
[0m16:14:33.038989 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_idx.source_not_null_IDX-Schema_customers_customer_id.8525798d49"
[0m16:14:33.063585 [debug] [Thread-1  ]: Timing info for test.dbt_idx.source_not_null_IDX-Schema_customers_customer_id.8525798d49 (compile): 16:14:33.027181 => 16:14:33.063066
[0m16:14:33.065128 [debug] [Thread-1  ]: Began executing node test.dbt_idx.source_not_null_IDX-Schema_customers_customer_id.8525798d49
[0m16:14:33.069105 [debug] [Thread-1  ]: Writing runtime sql for node "test.dbt_idx.source_not_null_IDX-Schema_customers_customer_id.8525798d49"
[0m16:14:33.090682 [debug] [Thread-1  ]: Using postgres connection "test.dbt_idx.source_not_null_IDX-Schema_customers_customer_id.8525798d49"
[0m16:14:33.092067 [debug] [Thread-1  ]: On test.dbt_idx.source_not_null_IDX-Schema_customers_customer_id.8525798d49: BEGIN
[0m16:14:33.093071 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m16:14:33.103233 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m16:14:33.105351 [debug] [Thread-1  ]: Using postgres connection "test.dbt_idx.source_not_null_IDX-Schema_customers_customer_id.8525798d49"
[0m16:14:33.107444 [debug] [Thread-1  ]: On test.dbt_idx.source_not_null_IDX-Schema_customers_customer_id.8525798d49: /* {"app": "dbt", "dbt_version": "1.5.6", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "test.dbt_idx.source_not_null_IDX-Schema_customers_customer_id.8525798d49"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select customer_id
from "IDX-Stock"."IDX-Schema"."customers"
where customer_id is null



      
    ) dbt_internal_test
[0m16:14:33.110622 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.0 seconds
[0m16:14:33.116091 [debug] [Thread-1  ]: Timing info for test.dbt_idx.source_not_null_IDX-Schema_customers_customer_id.8525798d49 (execute): 16:14:33.065998 => 16:14:33.115370
[0m16:14:33.117435 [debug] [Thread-1  ]: On test.dbt_idx.source_not_null_IDX-Schema_customers_customer_id.8525798d49: ROLLBACK
[0m16:14:33.118940 [debug] [Thread-1  ]: On test.dbt_idx.source_not_null_IDX-Schema_customers_customer_id.8525798d49: Close
[0m16:14:33.120681 [info ] [Thread-1  ]: 11 of 19 PASS source_not_null_IDX-Schema_customers_customer_id ................. [[32mPASS[0m in 0.10s]
[0m16:14:33.126079 [debug] [Thread-1  ]: Finished running node test.dbt_idx.source_not_null_IDX-Schema_customers_customer_id.8525798d49
[0m16:14:33.128501 [debug] [Thread-1  ]: Began running node test.dbt_idx.source_not_null_IDX-Schema_ksql-company-stream_id.d088b78209
[0m16:14:33.130600 [info ] [Thread-1  ]: 12 of 19 START test source_not_null_IDX-Schema_ksql-company-stream_id .......... [RUN]
[0m16:14:33.134375 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.dbt_idx.source_not_null_IDX-Schema_customers_customer_id.8525798d49, now test.dbt_idx.source_not_null_IDX-Schema_ksql-company-stream_id.d088b78209)
[0m16:14:33.136964 [debug] [Thread-1  ]: Began compiling node test.dbt_idx.source_not_null_IDX-Schema_ksql-company-stream_id.d088b78209
[0m16:14:33.150182 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_idx.source_not_null_IDX-Schema_ksql-company-stream_id.d088b78209"
[0m16:14:33.178059 [debug] [Thread-1  ]: Timing info for test.dbt_idx.source_not_null_IDX-Schema_ksql-company-stream_id.d088b78209 (compile): 16:14:33.138797 => 16:14:33.177602
[0m16:14:33.179299 [debug] [Thread-1  ]: Began executing node test.dbt_idx.source_not_null_IDX-Schema_ksql-company-stream_id.d088b78209
[0m16:14:33.185396 [debug] [Thread-1  ]: Writing runtime sql for node "test.dbt_idx.source_not_null_IDX-Schema_ksql-company-stream_id.d088b78209"
[0m16:14:33.210609 [debug] [Thread-1  ]: Using postgres connection "test.dbt_idx.source_not_null_IDX-Schema_ksql-company-stream_id.d088b78209"
[0m16:14:33.211720 [debug] [Thread-1  ]: On test.dbt_idx.source_not_null_IDX-Schema_ksql-company-stream_id.d088b78209: BEGIN
[0m16:14:33.212949 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m16:14:33.223438 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m16:14:33.225316 [debug] [Thread-1  ]: Using postgres connection "test.dbt_idx.source_not_null_IDX-Schema_ksql-company-stream_id.d088b78209"
[0m16:14:33.227231 [debug] [Thread-1  ]: On test.dbt_idx.source_not_null_IDX-Schema_ksql-company-stream_id.d088b78209: /* {"app": "dbt", "dbt_version": "1.5.6", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "test.dbt_idx.source_not_null_IDX-Schema_ksql-company-stream_id.d088b78209"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from "IDX-Stock"."IDX-Schema"."ksql-company-stream"
where id is null



      
    ) dbt_internal_test
[0m16:14:33.233499 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.0 seconds
[0m16:14:33.240845 [debug] [Thread-1  ]: Timing info for test.dbt_idx.source_not_null_IDX-Schema_ksql-company-stream_id.d088b78209 (execute): 16:14:33.180719 => 16:14:33.239271
[0m16:14:33.243495 [debug] [Thread-1  ]: On test.dbt_idx.source_not_null_IDX-Schema_ksql-company-stream_id.d088b78209: ROLLBACK
[0m16:14:33.247382 [debug] [Thread-1  ]: On test.dbt_idx.source_not_null_IDX-Schema_ksql-company-stream_id.d088b78209: Close
[0m16:14:33.250683 [info ] [Thread-1  ]: 12 of 19 PASS source_not_null_IDX-Schema_ksql-company-stream_id ................ [[32mPASS[0m in 0.12s]
[0m16:14:33.252845 [debug] [Thread-1  ]: Finished running node test.dbt_idx.source_not_null_IDX-Schema_ksql-company-stream_id.d088b78209
[0m16:14:33.254596 [debug] [Thread-1  ]: Began running node test.dbt_idx.source_not_null_IDX-Schema_ksql-stock-stream_id.b3b44ecba6
[0m16:14:33.257079 [info ] [Thread-1  ]: 13 of 19 START test source_not_null_IDX-Schema_ksql-stock-stream_id ............ [RUN]
[0m16:14:33.259224 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.dbt_idx.source_not_null_IDX-Schema_ksql-company-stream_id.d088b78209, now test.dbt_idx.source_not_null_IDX-Schema_ksql-stock-stream_id.b3b44ecba6)
[0m16:14:33.260253 [debug] [Thread-1  ]: Began compiling node test.dbt_idx.source_not_null_IDX-Schema_ksql-stock-stream_id.b3b44ecba6
[0m16:14:33.269042 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_idx.source_not_null_IDX-Schema_ksql-stock-stream_id.b3b44ecba6"
[0m16:14:33.294903 [debug] [Thread-1  ]: Timing info for test.dbt_idx.source_not_null_IDX-Schema_ksql-stock-stream_id.b3b44ecba6 (compile): 16:14:33.261058 => 16:14:33.294509
[0m16:14:33.296159 [debug] [Thread-1  ]: Began executing node test.dbt_idx.source_not_null_IDX-Schema_ksql-stock-stream_id.b3b44ecba6
[0m16:14:33.300935 [debug] [Thread-1  ]: Writing runtime sql for node "test.dbt_idx.source_not_null_IDX-Schema_ksql-stock-stream_id.b3b44ecba6"
[0m16:14:33.324403 [debug] [Thread-1  ]: Using postgres connection "test.dbt_idx.source_not_null_IDX-Schema_ksql-stock-stream_id.b3b44ecba6"
[0m16:14:33.325477 [debug] [Thread-1  ]: On test.dbt_idx.source_not_null_IDX-Schema_ksql-stock-stream_id.b3b44ecba6: BEGIN
[0m16:14:33.326496 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m16:14:33.335198 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m16:14:33.336878 [debug] [Thread-1  ]: Using postgres connection "test.dbt_idx.source_not_null_IDX-Schema_ksql-stock-stream_id.b3b44ecba6"
[0m16:14:33.338946 [debug] [Thread-1  ]: On test.dbt_idx.source_not_null_IDX-Schema_ksql-stock-stream_id.b3b44ecba6: /* {"app": "dbt", "dbt_version": "1.5.6", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "test.dbt_idx.source_not_null_IDX-Schema_ksql-stock-stream_id.b3b44ecba6"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from "IDX-Stock"."IDX-Schema"."ksql-stock-stream"
where id is null



      
    ) dbt_internal_test
[0m16:14:33.344538 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.0 seconds
[0m16:14:33.347912 [debug] [Thread-1  ]: Timing info for test.dbt_idx.source_not_null_IDX-Schema_ksql-stock-stream_id.b3b44ecba6 (execute): 16:14:33.297267 => 16:14:33.347247
[0m16:14:33.349201 [debug] [Thread-1  ]: On test.dbt_idx.source_not_null_IDX-Schema_ksql-stock-stream_id.b3b44ecba6: ROLLBACK
[0m16:14:33.350601 [debug] [Thread-1  ]: On test.dbt_idx.source_not_null_IDX-Schema_ksql-stock-stream_id.b3b44ecba6: Close
[0m16:14:33.352133 [info ] [Thread-1  ]: 13 of 19 PASS source_not_null_IDX-Schema_ksql-stock-stream_id .................. [[32mPASS[0m in 0.09s]
[0m16:14:33.353821 [debug] [Thread-1  ]: Finished running node test.dbt_idx.source_not_null_IDX-Schema_ksql-stock-stream_id.b3b44ecba6
[0m16:14:33.355502 [debug] [Thread-1  ]: Began running node test.dbt_idx.source_not_null_IDX-Schema_orders_order_id.f2383dcca5
[0m16:14:33.357750 [info ] [Thread-1  ]: 14 of 19 START test source_not_null_IDX-Schema_orders_order_id ................. [RUN]
[0m16:14:33.360646 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.dbt_idx.source_not_null_IDX-Schema_ksql-stock-stream_id.b3b44ecba6, now test.dbt_idx.source_not_null_IDX-Schema_orders_order_id.f2383dcca5)
[0m16:14:33.362257 [debug] [Thread-1  ]: Began compiling node test.dbt_idx.source_not_null_IDX-Schema_orders_order_id.f2383dcca5
[0m16:14:33.378255 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_idx.source_not_null_IDX-Schema_orders_order_id.f2383dcca5"
[0m16:14:33.405104 [debug] [Thread-1  ]: Timing info for test.dbt_idx.source_not_null_IDX-Schema_orders_order_id.f2383dcca5 (compile): 16:14:33.364016 => 16:14:33.404443
[0m16:14:33.406863 [debug] [Thread-1  ]: Began executing node test.dbt_idx.source_not_null_IDX-Schema_orders_order_id.f2383dcca5
[0m16:14:33.410948 [debug] [Thread-1  ]: Writing runtime sql for node "test.dbt_idx.source_not_null_IDX-Schema_orders_order_id.f2383dcca5"
[0m16:14:33.443948 [debug] [Thread-1  ]: Using postgres connection "test.dbt_idx.source_not_null_IDX-Schema_orders_order_id.f2383dcca5"
[0m16:14:33.447425 [debug] [Thread-1  ]: On test.dbt_idx.source_not_null_IDX-Schema_orders_order_id.f2383dcca5: BEGIN
[0m16:14:33.449153 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m16:14:33.458677 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m16:14:33.460196 [debug] [Thread-1  ]: Using postgres connection "test.dbt_idx.source_not_null_IDX-Schema_orders_order_id.f2383dcca5"
[0m16:14:33.461622 [debug] [Thread-1  ]: On test.dbt_idx.source_not_null_IDX-Schema_orders_order_id.f2383dcca5: /* {"app": "dbt", "dbt_version": "1.5.6", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "test.dbt_idx.source_not_null_IDX-Schema_orders_order_id.f2383dcca5"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select order_id
from "IDX-Stock"."IDX-Schema"."orders"
where order_id is null



      
    ) dbt_internal_test
[0m16:14:33.467028 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.0 seconds
[0m16:14:33.473902 [debug] [Thread-1  ]: Timing info for test.dbt_idx.source_not_null_IDX-Schema_orders_order_id.f2383dcca5 (execute): 16:14:33.407868 => 16:14:33.472899
[0m16:14:33.477002 [debug] [Thread-1  ]: On test.dbt_idx.source_not_null_IDX-Schema_orders_order_id.f2383dcca5: ROLLBACK
[0m16:14:33.480579 [debug] [Thread-1  ]: On test.dbt_idx.source_not_null_IDX-Schema_orders_order_id.f2383dcca5: Close
[0m16:14:33.484713 [info ] [Thread-1  ]: 14 of 19 PASS source_not_null_IDX-Schema_orders_order_id ....................... [[32mPASS[0m in 0.12s]
[0m16:14:33.487075 [debug] [Thread-1  ]: Finished running node test.dbt_idx.source_not_null_IDX-Schema_orders_order_id.f2383dcca5
[0m16:14:33.489380 [debug] [Thread-1  ]: Began running node test.dbt_idx.source_relationships_IDX-Schema_orders_cust_id__customer_id__source_IDX_Schema_customers_.dc582657bc
[0m16:14:33.493503 [info ] [Thread-1  ]: 15 of 19 START test source_relationships_IDX-Schema_orders_cust_id__customer_id__source_IDX_Schema_customers_  [RUN]
[0m16:14:33.499291 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.dbt_idx.source_not_null_IDX-Schema_orders_order_id.f2383dcca5, now test.dbt_idx.source_relationships_IDX-Schema_orders_cust_id__customer_id__source_IDX_Schema_customers_.dc582657bc)
[0m16:14:33.502187 [debug] [Thread-1  ]: Began compiling node test.dbt_idx.source_relationships_IDX-Schema_orders_cust_id__customer_id__source_IDX_Schema_customers_.dc582657bc
[0m16:14:33.536624 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_idx.source_relationships_IDX-Schema_orders_cust_id__customer_id__source_IDX_Schema_customers_.dc582657bc"
[0m16:14:33.580771 [debug] [Thread-1  ]: Timing info for test.dbt_idx.source_relationships_IDX-Schema_orders_cust_id__customer_id__source_IDX_Schema_customers_.dc582657bc (compile): 16:14:33.503705 => 16:14:33.579708
[0m16:14:33.583694 [debug] [Thread-1  ]: Began executing node test.dbt_idx.source_relationships_IDX-Schema_orders_cust_id__customer_id__source_IDX_Schema_customers_.dc582657bc
[0m16:14:33.593511 [debug] [Thread-1  ]: Writing runtime sql for node "test.dbt_idx.source_relationships_IDX-Schema_orders_cust_id__customer_id__source_IDX_Schema_customers_.dc582657bc"
[0m16:14:33.627129 [debug] [Thread-1  ]: Using postgres connection "test.dbt_idx.source_relationships_IDX-Schema_orders_cust_id__customer_id__source_IDX_Schema_customers_.dc582657bc"
[0m16:14:33.628810 [debug] [Thread-1  ]: On test.dbt_idx.source_relationships_IDX-Schema_orders_cust_id__customer_id__source_IDX_Schema_customers_.dc582657bc: BEGIN
[0m16:14:33.630537 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m16:14:33.644823 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m16:14:33.646881 [debug] [Thread-1  ]: Using postgres connection "test.dbt_idx.source_relationships_IDX-Schema_orders_cust_id__customer_id__source_IDX_Schema_customers_.dc582657bc"
[0m16:14:33.649366 [debug] [Thread-1  ]: On test.dbt_idx.source_relationships_IDX-Schema_orders_cust_id__customer_id__source_IDX_Schema_customers_.dc582657bc: /* {"app": "dbt", "dbt_version": "1.5.6", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "test.dbt_idx.source_relationships_IDX-Schema_orders_cust_id__customer_id__source_IDX_Schema_customers_.dc582657bc"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select cust_id as from_field
    from "IDX-Stock"."IDX-Schema"."orders"
    where cust_id is not null
),

parent as (
    select customer_id as to_field
    from "IDX-Stock"."IDX-Schema"."customers"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m16:14:33.654505 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.0 seconds
[0m16:14:33.660412 [debug] [Thread-1  ]: Timing info for test.dbt_idx.source_relationships_IDX-Schema_orders_cust_id__customer_id__source_IDX_Schema_customers_.dc582657bc (execute): 16:14:33.585630 => 16:14:33.659790
[0m16:14:33.661748 [debug] [Thread-1  ]: On test.dbt_idx.source_relationships_IDX-Schema_orders_cust_id__customer_id__source_IDX_Schema_customers_.dc582657bc: ROLLBACK
[0m16:14:33.664333 [debug] [Thread-1  ]: On test.dbt_idx.source_relationships_IDX-Schema_orders_cust_id__customer_id__source_IDX_Schema_customers_.dc582657bc: Close
[0m16:14:33.668341 [info ] [Thread-1  ]: 15 of 19 PASS source_relationships_IDX-Schema_orders_cust_id__customer_id__source_IDX_Schema_customers_  [[32mPASS[0m in 0.17s]
[0m16:14:33.670422 [debug] [Thread-1  ]: Finished running node test.dbt_idx.source_relationships_IDX-Schema_orders_cust_id__customer_id__source_IDX_Schema_customers_.dc582657bc
[0m16:14:33.672755 [debug] [Thread-1  ]: Began running node test.dbt_idx.source_unique_IDX-Schema_ksql-company-stream_id.09232074f4
[0m16:14:33.675818 [info ] [Thread-1  ]: 16 of 19 START test source_unique_IDX-Schema_ksql-company-stream_id ............ [RUN]
[0m16:14:33.679714 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.dbt_idx.source_relationships_IDX-Schema_orders_cust_id__customer_id__source_IDX_Schema_customers_.dc582657bc, now test.dbt_idx.source_unique_IDX-Schema_ksql-company-stream_id.09232074f4)
[0m16:14:33.682485 [debug] [Thread-1  ]: Began compiling node test.dbt_idx.source_unique_IDX-Schema_ksql-company-stream_id.09232074f4
[0m16:14:33.702273 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_idx.source_unique_IDX-Schema_ksql-company-stream_id.09232074f4"
[0m16:14:33.731709 [debug] [Thread-1  ]: Timing info for test.dbt_idx.source_unique_IDX-Schema_ksql-company-stream_id.09232074f4 (compile): 16:14:33.684500 => 16:14:33.731268
[0m16:14:33.733162 [debug] [Thread-1  ]: Began executing node test.dbt_idx.source_unique_IDX-Schema_ksql-company-stream_id.09232074f4
[0m16:14:33.737585 [debug] [Thread-1  ]: Writing runtime sql for node "test.dbt_idx.source_unique_IDX-Schema_ksql-company-stream_id.09232074f4"
[0m16:14:33.770356 [debug] [Thread-1  ]: Using postgres connection "test.dbt_idx.source_unique_IDX-Schema_ksql-company-stream_id.09232074f4"
[0m16:14:33.772047 [debug] [Thread-1  ]: On test.dbt_idx.source_unique_IDX-Schema_ksql-company-stream_id.09232074f4: BEGIN
[0m16:14:33.774143 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m16:14:33.786308 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m16:14:33.789056 [debug] [Thread-1  ]: Using postgres connection "test.dbt_idx.source_unique_IDX-Schema_ksql-company-stream_id.09232074f4"
[0m16:14:33.791801 [debug] [Thread-1  ]: On test.dbt_idx.source_unique_IDX-Schema_ksql-company-stream_id.09232074f4: /* {"app": "dbt", "dbt_version": "1.5.6", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "test.dbt_idx.source_unique_IDX-Schema_ksql-company-stream_id.09232074f4"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from "IDX-Stock"."IDX-Schema"."ksql-company-stream"
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
[0m16:14:33.798443 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.0 seconds
[0m16:14:33.803861 [debug] [Thread-1  ]: Timing info for test.dbt_idx.source_unique_IDX-Schema_ksql-company-stream_id.09232074f4 (execute): 16:14:33.734114 => 16:14:33.803024
[0m16:14:33.807879 [debug] [Thread-1  ]: On test.dbt_idx.source_unique_IDX-Schema_ksql-company-stream_id.09232074f4: ROLLBACK
[0m16:14:33.810571 [debug] [Thread-1  ]: On test.dbt_idx.source_unique_IDX-Schema_ksql-company-stream_id.09232074f4: Close
[0m16:14:33.816043 [info ] [Thread-1  ]: 16 of 19 PASS source_unique_IDX-Schema_ksql-company-stream_id .................. [[32mPASS[0m in 0.14s]
[0m16:14:33.821383 [debug] [Thread-1  ]: Finished running node test.dbt_idx.source_unique_IDX-Schema_ksql-company-stream_id.09232074f4
[0m16:14:33.823950 [debug] [Thread-1  ]: Began running node test.dbt_idx.source_unique_IDX-Schema_ksql-stock-stream_id.2119c5c33b
[0m16:14:33.826173 [info ] [Thread-1  ]: 17 of 19 START test source_unique_IDX-Schema_ksql-stock-stream_id .............. [RUN]
[0m16:14:33.828926 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.dbt_idx.source_unique_IDX-Schema_ksql-company-stream_id.09232074f4, now test.dbt_idx.source_unique_IDX-Schema_ksql-stock-stream_id.2119c5c33b)
[0m16:14:33.830587 [debug] [Thread-1  ]: Began compiling node test.dbt_idx.source_unique_IDX-Schema_ksql-stock-stream_id.2119c5c33b
[0m16:14:33.844704 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_idx.source_unique_IDX-Schema_ksql-stock-stream_id.2119c5c33b"
[0m16:14:33.874954 [debug] [Thread-1  ]: Timing info for test.dbt_idx.source_unique_IDX-Schema_ksql-stock-stream_id.2119c5c33b (compile): 16:14:33.832766 => 16:14:33.874324
[0m16:14:33.876536 [debug] [Thread-1  ]: Began executing node test.dbt_idx.source_unique_IDX-Schema_ksql-stock-stream_id.2119c5c33b
[0m16:14:33.882311 [debug] [Thread-1  ]: Writing runtime sql for node "test.dbt_idx.source_unique_IDX-Schema_ksql-stock-stream_id.2119c5c33b"
[0m16:14:33.910485 [debug] [Thread-1  ]: Using postgres connection "test.dbt_idx.source_unique_IDX-Schema_ksql-stock-stream_id.2119c5c33b"
[0m16:14:33.912178 [debug] [Thread-1  ]: On test.dbt_idx.source_unique_IDX-Schema_ksql-stock-stream_id.2119c5c33b: BEGIN
[0m16:14:33.914001 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m16:14:33.927102 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m16:14:33.929160 [debug] [Thread-1  ]: Using postgres connection "test.dbt_idx.source_unique_IDX-Schema_ksql-stock-stream_id.2119c5c33b"
[0m16:14:33.931513 [debug] [Thread-1  ]: On test.dbt_idx.source_unique_IDX-Schema_ksql-stock-stream_id.2119c5c33b: /* {"app": "dbt", "dbt_version": "1.5.6", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "test.dbt_idx.source_unique_IDX-Schema_ksql-stock-stream_id.2119c5c33b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from "IDX-Stock"."IDX-Schema"."ksql-stock-stream"
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
[0m16:14:33.969760 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.0 seconds
[0m16:14:33.975978 [debug] [Thread-1  ]: Timing info for test.dbt_idx.source_unique_IDX-Schema_ksql-stock-stream_id.2119c5c33b (execute): 16:14:33.877675 => 16:14:33.974968
[0m16:14:33.978273 [debug] [Thread-1  ]: On test.dbt_idx.source_unique_IDX-Schema_ksql-stock-stream_id.2119c5c33b: ROLLBACK
[0m16:14:33.981186 [debug] [Thread-1  ]: On test.dbt_idx.source_unique_IDX-Schema_ksql-stock-stream_id.2119c5c33b: Close
[0m16:14:33.985173 [info ] [Thread-1  ]: 17 of 19 PASS source_unique_IDX-Schema_ksql-stock-stream_id .................... [[32mPASS[0m in 0.16s]
[0m16:14:33.988658 [debug] [Thread-1  ]: Finished running node test.dbt_idx.source_unique_IDX-Schema_ksql-stock-stream_id.2119c5c33b
[0m16:14:33.991519 [debug] [Thread-1  ]: Began running node test.dbt_idx.source_unique_IDX-Schema_orders_order_id.5a8ef486ee
[0m16:14:33.994844 [info ] [Thread-1  ]: 18 of 19 START test source_unique_IDX-Schema_orders_order_id ................... [RUN]
[0m16:14:33.998674 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.dbt_idx.source_unique_IDX-Schema_ksql-stock-stream_id.2119c5c33b, now test.dbt_idx.source_unique_IDX-Schema_orders_order_id.5a8ef486ee)
[0m16:14:34.001075 [debug] [Thread-1  ]: Began compiling node test.dbt_idx.source_unique_IDX-Schema_orders_order_id.5a8ef486ee
[0m16:14:34.018312 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_idx.source_unique_IDX-Schema_orders_order_id.5a8ef486ee"
[0m16:14:34.051417 [debug] [Thread-1  ]: Timing info for test.dbt_idx.source_unique_IDX-Schema_orders_order_id.5a8ef486ee (compile): 16:14:34.002673 => 16:14:34.050679
[0m16:14:34.053028 [debug] [Thread-1  ]: Began executing node test.dbt_idx.source_unique_IDX-Schema_orders_order_id.5a8ef486ee
[0m16:14:34.060378 [debug] [Thread-1  ]: Writing runtime sql for node "test.dbt_idx.source_unique_IDX-Schema_orders_order_id.5a8ef486ee"
[0m16:14:34.089746 [debug] [Thread-1  ]: Using postgres connection "test.dbt_idx.source_unique_IDX-Schema_orders_order_id.5a8ef486ee"
[0m16:14:34.091977 [debug] [Thread-1  ]: On test.dbt_idx.source_unique_IDX-Schema_orders_order_id.5a8ef486ee: BEGIN
[0m16:14:34.093377 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m16:14:34.104500 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m16:14:34.106946 [debug] [Thread-1  ]: Using postgres connection "test.dbt_idx.source_unique_IDX-Schema_orders_order_id.5a8ef486ee"
[0m16:14:34.108903 [debug] [Thread-1  ]: On test.dbt_idx.source_unique_IDX-Schema_orders_order_id.5a8ef486ee: /* {"app": "dbt", "dbt_version": "1.5.6", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "test.dbt_idx.source_unique_IDX-Schema_orders_order_id.5a8ef486ee"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    order_id as unique_field,
    count(*) as n_records

from "IDX-Stock"."IDX-Schema"."orders"
where order_id is not null
group by order_id
having count(*) > 1



      
    ) dbt_internal_test
[0m16:14:34.115678 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.0 seconds
[0m16:14:34.130273 [debug] [Thread-1  ]: Timing info for test.dbt_idx.source_unique_IDX-Schema_orders_order_id.5a8ef486ee (execute): 16:14:34.054735 => 16:14:34.129516
[0m16:14:34.132671 [debug] [Thread-1  ]: On test.dbt_idx.source_unique_IDX-Schema_orders_order_id.5a8ef486ee: ROLLBACK
[0m16:14:34.136378 [debug] [Thread-1  ]: On test.dbt_idx.source_unique_IDX-Schema_orders_order_id.5a8ef486ee: Close
[0m16:14:34.141494 [info ] [Thread-1  ]: 18 of 19 PASS source_unique_IDX-Schema_orders_order_id ......................... [[32mPASS[0m in 0.14s]
[0m16:14:34.144511 [debug] [Thread-1  ]: Finished running node test.dbt_idx.source_unique_IDX-Schema_orders_order_id.5a8ef486ee
[0m16:14:34.146303 [debug] [Thread-1  ]: Began running node test.dbt_idx.unique_customer_orders_status_order_id.b7a45e83ee
[0m16:14:34.148800 [info ] [Thread-1  ]: 19 of 19 START test unique_customer_orders_status_order_id ..................... [RUN]
[0m16:14:34.153143 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.dbt_idx.source_unique_IDX-Schema_orders_order_id.5a8ef486ee, now test.dbt_idx.unique_customer_orders_status_order_id.b7a45e83ee)
[0m16:14:34.154943 [debug] [Thread-1  ]: Began compiling node test.dbt_idx.unique_customer_orders_status_order_id.b7a45e83ee
[0m16:14:34.165830 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_idx.unique_customer_orders_status_order_id.b7a45e83ee"
[0m16:14:34.198518 [debug] [Thread-1  ]: Timing info for test.dbt_idx.unique_customer_orders_status_order_id.b7a45e83ee (compile): 16:14:34.156511 => 16:14:34.197685
[0m16:14:34.200178 [debug] [Thread-1  ]: Began executing node test.dbt_idx.unique_customer_orders_status_order_id.b7a45e83ee
[0m16:14:34.206057 [debug] [Thread-1  ]: Writing runtime sql for node "test.dbt_idx.unique_customer_orders_status_order_id.b7a45e83ee"
[0m16:14:34.237628 [debug] [Thread-1  ]: Using postgres connection "test.dbt_idx.unique_customer_orders_status_order_id.b7a45e83ee"
[0m16:14:34.239782 [debug] [Thread-1  ]: On test.dbt_idx.unique_customer_orders_status_order_id.b7a45e83ee: BEGIN
[0m16:14:34.241649 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m16:14:34.257820 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m16:14:34.259810 [debug] [Thread-1  ]: Using postgres connection "test.dbt_idx.unique_customer_orders_status_order_id.b7a45e83ee"
[0m16:14:34.261832 [debug] [Thread-1  ]: On test.dbt_idx.unique_customer_orders_status_order_id.b7a45e83ee: /* {"app": "dbt", "dbt_version": "1.5.6", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "test.dbt_idx.unique_customer_orders_status_order_id.b7a45e83ee"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    order_id as unique_field,
    count(*) as n_records

from "IDX-Stock"."IDX-Schema"."customer_orders_status"
where order_id is not null
group by order_id
having count(*) > 1



      
    ) dbt_internal_test
[0m16:14:34.269123 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.0 seconds
[0m16:14:34.275752 [debug] [Thread-1  ]: Timing info for test.dbt_idx.unique_customer_orders_status_order_id.b7a45e83ee (execute): 16:14:34.201350 => 16:14:34.274806
[0m16:14:34.278407 [debug] [Thread-1  ]: On test.dbt_idx.unique_customer_orders_status_order_id.b7a45e83ee: ROLLBACK
[0m16:14:34.281001 [debug] [Thread-1  ]: On test.dbt_idx.unique_customer_orders_status_order_id.b7a45e83ee: Close
[0m16:14:34.284934 [info ] [Thread-1  ]: 19 of 19 PASS unique_customer_orders_status_order_id ........................... [[32mPASS[0m in 0.13s]
[0m16:14:34.287406 [debug] [Thread-1  ]: Finished running node test.dbt_idx.unique_customer_orders_status_order_id.b7a45e83ee
[0m16:14:34.302521 [debug] [MainThread]: Using postgres connection "master"
[0m16:14:34.303768 [debug] [MainThread]: On master: BEGIN
[0m16:14:34.305342 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:14:34.316670 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m16:14:34.318525 [debug] [MainThread]: On master: COMMIT
[0m16:14:34.320296 [debug] [MainThread]: Using postgres connection "master"
[0m16:14:34.322496 [debug] [MainThread]: On master: COMMIT
[0m16:14:34.324884 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m16:14:34.327111 [debug] [MainThread]: On master: Close
[0m16:14:34.329534 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:14:34.331992 [debug] [MainThread]: Connection 'test.dbt_idx.unique_customer_orders_status_order_id.b7a45e83ee' was properly closed.
[0m16:14:34.334213 [info ] [MainThread]: 
[0m16:14:34.337710 [info ] [MainThread]: Finished running 19 tests in 0 hours 0 minutes and 2.92 seconds (2.92s).
[0m16:14:34.344944 [debug] [MainThread]: Command end result
[0m16:14:34.397131 [info ] [MainThread]: 
[0m16:14:34.399887 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:14:34.401952 [info ] [MainThread]: 
[0m16:14:34.403758 [info ] [MainThread]: Done. PASS=19 WARN=0 ERROR=0 SKIP=0 TOTAL=19
[0m16:14:34.406890 [debug] [MainThread]: Command `dbt test` succeeded at 16:14:34.406620 after 4.59 seconds
[0m16:14:34.408422 [debug] [MainThread]: Flushing usage events


============================== 16:19:31.416924 | fb5dd7b8-60c0-4850-a73c-d9da9c6d9581 ==============================
[0m16:19:31.416924 [info ] [MainThread]: Running with dbt=1.5.6
[0m16:19:31.427843 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dags/Py-DBT-IDX', 'debug': 'False', 'warn_error': 'None', 'log_path': '/opt/airflow/dags/Py-DBT-IDX/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'send_anonymous_usage_stats': 'False'}


============================== 16:19:31.467270 | 873fce05-2761-4bb0-85eb-e45a358f0ac9 ==============================
[0m16:19:31.467270 [info ] [MainThread]: Running with dbt=1.5.6
[0m16:19:31.477362 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dags/Py-DBT-IDX', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/opt/airflow/dags/Py-DBT-IDX/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'False'}
[0m16:19:31.667561 [info ] [MainThread]: Registered adapter: postgres=1.5.6
[0m16:19:31.716672 [debug] [MainThread]: checksum: 36b91491eb2b55e69ff526c98e337edadb953c9826242889489b2fea40332ad6, vars: {}, profile: , target: , version: 1.5.6
[0m16:19:31.720319 [info ] [MainThread]: Registered adapter: postgres=1.5.6
[0m16:19:31.776625 [debug] [MainThread]: checksum: 36b91491eb2b55e69ff526c98e337edadb953c9826242889489b2fea40332ad6, vars: {}, profile: , target: , version: 1.5.6
[0m16:19:32.653208 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:19:32.654960 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:19:32.683158 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:19:32.684470 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:19:32.727809 [info ] [MainThread]: Found 11 models, 19 tests, 1 snapshot, 0 analyses, 307 macros, 0 operations, 0 seed files, 5 sources, 0 exposures, 0 metrics, 0 groups
[0m16:19:32.733137 [info ] [MainThread]: 
[0m16:19:32.735530 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m16:19:32.739784 [debug] [ThreadPool]: Acquiring new postgres connection 'list_IDX-Stock'
[0m16:19:32.758377 [info ] [MainThread]: Found 11 models, 19 tests, 1 snapshot, 0 analyses, 307 macros, 0 operations, 0 seed files, 5 sources, 0 exposures, 0 metrics, 0 groups
[0m16:19:32.759290 [debug] [ThreadPool]: Using postgres connection "list_IDX-Stock"
[0m16:19:32.760558 [debug] [ThreadPool]: On list_IDX-Stock: /* {"app": "dbt", "dbt_version": "1.5.6", "profile_name": "dbt_idx", "target_name": "dev", "connection_name": "list_IDX-Stock"} */

    select distinct nspname from pg_namespace
  
[0m16:19:32.761591 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:19:32.761933 [info ] [MainThread]: 
[0m16:19:32.764210 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m16:19:32.766685 [debug] [MainThread]: Command end result
[0m16:19:32.775366 [debug] [ThreadPool]: SQL status: SELECT 12 in 0.0 seconds
[0m16:19:32.777799 [debug] [ThreadPool]: On list_IDX-Stock: Close
[0m16:19:32.783795 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_IDX-Stock, now list_IDX-Stock_IDX-Schema)
[0m16:19:32.794477 [debug] [ThreadPool]: Using postgres connection "list_IDX-Stock_IDX-Schema"
[0m16:19:32.795814 [debug] [ThreadPool]: On list_IDX-Stock_IDX-Schema: BEGIN
[0m16:19:32.798192 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:19:32.811066 [info ] [MainThread]: 
[0m16:19:32.812439 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m16:19:32.813238 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:19:32.815987 [debug] [ThreadPool]: Using postgres connection "list_IDX-Stock_IDX-Schema"
[0m16:19:32.816082 [info ] [MainThread]: 
[0m16:19:32.819233 [debug] [ThreadPool]: On list_IDX-Stock_IDX-Schema: /* {"app": "dbt", "dbt_version": "1.5.6", "profile_name": "dbt_idx", "target_name": "dev", "connection_name": "list_IDX-Stock_IDX-Schema"} */
select
      'IDX-Stock' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'IDX-Schema'
    union all
    select
      'IDX-Stock' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'IDX-Schema'
  
[0m16:19:32.819109 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=0 SKIP=0 TOTAL=0
[0m16:19:32.824906 [debug] [MainThread]: Command `dbt seed` succeeded at 16:19:32.823782 after 1.40 seconds
[0m16:19:32.827468 [debug] [MainThread]: Flushing usage events
[0m16:19:32.831477 [debug] [ThreadPool]: SQL status: SELECT 17 in 0.0 seconds
[0m16:19:32.838562 [debug] [ThreadPool]: On list_IDX-Stock_IDX-Schema: ROLLBACK
[0m16:19:32.841969 [debug] [ThreadPool]: On list_IDX-Stock_IDX-Schema: Close
[0m16:19:32.848265 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_IDX-Stock_IDX-Schema, now list_IDX-Stock_snapshots)
[0m16:19:32.860973 [debug] [ThreadPool]: Using postgres connection "list_IDX-Stock_snapshots"
[0m16:19:32.862641 [debug] [ThreadPool]: On list_IDX-Stock_snapshots: BEGIN
[0m16:19:32.865166 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:19:32.879219 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m16:19:32.881902 [debug] [ThreadPool]: Using postgres connection "list_IDX-Stock_snapshots"
[0m16:19:32.884284 [debug] [ThreadPool]: On list_IDX-Stock_snapshots: /* {"app": "dbt", "dbt_version": "1.5.6", "profile_name": "dbt_idx", "target_name": "dev", "connection_name": "list_IDX-Stock_snapshots"} */
select
      'IDX-Stock' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'snapshots'
    union all
    select
      'IDX-Stock' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'snapshots'
  
[0m16:19:32.892722 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.0 seconds
[0m16:19:32.897345 [debug] [ThreadPool]: On list_IDX-Stock_snapshots: ROLLBACK
[0m16:19:32.900595 [debug] [ThreadPool]: On list_IDX-Stock_snapshots: Close
[0m16:19:32.921276 [debug] [MainThread]: Using postgres connection "master"
[0m16:19:32.923767 [debug] [MainThread]: On master: BEGIN
[0m16:19:32.925850 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:19:32.940495 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m16:19:32.942850 [debug] [MainThread]: Using postgres connection "master"
[0m16:19:32.945054 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.5.6", "profile_name": "dbt_idx", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m16:19:32.964701 [debug] [MainThread]: SQL status: SELECT 9 in 0.0 seconds
[0m16:19:32.974308 [debug] [MainThread]: On master: ROLLBACK
[0m16:19:32.977664 [debug] [MainThread]: Using postgres connection "master"
[0m16:19:32.979953 [debug] [MainThread]: On master: BEGIN
[0m16:19:32.982792 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m16:19:32.986010 [debug] [MainThread]: On master: COMMIT
[0m16:19:32.988665 [debug] [MainThread]: Using postgres connection "master"
[0m16:19:32.991366 [debug] [MainThread]: On master: COMMIT
[0m16:19:32.994403 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m16:19:32.998442 [debug] [MainThread]: On master: Close
[0m16:19:33.002575 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:19:33.008237 [info ] [MainThread]: 
[0m16:19:33.027677 [debug] [Thread-1  ]: Began running node model.dbt_idx.stg_eltool__company
[0m16:19:33.029677 [info ] [Thread-1  ]: 1 of 11 START sql view model IDX-Schema.stg_eltool__company .................... [RUN]
[0m16:19:33.033210 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_IDX-Stock_snapshots, now model.dbt_idx.stg_eltool__company)
[0m16:19:33.035064 [debug] [Thread-1  ]: Began compiling node model.dbt_idx.stg_eltool__company
[0m16:19:33.051596 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_idx.stg_eltool__company"
[0m16:19:33.075964 [debug] [Thread-1  ]: Timing info for model.dbt_idx.stg_eltool__company (compile): 16:19:33.036078 => 16:19:33.075488
[0m16:19:33.077172 [debug] [Thread-1  ]: Began executing node model.dbt_idx.stg_eltool__company
[0m16:19:33.142878 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_idx.stg_eltool__company"
[0m16:19:33.167711 [debug] [Thread-1  ]: Using postgres connection "model.dbt_idx.stg_eltool__company"
[0m16:19:33.168915 [debug] [Thread-1  ]: On model.dbt_idx.stg_eltool__company: BEGIN
[0m16:19:33.169927 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m16:19:33.181176 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m16:19:33.183279 [debug] [Thread-1  ]: Using postgres connection "model.dbt_idx.stg_eltool__company"
[0m16:19:33.185182 [debug] [Thread-1  ]: On model.dbt_idx.stg_eltool__company: /* {"app": "dbt", "dbt_version": "1.5.6", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__company"} */

  create view "IDX-Stock"."IDX-Schema"."stg_eltool__company__dbt_tmp"
    
    
  as (
    with source as (select *
                from "IDX-Stock"."IDX-Schema"."ksql-company-stream"),
     renamed as (select id,
                        ticker,
                        name,
                        logo
                 from source)
select *
from renamed
  );
[0m16:19:33.193523 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m16:19:33.211649 [debug] [Thread-1  ]: Using postgres connection "model.dbt_idx.stg_eltool__company"
[0m16:19:33.214584 [debug] [Thread-1  ]: On model.dbt_idx.stg_eltool__company: /* {"app": "dbt", "dbt_version": "1.5.6", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__company"} */
alter table "IDX-Stock"."IDX-Schema"."stg_eltool__company" rename to "stg_eltool__company__dbt_backup"
[0m16:19:33.218372 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m16:19:33.225809 [debug] [Thread-1  ]: Using postgres connection "model.dbt_idx.stg_eltool__company"
[0m16:19:33.226946 [debug] [Thread-1  ]: On model.dbt_idx.stg_eltool__company: /* {"app": "dbt", "dbt_version": "1.5.6", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__company"} */
alter table "IDX-Stock"."IDX-Schema"."stg_eltool__company__dbt_tmp" rename to "stg_eltool__company"
[0m16:19:33.228487 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m16:19:33.261661 [debug] [Thread-1  ]: On model.dbt_idx.stg_eltool__company: COMMIT
[0m16:19:33.263583 [debug] [Thread-1  ]: Using postgres connection "model.dbt_idx.stg_eltool__company"
[0m16:19:33.265625 [debug] [Thread-1  ]: On model.dbt_idx.stg_eltool__company: COMMIT
[0m16:19:33.269457 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m16:19:33.278449 [debug] [Thread-1  ]: Using postgres connection "model.dbt_idx.stg_eltool__company"
[0m16:19:33.280611 [debug] [Thread-1  ]: On model.dbt_idx.stg_eltool__company: /* {"app": "dbt", "dbt_version": "1.5.6", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__company"} */
drop view if exists "IDX-Stock"."IDX-Schema"."stg_eltool__company__dbt_backup" cascade
[0m16:19:33.286086 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
[0m16:19:33.290187 [debug] [Thread-1  ]: Timing info for model.dbt_idx.stg_eltool__company (execute): 16:19:33.078131 => 16:19:33.289889
[0m16:19:33.291631 [debug] [Thread-1  ]: On model.dbt_idx.stg_eltool__company: Close
[0m16:19:33.294273 [info ] [Thread-1  ]: 1 of 11 OK created sql view model IDX-Schema.stg_eltool__company ............... [[32mCREATE VIEW[0m in 0.26s]
[0m16:19:33.297030 [debug] [Thread-1  ]: Finished running node model.dbt_idx.stg_eltool__company
[0m16:19:33.299562 [debug] [Thread-1  ]: Began running node model.dbt_idx.stg_eltool__customers
[0m16:19:33.301099 [info ] [Thread-1  ]: 2 of 11 START sql view model IDX-Schema.stg_eltool__customers .................. [RUN]
[0m16:19:33.303272 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_idx.stg_eltool__company, now model.dbt_idx.stg_eltool__customers)
[0m16:19:33.305025 [debug] [Thread-1  ]: Began compiling node model.dbt_idx.stg_eltool__customers
[0m16:19:33.311885 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_idx.stg_eltool__customers"
[0m16:19:33.344647 [debug] [Thread-1  ]: Timing info for model.dbt_idx.stg_eltool__customers (compile): 16:19:33.306549 => 16:19:33.344260
[0m16:19:33.346101 [debug] [Thread-1  ]: Began executing node model.dbt_idx.stg_eltool__customers
[0m16:19:33.354441 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_idx.stg_eltool__customers"
[0m16:19:33.386246 [debug] [Thread-1  ]: Using postgres connection "model.dbt_idx.stg_eltool__customers"
[0m16:19:33.387682 [debug] [Thread-1  ]: On model.dbt_idx.stg_eltool__customers: BEGIN
[0m16:19:33.389439 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m16:19:33.398787 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m16:19:33.400326 [debug] [Thread-1  ]: Using postgres connection "model.dbt_idx.stg_eltool__customers"
[0m16:19:33.401682 [debug] [Thread-1  ]: On model.dbt_idx.stg_eltool__customers: /* {"app": "dbt", "dbt_version": "1.5.6", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__customers"} */

  create view "IDX-Stock"."IDX-Schema"."stg_eltool__customers__dbt_tmp"
    
    
  as (
    with source as (select *
                from "IDX-Stock"."IDX-Schema"."customers"),
     renamed as (select
                     customer_id,
                    'This is Dummy' as dummy
                 from source
                 where customer_id = 1234567890)
select *
from renamed
  );
[0m16:19:33.409190 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m16:19:33.419838 [debug] [Thread-1  ]: Using postgres connection "model.dbt_idx.stg_eltool__customers"
[0m16:19:33.422828 [debug] [Thread-1  ]: On model.dbt_idx.stg_eltool__customers: /* {"app": "dbt", "dbt_version": "1.5.6", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__customers"} */
alter table "IDX-Stock"."IDX-Schema"."stg_eltool__customers" rename to "stg_eltool__customers__dbt_backup"
[0m16:19:33.426332 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m16:19:33.434632 [debug] [Thread-1  ]: Using postgres connection "model.dbt_idx.stg_eltool__customers"
[0m16:19:33.435969 [debug] [Thread-1  ]: On model.dbt_idx.stg_eltool__customers: /* {"app": "dbt", "dbt_version": "1.5.6", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__customers"} */
alter table "IDX-Stock"."IDX-Schema"."stg_eltool__customers__dbt_tmp" rename to "stg_eltool__customers"
[0m16:19:33.438399 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m16:19:33.442589 [debug] [Thread-1  ]: On model.dbt_idx.stg_eltool__customers: COMMIT
[0m16:19:33.443655 [debug] [Thread-1  ]: Using postgres connection "model.dbt_idx.stg_eltool__customers"
[0m16:19:33.444692 [debug] [Thread-1  ]: On model.dbt_idx.stg_eltool__customers: COMMIT
[0m16:19:33.448793 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m16:19:33.455272 [debug] [Thread-1  ]: Using postgres connection "model.dbt_idx.stg_eltool__customers"
[0m16:19:33.457056 [debug] [Thread-1  ]: On model.dbt_idx.stg_eltool__customers: /* {"app": "dbt", "dbt_version": "1.5.6", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__customers"} */
drop view if exists "IDX-Stock"."IDX-Schema"."stg_eltool__customers__dbt_backup" cascade
[0m16:19:33.460389 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
[0m16:19:33.464189 [debug] [Thread-1  ]: Timing info for model.dbt_idx.stg_eltool__customers (execute): 16:19:33.347332 => 16:19:33.463667
[0m16:19:33.465633 [debug] [Thread-1  ]: On model.dbt_idx.stg_eltool__customers: Close
[0m16:19:33.467669 [info ] [Thread-1  ]: 2 of 11 OK created sql view model IDX-Schema.stg_eltool__customers ............. [[32mCREATE VIEW[0m in 0.16s]
[0m16:19:33.469322 [debug] [Thread-1  ]: Finished running node model.dbt_idx.stg_eltool__customers
[0m16:19:33.470888 [debug] [Thread-1  ]: Began running node model.dbt_idx.stg_eltool__customers_snapshots
[0m16:19:33.472725 [info ] [Thread-1  ]: 3 of 11 START sql view model IDX-Schema.stg_eltool__customers_snapshots ........ [RUN]
[0m16:19:33.474540 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_idx.stg_eltool__customers, now model.dbt_idx.stg_eltool__customers_snapshots)
[0m16:19:33.475576 [debug] [Thread-1  ]: Began compiling node model.dbt_idx.stg_eltool__customers_snapshots
[0m16:19:33.480067 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_idx.stg_eltool__customers_snapshots"
[0m16:19:33.502823 [debug] [Thread-1  ]: Timing info for model.dbt_idx.stg_eltool__customers_snapshots (compile): 16:19:33.476395 => 16:19:33.502426
[0m16:19:33.504202 [debug] [Thread-1  ]: Began executing node model.dbt_idx.stg_eltool__customers_snapshots
[0m16:19:33.511917 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_idx.stg_eltool__customers_snapshots"
[0m16:19:33.535124 [debug] [Thread-1  ]: Using postgres connection "model.dbt_idx.stg_eltool__customers_snapshots"
[0m16:19:33.536245 [debug] [Thread-1  ]: On model.dbt_idx.stg_eltool__customers_snapshots: BEGIN
[0m16:19:33.537563 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m16:19:33.546602 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m16:19:33.548876 [debug] [Thread-1  ]: Using postgres connection "model.dbt_idx.stg_eltool__customers_snapshots"
[0m16:19:33.550550 [debug] [Thread-1  ]: On model.dbt_idx.stg_eltool__customers_snapshots: /* {"app": "dbt", "dbt_version": "1.5.6", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__customers_snapshots"} */

  create view "IDX-Stock"."IDX-Schema"."stg_eltool__customers_snapshots__dbt_tmp"
    
    
  as (
    with source as (select *
                from "IDX-Stock"."snapshots"."customers_snapshot"),
     renamed as (select customer_id,
                        zipcode,
                        city,
                        state_code,
                        datetime_created::TIMESTAMP AS datetime_created,
                        datetime_updated::TIMESTAMP AS datetime_updated,
                        dbt_valid_from,
                        dbt_valid_to
                 from source)
select *
from renamed
  );
[0m16:19:33.557719 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m16:19:33.568818 [debug] [Thread-1  ]: Using postgres connection "model.dbt_idx.stg_eltool__customers_snapshots"
[0m16:19:33.570766 [debug] [Thread-1  ]: On model.dbt_idx.stg_eltool__customers_snapshots: /* {"app": "dbt", "dbt_version": "1.5.6", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__customers_snapshots"} */
alter table "IDX-Stock"."IDX-Schema"."stg_eltool__customers_snapshots" rename to "stg_eltool__customers_snapshots__dbt_backup"
[0m16:19:33.573716 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m16:19:33.582971 [debug] [Thread-1  ]: Using postgres connection "model.dbt_idx.stg_eltool__customers_snapshots"
[0m16:19:33.584563 [debug] [Thread-1  ]: On model.dbt_idx.stg_eltool__customers_snapshots: /* {"app": "dbt", "dbt_version": "1.5.6", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__customers_snapshots"} */
alter table "IDX-Stock"."IDX-Schema"."stg_eltool__customers_snapshots__dbt_tmp" rename to "stg_eltool__customers_snapshots"
[0m16:19:33.586050 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m16:19:33.590747 [debug] [Thread-1  ]: On model.dbt_idx.stg_eltool__customers_snapshots: COMMIT
[0m16:19:33.591920 [debug] [Thread-1  ]: Using postgres connection "model.dbt_idx.stg_eltool__customers_snapshots"
[0m16:19:33.593046 [debug] [Thread-1  ]: On model.dbt_idx.stg_eltool__customers_snapshots: COMMIT
[0m16:19:33.596044 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m16:19:33.603653 [debug] [Thread-1  ]: Using postgres connection "model.dbt_idx.stg_eltool__customers_snapshots"
[0m16:19:33.605258 [debug] [Thread-1  ]: On model.dbt_idx.stg_eltool__customers_snapshots: /* {"app": "dbt", "dbt_version": "1.5.6", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__customers_snapshots"} */
drop view if exists "IDX-Stock"."IDX-Schema"."stg_eltool__customers_snapshots__dbt_backup" cascade
[0m16:19:33.609161 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
[0m16:19:33.611825 [debug] [Thread-1  ]: Timing info for model.dbt_idx.stg_eltool__customers_snapshots (execute): 16:19:33.505277 => 16:19:33.611518
[0m16:19:33.613510 [debug] [Thread-1  ]: On model.dbt_idx.stg_eltool__customers_snapshots: Close
[0m16:19:33.616151 [info ] [Thread-1  ]: 3 of 11 OK created sql view model IDX-Schema.stg_eltool__customers_snapshots ... [[32mCREATE VIEW[0m in 0.14s]
[0m16:19:33.617904 [debug] [Thread-1  ]: Finished running node model.dbt_idx.stg_eltool__customers_snapshots
[0m16:19:33.618992 [debug] [Thread-1  ]: Began running node model.dbt_idx.stg_eltool__orders
[0m16:19:33.620211 [info ] [Thread-1  ]: 4 of 11 START sql view model IDX-Schema.stg_eltool__orders ..................... [RUN]
[0m16:19:33.623230 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_idx.stg_eltool__customers_snapshots, now model.dbt_idx.stg_eltool__orders)
[0m16:19:33.624526 [debug] [Thread-1  ]: Began compiling node model.dbt_idx.stg_eltool__orders
[0m16:19:33.672454 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_idx.stg_eltool__orders"
[0m16:19:33.700099 [debug] [Thread-1  ]: Timing info for model.dbt_idx.stg_eltool__orders (compile): 16:19:33.625372 => 16:19:33.699709
[0m16:19:33.701434 [debug] [Thread-1  ]: Began executing node model.dbt_idx.stg_eltool__orders
[0m16:19:33.709154 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_idx.stg_eltool__orders"
[0m16:19:33.738600 [debug] [Thread-1  ]: Using postgres connection "model.dbt_idx.stg_eltool__orders"
[0m16:19:33.740166 [debug] [Thread-1  ]: On model.dbt_idx.stg_eltool__orders: BEGIN
[0m16:19:33.741295 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m16:19:33.750391 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m16:19:33.752187 [debug] [Thread-1  ]: Using postgres connection "model.dbt_idx.stg_eltool__orders"
[0m16:19:33.753740 [debug] [Thread-1  ]: On model.dbt_idx.stg_eltool__orders: /* {"app": "dbt", "dbt_version": "1.5.6", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__orders"} */

  create view "IDX-Stock"."IDX-Schema"."stg_eltool__orders__dbt_tmp"
    
    
  as (
    with source as (select *
                from "IDX-Stock"."IDX-Schema"."orders"),
     renamed as (select order_id,
                        cust_id AS customer_id,
                        order_status,
                        order_purchase_timestamp::TIMESTAMP,
                        order_approved_at::TIMESTAMP,
                        order_delivered_carrier_date::TIMESTAMP,
                        order_delivered_customer_date::TIMESTAMP,
                        order_estimated_delivery_date::TIMESTAMP
                 from source)
select *
from renamed
  );
[0m16:19:33.758030 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m16:19:33.764209 [debug] [Thread-1  ]: Using postgres connection "model.dbt_idx.stg_eltool__orders"
[0m16:19:33.767410 [debug] [Thread-1  ]: On model.dbt_idx.stg_eltool__orders: /* {"app": "dbt", "dbt_version": "1.5.6", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__orders"} */
alter table "IDX-Stock"."IDX-Schema"."stg_eltool__orders" rename to "stg_eltool__orders__dbt_backup"
[0m16:19:33.770743 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m16:19:33.780249 [debug] [Thread-1  ]: Using postgres connection "model.dbt_idx.stg_eltool__orders"
[0m16:19:33.783741 [debug] [Thread-1  ]: On model.dbt_idx.stg_eltool__orders: /* {"app": "dbt", "dbt_version": "1.5.6", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__orders"} */
alter table "IDX-Stock"."IDX-Schema"."stg_eltool__orders__dbt_tmp" rename to "stg_eltool__orders"
[0m16:19:33.786248 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m16:19:33.793182 [debug] [Thread-1  ]: On model.dbt_idx.stg_eltool__orders: COMMIT
[0m16:19:33.794437 [debug] [Thread-1  ]: Using postgres connection "model.dbt_idx.stg_eltool__orders"
[0m16:19:33.796524 [debug] [Thread-1  ]: On model.dbt_idx.stg_eltool__orders: COMMIT
[0m16:19:33.801967 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m16:19:33.808863 [debug] [Thread-1  ]: Using postgres connection "model.dbt_idx.stg_eltool__orders"
[0m16:19:33.810058 [debug] [Thread-1  ]: On model.dbt_idx.stg_eltool__orders: /* {"app": "dbt", "dbt_version": "1.5.6", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__orders"} */
drop view if exists "IDX-Stock"."IDX-Schema"."stg_eltool__orders__dbt_backup" cascade
[0m16:19:33.814757 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
[0m16:19:33.818791 [debug] [Thread-1  ]: Timing info for model.dbt_idx.stg_eltool__orders (execute): 16:19:33.702258 => 16:19:33.818498
[0m16:19:33.819990 [debug] [Thread-1  ]: On model.dbt_idx.stg_eltool__orders: Close
[0m16:19:33.823882 [info ] [Thread-1  ]: 4 of 11 OK created sql view model IDX-Schema.stg_eltool__orders ................ [[32mCREATE VIEW[0m in 0.20s]
[0m16:19:33.827016 [debug] [Thread-1  ]: Finished running node model.dbt_idx.stg_eltool__orders
[0m16:19:33.828565 [debug] [Thread-1  ]: Began running node model.dbt_idx.stg_eltool__state
[0m16:19:33.830742 [info ] [Thread-1  ]: 5 of 11 START sql view model IDX-Schema.stg_eltool__state ...................... [RUN]
[0m16:19:33.834129 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_idx.stg_eltool__orders, now model.dbt_idx.stg_eltool__state)
[0m16:19:33.835304 [debug] [Thread-1  ]: Began compiling node model.dbt_idx.stg_eltool__state
[0m16:19:33.840594 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_idx.stg_eltool__state"
[0m16:19:33.866064 [debug] [Thread-1  ]: Timing info for model.dbt_idx.stg_eltool__state (compile): 16:19:33.836472 => 16:19:33.865642
[0m16:19:33.867224 [debug] [Thread-1  ]: Began executing node model.dbt_idx.stg_eltool__state
[0m16:19:33.876354 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_idx.stg_eltool__state"
[0m16:19:33.902827 [debug] [Thread-1  ]: Using postgres connection "model.dbt_idx.stg_eltool__state"
[0m16:19:33.904374 [debug] [Thread-1  ]: On model.dbt_idx.stg_eltool__state: BEGIN
[0m16:19:33.906767 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m16:19:33.916360 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m16:19:33.918368 [debug] [Thread-1  ]: Using postgres connection "model.dbt_idx.stg_eltool__state"
[0m16:19:33.920050 [debug] [Thread-1  ]: On model.dbt_idx.stg_eltool__state: /* {"app": "dbt", "dbt_version": "1.5.6", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__state"} */

  create view "IDX-Stock"."IDX-Schema"."stg_eltool__state__dbt_tmp"
    
    
  as (
    with source as (select *
                from "IDX-Stock"."IDX-Schema"."state"),
     renamed as (select state_identifier::INT AS state_id,
                         state_code::VARCHAR(2) AS state_code,
                         st_name::VARCHAR(30) AS state_name
                 from source)
select *
from renamed
  );
[0m16:19:33.925596 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m16:19:33.937091 [debug] [Thread-1  ]: Using postgres connection "model.dbt_idx.stg_eltool__state"
[0m16:19:33.941599 [debug] [Thread-1  ]: On model.dbt_idx.stg_eltool__state: /* {"app": "dbt", "dbt_version": "1.5.6", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__state"} */
alter table "IDX-Stock"."IDX-Schema"."stg_eltool__state" rename to "stg_eltool__state__dbt_backup"
[0m16:19:33.945195 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m16:19:33.956673 [debug] [Thread-1  ]: Using postgres connection "model.dbt_idx.stg_eltool__state"
[0m16:19:33.958274 [debug] [Thread-1  ]: On model.dbt_idx.stg_eltool__state: /* {"app": "dbt", "dbt_version": "1.5.6", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__state"} */
alter table "IDX-Stock"."IDX-Schema"."stg_eltool__state__dbt_tmp" rename to "stg_eltool__state"
[0m16:19:33.960332 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m16:19:33.966953 [debug] [Thread-1  ]: On model.dbt_idx.stg_eltool__state: COMMIT
[0m16:19:33.968774 [debug] [Thread-1  ]: Using postgres connection "model.dbt_idx.stg_eltool__state"
[0m16:19:33.970924 [debug] [Thread-1  ]: On model.dbt_idx.stg_eltool__state: COMMIT
[0m16:19:33.975923 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m16:19:33.985353 [debug] [Thread-1  ]: Using postgres connection "model.dbt_idx.stg_eltool__state"
[0m16:19:33.987108 [debug] [Thread-1  ]: On model.dbt_idx.stg_eltool__state: /* {"app": "dbt", "dbt_version": "1.5.6", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__state"} */
drop view if exists "IDX-Stock"."IDX-Schema"."stg_eltool__state__dbt_backup" cascade
[0m16:19:33.991531 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
[0m16:19:33.994919 [debug] [Thread-1  ]: Timing info for model.dbt_idx.stg_eltool__state (execute): 16:19:33.868209 => 16:19:33.994591
[0m16:19:33.997171 [debug] [Thread-1  ]: On model.dbt_idx.stg_eltool__state: Close
[0m16:19:34.001316 [info ] [Thread-1  ]: 5 of 11 OK created sql view model IDX-Schema.stg_eltool__state ................. [[32mCREATE VIEW[0m in 0.17s]
[0m16:19:34.003973 [debug] [Thread-1  ]: Finished running node model.dbt_idx.stg_eltool__state
[0m16:19:34.006282 [debug] [Thread-1  ]: Began running node model.dbt_idx.stg_eltool__stock
[0m16:19:34.008512 [info ] [Thread-1  ]: 6 of 11 START sql view model IDX-Schema.stg_eltool__stock ...................... [RUN]
[0m16:19:34.011230 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_idx.stg_eltool__state, now model.dbt_idx.stg_eltool__stock)
[0m16:19:34.013300 [debug] [Thread-1  ]: Began compiling node model.dbt_idx.stg_eltool__stock
[0m16:19:34.022160 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_idx.stg_eltool__stock"
[0m16:19:34.052668 [debug] [Thread-1  ]: Timing info for model.dbt_idx.stg_eltool__stock (compile): 16:19:34.015615 => 16:19:34.052220
[0m16:19:34.054439 [debug] [Thread-1  ]: Began executing node model.dbt_idx.stg_eltool__stock
[0m16:19:34.068259 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_idx.stg_eltool__stock"
[0m16:19:34.102636 [debug] [Thread-1  ]: Using postgres connection "model.dbt_idx.stg_eltool__stock"
[0m16:19:34.104806 [debug] [Thread-1  ]: On model.dbt_idx.stg_eltool__stock: BEGIN
[0m16:19:34.107449 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m16:19:34.124276 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m16:19:34.126533 [debug] [Thread-1  ]: Using postgres connection "model.dbt_idx.stg_eltool__stock"
[0m16:19:34.129146 [debug] [Thread-1  ]: On model.dbt_idx.stg_eltool__stock: /* {"app": "dbt", "dbt_version": "1.5.6", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__stock"} */

  create view "IDX-Stock"."IDX-Schema"."stg_eltool__stock__dbt_tmp"
    
    
  as (
    with source as (select *
                from "IDX-Stock"."IDX-Schema"."ksql-stock-stream"),
     renamed as (select *
                 from source)
select *
from renamed
  );
[0m16:19:34.139026 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m16:19:34.164949 [debug] [Thread-1  ]: Using postgres connection "model.dbt_idx.stg_eltool__stock"
[0m16:19:34.168855 [debug] [Thread-1  ]: On model.dbt_idx.stg_eltool__stock: /* {"app": "dbt", "dbt_version": "1.5.6", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__stock"} */
alter table "IDX-Stock"."IDX-Schema"."stg_eltool__stock" rename to "stg_eltool__stock__dbt_backup"
[0m16:19:34.172967 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m16:19:34.184667 [debug] [Thread-1  ]: Using postgres connection "model.dbt_idx.stg_eltool__stock"
[0m16:19:34.186280 [debug] [Thread-1  ]: On model.dbt_idx.stg_eltool__stock: /* {"app": "dbt", "dbt_version": "1.5.6", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__stock"} */
alter table "IDX-Stock"."IDX-Schema"."stg_eltool__stock__dbt_tmp" rename to "stg_eltool__stock"
[0m16:19:34.189164 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m16:19:34.194464 [debug] [Thread-1  ]: On model.dbt_idx.stg_eltool__stock: COMMIT
[0m16:19:34.196068 [debug] [Thread-1  ]: Using postgres connection "model.dbt_idx.stg_eltool__stock"
[0m16:19:34.197824 [debug] [Thread-1  ]: On model.dbt_idx.stg_eltool__stock: COMMIT
[0m16:19:34.202660 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m16:19:34.209133 [debug] [Thread-1  ]: Using postgres connection "model.dbt_idx.stg_eltool__stock"
[0m16:19:34.210507 [debug] [Thread-1  ]: On model.dbt_idx.stg_eltool__stock: /* {"app": "dbt", "dbt_version": "1.5.6", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__stock"} */
drop view if exists "IDX-Stock"."IDX-Schema"."stg_eltool__stock__dbt_backup" cascade
[0m16:19:34.215290 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
[0m16:19:34.219831 [debug] [Thread-1  ]: Timing info for model.dbt_idx.stg_eltool__stock (execute): 16:19:34.056406 => 16:19:34.219428
[0m16:19:34.221688 [debug] [Thread-1  ]: On model.dbt_idx.stg_eltool__stock: Close
[0m16:19:34.224611 [info ] [Thread-1  ]: 6 of 11 OK created sql view model IDX-Schema.stg_eltool__stock ................. [[32mCREATE VIEW[0m in 0.21s]
[0m16:19:34.226763 [debug] [Thread-1  ]: Finished running node model.dbt_idx.stg_eltool__stock
[0m16:19:34.228162 [debug] [Thread-1  ]: Began running node model.dbt_idx.fact_orders
[0m16:19:34.230635 [info ] [Thread-1  ]: 7 of 11 START sql table model IDX-Schema.fact_orders ........................... [RUN]
[0m16:19:34.234201 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_idx.stg_eltool__stock, now model.dbt_idx.fact_orders)
[0m16:19:34.235964 [debug] [Thread-1  ]: Began compiling node model.dbt_idx.fact_orders
[0m16:19:34.242360 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_idx.fact_orders"
[0m16:19:34.271990 [debug] [Thread-1  ]: Timing info for model.dbt_idx.fact_orders (compile): 16:19:34.237472 => 16:19:34.271155
[0m16:19:34.274187 [debug] [Thread-1  ]: Began executing node model.dbt_idx.fact_orders
[0m16:19:34.331249 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_idx.fact_orders"
[0m16:19:34.368672 [debug] [Thread-1  ]: Using postgres connection "model.dbt_idx.fact_orders"
[0m16:19:34.370731 [debug] [Thread-1  ]: On model.dbt_idx.fact_orders: BEGIN
[0m16:19:34.373158 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m16:19:34.385217 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m16:19:34.386739 [debug] [Thread-1  ]: Using postgres connection "model.dbt_idx.fact_orders"
[0m16:19:34.389003 [debug] [Thread-1  ]: On model.dbt_idx.fact_orders: /* {"app": "dbt", "dbt_version": "1.5.6", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.fact_orders"} */

  
    

  create  table "IDX-Stock"."IDX-Schema"."fact_orders__dbt_tmp"
  
  
    as
  
  (
    with orders as (
    select *
    from "IDX-Stock"."IDX-Schema"."stg_eltool__orders"
)
select * from orders
  );
  
[0m16:19:34.402081 [debug] [Thread-1  ]: SQL status: SELECT 999 in 0.0 seconds
[0m16:19:34.416716 [debug] [Thread-1  ]: Using postgres connection "model.dbt_idx.fact_orders"
[0m16:19:34.420101 [debug] [Thread-1  ]: On model.dbt_idx.fact_orders: /* {"app": "dbt", "dbt_version": "1.5.6", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.fact_orders"} */
alter table "IDX-Stock"."IDX-Schema"."fact_orders" rename to "fact_orders__dbt_backup"
[0m16:19:34.424333 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m16:19:34.435369 [debug] [Thread-1  ]: Using postgres connection "model.dbt_idx.fact_orders"
[0m16:19:34.437058 [debug] [Thread-1  ]: On model.dbt_idx.fact_orders: /* {"app": "dbt", "dbt_version": "1.5.6", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.fact_orders"} */
alter table "IDX-Stock"."IDX-Schema"."fact_orders__dbt_tmp" rename to "fact_orders"
[0m16:19:34.440091 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m16:19:34.451766 [debug] [Thread-1  ]: On model.dbt_idx.fact_orders: COMMIT
[0m16:19:34.453110 [debug] [Thread-1  ]: Using postgres connection "model.dbt_idx.fact_orders"
[0m16:19:34.454510 [debug] [Thread-1  ]: On model.dbt_idx.fact_orders: COMMIT
[0m16:19:34.460343 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m16:19:34.466471 [debug] [Thread-1  ]: Using postgres connection "model.dbt_idx.fact_orders"
[0m16:19:34.467765 [debug] [Thread-1  ]: On model.dbt_idx.fact_orders: /* {"app": "dbt", "dbt_version": "1.5.6", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.fact_orders"} */
drop table if exists "IDX-Stock"."IDX-Schema"."fact_orders__dbt_backup" cascade
[0m16:19:34.473813 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
[0m16:19:34.476901 [debug] [Thread-1  ]: Timing info for model.dbt_idx.fact_orders (execute): 16:19:34.275340 => 16:19:34.476608
[0m16:19:34.478185 [debug] [Thread-1  ]: On model.dbt_idx.fact_orders: Close
[0m16:19:34.481837 [info ] [Thread-1  ]: 7 of 11 OK created sql table model IDX-Schema.fact_orders ...................... [[32mSELECT 999[0m in 0.25s]
[0m16:19:34.484508 [debug] [Thread-1  ]: Finished running node model.dbt_idx.fact_orders
[0m16:19:34.486081 [debug] [Thread-1  ]: Began running node model.dbt_idx.dim_customers
[0m16:19:34.487943 [info ] [Thread-1  ]: 8 of 11 START sql table model IDX-Schema.dim_customers ......................... [RUN]
[0m16:19:34.490510 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_idx.fact_orders, now model.dbt_idx.dim_customers)
[0m16:19:34.491738 [debug] [Thread-1  ]: Began compiling node model.dbt_idx.dim_customers
[0m16:19:34.498581 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_idx.dim_customers"
[0m16:19:34.524310 [debug] [Thread-1  ]: Timing info for model.dbt_idx.dim_customers (compile): 16:19:34.492715 => 16:19:34.523806
[0m16:19:34.525629 [debug] [Thread-1  ]: Began executing node model.dbt_idx.dim_customers
[0m16:19:34.538637 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_idx.dim_customers"
[0m16:19:34.566732 [debug] [Thread-1  ]: Using postgres connection "model.dbt_idx.dim_customers"
[0m16:19:34.568079 [debug] [Thread-1  ]: On model.dbt_idx.dim_customers: BEGIN
[0m16:19:34.569116 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m16:19:34.579368 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m16:19:34.581673 [debug] [Thread-1  ]: Using postgres connection "model.dbt_idx.dim_customers"
[0m16:19:34.583627 [debug] [Thread-1  ]: On model.dbt_idx.dim_customers: /* {"app": "dbt", "dbt_version": "1.5.6", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.dim_customers"} */

  
    

  create  table "IDX-Stock"."IDX-Schema"."dim_customers__dbt_tmp"
  
  
    as
  
  (
    -- noinspection SqlDialectInspectionForFile

with customers as (
    select *
    from "IDX-Stock"."IDX-Schema"."stg_eltool__customers_snapshots"
    ),
     state as (
         select *
         from "IDX-Stock"."IDX-Schema"."stg_eltool__state"
     )
select c.customer_id,
       c.zipcode,
       c.city,
       c.state_code,
       s.state_name,
       c.datetime_created,
       c.datetime_updated,
       c.dbt_valid_from::TIMESTAMP as valid_from,
        CASE WHEN c.dbt_valid_to IS NULL
            THEN '9999-12-31'::TIMESTAMP
            ELSE c.dbt_valid_to::TIMESTAMP
        END as valid_to
from customers c
    join state s on c.state_code = s.state_code
  );
  
[0m16:19:34.593794 [debug] [Thread-1  ]: SQL status: SELECT 100 in 0.0 seconds
[0m16:19:34.606560 [debug] [Thread-1  ]: Using postgres connection "model.dbt_idx.dim_customers"
[0m16:19:34.608086 [debug] [Thread-1  ]: On model.dbt_idx.dim_customers: /* {"app": "dbt", "dbt_version": "1.5.6", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.dim_customers"} */
alter table "IDX-Stock"."IDX-Schema"."dim_customers" rename to "dim_customers__dbt_backup"
[0m16:19:34.610891 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m16:19:34.619269 [debug] [Thread-1  ]: Using postgres connection "model.dbt_idx.dim_customers"
[0m16:19:34.621610 [debug] [Thread-1  ]: On model.dbt_idx.dim_customers: /* {"app": "dbt", "dbt_version": "1.5.6", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.dim_customers"} */
alter table "IDX-Stock"."IDX-Schema"."dim_customers__dbt_tmp" rename to "dim_customers"
[0m16:19:34.624442 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m16:19:34.629873 [debug] [Thread-1  ]: On model.dbt_idx.dim_customers: COMMIT
[0m16:19:34.631959 [debug] [Thread-1  ]: Using postgres connection "model.dbt_idx.dim_customers"
[0m16:19:34.633443 [debug] [Thread-1  ]: On model.dbt_idx.dim_customers: COMMIT
[0m16:19:34.636375 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m16:19:34.642673 [debug] [Thread-1  ]: Using postgres connection "model.dbt_idx.dim_customers"
[0m16:19:34.644094 [debug] [Thread-1  ]: On model.dbt_idx.dim_customers: /* {"app": "dbt", "dbt_version": "1.5.6", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.dim_customers"} */
drop table if exists "IDX-Stock"."IDX-Schema"."dim_customers__dbt_backup" cascade
[0m16:19:34.647998 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
[0m16:19:34.651387 [debug] [Thread-1  ]: Timing info for model.dbt_idx.dim_customers (execute): 16:19:34.526668 => 16:19:34.651055
[0m16:19:34.652838 [debug] [Thread-1  ]: On model.dbt_idx.dim_customers: Close
[0m16:19:34.655766 [info ] [Thread-1  ]: 8 of 11 OK created sql table model IDX-Schema.dim_customers .................... [[32mSELECT 100[0m in 0.17s]
[0m16:19:34.658002 [debug] [Thread-1  ]: Finished running node model.dbt_idx.dim_customers
[0m16:19:34.659487 [debug] [Thread-1  ]: Began running node model.dbt_idx.fact_stocks
[0m16:19:34.661146 [info ] [Thread-1  ]: 9 of 11 START sql table model IDX-Schema.fact_stocks ........................... [RUN]
[0m16:19:34.664049 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_idx.dim_customers, now model.dbt_idx.fact_stocks)
[0m16:19:34.665693 [debug] [Thread-1  ]: Began compiling node model.dbt_idx.fact_stocks
[0m16:19:34.671897 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_idx.fact_stocks"
[0m16:19:34.695302 [debug] [Thread-1  ]: Timing info for model.dbt_idx.fact_stocks (compile): 16:19:34.666757 => 16:19:34.694709
[0m16:19:34.696761 [debug] [Thread-1  ]: Began executing node model.dbt_idx.fact_stocks
[0m16:19:34.705184 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_idx.fact_stocks"
[0m16:19:34.729873 [debug] [Thread-1  ]: Using postgres connection "model.dbt_idx.fact_stocks"
[0m16:19:34.731565 [debug] [Thread-1  ]: On model.dbt_idx.fact_stocks: BEGIN
[0m16:19:34.732685 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m16:19:34.741110 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m16:19:34.743041 [debug] [Thread-1  ]: Using postgres connection "model.dbt_idx.fact_stocks"
[0m16:19:34.744876 [debug] [Thread-1  ]: On model.dbt_idx.fact_stocks: /* {"app": "dbt", "dbt_version": "1.5.6", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.fact_stocks"} */

  
    

  create  table "IDX-Stock"."IDX-Schema"."fact_stocks__dbt_tmp"
  
  
    as
  
  (
    -- noinspection SqlDialectInspectionForFile

with stock as (
    select *
    from "IDX-Stock"."IDX-Schema"."stg_eltool__stock"
    ),
     company as (
         select *
         from "IDX-Stock"."IDX-Schema"."stg_eltool__company"
     )
select a.id,
       a.ticker,
       b.name,
       a.date,
       a.open,
       a.high,
       a.low,
       a.close,
       a.volume,
       b.logo
from stock a
    join company b on a.ticker = b.ticker
  );
  
[0m16:19:34.875165 [debug] [Thread-1  ]: SQL status: SELECT 26131 in 0.0 seconds
[0m16:19:34.885043 [debug] [Thread-1  ]: Using postgres connection "model.dbt_idx.fact_stocks"
[0m16:19:34.887107 [debug] [Thread-1  ]: On model.dbt_idx.fact_stocks: /* {"app": "dbt", "dbt_version": "1.5.6", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.fact_stocks"} */
alter table "IDX-Stock"."IDX-Schema"."fact_stocks" rename to "fact_stocks__dbt_backup"
[0m16:19:34.889819 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m16:19:34.896302 [debug] [Thread-1  ]: Using postgres connection "model.dbt_idx.fact_stocks"
[0m16:19:34.898112 [debug] [Thread-1  ]: On model.dbt_idx.fact_stocks: /* {"app": "dbt", "dbt_version": "1.5.6", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.fact_stocks"} */
alter table "IDX-Stock"."IDX-Schema"."fact_stocks__dbt_tmp" rename to "fact_stocks"
[0m16:19:34.900099 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m16:19:34.905215 [debug] [Thread-1  ]: On model.dbt_idx.fact_stocks: COMMIT
[0m16:19:34.907419 [debug] [Thread-1  ]: Using postgres connection "model.dbt_idx.fact_stocks"
[0m16:19:34.908893 [debug] [Thread-1  ]: On model.dbt_idx.fact_stocks: COMMIT
[0m16:19:34.945809 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m16:19:34.954265 [debug] [Thread-1  ]: Using postgres connection "model.dbt_idx.fact_stocks"
[0m16:19:34.956361 [debug] [Thread-1  ]: On model.dbt_idx.fact_stocks: /* {"app": "dbt", "dbt_version": "1.5.6", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.fact_stocks"} */
drop table if exists "IDX-Stock"."IDX-Schema"."fact_stocks__dbt_backup" cascade
[0m16:19:34.961409 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
[0m16:19:34.965619 [debug] [Thread-1  ]: Timing info for model.dbt_idx.fact_stocks (execute): 16:19:34.697970 => 16:19:34.965274
[0m16:19:34.966950 [debug] [Thread-1  ]: On model.dbt_idx.fact_stocks: Close
[0m16:19:34.969225 [info ] [Thread-1  ]: 9 of 11 OK created sql table model IDX-Schema.fact_stocks ...................... [[32mSELECT 26131[0m in 0.31s]
[0m16:19:34.971759 [debug] [Thread-1  ]: Finished running node model.dbt_idx.fact_stocks
[0m16:19:34.973850 [debug] [Thread-1  ]: Began running node model.dbt_idx.customer_orders_status
[0m16:19:34.975290 [info ] [Thread-1  ]: 10 of 11 START sql view model IDX-Schema.customer_orders_status ................ [RUN]
[0m16:19:34.977066 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_idx.fact_stocks, now model.dbt_idx.customer_orders_status)
[0m16:19:34.978312 [debug] [Thread-1  ]: Began compiling node model.dbt_idx.customer_orders_status
[0m16:19:34.985190 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_idx.customer_orders_status"
[0m16:19:35.017586 [debug] [Thread-1  ]: Timing info for model.dbt_idx.customer_orders_status (compile): 16:19:34.980103 => 16:19:35.017179
[0m16:19:35.018688 [debug] [Thread-1  ]: Began executing node model.dbt_idx.customer_orders_status
[0m16:19:35.033666 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_idx.customer_orders_status"
[0m16:19:35.070447 [debug] [Thread-1  ]: Using postgres connection "model.dbt_idx.customer_orders_status"
[0m16:19:35.072596 [debug] [Thread-1  ]: On model.dbt_idx.customer_orders_status: BEGIN
[0m16:19:35.074800 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m16:19:35.088086 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m16:19:35.091392 [debug] [Thread-1  ]: Using postgres connection "model.dbt_idx.customer_orders_status"
[0m16:19:35.093945 [debug] [Thread-1  ]: On model.dbt_idx.customer_orders_status: /* {"app": "dbt", "dbt_version": "1.5.6", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.customer_orders_status"} */

  create view "IDX-Stock"."IDX-Schema"."customer_orders_status__dbt_tmp"
    
    
  as (
    with orders as (select *
                from "IDX-Stock"."IDX-Schema"."fact_orders"),
     customers as (select *
                   from "IDX-Stock"."IDX-Schema"."dim_customers")
select o.order_id,
       o.customer_id,
       o.order_status,
       o.order_purchase_timestamp,
       o.order_approved_at,
       o.order_delivered_carrier_date,
       o.order_delivered_customer_date,
       o.order_estimated_delivery_date,
       c.zipcode    as customer_zipcode,
       c.city       as customer_city,
       c.state_code as customer_state_code,
       c.state_name as customer_state_name
from orders o
    join customers c on o.customer_id = c.customer_id
    and o.order_purchase_timestamp >= c.valid_from
    and o.order_purchase_timestamp <= c.valid_to
  );
[0m16:19:35.102150 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m16:19:35.114613 [debug] [Thread-1  ]: Using postgres connection "model.dbt_idx.customer_orders_status"
[0m16:19:35.118334 [debug] [Thread-1  ]: On model.dbt_idx.customer_orders_status: /* {"app": "dbt", "dbt_version": "1.5.6", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.customer_orders_status"} */
alter table "IDX-Stock"."IDX-Schema"."customer_orders_status__dbt_tmp" rename to "customer_orders_status"
[0m16:19:35.123083 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m16:19:35.130061 [debug] [Thread-1  ]: On model.dbt_idx.customer_orders_status: COMMIT
[0m16:19:35.133559 [debug] [Thread-1  ]: Using postgres connection "model.dbt_idx.customer_orders_status"
[0m16:19:35.135992 [debug] [Thread-1  ]: On model.dbt_idx.customer_orders_status: COMMIT
[0m16:19:35.140563 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m16:19:35.149157 [debug] [Thread-1  ]: Using postgres connection "model.dbt_idx.customer_orders_status"
[0m16:19:35.151249 [debug] [Thread-1  ]: On model.dbt_idx.customer_orders_status: /* {"app": "dbt", "dbt_version": "1.5.6", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.customer_orders_status"} */
drop view if exists "IDX-Stock"."IDX-Schema"."customer_orders_status__dbt_backup" cascade
[0m16:19:35.155048 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
[0m16:19:35.159721 [debug] [Thread-1  ]: Timing info for model.dbt_idx.customer_orders_status (execute): 16:19:35.019869 => 16:19:35.159076
[0m16:19:35.161537 [debug] [Thread-1  ]: On model.dbt_idx.customer_orders_status: Close
[0m16:19:35.165448 [info ] [Thread-1  ]: 10 of 11 OK created sql view model IDX-Schema.customer_orders_status ........... [[32mCREATE VIEW[0m in 0.19s]
[0m16:19:35.168611 [debug] [Thread-1  ]: Finished running node model.dbt_idx.customer_orders_status
[0m16:19:35.170611 [debug] [Thread-1  ]: Began running node model.dbt_idx.stock_update_status
[0m16:19:35.173140 [info ] [Thread-1  ]: 11 of 11 START sql view model IDX-Schema.stock_update_status ................... [RUN]
[0m16:19:35.175440 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_idx.customer_orders_status, now model.dbt_idx.stock_update_status)
[0m16:19:35.176866 [debug] [Thread-1  ]: Began compiling node model.dbt_idx.stock_update_status
[0m16:19:35.184461 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_idx.stock_update_status"
[0m16:19:35.216476 [debug] [Thread-1  ]: Timing info for model.dbt_idx.stock_update_status (compile): 16:19:35.178080 => 16:19:35.215958
[0m16:19:35.217989 [debug] [Thread-1  ]: Began executing node model.dbt_idx.stock_update_status
[0m16:19:35.228459 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_idx.stock_update_status"
[0m16:19:35.259403 [debug] [Thread-1  ]: Using postgres connection "model.dbt_idx.stock_update_status"
[0m16:19:35.261096 [debug] [Thread-1  ]: On model.dbt_idx.stock_update_status: BEGIN
[0m16:19:35.262991 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m16:19:35.274362 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m16:19:35.276515 [debug] [Thread-1  ]: Using postgres connection "model.dbt_idx.stock_update_status"
[0m16:19:35.277964 [debug] [Thread-1  ]: On model.dbt_idx.stock_update_status: /* {"app": "dbt", "dbt_version": "1.5.6", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stock_update_status"} */

  create view "IDX-Stock"."IDX-Schema"."stock_update_status__dbt_tmp"
    
    
  as (
    with stock as (select *,
                        rank() over (
                        partition by ticker
                        order by date desc
                        ) as rank
               from "IDX-Stock"."IDX-Schema"."fact_stocks")
select a.id,
       a.ticker,
       a.name,
       a.date,
       a.open,
       a.high,
       a.low,
       a.close,
       a.volume,
       a.rank,
       a.logo
from stock a
order by a.date desc, a.ticker desc
  );
[0m16:19:35.285197 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m16:19:35.302177 [debug] [Thread-1  ]: Using postgres connection "model.dbt_idx.stock_update_status"
[0m16:19:35.303855 [debug] [Thread-1  ]: On model.dbt_idx.stock_update_status: /* {"app": "dbt", "dbt_version": "1.5.6", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stock_update_status"} */
alter table "IDX-Stock"."IDX-Schema"."stock_update_status__dbt_tmp" rename to "stock_update_status"
[0m16:19:35.307718 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m16:19:35.313175 [debug] [Thread-1  ]: On model.dbt_idx.stock_update_status: COMMIT
[0m16:19:35.315090 [debug] [Thread-1  ]: Using postgres connection "model.dbt_idx.stock_update_status"
[0m16:19:35.316860 [debug] [Thread-1  ]: On model.dbt_idx.stock_update_status: COMMIT
[0m16:19:35.319624 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m16:19:35.330389 [debug] [Thread-1  ]: Using postgres connection "model.dbt_idx.stock_update_status"
[0m16:19:35.335003 [debug] [Thread-1  ]: On model.dbt_idx.stock_update_status: /* {"app": "dbt", "dbt_version": "1.5.6", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stock_update_status"} */
drop view if exists "IDX-Stock"."IDX-Schema"."stock_update_status__dbt_backup" cascade
[0m16:19:35.338283 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
[0m16:19:35.344271 [debug] [Thread-1  ]: Timing info for model.dbt_idx.stock_update_status (execute): 16:19:35.219111 => 16:19:35.343676
[0m16:19:35.346334 [debug] [Thread-1  ]: On model.dbt_idx.stock_update_status: Close
[0m16:19:35.355436 [info ] [Thread-1  ]: 11 of 11 OK created sql view model IDX-Schema.stock_update_status .............. [[32mCREATE VIEW[0m in 0.18s]
[0m16:19:35.359672 [debug] [Thread-1  ]: Finished running node model.dbt_idx.stock_update_status
[0m16:19:35.403002 [debug] [MainThread]: Using postgres connection "master"
[0m16:19:35.405281 [debug] [MainThread]: On master: BEGIN
[0m16:19:35.407981 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:19:35.420294 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m16:19:35.422653 [debug] [MainThread]: On master: COMMIT
[0m16:19:35.424953 [debug] [MainThread]: Using postgres connection "master"
[0m16:19:35.427772 [debug] [MainThread]: On master: COMMIT
[0m16:19:35.432250 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m16:19:35.436293 [debug] [MainThread]: On master: Close
[0m16:19:35.442444 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:19:35.445036 [debug] [MainThread]: Connection 'model.dbt_idx.stock_update_status' was properly closed.
[0m16:19:35.450123 [info ] [MainThread]: 
[0m16:19:35.453859 [info ] [MainThread]: Finished running 8 view models, 3 table models in 0 hours 0 minutes and 2.71 seconds (2.71s).
[0m16:19:35.465202 [debug] [MainThread]: Command end result
[0m16:19:35.532158 [info ] [MainThread]: 
[0m16:19:35.534084 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:19:35.535734 [info ] [MainThread]: 
[0m16:19:35.537485 [info ] [MainThread]: Done. PASS=11 WARN=0 ERROR=0 SKIP=0 TOTAL=11
[0m16:19:35.540134 [debug] [MainThread]: Command `dbt run` succeeded at 16:19:35.539844 after 4.17 seconds
[0m16:19:35.542166 [debug] [MainThread]: Flushing usage events


============================== 16:19:40.881186 | 6e8d6f8f-6594-42d2-a3e0-168c37e6c61d ==============================
[0m16:19:40.881186 [info ] [MainThread]: Running with dbt=1.5.6
[0m16:19:40.894310 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/opt/airflow/dags/Py-DBT-IDX/logs', 'version_check': 'True', 'profiles_dir': '/opt/airflow/dags/Py-DBT-IDX', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'send_anonymous_usage_stats': 'False'}
[0m16:19:41.146461 [info ] [MainThread]: Registered adapter: postgres=1.5.6
[0m16:19:41.189399 [debug] [MainThread]: checksum: 36b91491eb2b55e69ff526c98e337edadb953c9826242889489b2fea40332ad6, vars: {}, profile: , target: , version: 1.5.6
[0m16:19:42.414729 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:19:42.415974 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:19:42.481420 [info ] [MainThread]: Found 11 models, 19 tests, 1 snapshot, 0 analyses, 307 macros, 0 operations, 0 seed files, 5 sources, 0 exposures, 0 metrics, 0 groups
[0m16:19:42.485146 [info ] [MainThread]: 
[0m16:19:42.488400 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m16:19:42.491091 [debug] [ThreadPool]: Acquiring new postgres connection 'list_IDX-Stock'
[0m16:19:42.517056 [debug] [ThreadPool]: Using postgres connection "list_IDX-Stock"
[0m16:19:42.518796 [debug] [ThreadPool]: On list_IDX-Stock: /* {"app": "dbt", "dbt_version": "1.5.6", "profile_name": "dbt_idx", "target_name": "dev", "connection_name": "list_IDX-Stock"} */

    select distinct nspname from pg_namespace
  
[0m16:19:42.520405 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:19:42.537066 [debug] [ThreadPool]: SQL status: SELECT 12 in 0.0 seconds
[0m16:19:42.543668 [debug] [ThreadPool]: On list_IDX-Stock: Close
[0m16:19:42.551560 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_IDX-Stock, now list_IDX-Stock_IDX-Schema)
[0m16:19:42.568492 [debug] [ThreadPool]: Using postgres connection "list_IDX-Stock_IDX-Schema"
[0m16:19:42.570204 [debug] [ThreadPool]: On list_IDX-Stock_IDX-Schema: BEGIN
[0m16:19:42.571897 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:19:42.584002 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m16:19:42.585628 [debug] [ThreadPool]: Using postgres connection "list_IDX-Stock_IDX-Schema"
[0m16:19:42.587551 [debug] [ThreadPool]: On list_IDX-Stock_IDX-Schema: /* {"app": "dbt", "dbt_version": "1.5.6", "profile_name": "dbt_idx", "target_name": "dev", "connection_name": "list_IDX-Stock_IDX-Schema"} */
select
      'IDX-Stock' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'IDX-Schema'
    union all
    select
      'IDX-Stock' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'IDX-Schema'
  
[0m16:19:42.593831 [debug] [ThreadPool]: SQL status: SELECT 17 in 0.0 seconds
[0m16:19:42.601381 [debug] [ThreadPool]: On list_IDX-Stock_IDX-Schema: ROLLBACK
[0m16:19:42.604999 [debug] [ThreadPool]: On list_IDX-Stock_IDX-Schema: Close
[0m16:19:42.609547 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_IDX-Stock_IDX-Schema, now list_IDX-Stock_snapshots)
[0m16:19:42.628168 [debug] [ThreadPool]: Using postgres connection "list_IDX-Stock_snapshots"
[0m16:19:42.630571 [debug] [ThreadPool]: On list_IDX-Stock_snapshots: BEGIN
[0m16:19:42.633155 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:19:42.647154 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m16:19:42.649693 [debug] [ThreadPool]: Using postgres connection "list_IDX-Stock_snapshots"
[0m16:19:42.651528 [debug] [ThreadPool]: On list_IDX-Stock_snapshots: /* {"app": "dbt", "dbt_version": "1.5.6", "profile_name": "dbt_idx", "target_name": "dev", "connection_name": "list_IDX-Stock_snapshots"} */
select
      'IDX-Stock' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'snapshots'
    union all
    select
      'IDX-Stock' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'snapshots'
  
[0m16:19:42.659885 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.0 seconds
[0m16:19:42.665581 [debug] [ThreadPool]: On list_IDX-Stock_snapshots: ROLLBACK
[0m16:19:42.667900 [debug] [ThreadPool]: On list_IDX-Stock_snapshots: Close
[0m16:19:42.683566 [debug] [MainThread]: Using postgres connection "master"
[0m16:19:42.685855 [debug] [MainThread]: On master: BEGIN
[0m16:19:42.688479 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:19:42.701258 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m16:19:42.704431 [debug] [MainThread]: Using postgres connection "master"
[0m16:19:42.707146 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.5.6", "profile_name": "dbt_idx", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m16:19:42.728563 [debug] [MainThread]: SQL status: SELECT 9 in 0.0 seconds
[0m16:19:42.741223 [debug] [MainThread]: On master: ROLLBACK
[0m16:19:42.743553 [debug] [MainThread]: Using postgres connection "master"
[0m16:19:42.745780 [debug] [MainThread]: On master: BEGIN
[0m16:19:42.748654 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m16:19:42.750375 [debug] [MainThread]: On master: COMMIT
[0m16:19:42.752250 [debug] [MainThread]: Using postgres connection "master"
[0m16:19:42.754074 [debug] [MainThread]: On master: COMMIT
[0m16:19:42.757008 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m16:19:42.759724 [debug] [MainThread]: On master: Close
[0m16:19:42.764342 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:19:42.768249 [info ] [MainThread]: 
[0m16:19:42.786166 [debug] [Thread-1  ]: Began running node snapshot.dbt_idx.customers_snapshot
[0m16:19:42.788818 [info ] [Thread-1  ]: 1 of 1 START snapshot snapshots.customers_snapshot ............................. [RUN]
[0m16:19:42.792594 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_IDX-Stock_snapshots, now snapshot.dbt_idx.customers_snapshot)
[0m16:19:42.794874 [debug] [Thread-1  ]: Began compiling node snapshot.dbt_idx.customers_snapshot
[0m16:19:42.813247 [debug] [Thread-1  ]: Timing info for snapshot.dbt_idx.customers_snapshot (compile): 16:19:42.796554 => 16:19:42.812757
[0m16:19:42.814590 [debug] [Thread-1  ]: Began executing node snapshot.dbt_idx.customers_snapshot
[0m16:19:42.909700 [debug] [Thread-1  ]: Using postgres connection "snapshot.dbt_idx.customers_snapshot"
[0m16:19:42.911210 [debug] [Thread-1  ]: On snapshot.dbt_idx.customers_snapshot: BEGIN
[0m16:19:42.913085 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m16:19:42.926757 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m16:19:42.929421 [debug] [Thread-1  ]: Using postgres connection "snapshot.dbt_idx.customers_snapshot"
[0m16:19:42.932185 [debug] [Thread-1  ]: On snapshot.dbt_idx.customers_snapshot: /* {"app": "dbt", "dbt_version": "1.5.6", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "snapshot.dbt_idx.customers_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "IDX-Stock".INFORMATION_SCHEMA.columns
      where table_name = 'customers_snapshot'
        
        and table_schema = 'snapshots'
        
      order by ordinal_position

  
[0m16:19:42.947987 [debug] [Thread-1  ]: SQL status: SELECT 10 in 0.0 seconds


============================== 16:19:42.973410 | 4c820584-95df-433a-8a1b-af6d03404cc2 ==============================
[0m16:19:42.973410 [info ] [MainThread]: Running with dbt=1.5.6
[0m16:19:42.986543 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dags/Py-DBT-IDX', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/opt/airflow/dags/Py-DBT-IDX/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'False'}
[0m16:19:43.014446 [debug] [Thread-1  ]: Using postgres connection "snapshot.dbt_idx.customers_snapshot"
[0m16:19:43.016279 [debug] [Thread-1  ]: On snapshot.dbt_idx.customers_snapshot: /* {"app": "dbt", "dbt_version": "1.5.6", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "snapshot.dbt_idx.customers_snapshot"} */

        
  
    

  create temporary table "customers_snapshot__dbt_tmp161942984865"
  
  
    as
  
  (
    with snapshot_query as (

        



select *
from "IDX-Stock"."IDX-Schema"."customers"


    ),

    snapshotted_data as (

        select *,
            customer_id as dbt_unique_key

        from "IDX-Stock"."snapshots"."customers_snapshot"
        where dbt_valid_to is null

    ),

    insertions_source_data as (

        select
            *,
            customer_id as dbt_unique_key,
            datetime_updated as dbt_updated_at,
            datetime_updated as dbt_valid_from,
            nullif(datetime_updated, datetime_updated) as dbt_valid_to,
            md5(coalesce(cast(customer_id as varchar ), '')
         || '|' || coalesce(cast(datetime_updated as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select
            *,
            customer_id as dbt_unique_key,
            datetime_updated as dbt_updated_at,
            datetime_updated as dbt_valid_from,
            datetime_updated as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where snapshotted_data.dbt_unique_key is null
           or (
                snapshotted_data.dbt_unique_key is not null
            and (
                (snapshotted_data.dbt_valid_from < source_data.datetime_updated)
            )
        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where (
            (snapshotted_data.dbt_valid_from < source_data.datetime_updated)
        )
    )

    select * from insertions
    union all
    select * from updates

  );
  
    
[0m16:19:43.026303 [debug] [Thread-1  ]: SQL status: SELECT 0 in 0.0 seconds
[0m16:19:43.035435 [debug] [Thread-1  ]: Using postgres connection "snapshot.dbt_idx.customers_snapshot"
[0m16:19:43.037426 [debug] [Thread-1  ]: On snapshot.dbt_idx.customers_snapshot: /* {"app": "dbt", "dbt_version": "1.5.6", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "snapshot.dbt_idx.customers_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'customers_snapshot__dbt_tmp161942984865'
        
      order by ordinal_position

  
[0m16:19:43.044517 [debug] [Thread-1  ]: SQL status: SELECT 12 in 0.0 seconds
[0m16:19:43.053321 [debug] [Thread-1  ]: Using postgres connection "snapshot.dbt_idx.customers_snapshot"
[0m16:19:43.055723 [debug] [Thread-1  ]: On snapshot.dbt_idx.customers_snapshot: /* {"app": "dbt", "dbt_version": "1.5.6", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "snapshot.dbt_idx.customers_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "IDX-Stock".INFORMATION_SCHEMA.columns
      where table_name = 'customers_snapshot'
        
        and table_schema = 'snapshots'
        
      order by ordinal_position

  
[0m16:19:43.060085 [debug] [Thread-1  ]: SQL status: SELECT 10 in 0.0 seconds
[0m16:19:43.070656 [debug] [Thread-1  ]: Using postgres connection "snapshot.dbt_idx.customers_snapshot"
[0m16:19:43.072789 [debug] [Thread-1  ]: On snapshot.dbt_idx.customers_snapshot: /* {"app": "dbt", "dbt_version": "1.5.6", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "snapshot.dbt_idx.customers_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'customers_snapshot__dbt_tmp161942984865'
        
      order by ordinal_position

  
[0m16:19:43.077858 [debug] [Thread-1  ]: SQL status: SELECT 12 in 0.0 seconds
[0m16:19:43.086364 [debug] [Thread-1  ]: Using postgres connection "snapshot.dbt_idx.customers_snapshot"
[0m16:19:43.088593 [debug] [Thread-1  ]: On snapshot.dbt_idx.customers_snapshot: /* {"app": "dbt", "dbt_version": "1.5.6", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "snapshot.dbt_idx.customers_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "IDX-Stock".INFORMATION_SCHEMA.columns
      where table_name = 'customers_snapshot'
        
        and table_schema = 'snapshots'
        
      order by ordinal_position

  
[0m16:19:43.092784 [debug] [Thread-1  ]: SQL status: SELECT 10 in 0.0 seconds
[0m16:19:43.106586 [debug] [Thread-1  ]: Using postgres connection "snapshot.dbt_idx.customers_snapshot"
[0m16:19:43.108079 [debug] [Thread-1  ]: On snapshot.dbt_idx.customers_snapshot: /* {"app": "dbt", "dbt_version": "1.5.6", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "snapshot.dbt_idx.customers_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'customers_snapshot__dbt_tmp161942984865'
        
      order by ordinal_position

  
[0m16:19:43.113119 [debug] [Thread-1  ]: SQL status: SELECT 12 in 0.0 seconds
[0m16:19:43.124902 [debug] [Thread-1  ]: Writing runtime sql for node "snapshot.dbt_idx.customers_snapshot"
[0m16:19:43.155843 [debug] [Thread-1  ]: Using postgres connection "snapshot.dbt_idx.customers_snapshot"
[0m16:19:43.157776 [debug] [Thread-1  ]: On snapshot.dbt_idx.customers_snapshot: /* {"app": "dbt", "dbt_version": "1.5.6", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "snapshot.dbt_idx.customers_snapshot"} */

      update "IDX-Stock"."snapshots"."customers_snapshot"
    set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to
    from "customers_snapshot__dbt_tmp161942984865" as DBT_INTERNAL_SOURCE
    where DBT_INTERNAL_SOURCE.dbt_scd_id::text = "IDX-Stock"."snapshots"."customers_snapshot".dbt_scd_id::text
      and DBT_INTERNAL_SOURCE.dbt_change_type::text in ('update'::text, 'delete'::text)
      and "IDX-Stock"."snapshots"."customers_snapshot".dbt_valid_to is null;

    insert into "IDX-Stock"."snapshots"."customers_snapshot" ("customer_id", "zipcode", "city", "state_code", "datetime_created", "datetime_updated", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id")
    select DBT_INTERNAL_SOURCE."customer_id",DBT_INTERNAL_SOURCE."zipcode",DBT_INTERNAL_SOURCE."city",DBT_INTERNAL_SOURCE."state_code",DBT_INTERNAL_SOURCE."datetime_created",DBT_INTERNAL_SOURCE."datetime_updated",DBT_INTERNAL_SOURCE."dbt_updated_at",DBT_INTERNAL_SOURCE."dbt_valid_from",DBT_INTERNAL_SOURCE."dbt_valid_to",DBT_INTERNAL_SOURCE."dbt_scd_id"
    from "customers_snapshot__dbt_tmp161942984865" as DBT_INTERNAL_SOURCE
    where DBT_INTERNAL_SOURCE.dbt_change_type::text = 'insert'::text;

  
[0m16:19:43.162870 [debug] [Thread-1  ]: SQL status: INSERT 0 0 in 0.0 seconds
[0m16:19:43.189463 [debug] [Thread-1  ]: On snapshot.dbt_idx.customers_snapshot: COMMIT
[0m16:19:43.190716 [debug] [Thread-1  ]: Using postgres connection "snapshot.dbt_idx.customers_snapshot"
[0m16:19:43.191842 [debug] [Thread-1  ]: On snapshot.dbt_idx.customers_snapshot: COMMIT
[0m16:19:43.194788 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m16:19:43.200298 [debug] [Thread-1  ]: Timing info for snapshot.dbt_idx.customers_snapshot (execute): 16:19:42.815598 => 16:19:43.200043
[0m16:19:43.201543 [debug] [Thread-1  ]: On snapshot.dbt_idx.customers_snapshot: Close
[0m16:19:43.204367 [info ] [Thread-1  ]: 1 of 1 OK snapshotted snapshots.customers_snapshot ............................. [[32msuccess[0m in 0.41s]
[0m16:19:43.206888 [debug] [Thread-1  ]: Finished running node snapshot.dbt_idx.customers_snapshot
[0m16:19:43.230232 [info ] [MainThread]: Registered adapter: postgres=1.5.6
[0m16:19:43.271590 [debug] [MainThread]: checksum: 36b91491eb2b55e69ff526c98e337edadb953c9826242889489b2fea40332ad6, vars: {}, profile: , target: , version: 1.5.6
[0m16:19:43.302476 [debug] [MainThread]: Using postgres connection "master"
[0m16:19:43.304390 [debug] [MainThread]: On master: BEGIN
[0m16:19:43.306687 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:19:43.319865 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m16:19:43.322771 [debug] [MainThread]: On master: COMMIT
[0m16:19:43.325382 [debug] [MainThread]: Using postgres connection "master"
[0m16:19:43.328046 [debug] [MainThread]: On master: COMMIT
[0m16:19:43.333279 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m16:19:43.335444 [debug] [MainThread]: On master: Close
[0m16:19:43.340005 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:19:43.343614 [debug] [MainThread]: Connection 'snapshot.dbt_idx.customers_snapshot' was properly closed.
[0m16:19:43.347688 [info ] [MainThread]: 
[0m16:19:43.351019 [info ] [MainThread]: Finished running 1 snapshot in 0 hours 0 minutes and 0.86 seconds (0.86s).
[0m16:19:43.356461 [debug] [MainThread]: Command end result
[0m16:19:43.423779 [info ] [MainThread]: 
[0m16:19:43.426064 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:19:43.428156 [info ] [MainThread]: 
[0m16:19:43.430443 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m16:19:43.433131 [debug] [MainThread]: Command `dbt snapshot` succeeded at 16:19:43.432894 after 2.61 seconds
[0m16:19:43.434625 [debug] [MainThread]: Flushing usage events
[0m16:19:44.458833 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:19:44.461152 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:19:44.539080 [info ] [MainThread]: Found 11 models, 19 tests, 1 snapshot, 0 analyses, 307 macros, 0 operations, 0 seed files, 5 sources, 0 exposures, 0 metrics, 0 groups
[0m16:19:44.545620 [info ] [MainThread]: 
[0m16:19:44.548603 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m16:19:44.552746 [debug] [ThreadPool]: Acquiring new postgres connection 'list_IDX-Stock_IDX-Schema'
[0m16:19:44.576842 [debug] [ThreadPool]: Using postgres connection "list_IDX-Stock_IDX-Schema"
[0m16:19:44.578517 [debug] [ThreadPool]: On list_IDX-Stock_IDX-Schema: BEGIN
[0m16:19:44.580562 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:19:44.591662 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m16:19:44.593617 [debug] [ThreadPool]: Using postgres connection "list_IDX-Stock_IDX-Schema"
[0m16:19:44.595668 [debug] [ThreadPool]: On list_IDX-Stock_IDX-Schema: /* {"app": "dbt", "dbt_version": "1.5.6", "profile_name": "dbt_idx", "target_name": "dev", "connection_name": "list_IDX-Stock_IDX-Schema"} */
select
      'IDX-Stock' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'IDX-Schema'
    union all
    select
      'IDX-Stock' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'IDX-Schema'
  
[0m16:19:44.601559 [debug] [ThreadPool]: SQL status: SELECT 17 in 0.0 seconds
[0m16:19:44.606431 [debug] [ThreadPool]: On list_IDX-Stock_IDX-Schema: ROLLBACK
[0m16:19:44.609263 [debug] [ThreadPool]: On list_IDX-Stock_IDX-Schema: Close
[0m16:19:44.612916 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_IDX-Stock_IDX-Schema, now list_IDX-Stock_snapshots)
[0m16:19:44.626068 [debug] [ThreadPool]: Using postgres connection "list_IDX-Stock_snapshots"
[0m16:19:44.628274 [debug] [ThreadPool]: On list_IDX-Stock_snapshots: BEGIN
[0m16:19:44.630741 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:19:44.641674 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m16:19:44.644095 [debug] [ThreadPool]: Using postgres connection "list_IDX-Stock_snapshots"
[0m16:19:44.646754 [debug] [ThreadPool]: On list_IDX-Stock_snapshots: /* {"app": "dbt", "dbt_version": "1.5.6", "profile_name": "dbt_idx", "target_name": "dev", "connection_name": "list_IDX-Stock_snapshots"} */
select
      'IDX-Stock' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'snapshots'
    union all
    select
      'IDX-Stock' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'snapshots'
  
[0m16:19:44.655149 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.0 seconds
[0m16:19:44.658742 [debug] [ThreadPool]: On list_IDX-Stock_snapshots: ROLLBACK
[0m16:19:44.660180 [debug] [ThreadPool]: On list_IDX-Stock_snapshots: Close
[0m16:19:44.676015 [debug] [MainThread]: Using postgres connection "master"
[0m16:19:44.677520 [debug] [MainThread]: On master: BEGIN
[0m16:19:44.679205 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:19:44.690938 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m16:19:44.692736 [debug] [MainThread]: Using postgres connection "master"
[0m16:19:44.695060 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.5.6", "profile_name": "dbt_idx", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m16:19:44.708126 [debug] [MainThread]: SQL status: SELECT 9 in 0.0 seconds
[0m16:19:44.716989 [debug] [MainThread]: On master: ROLLBACK
[0m16:19:44.720175 [debug] [MainThread]: Using postgres connection "master"
[0m16:19:44.722497 [debug] [MainThread]: On master: BEGIN
[0m16:19:44.725266 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m16:19:44.728598 [debug] [MainThread]: On master: COMMIT
[0m16:19:44.730747 [debug] [MainThread]: Using postgres connection "master"
[0m16:19:44.733071 [debug] [MainThread]: On master: COMMIT
[0m16:19:44.734874 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m16:19:44.736885 [debug] [MainThread]: On master: Close
[0m16:19:44.740763 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:19:44.745055 [info ] [MainThread]: 
[0m16:19:44.762282 [debug] [Thread-1  ]: Began running node test.dbt_idx.accepted_values_customer_orders_status_order_status__delivered__invoiced__shipped__processing__canceled__unavailable.ea8c296d27
[0m16:19:44.765979 [info ] [Thread-1  ]: 1 of 19 START test accepted_values_customer_orders_status_order_status__delivered__invoiced__shipped__processing__canceled__unavailable  [RUN]
[0m16:19:44.768777 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_IDX-Stock_snapshots, now test.dbt_idx.accepted_values_customer_orders_status_order_status__delivered__invoiced__shipped__processing__canceled__unavailable.ea8c296d27)
[0m16:19:44.771420 [debug] [Thread-1  ]: Began compiling node test.dbt_idx.accepted_values_customer_orders_status_order_status__delivered__invoiced__shipped__processing__canceled__unavailable.ea8c296d27
[0m16:19:44.808693 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_idx.accepted_values_customer_orders_status_order_status__delivered__invoiced__shipped__processing__canceled__unavailable.ea8c296d27"
[0m16:19:44.837489 [debug] [Thread-1  ]: Timing info for test.dbt_idx.accepted_values_customer_orders_status_order_status__delivered__invoiced__shipped__processing__canceled__unavailable.ea8c296d27 (compile): 16:19:44.773517 => 16:19:44.836962
[0m16:19:44.838905 [debug] [Thread-1  ]: Began executing node test.dbt_idx.accepted_values_customer_orders_status_order_status__delivered__invoiced__shipped__processing__canceled__unavailable.ea8c296d27
[0m16:19:44.861566 [debug] [Thread-1  ]: Writing runtime sql for node "test.dbt_idx.accepted_values_customer_orders_status_order_status__delivered__invoiced__shipped__processing__canceled__unavailable.ea8c296d27"
[0m16:19:44.891045 [debug] [Thread-1  ]: Using postgres connection "test.dbt_idx.accepted_values_customer_orders_status_order_status__delivered__invoiced__shipped__processing__canceled__unavailable.ea8c296d27"
[0m16:19:44.892136 [debug] [Thread-1  ]: On test.dbt_idx.accepted_values_customer_orders_status_order_status__delivered__invoiced__shipped__processing__canceled__unavailable.ea8c296d27: BEGIN
[0m16:19:44.893044 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m16:19:44.902635 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m16:19:44.904936 [debug] [Thread-1  ]: Using postgres connection "test.dbt_idx.accepted_values_customer_orders_status_order_status__delivered__invoiced__shipped__processing__canceled__unavailable.ea8c296d27"
[0m16:19:44.907103 [debug] [Thread-1  ]: On test.dbt_idx.accepted_values_customer_orders_status_order_status__delivered__invoiced__shipped__processing__canceled__unavailable.ea8c296d27: /* {"app": "dbt", "dbt_version": "1.5.6", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "test.dbt_idx.accepted_values_customer_orders_status_order_status__delivered__invoiced__shipped__processing__canceled__unavailable.ea8c296d27"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        order_status as value_field,
        count(*) as n_records

    from "IDX-Stock"."IDX-Schema"."customer_orders_status"
    group by order_status

)

select *
from all_values
where value_field not in (
    'delivered','invoiced','shipped','processing','canceled','unavailable'
)



      
    ) dbt_internal_test
[0m16:19:44.915506 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.0 seconds
[0m16:19:44.924010 [debug] [Thread-1  ]: Timing info for test.dbt_idx.accepted_values_customer_orders_status_order_status__delivered__invoiced__shipped__processing__canceled__unavailable.ea8c296d27 (execute): 16:19:44.839774 => 16:19:44.923381
[0m16:19:44.926401 [debug] [Thread-1  ]: On test.dbt_idx.accepted_values_customer_orders_status_order_status__delivered__invoiced__shipped__processing__canceled__unavailable.ea8c296d27: ROLLBACK
[0m16:19:44.929192 [debug] [Thread-1  ]: On test.dbt_idx.accepted_values_customer_orders_status_order_status__delivered__invoiced__shipped__processing__canceled__unavailable.ea8c296d27: Close
[0m16:19:44.933226 [info ] [Thread-1  ]: 1 of 19 PASS accepted_values_customer_orders_status_order_status__delivered__invoiced__shipped__processing__canceled__unavailable  [[32mPASS[0m in 0.16s]
[0m16:19:44.937149 [debug] [Thread-1  ]: Finished running node test.dbt_idx.accepted_values_customer_orders_status_order_status__delivered__invoiced__shipped__processing__canceled__unavailable.ea8c296d27
[0m16:19:44.940258 [debug] [Thread-1  ]: Began running node test.dbt_idx.assert_customer_dimension_has_no_row_loss.sql
[0m16:19:44.943121 [info ] [Thread-1  ]: 2 of 19 START test assert_customer_dimension_has_no_row_loss.sql ............... [RUN]
[0m16:19:44.947717 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.dbt_idx.accepted_values_customer_orders_status_order_status__delivered__invoiced__shipped__processing__canceled__unavailable.ea8c296d27, now test.dbt_idx.assert_customer_dimension_has_no_row_loss.sql)
[0m16:19:44.950448 [debug] [Thread-1  ]: Began compiling node test.dbt_idx.assert_customer_dimension_has_no_row_loss.sql
[0m16:19:44.958651 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_idx.assert_customer_dimension_has_no_row_loss.sql"
[0m16:19:44.990137 [debug] [Thread-1  ]: Timing info for test.dbt_idx.assert_customer_dimension_has_no_row_loss.sql (compile): 16:19:44.951890 => 16:19:44.989421
[0m16:19:44.992306 [debug] [Thread-1  ]: Began executing node test.dbt_idx.assert_customer_dimension_has_no_row_loss.sql
[0m16:19:45.000678 [debug] [Thread-1  ]: Writing runtime sql for node "test.dbt_idx.assert_customer_dimension_has_no_row_loss.sql"
[0m16:19:45.037865 [debug] [Thread-1  ]: Using postgres connection "test.dbt_idx.assert_customer_dimension_has_no_row_loss.sql"
[0m16:19:45.041241 [debug] [Thread-1  ]: On test.dbt_idx.assert_customer_dimension_has_no_row_loss.sql: BEGIN
[0m16:19:45.044353 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m16:19:45.062952 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m16:19:45.065511 [debug] [Thread-1  ]: Using postgres connection "test.dbt_idx.assert_customer_dimension_has_no_row_loss.sql"
[0m16:19:45.068669 [debug] [Thread-1  ]: On test.dbt_idx.assert_customer_dimension_has_no_row_loss.sql: /* {"app": "dbt", "dbt_version": "1.5.6", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "test.dbt_idx.assert_customer_dimension_has_no_row_loss.sql"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      -- dim_customers must have the same number of rows as its staging counterpart
-- Therefore return records where this isn't true to make the test fail
select *
from (
    select dim_cust.customer_id
    from "IDX-Stock"."IDX-Schema"."dim_customers" dim_cust
        left join "IDX-Stock"."IDX-Schema"."stg_eltool__customers_snapshots" stg_cust
    on dim_cust.customer_id = stg_cust.customer_id
    where stg_cust.customer_id is null
    UNION ALL
    select stg_cust.customer_id
    from "IDX-Stock"."IDX-Schema"."stg_eltool__customers_snapshots" stg_cust
      left join "IDX-Stock"."IDX-Schema"."dim_customers" dim_cust
    on stg_cust.customer_id = dim_cust.customer_id
    where dim_cust.customer_id is null
) tmp
      
    ) dbt_internal_test
[0m16:19:45.078994 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.0 seconds
[0m16:19:45.091467 [debug] [Thread-1  ]: Timing info for test.dbt_idx.assert_customer_dimension_has_no_row_loss.sql (execute): 16:19:44.994077 => 16:19:45.090223
[0m16:19:45.094181 [debug] [Thread-1  ]: On test.dbt_idx.assert_customer_dimension_has_no_row_loss.sql: ROLLBACK
[0m16:19:45.097693 [debug] [Thread-1  ]: On test.dbt_idx.assert_customer_dimension_has_no_row_loss.sql: Close
[0m16:19:45.103493 [info ] [Thread-1  ]: 2 of 19 PASS assert_customer_dimension_has_no_row_loss.sql ..................... [[32mPASS[0m in 0.16s]
[0m16:19:45.107831 [debug] [Thread-1  ]: Finished running node test.dbt_idx.assert_customer_dimension_has_no_row_loss.sql
[0m16:19:45.111781 [debug] [Thread-1  ]: Began running node test.dbt_idx.assert_stock_fact_has_no_row_loss.sql
[0m16:19:45.114991 [info ] [Thread-1  ]: 3 of 19 START test assert_stock_fact_has_no_row_loss.sql ....................... [RUN]
[0m16:19:45.118403 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.dbt_idx.assert_customer_dimension_has_no_row_loss.sql, now test.dbt_idx.assert_stock_fact_has_no_row_loss.sql)
[0m16:19:45.120305 [debug] [Thread-1  ]: Began compiling node test.dbt_idx.assert_stock_fact_has_no_row_loss.sql
[0m16:19:45.126799 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_idx.assert_stock_fact_has_no_row_loss.sql"
[0m16:19:45.151494 [debug] [Thread-1  ]: Timing info for test.dbt_idx.assert_stock_fact_has_no_row_loss.sql (compile): 16:19:45.121983 => 16:19:45.150857
[0m16:19:45.153258 [debug] [Thread-1  ]: Began executing node test.dbt_idx.assert_stock_fact_has_no_row_loss.sql
[0m16:19:45.159475 [debug] [Thread-1  ]: Writing runtime sql for node "test.dbt_idx.assert_stock_fact_has_no_row_loss.sql"
[0m16:19:45.183151 [debug] [Thread-1  ]: Using postgres connection "test.dbt_idx.assert_stock_fact_has_no_row_loss.sql"
[0m16:19:45.184306 [debug] [Thread-1  ]: On test.dbt_idx.assert_stock_fact_has_no_row_loss.sql: BEGIN
[0m16:19:45.185259 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m16:19:45.239459 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m16:19:45.241333 [debug] [Thread-1  ]: Using postgres connection "test.dbt_idx.assert_stock_fact_has_no_row_loss.sql"
[0m16:19:45.243204 [debug] [Thread-1  ]: On test.dbt_idx.assert_stock_fact_has_no_row_loss.sql: /* {"app": "dbt", "dbt_version": "1.5.6", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "test.dbt_idx.assert_stock_fact_has_no_row_loss.sql"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      -- fact_stocks must have the same number of rows as its staging counterpart
-- Therefore return records where this isn't true to make the test fail
select *
from (
    select stock.id
    from "IDX-Stock"."IDX-Schema"."fact_stocks" stock
    where stock.id is null
) tmp
      
    ) dbt_internal_test
[0m16:19:45.256394 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.0 seconds
[0m16:19:45.260545 [debug] [Thread-1  ]: Timing info for test.dbt_idx.assert_stock_fact_has_no_row_loss.sql (execute): 16:19:45.154874 => 16:19:45.260167
[0m16:19:45.264602 [debug] [Thread-1  ]: On test.dbt_idx.assert_stock_fact_has_no_row_loss.sql: ROLLBACK
[0m16:19:45.268211 [debug] [Thread-1  ]: On test.dbt_idx.assert_stock_fact_has_no_row_loss.sql: Close
[0m16:19:45.272977 [info ] [Thread-1  ]: 3 of 19 PASS assert_stock_fact_has_no_row_loss.sql ............................. [[32mPASS[0m in 0.16s]
[0m16:19:45.279160 [debug] [Thread-1  ]: Finished running node test.dbt_idx.assert_stock_fact_has_no_row_loss.sql
[0m16:19:45.281538 [debug] [Thread-1  ]: Began running node test.dbt_idx.not_null_customer_orders_status_customer_id.3915c814eb
[0m16:19:45.284362 [info ] [Thread-1  ]: 4 of 19 START test not_null_customer_orders_status_customer_id ................. [RUN]
[0m16:19:45.289086 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.dbt_idx.assert_stock_fact_has_no_row_loss.sql, now test.dbt_idx.not_null_customer_orders_status_customer_id.3915c814eb)
[0m16:19:45.291988 [debug] [Thread-1  ]: Began compiling node test.dbt_idx.not_null_customer_orders_status_customer_id.3915c814eb
[0m16:19:45.311116 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_idx.not_null_customer_orders_status_customer_id.3915c814eb"
[0m16:19:45.342960 [debug] [Thread-1  ]: Timing info for test.dbt_idx.not_null_customer_orders_status_customer_id.3915c814eb (compile): 16:19:45.293906 => 16:19:45.342568
[0m16:19:45.344263 [debug] [Thread-1  ]: Began executing node test.dbt_idx.not_null_customer_orders_status_customer_id.3915c814eb
[0m16:19:45.350093 [debug] [Thread-1  ]: Writing runtime sql for node "test.dbt_idx.not_null_customer_orders_status_customer_id.3915c814eb"
[0m16:19:45.383400 [debug] [Thread-1  ]: Using postgres connection "test.dbt_idx.not_null_customer_orders_status_customer_id.3915c814eb"
[0m16:19:45.384632 [debug] [Thread-1  ]: On test.dbt_idx.not_null_customer_orders_status_customer_id.3915c814eb: BEGIN
[0m16:19:45.385873 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m16:19:45.395012 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m16:19:45.397449 [debug] [Thread-1  ]: Using postgres connection "test.dbt_idx.not_null_customer_orders_status_customer_id.3915c814eb"
[0m16:19:45.399190 [debug] [Thread-1  ]: On test.dbt_idx.not_null_customer_orders_status_customer_id.3915c814eb: /* {"app": "dbt", "dbt_version": "1.5.6", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "test.dbt_idx.not_null_customer_orders_status_customer_id.3915c814eb"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select customer_id
from "IDX-Stock"."IDX-Schema"."customer_orders_status"
where customer_id is null



      
    ) dbt_internal_test
[0m16:19:45.404160 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.0 seconds
[0m16:19:45.408863 [debug] [Thread-1  ]: Timing info for test.dbt_idx.not_null_customer_orders_status_customer_id.3915c814eb (execute): 16:19:45.345399 => 16:19:45.408533
[0m16:19:45.410096 [debug] [Thread-1  ]: On test.dbt_idx.not_null_customer_orders_status_customer_id.3915c814eb: ROLLBACK
[0m16:19:45.413604 [debug] [Thread-1  ]: On test.dbt_idx.not_null_customer_orders_status_customer_id.3915c814eb: Close
[0m16:19:45.417528 [info ] [Thread-1  ]: 4 of 19 PASS not_null_customer_orders_status_customer_id ....................... [[32mPASS[0m in 0.13s]
[0m16:19:45.421242 [debug] [Thread-1  ]: Finished running node test.dbt_idx.not_null_customer_orders_status_customer_id.3915c814eb
[0m16:19:45.423145 [debug] [Thread-1  ]: Began running node test.dbt_idx.not_null_dim_customers_customer_id.dd91cd1c8d
[0m16:19:45.425386 [info ] [Thread-1  ]: 5 of 19 START test not_null_dim_customers_customer_id .......................... [RUN]
[0m16:19:45.428238 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.dbt_idx.not_null_customer_orders_status_customer_id.3915c814eb, now test.dbt_idx.not_null_dim_customers_customer_id.dd91cd1c8d)
[0m16:19:45.430129 [debug] [Thread-1  ]: Began compiling node test.dbt_idx.not_null_dim_customers_customer_id.dd91cd1c8d
[0m16:19:45.440024 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_idx.not_null_dim_customers_customer_id.dd91cd1c8d"
[0m16:19:45.472913 [debug] [Thread-1  ]: Timing info for test.dbt_idx.not_null_dim_customers_customer_id.dd91cd1c8d (compile): 16:19:45.432617 => 16:19:45.472497
[0m16:19:45.475165 [debug] [Thread-1  ]: Began executing node test.dbt_idx.not_null_dim_customers_customer_id.dd91cd1c8d
[0m16:19:45.480481 [debug] [Thread-1  ]: Writing runtime sql for node "test.dbt_idx.not_null_dim_customers_customer_id.dd91cd1c8d"
[0m16:19:45.510430 [debug] [Thread-1  ]: Using postgres connection "test.dbt_idx.not_null_dim_customers_customer_id.dd91cd1c8d"
[0m16:19:45.512239 [debug] [Thread-1  ]: On test.dbt_idx.not_null_dim_customers_customer_id.dd91cd1c8d: BEGIN
[0m16:19:45.513860 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m16:19:45.522756 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m16:19:45.524309 [debug] [Thread-1  ]: Using postgres connection "test.dbt_idx.not_null_dim_customers_customer_id.dd91cd1c8d"
[0m16:19:45.525718 [debug] [Thread-1  ]: On test.dbt_idx.not_null_dim_customers_customer_id.dd91cd1c8d: /* {"app": "dbt", "dbt_version": "1.5.6", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "test.dbt_idx.not_null_dim_customers_customer_id.dd91cd1c8d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select customer_id
from "IDX-Stock"."IDX-Schema"."dim_customers"
where customer_id is null



      
    ) dbt_internal_test
[0m16:19:45.529067 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.0 seconds
[0m16:19:45.533875 [debug] [Thread-1  ]: Timing info for test.dbt_idx.not_null_dim_customers_customer_id.dd91cd1c8d (execute): 16:19:45.476172 => 16:19:45.533463
[0m16:19:45.535101 [debug] [Thread-1  ]: On test.dbt_idx.not_null_dim_customers_customer_id.dd91cd1c8d: ROLLBACK
[0m16:19:45.537155 [debug] [Thread-1  ]: On test.dbt_idx.not_null_dim_customers_customer_id.dd91cd1c8d: Close
[0m16:19:45.541394 [info ] [Thread-1  ]: 5 of 19 PASS not_null_dim_customers_customer_id ................................ [[32mPASS[0m in 0.11s]
[0m16:19:45.544130 [debug] [Thread-1  ]: Finished running node test.dbt_idx.not_null_dim_customers_customer_id.dd91cd1c8d
[0m16:19:45.547759 [debug] [Thread-1  ]: Began running node test.dbt_idx.not_null_fact_stocks_id.e7b7e788fa
[0m16:19:45.550637 [info ] [Thread-1  ]: 6 of 19 START test not_null_fact_stocks_id ..................................... [RUN]
[0m16:19:45.556398 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.dbt_idx.not_null_dim_customers_customer_id.dd91cd1c8d, now test.dbt_idx.not_null_fact_stocks_id.e7b7e788fa)
[0m16:19:45.558920 [debug] [Thread-1  ]: Began compiling node test.dbt_idx.not_null_fact_stocks_id.e7b7e788fa
[0m16:19:45.573169 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_idx.not_null_fact_stocks_id.e7b7e788fa"
[0m16:19:45.618353 [debug] [Thread-1  ]: Timing info for test.dbt_idx.not_null_fact_stocks_id.e7b7e788fa (compile): 16:19:45.560338 => 16:19:45.617575
[0m16:19:45.620276 [debug] [Thread-1  ]: Began executing node test.dbt_idx.not_null_fact_stocks_id.e7b7e788fa
[0m16:19:45.625861 [debug] [Thread-1  ]: Writing runtime sql for node "test.dbt_idx.not_null_fact_stocks_id.e7b7e788fa"
[0m16:19:45.670248 [debug] [Thread-1  ]: Using postgres connection "test.dbt_idx.not_null_fact_stocks_id.e7b7e788fa"
[0m16:19:45.673024 [debug] [Thread-1  ]: On test.dbt_idx.not_null_fact_stocks_id.e7b7e788fa: BEGIN
[0m16:19:45.675351 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m16:19:45.687705 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m16:19:45.690188 [debug] [Thread-1  ]: Using postgres connection "test.dbt_idx.not_null_fact_stocks_id.e7b7e788fa"
[0m16:19:45.692244 [debug] [Thread-1  ]: On test.dbt_idx.not_null_fact_stocks_id.e7b7e788fa: /* {"app": "dbt", "dbt_version": "1.5.6", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "test.dbt_idx.not_null_fact_stocks_id.e7b7e788fa"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from "IDX-Stock"."IDX-Schema"."fact_stocks"
where id is null



      
    ) dbt_internal_test
[0m16:19:45.702405 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.0 seconds
[0m16:19:45.709405 [debug] [Thread-1  ]: Timing info for test.dbt_idx.not_null_fact_stocks_id.e7b7e788fa (execute): 16:19:45.621999 => 16:19:45.708837
[0m16:19:45.711746 [debug] [Thread-1  ]: On test.dbt_idx.not_null_fact_stocks_id.e7b7e788fa: ROLLBACK
[0m16:19:45.715445 [debug] [Thread-1  ]: On test.dbt_idx.not_null_fact_stocks_id.e7b7e788fa: Close
[0m16:19:45.722746 [info ] [Thread-1  ]: 6 of 19 PASS not_null_fact_stocks_id ........................................... [[32mPASS[0m in 0.17s]
[0m16:19:45.727707 [debug] [Thread-1  ]: Finished running node test.dbt_idx.not_null_fact_stocks_id.e7b7e788fa
[0m16:19:45.731520 [debug] [Thread-1  ]: Began running node test.dbt_idx.not_null_stg_eltool__company_id.632831b79c
[0m16:19:45.734062 [info ] [Thread-1  ]: 7 of 19 START test not_null_stg_eltool__company_id ............................. [RUN]
[0m16:19:45.737394 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.dbt_idx.not_null_fact_stocks_id.e7b7e788fa, now test.dbt_idx.not_null_stg_eltool__company_id.632831b79c)
[0m16:19:45.739502 [debug] [Thread-1  ]: Began compiling node test.dbt_idx.not_null_stg_eltool__company_id.632831b79c
[0m16:19:45.752105 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_idx.not_null_stg_eltool__company_id.632831b79c"
[0m16:19:45.790237 [debug] [Thread-1  ]: Timing info for test.dbt_idx.not_null_stg_eltool__company_id.632831b79c (compile): 16:19:45.741085 => 16:19:45.789751
[0m16:19:45.791612 [debug] [Thread-1  ]: Began executing node test.dbt_idx.not_null_stg_eltool__company_id.632831b79c
[0m16:19:45.798676 [debug] [Thread-1  ]: Writing runtime sql for node "test.dbt_idx.not_null_stg_eltool__company_id.632831b79c"
[0m16:19:45.830068 [debug] [Thread-1  ]: Using postgres connection "test.dbt_idx.not_null_stg_eltool__company_id.632831b79c"
[0m16:19:45.832047 [debug] [Thread-1  ]: On test.dbt_idx.not_null_stg_eltool__company_id.632831b79c: BEGIN
[0m16:19:45.833621 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m16:19:45.849182 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m16:19:45.851808 [debug] [Thread-1  ]: Using postgres connection "test.dbt_idx.not_null_stg_eltool__company_id.632831b79c"
[0m16:19:45.854347 [debug] [Thread-1  ]: On test.dbt_idx.not_null_stg_eltool__company_id.632831b79c: /* {"app": "dbt", "dbt_version": "1.5.6", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "test.dbt_idx.not_null_stg_eltool__company_id.632831b79c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from "IDX-Stock"."IDX-Schema"."stg_eltool__company"
where id is null



      
    ) dbt_internal_test
[0m16:19:45.859199 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.0 seconds
[0m16:19:45.863534 [debug] [Thread-1  ]: Timing info for test.dbt_idx.not_null_stg_eltool__company_id.632831b79c (execute): 16:19:45.792800 => 16:19:45.863004
[0m16:19:45.865622 [debug] [Thread-1  ]: On test.dbt_idx.not_null_stg_eltool__company_id.632831b79c: ROLLBACK
[0m16:19:45.867638 [debug] [Thread-1  ]: On test.dbt_idx.not_null_stg_eltool__company_id.632831b79c: Close
[0m16:19:45.869833 [info ] [Thread-1  ]: 7 of 19 PASS not_null_stg_eltool__company_id ................................... [[32mPASS[0m in 0.13s]
[0m16:19:45.872959 [debug] [Thread-1  ]: Finished running node test.dbt_idx.not_null_stg_eltool__company_id.632831b79c
[0m16:19:45.874823 [debug] [Thread-1  ]: Began running node test.dbt_idx.not_null_stg_eltool__customers_snapshots_customer_id.ea4fc4ca86
[0m16:19:45.876628 [info ] [Thread-1  ]: 8 of 19 START test not_null_stg_eltool__customers_snapshots_customer_id ........ [RUN]
[0m16:19:45.883594 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.dbt_idx.not_null_stg_eltool__company_id.632831b79c, now test.dbt_idx.not_null_stg_eltool__customers_snapshots_customer_id.ea4fc4ca86)
[0m16:19:45.886719 [debug] [Thread-1  ]: Began compiling node test.dbt_idx.not_null_stg_eltool__customers_snapshots_customer_id.ea4fc4ca86
[0m16:19:45.903788 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_idx.not_null_stg_eltool__customers_snapshots_customer_id.ea4fc4ca86"
[0m16:19:45.940535 [debug] [Thread-1  ]: Timing info for test.dbt_idx.not_null_stg_eltool__customers_snapshots_customer_id.ea4fc4ca86 (compile): 16:19:45.888910 => 16:19:45.939873
[0m16:19:45.942563 [debug] [Thread-1  ]: Began executing node test.dbt_idx.not_null_stg_eltool__customers_snapshots_customer_id.ea4fc4ca86
[0m16:19:45.948881 [debug] [Thread-1  ]: Writing runtime sql for node "test.dbt_idx.not_null_stg_eltool__customers_snapshots_customer_id.ea4fc4ca86"
[0m16:19:45.981548 [debug] [Thread-1  ]: Using postgres connection "test.dbt_idx.not_null_stg_eltool__customers_snapshots_customer_id.ea4fc4ca86"
[0m16:19:45.983170 [debug] [Thread-1  ]: On test.dbt_idx.not_null_stg_eltool__customers_snapshots_customer_id.ea4fc4ca86: BEGIN
[0m16:19:45.984552 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m16:19:45.997171 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m16:19:46.001109 [debug] [Thread-1  ]: Using postgres connection "test.dbt_idx.not_null_stg_eltool__customers_snapshots_customer_id.ea4fc4ca86"
[0m16:19:46.003900 [debug] [Thread-1  ]: On test.dbt_idx.not_null_stg_eltool__customers_snapshots_customer_id.ea4fc4ca86: /* {"app": "dbt", "dbt_version": "1.5.6", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "test.dbt_idx.not_null_stg_eltool__customers_snapshots_customer_id.ea4fc4ca86"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select customer_id
from "IDX-Stock"."IDX-Schema"."stg_eltool__customers_snapshots"
where customer_id is null



      
    ) dbt_internal_test
[0m16:19:46.011474 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.0 seconds
[0m16:19:46.020245 [debug] [Thread-1  ]: Timing info for test.dbt_idx.not_null_stg_eltool__customers_snapshots_customer_id.ea4fc4ca86 (execute): 16:19:45.943576 => 16:19:46.019307
[0m16:19:46.023430 [debug] [Thread-1  ]: On test.dbt_idx.not_null_stg_eltool__customers_snapshots_customer_id.ea4fc4ca86: ROLLBACK
[0m16:19:46.026446 [debug] [Thread-1  ]: On test.dbt_idx.not_null_stg_eltool__customers_snapshots_customer_id.ea4fc4ca86: Close
[0m16:19:46.032216 [info ] [Thread-1  ]: 8 of 19 PASS not_null_stg_eltool__customers_snapshots_customer_id .............. [[32mPASS[0m in 0.15s]
[0m16:19:46.037534 [debug] [Thread-1  ]: Finished running node test.dbt_idx.not_null_stg_eltool__customers_snapshots_customer_id.ea4fc4ca86
[0m16:19:46.040656 [debug] [Thread-1  ]: Began running node test.dbt_idx.not_null_stg_eltool__stock_id.68f6d1d89a
[0m16:19:46.042922 [info ] [Thread-1  ]: 9 of 19 START test not_null_stg_eltool__stock_id ............................... [RUN]
[0m16:19:46.047455 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.dbt_idx.not_null_stg_eltool__customers_snapshots_customer_id.ea4fc4ca86, now test.dbt_idx.not_null_stg_eltool__stock_id.68f6d1d89a)
[0m16:19:46.049691 [debug] [Thread-1  ]: Began compiling node test.dbt_idx.not_null_stg_eltool__stock_id.68f6d1d89a
[0m16:19:46.067786 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_idx.not_null_stg_eltool__stock_id.68f6d1d89a"
[0m16:19:46.101585 [debug] [Thread-1  ]: Timing info for test.dbt_idx.not_null_stg_eltool__stock_id.68f6d1d89a (compile): 16:19:46.051218 => 16:19:46.101161
[0m16:19:46.103195 [debug] [Thread-1  ]: Began executing node test.dbt_idx.not_null_stg_eltool__stock_id.68f6d1d89a
[0m16:19:46.162862 [debug] [Thread-1  ]: Writing runtime sql for node "test.dbt_idx.not_null_stg_eltool__stock_id.68f6d1d89a"
[0m16:19:46.198008 [debug] [Thread-1  ]: Using postgres connection "test.dbt_idx.not_null_stg_eltool__stock_id.68f6d1d89a"
[0m16:19:46.199916 [debug] [Thread-1  ]: On test.dbt_idx.not_null_stg_eltool__stock_id.68f6d1d89a: BEGIN
[0m16:19:46.201075 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m16:19:46.211907 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m16:19:46.214948 [debug] [Thread-1  ]: Using postgres connection "test.dbt_idx.not_null_stg_eltool__stock_id.68f6d1d89a"
[0m16:19:46.217320 [debug] [Thread-1  ]: On test.dbt_idx.not_null_stg_eltool__stock_id.68f6d1d89a: /* {"app": "dbt", "dbt_version": "1.5.6", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "test.dbt_idx.not_null_stg_eltool__stock_id.68f6d1d89a"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from "IDX-Stock"."IDX-Schema"."stg_eltool__stock"
where id is null



      
    ) dbt_internal_test
[0m16:19:46.231230 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.0 seconds
[0m16:19:46.237737 [debug] [Thread-1  ]: Timing info for test.dbt_idx.not_null_stg_eltool__stock_id.68f6d1d89a (execute): 16:19:46.104653 => 16:19:46.237140
[0m16:19:46.240457 [debug] [Thread-1  ]: On test.dbt_idx.not_null_stg_eltool__stock_id.68f6d1d89a: ROLLBACK
[0m16:19:46.243174 [debug] [Thread-1  ]: On test.dbt_idx.not_null_stg_eltool__stock_id.68f6d1d89a: Close
[0m16:19:46.247926 [info ] [Thread-1  ]: 9 of 19 PASS not_null_stg_eltool__stock_id ..................................... [[32mPASS[0m in 0.20s]
[0m16:19:46.253011 [debug] [Thread-1  ]: Finished running node test.dbt_idx.not_null_stg_eltool__stock_id.68f6d1d89a
[0m16:19:46.255483 [debug] [Thread-1  ]: Began running node test.dbt_idx.not_null_stock_update_status_id.633bc8afe3
[0m16:19:46.257212 [info ] [Thread-1  ]: 10 of 19 START test not_null_stock_update_status_id ............................ [RUN]
[0m16:19:46.261030 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.dbt_idx.not_null_stg_eltool__stock_id.68f6d1d89a, now test.dbt_idx.not_null_stock_update_status_id.633bc8afe3)
[0m16:19:46.263004 [debug] [Thread-1  ]: Began compiling node test.dbt_idx.not_null_stock_update_status_id.633bc8afe3
[0m16:19:46.276563 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_idx.not_null_stock_update_status_id.633bc8afe3"
[0m16:19:46.318078 [debug] [Thread-1  ]: Timing info for test.dbt_idx.not_null_stock_update_status_id.633bc8afe3 (compile): 16:19:46.266001 => 16:19:46.317661
[0m16:19:46.319827 [debug] [Thread-1  ]: Began executing node test.dbt_idx.not_null_stock_update_status_id.633bc8afe3
[0m16:19:46.326083 [debug] [Thread-1  ]: Writing runtime sql for node "test.dbt_idx.not_null_stock_update_status_id.633bc8afe3"
[0m16:19:46.366220 [debug] [Thread-1  ]: Using postgres connection "test.dbt_idx.not_null_stock_update_status_id.633bc8afe3"
[0m16:19:46.367427 [debug] [Thread-1  ]: On test.dbt_idx.not_null_stock_update_status_id.633bc8afe3: BEGIN
[0m16:19:46.368390 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m16:19:46.381727 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m16:19:46.383666 [debug] [Thread-1  ]: Using postgres connection "test.dbt_idx.not_null_stock_update_status_id.633bc8afe3"
[0m16:19:46.385307 [debug] [Thread-1  ]: On test.dbt_idx.not_null_stock_update_status_id.633bc8afe3: /* {"app": "dbt", "dbt_version": "1.5.6", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "test.dbt_idx.not_null_stock_update_status_id.633bc8afe3"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from "IDX-Stock"."IDX-Schema"."stock_update_status"
where id is null



      
    ) dbt_internal_test
[0m16:19:46.403285 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.0 seconds
[0m16:19:46.408386 [debug] [Thread-1  ]: Timing info for test.dbt_idx.not_null_stock_update_status_id.633bc8afe3 (execute): 16:19:46.321513 => 16:19:46.407485
[0m16:19:46.411110 [debug] [Thread-1  ]: On test.dbt_idx.not_null_stock_update_status_id.633bc8afe3: ROLLBACK
[0m16:19:46.414772 [debug] [Thread-1  ]: On test.dbt_idx.not_null_stock_update_status_id.633bc8afe3: Close
[0m16:19:46.419236 [info ] [Thread-1  ]: 10 of 19 PASS not_null_stock_update_status_id .................................. [[32mPASS[0m in 0.16s]
[0m16:19:46.423839 [debug] [Thread-1  ]: Finished running node test.dbt_idx.not_null_stock_update_status_id.633bc8afe3
[0m16:19:46.425882 [debug] [Thread-1  ]: Began running node test.dbt_idx.source_not_null_IDX-Schema_customers_customer_id.8525798d49
[0m16:19:46.427389 [info ] [Thread-1  ]: 11 of 19 START test source_not_null_IDX-Schema_customers_customer_id ........... [RUN]
[0m16:19:46.430772 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.dbt_idx.not_null_stock_update_status_id.633bc8afe3, now test.dbt_idx.source_not_null_IDX-Schema_customers_customer_id.8525798d49)
[0m16:19:46.433548 [debug] [Thread-1  ]: Began compiling node test.dbt_idx.source_not_null_IDX-Schema_customers_customer_id.8525798d49
[0m16:19:46.444130 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_idx.source_not_null_IDX-Schema_customers_customer_id.8525798d49"
[0m16:19:46.473568 [debug] [Thread-1  ]: Timing info for test.dbt_idx.source_not_null_IDX-Schema_customers_customer_id.8525798d49 (compile): 16:19:46.434956 => 16:19:46.473168
[0m16:19:46.474538 [debug] [Thread-1  ]: Began executing node test.dbt_idx.source_not_null_IDX-Schema_customers_customer_id.8525798d49
[0m16:19:46.478618 [debug] [Thread-1  ]: Writing runtime sql for node "test.dbt_idx.source_not_null_IDX-Schema_customers_customer_id.8525798d49"
[0m16:19:46.500506 [debug] [Thread-1  ]: Using postgres connection "test.dbt_idx.source_not_null_IDX-Schema_customers_customer_id.8525798d49"
[0m16:19:46.501605 [debug] [Thread-1  ]: On test.dbt_idx.source_not_null_IDX-Schema_customers_customer_id.8525798d49: BEGIN
[0m16:19:46.502667 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m16:19:46.511709 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m16:19:46.514368 [debug] [Thread-1  ]: Using postgres connection "test.dbt_idx.source_not_null_IDX-Schema_customers_customer_id.8525798d49"
[0m16:19:46.516140 [debug] [Thread-1  ]: On test.dbt_idx.source_not_null_IDX-Schema_customers_customer_id.8525798d49: /* {"app": "dbt", "dbt_version": "1.5.6", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "test.dbt_idx.source_not_null_IDX-Schema_customers_customer_id.8525798d49"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select customer_id
from "IDX-Stock"."IDX-Schema"."customers"
where customer_id is null



      
    ) dbt_internal_test
[0m16:19:46.519343 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.0 seconds
[0m16:19:46.526351 [debug] [Thread-1  ]: Timing info for test.dbt_idx.source_not_null_IDX-Schema_customers_customer_id.8525798d49 (execute): 16:19:46.475245 => 16:19:46.525933
[0m16:19:46.528490 [debug] [Thread-1  ]: On test.dbt_idx.source_not_null_IDX-Schema_customers_customer_id.8525798d49: ROLLBACK
[0m16:19:46.531854 [debug] [Thread-1  ]: On test.dbt_idx.source_not_null_IDX-Schema_customers_customer_id.8525798d49: Close
[0m16:19:46.535073 [info ] [Thread-1  ]: 11 of 19 PASS source_not_null_IDX-Schema_customers_customer_id ................. [[32mPASS[0m in 0.11s]
[0m16:19:46.538592 [debug] [Thread-1  ]: Finished running node test.dbt_idx.source_not_null_IDX-Schema_customers_customer_id.8525798d49
[0m16:19:46.541199 [debug] [Thread-1  ]: Began running node test.dbt_idx.source_not_null_IDX-Schema_ksql-company-stream_id.d088b78209
[0m16:19:46.542897 [info ] [Thread-1  ]: 12 of 19 START test source_not_null_IDX-Schema_ksql-company-stream_id .......... [RUN]
[0m16:19:46.545163 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.dbt_idx.source_not_null_IDX-Schema_customers_customer_id.8525798d49, now test.dbt_idx.source_not_null_IDX-Schema_ksql-company-stream_id.d088b78209)
[0m16:19:46.546887 [debug] [Thread-1  ]: Began compiling node test.dbt_idx.source_not_null_IDX-Schema_ksql-company-stream_id.d088b78209
[0m16:19:46.558657 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_idx.source_not_null_IDX-Schema_ksql-company-stream_id.d088b78209"
[0m16:19:46.609457 [debug] [Thread-1  ]: Timing info for test.dbt_idx.source_not_null_IDX-Schema_ksql-company-stream_id.d088b78209 (compile): 16:19:46.549210 => 16:19:46.608367
[0m16:19:46.612100 [debug] [Thread-1  ]: Began executing node test.dbt_idx.source_not_null_IDX-Schema_ksql-company-stream_id.d088b78209
[0m16:19:46.621998 [debug] [Thread-1  ]: Writing runtime sql for node "test.dbt_idx.source_not_null_IDX-Schema_ksql-company-stream_id.d088b78209"
[0m16:19:46.650121 [debug] [Thread-1  ]: Using postgres connection "test.dbt_idx.source_not_null_IDX-Schema_ksql-company-stream_id.d088b78209"
[0m16:19:46.651350 [debug] [Thread-1  ]: On test.dbt_idx.source_not_null_IDX-Schema_ksql-company-stream_id.d088b78209: BEGIN
[0m16:19:46.652847 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m16:19:46.664479 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m16:19:46.666576 [debug] [Thread-1  ]: Using postgres connection "test.dbt_idx.source_not_null_IDX-Schema_ksql-company-stream_id.d088b78209"
[0m16:19:46.668068 [debug] [Thread-1  ]: On test.dbt_idx.source_not_null_IDX-Schema_ksql-company-stream_id.d088b78209: /* {"app": "dbt", "dbt_version": "1.5.6", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "test.dbt_idx.source_not_null_IDX-Schema_ksql-company-stream_id.d088b78209"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from "IDX-Stock"."IDX-Schema"."ksql-company-stream"
where id is null



      
    ) dbt_internal_test
[0m16:19:46.671997 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.0 seconds
[0m16:19:46.677101 [debug] [Thread-1  ]: Timing info for test.dbt_idx.source_not_null_IDX-Schema_ksql-company-stream_id.d088b78209 (execute): 16:19:46.614320 => 16:19:46.676650
[0m16:19:46.679709 [debug] [Thread-1  ]: On test.dbt_idx.source_not_null_IDX-Schema_ksql-company-stream_id.d088b78209: ROLLBACK
[0m16:19:46.682894 [debug] [Thread-1  ]: On test.dbt_idx.source_not_null_IDX-Schema_ksql-company-stream_id.d088b78209: Close
[0m16:19:46.686698 [info ] [Thread-1  ]: 12 of 19 PASS source_not_null_IDX-Schema_ksql-company-stream_id ................ [[32mPASS[0m in 0.14s]
[0m16:19:46.691371 [debug] [Thread-1  ]: Finished running node test.dbt_idx.source_not_null_IDX-Schema_ksql-company-stream_id.d088b78209
[0m16:19:46.693399 [debug] [Thread-1  ]: Began running node test.dbt_idx.source_not_null_IDX-Schema_ksql-stock-stream_id.b3b44ecba6
[0m16:19:46.697107 [info ] [Thread-1  ]: 13 of 19 START test source_not_null_IDX-Schema_ksql-stock-stream_id ............ [RUN]
[0m16:19:46.701821 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.dbt_idx.source_not_null_IDX-Schema_ksql-company-stream_id.d088b78209, now test.dbt_idx.source_not_null_IDX-Schema_ksql-stock-stream_id.b3b44ecba6)
[0m16:19:46.703980 [debug] [Thread-1  ]: Began compiling node test.dbt_idx.source_not_null_IDX-Schema_ksql-stock-stream_id.b3b44ecba6
[0m16:19:46.715923 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_idx.source_not_null_IDX-Schema_ksql-stock-stream_id.b3b44ecba6"
[0m16:19:46.743220 [debug] [Thread-1  ]: Timing info for test.dbt_idx.source_not_null_IDX-Schema_ksql-stock-stream_id.b3b44ecba6 (compile): 16:19:46.705947 => 16:19:46.742626
[0m16:19:46.744906 [debug] [Thread-1  ]: Began executing node test.dbt_idx.source_not_null_IDX-Schema_ksql-stock-stream_id.b3b44ecba6
[0m16:19:46.750589 [debug] [Thread-1  ]: Writing runtime sql for node "test.dbt_idx.source_not_null_IDX-Schema_ksql-stock-stream_id.b3b44ecba6"
[0m16:19:46.774688 [debug] [Thread-1  ]: Using postgres connection "test.dbt_idx.source_not_null_IDX-Schema_ksql-stock-stream_id.b3b44ecba6"
[0m16:19:46.775725 [debug] [Thread-1  ]: On test.dbt_idx.source_not_null_IDX-Schema_ksql-stock-stream_id.b3b44ecba6: BEGIN
[0m16:19:46.776576 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m16:19:46.786292 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m16:19:46.788404 [debug] [Thread-1  ]: Using postgres connection "test.dbt_idx.source_not_null_IDX-Schema_ksql-stock-stream_id.b3b44ecba6"
[0m16:19:46.789821 [debug] [Thread-1  ]: On test.dbt_idx.source_not_null_IDX-Schema_ksql-stock-stream_id.b3b44ecba6: /* {"app": "dbt", "dbt_version": "1.5.6", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "test.dbt_idx.source_not_null_IDX-Schema_ksql-stock-stream_id.b3b44ecba6"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from "IDX-Stock"."IDX-Schema"."ksql-stock-stream"
where id is null



      
    ) dbt_internal_test
[0m16:19:46.797455 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.0 seconds
[0m16:19:46.800752 [debug] [Thread-1  ]: Timing info for test.dbt_idx.source_not_null_IDX-Schema_ksql-stock-stream_id.b3b44ecba6 (execute): 16:19:46.746370 => 16:19:46.800438
[0m16:19:46.801856 [debug] [Thread-1  ]: On test.dbt_idx.source_not_null_IDX-Schema_ksql-stock-stream_id.b3b44ecba6: ROLLBACK
[0m16:19:46.805469 [debug] [Thread-1  ]: On test.dbt_idx.source_not_null_IDX-Schema_ksql-stock-stream_id.b3b44ecba6: Close
[0m16:19:46.809054 [info ] [Thread-1  ]: 13 of 19 PASS source_not_null_IDX-Schema_ksql-stock-stream_id .................. [[32mPASS[0m in 0.11s]
[0m16:19:46.816727 [debug] [Thread-1  ]: Finished running node test.dbt_idx.source_not_null_IDX-Schema_ksql-stock-stream_id.b3b44ecba6
[0m16:19:46.818720 [debug] [Thread-1  ]: Began running node test.dbt_idx.source_not_null_IDX-Schema_orders_order_id.f2383dcca5
[0m16:19:46.821535 [info ] [Thread-1  ]: 14 of 19 START test source_not_null_IDX-Schema_orders_order_id ................. [RUN]
[0m16:19:46.824862 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.dbt_idx.source_not_null_IDX-Schema_ksql-stock-stream_id.b3b44ecba6, now test.dbt_idx.source_not_null_IDX-Schema_orders_order_id.f2383dcca5)
[0m16:19:46.827573 [debug] [Thread-1  ]: Began compiling node test.dbt_idx.source_not_null_IDX-Schema_orders_order_id.f2383dcca5
[0m16:19:46.842335 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_idx.source_not_null_IDX-Schema_orders_order_id.f2383dcca5"
[0m16:19:46.867184 [debug] [Thread-1  ]: Timing info for test.dbt_idx.source_not_null_IDX-Schema_orders_order_id.f2383dcca5 (compile): 16:19:46.829596 => 16:19:46.866591
[0m16:19:46.868362 [debug] [Thread-1  ]: Began executing node test.dbt_idx.source_not_null_IDX-Schema_orders_order_id.f2383dcca5
[0m16:19:46.873554 [debug] [Thread-1  ]: Writing runtime sql for node "test.dbt_idx.source_not_null_IDX-Schema_orders_order_id.f2383dcca5"
[0m16:19:46.901245 [debug] [Thread-1  ]: Using postgres connection "test.dbt_idx.source_not_null_IDX-Schema_orders_order_id.f2383dcca5"
[0m16:19:46.902574 [debug] [Thread-1  ]: On test.dbt_idx.source_not_null_IDX-Schema_orders_order_id.f2383dcca5: BEGIN
[0m16:19:46.903762 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m16:19:46.921649 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m16:19:46.924248 [debug] [Thread-1  ]: Using postgres connection "test.dbt_idx.source_not_null_IDX-Schema_orders_order_id.f2383dcca5"
[0m16:19:46.926605 [debug] [Thread-1  ]: On test.dbt_idx.source_not_null_IDX-Schema_orders_order_id.f2383dcca5: /* {"app": "dbt", "dbt_version": "1.5.6", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "test.dbt_idx.source_not_null_IDX-Schema_orders_order_id.f2383dcca5"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select order_id
from "IDX-Stock"."IDX-Schema"."orders"
where order_id is null



      
    ) dbt_internal_test
[0m16:19:46.933711 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.0 seconds
[0m16:19:46.942404 [debug] [Thread-1  ]: Timing info for test.dbt_idx.source_not_null_IDX-Schema_orders_order_id.f2383dcca5 (execute): 16:19:46.869509 => 16:19:46.941284
[0m16:19:46.945795 [debug] [Thread-1  ]: On test.dbt_idx.source_not_null_IDX-Schema_orders_order_id.f2383dcca5: ROLLBACK
[0m16:19:46.948820 [debug] [Thread-1  ]: On test.dbt_idx.source_not_null_IDX-Schema_orders_order_id.f2383dcca5: Close
[0m16:19:46.952141 [info ] [Thread-1  ]: 14 of 19 PASS source_not_null_IDX-Schema_orders_order_id ....................... [[32mPASS[0m in 0.13s]
[0m16:19:46.959676 [debug] [Thread-1  ]: Finished running node test.dbt_idx.source_not_null_IDX-Schema_orders_order_id.f2383dcca5
[0m16:19:46.964312 [debug] [Thread-1  ]: Began running node test.dbt_idx.source_relationships_IDX-Schema_orders_cust_id__customer_id__source_IDX_Schema_customers_.dc582657bc
[0m16:19:46.967400 [info ] [Thread-1  ]: 15 of 19 START test source_relationships_IDX-Schema_orders_cust_id__customer_id__source_IDX_Schema_customers_  [RUN]
[0m16:19:46.971188 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.dbt_idx.source_not_null_IDX-Schema_orders_order_id.f2383dcca5, now test.dbt_idx.source_relationships_IDX-Schema_orders_cust_id__customer_id__source_IDX_Schema_customers_.dc582657bc)
[0m16:19:46.973356 [debug] [Thread-1  ]: Began compiling node test.dbt_idx.source_relationships_IDX-Schema_orders_cust_id__customer_id__source_IDX_Schema_customers_.dc582657bc
[0m16:19:47.002412 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_idx.source_relationships_IDX-Schema_orders_cust_id__customer_id__source_IDX_Schema_customers_.dc582657bc"
[0m16:19:47.031025 [debug] [Thread-1  ]: Timing info for test.dbt_idx.source_relationships_IDX-Schema_orders_cust_id__customer_id__source_IDX_Schema_customers_.dc582657bc (compile): 16:19:46.974312 => 16:19:47.030482
[0m16:19:47.032235 [debug] [Thread-1  ]: Began executing node test.dbt_idx.source_relationships_IDX-Schema_orders_cust_id__customer_id__source_IDX_Schema_customers_.dc582657bc
[0m16:19:47.039398 [debug] [Thread-1  ]: Writing runtime sql for node "test.dbt_idx.source_relationships_IDX-Schema_orders_cust_id__customer_id__source_IDX_Schema_customers_.dc582657bc"
[0m16:19:47.064452 [debug] [Thread-1  ]: Using postgres connection "test.dbt_idx.source_relationships_IDX-Schema_orders_cust_id__customer_id__source_IDX_Schema_customers_.dc582657bc"
[0m16:19:47.065588 [debug] [Thread-1  ]: On test.dbt_idx.source_relationships_IDX-Schema_orders_cust_id__customer_id__source_IDX_Schema_customers_.dc582657bc: BEGIN
[0m16:19:47.066531 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m16:19:47.075521 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m16:19:47.077002 [debug] [Thread-1  ]: Using postgres connection "test.dbt_idx.source_relationships_IDX-Schema_orders_cust_id__customer_id__source_IDX_Schema_customers_.dc582657bc"
[0m16:19:47.079702 [debug] [Thread-1  ]: On test.dbt_idx.source_relationships_IDX-Schema_orders_cust_id__customer_id__source_IDX_Schema_customers_.dc582657bc: /* {"app": "dbt", "dbt_version": "1.5.6", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "test.dbt_idx.source_relationships_IDX-Schema_orders_cust_id__customer_id__source_IDX_Schema_customers_.dc582657bc"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select cust_id as from_field
    from "IDX-Stock"."IDX-Schema"."orders"
    where cust_id is not null
),

parent as (
    select customer_id as to_field
    from "IDX-Stock"."IDX-Schema"."customers"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m16:19:47.084331 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.0 seconds
[0m16:19:47.089394 [debug] [Thread-1  ]: Timing info for test.dbt_idx.source_relationships_IDX-Schema_orders_cust_id__customer_id__source_IDX_Schema_customers_.dc582657bc (execute): 16:19:47.033155 => 16:19:47.088731
[0m16:19:47.093184 [debug] [Thread-1  ]: On test.dbt_idx.source_relationships_IDX-Schema_orders_cust_id__customer_id__source_IDX_Schema_customers_.dc582657bc: ROLLBACK
[0m16:19:47.097097 [debug] [Thread-1  ]: On test.dbt_idx.source_relationships_IDX-Schema_orders_cust_id__customer_id__source_IDX_Schema_customers_.dc582657bc: Close
[0m16:19:47.101687 [info ] [Thread-1  ]: 15 of 19 PASS source_relationships_IDX-Schema_orders_cust_id__customer_id__source_IDX_Schema_customers_  [[32mPASS[0m in 0.13s]
[0m16:19:47.106290 [debug] [Thread-1  ]: Finished running node test.dbt_idx.source_relationships_IDX-Schema_orders_cust_id__customer_id__source_IDX_Schema_customers_.dc582657bc
[0m16:19:47.108337 [debug] [Thread-1  ]: Began running node test.dbt_idx.source_unique_IDX-Schema_ksql-company-stream_id.09232074f4
[0m16:19:47.109821 [info ] [Thread-1  ]: 16 of 19 START test source_unique_IDX-Schema_ksql-company-stream_id ............ [RUN]
[0m16:19:47.113691 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.dbt_idx.source_relationships_IDX-Schema_orders_cust_id__customer_id__source_IDX_Schema_customers_.dc582657bc, now test.dbt_idx.source_unique_IDX-Schema_ksql-company-stream_id.09232074f4)
[0m16:19:47.115907 [debug] [Thread-1  ]: Began compiling node test.dbt_idx.source_unique_IDX-Schema_ksql-company-stream_id.09232074f4
[0m16:19:47.134399 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_idx.source_unique_IDX-Schema_ksql-company-stream_id.09232074f4"
[0m16:19:47.168861 [debug] [Thread-1  ]: Timing info for test.dbt_idx.source_unique_IDX-Schema_ksql-company-stream_id.09232074f4 (compile): 16:19:47.118002 => 16:19:47.168070
[0m16:19:47.171536 [debug] [Thread-1  ]: Began executing node test.dbt_idx.source_unique_IDX-Schema_ksql-company-stream_id.09232074f4
[0m16:19:47.181757 [debug] [Thread-1  ]: Writing runtime sql for node "test.dbt_idx.source_unique_IDX-Schema_ksql-company-stream_id.09232074f4"
[0m16:19:47.218678 [debug] [Thread-1  ]: Using postgres connection "test.dbt_idx.source_unique_IDX-Schema_ksql-company-stream_id.09232074f4"
[0m16:19:47.222023 [debug] [Thread-1  ]: On test.dbt_idx.source_unique_IDX-Schema_ksql-company-stream_id.09232074f4: BEGIN
[0m16:19:47.224588 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m16:19:47.238099 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m16:19:47.240195 [debug] [Thread-1  ]: Using postgres connection "test.dbt_idx.source_unique_IDX-Schema_ksql-company-stream_id.09232074f4"
[0m16:19:47.242559 [debug] [Thread-1  ]: On test.dbt_idx.source_unique_IDX-Schema_ksql-company-stream_id.09232074f4: /* {"app": "dbt", "dbt_version": "1.5.6", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "test.dbt_idx.source_unique_IDX-Schema_ksql-company-stream_id.09232074f4"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from "IDX-Stock"."IDX-Schema"."ksql-company-stream"
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
[0m16:19:47.250331 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.0 seconds
[0m16:19:47.258799 [debug] [Thread-1  ]: Timing info for test.dbt_idx.source_unique_IDX-Schema_ksql-company-stream_id.09232074f4 (execute): 16:19:47.173518 => 16:19:47.257345
[0m16:19:47.262887 [debug] [Thread-1  ]: On test.dbt_idx.source_unique_IDX-Schema_ksql-company-stream_id.09232074f4: ROLLBACK
[0m16:19:47.269877 [debug] [Thread-1  ]: On test.dbt_idx.source_unique_IDX-Schema_ksql-company-stream_id.09232074f4: Close
[0m16:19:47.275757 [info ] [Thread-1  ]: 16 of 19 PASS source_unique_IDX-Schema_ksql-company-stream_id .................. [[32mPASS[0m in 0.16s]
[0m16:19:47.284864 [debug] [Thread-1  ]: Finished running node test.dbt_idx.source_unique_IDX-Schema_ksql-company-stream_id.09232074f4
[0m16:19:47.288563 [debug] [Thread-1  ]: Began running node test.dbt_idx.source_unique_IDX-Schema_ksql-stock-stream_id.2119c5c33b
[0m16:19:47.293657 [info ] [Thread-1  ]: 17 of 19 START test source_unique_IDX-Schema_ksql-stock-stream_id .............. [RUN]
[0m16:19:47.299898 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.dbt_idx.source_unique_IDX-Schema_ksql-company-stream_id.09232074f4, now test.dbt_idx.source_unique_IDX-Schema_ksql-stock-stream_id.2119c5c33b)
[0m16:19:47.306088 [debug] [Thread-1  ]: Began compiling node test.dbt_idx.source_unique_IDX-Schema_ksql-stock-stream_id.2119c5c33b
[0m16:19:47.328930 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_idx.source_unique_IDX-Schema_ksql-stock-stream_id.2119c5c33b"
[0m16:19:47.361336 [debug] [Thread-1  ]: Timing info for test.dbt_idx.source_unique_IDX-Schema_ksql-stock-stream_id.2119c5c33b (compile): 16:19:47.310411 => 16:19:47.360550
[0m16:19:47.362827 [debug] [Thread-1  ]: Began executing node test.dbt_idx.source_unique_IDX-Schema_ksql-stock-stream_id.2119c5c33b
[0m16:19:47.368191 [debug] [Thread-1  ]: Writing runtime sql for node "test.dbt_idx.source_unique_IDX-Schema_ksql-stock-stream_id.2119c5c33b"
[0m16:19:47.397365 [debug] [Thread-1  ]: Using postgres connection "test.dbt_idx.source_unique_IDX-Schema_ksql-stock-stream_id.2119c5c33b"
[0m16:19:47.399297 [debug] [Thread-1  ]: On test.dbt_idx.source_unique_IDX-Schema_ksql-stock-stream_id.2119c5c33b: BEGIN
[0m16:19:47.401021 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m16:19:47.413202 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m16:19:47.415924 [debug] [Thread-1  ]: Using postgres connection "test.dbt_idx.source_unique_IDX-Schema_ksql-stock-stream_id.2119c5c33b"
[0m16:19:47.418261 [debug] [Thread-1  ]: On test.dbt_idx.source_unique_IDX-Schema_ksql-stock-stream_id.2119c5c33b: /* {"app": "dbt", "dbt_version": "1.5.6", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "test.dbt_idx.source_unique_IDX-Schema_ksql-stock-stream_id.2119c5c33b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from "IDX-Stock"."IDX-Schema"."ksql-stock-stream"
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
[0m16:19:47.447015 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.0 seconds
[0m16:19:47.452076 [debug] [Thread-1  ]: Timing info for test.dbt_idx.source_unique_IDX-Schema_ksql-stock-stream_id.2119c5c33b (execute): 16:19:47.364038 => 16:19:47.451458
[0m16:19:47.454771 [debug] [Thread-1  ]: On test.dbt_idx.source_unique_IDX-Schema_ksql-stock-stream_id.2119c5c33b: ROLLBACK
[0m16:19:47.456648 [debug] [Thread-1  ]: On test.dbt_idx.source_unique_IDX-Schema_ksql-stock-stream_id.2119c5c33b: Close
[0m16:19:47.459372 [info ] [Thread-1  ]: 17 of 19 PASS source_unique_IDX-Schema_ksql-stock-stream_id .................... [[32mPASS[0m in 0.16s]
[0m16:19:47.462910 [debug] [Thread-1  ]: Finished running node test.dbt_idx.source_unique_IDX-Schema_ksql-stock-stream_id.2119c5c33b
[0m16:19:47.466412 [debug] [Thread-1  ]: Began running node test.dbt_idx.source_unique_IDX-Schema_orders_order_id.5a8ef486ee
[0m16:19:47.469637 [info ] [Thread-1  ]: 18 of 19 START test source_unique_IDX-Schema_orders_order_id ................... [RUN]
[0m16:19:47.474647 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.dbt_idx.source_unique_IDX-Schema_ksql-stock-stream_id.2119c5c33b, now test.dbt_idx.source_unique_IDX-Schema_orders_order_id.5a8ef486ee)
[0m16:19:47.476688 [debug] [Thread-1  ]: Began compiling node test.dbt_idx.source_unique_IDX-Schema_orders_order_id.5a8ef486ee
[0m16:19:47.491200 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_idx.source_unique_IDX-Schema_orders_order_id.5a8ef486ee"
[0m16:19:47.522841 [debug] [Thread-1  ]: Timing info for test.dbt_idx.source_unique_IDX-Schema_orders_order_id.5a8ef486ee (compile): 16:19:47.479113 => 16:19:47.522302
[0m16:19:47.524257 [debug] [Thread-1  ]: Began executing node test.dbt_idx.source_unique_IDX-Schema_orders_order_id.5a8ef486ee
[0m16:19:47.531249 [debug] [Thread-1  ]: Writing runtime sql for node "test.dbt_idx.source_unique_IDX-Schema_orders_order_id.5a8ef486ee"
[0m16:19:47.563390 [debug] [Thread-1  ]: Using postgres connection "test.dbt_idx.source_unique_IDX-Schema_orders_order_id.5a8ef486ee"
[0m16:19:47.567595 [debug] [Thread-1  ]: On test.dbt_idx.source_unique_IDX-Schema_orders_order_id.5a8ef486ee: BEGIN
[0m16:19:47.569026 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m16:19:47.579931 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m16:19:47.581879 [debug] [Thread-1  ]: Using postgres connection "test.dbt_idx.source_unique_IDX-Schema_orders_order_id.5a8ef486ee"
[0m16:19:47.583278 [debug] [Thread-1  ]: On test.dbt_idx.source_unique_IDX-Schema_orders_order_id.5a8ef486ee: /* {"app": "dbt", "dbt_version": "1.5.6", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "test.dbt_idx.source_unique_IDX-Schema_orders_order_id.5a8ef486ee"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    order_id as unique_field,
    count(*) as n_records

from "IDX-Stock"."IDX-Schema"."orders"
where order_id is not null
group by order_id
having count(*) > 1



      
    ) dbt_internal_test
[0m16:19:47.589672 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.0 seconds
[0m16:19:47.593240 [debug] [Thread-1  ]: Timing info for test.dbt_idx.source_unique_IDX-Schema_orders_order_id.5a8ef486ee (execute): 16:19:47.525433 => 16:19:47.592865
[0m16:19:47.596542 [debug] [Thread-1  ]: On test.dbt_idx.source_unique_IDX-Schema_orders_order_id.5a8ef486ee: ROLLBACK
[0m16:19:47.599232 [debug] [Thread-1  ]: On test.dbt_idx.source_unique_IDX-Schema_orders_order_id.5a8ef486ee: Close
[0m16:19:47.603326 [info ] [Thread-1  ]: 18 of 19 PASS source_unique_IDX-Schema_orders_order_id ......................... [[32mPASS[0m in 0.13s]
[0m16:19:47.605892 [debug] [Thread-1  ]: Finished running node test.dbt_idx.source_unique_IDX-Schema_orders_order_id.5a8ef486ee
[0m16:19:47.607655 [debug] [Thread-1  ]: Began running node test.dbt_idx.unique_customer_orders_status_order_id.b7a45e83ee
[0m16:19:47.609297 [info ] [Thread-1  ]: 19 of 19 START test unique_customer_orders_status_order_id ..................... [RUN]
[0m16:19:47.613696 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.dbt_idx.source_unique_IDX-Schema_orders_order_id.5a8ef486ee, now test.dbt_idx.unique_customer_orders_status_order_id.b7a45e83ee)
[0m16:19:47.615512 [debug] [Thread-1  ]: Began compiling node test.dbt_idx.unique_customer_orders_status_order_id.b7a45e83ee
[0m16:19:47.627735 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_idx.unique_customer_orders_status_order_id.b7a45e83ee"
[0m16:19:47.657185 [debug] [Thread-1  ]: Timing info for test.dbt_idx.unique_customer_orders_status_order_id.b7a45e83ee (compile): 16:19:47.617944 => 16:19:47.656782
[0m16:19:47.658499 [debug] [Thread-1  ]: Began executing node test.dbt_idx.unique_customer_orders_status_order_id.b7a45e83ee
[0m16:19:47.663900 [debug] [Thread-1  ]: Writing runtime sql for node "test.dbt_idx.unique_customer_orders_status_order_id.b7a45e83ee"
[0m16:19:47.689866 [debug] [Thread-1  ]: Using postgres connection "test.dbt_idx.unique_customer_orders_status_order_id.b7a45e83ee"
[0m16:19:47.691027 [debug] [Thread-1  ]: On test.dbt_idx.unique_customer_orders_status_order_id.b7a45e83ee: BEGIN
[0m16:19:47.691932 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m16:19:47.701311 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m16:19:47.703355 [debug] [Thread-1  ]: Using postgres connection "test.dbt_idx.unique_customer_orders_status_order_id.b7a45e83ee"
[0m16:19:47.705410 [debug] [Thread-1  ]: On test.dbt_idx.unique_customer_orders_status_order_id.b7a45e83ee: /* {"app": "dbt", "dbt_version": "1.5.6", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "test.dbt_idx.unique_customer_orders_status_order_id.b7a45e83ee"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    order_id as unique_field,
    count(*) as n_records

from "IDX-Stock"."IDX-Schema"."customer_orders_status"
where order_id is not null
group by order_id
having count(*) > 1



      
    ) dbt_internal_test
[0m16:19:47.712365 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.0 seconds
[0m16:19:47.716221 [debug] [Thread-1  ]: Timing info for test.dbt_idx.unique_customer_orders_status_order_id.b7a45e83ee (execute): 16:19:47.659475 => 16:19:47.715891
[0m16:19:47.717299 [debug] [Thread-1  ]: On test.dbt_idx.unique_customer_orders_status_order_id.b7a45e83ee: ROLLBACK
[0m16:19:47.718512 [debug] [Thread-1  ]: On test.dbt_idx.unique_customer_orders_status_order_id.b7a45e83ee: Close
[0m16:19:47.723554 [info ] [Thread-1  ]: 19 of 19 PASS unique_customer_orders_status_order_id ........................... [[32mPASS[0m in 0.11s]
[0m16:19:47.727112 [debug] [Thread-1  ]: Finished running node test.dbt_idx.unique_customer_orders_status_order_id.b7a45e83ee
[0m16:19:47.796816 [debug] [MainThread]: Using postgres connection "master"
[0m16:19:47.797936 [debug] [MainThread]: On master: BEGIN
[0m16:19:47.798911 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:19:47.808260 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m16:19:47.810043 [debug] [MainThread]: On master: COMMIT
[0m16:19:47.812466 [debug] [MainThread]: Using postgres connection "master"
[0m16:19:47.814647 [debug] [MainThread]: On master: COMMIT
[0m16:19:47.816908 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m16:19:47.819110 [debug] [MainThread]: On master: Close
[0m16:19:47.822357 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:19:47.824145 [debug] [MainThread]: Connection 'test.dbt_idx.unique_customer_orders_status_order_id.b7a45e83ee' was properly closed.
[0m16:19:47.825340 [info ] [MainThread]: 
[0m16:19:47.826570 [info ] [MainThread]: Finished running 19 tests in 0 hours 0 minutes and 3.28 seconds (3.28s).
[0m16:19:47.835602 [debug] [MainThread]: Command end result
[0m16:19:47.893948 [info ] [MainThread]: 
[0m16:19:47.896120 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:19:47.897873 [info ] [MainThread]: 
[0m16:19:47.899150 [info ] [MainThread]: Done. PASS=19 WARN=0 ERROR=0 SKIP=0 TOTAL=19
[0m16:19:47.900914 [debug] [MainThread]: Command `dbt test` succeeded at 16:19:47.900666 after 4.98 seconds
[0m16:19:47.902242 [debug] [MainThread]: Flushing usage events


============================== 16:20:27.250086 | d0e03d36-cf36-4874-bf08-1433c5925682 ==============================
[0m16:20:27.250086 [info ] [MainThread]: Running with dbt=1.5.6
[0m16:20:27.261726 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/opt/airflow/dags/Py-DBT-IDX/logs', 'profiles_dir': '/opt/airflow/dags/Py-DBT-IDX', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'False'}
[0m16:20:27.536447 [info ] [MainThread]: Registered adapter: postgres=1.5.6
[0m16:20:27.597462 [debug] [MainThread]: checksum: 36b91491eb2b55e69ff526c98e337edadb953c9826242889489b2fea40332ad6, vars: {}, profile: , target: , version: 1.5.6
[0m16:20:28.747209 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:20:28.749131 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:20:28.831244 [info ] [MainThread]: Found 11 models, 19 tests, 1 snapshot, 0 analyses, 307 macros, 0 operations, 0 seed files, 5 sources, 0 exposures, 0 metrics, 0 groups
[0m16:20:28.839217 [info ] [MainThread]: 
[0m16:20:28.841903 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m16:20:28.845235 [debug] [MainThread]: Command end result
[0m16:20:28.901413 [info ] [MainThread]: 
[0m16:20:28.903255 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:20:28.905316 [info ] [MainThread]: 
[0m16:20:28.908272 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=0 SKIP=0 TOTAL=0
[0m16:20:28.910548 [debug] [MainThread]: Command `dbt seed` succeeded at 16:20:28.910242 after 1.71 seconds
[0m16:20:28.912139 [debug] [MainThread]: Flushing usage events


============================== 16:20:35.206053 | acc4db6a-aeab-4769-9087-351e470a986e ==============================
[0m16:20:35.206053 [info ] [MainThread]: Running with dbt=1.5.6
[0m16:20:35.217535 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/opt/airflow/dags/Py-DBT-IDX', 'log_path': '/opt/airflow/dags/Py-DBT-IDX/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'False'}
[0m16:20:35.418483 [info ] [MainThread]: Registered adapter: postgres=1.5.6
[0m16:20:35.452095 [debug] [MainThread]: checksum: 36b91491eb2b55e69ff526c98e337edadb953c9826242889489b2fea40332ad6, vars: {}, profile: , target: , version: 1.5.6
[0m16:20:36.531882 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:20:36.533336 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:20:36.604951 [info ] [MainThread]: Found 11 models, 19 tests, 1 snapshot, 0 analyses, 307 macros, 0 operations, 0 seed files, 5 sources, 0 exposures, 0 metrics, 0 groups
[0m16:20:36.610027 [info ] [MainThread]: 
[0m16:20:36.612748 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m16:20:36.616442 [debug] [ThreadPool]: Acquiring new postgres connection 'list_IDX-Stock'
[0m16:20:36.637119 [debug] [ThreadPool]: Using postgres connection "list_IDX-Stock"
[0m16:20:36.638859 [debug] [ThreadPool]: On list_IDX-Stock: /* {"app": "dbt", "dbt_version": "1.5.6", "profile_name": "dbt_idx", "target_name": "dev", "connection_name": "list_IDX-Stock"} */

    select distinct nspname from pg_namespace
  
[0m16:20:36.640402 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:20:36.657675 [debug] [ThreadPool]: SQL status: SELECT 14 in 0.0 seconds
[0m16:20:36.660449 [debug] [ThreadPool]: On list_IDX-Stock: Close
[0m16:20:36.666167 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_IDX-Stock, now list_IDX-Stock_snapshots)
[0m16:20:36.677037 [debug] [ThreadPool]: Using postgres connection "list_IDX-Stock_snapshots"
[0m16:20:36.679363 [debug] [ThreadPool]: On list_IDX-Stock_snapshots: BEGIN
[0m16:20:36.681775 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:20:36.692635 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m16:20:36.694577 [debug] [ThreadPool]: Using postgres connection "list_IDX-Stock_snapshots"
[0m16:20:36.697105 [debug] [ThreadPool]: On list_IDX-Stock_snapshots: /* {"app": "dbt", "dbt_version": "1.5.6", "profile_name": "dbt_idx", "target_name": "dev", "connection_name": "list_IDX-Stock_snapshots"} */
select
      'IDX-Stock' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'snapshots'
    union all
    select
      'IDX-Stock' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'snapshots'
  
[0m16:20:36.702549 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.0 seconds
[0m16:20:36.708399 [debug] [ThreadPool]: On list_IDX-Stock_snapshots: ROLLBACK
[0m16:20:36.710374 [debug] [ThreadPool]: On list_IDX-Stock_snapshots: Close
[0m16:20:36.715048 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_IDX-Stock_snapshots, now list_IDX-Stock_IDX-Schema)
[0m16:20:36.724258 [debug] [ThreadPool]: Using postgres connection "list_IDX-Stock_IDX-Schema"
[0m16:20:36.726823 [debug] [ThreadPool]: On list_IDX-Stock_IDX-Schema: BEGIN
[0m16:20:36.728603 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:20:36.741929 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m16:20:36.743796 [debug] [ThreadPool]: Using postgres connection "list_IDX-Stock_IDX-Schema"
[0m16:20:36.745753 [debug] [ThreadPool]: On list_IDX-Stock_IDX-Schema: /* {"app": "dbt", "dbt_version": "1.5.6", "profile_name": "dbt_idx", "target_name": "dev", "connection_name": "list_IDX-Stock_IDX-Schema"} */
select
      'IDX-Stock' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'IDX-Schema'
    union all
    select
      'IDX-Stock' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'IDX-Schema'
  
[0m16:20:36.752677 [debug] [ThreadPool]: SQL status: SELECT 17 in 0.0 seconds
[0m16:20:36.759409 [debug] [ThreadPool]: On list_IDX-Stock_IDX-Schema: ROLLBACK
[0m16:20:36.761578 [debug] [ThreadPool]: On list_IDX-Stock_IDX-Schema: Close
[0m16:20:36.784390 [debug] [MainThread]: Using postgres connection "master"
[0m16:20:36.786179 [debug] [MainThread]: On master: BEGIN
[0m16:20:36.788602 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:20:36.801713 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m16:20:36.803770 [debug] [MainThread]: Using postgres connection "master"
[0m16:20:36.806092 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.5.6", "profile_name": "dbt_idx", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m16:20:36.819042 [debug] [MainThread]: SQL status: SELECT 9 in 0.0 seconds
[0m16:20:36.833237 [debug] [MainThread]: On master: ROLLBACK
[0m16:20:36.837204 [debug] [MainThread]: Using postgres connection "master"
[0m16:20:36.839324 [debug] [MainThread]: On master: BEGIN
[0m16:20:36.842781 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m16:20:36.844844 [debug] [MainThread]: On master: COMMIT
[0m16:20:36.847274 [debug] [MainThread]: Using postgres connection "master"
[0m16:20:36.850829 [debug] [MainThread]: On master: COMMIT
[0m16:20:36.853430 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m16:20:36.857067 [debug] [MainThread]: On master: Close
[0m16:20:36.860491 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:20:36.864186 [info ] [MainThread]: 
[0m16:20:36.881182 [debug] [Thread-1  ]: Began running node snapshot.dbt_idx.customers_snapshot
[0m16:20:36.883950 [info ] [Thread-1  ]: 1 of 1 START snapshot snapshots.customers_snapshot ............................. [RUN]
[0m16:20:36.886051 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_IDX-Stock_IDX-Schema, now snapshot.dbt_idx.customers_snapshot)
[0m16:20:36.887919 [debug] [Thread-1  ]: Began compiling node snapshot.dbt_idx.customers_snapshot
[0m16:20:36.905296 [debug] [Thread-1  ]: Timing info for snapshot.dbt_idx.customers_snapshot (compile): 16:20:36.889313 => 16:20:36.904774
[0m16:20:36.906941 [debug] [Thread-1  ]: Began executing node snapshot.dbt_idx.customers_snapshot
[0m16:20:36.990268 [debug] [Thread-1  ]: Using postgres connection "snapshot.dbt_idx.customers_snapshot"
[0m16:20:36.991602 [debug] [Thread-1  ]: On snapshot.dbt_idx.customers_snapshot: BEGIN
[0m16:20:36.992644 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m16:20:37.001817 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m16:20:37.003880 [debug] [Thread-1  ]: Using postgres connection "snapshot.dbt_idx.customers_snapshot"
[0m16:20:37.006087 [debug] [Thread-1  ]: On snapshot.dbt_idx.customers_snapshot: /* {"app": "dbt", "dbt_version": "1.5.6", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "snapshot.dbt_idx.customers_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "IDX-Stock".INFORMATION_SCHEMA.columns
      where table_name = 'customers_snapshot'
        
        and table_schema = 'snapshots'
        
      order by ordinal_position

  
[0m16:20:37.017576 [debug] [Thread-1  ]: SQL status: SELECT 10 in 0.0 seconds
[0m16:20:37.070489 [debug] [Thread-1  ]: Using postgres connection "snapshot.dbt_idx.customers_snapshot"
[0m16:20:37.072401 [debug] [Thread-1  ]: On snapshot.dbt_idx.customers_snapshot: /* {"app": "dbt", "dbt_version": "1.5.6", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "snapshot.dbt_idx.customers_snapshot"} */

        
  
    

  create temporary table "customers_snapshot__dbt_tmp162037049567"
  
  
    as
  
  (
    with snapshot_query as (

        



select *
from "IDX-Stock"."IDX-Schema"."customers"


    ),

    snapshotted_data as (

        select *,
            customer_id as dbt_unique_key

        from "IDX-Stock"."snapshots"."customers_snapshot"
        where dbt_valid_to is null

    ),

    insertions_source_data as (

        select
            *,
            customer_id as dbt_unique_key,
            datetime_updated as dbt_updated_at,
            datetime_updated as dbt_valid_from,
            nullif(datetime_updated, datetime_updated) as dbt_valid_to,
            md5(coalesce(cast(customer_id as varchar ), '')
         || '|' || coalesce(cast(datetime_updated as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select
            *,
            customer_id as dbt_unique_key,
            datetime_updated as dbt_updated_at,
            datetime_updated as dbt_valid_from,
            datetime_updated as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where snapshotted_data.dbt_unique_key is null
           or (
                snapshotted_data.dbt_unique_key is not null
            and (
                (snapshotted_data.dbt_valid_from < source_data.datetime_updated)
            )
        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where (
            (snapshotted_data.dbt_valid_from < source_data.datetime_updated)
        )
    )

    select * from insertions
    union all
    select * from updates

  );
  
    
[0m16:20:37.076023 [debug] [Thread-1  ]: SQL status: SELECT 0 in 0.0 seconds
[0m16:20:37.081659 [debug] [Thread-1  ]: Using postgres connection "snapshot.dbt_idx.customers_snapshot"
[0m16:20:37.082862 [debug] [Thread-1  ]: On snapshot.dbt_idx.customers_snapshot: /* {"app": "dbt", "dbt_version": "1.5.6", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "snapshot.dbt_idx.customers_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'customers_snapshot__dbt_tmp162037049567'
        
      order by ordinal_position

  
[0m16:20:37.086952 [debug] [Thread-1  ]: SQL status: SELECT 12 in 0.0 seconds
[0m16:20:37.092680 [debug] [Thread-1  ]: Using postgres connection "snapshot.dbt_idx.customers_snapshot"
[0m16:20:37.093819 [debug] [Thread-1  ]: On snapshot.dbt_idx.customers_snapshot: /* {"app": "dbt", "dbt_version": "1.5.6", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "snapshot.dbt_idx.customers_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "IDX-Stock".INFORMATION_SCHEMA.columns
      where table_name = 'customers_snapshot'
        
        and table_schema = 'snapshots'
        
      order by ordinal_position

  
[0m16:20:37.098657 [debug] [Thread-1  ]: SQL status: SELECT 10 in 0.0 seconds
[0m16:20:37.107320 [debug] [Thread-1  ]: Using postgres connection "snapshot.dbt_idx.customers_snapshot"
[0m16:20:37.108567 [debug] [Thread-1  ]: On snapshot.dbt_idx.customers_snapshot: /* {"app": "dbt", "dbt_version": "1.5.6", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "snapshot.dbt_idx.customers_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'customers_snapshot__dbt_tmp162037049567'
        
      order by ordinal_position

  
[0m16:20:37.112835 [debug] [Thread-1  ]: SQL status: SELECT 12 in 0.0 seconds
[0m16:20:37.119618 [debug] [Thread-1  ]: Using postgres connection "snapshot.dbt_idx.customers_snapshot"
[0m16:20:37.121601 [debug] [Thread-1  ]: On snapshot.dbt_idx.customers_snapshot: /* {"app": "dbt", "dbt_version": "1.5.6", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "snapshot.dbt_idx.customers_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "IDX-Stock".INFORMATION_SCHEMA.columns
      where table_name = 'customers_snapshot'
        
        and table_schema = 'snapshots'
        
      order by ordinal_position

  
[0m16:20:37.126880 [debug] [Thread-1  ]: SQL status: SELECT 10 in 0.0 seconds
[0m16:20:37.140905 [debug] [Thread-1  ]: Using postgres connection "snapshot.dbt_idx.customers_snapshot"
[0m16:20:37.142082 [debug] [Thread-1  ]: On snapshot.dbt_idx.customers_snapshot: /* {"app": "dbt", "dbt_version": "1.5.6", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "snapshot.dbt_idx.customers_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'customers_snapshot__dbt_tmp162037049567'
        
      order by ordinal_position

  
[0m16:20:37.146523 [debug] [Thread-1  ]: SQL status: SELECT 12 in 0.0 seconds
[0m16:20:37.157638 [debug] [Thread-1  ]: Writing runtime sql for node "snapshot.dbt_idx.customers_snapshot"
[0m16:20:37.186062 [debug] [Thread-1  ]: Using postgres connection "snapshot.dbt_idx.customers_snapshot"
[0m16:20:37.187874 [debug] [Thread-1  ]: On snapshot.dbt_idx.customers_snapshot: /* {"app": "dbt", "dbt_version": "1.5.6", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "snapshot.dbt_idx.customers_snapshot"} */

      update "IDX-Stock"."snapshots"."customers_snapshot"
    set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to
    from "customers_snapshot__dbt_tmp162037049567" as DBT_INTERNAL_SOURCE
    where DBT_INTERNAL_SOURCE.dbt_scd_id::text = "IDX-Stock"."snapshots"."customers_snapshot".dbt_scd_id::text
      and DBT_INTERNAL_SOURCE.dbt_change_type::text in ('update'::text, 'delete'::text)
      and "IDX-Stock"."snapshots"."customers_snapshot".dbt_valid_to is null;

    insert into "IDX-Stock"."snapshots"."customers_snapshot" ("customer_id", "zipcode", "city", "state_code", "datetime_created", "datetime_updated", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id")
    select DBT_INTERNAL_SOURCE."customer_id",DBT_INTERNAL_SOURCE."zipcode",DBT_INTERNAL_SOURCE."city",DBT_INTERNAL_SOURCE."state_code",DBT_INTERNAL_SOURCE."datetime_created",DBT_INTERNAL_SOURCE."datetime_updated",DBT_INTERNAL_SOURCE."dbt_updated_at",DBT_INTERNAL_SOURCE."dbt_valid_from",DBT_INTERNAL_SOURCE."dbt_valid_to",DBT_INTERNAL_SOURCE."dbt_scd_id"
    from "customers_snapshot__dbt_tmp162037049567" as DBT_INTERNAL_SOURCE
    where DBT_INTERNAL_SOURCE.dbt_change_type::text = 'insert'::text;

  
[0m16:20:37.189867 [debug] [Thread-1  ]: SQL status: INSERT 0 0 in 0.0 seconds
[0m16:20:37.214114 [debug] [Thread-1  ]: On snapshot.dbt_idx.customers_snapshot: COMMIT
[0m16:20:37.215447 [debug] [Thread-1  ]: Using postgres connection "snapshot.dbt_idx.customers_snapshot"
[0m16:20:37.216553 [debug] [Thread-1  ]: On snapshot.dbt_idx.customers_snapshot: COMMIT
[0m16:20:37.220110 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m16:20:37.225549 [debug] [Thread-1  ]: Timing info for snapshot.dbt_idx.customers_snapshot (execute): 16:20:36.908016 => 16:20:37.225297
[0m16:20:37.226656 [debug] [Thread-1  ]: On snapshot.dbt_idx.customers_snapshot: Close
[0m16:20:37.229154 [info ] [Thread-1  ]: 1 of 1 OK snapshotted snapshots.customers_snapshot ............................. [[32msuccess[0m in 0.34s]
[0m16:20:37.232323 [debug] [Thread-1  ]: Finished running node snapshot.dbt_idx.customers_snapshot
[0m16:20:37.286735 [debug] [MainThread]: Using postgres connection "master"
[0m16:20:37.288035 [debug] [MainThread]: On master: BEGIN
[0m16:20:37.289766 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:20:37.299952 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m16:20:37.301816 [debug] [MainThread]: On master: COMMIT
[0m16:20:37.303836 [debug] [MainThread]: Using postgres connection "master"
[0m16:20:37.306723 [debug] [MainThread]: On master: COMMIT
[0m16:20:37.308406 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m16:20:37.309626 [debug] [MainThread]: On master: Close
[0m16:20:37.311571 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:20:37.313538 [debug] [MainThread]: Connection 'snapshot.dbt_idx.customers_snapshot' was properly closed.
[0m16:20:37.316013 [info ] [MainThread]: 
[0m16:20:37.318726 [info ] [MainThread]: Finished running 1 snapshot in 0 hours 0 minutes and 0.70 seconds (0.70s).
[0m16:20:37.325614 [debug] [MainThread]: Command end result
[0m16:20:37.399777 [info ] [MainThread]: 
[0m16:20:37.401123 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:20:37.402249 [info ] [MainThread]: 
[0m16:20:37.403909 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m16:20:37.406690 [debug] [MainThread]: Command `dbt snapshot` succeeded at 16:20:37.406447 after 2.25 seconds
[0m16:20:37.408060 [debug] [MainThread]: Flushing usage events


============================== 16:20:43.487411 | 58538045-8ba6-4fba-8c69-c9fbfbbf9f49 ==============================
[0m16:20:43.487411 [info ] [MainThread]: Running with dbt=1.5.6
[0m16:20:43.505320 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/opt/airflow/dags/Py-DBT-IDX/logs', 'debug': 'False', 'profiles_dir': '/opt/airflow/dags/Py-DBT-IDX', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'send_anonymous_usage_stats': 'False'}
[0m16:20:43.749645 [info ] [MainThread]: Registered adapter: postgres=1.5.6
[0m16:20:43.791883 [debug] [MainThread]: checksum: 36b91491eb2b55e69ff526c98e337edadb953c9826242889489b2fea40332ad6, vars: {}, profile: , target: , version: 1.5.6
[0m16:20:45.023956 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:20:45.025565 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:20:45.097287 [info ] [MainThread]: Found 11 models, 19 tests, 1 snapshot, 0 analyses, 307 macros, 0 operations, 0 seed files, 5 sources, 0 exposures, 0 metrics, 0 groups
[0m16:20:45.101714 [info ] [MainThread]: 
[0m16:20:45.104438 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m16:20:45.108239 [debug] [ThreadPool]: Acquiring new postgres connection 'list_IDX-Stock'
[0m16:20:45.130503 [debug] [ThreadPool]: Using postgres connection "list_IDX-Stock"
[0m16:20:45.131948 [debug] [ThreadPool]: On list_IDX-Stock: /* {"app": "dbt", "dbt_version": "1.5.6", "profile_name": "dbt_idx", "target_name": "dev", "connection_name": "list_IDX-Stock"} */

    select distinct nspname from pg_namespace
  
[0m16:20:45.132872 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:20:45.144413 [debug] [ThreadPool]: SQL status: SELECT 14 in 0.0 seconds
[0m16:20:45.148397 [debug] [ThreadPool]: On list_IDX-Stock: Close
[0m16:20:45.152772 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_IDX-Stock, now list_IDX-Stock_IDX-Schema)
[0m16:20:45.164711 [debug] [ThreadPool]: Using postgres connection "list_IDX-Stock_IDX-Schema"
[0m16:20:45.165914 [debug] [ThreadPool]: On list_IDX-Stock_IDX-Schema: BEGIN
[0m16:20:45.166873 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:20:45.175788 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m16:20:45.177510 [debug] [ThreadPool]: Using postgres connection "list_IDX-Stock_IDX-Schema"
[0m16:20:45.179663 [debug] [ThreadPool]: On list_IDX-Stock_IDX-Schema: /* {"app": "dbt", "dbt_version": "1.5.6", "profile_name": "dbt_idx", "target_name": "dev", "connection_name": "list_IDX-Stock_IDX-Schema"} */
select
      'IDX-Stock' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'IDX-Schema'
    union all
    select
      'IDX-Stock' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'IDX-Schema'
  
[0m16:20:45.184388 [debug] [ThreadPool]: SQL status: SELECT 17 in 0.0 seconds
[0m16:20:45.191527 [debug] [ThreadPool]: On list_IDX-Stock_IDX-Schema: ROLLBACK
[0m16:20:45.193374 [debug] [ThreadPool]: On list_IDX-Stock_IDX-Schema: Close
[0m16:20:45.198778 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_IDX-Stock_IDX-Schema, now list_IDX-Stock_snapshots)
[0m16:20:45.212122 [debug] [ThreadPool]: Using postgres connection "list_IDX-Stock_snapshots"
[0m16:20:45.214088 [debug] [ThreadPool]: On list_IDX-Stock_snapshots: BEGIN
[0m16:20:45.216590 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:20:45.228624 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m16:20:45.231154 [debug] [ThreadPool]: Using postgres connection "list_IDX-Stock_snapshots"
[0m16:20:45.233848 [debug] [ThreadPool]: On list_IDX-Stock_snapshots: /* {"app": "dbt", "dbt_version": "1.5.6", "profile_name": "dbt_idx", "target_name": "dev", "connection_name": "list_IDX-Stock_snapshots"} */
select
      'IDX-Stock' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'snapshots'
    union all
    select
      'IDX-Stock' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'snapshots'
  
[0m16:20:45.242956 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.0 seconds
[0m16:20:45.249176 [debug] [ThreadPool]: On list_IDX-Stock_snapshots: ROLLBACK
[0m16:20:45.253361 [debug] [ThreadPool]: On list_IDX-Stock_snapshots: Close
[0m16:20:45.268365 [debug] [MainThread]: Using postgres connection "master"
[0m16:20:45.270687 [debug] [MainThread]: On master: BEGIN
[0m16:20:45.272199 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:20:45.283695 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m16:20:45.285510 [debug] [MainThread]: Using postgres connection "master"
[0m16:20:45.288041 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.5.6", "profile_name": "dbt_idx", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m16:20:45.303087 [debug] [MainThread]: SQL status: SELECT 9 in 0.0 seconds
[0m16:20:45.318449 [debug] [MainThread]: On master: ROLLBACK
[0m16:20:45.320958 [debug] [MainThread]: Using postgres connection "master"
[0m16:20:45.323399 [debug] [MainThread]: On master: BEGIN
[0m16:20:45.326144 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m16:20:45.328426 [debug] [MainThread]: On master: COMMIT
[0m16:20:45.331107 [debug] [MainThread]: Using postgres connection "master"
[0m16:20:45.334128 [debug] [MainThread]: On master: COMMIT
[0m16:20:45.336711 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m16:20:45.339199 [debug] [MainThread]: On master: Close
[0m16:20:45.343195 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:20:45.348001 [info ] [MainThread]: 
[0m16:20:45.367444 [debug] [Thread-1  ]: Began running node model.dbt_idx.stg_eltool__company
[0m16:20:45.370397 [info ] [Thread-1  ]: 1 of 11 START sql view model IDX-Schema.stg_eltool__company .................... [RUN]
[0m16:20:45.375179 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_IDX-Stock_snapshots, now model.dbt_idx.stg_eltool__company)
[0m16:20:45.377943 [debug] [Thread-1  ]: Began compiling node model.dbt_idx.stg_eltool__company
[0m16:20:45.398768 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_idx.stg_eltool__company"
[0m16:20:45.425414 [debug] [Thread-1  ]: Timing info for model.dbt_idx.stg_eltool__company (compile): 16:20:45.380228 => 16:20:45.424941
[0m16:20:45.426759 [debug] [Thread-1  ]: Began executing node model.dbt_idx.stg_eltool__company
[0m16:20:45.513695 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_idx.stg_eltool__company"
[0m16:20:45.542730 [debug] [Thread-1  ]: Using postgres connection "model.dbt_idx.stg_eltool__company"
[0m16:20:45.544073 [debug] [Thread-1  ]: On model.dbt_idx.stg_eltool__company: BEGIN
[0m16:20:45.545657 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m16:20:45.589115 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m16:20:45.591061 [debug] [Thread-1  ]: Using postgres connection "model.dbt_idx.stg_eltool__company"
[0m16:20:45.593035 [debug] [Thread-1  ]: On model.dbt_idx.stg_eltool__company: /* {"app": "dbt", "dbt_version": "1.5.6", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__company"} */

  create view "IDX-Stock"."IDX-Schema"."stg_eltool__company__dbt_tmp"
    
    
  as (
    with source as (select *
                from "IDX-Stock"."IDX-Schema"."ksql-company-stream"),
     renamed as (select id,
                        ticker,
                        name,
                        logo
                 from source)
select *
from renamed
  );
[0m16:20:45.598350 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m16:20:45.627341 [debug] [Thread-1  ]: Using postgres connection "model.dbt_idx.stg_eltool__company"
[0m16:20:45.630119 [debug] [Thread-1  ]: On model.dbt_idx.stg_eltool__company: /* {"app": "dbt", "dbt_version": "1.5.6", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__company"} */
alter table "IDX-Stock"."IDX-Schema"."stg_eltool__company" rename to "stg_eltool__company__dbt_backup"
[0m16:20:45.633801 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m16:20:45.651833 [debug] [Thread-1  ]: Using postgres connection "model.dbt_idx.stg_eltool__company"
[0m16:20:45.654453 [debug] [Thread-1  ]: On model.dbt_idx.stg_eltool__company: /* {"app": "dbt", "dbt_version": "1.5.6", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__company"} */
alter table "IDX-Stock"."IDX-Schema"."stg_eltool__company__dbt_tmp" rename to "stg_eltool__company"
[0m16:20:45.658077 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m16:20:45.700356 [debug] [Thread-1  ]: On model.dbt_idx.stg_eltool__company: COMMIT
[0m16:20:45.701756 [debug] [Thread-1  ]: Using postgres connection "model.dbt_idx.stg_eltool__company"
[0m16:20:45.703450 [debug] [Thread-1  ]: On model.dbt_idx.stg_eltool__company: COMMIT
[0m16:20:45.707750 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m16:20:45.720765 [debug] [Thread-1  ]: Using postgres connection "model.dbt_idx.stg_eltool__company"
[0m16:20:45.722994 [debug] [Thread-1  ]: On model.dbt_idx.stg_eltool__company: /* {"app": "dbt", "dbt_version": "1.5.6", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__company"} */
drop view if exists "IDX-Stock"."IDX-Schema"."stg_eltool__company__dbt_backup" cascade
[0m16:20:45.727084 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
[0m16:20:45.732559 [debug] [Thread-1  ]: Timing info for model.dbt_idx.stg_eltool__company (execute): 16:20:45.427961 => 16:20:45.732258
[0m16:20:45.733860 [debug] [Thread-1  ]: On model.dbt_idx.stg_eltool__company: Close
[0m16:20:45.736368 [info ] [Thread-1  ]: 1 of 11 OK created sql view model IDX-Schema.stg_eltool__company ............... [[32mCREATE VIEW[0m in 0.36s]
[0m16:20:45.740319 [debug] [Thread-1  ]: Finished running node model.dbt_idx.stg_eltool__company
[0m16:20:45.742040 [debug] [Thread-1  ]: Began running node model.dbt_idx.stg_eltool__customers
[0m16:20:45.743386 [info ] [Thread-1  ]: 2 of 11 START sql view model IDX-Schema.stg_eltool__customers .................. [RUN]
[0m16:20:45.746875 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_idx.stg_eltool__company, now model.dbt_idx.stg_eltool__customers)
[0m16:20:45.749190 [debug] [Thread-1  ]: Began compiling node model.dbt_idx.stg_eltool__customers
[0m16:20:45.757497 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_idx.stg_eltool__customers"
[0m16:20:45.795043 [debug] [Thread-1  ]: Timing info for model.dbt_idx.stg_eltool__customers (compile): 16:20:45.750433 => 16:20:45.794213
[0m16:20:45.797574 [debug] [Thread-1  ]: Began executing node model.dbt_idx.stg_eltool__customers
[0m16:20:45.808993 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_idx.stg_eltool__customers"
[0m16:20:45.838446 [debug] [Thread-1  ]: Using postgres connection "model.dbt_idx.stg_eltool__customers"
[0m16:20:45.840252 [debug] [Thread-1  ]: On model.dbt_idx.stg_eltool__customers: BEGIN
[0m16:20:45.841371 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m16:20:45.851010 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m16:20:45.853428 [debug] [Thread-1  ]: Using postgres connection "model.dbt_idx.stg_eltool__customers"
[0m16:20:45.856944 [debug] [Thread-1  ]: On model.dbt_idx.stg_eltool__customers: /* {"app": "dbt", "dbt_version": "1.5.6", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__customers"} */

  create view "IDX-Stock"."IDX-Schema"."stg_eltool__customers__dbt_tmp"
    
    
  as (
    with source as (select *
                from "IDX-Stock"."IDX-Schema"."customers"),
     renamed as (select
                     customer_id,
                    'This is Dummy' as dummy
                 from source
                 where customer_id = 1234567890)
select *
from renamed
  );
[0m16:20:45.863619 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m16:20:45.874668 [debug] [Thread-1  ]: Using postgres connection "model.dbt_idx.stg_eltool__customers"
[0m16:20:45.878547 [debug] [Thread-1  ]: On model.dbt_idx.stg_eltool__customers: /* {"app": "dbt", "dbt_version": "1.5.6", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__customers"} */
alter table "IDX-Stock"."IDX-Schema"."stg_eltool__customers" rename to "stg_eltool__customers__dbt_backup"
[0m16:20:45.882647 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m16:20:45.901548 [debug] [Thread-1  ]: Using postgres connection "model.dbt_idx.stg_eltool__customers"
[0m16:20:45.904055 [debug] [Thread-1  ]: On model.dbt_idx.stg_eltool__customers: /* {"app": "dbt", "dbt_version": "1.5.6", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__customers"} */
alter table "IDX-Stock"."IDX-Schema"."stg_eltool__customers__dbt_tmp" rename to "stg_eltool__customers"
[0m16:20:45.907429 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m16:20:45.913327 [debug] [Thread-1  ]: On model.dbt_idx.stg_eltool__customers: COMMIT
[0m16:20:45.916019 [debug] [Thread-1  ]: Using postgres connection "model.dbt_idx.stg_eltool__customers"
[0m16:20:45.917718 [debug] [Thread-1  ]: On model.dbt_idx.stg_eltool__customers: COMMIT
[0m16:20:45.922289 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m16:20:45.931450 [debug] [Thread-1  ]: Using postgres connection "model.dbt_idx.stg_eltool__customers"
[0m16:20:45.933581 [debug] [Thread-1  ]: On model.dbt_idx.stg_eltool__customers: /* {"app": "dbt", "dbt_version": "1.5.6", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__customers"} */
drop view if exists "IDX-Stock"."IDX-Schema"."stg_eltool__customers__dbt_backup" cascade
[0m16:20:45.939245 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
[0m16:20:45.942786 [debug] [Thread-1  ]: Timing info for model.dbt_idx.stg_eltool__customers (execute): 16:20:45.799129 => 16:20:45.942514
[0m16:20:45.944429 [debug] [Thread-1  ]: On model.dbt_idx.stg_eltool__customers: Close
[0m16:20:45.948359 [info ] [Thread-1  ]: 2 of 11 OK created sql view model IDX-Schema.stg_eltool__customers ............. [[32mCREATE VIEW[0m in 0.20s]
[0m16:20:45.951191 [debug] [Thread-1  ]: Finished running node model.dbt_idx.stg_eltool__customers
[0m16:20:45.953335 [debug] [Thread-1  ]: Began running node model.dbt_idx.stg_eltool__customers_snapshots
[0m16:20:45.956054 [info ] [Thread-1  ]: 3 of 11 START sql view model IDX-Schema.stg_eltool__customers_snapshots ........ [RUN]
[0m16:20:45.959258 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_idx.stg_eltool__customers, now model.dbt_idx.stg_eltool__customers_snapshots)
[0m16:20:45.960989 [debug] [Thread-1  ]: Began compiling node model.dbt_idx.stg_eltool__customers_snapshots
[0m16:20:45.968379 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_idx.stg_eltool__customers_snapshots"
[0m16:20:46.005545 [debug] [Thread-1  ]: Timing info for model.dbt_idx.stg_eltool__customers_snapshots (compile): 16:20:45.962749 => 16:20:46.004543
[0m16:20:46.008288 [debug] [Thread-1  ]: Began executing node model.dbt_idx.stg_eltool__customers_snapshots
[0m16:20:46.022512 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_idx.stg_eltool__customers_snapshots"
[0m16:20:46.054122 [debug] [Thread-1  ]: Using postgres connection "model.dbt_idx.stg_eltool__customers_snapshots"
[0m16:20:46.055902 [debug] [Thread-1  ]: On model.dbt_idx.stg_eltool__customers_snapshots: BEGIN
[0m16:20:46.058073 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m16:20:46.069381 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m16:20:46.071558 [debug] [Thread-1  ]: Using postgres connection "model.dbt_idx.stg_eltool__customers_snapshots"
[0m16:20:46.073983 [debug] [Thread-1  ]: On model.dbt_idx.stg_eltool__customers_snapshots: /* {"app": "dbt", "dbt_version": "1.5.6", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__customers_snapshots"} */

  create view "IDX-Stock"."IDX-Schema"."stg_eltool__customers_snapshots__dbt_tmp"
    
    
  as (
    with source as (select *
                from "IDX-Stock"."snapshots"."customers_snapshot"),
     renamed as (select customer_id,
                        zipcode,
                        city,
                        state_code,
                        datetime_created::TIMESTAMP AS datetime_created,
                        datetime_updated::TIMESTAMP AS datetime_updated,
                        dbt_valid_from,
                        dbt_valid_to
                 from source)
select *
from renamed
  );
[0m16:20:46.081010 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m16:20:46.094248 [debug] [Thread-1  ]: Using postgres connection "model.dbt_idx.stg_eltool__customers_snapshots"
[0m16:20:46.097004 [debug] [Thread-1  ]: On model.dbt_idx.stg_eltool__customers_snapshots: /* {"app": "dbt", "dbt_version": "1.5.6", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__customers_snapshots"} */
alter table "IDX-Stock"."IDX-Schema"."stg_eltool__customers_snapshots" rename to "stg_eltool__customers_snapshots__dbt_backup"
[0m16:20:46.100428 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m16:20:46.110214 [debug] [Thread-1  ]: Using postgres connection "model.dbt_idx.stg_eltool__customers_snapshots"
[0m16:20:46.112119 [debug] [Thread-1  ]: On model.dbt_idx.stg_eltool__customers_snapshots: /* {"app": "dbt", "dbt_version": "1.5.6", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__customers_snapshots"} */
alter table "IDX-Stock"."IDX-Schema"."stg_eltool__customers_snapshots__dbt_tmp" rename to "stg_eltool__customers_snapshots"
[0m16:20:46.115752 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m16:20:46.123656 [debug] [Thread-1  ]: On model.dbt_idx.stg_eltool__customers_snapshots: COMMIT
[0m16:20:46.125702 [debug] [Thread-1  ]: Using postgres connection "model.dbt_idx.stg_eltool__customers_snapshots"
[0m16:20:46.128020 [debug] [Thread-1  ]: On model.dbt_idx.stg_eltool__customers_snapshots: COMMIT
[0m16:20:46.132392 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m16:20:46.142378 [debug] [Thread-1  ]: Using postgres connection "model.dbt_idx.stg_eltool__customers_snapshots"
[0m16:20:46.143991 [debug] [Thread-1  ]: On model.dbt_idx.stg_eltool__customers_snapshots: /* {"app": "dbt", "dbt_version": "1.5.6", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__customers_snapshots"} */
drop view if exists "IDX-Stock"."IDX-Schema"."stg_eltool__customers_snapshots__dbt_backup" cascade
[0m16:20:46.147935 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
[0m16:20:46.152044 [debug] [Thread-1  ]: Timing info for model.dbt_idx.stg_eltool__customers_snapshots (execute): 16:20:46.010550 => 16:20:46.151590
[0m16:20:46.153638 [debug] [Thread-1  ]: On model.dbt_idx.stg_eltool__customers_snapshots: Close
[0m16:20:46.157558 [info ] [Thread-1  ]: 3 of 11 OK created sql view model IDX-Schema.stg_eltool__customers_snapshots ... [[32mCREATE VIEW[0m in 0.20s]
[0m16:20:46.160067 [debug] [Thread-1  ]: Finished running node model.dbt_idx.stg_eltool__customers_snapshots
[0m16:20:46.161678 [debug] [Thread-1  ]: Began running node model.dbt_idx.stg_eltool__orders
[0m16:20:46.164072 [info ] [Thread-1  ]: 4 of 11 START sql view model IDX-Schema.stg_eltool__orders ..................... [RUN]
[0m16:20:46.166709 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_idx.stg_eltool__customers_snapshots, now model.dbt_idx.stg_eltool__orders)
[0m16:20:46.168260 [debug] [Thread-1  ]: Began compiling node model.dbt_idx.stg_eltool__orders
[0m16:20:46.223674 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_idx.stg_eltool__orders"
[0m16:20:46.255712 [debug] [Thread-1  ]: Timing info for model.dbt_idx.stg_eltool__orders (compile): 16:20:46.169666 => 16:20:46.255329
[0m16:20:46.256936 [debug] [Thread-1  ]: Began executing node model.dbt_idx.stg_eltool__orders
[0m16:20:46.264889 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_idx.stg_eltool__orders"
[0m16:20:46.294186 [debug] [Thread-1  ]: Using postgres connection "model.dbt_idx.stg_eltool__orders"
[0m16:20:46.295718 [debug] [Thread-1  ]: On model.dbt_idx.stg_eltool__orders: BEGIN
[0m16:20:46.297011 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m16:20:46.305958 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m16:20:46.307932 [debug] [Thread-1  ]: Using postgres connection "model.dbt_idx.stg_eltool__orders"
[0m16:20:46.309134 [debug] [Thread-1  ]: On model.dbt_idx.stg_eltool__orders: /* {"app": "dbt", "dbt_version": "1.5.6", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__orders"} */

  create view "IDX-Stock"."IDX-Schema"."stg_eltool__orders__dbt_tmp"
    
    
  as (
    with source as (select *
                from "IDX-Stock"."IDX-Schema"."orders"),
     renamed as (select order_id,
                        cust_id AS customer_id,
                        order_status,
                        order_purchase_timestamp::TIMESTAMP,
                        order_approved_at::TIMESTAMP,
                        order_delivered_carrier_date::TIMESTAMP,
                        order_delivered_customer_date::TIMESTAMP,
                        order_estimated_delivery_date::TIMESTAMP
                 from source)
select *
from renamed
  );
[0m16:20:46.314115 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m16:20:46.320862 [debug] [Thread-1  ]: Using postgres connection "model.dbt_idx.stg_eltool__orders"
[0m16:20:46.323129 [debug] [Thread-1  ]: On model.dbt_idx.stg_eltool__orders: /* {"app": "dbt", "dbt_version": "1.5.6", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__orders"} */
alter table "IDX-Stock"."IDX-Schema"."stg_eltool__orders" rename to "stg_eltool__orders__dbt_backup"
[0m16:20:46.327748 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m16:20:46.335134 [debug] [Thread-1  ]: Using postgres connection "model.dbt_idx.stg_eltool__orders"
[0m16:20:46.338779 [debug] [Thread-1  ]: On model.dbt_idx.stg_eltool__orders: /* {"app": "dbt", "dbt_version": "1.5.6", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__orders"} */
alter table "IDX-Stock"."IDX-Schema"."stg_eltool__orders__dbt_tmp" rename to "stg_eltool__orders"
[0m16:20:46.342088 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m16:20:46.347391 [debug] [Thread-1  ]: On model.dbt_idx.stg_eltool__orders: COMMIT
[0m16:20:46.350163 [debug] [Thread-1  ]: Using postgres connection "model.dbt_idx.stg_eltool__orders"
[0m16:20:46.352220 [debug] [Thread-1  ]: On model.dbt_idx.stg_eltool__orders: COMMIT
[0m16:20:46.357181 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m16:20:46.363705 [debug] [Thread-1  ]: Using postgres connection "model.dbt_idx.stg_eltool__orders"
[0m16:20:46.364938 [debug] [Thread-1  ]: On model.dbt_idx.stg_eltool__orders: /* {"app": "dbt", "dbt_version": "1.5.6", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__orders"} */
drop view if exists "IDX-Stock"."IDX-Schema"."stg_eltool__orders__dbt_backup" cascade
[0m16:20:46.368190 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
[0m16:20:46.372763 [debug] [Thread-1  ]: Timing info for model.dbt_idx.stg_eltool__orders (execute): 16:20:46.257806 => 16:20:46.372511
[0m16:20:46.373921 [debug] [Thread-1  ]: On model.dbt_idx.stg_eltool__orders: Close
[0m16:20:46.375793 [info ] [Thread-1  ]: 4 of 11 OK created sql view model IDX-Schema.stg_eltool__orders ................ [[32mCREATE VIEW[0m in 0.21s]
[0m16:20:46.378294 [debug] [Thread-1  ]: Finished running node model.dbt_idx.stg_eltool__orders
[0m16:20:46.380240 [debug] [Thread-1  ]: Began running node model.dbt_idx.stg_eltool__state
[0m16:20:46.381451 [info ] [Thread-1  ]: 5 of 11 START sql view model IDX-Schema.stg_eltool__state ...................... [RUN]
[0m16:20:46.383087 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_idx.stg_eltool__orders, now model.dbt_idx.stg_eltool__state)
[0m16:20:46.384084 [debug] [Thread-1  ]: Began compiling node model.dbt_idx.stg_eltool__state
[0m16:20:46.389967 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_idx.stg_eltool__state"
[0m16:20:46.412564 [debug] [Thread-1  ]: Timing info for model.dbt_idx.stg_eltool__state (compile): 16:20:46.385414 => 16:20:46.412115
[0m16:20:46.413822 [debug] [Thread-1  ]: Began executing node model.dbt_idx.stg_eltool__state
[0m16:20:46.422224 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_idx.stg_eltool__state"
[0m16:20:46.444087 [debug] [Thread-1  ]: Using postgres connection "model.dbt_idx.stg_eltool__state"
[0m16:20:46.445594 [debug] [Thread-1  ]: On model.dbt_idx.stg_eltool__state: BEGIN
[0m16:20:46.446675 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m16:20:46.455662 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m16:20:46.457423 [debug] [Thread-1  ]: Using postgres connection "model.dbt_idx.stg_eltool__state"
[0m16:20:46.458781 [debug] [Thread-1  ]: On model.dbt_idx.stg_eltool__state: /* {"app": "dbt", "dbt_version": "1.5.6", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__state"} */

  create view "IDX-Stock"."IDX-Schema"."stg_eltool__state__dbt_tmp"
    
    
  as (
    with source as (select *
                from "IDX-Stock"."IDX-Schema"."state"),
     renamed as (select state_identifier::INT AS state_id,
                         state_code::VARCHAR(2) AS state_code,
                         st_name::VARCHAR(30) AS state_name
                 from source)
select *
from renamed
  );
[0m16:20:46.464530 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m16:20:46.475341 [debug] [Thread-1  ]: Using postgres connection "model.dbt_idx.stg_eltool__state"
[0m16:20:46.477638 [debug] [Thread-1  ]: On model.dbt_idx.stg_eltool__state: /* {"app": "dbt", "dbt_version": "1.5.6", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__state"} */
alter table "IDX-Stock"."IDX-Schema"."stg_eltool__state" rename to "stg_eltool__state__dbt_backup"
[0m16:20:46.481171 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m16:20:46.488311 [debug] [Thread-1  ]: Using postgres connection "model.dbt_idx.stg_eltool__state"
[0m16:20:46.490884 [debug] [Thread-1  ]: On model.dbt_idx.stg_eltool__state: /* {"app": "dbt", "dbt_version": "1.5.6", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__state"} */
alter table "IDX-Stock"."IDX-Schema"."stg_eltool__state__dbt_tmp" rename to "stg_eltool__state"
[0m16:20:46.493211 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m16:20:46.499266 [debug] [Thread-1  ]: On model.dbt_idx.stg_eltool__state: COMMIT
[0m16:20:46.500545 [debug] [Thread-1  ]: Using postgres connection "model.dbt_idx.stg_eltool__state"
[0m16:20:46.501489 [debug] [Thread-1  ]: On model.dbt_idx.stg_eltool__state: COMMIT
[0m16:20:46.505487 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m16:20:46.513809 [debug] [Thread-1  ]: Using postgres connection "model.dbt_idx.stg_eltool__state"
[0m16:20:46.515071 [debug] [Thread-1  ]: On model.dbt_idx.stg_eltool__state: /* {"app": "dbt", "dbt_version": "1.5.6", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__state"} */
drop view if exists "IDX-Stock"."IDX-Schema"."stg_eltool__state__dbt_backup" cascade
[0m16:20:46.518062 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
[0m16:20:46.521960 [debug] [Thread-1  ]: Timing info for model.dbt_idx.stg_eltool__state (execute): 16:20:46.414616 => 16:20:46.521504
[0m16:20:46.523149 [debug] [Thread-1  ]: On model.dbt_idx.stg_eltool__state: Close
[0m16:20:46.524929 [info ] [Thread-1  ]: 5 of 11 OK created sql view model IDX-Schema.stg_eltool__state ................. [[32mCREATE VIEW[0m in 0.14s]
[0m16:20:46.527438 [debug] [Thread-1  ]: Finished running node model.dbt_idx.stg_eltool__state
[0m16:20:46.529352 [debug] [Thread-1  ]: Began running node model.dbt_idx.stg_eltool__stock
[0m16:20:46.531066 [info ] [Thread-1  ]: 6 of 11 START sql view model IDX-Schema.stg_eltool__stock ...................... [RUN]
[0m16:20:46.532946 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_idx.stg_eltool__state, now model.dbt_idx.stg_eltool__stock)
[0m16:20:46.533958 [debug] [Thread-1  ]: Began compiling node model.dbt_idx.stg_eltool__stock
[0m16:20:46.539723 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_idx.stg_eltool__stock"
[0m16:20:46.562378 [debug] [Thread-1  ]: Timing info for model.dbt_idx.stg_eltool__stock (compile): 16:20:46.534810 => 16:20:46.561815
[0m16:20:46.563530 [debug] [Thread-1  ]: Began executing node model.dbt_idx.stg_eltool__stock
[0m16:20:46.571276 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_idx.stg_eltool__stock"
[0m16:20:46.594962 [debug] [Thread-1  ]: Using postgres connection "model.dbt_idx.stg_eltool__stock"
[0m16:20:46.596448 [debug] [Thread-1  ]: On model.dbt_idx.stg_eltool__stock: BEGIN
[0m16:20:46.597416 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m16:20:46.606427 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m16:20:46.608139 [debug] [Thread-1  ]: Using postgres connection "model.dbt_idx.stg_eltool__stock"
[0m16:20:46.609512 [debug] [Thread-1  ]: On model.dbt_idx.stg_eltool__stock: /* {"app": "dbt", "dbt_version": "1.5.6", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__stock"} */

  create view "IDX-Stock"."IDX-Schema"."stg_eltool__stock__dbt_tmp"
    
    
  as (
    with source as (select *
                from "IDX-Stock"."IDX-Schema"."ksql-stock-stream"),
     renamed as (select *
                 from source)
select *
from renamed
  );
[0m16:20:46.615701 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m16:20:46.624377 [debug] [Thread-1  ]: Using postgres connection "model.dbt_idx.stg_eltool__stock"
[0m16:20:46.625832 [debug] [Thread-1  ]: On model.dbt_idx.stg_eltool__stock: /* {"app": "dbt", "dbt_version": "1.5.6", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__stock"} */
alter table "IDX-Stock"."IDX-Schema"."stg_eltool__stock" rename to "stg_eltool__stock__dbt_backup"
[0m16:20:46.629833 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m16:20:46.637840 [debug] [Thread-1  ]: Using postgres connection "model.dbt_idx.stg_eltool__stock"
[0m16:20:46.640385 [debug] [Thread-1  ]: On model.dbt_idx.stg_eltool__stock: /* {"app": "dbt", "dbt_version": "1.5.6", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__stock"} */
alter table "IDX-Stock"."IDX-Schema"."stg_eltool__stock__dbt_tmp" rename to "stg_eltool__stock"
[0m16:20:46.642784 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m16:20:46.648581 [debug] [Thread-1  ]: On model.dbt_idx.stg_eltool__stock: COMMIT
[0m16:20:46.649828 [debug] [Thread-1  ]: Using postgres connection "model.dbt_idx.stg_eltool__stock"
[0m16:20:46.651376 [debug] [Thread-1  ]: On model.dbt_idx.stg_eltool__stock: COMMIT
[0m16:20:46.655412 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m16:20:46.661547 [debug] [Thread-1  ]: Using postgres connection "model.dbt_idx.stg_eltool__stock"
[0m16:20:46.663957 [debug] [Thread-1  ]: On model.dbt_idx.stg_eltool__stock: /* {"app": "dbt", "dbt_version": "1.5.6", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__stock"} */
drop view if exists "IDX-Stock"."IDX-Schema"."stg_eltool__stock__dbt_backup" cascade
[0m16:20:46.668258 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
[0m16:20:46.672762 [debug] [Thread-1  ]: Timing info for model.dbt_idx.stg_eltool__stock (execute): 16:20:46.564314 => 16:20:46.672267
[0m16:20:46.674166 [debug] [Thread-1  ]: On model.dbt_idx.stg_eltool__stock: Close
[0m16:20:46.676315 [info ] [Thread-1  ]: 6 of 11 OK created sql view model IDX-Schema.stg_eltool__stock ................. [[32mCREATE VIEW[0m in 0.14s]
[0m16:20:46.679529 [debug] [Thread-1  ]: Finished running node model.dbt_idx.stg_eltool__stock
[0m16:20:46.681755 [debug] [Thread-1  ]: Began running node model.dbt_idx.fact_orders
[0m16:20:46.683127 [info ] [Thread-1  ]: 7 of 11 START sql table model IDX-Schema.fact_orders ........................... [RUN]
[0m16:20:46.685093 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_idx.stg_eltool__stock, now model.dbt_idx.fact_orders)
[0m16:20:46.687308 [debug] [Thread-1  ]: Began compiling node model.dbt_idx.fact_orders
[0m16:20:46.692913 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_idx.fact_orders"
[0m16:20:46.722849 [debug] [Thread-1  ]: Timing info for model.dbt_idx.fact_orders (compile): 16:20:46.689058 => 16:20:46.722273
[0m16:20:46.723972 [debug] [Thread-1  ]: Began executing node model.dbt_idx.fact_orders
[0m16:20:46.761987 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_idx.fact_orders"
[0m16:20:46.786721 [debug] [Thread-1  ]: Using postgres connection "model.dbt_idx.fact_orders"
[0m16:20:46.788203 [debug] [Thread-1  ]: On model.dbt_idx.fact_orders: BEGIN
[0m16:20:46.789508 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m16:20:46.798895 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m16:20:46.800598 [debug] [Thread-1  ]: Using postgres connection "model.dbt_idx.fact_orders"
[0m16:20:46.802144 [debug] [Thread-1  ]: On model.dbt_idx.fact_orders: /* {"app": "dbt", "dbt_version": "1.5.6", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.fact_orders"} */

  
    

  create  table "IDX-Stock"."IDX-Schema"."fact_orders__dbt_tmp"
  
  
    as
  
  (
    with orders as (
    select *
    from "IDX-Stock"."IDX-Schema"."stg_eltool__orders"
)
select * from orders
  );
  
[0m16:20:46.808963 [debug] [Thread-1  ]: SQL status: SELECT 999 in 0.0 seconds
[0m16:20:46.814949 [debug] [Thread-1  ]: Using postgres connection "model.dbt_idx.fact_orders"
[0m16:20:46.816024 [debug] [Thread-1  ]: On model.dbt_idx.fact_orders: /* {"app": "dbt", "dbt_version": "1.5.6", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.fact_orders"} */
alter table "IDX-Stock"."IDX-Schema"."fact_orders" rename to "fact_orders__dbt_backup"
[0m16:20:46.817476 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m16:20:46.831557 [debug] [Thread-1  ]: Using postgres connection "model.dbt_idx.fact_orders"
[0m16:20:46.833052 [debug] [Thread-1  ]: On model.dbt_idx.fact_orders: /* {"app": "dbt", "dbt_version": "1.5.6", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.fact_orders"} */
alter table "IDX-Stock"."IDX-Schema"."fact_orders__dbt_tmp" rename to "fact_orders"
[0m16:20:46.834968 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m16:20:46.853501 [debug] [Thread-1  ]: On model.dbt_idx.fact_orders: COMMIT
[0m16:20:46.856439 [debug] [Thread-1  ]: Using postgres connection "model.dbt_idx.fact_orders"
[0m16:20:46.858615 [debug] [Thread-1  ]: On model.dbt_idx.fact_orders: COMMIT
[0m16:20:46.863588 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m16:20:46.868745 [debug] [Thread-1  ]: Using postgres connection "model.dbt_idx.fact_orders"
[0m16:20:46.870270 [debug] [Thread-1  ]: On model.dbt_idx.fact_orders: /* {"app": "dbt", "dbt_version": "1.5.6", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.fact_orders"} */
drop table if exists "IDX-Stock"."IDX-Schema"."fact_orders__dbt_backup" cascade
[0m16:20:46.875729 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
[0m16:20:46.879956 [debug] [Thread-1  ]: Timing info for model.dbt_idx.fact_orders (execute): 16:20:46.724860 => 16:20:46.879368
[0m16:20:46.881333 [debug] [Thread-1  ]: On model.dbt_idx.fact_orders: Close
[0m16:20:46.883681 [info ] [Thread-1  ]: 7 of 11 OK created sql table model IDX-Schema.fact_orders ...................... [[32mSELECT 999[0m in 0.20s]
[0m16:20:46.886667 [debug] [Thread-1  ]: Finished running node model.dbt_idx.fact_orders
[0m16:20:46.888945 [debug] [Thread-1  ]: Began running node model.dbt_idx.dim_customers
[0m16:20:46.890509 [info ] [Thread-1  ]: 8 of 11 START sql table model IDX-Schema.dim_customers ......................... [RUN]
[0m16:20:46.892273 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_idx.fact_orders, now model.dbt_idx.dim_customers)
[0m16:20:46.893364 [debug] [Thread-1  ]: Began compiling node model.dbt_idx.dim_customers
[0m16:20:46.899394 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_idx.dim_customers"
[0m16:20:46.929592 [debug] [Thread-1  ]: Timing info for model.dbt_idx.dim_customers (compile): 16:20:46.894809 => 16:20:46.928785
[0m16:20:46.931398 [debug] [Thread-1  ]: Began executing node model.dbt_idx.dim_customers
[0m16:20:46.940931 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_idx.dim_customers"
[0m16:20:46.971888 [debug] [Thread-1  ]: Using postgres connection "model.dbt_idx.dim_customers"
[0m16:20:46.973422 [debug] [Thread-1  ]: On model.dbt_idx.dim_customers: BEGIN
[0m16:20:46.974498 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m16:20:46.983805 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m16:20:46.985719 [debug] [Thread-1  ]: Using postgres connection "model.dbt_idx.dim_customers"
[0m16:20:46.987992 [debug] [Thread-1  ]: On model.dbt_idx.dim_customers: /* {"app": "dbt", "dbt_version": "1.5.6", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.dim_customers"} */

  
    

  create  table "IDX-Stock"."IDX-Schema"."dim_customers__dbt_tmp"
  
  
    as
  
  (
    -- noinspection SqlDialectInspectionForFile

with customers as (
    select *
    from "IDX-Stock"."IDX-Schema"."stg_eltool__customers_snapshots"
    ),
     state as (
         select *
         from "IDX-Stock"."IDX-Schema"."stg_eltool__state"
     )
select c.customer_id,
       c.zipcode,
       c.city,
       c.state_code,
       s.state_name,
       c.datetime_created,
       c.datetime_updated,
       c.dbt_valid_from::TIMESTAMP as valid_from,
        CASE WHEN c.dbt_valid_to IS NULL
            THEN '9999-12-31'::TIMESTAMP
            ELSE c.dbt_valid_to::TIMESTAMP
        END as valid_to
from customers c
    join state s on c.state_code = s.state_code
  );
  
[0m16:20:46.996755 [debug] [Thread-1  ]: SQL status: SELECT 100 in 0.0 seconds
[0m16:20:47.011148 [debug] [Thread-1  ]: Using postgres connection "model.dbt_idx.dim_customers"
[0m16:20:47.014163 [debug] [Thread-1  ]: On model.dbt_idx.dim_customers: /* {"app": "dbt", "dbt_version": "1.5.6", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.dim_customers"} */
alter table "IDX-Stock"."IDX-Schema"."dim_customers" rename to "dim_customers__dbt_backup"
[0m16:20:47.016665 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m16:20:47.024956 [debug] [Thread-1  ]: Using postgres connection "model.dbt_idx.dim_customers"
[0m16:20:47.027362 [debug] [Thread-1  ]: On model.dbt_idx.dim_customers: /* {"app": "dbt", "dbt_version": "1.5.6", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.dim_customers"} */
alter table "IDX-Stock"."IDX-Schema"."dim_customers__dbt_tmp" rename to "dim_customers"
[0m16:20:47.030748 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m16:20:47.035707 [debug] [Thread-1  ]: On model.dbt_idx.dim_customers: COMMIT
[0m16:20:47.037934 [debug] [Thread-1  ]: Using postgres connection "model.dbt_idx.dim_customers"
[0m16:20:47.040020 [debug] [Thread-1  ]: On model.dbt_idx.dim_customers: COMMIT
[0m16:20:47.043481 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m16:20:47.049708 [debug] [Thread-1  ]: Using postgres connection "model.dbt_idx.dim_customers"
[0m16:20:47.050895 [debug] [Thread-1  ]: On model.dbt_idx.dim_customers: /* {"app": "dbt", "dbt_version": "1.5.6", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.dim_customers"} */
drop table if exists "IDX-Stock"."IDX-Schema"."dim_customers__dbt_backup" cascade
[0m16:20:47.054956 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
[0m16:20:47.058339 [debug] [Thread-1  ]: Timing info for model.dbt_idx.dim_customers (execute): 16:20:46.932527 => 16:20:47.058093
[0m16:20:47.059388 [debug] [Thread-1  ]: On model.dbt_idx.dim_customers: Close
[0m16:20:47.062048 [info ] [Thread-1  ]: 8 of 11 OK created sql table model IDX-Schema.dim_customers .................... [[32mSELECT 100[0m in 0.17s]
[0m16:20:47.064500 [debug] [Thread-1  ]: Finished running node model.dbt_idx.dim_customers
[0m16:20:47.065637 [debug] [Thread-1  ]: Began running node model.dbt_idx.fact_stocks
[0m16:20:47.066813 [info ] [Thread-1  ]: 9 of 11 START sql table model IDX-Schema.fact_stocks ........................... [RUN]
[0m16:20:47.068530 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_idx.dim_customers, now model.dbt_idx.fact_stocks)
[0m16:20:47.070407 [debug] [Thread-1  ]: Began compiling node model.dbt_idx.fact_stocks
[0m16:20:47.076067 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_idx.fact_stocks"
[0m16:20:47.105072 [debug] [Thread-1  ]: Timing info for model.dbt_idx.fact_stocks (compile): 16:20:47.072322 => 16:20:47.104525
[0m16:20:47.106328 [debug] [Thread-1  ]: Began executing node model.dbt_idx.fact_stocks
[0m16:20:47.113965 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_idx.fact_stocks"
[0m16:20:47.139947 [debug] [Thread-1  ]: Using postgres connection "model.dbt_idx.fact_stocks"
[0m16:20:47.141015 [debug] [Thread-1  ]: On model.dbt_idx.fact_stocks: BEGIN
[0m16:20:47.141958 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m16:20:47.151175 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m16:20:47.154438 [debug] [Thread-1  ]: Using postgres connection "model.dbt_idx.fact_stocks"
[0m16:20:47.157343 [debug] [Thread-1  ]: On model.dbt_idx.fact_stocks: /* {"app": "dbt", "dbt_version": "1.5.6", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.fact_stocks"} */

  
    

  create  table "IDX-Stock"."IDX-Schema"."fact_stocks__dbt_tmp"
  
  
    as
  
  (
    -- noinspection SqlDialectInspectionForFile

with stock as (
    select *
    from "IDX-Stock"."IDX-Schema"."stg_eltool__stock"
    ),
     company as (
         select *
         from "IDX-Stock"."IDX-Schema"."stg_eltool__company"
     )
select a.id,
       a.ticker,
       b.name,
       a.date,
       a.open,
       a.high,
       a.low,
       a.close,
       a.volume,
       b.logo
from stock a
    join company b on a.ticker = b.ticker
  );
  
[0m16:20:47.230954 [debug] [Thread-1  ]: SQL status: SELECT 26131 in 0.0 seconds
[0m16:20:47.238614 [debug] [Thread-1  ]: Using postgres connection "model.dbt_idx.fact_stocks"
[0m16:20:47.240534 [debug] [Thread-1  ]: On model.dbt_idx.fact_stocks: /* {"app": "dbt", "dbt_version": "1.5.6", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.fact_stocks"} */
alter table "IDX-Stock"."IDX-Schema"."fact_stocks" rename to "fact_stocks__dbt_backup"
[0m16:20:47.243954 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m16:20:47.251278 [debug] [Thread-1  ]: Using postgres connection "model.dbt_idx.fact_stocks"
[0m16:20:47.253279 [debug] [Thread-1  ]: On model.dbt_idx.fact_stocks: /* {"app": "dbt", "dbt_version": "1.5.6", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.fact_stocks"} */
alter table "IDX-Stock"."IDX-Schema"."fact_stocks__dbt_tmp" rename to "fact_stocks"
[0m16:20:47.256188 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m16:20:47.263794 [debug] [Thread-1  ]: On model.dbt_idx.fact_stocks: COMMIT
[0m16:20:47.265343 [debug] [Thread-1  ]: Using postgres connection "model.dbt_idx.fact_stocks"
[0m16:20:47.266627 [debug] [Thread-1  ]: On model.dbt_idx.fact_stocks: COMMIT
[0m16:20:47.297465 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m16:20:47.301993 [debug] [Thread-1  ]: Using postgres connection "model.dbt_idx.fact_stocks"
[0m16:20:47.303399 [debug] [Thread-1  ]: On model.dbt_idx.fact_stocks: /* {"app": "dbt", "dbt_version": "1.5.6", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.fact_stocks"} */
drop table if exists "IDX-Stock"."IDX-Schema"."fact_stocks__dbt_backup" cascade
[0m16:20:47.308566 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
[0m16:20:47.312075 [debug] [Thread-1  ]: Timing info for model.dbt_idx.fact_stocks (execute): 16:20:47.107151 => 16:20:47.311798
[0m16:20:47.313440 [debug] [Thread-1  ]: On model.dbt_idx.fact_stocks: Close
[0m16:20:47.315198 [info ] [Thread-1  ]: 9 of 11 OK created sql table model IDX-Schema.fact_stocks ...................... [[32mSELECT 26131[0m in 0.25s]
[0m16:20:47.316761 [debug] [Thread-1  ]: Finished running node model.dbt_idx.fact_stocks
[0m16:20:47.317909 [debug] [Thread-1  ]: Began running node model.dbt_idx.customer_orders_status
[0m16:20:47.319711 [info ] [Thread-1  ]: 10 of 11 START sql view model IDX-Schema.customer_orders_status ................ [RUN]
[0m16:20:47.322836 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_idx.fact_stocks, now model.dbt_idx.customer_orders_status)
[0m16:20:47.324059 [debug] [Thread-1  ]: Began compiling node model.dbt_idx.customer_orders_status
[0m16:20:47.330000 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_idx.customer_orders_status"
[0m16:20:47.360758 [debug] [Thread-1  ]: Timing info for model.dbt_idx.customer_orders_status (compile): 16:20:47.324970 => 16:20:47.360223
[0m16:20:47.362311 [debug] [Thread-1  ]: Began executing node model.dbt_idx.customer_orders_status
[0m16:20:47.372056 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_idx.customer_orders_status"
[0m16:20:47.398724 [debug] [Thread-1  ]: Using postgres connection "model.dbt_idx.customer_orders_status"
[0m16:20:47.399992 [debug] [Thread-1  ]: On model.dbt_idx.customer_orders_status: BEGIN
[0m16:20:47.400960 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m16:20:47.409906 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m16:20:47.412741 [debug] [Thread-1  ]: Using postgres connection "model.dbt_idx.customer_orders_status"
[0m16:20:47.415097 [debug] [Thread-1  ]: On model.dbt_idx.customer_orders_status: /* {"app": "dbt", "dbt_version": "1.5.6", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.customer_orders_status"} */

  create view "IDX-Stock"."IDX-Schema"."customer_orders_status__dbt_tmp"
    
    
  as (
    with orders as (select *
                from "IDX-Stock"."IDX-Schema"."fact_orders"),
     customers as (select *
                   from "IDX-Stock"."IDX-Schema"."dim_customers")
select o.order_id,
       o.customer_id,
       o.order_status,
       o.order_purchase_timestamp,
       o.order_approved_at,
       o.order_delivered_carrier_date,
       o.order_delivered_customer_date,
       o.order_estimated_delivery_date,
       c.zipcode    as customer_zipcode,
       c.city       as customer_city,
       c.state_code as customer_state_code,
       c.state_name as customer_state_name
from orders o
    join customers c on o.customer_id = c.customer_id
    and o.order_purchase_timestamp >= c.valid_from
    and o.order_purchase_timestamp <= c.valid_to
  );
[0m16:20:47.420183 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m16:20:47.426906 [debug] [Thread-1  ]: Using postgres connection "model.dbt_idx.customer_orders_status"
[0m16:20:47.430449 [debug] [Thread-1  ]: On model.dbt_idx.customer_orders_status: /* {"app": "dbt", "dbt_version": "1.5.6", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.customer_orders_status"} */
alter table "IDX-Stock"."IDX-Schema"."customer_orders_status__dbt_tmp" rename to "customer_orders_status"
[0m16:20:47.434042 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m16:20:47.440801 [debug] [Thread-1  ]: On model.dbt_idx.customer_orders_status: COMMIT
[0m16:20:47.442286 [debug] [Thread-1  ]: Using postgres connection "model.dbt_idx.customer_orders_status"
[0m16:20:47.443472 [debug] [Thread-1  ]: On model.dbt_idx.customer_orders_status: COMMIT
[0m16:20:47.448424 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m16:20:47.454399 [debug] [Thread-1  ]: Using postgres connection "model.dbt_idx.customer_orders_status"
[0m16:20:47.456058 [debug] [Thread-1  ]: On model.dbt_idx.customer_orders_status: /* {"app": "dbt", "dbt_version": "1.5.6", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.customer_orders_status"} */
drop view if exists "IDX-Stock"."IDX-Schema"."customer_orders_status__dbt_backup" cascade
[0m16:20:47.457576 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
[0m16:20:47.461489 [debug] [Thread-1  ]: Timing info for model.dbt_idx.customer_orders_status (execute): 16:20:47.363439 => 16:20:47.461000
[0m16:20:47.463764 [debug] [Thread-1  ]: On model.dbt_idx.customer_orders_status: Close
[0m16:20:47.465992 [info ] [Thread-1  ]: 10 of 11 OK created sql view model IDX-Schema.customer_orders_status ........... [[32mCREATE VIEW[0m in 0.14s]
[0m16:20:47.467809 [debug] [Thread-1  ]: Finished running node model.dbt_idx.customer_orders_status
[0m16:20:47.469573 [debug] [Thread-1  ]: Began running node model.dbt_idx.stock_update_status
[0m16:20:47.471770 [info ] [Thread-1  ]: 11 of 11 START sql view model IDX-Schema.stock_update_status ................... [RUN]
[0m16:20:47.473671 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.dbt_idx.customer_orders_status, now model.dbt_idx.stock_update_status)
[0m16:20:47.474814 [debug] [Thread-1  ]: Began compiling node model.dbt_idx.stock_update_status
[0m16:20:47.483603 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_idx.stock_update_status"
[0m16:20:47.518231 [debug] [Thread-1  ]: Timing info for model.dbt_idx.stock_update_status (compile): 16:20:47.476163 => 16:20:47.517846
[0m16:20:47.520142 [debug] [Thread-1  ]: Began executing node model.dbt_idx.stock_update_status
[0m16:20:47.533857 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_idx.stock_update_status"
[0m16:20:47.576866 [debug] [Thread-1  ]: Using postgres connection "model.dbt_idx.stock_update_status"
[0m16:20:47.579758 [debug] [Thread-1  ]: On model.dbt_idx.stock_update_status: BEGIN
[0m16:20:47.582073 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m16:20:47.594335 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m16:20:47.597243 [debug] [Thread-1  ]: Using postgres connection "model.dbt_idx.stock_update_status"
[0m16:20:47.598965 [debug] [Thread-1  ]: On model.dbt_idx.stock_update_status: /* {"app": "dbt", "dbt_version": "1.5.6", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stock_update_status"} */

  create view "IDX-Stock"."IDX-Schema"."stock_update_status__dbt_tmp"
    
    
  as (
    with stock as (select *,
                        rank() over (
                        partition by ticker
                        order by date desc
                        ) as rank
               from "IDX-Stock"."IDX-Schema"."fact_stocks")
select a.id,
       a.ticker,
       a.name,
       a.date,
       a.open,
       a.high,
       a.low,
       a.close,
       a.volume,
       a.rank,
       a.logo
from stock a
order by a.date desc, a.ticker desc
  );
[0m16:20:47.606995 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m16:20:47.624568 [debug] [Thread-1  ]: Using postgres connection "model.dbt_idx.stock_update_status"
[0m16:20:47.626579 [debug] [Thread-1  ]: On model.dbt_idx.stock_update_status: /* {"app": "dbt", "dbt_version": "1.5.6", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stock_update_status"} */
alter table "IDX-Stock"."IDX-Schema"."stock_update_status__dbt_tmp" rename to "stock_update_status"
[0m16:20:47.631143 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m16:20:47.636375 [debug] [Thread-1  ]: On model.dbt_idx.stock_update_status: COMMIT
[0m16:20:47.638450 [debug] [Thread-1  ]: Using postgres connection "model.dbt_idx.stock_update_status"
[0m16:20:47.640723 [debug] [Thread-1  ]: On model.dbt_idx.stock_update_status: COMMIT
[0m16:20:47.644375 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m16:20:47.651084 [debug] [Thread-1  ]: Using postgres connection "model.dbt_idx.stock_update_status"
[0m16:20:47.652866 [debug] [Thread-1  ]: On model.dbt_idx.stock_update_status: /* {"app": "dbt", "dbt_version": "1.5.6", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stock_update_status"} */
drop view if exists "IDX-Stock"."IDX-Schema"."stock_update_status__dbt_backup" cascade
[0m16:20:47.655232 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
[0m16:20:47.658696 [debug] [Thread-1  ]: Timing info for model.dbt_idx.stock_update_status (execute): 16:20:47.522022 => 16:20:47.658443
[0m16:20:47.659985 [debug] [Thread-1  ]: On model.dbt_idx.stock_update_status: Close
[0m16:20:47.664620 [info ] [Thread-1  ]: 11 of 11 OK created sql view model IDX-Schema.stock_update_status .............. [[32mCREATE VIEW[0m in 0.19s]
[0m16:20:47.666473 [debug] [Thread-1  ]: Finished running node model.dbt_idx.stock_update_status
[0m16:20:47.743672 [debug] [MainThread]: Using postgres connection "master"
[0m16:20:47.745941 [debug] [MainThread]: On master: BEGIN
[0m16:20:47.748304 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:20:47.760571 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m16:20:47.762915 [debug] [MainThread]: On master: COMMIT
[0m16:20:47.765370 [debug] [MainThread]: Using postgres connection "master"
[0m16:20:47.767628 [debug] [MainThread]: On master: COMMIT
[0m16:20:47.771141 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m16:20:47.776059 [debug] [MainThread]: On master: Close
[0m16:20:47.781254 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:20:47.784493 [debug] [MainThread]: Connection 'model.dbt_idx.stock_update_status' was properly closed.
[0m16:20:47.788196 [info ] [MainThread]: 
[0m16:20:47.792546 [info ] [MainThread]: Finished running 8 view models, 3 table models in 0 hours 0 minutes and 2.68 seconds (2.68s).
[0m16:20:47.809095 [debug] [MainThread]: Command end result
[0m16:20:47.878739 [info ] [MainThread]: 
[0m16:20:47.881652 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:20:47.884393 [info ] [MainThread]: 
[0m16:20:47.886602 [info ] [MainThread]: Done. PASS=11 WARN=0 ERROR=0 SKIP=0 TOTAL=11
[0m16:20:47.889517 [debug] [MainThread]: Command `dbt run` succeeded at 16:20:47.889066 after 4.45 seconds
[0m16:20:47.891471 [debug] [MainThread]: Flushing usage events


============================== 16:20:54.914238 | 3ff27b82-4404-40de-a9d2-54cffabeb517 ==============================
[0m16:20:54.914238 [info ] [MainThread]: Running with dbt=1.5.6
[0m16:20:54.923216 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dags/Py-DBT-IDX', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/opt/airflow/dags/Py-DBT-IDX/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'send_anonymous_usage_stats': 'False'}
[0m16:20:55.165707 [info ] [MainThread]: Registered adapter: postgres=1.5.6
[0m16:20:55.200779 [debug] [MainThread]: checksum: 36b91491eb2b55e69ff526c98e337edadb953c9826242889489b2fea40332ad6, vars: {}, profile: , target: , version: 1.5.6
[0m16:20:56.246773 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:20:56.247928 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:20:56.309823 [info ] [MainThread]: Found 11 models, 19 tests, 1 snapshot, 0 analyses, 307 macros, 0 operations, 0 seed files, 5 sources, 0 exposures, 0 metrics, 0 groups
[0m16:20:56.315803 [info ] [MainThread]: 
[0m16:20:56.318307 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m16:20:56.322407 [debug] [ThreadPool]: Acquiring new postgres connection 'list_IDX-Stock_IDX-Schema'
[0m16:20:56.339786 [debug] [ThreadPool]: Using postgres connection "list_IDX-Stock_IDX-Schema"
[0m16:20:56.340920 [debug] [ThreadPool]: On list_IDX-Stock_IDX-Schema: BEGIN
[0m16:20:56.341837 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:20:56.352715 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m16:20:56.354593 [debug] [ThreadPool]: Using postgres connection "list_IDX-Stock_IDX-Schema"
[0m16:20:56.355815 [debug] [ThreadPool]: On list_IDX-Stock_IDX-Schema: /* {"app": "dbt", "dbt_version": "1.5.6", "profile_name": "dbt_idx", "target_name": "dev", "connection_name": "list_IDX-Stock_IDX-Schema"} */
select
      'IDX-Stock' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'IDX-Schema'
    union all
    select
      'IDX-Stock' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'IDX-Schema'
  
[0m16:20:56.361953 [debug] [ThreadPool]: SQL status: SELECT 17 in 0.0 seconds
[0m16:20:56.366631 [debug] [ThreadPool]: On list_IDX-Stock_IDX-Schema: ROLLBACK
[0m16:20:56.370916 [debug] [ThreadPool]: On list_IDX-Stock_IDX-Schema: Close
[0m16:20:56.375071 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_IDX-Stock_IDX-Schema, now list_IDX-Stock_snapshots)
[0m16:20:56.387558 [debug] [ThreadPool]: Using postgres connection "list_IDX-Stock_snapshots"
[0m16:20:56.391485 [debug] [ThreadPool]: On list_IDX-Stock_snapshots: BEGIN
[0m16:20:56.393167 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:20:56.403895 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m16:20:56.405569 [debug] [ThreadPool]: Using postgres connection "list_IDX-Stock_snapshots"
[0m16:20:56.407443 [debug] [ThreadPool]: On list_IDX-Stock_snapshots: /* {"app": "dbt", "dbt_version": "1.5.6", "profile_name": "dbt_idx", "target_name": "dev", "connection_name": "list_IDX-Stock_snapshots"} */
select
      'IDX-Stock' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'snapshots'
    union all
    select
      'IDX-Stock' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'snapshots'
  
[0m16:20:56.413224 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.0 seconds
[0m16:20:56.416771 [debug] [ThreadPool]: On list_IDX-Stock_snapshots: ROLLBACK
[0m16:20:56.419634 [debug] [ThreadPool]: On list_IDX-Stock_snapshots: Close
[0m16:20:56.441369 [debug] [MainThread]: Using postgres connection "master"
[0m16:20:56.444899 [debug] [MainThread]: On master: BEGIN
[0m16:20:56.447436 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:20:56.461867 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m16:20:56.464261 [debug] [MainThread]: Using postgres connection "master"
[0m16:20:56.466876 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.5.6", "profile_name": "dbt_idx", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m16:20:56.480712 [debug] [MainThread]: SQL status: SELECT 9 in 0.0 seconds
[0m16:20:56.489238 [debug] [MainThread]: On master: ROLLBACK
[0m16:20:56.490847 [debug] [MainThread]: Using postgres connection "master"
[0m16:20:56.491855 [debug] [MainThread]: On master: BEGIN
[0m16:20:56.495841 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m16:20:56.498888 [debug] [MainThread]: On master: COMMIT
[0m16:20:56.501384 [debug] [MainThread]: Using postgres connection "master"
[0m16:20:56.504210 [debug] [MainThread]: On master: COMMIT
[0m16:20:56.507733 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m16:20:56.509731 [debug] [MainThread]: On master: Close
[0m16:20:56.515052 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:20:56.517242 [info ] [MainThread]: 
[0m16:20:56.532649 [debug] [Thread-1  ]: Began running node test.dbt_idx.accepted_values_customer_orders_status_order_status__delivered__invoiced__shipped__processing__canceled__unavailable.ea8c296d27
[0m16:20:56.534463 [info ] [Thread-1  ]: 1 of 19 START test accepted_values_customer_orders_status_order_status__delivered__invoiced__shipped__processing__canceled__unavailable  [RUN]
[0m16:20:56.538448 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_IDX-Stock_snapshots, now test.dbt_idx.accepted_values_customer_orders_status_order_status__delivered__invoiced__shipped__processing__canceled__unavailable.ea8c296d27)
[0m16:20:56.541607 [debug] [Thread-1  ]: Began compiling node test.dbt_idx.accepted_values_customer_orders_status_order_status__delivered__invoiced__shipped__processing__canceled__unavailable.ea8c296d27
[0m16:20:56.580729 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_idx.accepted_values_customer_orders_status_order_status__delivered__invoiced__shipped__processing__canceled__unavailable.ea8c296d27"
[0m16:20:56.613005 [debug] [Thread-1  ]: Timing info for test.dbt_idx.accepted_values_customer_orders_status_order_status__delivered__invoiced__shipped__processing__canceled__unavailable.ea8c296d27 (compile): 16:20:56.544092 => 16:20:56.612531
[0m16:20:56.614162 [debug] [Thread-1  ]: Began executing node test.dbt_idx.accepted_values_customer_orders_status_order_status__delivered__invoiced__shipped__processing__canceled__unavailable.ea8c296d27
[0m16:20:56.637882 [debug] [Thread-1  ]: Writing runtime sql for node "test.dbt_idx.accepted_values_customer_orders_status_order_status__delivered__invoiced__shipped__processing__canceled__unavailable.ea8c296d27"
[0m16:20:56.668559 [debug] [Thread-1  ]: Using postgres connection "test.dbt_idx.accepted_values_customer_orders_status_order_status__delivered__invoiced__shipped__processing__canceled__unavailable.ea8c296d27"
[0m16:20:56.670009 [debug] [Thread-1  ]: On test.dbt_idx.accepted_values_customer_orders_status_order_status__delivered__invoiced__shipped__processing__canceled__unavailable.ea8c296d27: BEGIN
[0m16:20:56.671026 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m16:20:56.679841 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m16:20:56.681573 [debug] [Thread-1  ]: Using postgres connection "test.dbt_idx.accepted_values_customer_orders_status_order_status__delivered__invoiced__shipped__processing__canceled__unavailable.ea8c296d27"
[0m16:20:56.682839 [debug] [Thread-1  ]: On test.dbt_idx.accepted_values_customer_orders_status_order_status__delivered__invoiced__shipped__processing__canceled__unavailable.ea8c296d27: /* {"app": "dbt", "dbt_version": "1.5.6", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "test.dbt_idx.accepted_values_customer_orders_status_order_status__delivered__invoiced__shipped__processing__canceled__unavailable.ea8c296d27"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        order_status as value_field,
        count(*) as n_records

    from "IDX-Stock"."IDX-Schema"."customer_orders_status"
    group by order_status

)

select *
from all_values
where value_field not in (
    'delivered','invoiced','shipped','processing','canceled','unavailable'
)



      
    ) dbt_internal_test
[0m16:20:56.689717 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.0 seconds
[0m16:20:56.697398 [debug] [Thread-1  ]: Timing info for test.dbt_idx.accepted_values_customer_orders_status_order_status__delivered__invoiced__shipped__processing__canceled__unavailable.ea8c296d27 (execute): 16:20:56.615039 => 16:20:56.696281
[0m16:20:56.699419 [debug] [Thread-1  ]: On test.dbt_idx.accepted_values_customer_orders_status_order_status__delivered__invoiced__shipped__processing__canceled__unavailable.ea8c296d27: ROLLBACK
[0m16:20:56.702621 [debug] [Thread-1  ]: On test.dbt_idx.accepted_values_customer_orders_status_order_status__delivered__invoiced__shipped__processing__canceled__unavailable.ea8c296d27: Close
[0m16:20:56.707102 [info ] [Thread-1  ]: 1 of 19 PASS accepted_values_customer_orders_status_order_status__delivered__invoiced__shipped__processing__canceled__unavailable  [[32mPASS[0m in 0.17s]
[0m16:20:56.710889 [debug] [Thread-1  ]: Finished running node test.dbt_idx.accepted_values_customer_orders_status_order_status__delivered__invoiced__shipped__processing__canceled__unavailable.ea8c296d27
[0m16:20:56.713369 [debug] [Thread-1  ]: Began running node test.dbt_idx.assert_customer_dimension_has_no_row_loss.sql
[0m16:20:56.715948 [info ] [Thread-1  ]: 2 of 19 START test assert_customer_dimension_has_no_row_loss.sql ............... [RUN]
[0m16:20:56.719233 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.dbt_idx.accepted_values_customer_orders_status_order_status__delivered__invoiced__shipped__processing__canceled__unavailable.ea8c296d27, now test.dbt_idx.assert_customer_dimension_has_no_row_loss.sql)
[0m16:20:56.721935 [debug] [Thread-1  ]: Began compiling node test.dbt_idx.assert_customer_dimension_has_no_row_loss.sql
[0m16:20:56.730242 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_idx.assert_customer_dimension_has_no_row_loss.sql"
[0m16:20:56.753395 [debug] [Thread-1  ]: Timing info for test.dbt_idx.assert_customer_dimension_has_no_row_loss.sql (compile): 16:20:56.723986 => 16:20:56.752888
[0m16:20:56.754565 [debug] [Thread-1  ]: Began executing node test.dbt_idx.assert_customer_dimension_has_no_row_loss.sql
[0m16:20:56.758399 [debug] [Thread-1  ]: Writing runtime sql for node "test.dbt_idx.assert_customer_dimension_has_no_row_loss.sql"
[0m16:20:56.779528 [debug] [Thread-1  ]: Using postgres connection "test.dbt_idx.assert_customer_dimension_has_no_row_loss.sql"
[0m16:20:56.780633 [debug] [Thread-1  ]: On test.dbt_idx.assert_customer_dimension_has_no_row_loss.sql: BEGIN
[0m16:20:56.781572 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m16:20:56.790715 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m16:20:56.792213 [debug] [Thread-1  ]: Using postgres connection "test.dbt_idx.assert_customer_dimension_has_no_row_loss.sql"
[0m16:20:56.794311 [debug] [Thread-1  ]: On test.dbt_idx.assert_customer_dimension_has_no_row_loss.sql: /* {"app": "dbt", "dbt_version": "1.5.6", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "test.dbt_idx.assert_customer_dimension_has_no_row_loss.sql"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      -- dim_customers must have the same number of rows as its staging counterpart
-- Therefore return records where this isn't true to make the test fail
select *
from (
    select dim_cust.customer_id
    from "IDX-Stock"."IDX-Schema"."dim_customers" dim_cust
        left join "IDX-Stock"."IDX-Schema"."stg_eltool__customers_snapshots" stg_cust
    on dim_cust.customer_id = stg_cust.customer_id
    where stg_cust.customer_id is null
    UNION ALL
    select stg_cust.customer_id
    from "IDX-Stock"."IDX-Schema"."stg_eltool__customers_snapshots" stg_cust
      left join "IDX-Stock"."IDX-Schema"."dim_customers" dim_cust
    on stg_cust.customer_id = dim_cust.customer_id
    where dim_cust.customer_id is null
) tmp
      
    ) dbt_internal_test
[0m16:20:56.799614 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.0 seconds
[0m16:20:56.805027 [debug] [Thread-1  ]: Timing info for test.dbt_idx.assert_customer_dimension_has_no_row_loss.sql (execute): 16:20:56.755456 => 16:20:56.804633
[0m16:20:56.806233 [debug] [Thread-1  ]: On test.dbt_idx.assert_customer_dimension_has_no_row_loss.sql: ROLLBACK
[0m16:20:56.807502 [debug] [Thread-1  ]: On test.dbt_idx.assert_customer_dimension_has_no_row_loss.sql: Close
[0m16:20:56.810778 [info ] [Thread-1  ]: 2 of 19 PASS assert_customer_dimension_has_no_row_loss.sql ..................... [[32mPASS[0m in 0.09s]
[0m16:20:56.814636 [debug] [Thread-1  ]: Finished running node test.dbt_idx.assert_customer_dimension_has_no_row_loss.sql
[0m16:20:56.817122 [debug] [Thread-1  ]: Began running node test.dbt_idx.assert_stock_fact_has_no_row_loss.sql
[0m16:20:56.820284 [info ] [Thread-1  ]: 3 of 19 START test assert_stock_fact_has_no_row_loss.sql ....................... [RUN]
[0m16:20:56.823321 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.dbt_idx.assert_customer_dimension_has_no_row_loss.sql, now test.dbt_idx.assert_stock_fact_has_no_row_loss.sql)
[0m16:20:56.824652 [debug] [Thread-1  ]: Began compiling node test.dbt_idx.assert_stock_fact_has_no_row_loss.sql
[0m16:20:56.835148 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_idx.assert_stock_fact_has_no_row_loss.sql"
[0m16:20:56.865991 [debug] [Thread-1  ]: Timing info for test.dbt_idx.assert_stock_fact_has_no_row_loss.sql (compile): 16:20:56.826129 => 16:20:56.865582
[0m16:20:56.867491 [debug] [Thread-1  ]: Began executing node test.dbt_idx.assert_stock_fact_has_no_row_loss.sql
[0m16:20:56.873808 [debug] [Thread-1  ]: Writing runtime sql for node "test.dbt_idx.assert_stock_fact_has_no_row_loss.sql"
[0m16:20:56.902705 [debug] [Thread-1  ]: Using postgres connection "test.dbt_idx.assert_stock_fact_has_no_row_loss.sql"
[0m16:20:56.905188 [debug] [Thread-1  ]: On test.dbt_idx.assert_stock_fact_has_no_row_loss.sql: BEGIN
[0m16:20:56.907138 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m16:20:56.920783 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m16:20:56.923404 [debug] [Thread-1  ]: Using postgres connection "test.dbt_idx.assert_stock_fact_has_no_row_loss.sql"
[0m16:20:56.926300 [debug] [Thread-1  ]: On test.dbt_idx.assert_stock_fact_has_no_row_loss.sql: /* {"app": "dbt", "dbt_version": "1.5.6", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "test.dbt_idx.assert_stock_fact_has_no_row_loss.sql"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      -- fact_stocks must have the same number of rows as its staging counterpart
-- Therefore return records where this isn't true to make the test fail
select *
from (
    select stock.id
    from "IDX-Stock"."IDX-Schema"."fact_stocks" stock
    where stock.id is null
) tmp
      
    ) dbt_internal_test
[0m16:20:56.939747 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.0 seconds
[0m16:20:56.946629 [debug] [Thread-1  ]: Timing info for test.dbt_idx.assert_stock_fact_has_no_row_loss.sql (execute): 16:20:56.869191 => 16:20:56.945753
[0m16:20:56.951035 [debug] [Thread-1  ]: On test.dbt_idx.assert_stock_fact_has_no_row_loss.sql: ROLLBACK
[0m16:20:56.954209 [debug] [Thread-1  ]: On test.dbt_idx.assert_stock_fact_has_no_row_loss.sql: Close
[0m16:20:56.958478 [info ] [Thread-1  ]: 3 of 19 PASS assert_stock_fact_has_no_row_loss.sql ............................. [[32mPASS[0m in 0.14s]
[0m16:20:56.965080 [debug] [Thread-1  ]: Finished running node test.dbt_idx.assert_stock_fact_has_no_row_loss.sql
[0m16:20:56.967689 [debug] [Thread-1  ]: Began running node test.dbt_idx.not_null_customer_orders_status_customer_id.3915c814eb
[0m16:20:56.970884 [info ] [Thread-1  ]: 4 of 19 START test not_null_customer_orders_status_customer_id ................. [RUN]
[0m16:20:56.973601 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.dbt_idx.assert_stock_fact_has_no_row_loss.sql, now test.dbt_idx.not_null_customer_orders_status_customer_id.3915c814eb)
[0m16:20:56.975259 [debug] [Thread-1  ]: Began compiling node test.dbt_idx.not_null_customer_orders_status_customer_id.3915c814eb
[0m16:20:56.995128 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_idx.not_null_customer_orders_status_customer_id.3915c814eb"
[0m16:20:57.038334 [debug] [Thread-1  ]: Timing info for test.dbt_idx.not_null_customer_orders_status_customer_id.3915c814eb (compile): 16:20:56.977008 => 16:20:57.037947
[0m16:20:57.039598 [debug] [Thread-1  ]: Began executing node test.dbt_idx.not_null_customer_orders_status_customer_id.3915c814eb
[0m16:20:57.046545 [debug] [Thread-1  ]: Writing runtime sql for node "test.dbt_idx.not_null_customer_orders_status_customer_id.3915c814eb"
[0m16:20:57.082216 [debug] [Thread-1  ]: Using postgres connection "test.dbt_idx.not_null_customer_orders_status_customer_id.3915c814eb"
[0m16:20:57.084321 [debug] [Thread-1  ]: On test.dbt_idx.not_null_customer_orders_status_customer_id.3915c814eb: BEGIN
[0m16:20:57.086525 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m16:20:57.095725 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m16:20:57.097928 [debug] [Thread-1  ]: Using postgres connection "test.dbt_idx.not_null_customer_orders_status_customer_id.3915c814eb"
[0m16:20:57.100549 [debug] [Thread-1  ]: On test.dbt_idx.not_null_customer_orders_status_customer_id.3915c814eb: /* {"app": "dbt", "dbt_version": "1.5.6", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "test.dbt_idx.not_null_customer_orders_status_customer_id.3915c814eb"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select customer_id
from "IDX-Stock"."IDX-Schema"."customer_orders_status"
where customer_id is null



      
    ) dbt_internal_test
[0m16:20:57.106169 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.0 seconds
[0m16:20:57.110141 [debug] [Thread-1  ]: Timing info for test.dbt_idx.not_null_customer_orders_status_customer_id.3915c814eb (execute): 16:20:57.040454 => 16:20:57.109523
[0m16:20:57.113588 [debug] [Thread-1  ]: On test.dbt_idx.not_null_customer_orders_status_customer_id.3915c814eb: ROLLBACK
[0m16:20:57.116270 [debug] [Thread-1  ]: On test.dbt_idx.not_null_customer_orders_status_customer_id.3915c814eb: Close
[0m16:20:57.121138 [info ] [Thread-1  ]: 4 of 19 PASS not_null_customer_orders_status_customer_id ....................... [[32mPASS[0m in 0.15s]
[0m16:20:57.124896 [debug] [Thread-1  ]: Finished running node test.dbt_idx.not_null_customer_orders_status_customer_id.3915c814eb
[0m16:20:57.127903 [debug] [Thread-1  ]: Began running node test.dbt_idx.not_null_dim_customers_customer_id.dd91cd1c8d
[0m16:20:57.130779 [info ] [Thread-1  ]: 5 of 19 START test not_null_dim_customers_customer_id .......................... [RUN]
[0m16:20:57.135250 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.dbt_idx.not_null_customer_orders_status_customer_id.3915c814eb, now test.dbt_idx.not_null_dim_customers_customer_id.dd91cd1c8d)
[0m16:20:57.138136 [debug] [Thread-1  ]: Began compiling node test.dbt_idx.not_null_dim_customers_customer_id.dd91cd1c8d
[0m16:20:57.154031 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_idx.not_null_dim_customers_customer_id.dd91cd1c8d"
[0m16:20:57.192961 [debug] [Thread-1  ]: Timing info for test.dbt_idx.not_null_dim_customers_customer_id.dd91cd1c8d (compile): 16:20:57.141387 => 16:20:57.191900
[0m16:20:57.195477 [debug] [Thread-1  ]: Began executing node test.dbt_idx.not_null_dim_customers_customer_id.dd91cd1c8d
[0m16:20:57.204331 [debug] [Thread-1  ]: Writing runtime sql for node "test.dbt_idx.not_null_dim_customers_customer_id.dd91cd1c8d"
[0m16:20:57.241014 [debug] [Thread-1  ]: Using postgres connection "test.dbt_idx.not_null_dim_customers_customer_id.dd91cd1c8d"
[0m16:20:57.243633 [debug] [Thread-1  ]: On test.dbt_idx.not_null_dim_customers_customer_id.dd91cd1c8d: BEGIN
[0m16:20:57.245892 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m16:20:57.261608 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m16:20:57.264692 [debug] [Thread-1  ]: Using postgres connection "test.dbt_idx.not_null_dim_customers_customer_id.dd91cd1c8d"
[0m16:20:57.269319 [debug] [Thread-1  ]: On test.dbt_idx.not_null_dim_customers_customer_id.dd91cd1c8d: /* {"app": "dbt", "dbt_version": "1.5.6", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "test.dbt_idx.not_null_dim_customers_customer_id.dd91cd1c8d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select customer_id
from "IDX-Stock"."IDX-Schema"."dim_customers"
where customer_id is null



      
    ) dbt_internal_test
[0m16:20:57.277853 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.0 seconds
[0m16:20:57.283196 [debug] [Thread-1  ]: Timing info for test.dbt_idx.not_null_dim_customers_customer_id.dd91cd1c8d (execute): 16:20:57.196996 => 16:20:57.282603
[0m16:20:57.286947 [debug] [Thread-1  ]: On test.dbt_idx.not_null_dim_customers_customer_id.dd91cd1c8d: ROLLBACK
[0m16:20:57.290396 [debug] [Thread-1  ]: On test.dbt_idx.not_null_dim_customers_customer_id.dd91cd1c8d: Close
[0m16:20:57.295395 [info ] [Thread-1  ]: 5 of 19 PASS not_null_dim_customers_customer_id ................................ [[32mPASS[0m in 0.16s]
[0m16:20:57.300405 [debug] [Thread-1  ]: Finished running node test.dbt_idx.not_null_dim_customers_customer_id.dd91cd1c8d
[0m16:20:57.304946 [debug] [Thread-1  ]: Began running node test.dbt_idx.not_null_fact_stocks_id.e7b7e788fa
[0m16:20:57.309179 [info ] [Thread-1  ]: 6 of 19 START test not_null_fact_stocks_id ..................................... [RUN]
[0m16:20:57.314123 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.dbt_idx.not_null_dim_customers_customer_id.dd91cd1c8d, now test.dbt_idx.not_null_fact_stocks_id.e7b7e788fa)
[0m16:20:57.324590 [debug] [Thread-1  ]: Began compiling node test.dbt_idx.not_null_fact_stocks_id.e7b7e788fa
[0m16:20:57.352613 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_idx.not_null_fact_stocks_id.e7b7e788fa"
[0m16:20:57.406484 [debug] [Thread-1  ]: Timing info for test.dbt_idx.not_null_fact_stocks_id.e7b7e788fa (compile): 16:20:57.329188 => 16:20:57.405126
[0m16:20:57.413988 [debug] [Thread-1  ]: Began executing node test.dbt_idx.not_null_fact_stocks_id.e7b7e788fa
[0m16:20:57.431160 [debug] [Thread-1  ]: Writing runtime sql for node "test.dbt_idx.not_null_fact_stocks_id.e7b7e788fa"
[0m16:20:57.483360 [debug] [Thread-1  ]: Using postgres connection "test.dbt_idx.not_null_fact_stocks_id.e7b7e788fa"
[0m16:20:57.486070 [debug] [Thread-1  ]: On test.dbt_idx.not_null_fact_stocks_id.e7b7e788fa: BEGIN
[0m16:20:57.488490 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m16:20:57.508463 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m16:20:57.514386 [debug] [Thread-1  ]: Using postgres connection "test.dbt_idx.not_null_fact_stocks_id.e7b7e788fa"
[0m16:20:57.516238 [debug] [Thread-1  ]: On test.dbt_idx.not_null_fact_stocks_id.e7b7e788fa: /* {"app": "dbt", "dbt_version": "1.5.6", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "test.dbt_idx.not_null_fact_stocks_id.e7b7e788fa"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from "IDX-Stock"."IDX-Schema"."fact_stocks"
where id is null



      
    ) dbt_internal_test
[0m16:20:57.524342 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.0 seconds
[0m16:20:57.531523 [debug] [Thread-1  ]: Timing info for test.dbt_idx.not_null_fact_stocks_id.e7b7e788fa (execute): 16:20:57.415999 => 16:20:57.530687
[0m16:20:57.534150 [debug] [Thread-1  ]: On test.dbt_idx.not_null_fact_stocks_id.e7b7e788fa: ROLLBACK
[0m16:20:57.536800 [debug] [Thread-1  ]: On test.dbt_idx.not_null_fact_stocks_id.e7b7e788fa: Close
[0m16:20:57.541027 [info ] [Thread-1  ]: 6 of 19 PASS not_null_fact_stocks_id ........................................... [[32mPASS[0m in 0.23s]
[0m16:20:57.546245 [debug] [Thread-1  ]: Finished running node test.dbt_idx.not_null_fact_stocks_id.e7b7e788fa
[0m16:20:57.548492 [debug] [Thread-1  ]: Began running node test.dbt_idx.not_null_stg_eltool__company_id.632831b79c
[0m16:20:57.550008 [info ] [Thread-1  ]: 7 of 19 START test not_null_stg_eltool__company_id ............................. [RUN]
[0m16:20:57.553186 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.dbt_idx.not_null_fact_stocks_id.e7b7e788fa, now test.dbt_idx.not_null_stg_eltool__company_id.632831b79c)
[0m16:20:57.555432 [debug] [Thread-1  ]: Began compiling node test.dbt_idx.not_null_stg_eltool__company_id.632831b79c
[0m16:20:57.565751 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_idx.not_null_stg_eltool__company_id.632831b79c"
[0m16:20:57.594866 [debug] [Thread-1  ]: Timing info for test.dbt_idx.not_null_stg_eltool__company_id.632831b79c (compile): 16:20:57.556616 => 16:20:57.594401
[0m16:20:57.596209 [debug] [Thread-1  ]: Began executing node test.dbt_idx.not_null_stg_eltool__company_id.632831b79c
[0m16:20:57.601713 [debug] [Thread-1  ]: Writing runtime sql for node "test.dbt_idx.not_null_stg_eltool__company_id.632831b79c"
[0m16:20:57.629811 [debug] [Thread-1  ]: Using postgres connection "test.dbt_idx.not_null_stg_eltool__company_id.632831b79c"
[0m16:20:57.631067 [debug] [Thread-1  ]: On test.dbt_idx.not_null_stg_eltool__company_id.632831b79c: BEGIN
[0m16:20:57.632205 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m16:20:57.642719 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m16:20:57.644752 [debug] [Thread-1  ]: Using postgres connection "test.dbt_idx.not_null_stg_eltool__company_id.632831b79c"
[0m16:20:57.646421 [debug] [Thread-1  ]: On test.dbt_idx.not_null_stg_eltool__company_id.632831b79c: /* {"app": "dbt", "dbt_version": "1.5.6", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "test.dbt_idx.not_null_stg_eltool__company_id.632831b79c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from "IDX-Stock"."IDX-Schema"."stg_eltool__company"
where id is null



      
    ) dbt_internal_test
[0m16:20:57.650955 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.0 seconds
[0m16:20:57.657306 [debug] [Thread-1  ]: Timing info for test.dbt_idx.not_null_stg_eltool__company_id.632831b79c (execute): 16:20:57.597337 => 16:20:57.656852
[0m16:20:57.660321 [debug] [Thread-1  ]: On test.dbt_idx.not_null_stg_eltool__company_id.632831b79c: ROLLBACK
[0m16:20:57.663906 [debug] [Thread-1  ]: On test.dbt_idx.not_null_stg_eltool__company_id.632831b79c: Close
[0m16:20:57.668710 [info ] [Thread-1  ]: 7 of 19 PASS not_null_stg_eltool__company_id ................................... [[32mPASS[0m in 0.12s]
[0m16:20:57.672584 [debug] [Thread-1  ]: Finished running node test.dbt_idx.not_null_stg_eltool__company_id.632831b79c
[0m16:20:57.676308 [debug] [Thread-1  ]: Began running node test.dbt_idx.not_null_stg_eltool__customers_snapshots_customer_id.ea4fc4ca86
[0m16:20:57.679535 [info ] [Thread-1  ]: 8 of 19 START test not_null_stg_eltool__customers_snapshots_customer_id ........ [RUN]
[0m16:20:57.683286 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.dbt_idx.not_null_stg_eltool__company_id.632831b79c, now test.dbt_idx.not_null_stg_eltool__customers_snapshots_customer_id.ea4fc4ca86)
[0m16:20:57.685655 [debug] [Thread-1  ]: Began compiling node test.dbt_idx.not_null_stg_eltool__customers_snapshots_customer_id.ea4fc4ca86
[0m16:20:57.696927 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_idx.not_null_stg_eltool__customers_snapshots_customer_id.ea4fc4ca86"
[0m16:20:57.729397 [debug] [Thread-1  ]: Timing info for test.dbt_idx.not_null_stg_eltool__customers_snapshots_customer_id.ea4fc4ca86 (compile): 16:20:57.688449 => 16:20:57.728653
[0m16:20:57.731805 [debug] [Thread-1  ]: Began executing node test.dbt_idx.not_null_stg_eltool__customers_snapshots_customer_id.ea4fc4ca86
[0m16:20:57.738012 [debug] [Thread-1  ]: Writing runtime sql for node "test.dbt_idx.not_null_stg_eltool__customers_snapshots_customer_id.ea4fc4ca86"
[0m16:20:57.772254 [debug] [Thread-1  ]: Using postgres connection "test.dbt_idx.not_null_stg_eltool__customers_snapshots_customer_id.ea4fc4ca86"
[0m16:20:57.773572 [debug] [Thread-1  ]: On test.dbt_idx.not_null_stg_eltool__customers_snapshots_customer_id.ea4fc4ca86: BEGIN
[0m16:20:57.774651 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m16:20:57.785767 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m16:20:57.788494 [debug] [Thread-1  ]: Using postgres connection "test.dbt_idx.not_null_stg_eltool__customers_snapshots_customer_id.ea4fc4ca86"
[0m16:20:57.790696 [debug] [Thread-1  ]: On test.dbt_idx.not_null_stg_eltool__customers_snapshots_customer_id.ea4fc4ca86: /* {"app": "dbt", "dbt_version": "1.5.6", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "test.dbt_idx.not_null_stg_eltool__customers_snapshots_customer_id.ea4fc4ca86"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select customer_id
from "IDX-Stock"."IDX-Schema"."stg_eltool__customers_snapshots"
where customer_id is null



      
    ) dbt_internal_test
[0m16:20:57.797334 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.0 seconds
[0m16:20:57.803581 [debug] [Thread-1  ]: Timing info for test.dbt_idx.not_null_stg_eltool__customers_snapshots_customer_id.ea4fc4ca86 (execute): 16:20:57.733343 => 16:20:57.802270
[0m16:20:57.807525 [debug] [Thread-1  ]: On test.dbt_idx.not_null_stg_eltool__customers_snapshots_customer_id.ea4fc4ca86: ROLLBACK
[0m16:20:57.810400 [debug] [Thread-1  ]: On test.dbt_idx.not_null_stg_eltool__customers_snapshots_customer_id.ea4fc4ca86: Close
[0m16:20:57.813991 [info ] [Thread-1  ]: 8 of 19 PASS not_null_stg_eltool__customers_snapshots_customer_id .............. [[32mPASS[0m in 0.13s]
[0m16:20:57.817189 [debug] [Thread-1  ]: Finished running node test.dbt_idx.not_null_stg_eltool__customers_snapshots_customer_id.ea4fc4ca86
[0m16:20:57.820400 [debug] [Thread-1  ]: Began running node test.dbt_idx.not_null_stg_eltool__stock_id.68f6d1d89a
[0m16:20:57.823863 [info ] [Thread-1  ]: 9 of 19 START test not_null_stg_eltool__stock_id ............................... [RUN]
[0m16:20:57.828221 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.dbt_idx.not_null_stg_eltool__customers_snapshots_customer_id.ea4fc4ca86, now test.dbt_idx.not_null_stg_eltool__stock_id.68f6d1d89a)
[0m16:20:57.830261 [debug] [Thread-1  ]: Began compiling node test.dbt_idx.not_null_stg_eltool__stock_id.68f6d1d89a
[0m16:20:57.843202 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_idx.not_null_stg_eltool__stock_id.68f6d1d89a"
[0m16:20:57.876648 [debug] [Thread-1  ]: Timing info for test.dbt_idx.not_null_stg_eltool__stock_id.68f6d1d89a (compile): 16:20:57.831421 => 16:20:57.876039
[0m16:20:57.878505 [debug] [Thread-1  ]: Began executing node test.dbt_idx.not_null_stg_eltool__stock_id.68f6d1d89a
[0m16:20:57.943814 [debug] [Thread-1  ]: Writing runtime sql for node "test.dbt_idx.not_null_stg_eltool__stock_id.68f6d1d89a"
[0m16:20:57.978167 [debug] [Thread-1  ]: Using postgres connection "test.dbt_idx.not_null_stg_eltool__stock_id.68f6d1d89a"
[0m16:20:57.980144 [debug] [Thread-1  ]: On test.dbt_idx.not_null_stg_eltool__stock_id.68f6d1d89a: BEGIN
[0m16:20:57.981443 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m16:20:58.001892 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m16:20:58.004642 [debug] [Thread-1  ]: Using postgres connection "test.dbt_idx.not_null_stg_eltool__stock_id.68f6d1d89a"
[0m16:20:58.006899 [debug] [Thread-1  ]: On test.dbt_idx.not_null_stg_eltool__stock_id.68f6d1d89a: /* {"app": "dbt", "dbt_version": "1.5.6", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "test.dbt_idx.not_null_stg_eltool__stock_id.68f6d1d89a"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from "IDX-Stock"."IDX-Schema"."stg_eltool__stock"
where id is null



      
    ) dbt_internal_test
[0m16:20:58.020079 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.0 seconds
[0m16:20:58.028155 [debug] [Thread-1  ]: Timing info for test.dbt_idx.not_null_stg_eltool__stock_id.68f6d1d89a (execute): 16:20:57.879787 => 16:20:58.027147
[0m16:20:58.031234 [debug] [Thread-1  ]: On test.dbt_idx.not_null_stg_eltool__stock_id.68f6d1d89a: ROLLBACK
[0m16:20:58.035884 [debug] [Thread-1  ]: On test.dbt_idx.not_null_stg_eltool__stock_id.68f6d1d89a: Close
[0m16:20:58.041768 [info ] [Thread-1  ]: 9 of 19 PASS not_null_stg_eltool__stock_id ..................................... [[32mPASS[0m in 0.21s]
[0m16:20:58.047663 [debug] [Thread-1  ]: Finished running node test.dbt_idx.not_null_stg_eltool__stock_id.68f6d1d89a
[0m16:20:58.050215 [debug] [Thread-1  ]: Began running node test.dbt_idx.not_null_stock_update_status_id.633bc8afe3
[0m16:20:58.053206 [info ] [Thread-1  ]: 10 of 19 START test not_null_stock_update_status_id ............................ [RUN]
[0m16:20:58.058714 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.dbt_idx.not_null_stg_eltool__stock_id.68f6d1d89a, now test.dbt_idx.not_null_stock_update_status_id.633bc8afe3)
[0m16:20:58.061533 [debug] [Thread-1  ]: Began compiling node test.dbt_idx.not_null_stock_update_status_id.633bc8afe3
[0m16:20:58.082999 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_idx.not_null_stock_update_status_id.633bc8afe3"
[0m16:20:58.116999 [debug] [Thread-1  ]: Timing info for test.dbt_idx.not_null_stock_update_status_id.633bc8afe3 (compile): 16:20:58.063582 => 16:20:58.116386
[0m16:20:58.119125 [debug] [Thread-1  ]: Began executing node test.dbt_idx.not_null_stock_update_status_id.633bc8afe3
[0m16:20:58.125681 [debug] [Thread-1  ]: Writing runtime sql for node "test.dbt_idx.not_null_stock_update_status_id.633bc8afe3"
[0m16:20:58.166015 [debug] [Thread-1  ]: Using postgres connection "test.dbt_idx.not_null_stock_update_status_id.633bc8afe3"
[0m16:20:58.167801 [debug] [Thread-1  ]: On test.dbt_idx.not_null_stock_update_status_id.633bc8afe3: BEGIN
[0m16:20:58.169940 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m16:20:58.181296 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m16:20:58.183100 [debug] [Thread-1  ]: Using postgres connection "test.dbt_idx.not_null_stock_update_status_id.633bc8afe3"
[0m16:20:58.185546 [debug] [Thread-1  ]: On test.dbt_idx.not_null_stock_update_status_id.633bc8afe3: /* {"app": "dbt", "dbt_version": "1.5.6", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "test.dbt_idx.not_null_stock_update_status_id.633bc8afe3"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from "IDX-Stock"."IDX-Schema"."stock_update_status"
where id is null



      
    ) dbt_internal_test
[0m16:20:58.198221 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.0 seconds
[0m16:20:58.203225 [debug] [Thread-1  ]: Timing info for test.dbt_idx.not_null_stock_update_status_id.633bc8afe3 (execute): 16:20:58.120479 => 16:20:58.202480
[0m16:20:58.204868 [debug] [Thread-1  ]: On test.dbt_idx.not_null_stock_update_status_id.633bc8afe3: ROLLBACK
[0m16:20:58.206530 [debug] [Thread-1  ]: On test.dbt_idx.not_null_stock_update_status_id.633bc8afe3: Close
[0m16:20:58.209385 [info ] [Thread-1  ]: 10 of 19 PASS not_null_stock_update_status_id .................................. [[32mPASS[0m in 0.15s]
[0m16:20:58.214113 [debug] [Thread-1  ]: Finished running node test.dbt_idx.not_null_stock_update_status_id.633bc8afe3
[0m16:20:58.215799 [debug] [Thread-1  ]: Began running node test.dbt_idx.source_not_null_IDX-Schema_customers_customer_id.8525798d49
[0m16:20:58.217298 [info ] [Thread-1  ]: 11 of 19 START test source_not_null_IDX-Schema_customers_customer_id ........... [RUN]
[0m16:20:58.220019 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.dbt_idx.not_null_stock_update_status_id.633bc8afe3, now test.dbt_idx.source_not_null_IDX-Schema_customers_customer_id.8525798d49)
[0m16:20:58.222559 [debug] [Thread-1  ]: Began compiling node test.dbt_idx.source_not_null_IDX-Schema_customers_customer_id.8525798d49
[0m16:20:58.240400 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_idx.source_not_null_IDX-Schema_customers_customer_id.8525798d49"
[0m16:20:58.270422 [debug] [Thread-1  ]: Timing info for test.dbt_idx.source_not_null_IDX-Schema_customers_customer_id.8525798d49 (compile): 16:20:58.224320 => 16:20:58.269825
[0m16:20:58.271757 [debug] [Thread-1  ]: Began executing node test.dbt_idx.source_not_null_IDX-Schema_customers_customer_id.8525798d49
[0m16:20:58.277171 [debug] [Thread-1  ]: Writing runtime sql for node "test.dbt_idx.source_not_null_IDX-Schema_customers_customer_id.8525798d49"
[0m16:20:58.303285 [debug] [Thread-1  ]: Using postgres connection "test.dbt_idx.source_not_null_IDX-Schema_customers_customer_id.8525798d49"
[0m16:20:58.304832 [debug] [Thread-1  ]: On test.dbt_idx.source_not_null_IDX-Schema_customers_customer_id.8525798d49: BEGIN
[0m16:20:58.306145 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m16:20:58.319455 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m16:20:58.321518 [debug] [Thread-1  ]: Using postgres connection "test.dbt_idx.source_not_null_IDX-Schema_customers_customer_id.8525798d49"
[0m16:20:58.323170 [debug] [Thread-1  ]: On test.dbt_idx.source_not_null_IDX-Schema_customers_customer_id.8525798d49: /* {"app": "dbt", "dbt_version": "1.5.6", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "test.dbt_idx.source_not_null_IDX-Schema_customers_customer_id.8525798d49"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select customer_id
from "IDX-Stock"."IDX-Schema"."customers"
where customer_id is null



      
    ) dbt_internal_test
[0m16:20:58.328483 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.0 seconds
[0m16:20:58.332985 [debug] [Thread-1  ]: Timing info for test.dbt_idx.source_not_null_IDX-Schema_customers_customer_id.8525798d49 (execute): 16:20:58.272775 => 16:20:58.332552
[0m16:20:58.337059 [debug] [Thread-1  ]: On test.dbt_idx.source_not_null_IDX-Schema_customers_customer_id.8525798d49: ROLLBACK
[0m16:20:58.340822 [debug] [Thread-1  ]: On test.dbt_idx.source_not_null_IDX-Schema_customers_customer_id.8525798d49: Close
[0m16:20:58.346465 [info ] [Thread-1  ]: 11 of 19 PASS source_not_null_IDX-Schema_customers_customer_id ................. [[32mPASS[0m in 0.13s]
[0m16:20:58.350111 [debug] [Thread-1  ]: Finished running node test.dbt_idx.source_not_null_IDX-Schema_customers_customer_id.8525798d49
[0m16:20:58.353383 [debug] [Thread-1  ]: Began running node test.dbt_idx.source_not_null_IDX-Schema_ksql-company-stream_id.d088b78209
[0m16:20:58.356880 [info ] [Thread-1  ]: 12 of 19 START test source_not_null_IDX-Schema_ksql-company-stream_id .......... [RUN]
[0m16:20:58.360536 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.dbt_idx.source_not_null_IDX-Schema_customers_customer_id.8525798d49, now test.dbt_idx.source_not_null_IDX-Schema_ksql-company-stream_id.d088b78209)
[0m16:20:58.362975 [debug] [Thread-1  ]: Began compiling node test.dbt_idx.source_not_null_IDX-Schema_ksql-company-stream_id.d088b78209
[0m16:20:58.374263 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_idx.source_not_null_IDX-Schema_ksql-company-stream_id.d088b78209"
[0m16:20:58.405452 [debug] [Thread-1  ]: Timing info for test.dbt_idx.source_not_null_IDX-Schema_ksql-company-stream_id.d088b78209 (compile): 16:20:58.364215 => 16:20:58.404952
[0m16:20:58.406960 [debug] [Thread-1  ]: Began executing node test.dbt_idx.source_not_null_IDX-Schema_ksql-company-stream_id.d088b78209
[0m16:20:58.412966 [debug] [Thread-1  ]: Writing runtime sql for node "test.dbt_idx.source_not_null_IDX-Schema_ksql-company-stream_id.d088b78209"
[0m16:20:58.439631 [debug] [Thread-1  ]: Using postgres connection "test.dbt_idx.source_not_null_IDX-Schema_ksql-company-stream_id.d088b78209"
[0m16:20:58.440979 [debug] [Thread-1  ]: On test.dbt_idx.source_not_null_IDX-Schema_ksql-company-stream_id.d088b78209: BEGIN
[0m16:20:58.442713 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m16:20:58.453757 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m16:20:58.455436 [debug] [Thread-1  ]: Using postgres connection "test.dbt_idx.source_not_null_IDX-Schema_ksql-company-stream_id.d088b78209"
[0m16:20:58.456941 [debug] [Thread-1  ]: On test.dbt_idx.source_not_null_IDX-Schema_ksql-company-stream_id.d088b78209: /* {"app": "dbt", "dbt_version": "1.5.6", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "test.dbt_idx.source_not_null_IDX-Schema_ksql-company-stream_id.d088b78209"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from "IDX-Stock"."IDX-Schema"."ksql-company-stream"
where id is null



      
    ) dbt_internal_test
[0m16:20:58.462403 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.0 seconds
[0m16:20:58.466431 [debug] [Thread-1  ]: Timing info for test.dbt_idx.source_not_null_IDX-Schema_ksql-company-stream_id.d088b78209 (execute): 16:20:58.408049 => 16:20:58.465969
[0m16:20:58.469515 [debug] [Thread-1  ]: On test.dbt_idx.source_not_null_IDX-Schema_ksql-company-stream_id.d088b78209: ROLLBACK
[0m16:20:58.472033 [debug] [Thread-1  ]: On test.dbt_idx.source_not_null_IDX-Schema_ksql-company-stream_id.d088b78209: Close
[0m16:20:58.476557 [info ] [Thread-1  ]: 12 of 19 PASS source_not_null_IDX-Schema_ksql-company-stream_id ................ [[32mPASS[0m in 0.12s]
[0m16:20:58.479465 [debug] [Thread-1  ]: Finished running node test.dbt_idx.source_not_null_IDX-Schema_ksql-company-stream_id.d088b78209
[0m16:20:58.481130 [debug] [Thread-1  ]: Began running node test.dbt_idx.source_not_null_IDX-Schema_ksql-stock-stream_id.b3b44ecba6
[0m16:20:58.483964 [info ] [Thread-1  ]: 13 of 19 START test source_not_null_IDX-Schema_ksql-stock-stream_id ............ [RUN]
[0m16:20:58.486727 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.dbt_idx.source_not_null_IDX-Schema_ksql-company-stream_id.d088b78209, now test.dbt_idx.source_not_null_IDX-Schema_ksql-stock-stream_id.b3b44ecba6)
[0m16:20:58.489182 [debug] [Thread-1  ]: Began compiling node test.dbt_idx.source_not_null_IDX-Schema_ksql-stock-stream_id.b3b44ecba6
[0m16:20:58.499420 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_idx.source_not_null_IDX-Schema_ksql-stock-stream_id.b3b44ecba6"
[0m16:20:58.528233 [debug] [Thread-1  ]: Timing info for test.dbt_idx.source_not_null_IDX-Schema_ksql-stock-stream_id.b3b44ecba6 (compile): 16:20:58.490333 => 16:20:58.527744
[0m16:20:58.529631 [debug] [Thread-1  ]: Began executing node test.dbt_idx.source_not_null_IDX-Schema_ksql-stock-stream_id.b3b44ecba6
[0m16:20:58.535237 [debug] [Thread-1  ]: Writing runtime sql for node "test.dbt_idx.source_not_null_IDX-Schema_ksql-stock-stream_id.b3b44ecba6"
[0m16:20:58.561864 [debug] [Thread-1  ]: Using postgres connection "test.dbt_idx.source_not_null_IDX-Schema_ksql-stock-stream_id.b3b44ecba6"
[0m16:20:58.563190 [debug] [Thread-1  ]: On test.dbt_idx.source_not_null_IDX-Schema_ksql-stock-stream_id.b3b44ecba6: BEGIN
[0m16:20:58.564387 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m16:20:58.575287 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m16:20:58.577201 [debug] [Thread-1  ]: Using postgres connection "test.dbt_idx.source_not_null_IDX-Schema_ksql-stock-stream_id.b3b44ecba6"
[0m16:20:58.579216 [debug] [Thread-1  ]: On test.dbt_idx.source_not_null_IDX-Schema_ksql-stock-stream_id.b3b44ecba6: /* {"app": "dbt", "dbt_version": "1.5.6", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "test.dbt_idx.source_not_null_IDX-Schema_ksql-stock-stream_id.b3b44ecba6"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from "IDX-Stock"."IDX-Schema"."ksql-stock-stream"
where id is null



      
    ) dbt_internal_test
[0m16:20:58.587748 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.0 seconds
[0m16:20:58.593304 [debug] [Thread-1  ]: Timing info for test.dbt_idx.source_not_null_IDX-Schema_ksql-stock-stream_id.b3b44ecba6 (execute): 16:20:58.530692 => 16:20:58.592084
[0m16:20:58.596472 [debug] [Thread-1  ]: On test.dbt_idx.source_not_null_IDX-Schema_ksql-stock-stream_id.b3b44ecba6: ROLLBACK
[0m16:20:58.599438 [debug] [Thread-1  ]: On test.dbt_idx.source_not_null_IDX-Schema_ksql-stock-stream_id.b3b44ecba6: Close
[0m16:20:58.603409 [info ] [Thread-1  ]: 13 of 19 PASS source_not_null_IDX-Schema_ksql-stock-stream_id .................. [[32mPASS[0m in 0.12s]
[0m16:20:58.607501 [debug] [Thread-1  ]: Finished running node test.dbt_idx.source_not_null_IDX-Schema_ksql-stock-stream_id.b3b44ecba6
[0m16:20:58.610294 [debug] [Thread-1  ]: Began running node test.dbt_idx.source_not_null_IDX-Schema_orders_order_id.f2383dcca5
[0m16:20:58.614298 [info ] [Thread-1  ]: 14 of 19 START test source_not_null_IDX-Schema_orders_order_id ................. [RUN]
[0m16:20:58.616446 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.dbt_idx.source_not_null_IDX-Schema_ksql-stock-stream_id.b3b44ecba6, now test.dbt_idx.source_not_null_IDX-Schema_orders_order_id.f2383dcca5)
[0m16:20:58.618220 [debug] [Thread-1  ]: Began compiling node test.dbt_idx.source_not_null_IDX-Schema_orders_order_id.f2383dcca5
[0m16:20:58.634533 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_idx.source_not_null_IDX-Schema_orders_order_id.f2383dcca5"
[0m16:20:58.660632 [debug] [Thread-1  ]: Timing info for test.dbt_idx.source_not_null_IDX-Schema_orders_order_id.f2383dcca5 (compile): 16:20:58.619969 => 16:20:58.659868
[0m16:20:58.662075 [debug] [Thread-1  ]: Began executing node test.dbt_idx.source_not_null_IDX-Schema_orders_order_id.f2383dcca5
[0m16:20:58.666622 [debug] [Thread-1  ]: Writing runtime sql for node "test.dbt_idx.source_not_null_IDX-Schema_orders_order_id.f2383dcca5"
[0m16:20:58.691142 [debug] [Thread-1  ]: Using postgres connection "test.dbt_idx.source_not_null_IDX-Schema_orders_order_id.f2383dcca5"
[0m16:20:58.692994 [debug] [Thread-1  ]: On test.dbt_idx.source_not_null_IDX-Schema_orders_order_id.f2383dcca5: BEGIN
[0m16:20:58.694539 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m16:20:58.704526 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m16:20:58.705901 [debug] [Thread-1  ]: Using postgres connection "test.dbt_idx.source_not_null_IDX-Schema_orders_order_id.f2383dcca5"
[0m16:20:58.707399 [debug] [Thread-1  ]: On test.dbt_idx.source_not_null_IDX-Schema_orders_order_id.f2383dcca5: /* {"app": "dbt", "dbt_version": "1.5.6", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "test.dbt_idx.source_not_null_IDX-Schema_orders_order_id.f2383dcca5"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select order_id
from "IDX-Stock"."IDX-Schema"."orders"
where order_id is null



      
    ) dbt_internal_test
[0m16:20:58.711131 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.0 seconds
[0m16:20:58.715407 [debug] [Thread-1  ]: Timing info for test.dbt_idx.source_not_null_IDX-Schema_orders_order_id.f2383dcca5 (execute): 16:20:58.663049 => 16:20:58.715011
[0m16:20:58.716720 [debug] [Thread-1  ]: On test.dbt_idx.source_not_null_IDX-Schema_orders_order_id.f2383dcca5: ROLLBACK
[0m16:20:58.720642 [debug] [Thread-1  ]: On test.dbt_idx.source_not_null_IDX-Schema_orders_order_id.f2383dcca5: Close
[0m16:20:58.724267 [info ] [Thread-1  ]: 14 of 19 PASS source_not_null_IDX-Schema_orders_order_id ....................... [[32mPASS[0m in 0.11s]
[0m16:20:58.727750 [debug] [Thread-1  ]: Finished running node test.dbt_idx.source_not_null_IDX-Schema_orders_order_id.f2383dcca5
[0m16:20:58.729562 [debug] [Thread-1  ]: Began running node test.dbt_idx.source_relationships_IDX-Schema_orders_cust_id__customer_id__source_IDX_Schema_customers_.dc582657bc
[0m16:20:58.731181 [info ] [Thread-1  ]: 15 of 19 START test source_relationships_IDX-Schema_orders_cust_id__customer_id__source_IDX_Schema_customers_  [RUN]
[0m16:20:58.735288 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.dbt_idx.source_not_null_IDX-Schema_orders_order_id.f2383dcca5, now test.dbt_idx.source_relationships_IDX-Schema_orders_cust_id__customer_id__source_IDX_Schema_customers_.dc582657bc)
[0m16:20:58.737176 [debug] [Thread-1  ]: Began compiling node test.dbt_idx.source_relationships_IDX-Schema_orders_cust_id__customer_id__source_IDX_Schema_customers_.dc582657bc
[0m16:20:58.760391 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_idx.source_relationships_IDX-Schema_orders_cust_id__customer_id__source_IDX_Schema_customers_.dc582657bc"
[0m16:20:58.786484 [debug] [Thread-1  ]: Timing info for test.dbt_idx.source_relationships_IDX-Schema_orders_cust_id__customer_id__source_IDX_Schema_customers_.dc582657bc (compile): 16:20:58.739615 => 16:20:58.785957
[0m16:20:58.787912 [debug] [Thread-1  ]: Began executing node test.dbt_idx.source_relationships_IDX-Schema_orders_cust_id__customer_id__source_IDX_Schema_customers_.dc582657bc
[0m16:20:58.793048 [debug] [Thread-1  ]: Writing runtime sql for node "test.dbt_idx.source_relationships_IDX-Schema_orders_cust_id__customer_id__source_IDX_Schema_customers_.dc582657bc"
[0m16:20:58.818760 [debug] [Thread-1  ]: Using postgres connection "test.dbt_idx.source_relationships_IDX-Schema_orders_cust_id__customer_id__source_IDX_Schema_customers_.dc582657bc"
[0m16:20:58.820564 [debug] [Thread-1  ]: On test.dbt_idx.source_relationships_IDX-Schema_orders_cust_id__customer_id__source_IDX_Schema_customers_.dc582657bc: BEGIN
[0m16:20:58.821836 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m16:20:58.831910 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m16:20:58.833596 [debug] [Thread-1  ]: Using postgres connection "test.dbt_idx.source_relationships_IDX-Schema_orders_cust_id__customer_id__source_IDX_Schema_customers_.dc582657bc"
[0m16:20:58.835911 [debug] [Thread-1  ]: On test.dbt_idx.source_relationships_IDX-Schema_orders_cust_id__customer_id__source_IDX_Schema_customers_.dc582657bc: /* {"app": "dbt", "dbt_version": "1.5.6", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "test.dbt_idx.source_relationships_IDX-Schema_orders_cust_id__customer_id__source_IDX_Schema_customers_.dc582657bc"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select cust_id as from_field
    from "IDX-Stock"."IDX-Schema"."orders"
    where cust_id is not null
),

parent as (
    select customer_id as to_field
    from "IDX-Stock"."IDX-Schema"."customers"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m16:20:58.841455 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.0 seconds
[0m16:20:58.846087 [debug] [Thread-1  ]: Timing info for test.dbt_idx.source_relationships_IDX-Schema_orders_cust_id__customer_id__source_IDX_Schema_customers_.dc582657bc (execute): 16:20:58.788930 => 16:20:58.845556
[0m16:20:58.847766 [debug] [Thread-1  ]: On test.dbt_idx.source_relationships_IDX-Schema_orders_cust_id__customer_id__source_IDX_Schema_customers_.dc582657bc: ROLLBACK
[0m16:20:58.849417 [debug] [Thread-1  ]: On test.dbt_idx.source_relationships_IDX-Schema_orders_cust_id__customer_id__source_IDX_Schema_customers_.dc582657bc: Close
[0m16:20:58.854426 [info ] [Thread-1  ]: 15 of 19 PASS source_relationships_IDX-Schema_orders_cust_id__customer_id__source_IDX_Schema_customers_  [[32mPASS[0m in 0.12s]
[0m16:20:58.858230 [debug] [Thread-1  ]: Finished running node test.dbt_idx.source_relationships_IDX-Schema_orders_cust_id__customer_id__source_IDX_Schema_customers_.dc582657bc
[0m16:20:58.860953 [debug] [Thread-1  ]: Began running node test.dbt_idx.source_unique_IDX-Schema_ksql-company-stream_id.09232074f4
[0m16:20:58.862793 [info ] [Thread-1  ]: 16 of 19 START test source_unique_IDX-Schema_ksql-company-stream_id ............ [RUN]
[0m16:20:58.866823 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.dbt_idx.source_relationships_IDX-Schema_orders_cust_id__customer_id__source_IDX_Schema_customers_.dc582657bc, now test.dbt_idx.source_unique_IDX-Schema_ksql-company-stream_id.09232074f4)
[0m16:20:58.869235 [debug] [Thread-1  ]: Began compiling node test.dbt_idx.source_unique_IDX-Schema_ksql-company-stream_id.09232074f4
[0m16:20:58.885519 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_idx.source_unique_IDX-Schema_ksql-company-stream_id.09232074f4"
[0m16:20:58.913827 [debug] [Thread-1  ]: Timing info for test.dbt_idx.source_unique_IDX-Schema_ksql-company-stream_id.09232074f4 (compile): 16:20:58.871117 => 16:20:58.913336
[0m16:20:58.915184 [debug] [Thread-1  ]: Began executing node test.dbt_idx.source_unique_IDX-Schema_ksql-company-stream_id.09232074f4
[0m16:20:58.920830 [debug] [Thread-1  ]: Writing runtime sql for node "test.dbt_idx.source_unique_IDX-Schema_ksql-company-stream_id.09232074f4"
[0m16:20:58.946408 [debug] [Thread-1  ]: Using postgres connection "test.dbt_idx.source_unique_IDX-Schema_ksql-company-stream_id.09232074f4"
[0m16:20:58.947774 [debug] [Thread-1  ]: On test.dbt_idx.source_unique_IDX-Schema_ksql-company-stream_id.09232074f4: BEGIN
[0m16:20:58.948973 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m16:20:58.959933 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m16:20:58.961951 [debug] [Thread-1  ]: Using postgres connection "test.dbt_idx.source_unique_IDX-Schema_ksql-company-stream_id.09232074f4"
[0m16:20:58.963589 [debug] [Thread-1  ]: On test.dbt_idx.source_unique_IDX-Schema_ksql-company-stream_id.09232074f4: /* {"app": "dbt", "dbt_version": "1.5.6", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "test.dbt_idx.source_unique_IDX-Schema_ksql-company-stream_id.09232074f4"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from "IDX-Stock"."IDX-Schema"."ksql-company-stream"
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
[0m16:20:58.968469 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.0 seconds
[0m16:20:58.973972 [debug] [Thread-1  ]: Timing info for test.dbt_idx.source_unique_IDX-Schema_ksql-company-stream_id.09232074f4 (execute): 16:20:58.916317 => 16:20:58.973585
[0m16:20:58.975491 [debug] [Thread-1  ]: On test.dbt_idx.source_unique_IDX-Schema_ksql-company-stream_id.09232074f4: ROLLBACK
[0m16:20:58.979445 [debug] [Thread-1  ]: On test.dbt_idx.source_unique_IDX-Schema_ksql-company-stream_id.09232074f4: Close
[0m16:20:58.982802 [info ] [Thread-1  ]: 16 of 19 PASS source_unique_IDX-Schema_ksql-company-stream_id .................. [[32mPASS[0m in 0.12s]
[0m16:20:58.986299 [debug] [Thread-1  ]: Finished running node test.dbt_idx.source_unique_IDX-Schema_ksql-company-stream_id.09232074f4
[0m16:20:58.988778 [debug] [Thread-1  ]: Began running node test.dbt_idx.source_unique_IDX-Schema_ksql-stock-stream_id.2119c5c33b
[0m16:20:58.990735 [info ] [Thread-1  ]: 17 of 19 START test source_unique_IDX-Schema_ksql-stock-stream_id .............. [RUN]
[0m16:20:58.994593 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.dbt_idx.source_unique_IDX-Schema_ksql-company-stream_id.09232074f4, now test.dbt_idx.source_unique_IDX-Schema_ksql-stock-stream_id.2119c5c33b)
[0m16:20:58.996980 [debug] [Thread-1  ]: Began compiling node test.dbt_idx.source_unique_IDX-Schema_ksql-stock-stream_id.2119c5c33b
[0m16:20:59.013156 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_idx.source_unique_IDX-Schema_ksql-stock-stream_id.2119c5c33b"
[0m16:20:59.041391 [debug] [Thread-1  ]: Timing info for test.dbt_idx.source_unique_IDX-Schema_ksql-stock-stream_id.2119c5c33b (compile): 16:20:58.998953 => 16:20:59.040944
[0m16:20:59.042931 [debug] [Thread-1  ]: Began executing node test.dbt_idx.source_unique_IDX-Schema_ksql-stock-stream_id.2119c5c33b
[0m16:20:59.050349 [debug] [Thread-1  ]: Writing runtime sql for node "test.dbt_idx.source_unique_IDX-Schema_ksql-stock-stream_id.2119c5c33b"
[0m16:20:59.082121 [debug] [Thread-1  ]: Using postgres connection "test.dbt_idx.source_unique_IDX-Schema_ksql-stock-stream_id.2119c5c33b"
[0m16:20:59.083979 [debug] [Thread-1  ]: On test.dbt_idx.source_unique_IDX-Schema_ksql-stock-stream_id.2119c5c33b: BEGIN
[0m16:20:59.086301 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m16:20:59.099301 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m16:20:59.101391 [debug] [Thread-1  ]: Using postgres connection "test.dbt_idx.source_unique_IDX-Schema_ksql-stock-stream_id.2119c5c33b"
[0m16:20:59.103978 [debug] [Thread-1  ]: On test.dbt_idx.source_unique_IDX-Schema_ksql-stock-stream_id.2119c5c33b: /* {"app": "dbt", "dbt_version": "1.5.6", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "test.dbt_idx.source_unique_IDX-Schema_ksql-stock-stream_id.2119c5c33b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from "IDX-Stock"."IDX-Schema"."ksql-stock-stream"
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
[0m16:20:59.141076 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.0 seconds
[0m16:20:59.146153 [debug] [Thread-1  ]: Timing info for test.dbt_idx.source_unique_IDX-Schema_ksql-stock-stream_id.2119c5c33b (execute): 16:20:59.044605 => 16:20:59.145713
[0m16:20:59.147472 [debug] [Thread-1  ]: On test.dbt_idx.source_unique_IDX-Schema_ksql-stock-stream_id.2119c5c33b: ROLLBACK
[0m16:20:59.149402 [debug] [Thread-1  ]: On test.dbt_idx.source_unique_IDX-Schema_ksql-stock-stream_id.2119c5c33b: Close
[0m16:20:59.153928 [info ] [Thread-1  ]: 17 of 19 PASS source_unique_IDX-Schema_ksql-stock-stream_id .................... [[32mPASS[0m in 0.16s]
[0m16:20:59.158662 [debug] [Thread-1  ]: Finished running node test.dbt_idx.source_unique_IDX-Schema_ksql-stock-stream_id.2119c5c33b
[0m16:20:59.162689 [debug] [Thread-1  ]: Began running node test.dbt_idx.source_unique_IDX-Schema_orders_order_id.5a8ef486ee
[0m16:20:59.164307 [info ] [Thread-1  ]: 18 of 19 START test source_unique_IDX-Schema_orders_order_id ................... [RUN]
[0m16:20:59.166442 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.dbt_idx.source_unique_IDX-Schema_ksql-stock-stream_id.2119c5c33b, now test.dbt_idx.source_unique_IDX-Schema_orders_order_id.5a8ef486ee)
[0m16:20:59.168312 [debug] [Thread-1  ]: Began compiling node test.dbt_idx.source_unique_IDX-Schema_orders_order_id.5a8ef486ee
[0m16:20:59.181432 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_idx.source_unique_IDX-Schema_orders_order_id.5a8ef486ee"
[0m16:20:59.208937 [debug] [Thread-1  ]: Timing info for test.dbt_idx.source_unique_IDX-Schema_orders_order_id.5a8ef486ee (compile): 16:20:59.170049 => 16:20:59.208188
[0m16:20:59.211420 [debug] [Thread-1  ]: Began executing node test.dbt_idx.source_unique_IDX-Schema_orders_order_id.5a8ef486ee
[0m16:20:59.219339 [debug] [Thread-1  ]: Writing runtime sql for node "test.dbt_idx.source_unique_IDX-Schema_orders_order_id.5a8ef486ee"
[0m16:20:59.249297 [debug] [Thread-1  ]: Using postgres connection "test.dbt_idx.source_unique_IDX-Schema_orders_order_id.5a8ef486ee"
[0m16:20:59.251243 [debug] [Thread-1  ]: On test.dbt_idx.source_unique_IDX-Schema_orders_order_id.5a8ef486ee: BEGIN
[0m16:20:59.253502 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m16:20:59.263883 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m16:20:59.265512 [debug] [Thread-1  ]: Using postgres connection "test.dbt_idx.source_unique_IDX-Schema_orders_order_id.5a8ef486ee"
[0m16:20:59.268129 [debug] [Thread-1  ]: On test.dbt_idx.source_unique_IDX-Schema_orders_order_id.5a8ef486ee: /* {"app": "dbt", "dbt_version": "1.5.6", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "test.dbt_idx.source_unique_IDX-Schema_orders_order_id.5a8ef486ee"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    order_id as unique_field,
    count(*) as n_records

from "IDX-Stock"."IDX-Schema"."orders"
where order_id is not null
group by order_id
having count(*) > 1



      
    ) dbt_internal_test
[0m16:20:59.274219 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.0 seconds
[0m16:20:59.285571 [debug] [Thread-1  ]: Timing info for test.dbt_idx.source_unique_IDX-Schema_orders_order_id.5a8ef486ee (execute): 16:20:59.212999 => 16:20:59.285069
[0m16:20:59.287050 [debug] [Thread-1  ]: On test.dbt_idx.source_unique_IDX-Schema_orders_order_id.5a8ef486ee: ROLLBACK
[0m16:20:59.288801 [debug] [Thread-1  ]: On test.dbt_idx.source_unique_IDX-Schema_orders_order_id.5a8ef486ee: Close
[0m16:20:59.292111 [info ] [Thread-1  ]: 18 of 19 PASS source_unique_IDX-Schema_orders_order_id ......................... [[32mPASS[0m in 0.13s]
[0m16:20:59.296594 [debug] [Thread-1  ]: Finished running node test.dbt_idx.source_unique_IDX-Schema_orders_order_id.5a8ef486ee
[0m16:20:59.299441 [debug] [Thread-1  ]: Began running node test.dbt_idx.unique_customer_orders_status_order_id.b7a45e83ee
[0m16:20:59.301630 [info ] [Thread-1  ]: 19 of 19 START test unique_customer_orders_status_order_id ..................... [RUN]
[0m16:20:59.305724 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.dbt_idx.source_unique_IDX-Schema_orders_order_id.5a8ef486ee, now test.dbt_idx.unique_customer_orders_status_order_id.b7a45e83ee)
[0m16:20:59.307621 [debug] [Thread-1  ]: Began compiling node test.dbt_idx.unique_customer_orders_status_order_id.b7a45e83ee
[0m16:20:59.320001 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_idx.unique_customer_orders_status_order_id.b7a45e83ee"
[0m16:20:59.350423 [debug] [Thread-1  ]: Timing info for test.dbt_idx.unique_customer_orders_status_order_id.b7a45e83ee (compile): 16:20:59.309313 => 16:20:59.349664
[0m16:20:59.352381 [debug] [Thread-1  ]: Began executing node test.dbt_idx.unique_customer_orders_status_order_id.b7a45e83ee
[0m16:20:59.357662 [debug] [Thread-1  ]: Writing runtime sql for node "test.dbt_idx.unique_customer_orders_status_order_id.b7a45e83ee"
[0m16:20:59.387390 [debug] [Thread-1  ]: Using postgres connection "test.dbt_idx.unique_customer_orders_status_order_id.b7a45e83ee"
[0m16:20:59.388694 [debug] [Thread-1  ]: On test.dbt_idx.unique_customer_orders_status_order_id.b7a45e83ee: BEGIN
[0m16:20:59.390064 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m16:20:59.400455 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m16:20:59.402265 [debug] [Thread-1  ]: Using postgres connection "test.dbt_idx.unique_customer_orders_status_order_id.b7a45e83ee"
[0m16:20:59.404209 [debug] [Thread-1  ]: On test.dbt_idx.unique_customer_orders_status_order_id.b7a45e83ee: /* {"app": "dbt", "dbt_version": "1.5.6", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "test.dbt_idx.unique_customer_orders_status_order_id.b7a45e83ee"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    order_id as unique_field,
    count(*) as n_records

from "IDX-Stock"."IDX-Schema"."customer_orders_status"
where order_id is not null
group by order_id
having count(*) > 1



      
    ) dbt_internal_test
[0m16:20:59.411614 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.0 seconds
[0m16:20:59.416131 [debug] [Thread-1  ]: Timing info for test.dbt_idx.unique_customer_orders_status_order_id.b7a45e83ee (execute): 16:20:59.353724 => 16:20:59.415700
[0m16:20:59.418928 [debug] [Thread-1  ]: On test.dbt_idx.unique_customer_orders_status_order_id.b7a45e83ee: ROLLBACK
[0m16:20:59.422438 [debug] [Thread-1  ]: On test.dbt_idx.unique_customer_orders_status_order_id.b7a45e83ee: Close
[0m16:20:59.427334 [info ] [Thread-1  ]: 19 of 19 PASS unique_customer_orders_status_order_id ........................... [[32mPASS[0m in 0.12s]
[0m16:20:59.430635 [debug] [Thread-1  ]: Finished running node test.dbt_idx.unique_customer_orders_status_order_id.b7a45e83ee
[0m16:20:59.463622 [debug] [MainThread]: Using postgres connection "master"
[0m16:20:59.464936 [debug] [MainThread]: On master: BEGIN
[0m16:20:59.466082 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:20:59.476801 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m16:20:59.478318 [debug] [MainThread]: On master: COMMIT
[0m16:20:59.479768 [debug] [MainThread]: Using postgres connection "master"
[0m16:20:59.481083 [debug] [MainThread]: On master: COMMIT
[0m16:20:59.482773 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m16:20:59.486552 [debug] [MainThread]: On master: Close
[0m16:20:59.489197 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:20:59.490527 [debug] [MainThread]: Connection 'test.dbt_idx.unique_customer_orders_status_order_id.b7a45e83ee' was properly closed.
[0m16:20:59.492058 [info ] [MainThread]: 
[0m16:20:59.495730 [info ] [MainThread]: Finished running 19 tests in 0 hours 0 minutes and 3.17 seconds (3.17s).
[0m16:20:59.506116 [debug] [MainThread]: Command end result
[0m16:20:59.555878 [info ] [MainThread]: 
[0m16:20:59.557461 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:20:59.559375 [info ] [MainThread]: 
[0m16:20:59.561448 [info ] [MainThread]: Done. PASS=19 WARN=0 ERROR=0 SKIP=0 TOTAL=19
[0m16:20:59.563662 [debug] [MainThread]: Command `dbt test` succeeded at 16:20:59.563381 after 4.69 seconds
[0m16:20:59.564846 [debug] [MainThread]: Flushing usage events
