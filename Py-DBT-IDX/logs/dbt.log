

============================== 16:18:35.662604 | e39c4583-6abe-4c5b-b410-f5110b2bc485 ==============================
[0m16:18:35.662604 [info ] [MainThread]: Running with dbt=1.6.1
[0m16:18:35.670126 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'D:\\00 Project\\00 My Project\\IdeaProjects\\Py-DBT-IDX', 'debug': 'False', 'version_check': 'True', 'log_path': 'D:\\00 Project\\00 My Project\\IdeaProjects\\Py-DBT-IDX\\logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt snapshot', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'False'}
[0m16:18:35.779757 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `source-paths` config has been renamed to `model-paths`. Please update your
`dbt_project.yml` configuration to reflect this change.
[0m16:18:35.781747 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `data-paths` config has been renamed to `seed-paths`. Please update your
`dbt_project.yml` configuration to reflect this change.
[0m16:18:35.863187 [info ] [MainThread]: Registered adapter: postgres=1.6.1
[0m16:18:35.874707 [debug] [MainThread]: checksum: efe19d9f5b93d1a98cc804fbfcdb6b3aced98b974af664946fee1cde8837deb7, vars: {}, profile: , target: , version: 1.6.1
[0m16:18:35.875707 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m16:18:36.720343 [warn ] [MainThread]: [[33mWARNING[0m]: Did not find matching node for patch with name 'dim_customers' in the 'models' section of file 'models\marts\core\core.yml'
[0m16:18:36.722321 [warn ] [MainThread]: [[33mWARNING[0m]: Did not find matching node for patch with name 'fct_orders' in the 'models' section of file 'models\marts\core\core.yml'
[0m16:18:36.797252 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_idx.not_null_dim_customers_customer_id.dd91cd1c8d' (models\marts\core\core.yml) depends on a node named 'dim_customers' in package '' which was not found
[0m16:18:36.833485 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.dbt_idx.marts.core
[0m16:18:36.875621 [info ] [MainThread]: Found 4 tests, 3 sources, 0 exposures, 0 metrics, 349 macros, 0 groups, 0 semantic models
[0m16:18:36.879076 [info ] [MainThread]: 
[0m16:18:36.880112 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m16:18:36.882086 [debug] [MainThread]: Command end result
[0m16:18:36.900811 [debug] [MainThread]: Command `dbt snapshot` succeeded at 16:18:36.899812 after 1.28 seconds
[0m16:18:36.901816 [debug] [MainThread]: Flushing usage events


============================== 16:42:46.186929 | bd6eefb1-ddc2-4391-b84d-3e84c46f9043 ==============================
[0m16:42:46.186929 [info ] [MainThread]: Running with dbt=1.6.1
[0m16:42:46.191531 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'D:\\00 Project\\00 My Project\\IdeaProjects\\Py-DBT-IDX', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': 'D:\\00 Project\\00 My Project\\IdeaProjects\\Py-DBT-IDX\\logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt snapshot', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'False'}
[0m16:42:46.321441 [info ] [MainThread]: Registered adapter: postgres=1.6.1
[0m16:42:46.333340 [debug] [MainThread]: checksum: efe19d9f5b93d1a98cc804fbfcdb6b3aced98b974af664946fee1cde8837deb7, vars: {}, profile: , target: , version: 1.6.1
[0m16:42:46.341868 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m16:42:47.166414 [warn ] [MainThread]: [[33mWARNING[0m]: Did not find matching node for patch with name 'dim_customers' in the 'models' section of file 'models\marts\core\core.yml'
[0m16:42:47.213577 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_idx.not_null_dim_customers_customer_id.dd91cd1c8d' (models\marts\core\core.yml) depends on a node named 'dim_customers' in package '' which was not found
[0m16:42:47.335476 [info ] [MainThread]: Found 5 models, 1 snapshot, 4 tests, 3 sources, 0 exposures, 0 metrics, 349 macros, 0 groups, 0 semantic models
[0m16:42:47.337505 [info ] [MainThread]: 
[0m16:42:47.339483 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m16:42:47.342982 [debug] [ThreadPool]: Acquiring new postgres connection 'list_IDX-Stock'
[0m16:42:47.353500 [debug] [ThreadPool]: Using postgres connection "list_IDX-Stock"
[0m16:42:47.353500 [debug] [ThreadPool]: On list_IDX-Stock: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "connection_name": "list_IDX-Stock"} */

    select distinct nspname from pg_namespace
  
[0m16:42:47.354506 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:42:47.407741 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.0 seconds
[0m16:42:47.409760 [debug] [ThreadPool]: On list_IDX-Stock: Close
[0m16:42:47.412243 [debug] [ThreadPool]: Acquiring new postgres connection 'list_IDX-Stock_snapshots'
[0m16:42:47.420264 [debug] [ThreadPool]: Using postgres connection "list_IDX-Stock_snapshots"
[0m16:42:47.421772 [debug] [ThreadPool]: On list_IDX-Stock_snapshots: BEGIN
[0m16:42:47.421772 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:42:47.445811 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m16:42:47.446809 [debug] [ThreadPool]: Using postgres connection "list_IDX-Stock_snapshots"
[0m16:42:47.446809 [debug] [ThreadPool]: On list_IDX-Stock_snapshots: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "connection_name": "list_IDX-Stock_snapshots"} */
select
      'IDX-Stock' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'snapshots'
    union all
    select
      'IDX-Stock' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'snapshots'
    union all
    select
      'IDX-Stock' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'snapshots'
  
[0m16:42:47.454252 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.0 seconds
[0m16:42:47.456287 [debug] [ThreadPool]: On list_IDX-Stock_snapshots: ROLLBACK
[0m16:42:47.458253 [debug] [ThreadPool]: On list_IDX-Stock_snapshots: Close
[0m16:42:47.460250 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_IDX-Stock_snapshots, now list_IDX-Stock_warehouse)
[0m16:42:47.463765 [debug] [ThreadPool]: Using postgres connection "list_IDX-Stock_warehouse"
[0m16:42:47.464765 [debug] [ThreadPool]: On list_IDX-Stock_warehouse: BEGIN
[0m16:42:47.465793 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:42:47.487007 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m16:42:47.488002 [debug] [ThreadPool]: Using postgres connection "list_IDX-Stock_warehouse"
[0m16:42:47.488002 [debug] [ThreadPool]: On list_IDX-Stock_warehouse: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "connection_name": "list_IDX-Stock_warehouse"} */
select
      'IDX-Stock' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'warehouse'
    union all
    select
      'IDX-Stock' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'warehouse'
    union all
    select
      'IDX-Stock' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'warehouse'
  
[0m16:42:47.494533 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.0 seconds
[0m16:42:47.497552 [debug] [ThreadPool]: On list_IDX-Stock_warehouse: ROLLBACK
[0m16:42:47.499518 [debug] [ThreadPool]: On list_IDX-Stock_warehouse: Close
[0m16:42:47.510087 [debug] [MainThread]: Using postgres connection "master"
[0m16:42:47.510087 [debug] [MainThread]: On master: BEGIN
[0m16:42:47.510087 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:42:47.538928 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m16:42:47.539925 [debug] [MainThread]: Using postgres connection "master"
[0m16:42:47.541446 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m16:42:47.554041 [debug] [MainThread]: SQL status: SELECT 0 in 0.0 seconds
[0m16:42:47.557084 [debug] [MainThread]: On master: ROLLBACK
[0m16:42:47.560043 [debug] [MainThread]: Using postgres connection "master"
[0m16:42:47.560043 [debug] [MainThread]: On master: BEGIN
[0m16:42:47.565596 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m16:42:47.566574 [debug] [MainThread]: On master: COMMIT
[0m16:42:47.567614 [debug] [MainThread]: Using postgres connection "master"
[0m16:42:47.568561 [debug] [MainThread]: On master: COMMIT
[0m16:42:47.570561 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m16:42:47.572102 [debug] [MainThread]: On master: Close
[0m16:42:47.573109 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:42:47.575632 [info ] [MainThread]: 
[0m16:42:47.582747 [debug] [Thread-1 (]: Began running node snapshot.dbt_idx.customers_snapshot
[0m16:42:47.583687 [info ] [Thread-1 (]: 1 of 1 START snapshot snapshots.customers_snapshot ............................. [RUN]
[0m16:42:47.586686 [debug] [Thread-1 (]: Acquiring new postgres connection 'snapshot.dbt_idx.customers_snapshot'
[0m16:42:47.587683 [debug] [Thread-1 (]: Began compiling node snapshot.dbt_idx.customers_snapshot
[0m16:42:47.600318 [debug] [Thread-1 (]: Timing info for snapshot.dbt_idx.customers_snapshot (compile): 16:42:47.589250 => 16:42:47.600318
[0m16:42:47.601945 [debug] [Thread-1 (]: Began executing node snapshot.dbt_idx.customers_snapshot
[0m16:42:47.675781 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.dbt_idx.customers_snapshot"
[0m16:42:47.684538 [debug] [Thread-1 (]: Using postgres connection "snapshot.dbt_idx.customers_snapshot"
[0m16:42:47.685537 [debug] [Thread-1 (]: On snapshot.dbt_idx.customers_snapshot: BEGIN
[0m16:42:47.685537 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m16:42:47.711407 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m16:42:47.712419 [debug] [Thread-1 (]: Using postgres connection "snapshot.dbt_idx.customers_snapshot"
[0m16:42:47.713453 [debug] [Thread-1 (]: On snapshot.dbt_idx.customers_snapshot: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "snapshot.dbt_idx.customers_snapshot"} */

      
  
    

  create  table "IDX-Stock"."snapshots"."customers_snapshot"
  
  
    as
  
  (
    

    select *,
        md5(coalesce(cast(customer_id as varchar ), '')
         || '|' || coalesce(cast(datetime_updated as varchar ), '')
        ) as dbt_scd_id,
        datetime_updated as dbt_updated_at,
        datetime_updated as dbt_valid_from,
        nullif(datetime_updated, datetime_updated) as dbt_valid_to
    from (
        



select *
from "IDX-Stock"."warehouse"."customers"

    ) sbq



  );
  
  
[0m16:42:47.735685 [debug] [Thread-1 (]: SQL status: SELECT 100 in 0.0 seconds
[0m16:42:47.755627 [debug] [Thread-1 (]: On snapshot.dbt_idx.customers_snapshot: COMMIT
[0m16:42:47.756638 [debug] [Thread-1 (]: Using postgres connection "snapshot.dbt_idx.customers_snapshot"
[0m16:42:47.757636 [debug] [Thread-1 (]: On snapshot.dbt_idx.customers_snapshot: COMMIT
[0m16:42:47.762113 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m16:42:47.765121 [debug] [Thread-1 (]: Timing info for snapshot.dbt_idx.customers_snapshot (execute): 16:42:47.602845 => 16:42:47.765121
[0m16:42:47.766161 [debug] [Thread-1 (]: On snapshot.dbt_idx.customers_snapshot: Close
[0m16:42:47.769124 [info ] [Thread-1 (]: 1 of 1 OK snapshotted snapshots.customers_snapshot ............................. [[32msuccess[0m in 0.18s]
[0m16:42:47.771692 [debug] [Thread-1 (]: Finished running node snapshot.dbt_idx.customers_snapshot
[0m16:42:47.775718 [debug] [MainThread]: Using postgres connection "master"
[0m16:42:47.776711 [debug] [MainThread]: On master: BEGIN
[0m16:42:47.778708 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:42:47.809577 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m16:42:47.810590 [debug] [MainThread]: On master: COMMIT
[0m16:42:47.811582 [debug] [MainThread]: Using postgres connection "master"
[0m16:42:47.812111 [debug] [MainThread]: On master: COMMIT
[0m16:42:47.814130 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m16:42:47.816118 [debug] [MainThread]: On master: Close
[0m16:42:47.817126 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:42:47.818124 [debug] [MainThread]: Connection 'list_IDX-Stock' was properly closed.
[0m16:42:47.819636 [debug] [MainThread]: Connection 'list_IDX-Stock_warehouse' was properly closed.
[0m16:42:47.821649 [debug] [MainThread]: Connection 'snapshot.dbt_idx.customers_snapshot' was properly closed.
[0m16:42:47.821649 [info ] [MainThread]: 
[0m16:42:47.823836 [info ] [MainThread]: Finished running 1 snapshot in 0 hours 0 minutes and 0.48 seconds (0.48s).
[0m16:42:47.825861 [debug] [MainThread]: Command end result
[0m16:42:47.858071 [info ] [MainThread]: 
[0m16:42:47.859544 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:42:47.861544 [info ] [MainThread]: 
[0m16:42:47.863682 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m16:42:47.865678 [debug] [MainThread]: Command `dbt snapshot` succeeded at 16:42:47.865678 after 1.72 seconds
[0m16:42:47.866643 [debug] [MainThread]: Flushing usage events


============================== 16:43:33.612940 | 8539b76c-44c6-4a70-9f1e-76e585adc040 ==============================
[0m16:43:33.612940 [info ] [MainThread]: Running with dbt=1.6.1
[0m16:43:33.617970 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'D:\\00 Project\\00 My Project\\IdeaProjects\\Py-DBT-IDX', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': 'D:\\00 Project\\00 My Project\\IdeaProjects\\Py-DBT-IDX\\logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt snapshot', 'send_anonymous_usage_stats': 'False'}
[0m16:43:33.747406 [info ] [MainThread]: Registered adapter: postgres=1.6.1
[0m16:43:33.758988 [debug] [MainThread]: checksum: efe19d9f5b93d1a98cc804fbfcdb6b3aced98b974af664946fee1cde8837deb7, vars: {}, profile: , target: , version: 1.6.1
[0m16:43:33.899543 [debug] [MainThread]: Partial parsing enabled: 1 files deleted, 1 files added, 0 files changed.
[0m16:43:33.900517 [debug] [MainThread]: Partial parsing: added file: dbt_idx://models\marts\core\dim_customers.sql
[0m16:43:33.901514 [debug] [MainThread]: Partial parsing: deleted file: dbt_idx://models\marts\core\dim_customer.sql
[0m16:43:33.990026 [info ] [MainThread]: Found 5 models, 1 snapshot, 4 tests, 3 sources, 0 exposures, 0 metrics, 349 macros, 0 groups, 0 semantic models
[0m16:43:33.993544 [info ] [MainThread]: 
[0m16:43:33.995547 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m16:43:33.998580 [debug] [ThreadPool]: Acquiring new postgres connection 'list_IDX-Stock'
[0m16:43:34.013695 [debug] [ThreadPool]: Using postgres connection "list_IDX-Stock"
[0m16:43:34.014660 [debug] [ThreadPool]: On list_IDX-Stock: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "connection_name": "list_IDX-Stock"} */

    select distinct nspname from pg_namespace
  
[0m16:43:34.014660 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:43:34.045863 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.0 seconds
[0m16:43:34.047862 [debug] [ThreadPool]: On list_IDX-Stock: Close
[0m16:43:34.052360 [debug] [ThreadPool]: Acquiring new postgres connection 'list_IDX-Stock_snapshots'
[0m16:43:34.060359 [debug] [ThreadPool]: Using postgres connection "list_IDX-Stock_snapshots"
[0m16:43:34.061365 [debug] [ThreadPool]: On list_IDX-Stock_snapshots: BEGIN
[0m16:43:34.061365 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:43:34.081292 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m16:43:34.082343 [debug] [ThreadPool]: Using postgres connection "list_IDX-Stock_snapshots"
[0m16:43:34.083325 [debug] [ThreadPool]: On list_IDX-Stock_snapshots: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "connection_name": "list_IDX-Stock_snapshots"} */
select
      'IDX-Stock' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'snapshots'
    union all
    select
      'IDX-Stock' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'snapshots'
    union all
    select
      'IDX-Stock' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'snapshots'
  
[0m16:43:34.089302 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.0 seconds
[0m16:43:34.091298 [debug] [ThreadPool]: On list_IDX-Stock_snapshots: ROLLBACK
[0m16:43:34.093816 [debug] [ThreadPool]: On list_IDX-Stock_snapshots: Close
[0m16:43:34.096818 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_IDX-Stock_snapshots, now list_IDX-Stock_warehouse)
[0m16:43:34.102363 [debug] [ThreadPool]: Using postgres connection "list_IDX-Stock_warehouse"
[0m16:43:34.103361 [debug] [ThreadPool]: On list_IDX-Stock_warehouse: BEGIN
[0m16:43:34.104324 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:43:34.126454 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m16:43:34.126454 [debug] [ThreadPool]: Using postgres connection "list_IDX-Stock_warehouse"
[0m16:43:34.127756 [debug] [ThreadPool]: On list_IDX-Stock_warehouse: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "connection_name": "list_IDX-Stock_warehouse"} */
select
      'IDX-Stock' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'warehouse'
    union all
    select
      'IDX-Stock' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'warehouse'
    union all
    select
      'IDX-Stock' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'warehouse'
  
[0m16:43:34.133302 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.0 seconds
[0m16:43:34.135326 [debug] [ThreadPool]: On list_IDX-Stock_warehouse: ROLLBACK
[0m16:43:34.137296 [debug] [ThreadPool]: On list_IDX-Stock_warehouse: Close
[0m16:43:34.145363 [debug] [MainThread]: Using postgres connection "master"
[0m16:43:34.147338 [debug] [MainThread]: On master: BEGIN
[0m16:43:34.147338 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:43:34.169165 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m16:43:34.170161 [debug] [MainThread]: Using postgres connection "master"
[0m16:43:34.170161 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m16:43:34.175709 [debug] [MainThread]: SQL status: SELECT 0 in 0.0 seconds
[0m16:43:34.178716 [debug] [MainThread]: On master: ROLLBACK
[0m16:43:34.181215 [debug] [MainThread]: Using postgres connection "master"
[0m16:43:34.181215 [debug] [MainThread]: On master: BEGIN
[0m16:43:34.185220 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m16:43:34.185220 [debug] [MainThread]: On master: COMMIT
[0m16:43:34.186227 [debug] [MainThread]: Using postgres connection "master"
[0m16:43:34.187231 [debug] [MainThread]: On master: COMMIT
[0m16:43:34.189225 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m16:43:34.189225 [debug] [MainThread]: On master: Close
[0m16:43:34.191233 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:43:34.193355 [info ] [MainThread]: 
[0m16:43:34.198354 [debug] [Thread-1 (]: Began running node snapshot.dbt_idx.customers_snapshot
[0m16:43:34.199355 [info ] [Thread-1 (]: 1 of 1 START snapshot snapshots.customers_snapshot ............................. [RUN]
[0m16:43:34.200356 [debug] [Thread-1 (]: Acquiring new postgres connection 'snapshot.dbt_idx.customers_snapshot'
[0m16:43:34.201402 [debug] [Thread-1 (]: Began compiling node snapshot.dbt_idx.customers_snapshot
[0m16:43:34.211563 [debug] [Thread-1 (]: Timing info for snapshot.dbt_idx.customers_snapshot (compile): 16:43:34.201402 => 16:43:34.211563
[0m16:43:34.213029 [debug] [Thread-1 (]: Began executing node snapshot.dbt_idx.customers_snapshot
[0m16:43:34.257513 [debug] [Thread-1 (]: Using postgres connection "snapshot.dbt_idx.customers_snapshot"
[0m16:43:34.258556 [debug] [Thread-1 (]: On snapshot.dbt_idx.customers_snapshot: BEGIN
[0m16:43:34.259538 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m16:43:34.281269 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m16:43:34.282199 [debug] [Thread-1 (]: Using postgres connection "snapshot.dbt_idx.customers_snapshot"
[0m16:43:34.282199 [debug] [Thread-1 (]: On snapshot.dbt_idx.customers_snapshot: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "snapshot.dbt_idx.customers_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "IDX-Stock".INFORMATION_SCHEMA.columns
      where table_name = 'customers_snapshot'
        
        and table_schema = 'snapshots'
        
      order by ordinal_position

  
[0m16:43:34.298369 [debug] [Thread-1 (]: SQL status: SELECT 10 in 0.0 seconds
[0m16:43:34.325748 [debug] [Thread-1 (]: Using postgres connection "snapshot.dbt_idx.customers_snapshot"
[0m16:43:34.326748 [debug] [Thread-1 (]: On snapshot.dbt_idx.customers_snapshot: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "snapshot.dbt_idx.customers_snapshot"} */

        
  
    

  create temporary table "customers_snapshot__dbt_tmp164334313157"
  
  
    as
  
  (
    with snapshot_query as (

        



select *
from "IDX-Stock"."warehouse"."customers"


    ),

    snapshotted_data as (

        select *,
            customer_id as dbt_unique_key

        from "IDX-Stock"."snapshots"."customers_snapshot"
        where dbt_valid_to is null

    ),

    insertions_source_data as (

        select
            *,
            customer_id as dbt_unique_key,
            datetime_updated as dbt_updated_at,
            datetime_updated as dbt_valid_from,
            nullif(datetime_updated, datetime_updated) as dbt_valid_to,
            md5(coalesce(cast(customer_id as varchar ), '')
         || '|' || coalesce(cast(datetime_updated as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select
            *,
            customer_id as dbt_unique_key,
            datetime_updated as dbt_updated_at,
            datetime_updated as dbt_valid_from,
            datetime_updated as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where snapshotted_data.dbt_unique_key is null
           or (
                snapshotted_data.dbt_unique_key is not null
            and (
                (snapshotted_data.dbt_valid_from < source_data.datetime_updated)
            )
        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where (
            (snapshotted_data.dbt_valid_from < source_data.datetime_updated)
        )
    )

    select * from insertions
    union all
    select * from updates

  );
  
    
[0m16:43:34.333336 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.0 seconds
[0m16:43:34.337337 [debug] [Thread-1 (]: Using postgres connection "snapshot.dbt_idx.customers_snapshot"
[0m16:43:34.338352 [debug] [Thread-1 (]: On snapshot.dbt_idx.customers_snapshot: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "snapshot.dbt_idx.customers_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'customers_snapshot__dbt_tmp164334313157'
        
      order by ordinal_position

  
[0m16:43:34.343926 [debug] [Thread-1 (]: SQL status: SELECT 12 in 0.0 seconds
[0m16:43:34.347925 [debug] [Thread-1 (]: Using postgres connection "snapshot.dbt_idx.customers_snapshot"
[0m16:43:34.348924 [debug] [Thread-1 (]: On snapshot.dbt_idx.customers_snapshot: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "snapshot.dbt_idx.customers_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "IDX-Stock".INFORMATION_SCHEMA.columns
      where table_name = 'customers_snapshot'
        
        and table_schema = 'snapshots'
        
      order by ordinal_position

  
[0m16:43:34.352437 [debug] [Thread-1 (]: SQL status: SELECT 10 in 0.0 seconds
[0m16:43:34.356467 [debug] [Thread-1 (]: Using postgres connection "snapshot.dbt_idx.customers_snapshot"
[0m16:43:34.357465 [debug] [Thread-1 (]: On snapshot.dbt_idx.customers_snapshot: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "snapshot.dbt_idx.customers_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'customers_snapshot__dbt_tmp164334313157'
        
      order by ordinal_position

  
[0m16:43:34.361465 [debug] [Thread-1 (]: SQL status: SELECT 12 in 0.0 seconds
[0m16:43:34.366819 [debug] [Thread-1 (]: Using postgres connection "snapshot.dbt_idx.customers_snapshot"
[0m16:43:34.367818 [debug] [Thread-1 (]: On snapshot.dbt_idx.customers_snapshot: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "snapshot.dbt_idx.customers_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "IDX-Stock".INFORMATION_SCHEMA.columns
      where table_name = 'customers_snapshot'
        
        and table_schema = 'snapshots'
        
      order by ordinal_position

  
[0m16:43:34.371625 [debug] [Thread-1 (]: SQL status: SELECT 10 in 0.0 seconds
[0m16:43:34.379692 [debug] [Thread-1 (]: Using postgres connection "snapshot.dbt_idx.customers_snapshot"
[0m16:43:34.379692 [debug] [Thread-1 (]: On snapshot.dbt_idx.customers_snapshot: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "snapshot.dbt_idx.customers_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'customers_snapshot__dbt_tmp164334313157'
        
      order by ordinal_position

  
[0m16:43:34.385218 [debug] [Thread-1 (]: SQL status: SELECT 12 in 0.0 seconds
[0m16:43:34.391800 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.dbt_idx.customers_snapshot"
[0m16:43:34.408801 [debug] [Thread-1 (]: Using postgres connection "snapshot.dbt_idx.customers_snapshot"
[0m16:43:34.409800 [debug] [Thread-1 (]: On snapshot.dbt_idx.customers_snapshot: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "snapshot.dbt_idx.customers_snapshot"} */

      update "IDX-Stock"."snapshots"."customers_snapshot"
    set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to
    from "customers_snapshot__dbt_tmp164334313157" as DBT_INTERNAL_SOURCE
    where DBT_INTERNAL_SOURCE.dbt_scd_id::text = "IDX-Stock"."snapshots"."customers_snapshot".dbt_scd_id::text
      and DBT_INTERNAL_SOURCE.dbt_change_type::text in ('update'::text, 'delete'::text)
      and "IDX-Stock"."snapshots"."customers_snapshot".dbt_valid_to is null;

    insert into "IDX-Stock"."snapshots"."customers_snapshot" ("customer_id", "zipcode", "city", "state_code", "datetime_created", "datetime_updated", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id")
    select DBT_INTERNAL_SOURCE."customer_id",DBT_INTERNAL_SOURCE."zipcode",DBT_INTERNAL_SOURCE."city",DBT_INTERNAL_SOURCE."state_code",DBT_INTERNAL_SOURCE."datetime_created",DBT_INTERNAL_SOURCE."datetime_updated",DBT_INTERNAL_SOURCE."dbt_updated_at",DBT_INTERNAL_SOURCE."dbt_valid_from",DBT_INTERNAL_SOURCE."dbt_valid_to",DBT_INTERNAL_SOURCE."dbt_scd_id"
    from "customers_snapshot__dbt_tmp164334313157" as DBT_INTERNAL_SOURCE
    where DBT_INTERNAL_SOURCE.dbt_change_type::text = 'insert'::text;

  
[0m16:43:34.413912 [debug] [Thread-1 (]: SQL status: INSERT 0 0 in 0.0 seconds
[0m16:43:34.429157 [debug] [Thread-1 (]: On snapshot.dbt_idx.customers_snapshot: COMMIT
[0m16:43:34.430135 [debug] [Thread-1 (]: Using postgres connection "snapshot.dbt_idx.customers_snapshot"
[0m16:43:34.430135 [debug] [Thread-1 (]: On snapshot.dbt_idx.customers_snapshot: COMMIT
[0m16:43:34.435152 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m16:43:34.439187 [debug] [Thread-1 (]: Timing info for snapshot.dbt_idx.customers_snapshot (execute): 16:43:34.213029 => 16:43:34.438183
[0m16:43:34.439187 [debug] [Thread-1 (]: On snapshot.dbt_idx.customers_snapshot: Close
[0m16:43:34.442698 [info ] [Thread-1 (]: 1 of 1 OK snapshotted snapshots.customers_snapshot ............................. [[32msuccess[0m in 0.24s]
[0m16:43:34.444699 [debug] [Thread-1 (]: Finished running node snapshot.dbt_idx.customers_snapshot
[0m16:43:34.449704 [debug] [MainThread]: Using postgres connection "master"
[0m16:43:34.451210 [debug] [MainThread]: On master: BEGIN
[0m16:43:34.452224 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:43:34.475978 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m16:43:34.476972 [debug] [MainThread]: On master: COMMIT
[0m16:43:34.476972 [debug] [MainThread]: Using postgres connection "master"
[0m16:43:34.477973 [debug] [MainThread]: On master: COMMIT
[0m16:43:34.479986 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m16:43:34.481493 [debug] [MainThread]: On master: Close
[0m16:43:34.482500 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:43:34.484503 [debug] [MainThread]: Connection 'list_IDX-Stock' was properly closed.
[0m16:43:34.485501 [debug] [MainThread]: Connection 'list_IDX-Stock_warehouse' was properly closed.
[0m16:43:34.486528 [debug] [MainThread]: Connection 'snapshot.dbt_idx.customers_snapshot' was properly closed.
[0m16:43:34.487537 [info ] [MainThread]: 
[0m16:43:34.488509 [info ] [MainThread]: Finished running 1 snapshot in 0 hours 0 minutes and 0.49 seconds (0.49s).
[0m16:43:34.490505 [debug] [MainThread]: Command end result
[0m16:43:34.522845 [info ] [MainThread]: 
[0m16:43:34.524852 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:43:34.525852 [info ] [MainThread]: 
[0m16:43:34.527372 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m16:43:34.529414 [debug] [MainThread]: Command `dbt snapshot` succeeded at 16:43:34.528443 after 0.95 seconds
[0m16:43:34.529414 [debug] [MainThread]: Flushing usage events


============================== 16:44:51.252803 | 1fb805ca-13d1-446e-9f23-23da5712aacd ==============================
[0m16:44:51.252803 [info ] [MainThread]: Running with dbt=1.6.1
[0m16:44:51.257769 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'D:\\00 Project\\00 My Project\\IdeaProjects\\Py-DBT-IDX\\logs', 'version_check': 'True', 'profiles_dir': 'D:\\00 Project\\00 My Project\\IdeaProjects\\Py-DBT-IDX', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt snapshot', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'False'}
[0m16:44:51.392046 [info ] [MainThread]: Registered adapter: postgres=1.6.1
[0m16:44:51.404077 [debug] [MainThread]: checksum: efe19d9f5b93d1a98cc804fbfcdb6b3aced98b974af664946fee1cde8837deb7, vars: {}, profile: , target: , version: 1.6.1
[0m16:44:51.549993 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:44:51.550993 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:44:51.597077 [info ] [MainThread]: Found 5 models, 1 snapshot, 4 tests, 3 sources, 0 exposures, 0 metrics, 349 macros, 0 groups, 0 semantic models
[0m16:44:51.600092 [info ] [MainThread]: 
[0m16:44:51.601062 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m16:44:51.604583 [debug] [ThreadPool]: Acquiring new postgres connection 'list_IDX-Stock'
[0m16:44:51.617185 [debug] [ThreadPool]: Using postgres connection "list_IDX-Stock"
[0m16:44:51.618142 [debug] [ThreadPool]: On list_IDX-Stock: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "connection_name": "list_IDX-Stock"} */

    select distinct nspname from pg_namespace
  
[0m16:44:51.619161 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:44:51.652293 [debug] [ThreadPool]: SQL status: SELECT 9 in 0.0 seconds
[0m16:44:51.654292 [debug] [ThreadPool]: On list_IDX-Stock: Close
[0m16:44:51.658309 [debug] [ThreadPool]: Acquiring new postgres connection 'list_IDX-Stock_snapshots'
[0m16:44:51.665876 [debug] [ThreadPool]: Using postgres connection "list_IDX-Stock_snapshots"
[0m16:44:51.666843 [debug] [ThreadPool]: On list_IDX-Stock_snapshots: BEGIN
[0m16:44:51.667848 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:44:51.694528 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m16:44:51.696137 [debug] [ThreadPool]: Using postgres connection "list_IDX-Stock_snapshots"
[0m16:44:51.696137 [debug] [ThreadPool]: On list_IDX-Stock_snapshots: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "connection_name": "list_IDX-Stock_snapshots"} */
select
      'IDX-Stock' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'snapshots'
    union all
    select
      'IDX-Stock' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'snapshots'
    union all
    select
      'IDX-Stock' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'snapshots'
  
[0m16:44:51.702156 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.0 seconds
[0m16:44:51.704155 [debug] [ThreadPool]: On list_IDX-Stock_snapshots: ROLLBACK
[0m16:44:51.707169 [debug] [ThreadPool]: On list_IDX-Stock_snapshots: Close
[0m16:44:51.709170 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_IDX-Stock_snapshots, now list_IDX-Stock_warehouse)
[0m16:44:51.714310 [debug] [ThreadPool]: Using postgres connection "list_IDX-Stock_warehouse"
[0m16:44:51.715311 [debug] [ThreadPool]: On list_IDX-Stock_warehouse: BEGIN
[0m16:44:51.716321 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:44:51.740212 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m16:44:51.741219 [debug] [ThreadPool]: Using postgres connection "list_IDX-Stock_warehouse"
[0m16:44:51.741729 [debug] [ThreadPool]: On list_IDX-Stock_warehouse: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "connection_name": "list_IDX-Stock_warehouse"} */
select
      'IDX-Stock' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'warehouse'
    union all
    select
      'IDX-Stock' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'warehouse'
    union all
    select
      'IDX-Stock' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'warehouse'
  
[0m16:44:51.746808 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.0 seconds
[0m16:44:51.749280 [debug] [ThreadPool]: On list_IDX-Stock_warehouse: ROLLBACK
[0m16:44:51.752646 [debug] [ThreadPool]: On list_IDX-Stock_warehouse: Close
[0m16:44:51.762171 [debug] [MainThread]: Using postgres connection "master"
[0m16:44:51.763206 [debug] [MainThread]: On master: BEGIN
[0m16:44:51.764171 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:44:51.787730 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m16:44:51.787730 [debug] [MainThread]: Using postgres connection "master"
[0m16:44:51.789257 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m16:44:51.794748 [debug] [MainThread]: SQL status: SELECT 0 in 0.0 seconds
[0m16:44:51.797259 [debug] [MainThread]: On master: ROLLBACK
[0m16:44:51.799292 [debug] [MainThread]: Using postgres connection "master"
[0m16:44:51.800260 [debug] [MainThread]: On master: BEGIN
[0m16:44:51.804776 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m16:44:51.805782 [debug] [MainThread]: On master: COMMIT
[0m16:44:51.806781 [debug] [MainThread]: Using postgres connection "master"
[0m16:44:51.807778 [debug] [MainThread]: On master: COMMIT
[0m16:44:51.809784 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m16:44:51.811340 [debug] [MainThread]: On master: Close
[0m16:44:51.813290 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:44:51.814291 [info ] [MainThread]: 
[0m16:44:51.820292 [debug] [Thread-1 (]: Began running node snapshot.dbt_idx.customers_snapshot
[0m16:44:51.821332 [info ] [Thread-1 (]: 1 of 1 START snapshot snapshots.customers_snapshot ............................. [RUN]
[0m16:44:51.823476 [debug] [Thread-1 (]: Acquiring new postgres connection 'snapshot.dbt_idx.customers_snapshot'
[0m16:44:51.824437 [debug] [Thread-1 (]: Began compiling node snapshot.dbt_idx.customers_snapshot
[0m16:44:51.832070 [debug] [Thread-1 (]: Timing info for snapshot.dbt_idx.customers_snapshot (compile): 16:44:51.824437 => 16:44:51.832070
[0m16:44:51.833114 [debug] [Thread-1 (]: Began executing node snapshot.dbt_idx.customers_snapshot
[0m16:44:51.889101 [debug] [Thread-1 (]: Using postgres connection "snapshot.dbt_idx.customers_snapshot"
[0m16:44:51.890066 [debug] [Thread-1 (]: On snapshot.dbt_idx.customers_snapshot: BEGIN
[0m16:44:51.890066 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m16:44:51.911359 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m16:44:51.912370 [debug] [Thread-1 (]: Using postgres connection "snapshot.dbt_idx.customers_snapshot"
[0m16:44:51.913370 [debug] [Thread-1 (]: On snapshot.dbt_idx.customers_snapshot: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "snapshot.dbt_idx.customers_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "IDX-Stock".INFORMATION_SCHEMA.columns
      where table_name = 'customers_snapshot'
        
        and table_schema = 'snapshots'
        
      order by ordinal_position

  
[0m16:44:51.921961 [debug] [Thread-1 (]: SQL status: SELECT 10 in 0.0 seconds
[0m16:44:51.951026 [debug] [Thread-1 (]: Using postgres connection "snapshot.dbt_idx.customers_snapshot"
[0m16:44:51.952518 [debug] [Thread-1 (]: On snapshot.dbt_idx.customers_snapshot: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "snapshot.dbt_idx.customers_snapshot"} */

        
  
    

  create temporary table "customers_snapshot__dbt_tmp164451938473"
  
  
    as
  
  (
    with snapshot_query as (

        



select *
from "IDX-Stock"."warehouse"."customers"


    ),

    snapshotted_data as (

        select *,
            customer_id as dbt_unique_key

        from "IDX-Stock"."snapshots"."customers_snapshot"
        where dbt_valid_to is null

    ),

    insertions_source_data as (

        select
            *,
            customer_id as dbt_unique_key,
            datetime_updated as dbt_updated_at,
            datetime_updated as dbt_valid_from,
            nullif(datetime_updated, datetime_updated) as dbt_valid_to,
            md5(coalesce(cast(customer_id as varchar ), '')
         || '|' || coalesce(cast(datetime_updated as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select
            *,
            customer_id as dbt_unique_key,
            datetime_updated as dbt_updated_at,
            datetime_updated as dbt_valid_from,
            datetime_updated as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where snapshotted_data.dbt_unique_key is null
           or (
                snapshotted_data.dbt_unique_key is not null
            and (
                (snapshotted_data.dbt_valid_from < source_data.datetime_updated)
            )
        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where (
            (snapshotted_data.dbt_valid_from < source_data.datetime_updated)
        )
    )

    select * from insertions
    union all
    select * from updates

  );
  
    
[0m16:44:51.958535 [debug] [Thread-1 (]: SQL status: SELECT 10 in 0.0 seconds
[0m16:44:51.962099 [debug] [Thread-1 (]: Using postgres connection "snapshot.dbt_idx.customers_snapshot"
[0m16:44:51.963066 [debug] [Thread-1 (]: On snapshot.dbt_idx.customers_snapshot: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "snapshot.dbt_idx.customers_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'customers_snapshot__dbt_tmp164451938473'
        
      order by ordinal_position

  
[0m16:44:51.968432 [debug] [Thread-1 (]: SQL status: SELECT 12 in 0.0 seconds
[0m16:44:51.972939 [debug] [Thread-1 (]: Using postgres connection "snapshot.dbt_idx.customers_snapshot"
[0m16:44:51.973953 [debug] [Thread-1 (]: On snapshot.dbt_idx.customers_snapshot: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "snapshot.dbt_idx.customers_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "IDX-Stock".INFORMATION_SCHEMA.columns
      where table_name = 'customers_snapshot'
        
        and table_schema = 'snapshots'
        
      order by ordinal_position

  
[0m16:44:51.978982 [debug] [Thread-1 (]: SQL status: SELECT 10 in 0.0 seconds
[0m16:44:51.984464 [debug] [Thread-1 (]: Using postgres connection "snapshot.dbt_idx.customers_snapshot"
[0m16:44:51.985479 [debug] [Thread-1 (]: On snapshot.dbt_idx.customers_snapshot: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "snapshot.dbt_idx.customers_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'customers_snapshot__dbt_tmp164451938473'
        
      order by ordinal_position

  
[0m16:44:51.989479 [debug] [Thread-1 (]: SQL status: SELECT 12 in 0.0 seconds
[0m16:44:51.994000 [debug] [Thread-1 (]: Using postgres connection "snapshot.dbt_idx.customers_snapshot"
[0m16:44:51.994000 [debug] [Thread-1 (]: On snapshot.dbt_idx.customers_snapshot: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "snapshot.dbt_idx.customers_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "IDX-Stock".INFORMATION_SCHEMA.columns
      where table_name = 'customers_snapshot'
        
        and table_schema = 'snapshots'
        
      order by ordinal_position

  
[0m16:44:52.001064 [debug] [Thread-1 (]: SQL status: SELECT 10 in 0.0 seconds
[0m16:44:52.011075 [debug] [Thread-1 (]: Using postgres connection "snapshot.dbt_idx.customers_snapshot"
[0m16:44:52.011587 [debug] [Thread-1 (]: On snapshot.dbt_idx.customers_snapshot: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "snapshot.dbt_idx.customers_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'customers_snapshot__dbt_tmp164451938473'
        
      order by ordinal_position

  
[0m16:44:52.017107 [debug] [Thread-1 (]: SQL status: SELECT 12 in 0.0 seconds
[0m16:44:52.023466 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.dbt_idx.customers_snapshot"
[0m16:44:52.038990 [debug] [Thread-1 (]: Using postgres connection "snapshot.dbt_idx.customers_snapshot"
[0m16:44:52.040025 [debug] [Thread-1 (]: On snapshot.dbt_idx.customers_snapshot: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "snapshot.dbt_idx.customers_snapshot"} */

      update "IDX-Stock"."snapshots"."customers_snapshot"
    set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to
    from "customers_snapshot__dbt_tmp164451938473" as DBT_INTERNAL_SOURCE
    where DBT_INTERNAL_SOURCE.dbt_scd_id::text = "IDX-Stock"."snapshots"."customers_snapshot".dbt_scd_id::text
      and DBT_INTERNAL_SOURCE.dbt_change_type::text in ('update'::text, 'delete'::text)
      and "IDX-Stock"."snapshots"."customers_snapshot".dbt_valid_to is null;

    insert into "IDX-Stock"."snapshots"."customers_snapshot" ("customer_id", "zipcode", "city", "state_code", "datetime_created", "datetime_updated", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id")
    select DBT_INTERNAL_SOURCE."customer_id",DBT_INTERNAL_SOURCE."zipcode",DBT_INTERNAL_SOURCE."city",DBT_INTERNAL_SOURCE."state_code",DBT_INTERNAL_SOURCE."datetime_created",DBT_INTERNAL_SOURCE."datetime_updated",DBT_INTERNAL_SOURCE."dbt_updated_at",DBT_INTERNAL_SOURCE."dbt_valid_from",DBT_INTERNAL_SOURCE."dbt_valid_to",DBT_INTERNAL_SOURCE."dbt_scd_id"
    from "customers_snapshot__dbt_tmp164451938473" as DBT_INTERNAL_SOURCE
    where DBT_INTERNAL_SOURCE.dbt_change_type::text = 'insert'::text;

  
[0m16:44:52.043254 [debug] [Thread-1 (]: SQL status: INSERT 0 5 in 0.0 seconds
[0m16:44:52.059801 [debug] [Thread-1 (]: On snapshot.dbt_idx.customers_snapshot: COMMIT
[0m16:44:52.061312 [debug] [Thread-1 (]: Using postgres connection "snapshot.dbt_idx.customers_snapshot"
[0m16:44:52.062334 [debug] [Thread-1 (]: On snapshot.dbt_idx.customers_snapshot: COMMIT
[0m16:44:52.066321 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m16:44:52.071322 [debug] [Thread-1 (]: Timing info for snapshot.dbt_idx.customers_snapshot (execute): 16:44:51.835076 => 16:44:52.070347
[0m16:44:52.071833 [debug] [Thread-1 (]: On snapshot.dbt_idx.customers_snapshot: Close
[0m16:44:52.073843 [info ] [Thread-1 (]: 1 of 1 OK snapshotted snapshots.customers_snapshot ............................. [[32msuccess[0m in 0.25s]
[0m16:44:52.076840 [debug] [Thread-1 (]: Finished running node snapshot.dbt_idx.customers_snapshot
[0m16:44:52.079850 [debug] [MainThread]: Using postgres connection "master"
[0m16:44:52.079850 [debug] [MainThread]: On master: BEGIN
[0m16:44:52.081357 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:44:52.113378 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m16:44:52.115264 [debug] [MainThread]: On master: COMMIT
[0m16:44:52.116813 [debug] [MainThread]: Using postgres connection "master"
[0m16:44:52.117818 [debug] [MainThread]: On master: COMMIT
[0m16:44:52.119836 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m16:44:52.122367 [debug] [MainThread]: On master: Close
[0m16:44:52.124354 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:44:52.125355 [debug] [MainThread]: Connection 'list_IDX-Stock' was properly closed.
[0m16:44:52.126358 [debug] [MainThread]: Connection 'list_IDX-Stock_warehouse' was properly closed.
[0m16:44:52.126358 [debug] [MainThread]: Connection 'snapshot.dbt_idx.customers_snapshot' was properly closed.
[0m16:44:52.127353 [info ] [MainThread]: 
[0m16:44:52.128027 [info ] [MainThread]: Finished running 1 snapshot in 0 hours 0 minutes and 0.53 seconds (0.53s).
[0m16:44:52.129039 [debug] [MainThread]: Command end result
[0m16:44:52.153571 [info ] [MainThread]: 
[0m16:44:52.154569 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:44:52.155572 [info ] [MainThread]: 
[0m16:44:52.157551 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m16:44:52.158553 [debug] [MainThread]: Command `dbt snapshot` succeeded at 16:44:52.158553 after 0.94 seconds
[0m16:44:52.159571 [debug] [MainThread]: Flushing usage events


============================== 17:58:58.638310 | 21bf611a-c955-48cb-9cf0-5a0fd150a031 ==============================
[0m17:58:58.638310 [info ] [MainThread]: Running with dbt=1.6.1
[0m17:58:58.643312 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'D:\\00 Project\\00 My Project\\IdeaProjects\\Py-DBT-IDX\\logs', 'profiles_dir': 'D:\\00 Project\\00 My Project\\IdeaProjects\\Py-DBT-IDX', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt snapshot', 'send_anonymous_usage_stats': 'False'}
[0m17:58:58.797992 [info ] [MainThread]: Registered adapter: postgres=1.6.1
[0m17:58:58.810563 [debug] [MainThread]: checksum: efe19d9f5b93d1a98cc804fbfcdb6b3aced98b974af664946fee1cde8837deb7, vars: {}, profile: , target: , version: 1.6.1
[0m17:58:58.973765 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 4 files added, 1 files changed.
[0m17:58:58.974767 [debug] [MainThread]: Partial parsing: added file: dbt_idx://models\marts\marketing\customer_orders_status.sql
[0m17:58:58.976281 [debug] [MainThread]: Partial parsing: added file: dbt_idx://tests\assert_customer_dimension_has_no_row_loss.sql.sql
[0m17:58:58.977288 [debug] [MainThread]: Partial parsing: added file: dbt_idx://models\staging\stg_eltool.yml
[0m17:58:58.977288 [debug] [MainThread]: Partial parsing: added file: dbt_idx://models\marts\marketing\marketing.yml
[0m17:58:58.978287 [debug] [MainThread]: Partial parsing: updated file: dbt_idx://models\marts\core\dim_customers.sql
[0m17:58:59.135212 [info ] [MainThread]: Found 6 models, 1 snapshot, 9 tests, 3 sources, 0 exposures, 0 metrics, 349 macros, 0 groups, 0 semantic models
[0m17:58:59.137660 [info ] [MainThread]: 
[0m17:58:59.139666 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m17:58:59.141622 [debug] [ThreadPool]: Acquiring new postgres connection 'list_IDX-Stock'
[0m17:58:59.153140 [debug] [ThreadPool]: Using postgres connection "list_IDX-Stock"
[0m17:58:59.154143 [debug] [ThreadPool]: On list_IDX-Stock: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "connection_name": "list_IDX-Stock"} */

    select distinct nspname from pg_namespace
  
[0m17:58:59.155141 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:58:59.200895 [debug] [ThreadPool]: SQL status: SELECT 11 in 0.0 seconds
[0m17:58:59.202943 [debug] [ThreadPool]: On list_IDX-Stock: Close
[0m17:58:59.206409 [debug] [ThreadPool]: Acquiring new postgres connection 'list_IDX-Stock_warehouse'
[0m17:58:59.219016 [debug] [ThreadPool]: Using postgres connection "list_IDX-Stock_warehouse"
[0m17:58:59.219016 [debug] [ThreadPool]: On list_IDX-Stock_warehouse: BEGIN
[0m17:58:59.220091 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:58:59.246116 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m17:58:59.248209 [debug] [ThreadPool]: Using postgres connection "list_IDX-Stock_warehouse"
[0m17:58:59.249155 [debug] [ThreadPool]: On list_IDX-Stock_warehouse: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "connection_name": "list_IDX-Stock_warehouse"} */
select
      'IDX-Stock' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'warehouse'
    union all
    select
      'IDX-Stock' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'warehouse'
    union all
    select
      'IDX-Stock' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'warehouse'
  
[0m17:58:59.257726 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.0 seconds
[0m17:58:59.259735 [debug] [ThreadPool]: On list_IDX-Stock_warehouse: ROLLBACK
[0m17:58:59.262763 [debug] [ThreadPool]: On list_IDX-Stock_warehouse: Close
[0m17:58:59.264730 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_IDX-Stock_warehouse, now list_IDX-Stock_snapshots)
[0m17:58:59.269283 [debug] [ThreadPool]: Using postgres connection "list_IDX-Stock_snapshots"
[0m17:58:59.270307 [debug] [ThreadPool]: On list_IDX-Stock_snapshots: BEGIN
[0m17:58:59.271285 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:58:59.296933 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m17:58:59.297943 [debug] [ThreadPool]: Using postgres connection "list_IDX-Stock_snapshots"
[0m17:58:59.298921 [debug] [ThreadPool]: On list_IDX-Stock_snapshots: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "connection_name": "list_IDX-Stock_snapshots"} */
select
      'IDX-Stock' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'snapshots'
    union all
    select
      'IDX-Stock' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'snapshots'
    union all
    select
      'IDX-Stock' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'snapshots'
  
[0m17:58:59.304217 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.0 seconds
[0m17:58:59.305868 [debug] [ThreadPool]: On list_IDX-Stock_snapshots: ROLLBACK
[0m17:58:59.308804 [debug] [ThreadPool]: On list_IDX-Stock_snapshots: Close
[0m17:58:59.317365 [debug] [MainThread]: Using postgres connection "master"
[0m17:58:59.318366 [debug] [MainThread]: On master: BEGIN
[0m17:58:59.319368 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:58:59.342240 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m17:58:59.343273 [debug] [MainThread]: Using postgres connection "master"
[0m17:58:59.344266 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m17:58:59.352068 [debug] [MainThread]: SQL status: SELECT 0 in 0.0 seconds
[0m17:58:59.354117 [debug] [MainThread]: On master: ROLLBACK
[0m17:58:59.356103 [debug] [MainThread]: Using postgres connection "master"
[0m17:58:59.357365 [debug] [MainThread]: On master: BEGIN
[0m17:58:59.361348 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m17:58:59.362366 [debug] [MainThread]: On master: COMMIT
[0m17:58:59.363375 [debug] [MainThread]: Using postgres connection "master"
[0m17:58:59.363375 [debug] [MainThread]: On master: COMMIT
[0m17:58:59.365925 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m17:58:59.365925 [debug] [MainThread]: On master: Close
[0m17:58:59.367883 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:58:59.369902 [info ] [MainThread]: 
[0m17:58:59.374882 [debug] [Thread-1 (]: Began running node snapshot.dbt_idx.customers_snapshot
[0m17:58:59.375883 [info ] [Thread-1 (]: 1 of 1 START snapshot snapshots.customers_snapshot ............................. [RUN]
[0m17:58:59.376982 [debug] [Thread-1 (]: Acquiring new postgres connection 'snapshot.dbt_idx.customers_snapshot'
[0m17:58:59.377983 [debug] [Thread-1 (]: Began compiling node snapshot.dbt_idx.customers_snapshot
[0m17:58:59.387502 [debug] [Thread-1 (]: Timing info for snapshot.dbt_idx.customers_snapshot (compile): 17:58:59.378989 => 17:58:59.387502
[0m17:58:59.388507 [debug] [Thread-1 (]: Began executing node snapshot.dbt_idx.customers_snapshot
[0m17:58:59.438222 [debug] [Thread-1 (]: Using postgres connection "snapshot.dbt_idx.customers_snapshot"
[0m17:58:59.439246 [debug] [Thread-1 (]: On snapshot.dbt_idx.customers_snapshot: BEGIN
[0m17:58:59.440255 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m17:58:59.462976 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m17:58:59.463951 [debug] [Thread-1 (]: Using postgres connection "snapshot.dbt_idx.customers_snapshot"
[0m17:58:59.464966 [debug] [Thread-1 (]: On snapshot.dbt_idx.customers_snapshot: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "snapshot.dbt_idx.customers_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "IDX-Stock".INFORMATION_SCHEMA.columns
      where table_name = 'customers_snapshot'
        
        and table_schema = 'snapshots'
        
      order by ordinal_position

  
[0m17:58:59.489131 [debug] [Thread-1 (]: SQL status: SELECT 10 in 0.0 seconds
[0m17:58:59.519019 [debug] [Thread-1 (]: Using postgres connection "snapshot.dbt_idx.customers_snapshot"
[0m17:58:59.520024 [debug] [Thread-1 (]: On snapshot.dbt_idx.customers_snapshot: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "snapshot.dbt_idx.customers_snapshot"} */

        
  
    

  create temporary table "customers_snapshot__dbt_tmp175859505971"
  
  
    as
  
  (
    with snapshot_query as (

        



select *
from "IDX-Stock"."warehouse"."customers"


    ),

    snapshotted_data as (

        select *,
            customer_id as dbt_unique_key

        from "IDX-Stock"."snapshots"."customers_snapshot"
        where dbt_valid_to is null

    ),

    insertions_source_data as (

        select
            *,
            customer_id as dbt_unique_key,
            datetime_updated as dbt_updated_at,
            datetime_updated as dbt_valid_from,
            nullif(datetime_updated, datetime_updated) as dbt_valid_to,
            md5(coalesce(cast(customer_id as varchar ), '')
         || '|' || coalesce(cast(datetime_updated as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select
            *,
            customer_id as dbt_unique_key,
            datetime_updated as dbt_updated_at,
            datetime_updated as dbt_valid_from,
            datetime_updated as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where snapshotted_data.dbt_unique_key is null
           or (
                snapshotted_data.dbt_unique_key is not null
            and (
                (snapshotted_data.dbt_valid_from < source_data.datetime_updated)
            )
        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where (
            (snapshotted_data.dbt_valid_from < source_data.datetime_updated)
        )
    )

    select * from insertions
    union all
    select * from updates

  );
  
    
[0m17:58:59.532673 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.0 seconds
[0m17:58:59.536277 [debug] [Thread-1 (]: Using postgres connection "snapshot.dbt_idx.customers_snapshot"
[0m17:58:59.537224 [debug] [Thread-1 (]: On snapshot.dbt_idx.customers_snapshot: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "snapshot.dbt_idx.customers_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'customers_snapshot__dbt_tmp175859505971'
        
      order by ordinal_position

  
[0m17:58:59.541883 [debug] [Thread-1 (]: SQL status: SELECT 12 in 0.0 seconds
[0m17:58:59.545876 [debug] [Thread-1 (]: Using postgres connection "snapshot.dbt_idx.customers_snapshot"
[0m17:58:59.546382 [debug] [Thread-1 (]: On snapshot.dbt_idx.customers_snapshot: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "snapshot.dbt_idx.customers_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "IDX-Stock".INFORMATION_SCHEMA.columns
      where table_name = 'customers_snapshot'
        
        and table_schema = 'snapshots'
        
      order by ordinal_position

  
[0m17:58:59.550394 [debug] [Thread-1 (]: SQL status: SELECT 10 in 0.0 seconds
[0m17:58:59.556907 [debug] [Thread-1 (]: Using postgres connection "snapshot.dbt_idx.customers_snapshot"
[0m17:58:59.557908 [debug] [Thread-1 (]: On snapshot.dbt_idx.customers_snapshot: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "snapshot.dbt_idx.customers_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'customers_snapshot__dbt_tmp175859505971'
        
      order by ordinal_position

  
[0m17:58:59.562907 [debug] [Thread-1 (]: SQL status: SELECT 12 in 0.0 seconds
[0m17:58:59.566411 [debug] [Thread-1 (]: Using postgres connection "snapshot.dbt_idx.customers_snapshot"
[0m17:58:59.566411 [debug] [Thread-1 (]: On snapshot.dbt_idx.customers_snapshot: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "snapshot.dbt_idx.customers_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "IDX-Stock".INFORMATION_SCHEMA.columns
      where table_name = 'customers_snapshot'
        
        and table_schema = 'snapshots'
        
      order by ordinal_position

  
[0m17:58:59.571425 [debug] [Thread-1 (]: SQL status: SELECT 10 in 0.0 seconds
[0m17:58:59.579942 [debug] [Thread-1 (]: Using postgres connection "snapshot.dbt_idx.customers_snapshot"
[0m17:58:59.581942 [debug] [Thread-1 (]: On snapshot.dbt_idx.customers_snapshot: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "snapshot.dbt_idx.customers_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'customers_snapshot__dbt_tmp175859505971'
        
      order by ordinal_position

  
[0m17:58:59.586464 [debug] [Thread-1 (]: SQL status: SELECT 12 in 0.0 seconds
[0m17:58:59.596487 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.dbt_idx.customers_snapshot"
[0m17:58:59.611028 [debug] [Thread-1 (]: Using postgres connection "snapshot.dbt_idx.customers_snapshot"
[0m17:58:59.612052 [debug] [Thread-1 (]: On snapshot.dbt_idx.customers_snapshot: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "snapshot.dbt_idx.customers_snapshot"} */

      update "IDX-Stock"."snapshots"."customers_snapshot"
    set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to
    from "customers_snapshot__dbt_tmp175859505971" as DBT_INTERNAL_SOURCE
    where DBT_INTERNAL_SOURCE.dbt_scd_id::text = "IDX-Stock"."snapshots"."customers_snapshot".dbt_scd_id::text
      and DBT_INTERNAL_SOURCE.dbt_change_type::text in ('update'::text, 'delete'::text)
      and "IDX-Stock"."snapshots"."customers_snapshot".dbt_valid_to is null;

    insert into "IDX-Stock"."snapshots"."customers_snapshot" ("customer_id", "zipcode", "city", "state_code", "datetime_created", "datetime_updated", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id")
    select DBT_INTERNAL_SOURCE."customer_id",DBT_INTERNAL_SOURCE."zipcode",DBT_INTERNAL_SOURCE."city",DBT_INTERNAL_SOURCE."state_code",DBT_INTERNAL_SOURCE."datetime_created",DBT_INTERNAL_SOURCE."datetime_updated",DBT_INTERNAL_SOURCE."dbt_updated_at",DBT_INTERNAL_SOURCE."dbt_valid_from",DBT_INTERNAL_SOURCE."dbt_valid_to",DBT_INTERNAL_SOURCE."dbt_scd_id"
    from "customers_snapshot__dbt_tmp175859505971" as DBT_INTERNAL_SOURCE
    where DBT_INTERNAL_SOURCE.dbt_change_type::text = 'insert'::text;

  
[0m17:58:59.616024 [debug] [Thread-1 (]: SQL status: INSERT 0 0 in 0.0 seconds
[0m17:58:59.634688 [debug] [Thread-1 (]: On snapshot.dbt_idx.customers_snapshot: COMMIT
[0m17:58:59.636198 [debug] [Thread-1 (]: Using postgres connection "snapshot.dbt_idx.customers_snapshot"
[0m17:58:59.637723 [debug] [Thread-1 (]: On snapshot.dbt_idx.customers_snapshot: COMMIT
[0m17:58:59.640748 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m17:58:59.644748 [debug] [Thread-1 (]: Timing info for snapshot.dbt_idx.customers_snapshot (execute): 17:58:59.389507 => 17:58:59.644748
[0m17:58:59.645749 [debug] [Thread-1 (]: On snapshot.dbt_idx.customers_snapshot: Close
[0m17:58:59.649242 [info ] [Thread-1 (]: 1 of 1 OK snapshotted snapshots.customers_snapshot ............................. [[32msuccess[0m in 0.27s]
[0m17:58:59.652226 [debug] [Thread-1 (]: Finished running node snapshot.dbt_idx.customers_snapshot
[0m17:58:59.655752 [debug] [MainThread]: Using postgres connection "master"
[0m17:58:59.656761 [debug] [MainThread]: On master: BEGIN
[0m17:58:59.657759 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:58:59.684353 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m17:58:59.685922 [debug] [MainThread]: On master: COMMIT
[0m17:58:59.686871 [debug] [MainThread]: Using postgres connection "master"
[0m17:58:59.686871 [debug] [MainThread]: On master: COMMIT
[0m17:58:59.689885 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m17:58:59.690869 [debug] [MainThread]: On master: Close
[0m17:58:59.691892 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:58:59.692870 [debug] [MainThread]: Connection 'list_IDX-Stock' was properly closed.
[0m17:58:59.694397 [debug] [MainThread]: Connection 'list_IDX-Stock_snapshots' was properly closed.
[0m17:58:59.695914 [debug] [MainThread]: Connection 'snapshot.dbt_idx.customers_snapshot' was properly closed.
[0m17:58:59.696920 [info ] [MainThread]: 
[0m17:58:59.698921 [info ] [MainThread]: Finished running 1 snapshot in 0 hours 0 minutes and 0.56 seconds (0.56s).
[0m17:58:59.699944 [debug] [MainThread]: Command end result
[0m17:58:59.728228 [info ] [MainThread]: 
[0m17:58:59.730220 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:58:59.731234 [info ] [MainThread]: 
[0m17:58:59.733781 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m17:58:59.734769 [debug] [MainThread]: Command `dbt snapshot` succeeded at 17:58:59.734769 after 1.14 seconds
[0m17:58:59.736315 [debug] [MainThread]: Flushing usage events


============================== 17:59:15.631738 | b724f3e8-cca3-49e4-a68c-82e980ea9fbd ==============================
[0m17:59:15.631738 [info ] [MainThread]: Running with dbt=1.6.1
[0m17:59:15.638860 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'D:\\00 Project\\00 My Project\\IdeaProjects\\Py-DBT-IDX\\logs', 'debug': 'False', 'profiles_dir': 'D:\\00 Project\\00 My Project\\IdeaProjects\\Py-DBT-IDX', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'False'}
[0m17:59:15.810646 [info ] [MainThread]: Registered adapter: postgres=1.6.1
[0m17:59:15.827952 [debug] [MainThread]: checksum: efe19d9f5b93d1a98cc804fbfcdb6b3aced98b974af664946fee1cde8837deb7, vars: {}, profile: , target: , version: 1.6.1
[0m17:59:16.014622 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:59:16.016133 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:59:16.073848 [info ] [MainThread]: Found 6 models, 1 snapshot, 9 tests, 3 sources, 0 exposures, 0 metrics, 349 macros, 0 groups, 0 semantic models
[0m17:59:16.077325 [info ] [MainThread]: 
[0m17:59:16.079331 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m17:59:16.083368 [debug] [ThreadPool]: Acquiring new postgres connection 'list_IDX-Stock'
[0m17:59:16.097524 [debug] [ThreadPool]: Using postgres connection "list_IDX-Stock"
[0m17:59:16.098544 [debug] [ThreadPool]: On list_IDX-Stock: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "connection_name": "list_IDX-Stock"} */

    select distinct nspname from pg_namespace
  
[0m17:59:16.101527 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:59:16.138968 [debug] [ThreadPool]: SQL status: SELECT 13 in 0.0 seconds
[0m17:59:16.141009 [debug] [ThreadPool]: On list_IDX-Stock: Close
[0m17:59:16.145376 [debug] [ThreadPool]: Acquiring new postgres connection 'list_IDX-Stock_snapshots'
[0m17:59:16.154769 [debug] [ThreadPool]: Using postgres connection "list_IDX-Stock_snapshots"
[0m17:59:16.155769 [debug] [ThreadPool]: On list_IDX-Stock_snapshots: BEGIN
[0m17:59:16.156867 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:59:16.186133 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m17:59:16.188140 [debug] [ThreadPool]: Using postgres connection "list_IDX-Stock_snapshots"
[0m17:59:16.189142 [debug] [ThreadPool]: On list_IDX-Stock_snapshots: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "connection_name": "list_IDX-Stock_snapshots"} */
select
      'IDX-Stock' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'snapshots'
    union all
    select
      'IDX-Stock' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'snapshots'
    union all
    select
      'IDX-Stock' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'snapshots'
  
[0m17:59:16.194138 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.0 seconds
[0m17:59:16.195722 [debug] [ThreadPool]: On list_IDX-Stock_snapshots: ROLLBACK
[0m17:59:16.199279 [debug] [ThreadPool]: On list_IDX-Stock_snapshots: Close
[0m17:59:16.202301 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_IDX-Stock_snapshots, now list_IDX-Stock_warehouse)
[0m17:59:16.205817 [debug] [ThreadPool]: Using postgres connection "list_IDX-Stock_warehouse"
[0m17:59:16.206860 [debug] [ThreadPool]: On list_IDX-Stock_warehouse: BEGIN
[0m17:59:16.207857 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:59:16.233221 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m17:59:16.234752 [debug] [ThreadPool]: Using postgres connection "list_IDX-Stock_warehouse"
[0m17:59:16.234752 [debug] [ThreadPool]: On list_IDX-Stock_warehouse: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "connection_name": "list_IDX-Stock_warehouse"} */
select
      'IDX-Stock' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'warehouse'
    union all
    select
      'IDX-Stock' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'warehouse'
    union all
    select
      'IDX-Stock' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'warehouse'
  
[0m17:59:16.240835 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.0 seconds
[0m17:59:16.242845 [debug] [ThreadPool]: On list_IDX-Stock_warehouse: ROLLBACK
[0m17:59:16.246335 [debug] [ThreadPool]: On list_IDX-Stock_warehouse: Close
[0m17:59:16.258963 [debug] [MainThread]: Using postgres connection "master"
[0m17:59:16.261000 [debug] [MainThread]: On master: BEGIN
[0m17:59:16.261976 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:59:16.289680 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m17:59:16.292221 [debug] [MainThread]: Using postgres connection "master"
[0m17:59:16.294766 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m17:59:16.305816 [debug] [MainThread]: SQL status: SELECT 0 in 0.0 seconds
[0m17:59:16.308360 [debug] [MainThread]: On master: ROLLBACK
[0m17:59:16.311852 [debug] [MainThread]: Using postgres connection "master"
[0m17:59:16.312843 [debug] [MainThread]: On master: BEGIN
[0m17:59:16.316805 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m17:59:16.318809 [debug] [MainThread]: On master: COMMIT
[0m17:59:16.319811 [debug] [MainThread]: Using postgres connection "master"
[0m17:59:16.321828 [debug] [MainThread]: On master: COMMIT
[0m17:59:16.324810 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m17:59:16.325841 [debug] [MainThread]: On master: Close
[0m17:59:16.328064 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:59:16.329593 [info ] [MainThread]: 
[0m17:59:16.336106 [debug] [Thread-1 (]: Began running node model.dbt_idx.stg_eltool__customers
[0m17:59:16.337472 [info ] [Thread-1 (]: 1 of 6 START sql view model warehouse.stg_eltool__customers .................... [RUN]
[0m17:59:16.339472 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.dbt_idx.stg_eltool__customers'
[0m17:59:16.341488 [debug] [Thread-1 (]: Began compiling node model.dbt_idx.stg_eltool__customers
[0m17:59:16.354524 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_idx.stg_eltool__customers"
[0m17:59:16.362582 [debug] [Thread-1 (]: Timing info for model.dbt_idx.stg_eltool__customers (compile): 17:59:16.342472 => 17:59:16.361069
[0m17:59:16.364597 [debug] [Thread-1 (]: Began executing node model.dbt_idx.stg_eltool__customers
[0m17:59:16.413400 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_idx.stg_eltool__customers"
[0m17:59:16.420111 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__customers"
[0m17:59:16.422111 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__customers: BEGIN
[0m17:59:16.423111 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m17:59:16.451935 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m17:59:16.453446 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__customers"
[0m17:59:16.454484 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__customers: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__customers"} */

  create view "IDX-Stock"."warehouse"."stg_eltool__customers__dbt_tmp"
    
    
  as (
    with source as (select *
                from "IDX-Stock"."snapshots"."customers_snapshot"),
     renamed as (select customer_id,
                        zipcode,
                        city,
                        state_code,
                        datetime_created::TIMESTAMP AS datetime_created,
                        datetime_updated::TIMESTAMP AS datetime_updated,
                        dbt_valid_from,
                        dbt_valid_to
                 from source)
select *
from renamed
  );
[0m17:59:16.468540 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m17:59:16.478716 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__customers"
[0m17:59:16.479716 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__customers: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__customers"} */
alter table "IDX-Stock"."warehouse"."stg_eltool__customers__dbt_tmp" rename to "stg_eltool__customers"
[0m17:59:16.483716 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m17:59:16.501266 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__customers: COMMIT
[0m17:59:16.502267 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__customers"
[0m17:59:16.502267 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__customers: COMMIT
[0m17:59:16.506819 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m17:59:16.517335 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__customers"
[0m17:59:16.518347 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__customers: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__customers"} */
drop view if exists "IDX-Stock"."warehouse"."stg_eltool__customers__dbt_backup" cascade
[0m17:59:16.521862 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m17:59:16.524896 [debug] [Thread-1 (]: Timing info for model.dbt_idx.stg_eltool__customers (execute): 17:59:16.364597 => 17:59:16.523884
[0m17:59:16.524896 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__customers: Close
[0m17:59:16.527398 [info ] [Thread-1 (]: 1 of 6 OK created sql view model warehouse.stg_eltool__customers ............... [[32mCREATE VIEW[0m in 0.19s]
[0m17:59:16.530413 [debug] [Thread-1 (]: Finished running node model.dbt_idx.stg_eltool__customers
[0m17:59:16.532405 [debug] [Thread-1 (]: Began running node model.dbt_idx.stg_eltool__orders
[0m17:59:16.534420 [info ] [Thread-1 (]: 2 of 6 START sql view model warehouse.stg_eltool__orders ....................... [RUN]
[0m17:59:16.536954 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_idx.stg_eltool__customers, now model.dbt_idx.stg_eltool__orders)
[0m17:59:16.537971 [debug] [Thread-1 (]: Began compiling node model.dbt_idx.stg_eltool__orders
[0m17:59:16.544491 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_idx.stg_eltool__orders"
[0m17:59:16.557152 [debug] [Thread-1 (]: Timing info for model.dbt_idx.stg_eltool__orders (compile): 17:59:16.538954 => 17:59:16.556135
[0m17:59:16.558151 [debug] [Thread-1 (]: Began executing node model.dbt_idx.stg_eltool__orders
[0m17:59:16.569239 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_idx.stg_eltool__orders"
[0m17:59:16.579832 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__orders"
[0m17:59:16.580834 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__orders: BEGIN
[0m17:59:16.583859 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:59:16.613629 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m17:59:16.614671 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__orders"
[0m17:59:16.615799 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__orders: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__orders"} */

  create view "IDX-Stock"."warehouse"."stg_eltool__orders__dbt_tmp"
    
    
  as (
    with source as (select *
                from "IDX-Stock"."warehouse"."orders"),
     renamed as (select order_id,
                        cust_id AS customer_id,
                        order_status,
                        order_purchase_timestamp::TIMESTAMP,
                        order_approved_at::TIMESTAMP,
                        order_delivered_carrier_date::TIMESTAMP,
                        order_delivered_customer_date::TIMESTAMP,
                        order_estimated_delivery_date::TIMESTAMP
                 from source)
select *
from renamed
  );
[0m17:59:16.620742 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m17:59:16.624761 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__orders"
[0m17:59:16.625745 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__orders: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__orders"} */
alter table "IDX-Stock"."warehouse"."stg_eltool__orders__dbt_tmp" rename to "stg_eltool__orders"
[0m17:59:16.629309 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m17:59:16.632315 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__orders: COMMIT
[0m17:59:16.633326 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__orders"
[0m17:59:16.634334 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__orders: COMMIT
[0m17:59:16.637889 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m17:59:16.642918 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__orders"
[0m17:59:16.642918 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__orders: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__orders"} */
drop view if exists "IDX-Stock"."warehouse"."stg_eltool__orders__dbt_backup" cascade
[0m17:59:16.647008 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m17:59:16.649017 [debug] [Thread-1 (]: Timing info for model.dbt_idx.stg_eltool__orders (execute): 17:59:16.559150 => 17:59:16.649017
[0m17:59:16.650022 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__orders: Close
[0m17:59:16.653035 [info ] [Thread-1 (]: 2 of 6 OK created sql view model warehouse.stg_eltool__orders .................. [[32mCREATE VIEW[0m in 0.12s]
[0m17:59:16.656089 [debug] [Thread-1 (]: Finished running node model.dbt_idx.stg_eltool__orders
[0m17:59:16.658100 [debug] [Thread-1 (]: Began running node model.dbt_idx.stg_eltool__state
[0m17:59:16.660691 [info ] [Thread-1 (]: 3 of 6 START sql view model warehouse.stg_eltool__state ........................ [RUN]
[0m17:59:16.662619 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_idx.stg_eltool__orders, now model.dbt_idx.stg_eltool__state)
[0m17:59:16.663619 [debug] [Thread-1 (]: Began compiling node model.dbt_idx.stg_eltool__state
[0m17:59:16.669162 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_idx.stg_eltool__state"
[0m17:59:16.674716 [debug] [Thread-1 (]: Timing info for model.dbt_idx.stg_eltool__state (compile): 17:59:16.663619 => 17:59:16.674716
[0m17:59:16.675716 [debug] [Thread-1 (]: Began executing node model.dbt_idx.stg_eltool__state
[0m17:59:16.684578 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_idx.stg_eltool__state"
[0m17:59:16.691097 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__state"
[0m17:59:16.693091 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__state: BEGIN
[0m17:59:16.693091 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:59:16.722634 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m17:59:16.723636 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__state"
[0m17:59:16.724634 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__state: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__state"} */

  create view "IDX-Stock"."warehouse"."stg_eltool__state__dbt_tmp"
    
    
  as (
    with source as (select *
                from "IDX-Stock"."warehouse"."state"),
     renamed as (select state_identifier::INT AS state_id,
                         state_code::VARCHAR(2) AS state_code,
                         st_name::VARCHAR(30) AS state_name
                 from source)
select *
from renamed
  );
[0m17:59:16.729180 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m17:59:16.733165 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__state"
[0m17:59:16.734194 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__state: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__state"} */
alter table "IDX-Stock"."warehouse"."stg_eltool__state__dbt_tmp" rename to "stg_eltool__state"
[0m17:59:16.736711 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m17:59:16.740221 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__state: COMMIT
[0m17:59:16.741223 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__state"
[0m17:59:16.742221 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__state: COMMIT
[0m17:59:16.746269 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m17:59:16.750283 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__state"
[0m17:59:16.751279 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__state: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__state"} */
drop view if exists "IDX-Stock"."warehouse"."stg_eltool__state__dbt_backup" cascade
[0m17:59:16.754287 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m17:59:16.758850 [debug] [Thread-1 (]: Timing info for model.dbt_idx.stg_eltool__state (execute): 17:59:16.677067 => 17:59:16.757850
[0m17:59:16.759853 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__state: Close
[0m17:59:16.763439 [info ] [Thread-1 (]: 3 of 6 OK created sql view model warehouse.stg_eltool__state ................... [[32mCREATE VIEW[0m in 0.10s]
[0m17:59:16.766498 [debug] [Thread-1 (]: Finished running node model.dbt_idx.stg_eltool__state
[0m17:59:16.768513 [debug] [Thread-1 (]: Began running node model.dbt_idx.fct_orders
[0m17:59:16.770767 [info ] [Thread-1 (]: 4 of 6 START sql table model warehouse.fct_orders .............................. [RUN]
[0m17:59:16.773288 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_idx.stg_eltool__state, now model.dbt_idx.fct_orders)
[0m17:59:16.774799 [debug] [Thread-1 (]: Began compiling node model.dbt_idx.fct_orders
[0m17:59:16.779564 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_idx.fct_orders"
[0m17:59:16.786197 [debug] [Thread-1 (]: Timing info for model.dbt_idx.fct_orders (compile): 17:59:16.774799 => 17:59:16.784577
[0m17:59:16.787097 [debug] [Thread-1 (]: Began executing node model.dbt_idx.fct_orders
[0m17:59:16.821201 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_idx.fct_orders"
[0m17:59:16.826733 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.fct_orders"
[0m17:59:16.827918 [debug] [Thread-1 (]: On model.dbt_idx.fct_orders: BEGIN
[0m17:59:16.828932 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:59:16.854847 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m17:59:16.856339 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.fct_orders"
[0m17:59:16.857347 [debug] [Thread-1 (]: On model.dbt_idx.fct_orders: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.fct_orders"} */

  
    

  create  table "IDX-Stock"."warehouse"."fct_orders__dbt_tmp"
  
  
    as
  
  (
    with orders as (
    select *
    from "IDX-Stock"."warehouse"."stg_eltool__orders"
)
select * from orders
  );
  
[0m17:59:16.870925 [debug] [Thread-1 (]: SQL status: SELECT 999 in 0.0 seconds
[0m17:59:16.878714 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.fct_orders"
[0m17:59:16.879715 [debug] [Thread-1 (]: On model.dbt_idx.fct_orders: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.fct_orders"} */
alter table "IDX-Stock"."warehouse"."fct_orders__dbt_tmp" rename to "fct_orders"
[0m17:59:16.883721 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m17:59:16.894464 [debug] [Thread-1 (]: On model.dbt_idx.fct_orders: COMMIT
[0m17:59:16.896984 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.fct_orders"
[0m17:59:16.898996 [debug] [Thread-1 (]: On model.dbt_idx.fct_orders: COMMIT
[0m17:59:16.903996 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m17:59:16.912681 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.fct_orders"
[0m17:59:16.913672 [debug] [Thread-1 (]: On model.dbt_idx.fct_orders: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.fct_orders"} */
drop table if exists "IDX-Stock"."warehouse"."fct_orders__dbt_backup" cascade
[0m17:59:16.916818 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m17:59:16.919831 [debug] [Thread-1 (]: Timing info for model.dbt_idx.fct_orders (execute): 17:59:16.788096 => 17:59:16.919831
[0m17:59:16.920826 [debug] [Thread-1 (]: On model.dbt_idx.fct_orders: Close
[0m17:59:16.923829 [info ] [Thread-1 (]: 4 of 6 OK created sql table model warehouse.fct_orders ......................... [[32mSELECT 999[0m in 0.15s]
[0m17:59:16.925829 [debug] [Thread-1 (]: Finished running node model.dbt_idx.fct_orders
[0m17:59:16.927369 [debug] [Thread-1 (]: Began running node model.dbt_idx.dim_customers
[0m17:59:16.928361 [info ] [Thread-1 (]: 5 of 6 START sql table model warehouse.dim_customers ........................... [RUN]
[0m17:59:16.930362 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_idx.fct_orders, now model.dbt_idx.dim_customers)
[0m17:59:16.931364 [debug] [Thread-1 (]: Began compiling node model.dbt_idx.dim_customers
[0m17:59:16.935908 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_idx.dim_customers"
[0m17:59:16.940916 [debug] [Thread-1 (]: Timing info for model.dbt_idx.dim_customers (compile): 17:59:16.932364 => 17:59:16.939920
[0m17:59:16.942425 [debug] [Thread-1 (]: Began executing node model.dbt_idx.dim_customers
[0m17:59:16.950098 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_idx.dim_customers"
[0m17:59:16.957152 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.dim_customers"
[0m17:59:16.959171 [debug] [Thread-1 (]: On model.dbt_idx.dim_customers: BEGIN
[0m17:59:16.960175 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:59:16.992825 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m17:59:16.994332 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.dim_customers"
[0m17:59:16.995938 [debug] [Thread-1 (]: On model.dbt_idx.dim_customers: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.dim_customers"} */

  
    

  create  table "IDX-Stock"."warehouse"."dim_customers__dbt_tmp"
  
  
    as
  
  (
    -- noinspection SqlDialectInspectionForFile

with customers as (
    select *
    from "IDX-Stock"."warehouse"."stg_eltool__customers"
    ),
     state as (
         select *
         from "IDX-Stock"."warehouse"."stg_eltool__state"
     )
select c.customer_id,
       c.zipcode,
       c.city,
       c.state_code,
       s.state_name,
       c.datetime_created,
       c.datetime_updated,
       c.dbt_valid_from::TIMESTAMP as valid_from,
        CASE WHEN c.dbt_valid_to IS NULL
            THEN '9999-12-31'::TIMESTAMP
            ELSE c.dbt_valid_to::TIMESTAMP
        END as valid_to
from customers c
    join state s on c.state_code = s.state_code
  );
  
[0m17:59:17.002857 [debug] [Thread-1 (]: SQL status: SELECT 105 in 0.0 seconds
[0m17:59:17.006364 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.dim_customers"
[0m17:59:17.007371 [debug] [Thread-1 (]: On model.dbt_idx.dim_customers: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.dim_customers"} */
alter table "IDX-Stock"."warehouse"."dim_customers__dbt_tmp" rename to "dim_customers"
[0m17:59:17.010925 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m17:59:17.013928 [debug] [Thread-1 (]: On model.dbt_idx.dim_customers: COMMIT
[0m17:59:17.014927 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.dim_customers"
[0m17:59:17.016455 [debug] [Thread-1 (]: On model.dbt_idx.dim_customers: COMMIT
[0m17:59:17.020492 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m17:59:17.023486 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.dim_customers"
[0m17:59:17.024487 [debug] [Thread-1 (]: On model.dbt_idx.dim_customers: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.dim_customers"} */
drop table if exists "IDX-Stock"."warehouse"."dim_customers__dbt_backup" cascade
[0m17:59:17.027605 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m17:59:17.030163 [debug] [Thread-1 (]: Timing info for model.dbt_idx.dim_customers (execute): 17:59:16.943435 => 17:59:17.030163
[0m17:59:17.032122 [debug] [Thread-1 (]: On model.dbt_idx.dim_customers: Close
[0m17:59:17.034127 [info ] [Thread-1 (]: 5 of 6 OK created sql table model warehouse.dim_customers ...................... [[32mSELECT 105[0m in 0.10s]
[0m17:59:17.036132 [debug] [Thread-1 (]: Finished running node model.dbt_idx.dim_customers
[0m17:59:17.038375 [debug] [Thread-1 (]: Began running node model.dbt_idx.customer_orders_status
[0m17:59:17.039375 [info ] [Thread-1 (]: 6 of 6 START sql view model warehouse.customer_orders_status ................... [RUN]
[0m17:59:17.041381 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_idx.dim_customers, now model.dbt_idx.customer_orders_status)
[0m17:59:17.042376 [debug] [Thread-1 (]: Began compiling node model.dbt_idx.customer_orders_status
[0m17:59:17.046476 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_idx.customer_orders_status"
[0m17:59:17.051732 [debug] [Thread-1 (]: Timing info for model.dbt_idx.customer_orders_status (compile): 17:59:17.043397 => 17:59:17.051732
[0m17:59:17.052731 [debug] [Thread-1 (]: Began executing node model.dbt_idx.customer_orders_status
[0m17:59:17.059778 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_idx.customer_orders_status"
[0m17:59:17.065789 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.customer_orders_status"
[0m17:59:17.067822 [debug] [Thread-1 (]: On model.dbt_idx.customer_orders_status: BEGIN
[0m17:59:17.068824 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:59:17.100691 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m17:59:17.101705 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.customer_orders_status"
[0m17:59:17.102694 [debug] [Thread-1 (]: On model.dbt_idx.customer_orders_status: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.customer_orders_status"} */

  create view "IDX-Stock"."warehouse"."customer_orders_status__dbt_tmp"
    
    
  as (
    with orders as (select *
                from "IDX-Stock"."warehouse"."fct_orders"),
     customers as (select *
                   from "IDX-Stock"."warehouse"."dim_customers")
select o.order_id,
       o.customer_id,
       o.order_status,
       o.order_purchase_timestamp,
       o.order_approved_at,
       o.order_delivered_carrier_date,
       o.order_delivered_customer_date,
       o.order_estimated_delivery_date,
       c.zipcode    as customer_zipcode,
       c.city       as customer_city,
       c.state_code as customer_state_code,
       c.state_name as customer_state_name
from orders o
    join customers c on o.customer_id = c.customer_id
    and o.order_purchase_timestamp >= c.valid_from
    and o.order_purchase_timestamp <= c.valid_to
  );
[0m17:59:17.107877 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m17:59:17.114767 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.customer_orders_status"
[0m17:59:17.115774 [debug] [Thread-1 (]: On model.dbt_idx.customer_orders_status: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.customer_orders_status"} */
alter table "IDX-Stock"."warehouse"."customer_orders_status__dbt_tmp" rename to "customer_orders_status"
[0m17:59:17.118201 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m17:59:17.122201 [debug] [Thread-1 (]: On model.dbt_idx.customer_orders_status: COMMIT
[0m17:59:17.123199 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.customer_orders_status"
[0m17:59:17.124219 [debug] [Thread-1 (]: On model.dbt_idx.customer_orders_status: COMMIT
[0m17:59:17.129289 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m17:59:17.134636 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.customer_orders_status"
[0m17:59:17.136207 [debug] [Thread-1 (]: On model.dbt_idx.customer_orders_status: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.customer_orders_status"} */
drop view if exists "IDX-Stock"."warehouse"."customer_orders_status__dbt_backup" cascade
[0m17:59:17.139185 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m17:59:17.142176 [debug] [Thread-1 (]: Timing info for model.dbt_idx.customer_orders_status (execute): 17:59:17.054240 => 17:59:17.142176
[0m17:59:17.144177 [debug] [Thread-1 (]: On model.dbt_idx.customer_orders_status: Close
[0m17:59:17.146696 [info ] [Thread-1 (]: 6 of 6 OK created sql view model warehouse.customer_orders_status .............. [[32mCREATE VIEW[0m in 0.10s]
[0m17:59:17.149984 [debug] [Thread-1 (]: Finished running node model.dbt_idx.customer_orders_status
[0m17:59:17.153986 [debug] [MainThread]: Using postgres connection "master"
[0m17:59:17.155990 [debug] [MainThread]: On master: BEGIN
[0m17:59:17.157081 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:59:17.189859 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m17:59:17.191858 [debug] [MainThread]: On master: COMMIT
[0m17:59:17.192863 [debug] [MainThread]: Using postgres connection "master"
[0m17:59:17.193875 [debug] [MainThread]: On master: COMMIT
[0m17:59:17.195700 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m17:59:17.196707 [debug] [MainThread]: On master: Close
[0m17:59:17.198708 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:59:17.201266 [debug] [MainThread]: Connection 'list_IDX-Stock' was properly closed.
[0m17:59:17.203265 [debug] [MainThread]: Connection 'list_IDX-Stock_warehouse' was properly closed.
[0m17:59:17.204264 [debug] [MainThread]: Connection 'model.dbt_idx.customer_orders_status' was properly closed.
[0m17:59:17.205831 [info ] [MainThread]: 
[0m17:59:17.207785 [info ] [MainThread]: Finished running 4 view models, 2 table models in 0 hours 0 minutes and 1.13 seconds (1.13s).
[0m17:59:17.209782 [debug] [MainThread]: Command end result
[0m17:59:17.240886 [info ] [MainThread]: 
[0m17:59:17.242899 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:59:17.243894 [info ] [MainThread]: 
[0m17:59:17.246422 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 TOTAL=6
[0m17:59:17.248536 [debug] [MainThread]: Command `dbt run` succeeded at 17:59:17.248536 after 1.66 seconds
[0m17:59:17.250577 [debug] [MainThread]: Flushing usage events


============================== 18:04:14.148088 | d37ed150-dade-42b7-8d9e-ea7f556a911c ==============================
[0m18:04:14.148088 [info ] [MainThread]: Running with dbt=1.6.1
[0m18:04:14.153492 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'D:\\00 Project\\00 My Project\\IdeaProjects\\Py-DBT-IDX', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': 'D:\\00 Project\\00 My Project\\IdeaProjects\\Py-DBT-IDX\\logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'False'}
[0m18:04:14.291041 [info ] [MainThread]: Registered adapter: postgres=1.6.1
[0m18:04:14.300656 [debug] [MainThread]: checksum: efe19d9f5b93d1a98cc804fbfcdb6b3aced98b974af664946fee1cde8837deb7, vars: {}, profile: , target: , version: 1.6.1
[0m18:04:14.330305 [error] [MainThread]: Encountered an error:
Parsing Error
  The schema file at models\staging\stg_eltool.yml is invalid because the value of 'models' is not a list
[0m18:04:14.332313 [debug] [MainThread]: Command `dbt run` failed at 18:04:14.331311 after 0.22 seconds
[0m18:04:14.333309 [debug] [MainThread]: Flushing usage events


============================== 18:04:26.515256 | dc025216-ed3f-4bc1-900b-c81b449d05d0 ==============================
[0m18:04:26.515256 [info ] [MainThread]: Running with dbt=1.6.1
[0m18:04:26.521285 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'D:\\00 Project\\00 My Project\\IdeaProjects\\Py-DBT-IDX\\logs', 'debug': 'False', 'profiles_dir': 'D:\\00 Project\\00 My Project\\IdeaProjects\\Py-DBT-IDX', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'False'}
[0m18:04:26.657828 [info ] [MainThread]: Registered adapter: postgres=1.6.1
[0m18:04:26.668345 [debug] [MainThread]: checksum: efe19d9f5b93d1a98cc804fbfcdb6b3aced98b974af664946fee1cde8837deb7, vars: {}, profile: , target: , version: 1.6.1
[0m18:04:26.813919 [debug] [MainThread]: Partial parsing enabled: 1 files deleted, 1 files added, 2 files changed.
[0m18:04:26.815427 [debug] [MainThread]: Partial parsing: added file: dbt_idx://models\marts\core\fact_orders.sql
[0m18:04:26.815427 [debug] [MainThread]: Partial parsing: updated file: dbt_idx://models\marts\core\core.yml
[0m18:04:26.816433 [debug] [MainThread]: Partial parsing: updated file: dbt_idx://models\staging\stg_eltool.yml
[0m18:04:26.817440 [debug] [MainThread]: Partial parsing: deleted file: dbt_idx://models\marts\core\fct_orders.sql
[0m18:04:26.895136 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.dbt_idx.customer_orders_status' (models\marts\marketing\customer_orders_status.sql) depends on a node named 'fct_orders' which was not found
[0m18:04:26.897139 [debug] [MainThread]: Command `dbt run` failed at 18:04:26.896092 after 0.43 seconds
[0m18:04:26.897139 [debug] [MainThread]: Flushing usage events


============================== 18:04:56.315504 | dec835f7-2566-4566-a7ca-1ca5d2467f06 ==============================
[0m18:04:56.315504 [info ] [MainThread]: Running with dbt=1.6.1
[0m18:04:56.321504 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'D:\\00 Project\\00 My Project\\IdeaProjects\\Py-DBT-IDX', 'version_check': 'True', 'debug': 'False', 'log_path': 'D:\\00 Project\\00 My Project\\IdeaProjects\\Py-DBT-IDX\\logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'False'}
[0m18:04:56.475799 [info ] [MainThread]: Registered adapter: postgres=1.6.1
[0m18:04:56.492458 [debug] [MainThread]: checksum: efe19d9f5b93d1a98cc804fbfcdb6b3aced98b974af664946fee1cde8837deb7, vars: {}, profile: , target: , version: 1.6.1
[0m18:04:56.677143 [debug] [MainThread]: Partial parsing enabled: 1 files deleted, 1 files added, 3 files changed.
[0m18:04:56.678112 [debug] [MainThread]: Partial parsing: added file: dbt_idx://models\marts\core\fact_orders.sql
[0m18:04:56.679161 [debug] [MainThread]: Partial parsing: updated file: dbt_idx://models\marts\core\core.yml
[0m18:04:56.680113 [debug] [MainThread]: Partial parsing: updated file: dbt_idx://models\staging\stg_eltool.yml
[0m18:04:56.681112 [debug] [MainThread]: Partial parsing: deleted file: dbt_idx://models\marts\core\fct_orders.sql
[0m18:04:56.682127 [debug] [MainThread]: Partial parsing: updated file: dbt_idx://models\marts\marketing\customer_orders_status.sql
[0m18:04:56.880344 [info ] [MainThread]: Found 1 snapshot, 8 tests, 6 models, 3 sources, 0 exposures, 0 metrics, 349 macros, 0 groups, 0 semantic models
[0m18:04:56.883346 [info ] [MainThread]: 
[0m18:04:56.886400 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m18:04:56.890419 [debug] [ThreadPool]: Acquiring new postgres connection 'list_IDX-Stock'
[0m18:04:56.917135 [debug] [ThreadPool]: Using postgres connection "list_IDX-Stock"
[0m18:04:56.918155 [debug] [ThreadPool]: On list_IDX-Stock: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "connection_name": "list_IDX-Stock"} */

    select distinct nspname from pg_namespace
  
[0m18:04:56.919885 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:04:56.957102 [debug] [ThreadPool]: SQL status: SELECT 13 in 0.0 seconds
[0m18:04:56.960127 [debug] [ThreadPool]: On list_IDX-Stock: Close
[0m18:04:56.964619 [debug] [ThreadPool]: Acquiring new postgres connection 'list_IDX-Stock_warehouse'
[0m18:04:56.974674 [debug] [ThreadPool]: Using postgres connection "list_IDX-Stock_warehouse"
[0m18:04:56.975184 [debug] [ThreadPool]: On list_IDX-Stock_warehouse: BEGIN
[0m18:04:56.976192 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:04:57.000285 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m18:04:57.001281 [debug] [ThreadPool]: Using postgres connection "list_IDX-Stock_warehouse"
[0m18:04:57.002275 [debug] [ThreadPool]: On list_IDX-Stock_warehouse: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "connection_name": "list_IDX-Stock_warehouse"} */
select
      'IDX-Stock' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'warehouse'
    union all
    select
      'IDX-Stock' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'warehouse'
    union all
    select
      'IDX-Stock' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'warehouse'
  
[0m18:04:57.007798 [debug] [ThreadPool]: SQL status: SELECT 9 in 0.0 seconds
[0m18:04:57.009797 [debug] [ThreadPool]: On list_IDX-Stock_warehouse: ROLLBACK
[0m18:04:57.012324 [debug] [ThreadPool]: On list_IDX-Stock_warehouse: Close
[0m18:04:57.014924 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_IDX-Stock_warehouse, now list_IDX-Stock_snapshots)
[0m18:04:57.020872 [debug] [ThreadPool]: Using postgres connection "list_IDX-Stock_snapshots"
[0m18:04:57.021872 [debug] [ThreadPool]: On list_IDX-Stock_snapshots: BEGIN
[0m18:04:57.022872 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:04:57.046084 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m18:04:57.048073 [debug] [ThreadPool]: Using postgres connection "list_IDX-Stock_snapshots"
[0m18:04:57.048073 [debug] [ThreadPool]: On list_IDX-Stock_snapshots: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "connection_name": "list_IDX-Stock_snapshots"} */
select
      'IDX-Stock' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'snapshots'
    union all
    select
      'IDX-Stock' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'snapshots'
    union all
    select
      'IDX-Stock' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'snapshots'
  
[0m18:04:57.053088 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.0 seconds
[0m18:04:57.054646 [debug] [ThreadPool]: On list_IDX-Stock_snapshots: ROLLBACK
[0m18:04:57.057176 [debug] [ThreadPool]: On list_IDX-Stock_snapshots: Close
[0m18:04:57.069697 [debug] [MainThread]: Using postgres connection "master"
[0m18:04:57.070695 [debug] [MainThread]: On master: BEGIN
[0m18:04:57.071697 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:04:57.096791 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m18:04:57.097796 [debug] [MainThread]: Using postgres connection "master"
[0m18:04:57.098855 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m18:04:57.107573 [debug] [MainThread]: SQL status: SELECT 5 in 0.0 seconds
[0m18:04:57.111606 [debug] [MainThread]: On master: ROLLBACK
[0m18:04:57.113578 [debug] [MainThread]: Using postgres connection "master"
[0m18:04:57.114603 [debug] [MainThread]: On master: BEGIN
[0m18:04:57.117662 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m18:04:57.118703 [debug] [MainThread]: On master: COMMIT
[0m18:04:57.119673 [debug] [MainThread]: Using postgres connection "master"
[0m18:04:57.120675 [debug] [MainThread]: On master: COMMIT
[0m18:04:57.123678 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m18:04:57.124731 [debug] [MainThread]: On master: Close
[0m18:04:57.128008 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:04:57.129008 [info ] [MainThread]: 
[0m18:04:57.136705 [debug] [Thread-1 (]: Began running node model.dbt_idx.stg_eltool__customers
[0m18:04:57.137733 [info ] [Thread-1 (]: 1 of 6 START sql view model warehouse.stg_eltool__customers .................... [RUN]
[0m18:04:57.139702 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.dbt_idx.stg_eltool__customers'
[0m18:04:57.140719 [debug] [Thread-1 (]: Began compiling node model.dbt_idx.stg_eltool__customers
[0m18:04:57.148319 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_idx.stg_eltool__customers"
[0m18:04:57.156359 [debug] [Thread-1 (]: Timing info for model.dbt_idx.stg_eltool__customers (compile): 18:04:57.141712 => 18:04:57.156359
[0m18:04:57.157368 [debug] [Thread-1 (]: Began executing node model.dbt_idx.stg_eltool__customers
[0m18:04:57.206211 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_idx.stg_eltool__customers"
[0m18:04:57.213245 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__customers"
[0m18:04:57.214821 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__customers: BEGIN
[0m18:04:57.215761 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m18:04:57.244618 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m18:04:57.246762 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__customers"
[0m18:04:57.247763 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__customers: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__customers"} */

  create view "IDX-Stock"."warehouse"."stg_eltool__customers__dbt_tmp"
    
    
  as (
    with source as (select *
                from "IDX-Stock"."snapshots"."customers_snapshot"),
     renamed as (select customer_id,
                        zipcode,
                        city,
                        state_code,
                        datetime_created::TIMESTAMP AS datetime_created,
                        datetime_updated::TIMESTAMP AS datetime_updated,
                        dbt_valid_from,
                        dbt_valid_to
                 from source)
select *
from renamed
  );
[0m18:04:57.259313 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m18:04:57.271890 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__customers"
[0m18:04:57.272906 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__customers: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__customers"} */
alter table "IDX-Stock"."warehouse"."stg_eltool__customers" rename to "stg_eltool__customers__dbt_backup"
[0m18:04:57.276057 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:04:57.281053 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__customers"
[0m18:04:57.282559 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__customers: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__customers"} */
alter table "IDX-Stock"."warehouse"."stg_eltool__customers__dbt_tmp" rename to "stg_eltool__customers"
[0m18:04:57.286094 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:04:57.307103 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__customers: COMMIT
[0m18:04:57.308132 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__customers"
[0m18:04:57.309111 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__customers: COMMIT
[0m18:04:57.313133 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m18:04:57.326776 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__customers"
[0m18:04:57.327743 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__customers: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__customers"} */
drop view if exists "IDX-Stock"."warehouse"."stg_eltool__customers__dbt_backup" cascade
[0m18:04:57.331779 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m18:04:57.334778 [debug] [Thread-1 (]: Timing info for model.dbt_idx.stg_eltool__customers (execute): 18:04:57.158565 => 18:04:57.333754
[0m18:04:57.335332 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__customers: Close
[0m18:04:57.337341 [info ] [Thread-1 (]: 1 of 6 OK created sql view model warehouse.stg_eltool__customers ............... [[32mCREATE VIEW[0m in 0.20s]
[0m18:04:57.339854 [debug] [Thread-1 (]: Finished running node model.dbt_idx.stg_eltool__customers
[0m18:04:57.341896 [debug] [Thread-1 (]: Began running node model.dbt_idx.stg_eltool__orders
[0m18:04:57.343865 [info ] [Thread-1 (]: 2 of 6 START sql view model warehouse.stg_eltool__orders ....................... [RUN]
[0m18:04:57.346317 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_idx.stg_eltool__customers, now model.dbt_idx.stg_eltool__orders)
[0m18:04:57.347299 [debug] [Thread-1 (]: Began compiling node model.dbt_idx.stg_eltool__orders
[0m18:04:57.351301 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_idx.stg_eltool__orders"
[0m18:04:57.363404 [debug] [Thread-1 (]: Timing info for model.dbt_idx.stg_eltool__orders (compile): 18:04:57.348310 => 18:04:57.363404
[0m18:04:57.365047 [debug] [Thread-1 (]: Began executing node model.dbt_idx.stg_eltool__orders
[0m18:04:57.370989 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_idx.stg_eltool__orders"
[0m18:04:57.385496 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__orders"
[0m18:04:57.386598 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__orders: BEGIN
[0m18:04:57.387268 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:04:57.411098 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m18:04:57.412097 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__orders"
[0m18:04:57.412097 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__orders: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__orders"} */

  create view "IDX-Stock"."warehouse"."stg_eltool__orders__dbt_tmp"
    
    
  as (
    with source as (select *
                from "IDX-Stock"."warehouse"."orders"),
     renamed as (select order_id,
                        cust_id AS customer_id,
                        order_status,
                        order_purchase_timestamp::TIMESTAMP,
                        order_approved_at::TIMESTAMP,
                        order_delivered_carrier_date::TIMESTAMP,
                        order_delivered_customer_date::TIMESTAMP,
                        order_estimated_delivery_date::TIMESTAMP
                 from source)
select *
from renamed
  );
[0m18:04:57.417651 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m18:04:57.423208 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__orders"
[0m18:04:57.423208 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__orders: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__orders"} */
alter table "IDX-Stock"."warehouse"."stg_eltool__orders" rename to "stg_eltool__orders__dbt_backup"
[0m18:04:57.426786 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:04:57.431758 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__orders"
[0m18:04:57.432793 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__orders: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__orders"} */
alter table "IDX-Stock"."warehouse"."stg_eltool__orders__dbt_tmp" rename to "stg_eltool__orders"
[0m18:04:57.436008 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:04:57.439044 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__orders: COMMIT
[0m18:04:57.440050 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__orders"
[0m18:04:57.441325 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__orders: COMMIT
[0m18:04:57.446864 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m18:04:57.450873 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__orders"
[0m18:04:57.450873 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__orders: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__orders"} */
drop view if exists "IDX-Stock"."warehouse"."stg_eltool__orders__dbt_backup" cascade
[0m18:04:57.456450 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m18:04:57.458457 [debug] [Thread-1 (]: Timing info for model.dbt_idx.stg_eltool__orders (execute): 18:04:57.365986 => 18:04:57.458457
[0m18:04:57.459478 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__orders: Close
[0m18:04:57.462009 [info ] [Thread-1 (]: 2 of 6 OK created sql view model warehouse.stg_eltool__orders .................. [[32mCREATE VIEW[0m in 0.12s]
[0m18:04:57.463993 [debug] [Thread-1 (]: Finished running node model.dbt_idx.stg_eltool__orders
[0m18:04:57.465501 [debug] [Thread-1 (]: Began running node model.dbt_idx.stg_eltool__state
[0m18:04:57.467524 [info ] [Thread-1 (]: 3 of 6 START sql view model warehouse.stg_eltool__state ........................ [RUN]
[0m18:04:57.469523 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_idx.stg_eltool__orders, now model.dbt_idx.stg_eltool__state)
[0m18:04:57.470523 [debug] [Thread-1 (]: Began compiling node model.dbt_idx.stg_eltool__state
[0m18:04:57.473522 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_idx.stg_eltool__state"
[0m18:04:57.481962 [debug] [Thread-1 (]: Timing info for model.dbt_idx.stg_eltool__state (compile): 18:04:57.470523 => 18:04:57.480998
[0m18:04:57.482467 [debug] [Thread-1 (]: Began executing node model.dbt_idx.stg_eltool__state
[0m18:04:57.490005 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_idx.stg_eltool__state"
[0m18:04:57.498577 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__state"
[0m18:04:57.499593 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__state: BEGIN
[0m18:04:57.501103 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:04:57.526138 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m18:04:57.527114 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__state"
[0m18:04:57.528117 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__state: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__state"} */

  create view "IDX-Stock"."warehouse"."stg_eltool__state__dbt_tmp"
    
    
  as (
    with source as (select *
                from "IDX-Stock"."warehouse"."state"),
     renamed as (select state_identifier::INT AS state_id,
                         state_code::VARCHAR(2) AS state_code,
                         st_name::VARCHAR(30) AS state_name
                 from source)
select *
from renamed
  );
[0m18:04:57.533115 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m18:04:57.539631 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__state"
[0m18:04:57.540638 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__state: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__state"} */
alter table "IDX-Stock"."warehouse"."stg_eltool__state" rename to "stg_eltool__state__dbt_backup"
[0m18:04:57.543890 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:04:57.548082 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__state"
[0m18:04:57.549042 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__state: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__state"} */
alter table "IDX-Stock"."warehouse"."stg_eltool__state__dbt_tmp" rename to "stg_eltool__state"
[0m18:04:57.552044 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:04:57.555622 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__state: COMMIT
[0m18:04:57.556658 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__state"
[0m18:04:57.556658 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__state: COMMIT
[0m18:04:57.560848 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m18:04:57.565859 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__state"
[0m18:04:57.566851 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__state: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__state"} */
drop view if exists "IDX-Stock"."warehouse"."stg_eltool__state__dbt_backup" cascade
[0m18:04:57.572847 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m18:04:57.574854 [debug] [Thread-1 (]: Timing info for model.dbt_idx.stg_eltool__state (execute): 18:04:57.483480 => 18:04:57.574854
[0m18:04:57.576028 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__state: Close
[0m18:04:57.578988 [info ] [Thread-1 (]: 3 of 6 OK created sql view model warehouse.stg_eltool__state ................... [[32mCREATE VIEW[0m in 0.11s]
[0m18:04:57.581992 [debug] [Thread-1 (]: Finished running node model.dbt_idx.stg_eltool__state
[0m18:04:57.582510 [debug] [Thread-1 (]: Began running node model.dbt_idx.fact_orders
[0m18:04:57.583524 [info ] [Thread-1 (]: 4 of 6 START sql table model warehouse.fact_orders ............................. [RUN]
[0m18:04:57.586048 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_idx.stg_eltool__state, now model.dbt_idx.fact_orders)
[0m18:04:57.587058 [debug] [Thread-1 (]: Began compiling node model.dbt_idx.fact_orders
[0m18:04:57.593068 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_idx.fact_orders"
[0m18:04:57.597585 [debug] [Thread-1 (]: Timing info for model.dbt_idx.fact_orders (compile): 18:04:57.588069 => 18:04:57.597585
[0m18:04:57.598581 [debug] [Thread-1 (]: Began executing node model.dbt_idx.fact_orders
[0m18:04:57.638317 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_idx.fact_orders"
[0m18:04:57.643835 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.fact_orders"
[0m18:04:57.644826 [debug] [Thread-1 (]: On model.dbt_idx.fact_orders: BEGIN
[0m18:04:57.645385 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:04:57.671275 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m18:04:57.672302 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.fact_orders"
[0m18:04:57.673302 [debug] [Thread-1 (]: On model.dbt_idx.fact_orders: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.fact_orders"} */

  
    

  create  table "IDX-Stock"."warehouse"."fact_orders__dbt_tmp"
  
  
    as
  
  (
    with orders as (
    select *
    from "IDX-Stock"."warehouse"."stg_eltool__orders"
)
select * from orders
  );
  
[0m18:04:57.683356 [debug] [Thread-1 (]: SQL status: SELECT 999 in 0.0 seconds
[0m18:04:57.686927 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.fact_orders"
[0m18:04:57.687964 [debug] [Thread-1 (]: On model.dbt_idx.fact_orders: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.fact_orders"} */
alter table "IDX-Stock"."warehouse"."fact_orders__dbt_tmp" rename to "fact_orders"
[0m18:04:57.690927 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:04:57.698555 [debug] [Thread-1 (]: On model.dbt_idx.fact_orders: COMMIT
[0m18:04:57.699522 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.fact_orders"
[0m18:04:57.700523 [debug] [Thread-1 (]: On model.dbt_idx.fact_orders: COMMIT
[0m18:04:57.704672 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m18:04:57.711638 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.fact_orders"
[0m18:04:57.712596 [debug] [Thread-1 (]: On model.dbt_idx.fact_orders: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.fact_orders"} */
drop table if exists "IDX-Stock"."warehouse"."fact_orders__dbt_backup" cascade
[0m18:04:57.715717 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m18:04:57.718713 [debug] [Thread-1 (]: Timing info for model.dbt_idx.fact_orders (execute): 18:04:57.599580 => 18:04:57.717731
[0m18:04:57.718713 [debug] [Thread-1 (]: On model.dbt_idx.fact_orders: Close
[0m18:04:57.721715 [info ] [Thread-1 (]: 4 of 6 OK created sql table model warehouse.fact_orders ........................ [[32mSELECT 999[0m in 0.14s]
[0m18:04:57.723711 [debug] [Thread-1 (]: Finished running node model.dbt_idx.fact_orders
[0m18:04:57.725784 [debug] [Thread-1 (]: Began running node model.dbt_idx.dim_customers
[0m18:04:57.726781 [info ] [Thread-1 (]: 5 of 6 START sql table model warehouse.dim_customers ........................... [RUN]
[0m18:04:57.728787 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_idx.fact_orders, now model.dbt_idx.dim_customers)
[0m18:04:57.729814 [debug] [Thread-1 (]: Began compiling node model.dbt_idx.dim_customers
[0m18:04:57.734782 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_idx.dim_customers"
[0m18:04:57.744532 [debug] [Thread-1 (]: Timing info for model.dbt_idx.dim_customers (compile): 18:04:57.730816 => 18:04:57.744532
[0m18:04:57.746706 [debug] [Thread-1 (]: Began executing node model.dbt_idx.dim_customers
[0m18:04:57.754711 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_idx.dim_customers"
[0m18:04:57.764942 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.dim_customers"
[0m18:04:57.765450 [debug] [Thread-1 (]: On model.dbt_idx.dim_customers: BEGIN
[0m18:04:57.767466 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:04:57.794686 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m18:04:57.795928 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.dim_customers"
[0m18:04:57.796939 [debug] [Thread-1 (]: On model.dbt_idx.dim_customers: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.dim_customers"} */

  
    

  create  table "IDX-Stock"."warehouse"."dim_customers__dbt_tmp"
  
  
    as
  
  (
    -- noinspection SqlDialectInspectionForFile

with customers as (
    select *
    from "IDX-Stock"."warehouse"."stg_eltool__customers"
    ),
     state as (
         select *
         from "IDX-Stock"."warehouse"."stg_eltool__state"
     )
select c.customer_id,
       c.zipcode,
       c.city,
       c.state_code,
       s.state_name,
       c.datetime_created,
       c.datetime_updated,
       c.dbt_valid_from::TIMESTAMP as valid_from,
        CASE WHEN c.dbt_valid_to IS NULL
            THEN '9999-12-31'::TIMESTAMP
            ELSE c.dbt_valid_to::TIMESTAMP
        END as valid_to
from customers c
    join state s on c.state_code = s.state_code
  );
  
[0m18:04:57.804881 [debug] [Thread-1 (]: SQL status: SELECT 105 in 0.0 seconds
[0m18:04:57.808891 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.dim_customers"
[0m18:04:57.809889 [debug] [Thread-1 (]: On model.dbt_idx.dim_customers: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.dim_customers"} */
alter table "IDX-Stock"."warehouse"."dim_customers" rename to "dim_customers__dbt_backup"
[0m18:04:57.812889 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:04:57.817468 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.dim_customers"
[0m18:04:57.817994 [debug] [Thread-1 (]: On model.dbt_idx.dim_customers: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.dim_customers"} */
alter table "IDX-Stock"."warehouse"."dim_customers__dbt_tmp" rename to "dim_customers"
[0m18:04:57.822005 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:04:57.826650 [debug] [Thread-1 (]: On model.dbt_idx.dim_customers: COMMIT
[0m18:04:57.827605 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.dim_customers"
[0m18:04:57.828611 [debug] [Thread-1 (]: On model.dbt_idx.dim_customers: COMMIT
[0m18:04:57.833598 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m18:04:57.838452 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.dim_customers"
[0m18:04:57.839522 [debug] [Thread-1 (]: On model.dbt_idx.dim_customers: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.dim_customers"} */
drop table if exists "IDX-Stock"."warehouse"."dim_customers__dbt_backup" cascade
[0m18:04:57.845993 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m18:04:57.847994 [debug] [Thread-1 (]: Timing info for model.dbt_idx.dim_customers (execute): 18:04:57.746706 => 18:04:57.847994
[0m18:04:57.848995 [debug] [Thread-1 (]: On model.dbt_idx.dim_customers: Close
[0m18:04:57.851996 [info ] [Thread-1 (]: 5 of 6 OK created sql table model warehouse.dim_customers ...................... [[32mSELECT 105[0m in 0.12s]
[0m18:04:57.853000 [debug] [Thread-1 (]: Finished running node model.dbt_idx.dim_customers
[0m18:04:57.856080 [debug] [Thread-1 (]: Began running node model.dbt_idx.customer_orders_status
[0m18:04:57.857105 [info ] [Thread-1 (]: 6 of 6 START sql view model warehouse.customer_orders_status ................... [RUN]
[0m18:04:57.859532 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_idx.dim_customers, now model.dbt_idx.customer_orders_status)
[0m18:04:57.860536 [debug] [Thread-1 (]: Began compiling node model.dbt_idx.customer_orders_status
[0m18:04:57.866061 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_idx.customer_orders_status"
[0m18:04:57.874657 [debug] [Thread-1 (]: Timing info for model.dbt_idx.customer_orders_status (compile): 18:04:57.861541 => 18:04:57.874657
[0m18:04:57.875625 [debug] [Thread-1 (]: Began executing node model.dbt_idx.customer_orders_status
[0m18:04:57.886422 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_idx.customer_orders_status"
[0m18:04:57.896042 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.customer_orders_status"
[0m18:04:57.897228 [debug] [Thread-1 (]: On model.dbt_idx.customer_orders_status: BEGIN
[0m18:04:57.897740 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:04:57.920902 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m18:04:57.921894 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.customer_orders_status"
[0m18:04:57.921894 [debug] [Thread-1 (]: On model.dbt_idx.customer_orders_status: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.customer_orders_status"} */

  create view "IDX-Stock"."warehouse"."customer_orders_status__dbt_tmp"
    
    
  as (
    with orders as (select *
                from "IDX-Stock"."warehouse"."fact_orders"),
     customers as (select *
                   from "IDX-Stock"."warehouse"."dim_customers")
select o.order_id,
       o.customer_id,
       o.order_status,
       o.order_purchase_timestamp,
       o.order_approved_at,
       o.order_delivered_carrier_date,
       o.order_delivered_customer_date,
       o.order_estimated_delivery_date,
       c.zipcode    as customer_zipcode,
       c.city       as customer_city,
       c.state_code as customer_state_code,
       c.state_name as customer_state_name
from orders o
    join customers c on o.customer_id = c.customer_id
    and o.order_purchase_timestamp >= c.valid_from
    and o.order_purchase_timestamp <= c.valid_to
  );
[0m18:04:57.927032 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m18:04:57.931076 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.customer_orders_status"
[0m18:04:57.932032 [debug] [Thread-1 (]: On model.dbt_idx.customer_orders_status: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.customer_orders_status"} */
alter table "IDX-Stock"."warehouse"."customer_orders_status__dbt_tmp" rename to "customer_orders_status"
[0m18:04:57.934579 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:04:57.936622 [debug] [Thread-1 (]: On model.dbt_idx.customer_orders_status: COMMIT
[0m18:04:57.937621 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.customer_orders_status"
[0m18:04:57.938588 [debug] [Thread-1 (]: On model.dbt_idx.customer_orders_status: COMMIT
[0m18:04:57.942585 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m18:04:57.946187 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.customer_orders_status"
[0m18:04:57.947164 [debug] [Thread-1 (]: On model.dbt_idx.customer_orders_status: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.customer_orders_status"} */
drop view if exists "IDX-Stock"."warehouse"."customer_orders_status__dbt_backup" cascade
[0m18:04:57.949160 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m18:04:57.951209 [debug] [Thread-1 (]: Timing info for model.dbt_idx.customer_orders_status (execute): 18:04:57.877589 => 18:04:57.951209
[0m18:04:57.952194 [debug] [Thread-1 (]: On model.dbt_idx.customer_orders_status: Close
[0m18:04:57.953172 [info ] [Thread-1 (]: 6 of 6 OK created sql view model warehouse.customer_orders_status .............. [[32mCREATE VIEW[0m in 0.09s]
[0m18:04:57.955687 [debug] [Thread-1 (]: Finished running node model.dbt_idx.customer_orders_status
[0m18:04:57.958353 [debug] [MainThread]: Using postgres connection "master"
[0m18:04:57.959349 [debug] [MainThread]: On master: BEGIN
[0m18:04:57.960348 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:04:57.983431 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m18:04:57.985087 [debug] [MainThread]: On master: COMMIT
[0m18:04:57.985966 [debug] [MainThread]: Using postgres connection "master"
[0m18:04:57.987014 [debug] [MainThread]: On master: COMMIT
[0m18:04:57.988984 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m18:04:57.990000 [debug] [MainThread]: On master: Close
[0m18:04:57.991968 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:04:57.993001 [debug] [MainThread]: Connection 'list_IDX-Stock' was properly closed.
[0m18:04:57.994554 [debug] [MainThread]: Connection 'list_IDX-Stock_snapshots' was properly closed.
[0m18:04:57.995585 [debug] [MainThread]: Connection 'model.dbt_idx.customer_orders_status' was properly closed.
[0m18:04:57.996583 [info ] [MainThread]: 
[0m18:04:57.997563 [info ] [MainThread]: Finished running 4 view models, 2 table models in 0 hours 0 minutes and 1.11 seconds (1.11s).
[0m18:04:58.000596 [debug] [MainThread]: Command end result
[0m18:04:58.029106 [info ] [MainThread]: 
[0m18:04:58.030133 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:04:58.031140 [info ] [MainThread]: 
[0m18:04:58.032106 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 TOTAL=6
[0m18:04:58.034610 [debug] [MainThread]: Command `dbt run` succeeded at 18:04:58.034610 after 1.77 seconds
[0m18:04:58.035620 [debug] [MainThread]: Flushing usage events


============================== 18:10:58.042689 | de7b4f15-2ae7-4644-8e43-75ec25156bf6 ==============================
[0m18:10:58.042689 [info ] [MainThread]: Running with dbt=1.6.1
[0m18:10:58.049132 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'D:\\00 Project\\00 My Project\\IdeaProjects\\Py-DBT-IDX\\logs', 'version_check': 'True', 'profiles_dir': 'D:\\00 Project\\00 My Project\\IdeaProjects\\Py-DBT-IDX', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'False'}
[0m18:10:58.176565 [info ] [MainThread]: Registered adapter: postgres=1.6.1
[0m18:10:58.188656 [debug] [MainThread]: checksum: efe19d9f5b93d1a98cc804fbfcdb6b3aced98b974af664946fee1cde8837deb7, vars: {}, profile: , target: , version: 1.6.1
[0m18:10:58.341373 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 3 files changed.
[0m18:10:58.342398 [debug] [MainThread]: Partial parsing: added file: dbt_idx://models\staging\stg_eltool__customers_snapshots.sql
[0m18:10:58.343400 [debug] [MainThread]: Partial parsing: updated file: dbt_idx://models\staging\stg_eltool.yml
[0m18:10:58.344646 [debug] [MainThread]: Partial parsing: updated file: dbt_idx://models\marts\core\dim_customers.sql
[0m18:10:58.345629 [debug] [MainThread]: Partial parsing: updated file: dbt_idx://models\staging\stg_eltool__customers.sql
[0m18:10:58.460698 [info ] [MainThread]: Found 1 snapshot, 9 tests, 7 models, 3 sources, 0 exposures, 0 metrics, 349 macros, 0 groups, 0 semantic models
[0m18:10:58.463348 [info ] [MainThread]: 
[0m18:10:58.464802 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m18:10:58.467795 [debug] [ThreadPool]: Acquiring new postgres connection 'list_IDX-Stock'
[0m18:10:58.478342 [debug] [ThreadPool]: Using postgres connection "list_IDX-Stock"
[0m18:10:58.478342 [debug] [ThreadPool]: On list_IDX-Stock: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "connection_name": "list_IDX-Stock"} */

    select distinct nspname from pg_namespace
  
[0m18:10:58.479381 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:10:58.512233 [debug] [ThreadPool]: SQL status: SELECT 13 in 0.0 seconds
[0m18:10:58.513868 [debug] [ThreadPool]: On list_IDX-Stock: Close
[0m18:10:58.517756 [debug] [ThreadPool]: Acquiring new postgres connection 'list_IDX-Stock_warehouse'
[0m18:10:58.525372 [debug] [ThreadPool]: Using postgres connection "list_IDX-Stock_warehouse"
[0m18:10:58.525372 [debug] [ThreadPool]: On list_IDX-Stock_warehouse: BEGIN
[0m18:10:58.526376 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:10:58.549109 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m18:10:58.550093 [debug] [ThreadPool]: Using postgres connection "list_IDX-Stock_warehouse"
[0m18:10:58.551059 [debug] [ThreadPool]: On list_IDX-Stock_warehouse: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "connection_name": "list_IDX-Stock_warehouse"} */
select
      'IDX-Stock' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'warehouse'
    union all
    select
      'IDX-Stock' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'warehouse'
    union all
    select
      'IDX-Stock' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'warehouse'
  
[0m18:10:58.555652 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.0 seconds
[0m18:10:58.557630 [debug] [ThreadPool]: On list_IDX-Stock_warehouse: ROLLBACK
[0m18:10:58.559634 [debug] [ThreadPool]: On list_IDX-Stock_warehouse: Close
[0m18:10:58.562657 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_IDX-Stock_warehouse, now list_IDX-Stock_snapshots)
[0m18:10:58.568169 [debug] [ThreadPool]: Using postgres connection "list_IDX-Stock_snapshots"
[0m18:10:58.569174 [debug] [ThreadPool]: On list_IDX-Stock_snapshots: BEGIN
[0m18:10:58.570180 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:10:58.590883 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m18:10:58.591881 [debug] [ThreadPool]: Using postgres connection "list_IDX-Stock_snapshots"
[0m18:10:58.591881 [debug] [ThreadPool]: On list_IDX-Stock_snapshots: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "connection_name": "list_IDX-Stock_snapshots"} */
select
      'IDX-Stock' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'snapshots'
    union all
    select
      'IDX-Stock' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'snapshots'
    union all
    select
      'IDX-Stock' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'snapshots'
  
[0m18:10:58.596434 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.0 seconds
[0m18:10:58.598401 [debug] [ThreadPool]: On list_IDX-Stock_snapshots: ROLLBACK
[0m18:10:58.601159 [debug] [ThreadPool]: On list_IDX-Stock_snapshots: Close
[0m18:10:58.607692 [debug] [MainThread]: Using postgres connection "master"
[0m18:10:58.608692 [debug] [MainThread]: On master: BEGIN
[0m18:10:58.609693 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:10:58.630485 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m18:10:58.631473 [debug] [MainThread]: Using postgres connection "master"
[0m18:10:58.631473 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m18:10:58.638515 [debug] [MainThread]: SQL status: SELECT 5 in 0.0 seconds
[0m18:10:58.641569 [debug] [MainThread]: On master: ROLLBACK
[0m18:10:58.643519 [debug] [MainThread]: Using postgres connection "master"
[0m18:10:58.644871 [debug] [MainThread]: On master: BEGIN
[0m18:10:58.649822 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m18:10:58.649822 [debug] [MainThread]: On master: COMMIT
[0m18:10:58.650817 [debug] [MainThread]: Using postgres connection "master"
[0m18:10:58.651837 [debug] [MainThread]: On master: COMMIT
[0m18:10:58.654354 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m18:10:58.655395 [debug] [MainThread]: On master: Close
[0m18:10:58.656352 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:10:58.658370 [info ] [MainThread]: 
[0m18:10:58.663353 [debug] [Thread-1 (]: Began running node model.dbt_idx.stg_eltool__customers
[0m18:10:58.663893 [info ] [Thread-1 (]: 1 of 7 START sql view model warehouse.stg_eltool__customers .................... [RUN]
[0m18:10:58.664921 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.dbt_idx.stg_eltool__customers'
[0m18:10:58.665927 [debug] [Thread-1 (]: Began compiling node model.dbt_idx.stg_eltool__customers
[0m18:10:58.674487 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_idx.stg_eltool__customers"
[0m18:10:58.687632 [debug] [Thread-1 (]: Timing info for model.dbt_idx.stg_eltool__customers (compile): 18:10:58.666899 => 18:10:58.687632
[0m18:10:58.688631 [debug] [Thread-1 (]: Began executing node model.dbt_idx.stg_eltool__customers
[0m18:10:58.727002 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_idx.stg_eltool__customers"
[0m18:10:58.733581 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__customers"
[0m18:10:58.733581 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__customers: BEGIN
[0m18:10:58.734524 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m18:10:58.756699 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m18:10:58.757723 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__customers"
[0m18:10:58.758717 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__customers: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__customers"} */

  create view "IDX-Stock"."warehouse"."stg_eltool__customers__dbt_tmp"
    
    
  as (
    with source as (select *
                from "IDX-Stock"."warehouse"."customers"),
     renamed as (select customer_id,
                        'This is Dummy' as dummy
                 from source)
select *
from renamed
  );
[0m18:10:58.763706 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m18:10:58.770033 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__customers"
[0m18:10:58.771032 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__customers: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__customers"} */
alter table "IDX-Stock"."warehouse"."stg_eltool__customers" rename to "stg_eltool__customers__dbt_backup"
[0m18:10:58.773672 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:10:58.777724 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__customers"
[0m18:10:58.777724 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__customers: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__customers"} */
alter table "IDX-Stock"."warehouse"."stg_eltool__customers__dbt_tmp" rename to "stg_eltool__customers"
[0m18:10:58.780688 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:10:58.797728 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__customers: COMMIT
[0m18:10:58.798729 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__customers"
[0m18:10:58.798729 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__customers: COMMIT
[0m18:10:58.802403 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m18:10:58.810915 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__customers"
[0m18:10:58.811915 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__customers: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__customers"} */
drop view if exists "IDX-Stock"."warehouse"."stg_eltool__customers__dbt_backup" cascade
[0m18:10:58.817447 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m18:10:58.819484 [debug] [Thread-1 (]: Timing info for model.dbt_idx.stg_eltool__customers (execute): 18:10:58.689631 => 18:10:58.818482
[0m18:10:58.820457 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__customers: Close
[0m18:10:58.822451 [info ] [Thread-1 (]: 1 of 7 OK created sql view model warehouse.stg_eltool__customers ............... [[32mCREATE VIEW[0m in 0.16s]
[0m18:10:58.824000 [debug] [Thread-1 (]: Finished running node model.dbt_idx.stg_eltool__customers
[0m18:10:58.825014 [debug] [Thread-1 (]: Began running node model.dbt_idx.stg_eltool__customers_snapshots
[0m18:10:58.826011 [info ] [Thread-1 (]: 2 of 7 START sql view model warehouse.stg_eltool__customers_snapshots .......... [RUN]
[0m18:10:58.828012 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_idx.stg_eltool__customers, now model.dbt_idx.stg_eltool__customers_snapshots)
[0m18:10:58.829010 [debug] [Thread-1 (]: Began compiling node model.dbt_idx.stg_eltool__customers_snapshots
[0m18:10:58.832011 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_idx.stg_eltool__customers_snapshots"
[0m18:10:58.837537 [debug] [Thread-1 (]: Timing info for model.dbt_idx.stg_eltool__customers_snapshots (compile): 18:10:58.830011 => 18:10:58.836535
[0m18:10:58.838536 [debug] [Thread-1 (]: Began executing node model.dbt_idx.stg_eltool__customers_snapshots
[0m18:10:58.846685 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_idx.stg_eltool__customers_snapshots"
[0m18:10:58.853680 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__customers_snapshots"
[0m18:10:58.854749 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__customers_snapshots: BEGIN
[0m18:10:58.855743 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:10:58.878131 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m18:10:58.879126 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__customers_snapshots"
[0m18:10:58.880127 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__customers_snapshots: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__customers_snapshots"} */

  create view "IDX-Stock"."warehouse"."stg_eltool__customers_snapshots__dbt_tmp"
    
    
  as (
    with source as (select *
                from "IDX-Stock"."snapshots"."customers_snapshot"),
     renamed as (select customer_id,
                        zipcode,
                        city,
                        state_code,
                        datetime_created::TIMESTAMP AS datetime_created,
                        datetime_updated::TIMESTAMP AS datetime_updated,
                        dbt_valid_from,
                        dbt_valid_to
                 from source)
select *
from renamed
  );
[0m18:10:58.883822 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m18:10:58.887729 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__customers_snapshots"
[0m18:10:58.888729 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__customers_snapshots: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__customers_snapshots"} */
alter table "IDX-Stock"."warehouse"."stg_eltool__customers_snapshots__dbt_tmp" rename to "stg_eltool__customers_snapshots"
[0m18:10:58.891730 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:10:58.894301 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__customers_snapshots: COMMIT
[0m18:10:58.895308 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__customers_snapshots"
[0m18:10:58.895308 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__customers_snapshots: COMMIT
[0m18:10:58.899196 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m18:10:58.902223 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__customers_snapshots"
[0m18:10:58.902223 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__customers_snapshots: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__customers_snapshots"} */
drop view if exists "IDX-Stock"."warehouse"."stg_eltool__customers_snapshots__dbt_backup" cascade
[0m18:10:58.905771 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m18:10:58.907808 [debug] [Thread-1 (]: Timing info for model.dbt_idx.stg_eltool__customers_snapshots (execute): 18:10:58.838536 => 18:10:58.906807
[0m18:10:58.907808 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__customers_snapshots: Close
[0m18:10:58.909785 [info ] [Thread-1 (]: 2 of 7 OK created sql view model warehouse.stg_eltool__customers_snapshots ..... [[32mCREATE VIEW[0m in 0.08s]
[0m18:10:58.911805 [debug] [Thread-1 (]: Finished running node model.dbt_idx.stg_eltool__customers_snapshots
[0m18:10:58.913313 [debug] [Thread-1 (]: Began running node model.dbt_idx.stg_eltool__orders
[0m18:10:58.914349 [info ] [Thread-1 (]: 3 of 7 START sql view model warehouse.stg_eltool__orders ....................... [RUN]
[0m18:10:58.915321 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_idx.stg_eltool__customers_snapshots, now model.dbt_idx.stg_eltool__orders)
[0m18:10:58.916321 [debug] [Thread-1 (]: Began compiling node model.dbt_idx.stg_eltool__orders
[0m18:10:58.920321 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_idx.stg_eltool__orders"
[0m18:10:58.933445 [debug] [Thread-1 (]: Timing info for model.dbt_idx.stg_eltool__orders (compile): 18:10:58.917321 => 18:10:58.932442
[0m18:10:58.933988 [debug] [Thread-1 (]: Began executing node model.dbt_idx.stg_eltool__orders
[0m18:10:58.940029 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_idx.stg_eltool__orders"
[0m18:10:58.951005 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__orders"
[0m18:10:58.952016 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__orders: BEGIN
[0m18:10:58.952016 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:10:58.972036 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m18:10:58.973613 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__orders"
[0m18:10:58.974558 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__orders: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__orders"} */

  create view "IDX-Stock"."warehouse"."stg_eltool__orders__dbt_tmp"
    
    
  as (
    with source as (select *
                from "IDX-Stock"."warehouse"."orders"),
     renamed as (select order_id,
                        cust_id AS customer_id,
                        order_status,
                        order_purchase_timestamp::TIMESTAMP,
                        order_approved_at::TIMESTAMP,
                        order_delivered_carrier_date::TIMESTAMP,
                        order_delivered_customer_date::TIMESTAMP,
                        order_estimated_delivery_date::TIMESTAMP
                 from source)
select *
from renamed
  );
[0m18:10:58.978564 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m18:10:58.981564 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__orders"
[0m18:10:58.982570 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__orders: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__orders"} */
alter table "IDX-Stock"."warehouse"."stg_eltool__orders" rename to "stg_eltool__orders__dbt_backup"
[0m18:10:58.984820 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:10:58.988853 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__orders"
[0m18:10:58.989880 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__orders: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__orders"} */
alter table "IDX-Stock"."warehouse"."stg_eltool__orders__dbt_tmp" rename to "stg_eltool__orders"
[0m18:10:58.991851 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:10:58.994954 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__orders: COMMIT
[0m18:10:58.995981 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__orders"
[0m18:10:58.996960 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__orders: COMMIT
[0m18:10:59.000971 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m18:10:59.004553 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__orders"
[0m18:10:59.005518 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__orders: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__orders"} */
drop view if exists "IDX-Stock"."warehouse"."stg_eltool__orders__dbt_backup" cascade
[0m18:10:59.009516 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m18:10:59.011518 [debug] [Thread-1 (]: Timing info for model.dbt_idx.stg_eltool__orders (execute): 18:10:58.935030 => 18:10:59.010518
[0m18:10:59.011518 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__orders: Close
[0m18:10:59.014027 [info ] [Thread-1 (]: 3 of 7 OK created sql view model warehouse.stg_eltool__orders .................. [[32mCREATE VIEW[0m in 0.10s]
[0m18:10:59.016051 [debug] [Thread-1 (]: Finished running node model.dbt_idx.stg_eltool__orders
[0m18:10:59.017040 [debug] [Thread-1 (]: Began running node model.dbt_idx.stg_eltool__state
[0m18:10:59.018041 [info ] [Thread-1 (]: 4 of 7 START sql view model warehouse.stg_eltool__state ........................ [RUN]
[0m18:10:59.019032 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_idx.stg_eltool__orders, now model.dbt_idx.stg_eltool__state)
[0m18:10:59.020035 [debug] [Thread-1 (]: Began compiling node model.dbt_idx.stg_eltool__state
[0m18:10:59.024547 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_idx.stg_eltool__state"
[0m18:10:59.032553 [debug] [Thread-1 (]: Timing info for model.dbt_idx.stg_eltool__state (compile): 18:10:59.021038 => 18:10:59.031591
[0m18:10:59.032553 [debug] [Thread-1 (]: Began executing node model.dbt_idx.stg_eltool__state
[0m18:10:59.039096 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_idx.stg_eltool__state"
[0m18:10:59.045982 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__state"
[0m18:10:59.045982 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__state: BEGIN
[0m18:10:59.046981 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:10:59.071055 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m18:10:59.072054 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__state"
[0m18:10:59.072054 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__state: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__state"} */

  create view "IDX-Stock"."warehouse"."stg_eltool__state__dbt_tmp"
    
    
  as (
    with source as (select *
                from "IDX-Stock"."warehouse"."state"),
     renamed as (select state_identifier::INT AS state_id,
                         state_code::VARCHAR(2) AS state_code,
                         st_name::VARCHAR(30) AS state_name
                 from source)
select *
from renamed
  );
[0m18:10:59.076588 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m18:10:59.081588 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__state"
[0m18:10:59.082599 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__state: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__state"} */
alter table "IDX-Stock"."warehouse"."stg_eltool__state" rename to "stg_eltool__state__dbt_backup"
[0m18:10:59.084888 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:10:59.090880 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__state"
[0m18:10:59.091881 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__state: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__state"} */
alter table "IDX-Stock"."warehouse"."stg_eltool__state__dbt_tmp" rename to "stg_eltool__state"
[0m18:10:59.095014 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:10:59.097013 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__state: COMMIT
[0m18:10:59.098015 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__state"
[0m18:10:59.099014 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__state: COMMIT
[0m18:10:59.101874 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m18:10:59.105423 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__state"
[0m18:10:59.106408 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__state: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__state"} */
drop view if exists "IDX-Stock"."warehouse"."stg_eltool__state__dbt_backup" cascade
[0m18:10:59.110270 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m18:10:59.112308 [debug] [Thread-1 (]: Timing info for model.dbt_idx.stg_eltool__state (execute): 18:10:59.034059 => 18:10:59.112308
[0m18:10:59.113274 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__state: Close
[0m18:10:59.115401 [info ] [Thread-1 (]: 4 of 7 OK created sql view model warehouse.stg_eltool__state ................... [[32mCREATE VIEW[0m in 0.10s]
[0m18:10:59.117404 [debug] [Thread-1 (]: Finished running node model.dbt_idx.stg_eltool__state
[0m18:10:59.119398 [debug] [Thread-1 (]: Began running node model.dbt_idx.fact_orders
[0m18:10:59.120398 [info ] [Thread-1 (]: 5 of 7 START sql table model warehouse.fact_orders ............................. [RUN]
[0m18:10:59.121402 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_idx.stg_eltool__state, now model.dbt_idx.fact_orders)
[0m18:10:59.122399 [debug] [Thread-1 (]: Began compiling node model.dbt_idx.fact_orders
[0m18:10:59.125921 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_idx.fact_orders"
[0m18:10:59.131922 [debug] [Thread-1 (]: Timing info for model.dbt_idx.fact_orders (compile): 18:10:59.123403 => 18:10:59.131922
[0m18:10:59.133517 [debug] [Thread-1 (]: Began executing node model.dbt_idx.fact_orders
[0m18:10:59.162005 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_idx.fact_orders"
[0m18:10:59.169546 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.fact_orders"
[0m18:10:59.170526 [debug] [Thread-1 (]: On model.dbt_idx.fact_orders: BEGIN
[0m18:10:59.171525 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:10:59.195091 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m18:10:59.195091 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.fact_orders"
[0m18:10:59.196126 [debug] [Thread-1 (]: On model.dbt_idx.fact_orders: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.fact_orders"} */

  
    

  create  table "IDX-Stock"."warehouse"."fact_orders__dbt_tmp"
  
  
    as
  
  (
    with orders as (
    select *
    from "IDX-Stock"."warehouse"."stg_eltool__orders"
)
select * from orders
  );
  
[0m18:10:59.203610 [debug] [Thread-1 (]: SQL status: SELECT 999 in 0.0 seconds
[0m18:10:59.207649 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.fact_orders"
[0m18:10:59.208656 [debug] [Thread-1 (]: On model.dbt_idx.fact_orders: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.fact_orders"} */
alter table "IDX-Stock"."warehouse"."fact_orders" rename to "fact_orders__dbt_backup"
[0m18:10:59.211620 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:10:59.215201 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.fact_orders"
[0m18:10:59.216166 [debug] [Thread-1 (]: On model.dbt_idx.fact_orders: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.fact_orders"} */
alter table "IDX-Stock"."warehouse"."fact_orders__dbt_tmp" rename to "fact_orders"
[0m18:10:59.218181 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:10:59.223822 [debug] [Thread-1 (]: On model.dbt_idx.fact_orders: COMMIT
[0m18:10:59.224783 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.fact_orders"
[0m18:10:59.225750 [debug] [Thread-1 (]: On model.dbt_idx.fact_orders: COMMIT
[0m18:10:59.230155 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m18:10:59.235749 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.fact_orders"
[0m18:10:59.235749 [debug] [Thread-1 (]: On model.dbt_idx.fact_orders: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.fact_orders"} */
drop table if exists "IDX-Stock"."warehouse"."fact_orders__dbt_backup" cascade
[0m18:10:59.240745 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m18:10:59.243304 [debug] [Thread-1 (]: Timing info for model.dbt_idx.fact_orders (execute): 18:10:59.134438 => 18:10:59.243304
[0m18:10:59.243304 [debug] [Thread-1 (]: On model.dbt_idx.fact_orders: Close
[0m18:10:59.245335 [info ] [Thread-1 (]: 5 of 7 OK created sql table model warehouse.fact_orders ........................ [[32mSELECT 999[0m in 0.12s]
[0m18:10:59.248314 [debug] [Thread-1 (]: Finished running node model.dbt_idx.fact_orders
[0m18:10:59.249311 [debug] [Thread-1 (]: Began running node model.dbt_idx.dim_customers
[0m18:10:59.250311 [info ] [Thread-1 (]: 6 of 7 START sql table model warehouse.dim_customers ........................... [RUN]
[0m18:10:59.251313 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_idx.fact_orders, now model.dbt_idx.dim_customers)
[0m18:10:59.252313 [debug] [Thread-1 (]: Began compiling node model.dbt_idx.dim_customers
[0m18:10:59.255914 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_idx.dim_customers"
[0m18:10:59.261325 [debug] [Thread-1 (]: Timing info for model.dbt_idx.dim_customers (compile): 18:10:59.253327 => 18:10:59.261325
[0m18:10:59.262329 [debug] [Thread-1 (]: Began executing node model.dbt_idx.dim_customers
[0m18:10:59.268852 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_idx.dim_customers"
[0m18:10:59.275491 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.dim_customers"
[0m18:10:59.276484 [debug] [Thread-1 (]: On model.dbt_idx.dim_customers: BEGIN
[0m18:10:59.277491 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:10:59.301714 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m18:10:59.302714 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.dim_customers"
[0m18:10:59.303725 [debug] [Thread-1 (]: On model.dbt_idx.dim_customers: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.dim_customers"} */

  
    

  create  table "IDX-Stock"."warehouse"."dim_customers__dbt_tmp"
  
  
    as
  
  (
    -- noinspection SqlDialectInspectionForFile

with customers as (
    select *
    from "IDX-Stock"."warehouse"."stg_eltool__customers_snapshots"
    ),
     state as (
         select *
         from "IDX-Stock"."warehouse"."stg_eltool__state"
     )
select c.customer_id,
       c.zipcode,
       c.city,
       c.state_code,
       s.state_name,
       c.datetime_created,
       c.datetime_updated,
       c.dbt_valid_from::TIMESTAMP as valid_from,
        CASE WHEN c.dbt_valid_to IS NULL
            THEN '9999-12-31'::TIMESTAMP
            ELSE c.dbt_valid_to::TIMESTAMP
        END as valid_to
from customers c
    join state s on c.state_code = s.state_code
  );
  
[0m18:10:59.309079 [debug] [Thread-1 (]: SQL status: SELECT 105 in 0.0 seconds
[0m18:10:59.313599 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.dim_customers"
[0m18:10:59.314615 [debug] [Thread-1 (]: On model.dbt_idx.dim_customers: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.dim_customers"} */
alter table "IDX-Stock"."warehouse"."dim_customers" rename to "dim_customers__dbt_backup"
[0m18:10:59.317622 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:10:59.323645 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.dim_customers"
[0m18:10:59.324188 [debug] [Thread-1 (]: On model.dbt_idx.dim_customers: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.dim_customers"} */
alter table "IDX-Stock"."warehouse"."dim_customers__dbt_tmp" rename to "dim_customers"
[0m18:10:59.327196 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:10:59.329195 [debug] [Thread-1 (]: On model.dbt_idx.dim_customers: COMMIT
[0m18:10:59.330230 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.dim_customers"
[0m18:10:59.331231 [debug] [Thread-1 (]: On model.dbt_idx.dim_customers: COMMIT
[0m18:10:59.334734 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m18:10:59.339747 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.dim_customers"
[0m18:10:59.339747 [debug] [Thread-1 (]: On model.dbt_idx.dim_customers: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.dim_customers"} */
drop table if exists "IDX-Stock"."warehouse"."dim_customers__dbt_backup" cascade
[0m18:10:59.344870 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m18:10:59.347872 [debug] [Thread-1 (]: Timing info for model.dbt_idx.dim_customers (execute): 18:10:59.263329 => 18:10:59.346888
[0m18:10:59.348874 [debug] [Thread-1 (]: On model.dbt_idx.dim_customers: Close
[0m18:10:59.351873 [info ] [Thread-1 (]: 6 of 7 OK created sql table model warehouse.dim_customers ...................... [[32mSELECT 105[0m in 0.10s]
[0m18:10:59.355408 [debug] [Thread-1 (]: Finished running node model.dbt_idx.dim_customers
[0m18:10:59.357402 [debug] [Thread-1 (]: Began running node model.dbt_idx.customer_orders_status
[0m18:10:59.359399 [info ] [Thread-1 (]: 7 of 7 START sql view model warehouse.customer_orders_status ................... [RUN]
[0m18:10:59.360416 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_idx.dim_customers, now model.dbt_idx.customer_orders_status)
[0m18:10:59.361464 [debug] [Thread-1 (]: Began compiling node model.dbt_idx.customer_orders_status
[0m18:10:59.364986 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_idx.customer_orders_status"
[0m18:10:59.371999 [debug] [Thread-1 (]: Timing info for model.dbt_idx.customer_orders_status (compile): 18:10:59.361464 => 18:10:59.371999
[0m18:10:59.374551 [debug] [Thread-1 (]: Began executing node model.dbt_idx.customer_orders_status
[0m18:10:59.384647 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_idx.customer_orders_status"
[0m18:10:59.393588 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.customer_orders_status"
[0m18:10:59.394213 [debug] [Thread-1 (]: On model.dbt_idx.customer_orders_status: BEGIN
[0m18:10:59.395205 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:10:59.416948 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m18:10:59.417949 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.customer_orders_status"
[0m18:10:59.418949 [debug] [Thread-1 (]: On model.dbt_idx.customer_orders_status: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.customer_orders_status"} */

  create view "IDX-Stock"."warehouse"."customer_orders_status__dbt_tmp"
    
    
  as (
    with orders as (select *
                from "IDX-Stock"."warehouse"."fact_orders"),
     customers as (select *
                   from "IDX-Stock"."warehouse"."dim_customers")
select o.order_id,
       o.customer_id,
       o.order_status,
       o.order_purchase_timestamp,
       o.order_approved_at,
       o.order_delivered_carrier_date,
       o.order_delivered_customer_date,
       o.order_estimated_delivery_date,
       c.zipcode    as customer_zipcode,
       c.city       as customer_city,
       c.state_code as customer_state_code,
       c.state_name as customer_state_name
from orders o
    join customers c on o.customer_id = c.customer_id
    and o.order_purchase_timestamp >= c.valid_from
    and o.order_purchase_timestamp <= c.valid_to
  );
[0m18:10:59.421983 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m18:10:59.426570 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.customer_orders_status"
[0m18:10:59.426570 [debug] [Thread-1 (]: On model.dbt_idx.customer_orders_status: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.customer_orders_status"} */
alter table "IDX-Stock"."warehouse"."customer_orders_status__dbt_tmp" rename to "customer_orders_status"
[0m18:10:59.429324 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:10:59.431362 [debug] [Thread-1 (]: On model.dbt_idx.customer_orders_status: COMMIT
[0m18:10:59.432360 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.customer_orders_status"
[0m18:10:59.433344 [debug] [Thread-1 (]: On model.dbt_idx.customer_orders_status: COMMIT
[0m18:10:59.437531 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m18:10:59.440569 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.customer_orders_status"
[0m18:10:59.441532 [debug] [Thread-1 (]: On model.dbt_idx.customer_orders_status: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.customer_orders_status"} */
drop view if exists "IDX-Stock"."warehouse"."customer_orders_status__dbt_backup" cascade
[0m18:10:59.443534 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m18:10:59.445653 [debug] [Thread-1 (]: Timing info for model.dbt_idx.customer_orders_status (execute): 18:10:59.376551 => 18:10:59.445653
[0m18:10:59.446625 [debug] [Thread-1 (]: On model.dbt_idx.customer_orders_status: Close
[0m18:10:59.448631 [info ] [Thread-1 (]: 7 of 7 OK created sql view model warehouse.customer_orders_status .............. [[32mCREATE VIEW[0m in 0.09s]
[0m18:10:59.450627 [debug] [Thread-1 (]: Finished running node model.dbt_idx.customer_orders_status
[0m18:10:59.453626 [debug] [MainThread]: Using postgres connection "master"
[0m18:10:59.454131 [debug] [MainThread]: On master: BEGIN
[0m18:10:59.455137 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:10:59.477550 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m18:10:59.478550 [debug] [MainThread]: On master: COMMIT
[0m18:10:59.478550 [debug] [MainThread]: Using postgres connection "master"
[0m18:10:59.479572 [debug] [MainThread]: On master: COMMIT
[0m18:10:59.483505 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m18:10:59.485244 [debug] [MainThread]: On master: Close
[0m18:10:59.488614 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:10:59.490365 [debug] [MainThread]: Connection 'list_IDX-Stock' was properly closed.
[0m18:10:59.492000 [debug] [MainThread]: Connection 'list_IDX-Stock_snapshots' was properly closed.
[0m18:10:59.493642 [debug] [MainThread]: Connection 'model.dbt_idx.customer_orders_status' was properly closed.
[0m18:10:59.495837 [info ] [MainThread]: 
[0m18:10:59.497476 [info ] [MainThread]: Finished running 5 view models, 2 table models in 0 hours 0 minutes and 1.03 seconds (1.03s).
[0m18:10:59.502877 [debug] [MainThread]: Command end result
[0m18:10:59.526763 [info ] [MainThread]: 
[0m18:10:59.527764 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:10:59.528766 [info ] [MainThread]: 
[0m18:10:59.529769 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=0 SKIP=0 TOTAL=7
[0m18:10:59.530782 [debug] [MainThread]: Command `dbt run` succeeded at 18:10:59.530782 after 1.54 seconds
[0m18:10:59.531791 [debug] [MainThread]: Flushing usage events
