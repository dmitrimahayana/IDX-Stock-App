

============================== 16:18:35.662604 | e39c4583-6abe-4c5b-b410-f5110b2bc485 ==============================
[0m16:18:35.662604 [info ] [MainThread]: Running with dbt=1.6.1
[0m16:18:35.670126 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'D:\\00 Project\\00 My Project\\IdeaProjects\\Py-DBT-IDX', 'debug': 'False', 'version_check': 'True', 'log_path': 'D:\\00 Project\\00 My Project\\IdeaProjects\\Py-DBT-IDX\\logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt snapshot', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'False'}
[0m16:18:35.779757 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `source-paths` config has been renamed to `model-paths`. Please update your
`dbt_project.yml` configuration to reflect this change.
[0m16:18:35.781747 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `data-paths` config has been renamed to `seed-paths`. Please update your
`dbt_project.yml` configuration to reflect this change.
[0m16:18:35.863187 [info ] [MainThread]: Registered adapter: postgres=1.6.1
[0m16:18:35.874707 [debug] [MainThread]: checksum: efe19d9f5b93d1a98cc804fbfcdb6b3aced98b974af664946fee1cde8837deb7, vars: {}, profile: , target: , version: 1.6.1
[0m16:18:35.875707 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m16:18:36.720343 [warn ] [MainThread]: [[33mWARNING[0m]: Did not find matching node for patch with name 'dim_customers' in the 'models' section of file 'models\marts\core\core.yml'
[0m16:18:36.722321 [warn ] [MainThread]: [[33mWARNING[0m]: Did not find matching node for patch with name 'fct_orders' in the 'models' section of file 'models\marts\core\core.yml'
[0m16:18:36.797252 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_idx.not_null_dim_customers_customer_id.dd91cd1c8d' (models\marts\core\core.yml) depends on a node named 'dim_customers' in package '' which was not found
[0m16:18:36.833485 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.dbt_idx.marts.core
[0m16:18:36.875621 [info ] [MainThread]: Found 4 tests, 3 sources, 0 exposures, 0 metrics, 349 macros, 0 groups, 0 semantic models
[0m16:18:36.879076 [info ] [MainThread]: 
[0m16:18:36.880112 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m16:18:36.882086 [debug] [MainThread]: Command end result
[0m16:18:36.900811 [debug] [MainThread]: Command `dbt snapshot` succeeded at 16:18:36.899812 after 1.28 seconds
[0m16:18:36.901816 [debug] [MainThread]: Flushing usage events


============================== 16:42:46.186929 | bd6eefb1-ddc2-4391-b84d-3e84c46f9043 ==============================
[0m16:42:46.186929 [info ] [MainThread]: Running with dbt=1.6.1
[0m16:42:46.191531 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'D:\\00 Project\\00 My Project\\IdeaProjects\\Py-DBT-IDX', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': 'D:\\00 Project\\00 My Project\\IdeaProjects\\Py-DBT-IDX\\logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt snapshot', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'False'}
[0m16:42:46.321441 [info ] [MainThread]: Registered adapter: postgres=1.6.1
[0m16:42:46.333340 [debug] [MainThread]: checksum: efe19d9f5b93d1a98cc804fbfcdb6b3aced98b974af664946fee1cde8837deb7, vars: {}, profile: , target: , version: 1.6.1
[0m16:42:46.341868 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m16:42:47.166414 [warn ] [MainThread]: [[33mWARNING[0m]: Did not find matching node for patch with name 'dim_customers' in the 'models' section of file 'models\marts\core\core.yml'
[0m16:42:47.213577 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_idx.not_null_dim_customers_customer_id.dd91cd1c8d' (models\marts\core\core.yml) depends on a node named 'dim_customers' in package '' which was not found
[0m16:42:47.335476 [info ] [MainThread]: Found 5 models, 1 snapshot, 4 tests, 3 sources, 0 exposures, 0 metrics, 349 macros, 0 groups, 0 semantic models
[0m16:42:47.337505 [info ] [MainThread]: 
[0m16:42:47.339483 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m16:42:47.342982 [debug] [ThreadPool]: Acquiring new postgres connection 'list_IDX-Stock'
[0m16:42:47.353500 [debug] [ThreadPool]: Using postgres connection "list_IDX-Stock"
[0m16:42:47.353500 [debug] [ThreadPool]: On list_IDX-Stock: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "connection_name": "list_IDX-Stock"} */

    select distinct nspname from pg_namespace
  
[0m16:42:47.354506 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:42:47.407741 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.0 seconds
[0m16:42:47.409760 [debug] [ThreadPool]: On list_IDX-Stock: Close
[0m16:42:47.412243 [debug] [ThreadPool]: Acquiring new postgres connection 'list_IDX-Stock_snapshots'
[0m16:42:47.420264 [debug] [ThreadPool]: Using postgres connection "list_IDX-Stock_snapshots"
[0m16:42:47.421772 [debug] [ThreadPool]: On list_IDX-Stock_snapshots: BEGIN
[0m16:42:47.421772 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:42:47.445811 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m16:42:47.446809 [debug] [ThreadPool]: Using postgres connection "list_IDX-Stock_snapshots"
[0m16:42:47.446809 [debug] [ThreadPool]: On list_IDX-Stock_snapshots: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "connection_name": "list_IDX-Stock_snapshots"} */
select
      'IDX-Stock' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'snapshots'
    union all
    select
      'IDX-Stock' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'snapshots'
    union all
    select
      'IDX-Stock' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'snapshots'
  
[0m16:42:47.454252 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.0 seconds
[0m16:42:47.456287 [debug] [ThreadPool]: On list_IDX-Stock_snapshots: ROLLBACK
[0m16:42:47.458253 [debug] [ThreadPool]: On list_IDX-Stock_snapshots: Close
[0m16:42:47.460250 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_IDX-Stock_snapshots, now list_IDX-Stock_warehouse)
[0m16:42:47.463765 [debug] [ThreadPool]: Using postgres connection "list_IDX-Stock_warehouse"
[0m16:42:47.464765 [debug] [ThreadPool]: On list_IDX-Stock_warehouse: BEGIN
[0m16:42:47.465793 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:42:47.487007 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m16:42:47.488002 [debug] [ThreadPool]: Using postgres connection "list_IDX-Stock_warehouse"
[0m16:42:47.488002 [debug] [ThreadPool]: On list_IDX-Stock_warehouse: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "connection_name": "list_IDX-Stock_warehouse"} */
select
      'IDX-Stock' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'warehouse'
    union all
    select
      'IDX-Stock' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'warehouse'
    union all
    select
      'IDX-Stock' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'warehouse'
  
[0m16:42:47.494533 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.0 seconds
[0m16:42:47.497552 [debug] [ThreadPool]: On list_IDX-Stock_warehouse: ROLLBACK
[0m16:42:47.499518 [debug] [ThreadPool]: On list_IDX-Stock_warehouse: Close
[0m16:42:47.510087 [debug] [MainThread]: Using postgres connection "master"
[0m16:42:47.510087 [debug] [MainThread]: On master: BEGIN
[0m16:42:47.510087 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:42:47.538928 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m16:42:47.539925 [debug] [MainThread]: Using postgres connection "master"
[0m16:42:47.541446 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m16:42:47.554041 [debug] [MainThread]: SQL status: SELECT 0 in 0.0 seconds
[0m16:42:47.557084 [debug] [MainThread]: On master: ROLLBACK
[0m16:42:47.560043 [debug] [MainThread]: Using postgres connection "master"
[0m16:42:47.560043 [debug] [MainThread]: On master: BEGIN
[0m16:42:47.565596 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m16:42:47.566574 [debug] [MainThread]: On master: COMMIT
[0m16:42:47.567614 [debug] [MainThread]: Using postgres connection "master"
[0m16:42:47.568561 [debug] [MainThread]: On master: COMMIT
[0m16:42:47.570561 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m16:42:47.572102 [debug] [MainThread]: On master: Close
[0m16:42:47.573109 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:42:47.575632 [info ] [MainThread]: 
[0m16:42:47.582747 [debug] [Thread-1 (]: Began running node snapshot.dbt_idx.customers_snapshot
[0m16:42:47.583687 [info ] [Thread-1 (]: 1 of 1 START snapshot snapshots.customers_snapshot ............................. [RUN]
[0m16:42:47.586686 [debug] [Thread-1 (]: Acquiring new postgres connection 'snapshot.dbt_idx.customers_snapshot'
[0m16:42:47.587683 [debug] [Thread-1 (]: Began compiling node snapshot.dbt_idx.customers_snapshot
[0m16:42:47.600318 [debug] [Thread-1 (]: Timing info for snapshot.dbt_idx.customers_snapshot (compile): 16:42:47.589250 => 16:42:47.600318
[0m16:42:47.601945 [debug] [Thread-1 (]: Began executing node snapshot.dbt_idx.customers_snapshot
[0m16:42:47.675781 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.dbt_idx.customers_snapshot"
[0m16:42:47.684538 [debug] [Thread-1 (]: Using postgres connection "snapshot.dbt_idx.customers_snapshot"
[0m16:42:47.685537 [debug] [Thread-1 (]: On snapshot.dbt_idx.customers_snapshot: BEGIN
[0m16:42:47.685537 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m16:42:47.711407 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m16:42:47.712419 [debug] [Thread-1 (]: Using postgres connection "snapshot.dbt_idx.customers_snapshot"
[0m16:42:47.713453 [debug] [Thread-1 (]: On snapshot.dbt_idx.customers_snapshot: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "snapshot.dbt_idx.customers_snapshot"} */

      
  
    

  create  table "IDX-Stock"."snapshots"."customers_snapshot"
  
  
    as
  
  (
    

    select *,
        md5(coalesce(cast(customer_id as varchar ), '')
         || '|' || coalesce(cast(datetime_updated as varchar ), '')
        ) as dbt_scd_id,
        datetime_updated as dbt_updated_at,
        datetime_updated as dbt_valid_from,
        nullif(datetime_updated, datetime_updated) as dbt_valid_to
    from (
        



select *
from "IDX-Stock"."warehouse"."customers"

    ) sbq



  );
  
  
[0m16:42:47.735685 [debug] [Thread-1 (]: SQL status: SELECT 100 in 0.0 seconds
[0m16:42:47.755627 [debug] [Thread-1 (]: On snapshot.dbt_idx.customers_snapshot: COMMIT
[0m16:42:47.756638 [debug] [Thread-1 (]: Using postgres connection "snapshot.dbt_idx.customers_snapshot"
[0m16:42:47.757636 [debug] [Thread-1 (]: On snapshot.dbt_idx.customers_snapshot: COMMIT
[0m16:42:47.762113 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m16:42:47.765121 [debug] [Thread-1 (]: Timing info for snapshot.dbt_idx.customers_snapshot (execute): 16:42:47.602845 => 16:42:47.765121
[0m16:42:47.766161 [debug] [Thread-1 (]: On snapshot.dbt_idx.customers_snapshot: Close
[0m16:42:47.769124 [info ] [Thread-1 (]: 1 of 1 OK snapshotted snapshots.customers_snapshot ............................. [[32msuccess[0m in 0.18s]
[0m16:42:47.771692 [debug] [Thread-1 (]: Finished running node snapshot.dbt_idx.customers_snapshot
[0m16:42:47.775718 [debug] [MainThread]: Using postgres connection "master"
[0m16:42:47.776711 [debug] [MainThread]: On master: BEGIN
[0m16:42:47.778708 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:42:47.809577 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m16:42:47.810590 [debug] [MainThread]: On master: COMMIT
[0m16:42:47.811582 [debug] [MainThread]: Using postgres connection "master"
[0m16:42:47.812111 [debug] [MainThread]: On master: COMMIT
[0m16:42:47.814130 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m16:42:47.816118 [debug] [MainThread]: On master: Close
[0m16:42:47.817126 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:42:47.818124 [debug] [MainThread]: Connection 'list_IDX-Stock' was properly closed.
[0m16:42:47.819636 [debug] [MainThread]: Connection 'list_IDX-Stock_warehouse' was properly closed.
[0m16:42:47.821649 [debug] [MainThread]: Connection 'snapshot.dbt_idx.customers_snapshot' was properly closed.
[0m16:42:47.821649 [info ] [MainThread]: 
[0m16:42:47.823836 [info ] [MainThread]: Finished running 1 snapshot in 0 hours 0 minutes and 0.48 seconds (0.48s).
[0m16:42:47.825861 [debug] [MainThread]: Command end result
[0m16:42:47.858071 [info ] [MainThread]: 
[0m16:42:47.859544 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:42:47.861544 [info ] [MainThread]: 
[0m16:42:47.863682 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m16:42:47.865678 [debug] [MainThread]: Command `dbt snapshot` succeeded at 16:42:47.865678 after 1.72 seconds
[0m16:42:47.866643 [debug] [MainThread]: Flushing usage events


============================== 16:43:33.612940 | 8539b76c-44c6-4a70-9f1e-76e585adc040 ==============================
[0m16:43:33.612940 [info ] [MainThread]: Running with dbt=1.6.1
[0m16:43:33.617970 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'D:\\00 Project\\00 My Project\\IdeaProjects\\Py-DBT-IDX', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': 'D:\\00 Project\\00 My Project\\IdeaProjects\\Py-DBT-IDX\\logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt snapshot', 'send_anonymous_usage_stats': 'False'}
[0m16:43:33.747406 [info ] [MainThread]: Registered adapter: postgres=1.6.1
[0m16:43:33.758988 [debug] [MainThread]: checksum: efe19d9f5b93d1a98cc804fbfcdb6b3aced98b974af664946fee1cde8837deb7, vars: {}, profile: , target: , version: 1.6.1
[0m16:43:33.899543 [debug] [MainThread]: Partial parsing enabled: 1 files deleted, 1 files added, 0 files changed.
[0m16:43:33.900517 [debug] [MainThread]: Partial parsing: added file: dbt_idx://models\marts\core\dim_customers.sql
[0m16:43:33.901514 [debug] [MainThread]: Partial parsing: deleted file: dbt_idx://models\marts\core\dim_customer.sql
[0m16:43:33.990026 [info ] [MainThread]: Found 5 models, 1 snapshot, 4 tests, 3 sources, 0 exposures, 0 metrics, 349 macros, 0 groups, 0 semantic models
[0m16:43:33.993544 [info ] [MainThread]: 
[0m16:43:33.995547 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m16:43:33.998580 [debug] [ThreadPool]: Acquiring new postgres connection 'list_IDX-Stock'
[0m16:43:34.013695 [debug] [ThreadPool]: Using postgres connection "list_IDX-Stock"
[0m16:43:34.014660 [debug] [ThreadPool]: On list_IDX-Stock: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "connection_name": "list_IDX-Stock"} */

    select distinct nspname from pg_namespace
  
[0m16:43:34.014660 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:43:34.045863 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.0 seconds
[0m16:43:34.047862 [debug] [ThreadPool]: On list_IDX-Stock: Close
[0m16:43:34.052360 [debug] [ThreadPool]: Acquiring new postgres connection 'list_IDX-Stock_snapshots'
[0m16:43:34.060359 [debug] [ThreadPool]: Using postgres connection "list_IDX-Stock_snapshots"
[0m16:43:34.061365 [debug] [ThreadPool]: On list_IDX-Stock_snapshots: BEGIN
[0m16:43:34.061365 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:43:34.081292 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m16:43:34.082343 [debug] [ThreadPool]: Using postgres connection "list_IDX-Stock_snapshots"
[0m16:43:34.083325 [debug] [ThreadPool]: On list_IDX-Stock_snapshots: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "connection_name": "list_IDX-Stock_snapshots"} */
select
      'IDX-Stock' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'snapshots'
    union all
    select
      'IDX-Stock' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'snapshots'
    union all
    select
      'IDX-Stock' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'snapshots'
  
[0m16:43:34.089302 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.0 seconds
[0m16:43:34.091298 [debug] [ThreadPool]: On list_IDX-Stock_snapshots: ROLLBACK
[0m16:43:34.093816 [debug] [ThreadPool]: On list_IDX-Stock_snapshots: Close
[0m16:43:34.096818 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_IDX-Stock_snapshots, now list_IDX-Stock_warehouse)
[0m16:43:34.102363 [debug] [ThreadPool]: Using postgres connection "list_IDX-Stock_warehouse"
[0m16:43:34.103361 [debug] [ThreadPool]: On list_IDX-Stock_warehouse: BEGIN
[0m16:43:34.104324 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:43:34.126454 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m16:43:34.126454 [debug] [ThreadPool]: Using postgres connection "list_IDX-Stock_warehouse"
[0m16:43:34.127756 [debug] [ThreadPool]: On list_IDX-Stock_warehouse: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "connection_name": "list_IDX-Stock_warehouse"} */
select
      'IDX-Stock' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'warehouse'
    union all
    select
      'IDX-Stock' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'warehouse'
    union all
    select
      'IDX-Stock' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'warehouse'
  
[0m16:43:34.133302 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.0 seconds
[0m16:43:34.135326 [debug] [ThreadPool]: On list_IDX-Stock_warehouse: ROLLBACK
[0m16:43:34.137296 [debug] [ThreadPool]: On list_IDX-Stock_warehouse: Close
[0m16:43:34.145363 [debug] [MainThread]: Using postgres connection "master"
[0m16:43:34.147338 [debug] [MainThread]: On master: BEGIN
[0m16:43:34.147338 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:43:34.169165 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m16:43:34.170161 [debug] [MainThread]: Using postgres connection "master"
[0m16:43:34.170161 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m16:43:34.175709 [debug] [MainThread]: SQL status: SELECT 0 in 0.0 seconds
[0m16:43:34.178716 [debug] [MainThread]: On master: ROLLBACK
[0m16:43:34.181215 [debug] [MainThread]: Using postgres connection "master"
[0m16:43:34.181215 [debug] [MainThread]: On master: BEGIN
[0m16:43:34.185220 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m16:43:34.185220 [debug] [MainThread]: On master: COMMIT
[0m16:43:34.186227 [debug] [MainThread]: Using postgres connection "master"
[0m16:43:34.187231 [debug] [MainThread]: On master: COMMIT
[0m16:43:34.189225 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m16:43:34.189225 [debug] [MainThread]: On master: Close
[0m16:43:34.191233 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:43:34.193355 [info ] [MainThread]: 
[0m16:43:34.198354 [debug] [Thread-1 (]: Began running node snapshot.dbt_idx.customers_snapshot
[0m16:43:34.199355 [info ] [Thread-1 (]: 1 of 1 START snapshot snapshots.customers_snapshot ............................. [RUN]
[0m16:43:34.200356 [debug] [Thread-1 (]: Acquiring new postgres connection 'snapshot.dbt_idx.customers_snapshot'
[0m16:43:34.201402 [debug] [Thread-1 (]: Began compiling node snapshot.dbt_idx.customers_snapshot
[0m16:43:34.211563 [debug] [Thread-1 (]: Timing info for snapshot.dbt_idx.customers_snapshot (compile): 16:43:34.201402 => 16:43:34.211563
[0m16:43:34.213029 [debug] [Thread-1 (]: Began executing node snapshot.dbt_idx.customers_snapshot
[0m16:43:34.257513 [debug] [Thread-1 (]: Using postgres connection "snapshot.dbt_idx.customers_snapshot"
[0m16:43:34.258556 [debug] [Thread-1 (]: On snapshot.dbt_idx.customers_snapshot: BEGIN
[0m16:43:34.259538 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m16:43:34.281269 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m16:43:34.282199 [debug] [Thread-1 (]: Using postgres connection "snapshot.dbt_idx.customers_snapshot"
[0m16:43:34.282199 [debug] [Thread-1 (]: On snapshot.dbt_idx.customers_snapshot: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "snapshot.dbt_idx.customers_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "IDX-Stock".INFORMATION_SCHEMA.columns
      where table_name = 'customers_snapshot'
        
        and table_schema = 'snapshots'
        
      order by ordinal_position

  
[0m16:43:34.298369 [debug] [Thread-1 (]: SQL status: SELECT 10 in 0.0 seconds
[0m16:43:34.325748 [debug] [Thread-1 (]: Using postgres connection "snapshot.dbt_idx.customers_snapshot"
[0m16:43:34.326748 [debug] [Thread-1 (]: On snapshot.dbt_idx.customers_snapshot: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "snapshot.dbt_idx.customers_snapshot"} */

        
  
    

  create temporary table "customers_snapshot__dbt_tmp164334313157"
  
  
    as
  
  (
    with snapshot_query as (

        



select *
from "IDX-Stock"."warehouse"."customers"


    ),

    snapshotted_data as (

        select *,
            customer_id as dbt_unique_key

        from "IDX-Stock"."snapshots"."customers_snapshot"
        where dbt_valid_to is null

    ),

    insertions_source_data as (

        select
            *,
            customer_id as dbt_unique_key,
            datetime_updated as dbt_updated_at,
            datetime_updated as dbt_valid_from,
            nullif(datetime_updated, datetime_updated) as dbt_valid_to,
            md5(coalesce(cast(customer_id as varchar ), '')
         || '|' || coalesce(cast(datetime_updated as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select
            *,
            customer_id as dbt_unique_key,
            datetime_updated as dbt_updated_at,
            datetime_updated as dbt_valid_from,
            datetime_updated as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where snapshotted_data.dbt_unique_key is null
           or (
                snapshotted_data.dbt_unique_key is not null
            and (
                (snapshotted_data.dbt_valid_from < source_data.datetime_updated)
            )
        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where (
            (snapshotted_data.dbt_valid_from < source_data.datetime_updated)
        )
    )

    select * from insertions
    union all
    select * from updates

  );
  
    
[0m16:43:34.333336 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.0 seconds
[0m16:43:34.337337 [debug] [Thread-1 (]: Using postgres connection "snapshot.dbt_idx.customers_snapshot"
[0m16:43:34.338352 [debug] [Thread-1 (]: On snapshot.dbt_idx.customers_snapshot: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "snapshot.dbt_idx.customers_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'customers_snapshot__dbt_tmp164334313157'
        
      order by ordinal_position

  
[0m16:43:34.343926 [debug] [Thread-1 (]: SQL status: SELECT 12 in 0.0 seconds
[0m16:43:34.347925 [debug] [Thread-1 (]: Using postgres connection "snapshot.dbt_idx.customers_snapshot"
[0m16:43:34.348924 [debug] [Thread-1 (]: On snapshot.dbt_idx.customers_snapshot: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "snapshot.dbt_idx.customers_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "IDX-Stock".INFORMATION_SCHEMA.columns
      where table_name = 'customers_snapshot'
        
        and table_schema = 'snapshots'
        
      order by ordinal_position

  
[0m16:43:34.352437 [debug] [Thread-1 (]: SQL status: SELECT 10 in 0.0 seconds
[0m16:43:34.356467 [debug] [Thread-1 (]: Using postgres connection "snapshot.dbt_idx.customers_snapshot"
[0m16:43:34.357465 [debug] [Thread-1 (]: On snapshot.dbt_idx.customers_snapshot: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "snapshot.dbt_idx.customers_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'customers_snapshot__dbt_tmp164334313157'
        
      order by ordinal_position

  
[0m16:43:34.361465 [debug] [Thread-1 (]: SQL status: SELECT 12 in 0.0 seconds
[0m16:43:34.366819 [debug] [Thread-1 (]: Using postgres connection "snapshot.dbt_idx.customers_snapshot"
[0m16:43:34.367818 [debug] [Thread-1 (]: On snapshot.dbt_idx.customers_snapshot: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "snapshot.dbt_idx.customers_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "IDX-Stock".INFORMATION_SCHEMA.columns
      where table_name = 'customers_snapshot'
        
        and table_schema = 'snapshots'
        
      order by ordinal_position

  
[0m16:43:34.371625 [debug] [Thread-1 (]: SQL status: SELECT 10 in 0.0 seconds
[0m16:43:34.379692 [debug] [Thread-1 (]: Using postgres connection "snapshot.dbt_idx.customers_snapshot"
[0m16:43:34.379692 [debug] [Thread-1 (]: On snapshot.dbt_idx.customers_snapshot: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "snapshot.dbt_idx.customers_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'customers_snapshot__dbt_tmp164334313157'
        
      order by ordinal_position

  
[0m16:43:34.385218 [debug] [Thread-1 (]: SQL status: SELECT 12 in 0.0 seconds
[0m16:43:34.391800 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.dbt_idx.customers_snapshot"
[0m16:43:34.408801 [debug] [Thread-1 (]: Using postgres connection "snapshot.dbt_idx.customers_snapshot"
[0m16:43:34.409800 [debug] [Thread-1 (]: On snapshot.dbt_idx.customers_snapshot: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "snapshot.dbt_idx.customers_snapshot"} */

      update "IDX-Stock"."snapshots"."customers_snapshot"
    set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to
    from "customers_snapshot__dbt_tmp164334313157" as DBT_INTERNAL_SOURCE
    where DBT_INTERNAL_SOURCE.dbt_scd_id::text = "IDX-Stock"."snapshots"."customers_snapshot".dbt_scd_id::text
      and DBT_INTERNAL_SOURCE.dbt_change_type::text in ('update'::text, 'delete'::text)
      and "IDX-Stock"."snapshots"."customers_snapshot".dbt_valid_to is null;

    insert into "IDX-Stock"."snapshots"."customers_snapshot" ("customer_id", "zipcode", "city", "state_code", "datetime_created", "datetime_updated", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id")
    select DBT_INTERNAL_SOURCE."customer_id",DBT_INTERNAL_SOURCE."zipcode",DBT_INTERNAL_SOURCE."city",DBT_INTERNAL_SOURCE."state_code",DBT_INTERNAL_SOURCE."datetime_created",DBT_INTERNAL_SOURCE."datetime_updated",DBT_INTERNAL_SOURCE."dbt_updated_at",DBT_INTERNAL_SOURCE."dbt_valid_from",DBT_INTERNAL_SOURCE."dbt_valid_to",DBT_INTERNAL_SOURCE."dbt_scd_id"
    from "customers_snapshot__dbt_tmp164334313157" as DBT_INTERNAL_SOURCE
    where DBT_INTERNAL_SOURCE.dbt_change_type::text = 'insert'::text;

  
[0m16:43:34.413912 [debug] [Thread-1 (]: SQL status: INSERT 0 0 in 0.0 seconds
[0m16:43:34.429157 [debug] [Thread-1 (]: On snapshot.dbt_idx.customers_snapshot: COMMIT
[0m16:43:34.430135 [debug] [Thread-1 (]: Using postgres connection "snapshot.dbt_idx.customers_snapshot"
[0m16:43:34.430135 [debug] [Thread-1 (]: On snapshot.dbt_idx.customers_snapshot: COMMIT
[0m16:43:34.435152 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m16:43:34.439187 [debug] [Thread-1 (]: Timing info for snapshot.dbt_idx.customers_snapshot (execute): 16:43:34.213029 => 16:43:34.438183
[0m16:43:34.439187 [debug] [Thread-1 (]: On snapshot.dbt_idx.customers_snapshot: Close
[0m16:43:34.442698 [info ] [Thread-1 (]: 1 of 1 OK snapshotted snapshots.customers_snapshot ............................. [[32msuccess[0m in 0.24s]
[0m16:43:34.444699 [debug] [Thread-1 (]: Finished running node snapshot.dbt_idx.customers_snapshot
[0m16:43:34.449704 [debug] [MainThread]: Using postgres connection "master"
[0m16:43:34.451210 [debug] [MainThread]: On master: BEGIN
[0m16:43:34.452224 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:43:34.475978 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m16:43:34.476972 [debug] [MainThread]: On master: COMMIT
[0m16:43:34.476972 [debug] [MainThread]: Using postgres connection "master"
[0m16:43:34.477973 [debug] [MainThread]: On master: COMMIT
[0m16:43:34.479986 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m16:43:34.481493 [debug] [MainThread]: On master: Close
[0m16:43:34.482500 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:43:34.484503 [debug] [MainThread]: Connection 'list_IDX-Stock' was properly closed.
[0m16:43:34.485501 [debug] [MainThread]: Connection 'list_IDX-Stock_warehouse' was properly closed.
[0m16:43:34.486528 [debug] [MainThread]: Connection 'snapshot.dbt_idx.customers_snapshot' was properly closed.
[0m16:43:34.487537 [info ] [MainThread]: 
[0m16:43:34.488509 [info ] [MainThread]: Finished running 1 snapshot in 0 hours 0 minutes and 0.49 seconds (0.49s).
[0m16:43:34.490505 [debug] [MainThread]: Command end result
[0m16:43:34.522845 [info ] [MainThread]: 
[0m16:43:34.524852 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:43:34.525852 [info ] [MainThread]: 
[0m16:43:34.527372 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m16:43:34.529414 [debug] [MainThread]: Command `dbt snapshot` succeeded at 16:43:34.528443 after 0.95 seconds
[0m16:43:34.529414 [debug] [MainThread]: Flushing usage events


============================== 16:44:51.252803 | 1fb805ca-13d1-446e-9f23-23da5712aacd ==============================
[0m16:44:51.252803 [info ] [MainThread]: Running with dbt=1.6.1
[0m16:44:51.257769 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'D:\\00 Project\\00 My Project\\IdeaProjects\\Py-DBT-IDX\\logs', 'version_check': 'True', 'profiles_dir': 'D:\\00 Project\\00 My Project\\IdeaProjects\\Py-DBT-IDX', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt snapshot', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'False'}
[0m16:44:51.392046 [info ] [MainThread]: Registered adapter: postgres=1.6.1
[0m16:44:51.404077 [debug] [MainThread]: checksum: efe19d9f5b93d1a98cc804fbfcdb6b3aced98b974af664946fee1cde8837deb7, vars: {}, profile: , target: , version: 1.6.1
[0m16:44:51.549993 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:44:51.550993 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:44:51.597077 [info ] [MainThread]: Found 5 models, 1 snapshot, 4 tests, 3 sources, 0 exposures, 0 metrics, 349 macros, 0 groups, 0 semantic models
[0m16:44:51.600092 [info ] [MainThread]: 
[0m16:44:51.601062 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m16:44:51.604583 [debug] [ThreadPool]: Acquiring new postgres connection 'list_IDX-Stock'
[0m16:44:51.617185 [debug] [ThreadPool]: Using postgres connection "list_IDX-Stock"
[0m16:44:51.618142 [debug] [ThreadPool]: On list_IDX-Stock: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "connection_name": "list_IDX-Stock"} */

    select distinct nspname from pg_namespace
  
[0m16:44:51.619161 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:44:51.652293 [debug] [ThreadPool]: SQL status: SELECT 9 in 0.0 seconds
[0m16:44:51.654292 [debug] [ThreadPool]: On list_IDX-Stock: Close
[0m16:44:51.658309 [debug] [ThreadPool]: Acquiring new postgres connection 'list_IDX-Stock_snapshots'
[0m16:44:51.665876 [debug] [ThreadPool]: Using postgres connection "list_IDX-Stock_snapshots"
[0m16:44:51.666843 [debug] [ThreadPool]: On list_IDX-Stock_snapshots: BEGIN
[0m16:44:51.667848 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:44:51.694528 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m16:44:51.696137 [debug] [ThreadPool]: Using postgres connection "list_IDX-Stock_snapshots"
[0m16:44:51.696137 [debug] [ThreadPool]: On list_IDX-Stock_snapshots: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "connection_name": "list_IDX-Stock_snapshots"} */
select
      'IDX-Stock' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'snapshots'
    union all
    select
      'IDX-Stock' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'snapshots'
    union all
    select
      'IDX-Stock' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'snapshots'
  
[0m16:44:51.702156 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.0 seconds
[0m16:44:51.704155 [debug] [ThreadPool]: On list_IDX-Stock_snapshots: ROLLBACK
[0m16:44:51.707169 [debug] [ThreadPool]: On list_IDX-Stock_snapshots: Close
[0m16:44:51.709170 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_IDX-Stock_snapshots, now list_IDX-Stock_warehouse)
[0m16:44:51.714310 [debug] [ThreadPool]: Using postgres connection "list_IDX-Stock_warehouse"
[0m16:44:51.715311 [debug] [ThreadPool]: On list_IDX-Stock_warehouse: BEGIN
[0m16:44:51.716321 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:44:51.740212 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m16:44:51.741219 [debug] [ThreadPool]: Using postgres connection "list_IDX-Stock_warehouse"
[0m16:44:51.741729 [debug] [ThreadPool]: On list_IDX-Stock_warehouse: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "connection_name": "list_IDX-Stock_warehouse"} */
select
      'IDX-Stock' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'warehouse'
    union all
    select
      'IDX-Stock' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'warehouse'
    union all
    select
      'IDX-Stock' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'warehouse'
  
[0m16:44:51.746808 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.0 seconds
[0m16:44:51.749280 [debug] [ThreadPool]: On list_IDX-Stock_warehouse: ROLLBACK
[0m16:44:51.752646 [debug] [ThreadPool]: On list_IDX-Stock_warehouse: Close
[0m16:44:51.762171 [debug] [MainThread]: Using postgres connection "master"
[0m16:44:51.763206 [debug] [MainThread]: On master: BEGIN
[0m16:44:51.764171 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:44:51.787730 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m16:44:51.787730 [debug] [MainThread]: Using postgres connection "master"
[0m16:44:51.789257 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m16:44:51.794748 [debug] [MainThread]: SQL status: SELECT 0 in 0.0 seconds
[0m16:44:51.797259 [debug] [MainThread]: On master: ROLLBACK
[0m16:44:51.799292 [debug] [MainThread]: Using postgres connection "master"
[0m16:44:51.800260 [debug] [MainThread]: On master: BEGIN
[0m16:44:51.804776 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m16:44:51.805782 [debug] [MainThread]: On master: COMMIT
[0m16:44:51.806781 [debug] [MainThread]: Using postgres connection "master"
[0m16:44:51.807778 [debug] [MainThread]: On master: COMMIT
[0m16:44:51.809784 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m16:44:51.811340 [debug] [MainThread]: On master: Close
[0m16:44:51.813290 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:44:51.814291 [info ] [MainThread]: 
[0m16:44:51.820292 [debug] [Thread-1 (]: Began running node snapshot.dbt_idx.customers_snapshot
[0m16:44:51.821332 [info ] [Thread-1 (]: 1 of 1 START snapshot snapshots.customers_snapshot ............................. [RUN]
[0m16:44:51.823476 [debug] [Thread-1 (]: Acquiring new postgres connection 'snapshot.dbt_idx.customers_snapshot'
[0m16:44:51.824437 [debug] [Thread-1 (]: Began compiling node snapshot.dbt_idx.customers_snapshot
[0m16:44:51.832070 [debug] [Thread-1 (]: Timing info for snapshot.dbt_idx.customers_snapshot (compile): 16:44:51.824437 => 16:44:51.832070
[0m16:44:51.833114 [debug] [Thread-1 (]: Began executing node snapshot.dbt_idx.customers_snapshot
[0m16:44:51.889101 [debug] [Thread-1 (]: Using postgres connection "snapshot.dbt_idx.customers_snapshot"
[0m16:44:51.890066 [debug] [Thread-1 (]: On snapshot.dbt_idx.customers_snapshot: BEGIN
[0m16:44:51.890066 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m16:44:51.911359 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m16:44:51.912370 [debug] [Thread-1 (]: Using postgres connection "snapshot.dbt_idx.customers_snapshot"
[0m16:44:51.913370 [debug] [Thread-1 (]: On snapshot.dbt_idx.customers_snapshot: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "snapshot.dbt_idx.customers_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "IDX-Stock".INFORMATION_SCHEMA.columns
      where table_name = 'customers_snapshot'
        
        and table_schema = 'snapshots'
        
      order by ordinal_position

  
[0m16:44:51.921961 [debug] [Thread-1 (]: SQL status: SELECT 10 in 0.0 seconds
[0m16:44:51.951026 [debug] [Thread-1 (]: Using postgres connection "snapshot.dbt_idx.customers_snapshot"
[0m16:44:51.952518 [debug] [Thread-1 (]: On snapshot.dbt_idx.customers_snapshot: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "snapshot.dbt_idx.customers_snapshot"} */

        
  
    

  create temporary table "customers_snapshot__dbt_tmp164451938473"
  
  
    as
  
  (
    with snapshot_query as (

        



select *
from "IDX-Stock"."warehouse"."customers"


    ),

    snapshotted_data as (

        select *,
            customer_id as dbt_unique_key

        from "IDX-Stock"."snapshots"."customers_snapshot"
        where dbt_valid_to is null

    ),

    insertions_source_data as (

        select
            *,
            customer_id as dbt_unique_key,
            datetime_updated as dbt_updated_at,
            datetime_updated as dbt_valid_from,
            nullif(datetime_updated, datetime_updated) as dbt_valid_to,
            md5(coalesce(cast(customer_id as varchar ), '')
         || '|' || coalesce(cast(datetime_updated as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select
            *,
            customer_id as dbt_unique_key,
            datetime_updated as dbt_updated_at,
            datetime_updated as dbt_valid_from,
            datetime_updated as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where snapshotted_data.dbt_unique_key is null
           or (
                snapshotted_data.dbt_unique_key is not null
            and (
                (snapshotted_data.dbt_valid_from < source_data.datetime_updated)
            )
        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where (
            (snapshotted_data.dbt_valid_from < source_data.datetime_updated)
        )
    )

    select * from insertions
    union all
    select * from updates

  );
  
    
[0m16:44:51.958535 [debug] [Thread-1 (]: SQL status: SELECT 10 in 0.0 seconds
[0m16:44:51.962099 [debug] [Thread-1 (]: Using postgres connection "snapshot.dbt_idx.customers_snapshot"
[0m16:44:51.963066 [debug] [Thread-1 (]: On snapshot.dbt_idx.customers_snapshot: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "snapshot.dbt_idx.customers_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'customers_snapshot__dbt_tmp164451938473'
        
      order by ordinal_position

  
[0m16:44:51.968432 [debug] [Thread-1 (]: SQL status: SELECT 12 in 0.0 seconds
[0m16:44:51.972939 [debug] [Thread-1 (]: Using postgres connection "snapshot.dbt_idx.customers_snapshot"
[0m16:44:51.973953 [debug] [Thread-1 (]: On snapshot.dbt_idx.customers_snapshot: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "snapshot.dbt_idx.customers_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "IDX-Stock".INFORMATION_SCHEMA.columns
      where table_name = 'customers_snapshot'
        
        and table_schema = 'snapshots'
        
      order by ordinal_position

  
[0m16:44:51.978982 [debug] [Thread-1 (]: SQL status: SELECT 10 in 0.0 seconds
[0m16:44:51.984464 [debug] [Thread-1 (]: Using postgres connection "snapshot.dbt_idx.customers_snapshot"
[0m16:44:51.985479 [debug] [Thread-1 (]: On snapshot.dbt_idx.customers_snapshot: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "snapshot.dbt_idx.customers_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'customers_snapshot__dbt_tmp164451938473'
        
      order by ordinal_position

  
[0m16:44:51.989479 [debug] [Thread-1 (]: SQL status: SELECT 12 in 0.0 seconds
[0m16:44:51.994000 [debug] [Thread-1 (]: Using postgres connection "snapshot.dbt_idx.customers_snapshot"
[0m16:44:51.994000 [debug] [Thread-1 (]: On snapshot.dbt_idx.customers_snapshot: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "snapshot.dbt_idx.customers_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "IDX-Stock".INFORMATION_SCHEMA.columns
      where table_name = 'customers_snapshot'
        
        and table_schema = 'snapshots'
        
      order by ordinal_position

  
[0m16:44:52.001064 [debug] [Thread-1 (]: SQL status: SELECT 10 in 0.0 seconds
[0m16:44:52.011075 [debug] [Thread-1 (]: Using postgres connection "snapshot.dbt_idx.customers_snapshot"
[0m16:44:52.011587 [debug] [Thread-1 (]: On snapshot.dbt_idx.customers_snapshot: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "snapshot.dbt_idx.customers_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'customers_snapshot__dbt_tmp164451938473'
        
      order by ordinal_position

  
[0m16:44:52.017107 [debug] [Thread-1 (]: SQL status: SELECT 12 in 0.0 seconds
[0m16:44:52.023466 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.dbt_idx.customers_snapshot"
[0m16:44:52.038990 [debug] [Thread-1 (]: Using postgres connection "snapshot.dbt_idx.customers_snapshot"
[0m16:44:52.040025 [debug] [Thread-1 (]: On snapshot.dbt_idx.customers_snapshot: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "snapshot.dbt_idx.customers_snapshot"} */

      update "IDX-Stock"."snapshots"."customers_snapshot"
    set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to
    from "customers_snapshot__dbt_tmp164451938473" as DBT_INTERNAL_SOURCE
    where DBT_INTERNAL_SOURCE.dbt_scd_id::text = "IDX-Stock"."snapshots"."customers_snapshot".dbt_scd_id::text
      and DBT_INTERNAL_SOURCE.dbt_change_type::text in ('update'::text, 'delete'::text)
      and "IDX-Stock"."snapshots"."customers_snapshot".dbt_valid_to is null;

    insert into "IDX-Stock"."snapshots"."customers_snapshot" ("customer_id", "zipcode", "city", "state_code", "datetime_created", "datetime_updated", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id")
    select DBT_INTERNAL_SOURCE."customer_id",DBT_INTERNAL_SOURCE."zipcode",DBT_INTERNAL_SOURCE."city",DBT_INTERNAL_SOURCE."state_code",DBT_INTERNAL_SOURCE."datetime_created",DBT_INTERNAL_SOURCE."datetime_updated",DBT_INTERNAL_SOURCE."dbt_updated_at",DBT_INTERNAL_SOURCE."dbt_valid_from",DBT_INTERNAL_SOURCE."dbt_valid_to",DBT_INTERNAL_SOURCE."dbt_scd_id"
    from "customers_snapshot__dbt_tmp164451938473" as DBT_INTERNAL_SOURCE
    where DBT_INTERNAL_SOURCE.dbt_change_type::text = 'insert'::text;

  
[0m16:44:52.043254 [debug] [Thread-1 (]: SQL status: INSERT 0 5 in 0.0 seconds
[0m16:44:52.059801 [debug] [Thread-1 (]: On snapshot.dbt_idx.customers_snapshot: COMMIT
[0m16:44:52.061312 [debug] [Thread-1 (]: Using postgres connection "snapshot.dbt_idx.customers_snapshot"
[0m16:44:52.062334 [debug] [Thread-1 (]: On snapshot.dbt_idx.customers_snapshot: COMMIT
[0m16:44:52.066321 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m16:44:52.071322 [debug] [Thread-1 (]: Timing info for snapshot.dbt_idx.customers_snapshot (execute): 16:44:51.835076 => 16:44:52.070347
[0m16:44:52.071833 [debug] [Thread-1 (]: On snapshot.dbt_idx.customers_snapshot: Close
[0m16:44:52.073843 [info ] [Thread-1 (]: 1 of 1 OK snapshotted snapshots.customers_snapshot ............................. [[32msuccess[0m in 0.25s]
[0m16:44:52.076840 [debug] [Thread-1 (]: Finished running node snapshot.dbt_idx.customers_snapshot
[0m16:44:52.079850 [debug] [MainThread]: Using postgres connection "master"
[0m16:44:52.079850 [debug] [MainThread]: On master: BEGIN
[0m16:44:52.081357 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:44:52.113378 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m16:44:52.115264 [debug] [MainThread]: On master: COMMIT
[0m16:44:52.116813 [debug] [MainThread]: Using postgres connection "master"
[0m16:44:52.117818 [debug] [MainThread]: On master: COMMIT
[0m16:44:52.119836 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m16:44:52.122367 [debug] [MainThread]: On master: Close
[0m16:44:52.124354 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:44:52.125355 [debug] [MainThread]: Connection 'list_IDX-Stock' was properly closed.
[0m16:44:52.126358 [debug] [MainThread]: Connection 'list_IDX-Stock_warehouse' was properly closed.
[0m16:44:52.126358 [debug] [MainThread]: Connection 'snapshot.dbt_idx.customers_snapshot' was properly closed.
[0m16:44:52.127353 [info ] [MainThread]: 
[0m16:44:52.128027 [info ] [MainThread]: Finished running 1 snapshot in 0 hours 0 minutes and 0.53 seconds (0.53s).
[0m16:44:52.129039 [debug] [MainThread]: Command end result
[0m16:44:52.153571 [info ] [MainThread]: 
[0m16:44:52.154569 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:44:52.155572 [info ] [MainThread]: 
[0m16:44:52.157551 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m16:44:52.158553 [debug] [MainThread]: Command `dbt snapshot` succeeded at 16:44:52.158553 after 0.94 seconds
[0m16:44:52.159571 [debug] [MainThread]: Flushing usage events


============================== 17:58:58.638310 | 21bf611a-c955-48cb-9cf0-5a0fd150a031 ==============================
[0m17:58:58.638310 [info ] [MainThread]: Running with dbt=1.6.1
[0m17:58:58.643312 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'D:\\00 Project\\00 My Project\\IdeaProjects\\Py-DBT-IDX\\logs', 'profiles_dir': 'D:\\00 Project\\00 My Project\\IdeaProjects\\Py-DBT-IDX', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt snapshot', 'send_anonymous_usage_stats': 'False'}
[0m17:58:58.797992 [info ] [MainThread]: Registered adapter: postgres=1.6.1
[0m17:58:58.810563 [debug] [MainThread]: checksum: efe19d9f5b93d1a98cc804fbfcdb6b3aced98b974af664946fee1cde8837deb7, vars: {}, profile: , target: , version: 1.6.1
[0m17:58:58.973765 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 4 files added, 1 files changed.
[0m17:58:58.974767 [debug] [MainThread]: Partial parsing: added file: dbt_idx://models\marts\marketing\customer_orders_status.sql
[0m17:58:58.976281 [debug] [MainThread]: Partial parsing: added file: dbt_idx://tests\assert_customer_dimension_has_no_row_loss.sql.sql
[0m17:58:58.977288 [debug] [MainThread]: Partial parsing: added file: dbt_idx://models\staging\stg_eltool.yml
[0m17:58:58.977288 [debug] [MainThread]: Partial parsing: added file: dbt_idx://models\marts\marketing\marketing.yml
[0m17:58:58.978287 [debug] [MainThread]: Partial parsing: updated file: dbt_idx://models\marts\core\dim_customers.sql
[0m17:58:59.135212 [info ] [MainThread]: Found 6 models, 1 snapshot, 9 tests, 3 sources, 0 exposures, 0 metrics, 349 macros, 0 groups, 0 semantic models
[0m17:58:59.137660 [info ] [MainThread]: 
[0m17:58:59.139666 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m17:58:59.141622 [debug] [ThreadPool]: Acquiring new postgres connection 'list_IDX-Stock'
[0m17:58:59.153140 [debug] [ThreadPool]: Using postgres connection "list_IDX-Stock"
[0m17:58:59.154143 [debug] [ThreadPool]: On list_IDX-Stock: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "connection_name": "list_IDX-Stock"} */

    select distinct nspname from pg_namespace
  
[0m17:58:59.155141 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:58:59.200895 [debug] [ThreadPool]: SQL status: SELECT 11 in 0.0 seconds
[0m17:58:59.202943 [debug] [ThreadPool]: On list_IDX-Stock: Close
[0m17:58:59.206409 [debug] [ThreadPool]: Acquiring new postgres connection 'list_IDX-Stock_warehouse'
[0m17:58:59.219016 [debug] [ThreadPool]: Using postgres connection "list_IDX-Stock_warehouse"
[0m17:58:59.219016 [debug] [ThreadPool]: On list_IDX-Stock_warehouse: BEGIN
[0m17:58:59.220091 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:58:59.246116 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m17:58:59.248209 [debug] [ThreadPool]: Using postgres connection "list_IDX-Stock_warehouse"
[0m17:58:59.249155 [debug] [ThreadPool]: On list_IDX-Stock_warehouse: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "connection_name": "list_IDX-Stock_warehouse"} */
select
      'IDX-Stock' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'warehouse'
    union all
    select
      'IDX-Stock' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'warehouse'
    union all
    select
      'IDX-Stock' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'warehouse'
  
[0m17:58:59.257726 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.0 seconds
[0m17:58:59.259735 [debug] [ThreadPool]: On list_IDX-Stock_warehouse: ROLLBACK
[0m17:58:59.262763 [debug] [ThreadPool]: On list_IDX-Stock_warehouse: Close
[0m17:58:59.264730 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_IDX-Stock_warehouse, now list_IDX-Stock_snapshots)
[0m17:58:59.269283 [debug] [ThreadPool]: Using postgres connection "list_IDX-Stock_snapshots"
[0m17:58:59.270307 [debug] [ThreadPool]: On list_IDX-Stock_snapshots: BEGIN
[0m17:58:59.271285 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:58:59.296933 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m17:58:59.297943 [debug] [ThreadPool]: Using postgres connection "list_IDX-Stock_snapshots"
[0m17:58:59.298921 [debug] [ThreadPool]: On list_IDX-Stock_snapshots: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "connection_name": "list_IDX-Stock_snapshots"} */
select
      'IDX-Stock' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'snapshots'
    union all
    select
      'IDX-Stock' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'snapshots'
    union all
    select
      'IDX-Stock' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'snapshots'
  
[0m17:58:59.304217 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.0 seconds
[0m17:58:59.305868 [debug] [ThreadPool]: On list_IDX-Stock_snapshots: ROLLBACK
[0m17:58:59.308804 [debug] [ThreadPool]: On list_IDX-Stock_snapshots: Close
[0m17:58:59.317365 [debug] [MainThread]: Using postgres connection "master"
[0m17:58:59.318366 [debug] [MainThread]: On master: BEGIN
[0m17:58:59.319368 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:58:59.342240 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m17:58:59.343273 [debug] [MainThread]: Using postgres connection "master"
[0m17:58:59.344266 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m17:58:59.352068 [debug] [MainThread]: SQL status: SELECT 0 in 0.0 seconds
[0m17:58:59.354117 [debug] [MainThread]: On master: ROLLBACK
[0m17:58:59.356103 [debug] [MainThread]: Using postgres connection "master"
[0m17:58:59.357365 [debug] [MainThread]: On master: BEGIN
[0m17:58:59.361348 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m17:58:59.362366 [debug] [MainThread]: On master: COMMIT
[0m17:58:59.363375 [debug] [MainThread]: Using postgres connection "master"
[0m17:58:59.363375 [debug] [MainThread]: On master: COMMIT
[0m17:58:59.365925 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m17:58:59.365925 [debug] [MainThread]: On master: Close
[0m17:58:59.367883 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:58:59.369902 [info ] [MainThread]: 
[0m17:58:59.374882 [debug] [Thread-1 (]: Began running node snapshot.dbt_idx.customers_snapshot
[0m17:58:59.375883 [info ] [Thread-1 (]: 1 of 1 START snapshot snapshots.customers_snapshot ............................. [RUN]
[0m17:58:59.376982 [debug] [Thread-1 (]: Acquiring new postgres connection 'snapshot.dbt_idx.customers_snapshot'
[0m17:58:59.377983 [debug] [Thread-1 (]: Began compiling node snapshot.dbt_idx.customers_snapshot
[0m17:58:59.387502 [debug] [Thread-1 (]: Timing info for snapshot.dbt_idx.customers_snapshot (compile): 17:58:59.378989 => 17:58:59.387502
[0m17:58:59.388507 [debug] [Thread-1 (]: Began executing node snapshot.dbt_idx.customers_snapshot
[0m17:58:59.438222 [debug] [Thread-1 (]: Using postgres connection "snapshot.dbt_idx.customers_snapshot"
[0m17:58:59.439246 [debug] [Thread-1 (]: On snapshot.dbt_idx.customers_snapshot: BEGIN
[0m17:58:59.440255 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m17:58:59.462976 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m17:58:59.463951 [debug] [Thread-1 (]: Using postgres connection "snapshot.dbt_idx.customers_snapshot"
[0m17:58:59.464966 [debug] [Thread-1 (]: On snapshot.dbt_idx.customers_snapshot: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "snapshot.dbt_idx.customers_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "IDX-Stock".INFORMATION_SCHEMA.columns
      where table_name = 'customers_snapshot'
        
        and table_schema = 'snapshots'
        
      order by ordinal_position

  
[0m17:58:59.489131 [debug] [Thread-1 (]: SQL status: SELECT 10 in 0.0 seconds
[0m17:58:59.519019 [debug] [Thread-1 (]: Using postgres connection "snapshot.dbt_idx.customers_snapshot"
[0m17:58:59.520024 [debug] [Thread-1 (]: On snapshot.dbt_idx.customers_snapshot: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "snapshot.dbt_idx.customers_snapshot"} */

        
  
    

  create temporary table "customers_snapshot__dbt_tmp175859505971"
  
  
    as
  
  (
    with snapshot_query as (

        



select *
from "IDX-Stock"."warehouse"."customers"


    ),

    snapshotted_data as (

        select *,
            customer_id as dbt_unique_key

        from "IDX-Stock"."snapshots"."customers_snapshot"
        where dbt_valid_to is null

    ),

    insertions_source_data as (

        select
            *,
            customer_id as dbt_unique_key,
            datetime_updated as dbt_updated_at,
            datetime_updated as dbt_valid_from,
            nullif(datetime_updated, datetime_updated) as dbt_valid_to,
            md5(coalesce(cast(customer_id as varchar ), '')
         || '|' || coalesce(cast(datetime_updated as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select
            *,
            customer_id as dbt_unique_key,
            datetime_updated as dbt_updated_at,
            datetime_updated as dbt_valid_from,
            datetime_updated as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where snapshotted_data.dbt_unique_key is null
           or (
                snapshotted_data.dbt_unique_key is not null
            and (
                (snapshotted_data.dbt_valid_from < source_data.datetime_updated)
            )
        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where (
            (snapshotted_data.dbt_valid_from < source_data.datetime_updated)
        )
    )

    select * from insertions
    union all
    select * from updates

  );
  
    
[0m17:58:59.532673 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.0 seconds
[0m17:58:59.536277 [debug] [Thread-1 (]: Using postgres connection "snapshot.dbt_idx.customers_snapshot"
[0m17:58:59.537224 [debug] [Thread-1 (]: On snapshot.dbt_idx.customers_snapshot: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "snapshot.dbt_idx.customers_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'customers_snapshot__dbt_tmp175859505971'
        
      order by ordinal_position

  
[0m17:58:59.541883 [debug] [Thread-1 (]: SQL status: SELECT 12 in 0.0 seconds
[0m17:58:59.545876 [debug] [Thread-1 (]: Using postgres connection "snapshot.dbt_idx.customers_snapshot"
[0m17:58:59.546382 [debug] [Thread-1 (]: On snapshot.dbt_idx.customers_snapshot: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "snapshot.dbt_idx.customers_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "IDX-Stock".INFORMATION_SCHEMA.columns
      where table_name = 'customers_snapshot'
        
        and table_schema = 'snapshots'
        
      order by ordinal_position

  
[0m17:58:59.550394 [debug] [Thread-1 (]: SQL status: SELECT 10 in 0.0 seconds
[0m17:58:59.556907 [debug] [Thread-1 (]: Using postgres connection "snapshot.dbt_idx.customers_snapshot"
[0m17:58:59.557908 [debug] [Thread-1 (]: On snapshot.dbt_idx.customers_snapshot: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "snapshot.dbt_idx.customers_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'customers_snapshot__dbt_tmp175859505971'
        
      order by ordinal_position

  
[0m17:58:59.562907 [debug] [Thread-1 (]: SQL status: SELECT 12 in 0.0 seconds
[0m17:58:59.566411 [debug] [Thread-1 (]: Using postgres connection "snapshot.dbt_idx.customers_snapshot"
[0m17:58:59.566411 [debug] [Thread-1 (]: On snapshot.dbt_idx.customers_snapshot: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "snapshot.dbt_idx.customers_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "IDX-Stock".INFORMATION_SCHEMA.columns
      where table_name = 'customers_snapshot'
        
        and table_schema = 'snapshots'
        
      order by ordinal_position

  
[0m17:58:59.571425 [debug] [Thread-1 (]: SQL status: SELECT 10 in 0.0 seconds
[0m17:58:59.579942 [debug] [Thread-1 (]: Using postgres connection "snapshot.dbt_idx.customers_snapshot"
[0m17:58:59.581942 [debug] [Thread-1 (]: On snapshot.dbt_idx.customers_snapshot: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "snapshot.dbt_idx.customers_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'customers_snapshot__dbt_tmp175859505971'
        
      order by ordinal_position

  
[0m17:58:59.586464 [debug] [Thread-1 (]: SQL status: SELECT 12 in 0.0 seconds
[0m17:58:59.596487 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.dbt_idx.customers_snapshot"
[0m17:58:59.611028 [debug] [Thread-1 (]: Using postgres connection "snapshot.dbt_idx.customers_snapshot"
[0m17:58:59.612052 [debug] [Thread-1 (]: On snapshot.dbt_idx.customers_snapshot: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "snapshot.dbt_idx.customers_snapshot"} */

      update "IDX-Stock"."snapshots"."customers_snapshot"
    set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to
    from "customers_snapshot__dbt_tmp175859505971" as DBT_INTERNAL_SOURCE
    where DBT_INTERNAL_SOURCE.dbt_scd_id::text = "IDX-Stock"."snapshots"."customers_snapshot".dbt_scd_id::text
      and DBT_INTERNAL_SOURCE.dbt_change_type::text in ('update'::text, 'delete'::text)
      and "IDX-Stock"."snapshots"."customers_snapshot".dbt_valid_to is null;

    insert into "IDX-Stock"."snapshots"."customers_snapshot" ("customer_id", "zipcode", "city", "state_code", "datetime_created", "datetime_updated", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id")
    select DBT_INTERNAL_SOURCE."customer_id",DBT_INTERNAL_SOURCE."zipcode",DBT_INTERNAL_SOURCE."city",DBT_INTERNAL_SOURCE."state_code",DBT_INTERNAL_SOURCE."datetime_created",DBT_INTERNAL_SOURCE."datetime_updated",DBT_INTERNAL_SOURCE."dbt_updated_at",DBT_INTERNAL_SOURCE."dbt_valid_from",DBT_INTERNAL_SOURCE."dbt_valid_to",DBT_INTERNAL_SOURCE."dbt_scd_id"
    from "customers_snapshot__dbt_tmp175859505971" as DBT_INTERNAL_SOURCE
    where DBT_INTERNAL_SOURCE.dbt_change_type::text = 'insert'::text;

  
[0m17:58:59.616024 [debug] [Thread-1 (]: SQL status: INSERT 0 0 in 0.0 seconds
[0m17:58:59.634688 [debug] [Thread-1 (]: On snapshot.dbt_idx.customers_snapshot: COMMIT
[0m17:58:59.636198 [debug] [Thread-1 (]: Using postgres connection "snapshot.dbt_idx.customers_snapshot"
[0m17:58:59.637723 [debug] [Thread-1 (]: On snapshot.dbt_idx.customers_snapshot: COMMIT
[0m17:58:59.640748 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m17:58:59.644748 [debug] [Thread-1 (]: Timing info for snapshot.dbt_idx.customers_snapshot (execute): 17:58:59.389507 => 17:58:59.644748
[0m17:58:59.645749 [debug] [Thread-1 (]: On snapshot.dbt_idx.customers_snapshot: Close
[0m17:58:59.649242 [info ] [Thread-1 (]: 1 of 1 OK snapshotted snapshots.customers_snapshot ............................. [[32msuccess[0m in 0.27s]
[0m17:58:59.652226 [debug] [Thread-1 (]: Finished running node snapshot.dbt_idx.customers_snapshot
[0m17:58:59.655752 [debug] [MainThread]: Using postgres connection "master"
[0m17:58:59.656761 [debug] [MainThread]: On master: BEGIN
[0m17:58:59.657759 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:58:59.684353 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m17:58:59.685922 [debug] [MainThread]: On master: COMMIT
[0m17:58:59.686871 [debug] [MainThread]: Using postgres connection "master"
[0m17:58:59.686871 [debug] [MainThread]: On master: COMMIT
[0m17:58:59.689885 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m17:58:59.690869 [debug] [MainThread]: On master: Close
[0m17:58:59.691892 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:58:59.692870 [debug] [MainThread]: Connection 'list_IDX-Stock' was properly closed.
[0m17:58:59.694397 [debug] [MainThread]: Connection 'list_IDX-Stock_snapshots' was properly closed.
[0m17:58:59.695914 [debug] [MainThread]: Connection 'snapshot.dbt_idx.customers_snapshot' was properly closed.
[0m17:58:59.696920 [info ] [MainThread]: 
[0m17:58:59.698921 [info ] [MainThread]: Finished running 1 snapshot in 0 hours 0 minutes and 0.56 seconds (0.56s).
[0m17:58:59.699944 [debug] [MainThread]: Command end result
[0m17:58:59.728228 [info ] [MainThread]: 
[0m17:58:59.730220 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:58:59.731234 [info ] [MainThread]: 
[0m17:58:59.733781 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m17:58:59.734769 [debug] [MainThread]: Command `dbt snapshot` succeeded at 17:58:59.734769 after 1.14 seconds
[0m17:58:59.736315 [debug] [MainThread]: Flushing usage events


============================== 17:59:15.631738 | b724f3e8-cca3-49e4-a68c-82e980ea9fbd ==============================
[0m17:59:15.631738 [info ] [MainThread]: Running with dbt=1.6.1
[0m17:59:15.638860 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'D:\\00 Project\\00 My Project\\IdeaProjects\\Py-DBT-IDX\\logs', 'debug': 'False', 'profiles_dir': 'D:\\00 Project\\00 My Project\\IdeaProjects\\Py-DBT-IDX', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'False'}
[0m17:59:15.810646 [info ] [MainThread]: Registered adapter: postgres=1.6.1
[0m17:59:15.827952 [debug] [MainThread]: checksum: efe19d9f5b93d1a98cc804fbfcdb6b3aced98b974af664946fee1cde8837deb7, vars: {}, profile: , target: , version: 1.6.1
[0m17:59:16.014622 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:59:16.016133 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:59:16.073848 [info ] [MainThread]: Found 6 models, 1 snapshot, 9 tests, 3 sources, 0 exposures, 0 metrics, 349 macros, 0 groups, 0 semantic models
[0m17:59:16.077325 [info ] [MainThread]: 
[0m17:59:16.079331 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m17:59:16.083368 [debug] [ThreadPool]: Acquiring new postgres connection 'list_IDX-Stock'
[0m17:59:16.097524 [debug] [ThreadPool]: Using postgres connection "list_IDX-Stock"
[0m17:59:16.098544 [debug] [ThreadPool]: On list_IDX-Stock: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "connection_name": "list_IDX-Stock"} */

    select distinct nspname from pg_namespace
  
[0m17:59:16.101527 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:59:16.138968 [debug] [ThreadPool]: SQL status: SELECT 13 in 0.0 seconds
[0m17:59:16.141009 [debug] [ThreadPool]: On list_IDX-Stock: Close
[0m17:59:16.145376 [debug] [ThreadPool]: Acquiring new postgres connection 'list_IDX-Stock_snapshots'
[0m17:59:16.154769 [debug] [ThreadPool]: Using postgres connection "list_IDX-Stock_snapshots"
[0m17:59:16.155769 [debug] [ThreadPool]: On list_IDX-Stock_snapshots: BEGIN
[0m17:59:16.156867 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:59:16.186133 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m17:59:16.188140 [debug] [ThreadPool]: Using postgres connection "list_IDX-Stock_snapshots"
[0m17:59:16.189142 [debug] [ThreadPool]: On list_IDX-Stock_snapshots: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "connection_name": "list_IDX-Stock_snapshots"} */
select
      'IDX-Stock' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'snapshots'
    union all
    select
      'IDX-Stock' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'snapshots'
    union all
    select
      'IDX-Stock' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'snapshots'
  
[0m17:59:16.194138 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.0 seconds
[0m17:59:16.195722 [debug] [ThreadPool]: On list_IDX-Stock_snapshots: ROLLBACK
[0m17:59:16.199279 [debug] [ThreadPool]: On list_IDX-Stock_snapshots: Close
[0m17:59:16.202301 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_IDX-Stock_snapshots, now list_IDX-Stock_warehouse)
[0m17:59:16.205817 [debug] [ThreadPool]: Using postgres connection "list_IDX-Stock_warehouse"
[0m17:59:16.206860 [debug] [ThreadPool]: On list_IDX-Stock_warehouse: BEGIN
[0m17:59:16.207857 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:59:16.233221 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m17:59:16.234752 [debug] [ThreadPool]: Using postgres connection "list_IDX-Stock_warehouse"
[0m17:59:16.234752 [debug] [ThreadPool]: On list_IDX-Stock_warehouse: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "connection_name": "list_IDX-Stock_warehouse"} */
select
      'IDX-Stock' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'warehouse'
    union all
    select
      'IDX-Stock' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'warehouse'
    union all
    select
      'IDX-Stock' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'warehouse'
  
[0m17:59:16.240835 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.0 seconds
[0m17:59:16.242845 [debug] [ThreadPool]: On list_IDX-Stock_warehouse: ROLLBACK
[0m17:59:16.246335 [debug] [ThreadPool]: On list_IDX-Stock_warehouse: Close
[0m17:59:16.258963 [debug] [MainThread]: Using postgres connection "master"
[0m17:59:16.261000 [debug] [MainThread]: On master: BEGIN
[0m17:59:16.261976 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:59:16.289680 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m17:59:16.292221 [debug] [MainThread]: Using postgres connection "master"
[0m17:59:16.294766 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m17:59:16.305816 [debug] [MainThread]: SQL status: SELECT 0 in 0.0 seconds
[0m17:59:16.308360 [debug] [MainThread]: On master: ROLLBACK
[0m17:59:16.311852 [debug] [MainThread]: Using postgres connection "master"
[0m17:59:16.312843 [debug] [MainThread]: On master: BEGIN
[0m17:59:16.316805 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m17:59:16.318809 [debug] [MainThread]: On master: COMMIT
[0m17:59:16.319811 [debug] [MainThread]: Using postgres connection "master"
[0m17:59:16.321828 [debug] [MainThread]: On master: COMMIT
[0m17:59:16.324810 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m17:59:16.325841 [debug] [MainThread]: On master: Close
[0m17:59:16.328064 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:59:16.329593 [info ] [MainThread]: 
[0m17:59:16.336106 [debug] [Thread-1 (]: Began running node model.dbt_idx.stg_eltool__customers
[0m17:59:16.337472 [info ] [Thread-1 (]: 1 of 6 START sql view model warehouse.stg_eltool__customers .................... [RUN]
[0m17:59:16.339472 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.dbt_idx.stg_eltool__customers'
[0m17:59:16.341488 [debug] [Thread-1 (]: Began compiling node model.dbt_idx.stg_eltool__customers
[0m17:59:16.354524 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_idx.stg_eltool__customers"
[0m17:59:16.362582 [debug] [Thread-1 (]: Timing info for model.dbt_idx.stg_eltool__customers (compile): 17:59:16.342472 => 17:59:16.361069
[0m17:59:16.364597 [debug] [Thread-1 (]: Began executing node model.dbt_idx.stg_eltool__customers
[0m17:59:16.413400 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_idx.stg_eltool__customers"
[0m17:59:16.420111 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__customers"
[0m17:59:16.422111 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__customers: BEGIN
[0m17:59:16.423111 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m17:59:16.451935 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m17:59:16.453446 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__customers"
[0m17:59:16.454484 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__customers: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__customers"} */

  create view "IDX-Stock"."warehouse"."stg_eltool__customers__dbt_tmp"
    
    
  as (
    with source as (select *
                from "IDX-Stock"."snapshots"."customers_snapshot"),
     renamed as (select customer_id,
                        zipcode,
                        city,
                        state_code,
                        datetime_created::TIMESTAMP AS datetime_created,
                        datetime_updated::TIMESTAMP AS datetime_updated,
                        dbt_valid_from,
                        dbt_valid_to
                 from source)
select *
from renamed
  );
[0m17:59:16.468540 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m17:59:16.478716 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__customers"
[0m17:59:16.479716 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__customers: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__customers"} */
alter table "IDX-Stock"."warehouse"."stg_eltool__customers__dbt_tmp" rename to "stg_eltool__customers"
[0m17:59:16.483716 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m17:59:16.501266 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__customers: COMMIT
[0m17:59:16.502267 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__customers"
[0m17:59:16.502267 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__customers: COMMIT
[0m17:59:16.506819 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m17:59:16.517335 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__customers"
[0m17:59:16.518347 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__customers: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__customers"} */
drop view if exists "IDX-Stock"."warehouse"."stg_eltool__customers__dbt_backup" cascade
[0m17:59:16.521862 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m17:59:16.524896 [debug] [Thread-1 (]: Timing info for model.dbt_idx.stg_eltool__customers (execute): 17:59:16.364597 => 17:59:16.523884
[0m17:59:16.524896 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__customers: Close
[0m17:59:16.527398 [info ] [Thread-1 (]: 1 of 6 OK created sql view model warehouse.stg_eltool__customers ............... [[32mCREATE VIEW[0m in 0.19s]
[0m17:59:16.530413 [debug] [Thread-1 (]: Finished running node model.dbt_idx.stg_eltool__customers
[0m17:59:16.532405 [debug] [Thread-1 (]: Began running node model.dbt_idx.stg_eltool__orders
[0m17:59:16.534420 [info ] [Thread-1 (]: 2 of 6 START sql view model warehouse.stg_eltool__orders ....................... [RUN]
[0m17:59:16.536954 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_idx.stg_eltool__customers, now model.dbt_idx.stg_eltool__orders)
[0m17:59:16.537971 [debug] [Thread-1 (]: Began compiling node model.dbt_idx.stg_eltool__orders
[0m17:59:16.544491 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_idx.stg_eltool__orders"
[0m17:59:16.557152 [debug] [Thread-1 (]: Timing info for model.dbt_idx.stg_eltool__orders (compile): 17:59:16.538954 => 17:59:16.556135
[0m17:59:16.558151 [debug] [Thread-1 (]: Began executing node model.dbt_idx.stg_eltool__orders
[0m17:59:16.569239 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_idx.stg_eltool__orders"
[0m17:59:16.579832 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__orders"
[0m17:59:16.580834 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__orders: BEGIN
[0m17:59:16.583859 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:59:16.613629 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m17:59:16.614671 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__orders"
[0m17:59:16.615799 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__orders: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__orders"} */

  create view "IDX-Stock"."warehouse"."stg_eltool__orders__dbt_tmp"
    
    
  as (
    with source as (select *
                from "IDX-Stock"."warehouse"."orders"),
     renamed as (select order_id,
                        cust_id AS customer_id,
                        order_status,
                        order_purchase_timestamp::TIMESTAMP,
                        order_approved_at::TIMESTAMP,
                        order_delivered_carrier_date::TIMESTAMP,
                        order_delivered_customer_date::TIMESTAMP,
                        order_estimated_delivery_date::TIMESTAMP
                 from source)
select *
from renamed
  );
[0m17:59:16.620742 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m17:59:16.624761 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__orders"
[0m17:59:16.625745 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__orders: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__orders"} */
alter table "IDX-Stock"."warehouse"."stg_eltool__orders__dbt_tmp" rename to "stg_eltool__orders"
[0m17:59:16.629309 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m17:59:16.632315 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__orders: COMMIT
[0m17:59:16.633326 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__orders"
[0m17:59:16.634334 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__orders: COMMIT
[0m17:59:16.637889 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m17:59:16.642918 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__orders"
[0m17:59:16.642918 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__orders: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__orders"} */
drop view if exists "IDX-Stock"."warehouse"."stg_eltool__orders__dbt_backup" cascade
[0m17:59:16.647008 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m17:59:16.649017 [debug] [Thread-1 (]: Timing info for model.dbt_idx.stg_eltool__orders (execute): 17:59:16.559150 => 17:59:16.649017
[0m17:59:16.650022 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__orders: Close
[0m17:59:16.653035 [info ] [Thread-1 (]: 2 of 6 OK created sql view model warehouse.stg_eltool__orders .................. [[32mCREATE VIEW[0m in 0.12s]
[0m17:59:16.656089 [debug] [Thread-1 (]: Finished running node model.dbt_idx.stg_eltool__orders
[0m17:59:16.658100 [debug] [Thread-1 (]: Began running node model.dbt_idx.stg_eltool__state
[0m17:59:16.660691 [info ] [Thread-1 (]: 3 of 6 START sql view model warehouse.stg_eltool__state ........................ [RUN]
[0m17:59:16.662619 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_idx.stg_eltool__orders, now model.dbt_idx.stg_eltool__state)
[0m17:59:16.663619 [debug] [Thread-1 (]: Began compiling node model.dbt_idx.stg_eltool__state
[0m17:59:16.669162 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_idx.stg_eltool__state"
[0m17:59:16.674716 [debug] [Thread-1 (]: Timing info for model.dbt_idx.stg_eltool__state (compile): 17:59:16.663619 => 17:59:16.674716
[0m17:59:16.675716 [debug] [Thread-1 (]: Began executing node model.dbt_idx.stg_eltool__state
[0m17:59:16.684578 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_idx.stg_eltool__state"
[0m17:59:16.691097 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__state"
[0m17:59:16.693091 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__state: BEGIN
[0m17:59:16.693091 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:59:16.722634 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m17:59:16.723636 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__state"
[0m17:59:16.724634 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__state: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__state"} */

  create view "IDX-Stock"."warehouse"."stg_eltool__state__dbt_tmp"
    
    
  as (
    with source as (select *
                from "IDX-Stock"."warehouse"."state"),
     renamed as (select state_identifier::INT AS state_id,
                         state_code::VARCHAR(2) AS state_code,
                         st_name::VARCHAR(30) AS state_name
                 from source)
select *
from renamed
  );
[0m17:59:16.729180 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m17:59:16.733165 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__state"
[0m17:59:16.734194 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__state: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__state"} */
alter table "IDX-Stock"."warehouse"."stg_eltool__state__dbt_tmp" rename to "stg_eltool__state"
[0m17:59:16.736711 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m17:59:16.740221 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__state: COMMIT
[0m17:59:16.741223 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__state"
[0m17:59:16.742221 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__state: COMMIT
[0m17:59:16.746269 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m17:59:16.750283 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__state"
[0m17:59:16.751279 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__state: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__state"} */
drop view if exists "IDX-Stock"."warehouse"."stg_eltool__state__dbt_backup" cascade
[0m17:59:16.754287 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m17:59:16.758850 [debug] [Thread-1 (]: Timing info for model.dbt_idx.stg_eltool__state (execute): 17:59:16.677067 => 17:59:16.757850
[0m17:59:16.759853 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__state: Close
[0m17:59:16.763439 [info ] [Thread-1 (]: 3 of 6 OK created sql view model warehouse.stg_eltool__state ................... [[32mCREATE VIEW[0m in 0.10s]
[0m17:59:16.766498 [debug] [Thread-1 (]: Finished running node model.dbt_idx.stg_eltool__state
[0m17:59:16.768513 [debug] [Thread-1 (]: Began running node model.dbt_idx.fct_orders
[0m17:59:16.770767 [info ] [Thread-1 (]: 4 of 6 START sql table model warehouse.fct_orders .............................. [RUN]
[0m17:59:16.773288 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_idx.stg_eltool__state, now model.dbt_idx.fct_orders)
[0m17:59:16.774799 [debug] [Thread-1 (]: Began compiling node model.dbt_idx.fct_orders
[0m17:59:16.779564 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_idx.fct_orders"
[0m17:59:16.786197 [debug] [Thread-1 (]: Timing info for model.dbt_idx.fct_orders (compile): 17:59:16.774799 => 17:59:16.784577
[0m17:59:16.787097 [debug] [Thread-1 (]: Began executing node model.dbt_idx.fct_orders
[0m17:59:16.821201 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_idx.fct_orders"
[0m17:59:16.826733 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.fct_orders"
[0m17:59:16.827918 [debug] [Thread-1 (]: On model.dbt_idx.fct_orders: BEGIN
[0m17:59:16.828932 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:59:16.854847 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m17:59:16.856339 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.fct_orders"
[0m17:59:16.857347 [debug] [Thread-1 (]: On model.dbt_idx.fct_orders: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.fct_orders"} */

  
    

  create  table "IDX-Stock"."warehouse"."fct_orders__dbt_tmp"
  
  
    as
  
  (
    with orders as (
    select *
    from "IDX-Stock"."warehouse"."stg_eltool__orders"
)
select * from orders
  );
  
[0m17:59:16.870925 [debug] [Thread-1 (]: SQL status: SELECT 999 in 0.0 seconds
[0m17:59:16.878714 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.fct_orders"
[0m17:59:16.879715 [debug] [Thread-1 (]: On model.dbt_idx.fct_orders: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.fct_orders"} */
alter table "IDX-Stock"."warehouse"."fct_orders__dbt_tmp" rename to "fct_orders"
[0m17:59:16.883721 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m17:59:16.894464 [debug] [Thread-1 (]: On model.dbt_idx.fct_orders: COMMIT
[0m17:59:16.896984 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.fct_orders"
[0m17:59:16.898996 [debug] [Thread-1 (]: On model.dbt_idx.fct_orders: COMMIT
[0m17:59:16.903996 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m17:59:16.912681 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.fct_orders"
[0m17:59:16.913672 [debug] [Thread-1 (]: On model.dbt_idx.fct_orders: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.fct_orders"} */
drop table if exists "IDX-Stock"."warehouse"."fct_orders__dbt_backup" cascade
[0m17:59:16.916818 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m17:59:16.919831 [debug] [Thread-1 (]: Timing info for model.dbt_idx.fct_orders (execute): 17:59:16.788096 => 17:59:16.919831
[0m17:59:16.920826 [debug] [Thread-1 (]: On model.dbt_idx.fct_orders: Close
[0m17:59:16.923829 [info ] [Thread-1 (]: 4 of 6 OK created sql table model warehouse.fct_orders ......................... [[32mSELECT 999[0m in 0.15s]
[0m17:59:16.925829 [debug] [Thread-1 (]: Finished running node model.dbt_idx.fct_orders
[0m17:59:16.927369 [debug] [Thread-1 (]: Began running node model.dbt_idx.dim_customers
[0m17:59:16.928361 [info ] [Thread-1 (]: 5 of 6 START sql table model warehouse.dim_customers ........................... [RUN]
[0m17:59:16.930362 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_idx.fct_orders, now model.dbt_idx.dim_customers)
[0m17:59:16.931364 [debug] [Thread-1 (]: Began compiling node model.dbt_idx.dim_customers
[0m17:59:16.935908 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_idx.dim_customers"
[0m17:59:16.940916 [debug] [Thread-1 (]: Timing info for model.dbt_idx.dim_customers (compile): 17:59:16.932364 => 17:59:16.939920
[0m17:59:16.942425 [debug] [Thread-1 (]: Began executing node model.dbt_idx.dim_customers
[0m17:59:16.950098 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_idx.dim_customers"
[0m17:59:16.957152 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.dim_customers"
[0m17:59:16.959171 [debug] [Thread-1 (]: On model.dbt_idx.dim_customers: BEGIN
[0m17:59:16.960175 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:59:16.992825 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m17:59:16.994332 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.dim_customers"
[0m17:59:16.995938 [debug] [Thread-1 (]: On model.dbt_idx.dim_customers: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.dim_customers"} */

  
    

  create  table "IDX-Stock"."warehouse"."dim_customers__dbt_tmp"
  
  
    as
  
  (
    -- noinspection SqlDialectInspectionForFile

with customers as (
    select *
    from "IDX-Stock"."warehouse"."stg_eltool__customers"
    ),
     state as (
         select *
         from "IDX-Stock"."warehouse"."stg_eltool__state"
     )
select c.customer_id,
       c.zipcode,
       c.city,
       c.state_code,
       s.state_name,
       c.datetime_created,
       c.datetime_updated,
       c.dbt_valid_from::TIMESTAMP as valid_from,
        CASE WHEN c.dbt_valid_to IS NULL
            THEN '9999-12-31'::TIMESTAMP
            ELSE c.dbt_valid_to::TIMESTAMP
        END as valid_to
from customers c
    join state s on c.state_code = s.state_code
  );
  
[0m17:59:17.002857 [debug] [Thread-1 (]: SQL status: SELECT 105 in 0.0 seconds
[0m17:59:17.006364 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.dim_customers"
[0m17:59:17.007371 [debug] [Thread-1 (]: On model.dbt_idx.dim_customers: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.dim_customers"} */
alter table "IDX-Stock"."warehouse"."dim_customers__dbt_tmp" rename to "dim_customers"
[0m17:59:17.010925 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m17:59:17.013928 [debug] [Thread-1 (]: On model.dbt_idx.dim_customers: COMMIT
[0m17:59:17.014927 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.dim_customers"
[0m17:59:17.016455 [debug] [Thread-1 (]: On model.dbt_idx.dim_customers: COMMIT
[0m17:59:17.020492 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m17:59:17.023486 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.dim_customers"
[0m17:59:17.024487 [debug] [Thread-1 (]: On model.dbt_idx.dim_customers: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.dim_customers"} */
drop table if exists "IDX-Stock"."warehouse"."dim_customers__dbt_backup" cascade
[0m17:59:17.027605 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m17:59:17.030163 [debug] [Thread-1 (]: Timing info for model.dbt_idx.dim_customers (execute): 17:59:16.943435 => 17:59:17.030163
[0m17:59:17.032122 [debug] [Thread-1 (]: On model.dbt_idx.dim_customers: Close
[0m17:59:17.034127 [info ] [Thread-1 (]: 5 of 6 OK created sql table model warehouse.dim_customers ...................... [[32mSELECT 105[0m in 0.10s]
[0m17:59:17.036132 [debug] [Thread-1 (]: Finished running node model.dbt_idx.dim_customers
[0m17:59:17.038375 [debug] [Thread-1 (]: Began running node model.dbt_idx.customer_orders_status
[0m17:59:17.039375 [info ] [Thread-1 (]: 6 of 6 START sql view model warehouse.customer_orders_status ................... [RUN]
[0m17:59:17.041381 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_idx.dim_customers, now model.dbt_idx.customer_orders_status)
[0m17:59:17.042376 [debug] [Thread-1 (]: Began compiling node model.dbt_idx.customer_orders_status
[0m17:59:17.046476 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_idx.customer_orders_status"
[0m17:59:17.051732 [debug] [Thread-1 (]: Timing info for model.dbt_idx.customer_orders_status (compile): 17:59:17.043397 => 17:59:17.051732
[0m17:59:17.052731 [debug] [Thread-1 (]: Began executing node model.dbt_idx.customer_orders_status
[0m17:59:17.059778 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_idx.customer_orders_status"
[0m17:59:17.065789 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.customer_orders_status"
[0m17:59:17.067822 [debug] [Thread-1 (]: On model.dbt_idx.customer_orders_status: BEGIN
[0m17:59:17.068824 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:59:17.100691 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m17:59:17.101705 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.customer_orders_status"
[0m17:59:17.102694 [debug] [Thread-1 (]: On model.dbt_idx.customer_orders_status: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.customer_orders_status"} */

  create view "IDX-Stock"."warehouse"."customer_orders_status__dbt_tmp"
    
    
  as (
    with orders as (select *
                from "IDX-Stock"."warehouse"."fct_orders"),
     customers as (select *
                   from "IDX-Stock"."warehouse"."dim_customers")
select o.order_id,
       o.customer_id,
       o.order_status,
       o.order_purchase_timestamp,
       o.order_approved_at,
       o.order_delivered_carrier_date,
       o.order_delivered_customer_date,
       o.order_estimated_delivery_date,
       c.zipcode    as customer_zipcode,
       c.city       as customer_city,
       c.state_code as customer_state_code,
       c.state_name as customer_state_name
from orders o
    join customers c on o.customer_id = c.customer_id
    and o.order_purchase_timestamp >= c.valid_from
    and o.order_purchase_timestamp <= c.valid_to
  );
[0m17:59:17.107877 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m17:59:17.114767 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.customer_orders_status"
[0m17:59:17.115774 [debug] [Thread-1 (]: On model.dbt_idx.customer_orders_status: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.customer_orders_status"} */
alter table "IDX-Stock"."warehouse"."customer_orders_status__dbt_tmp" rename to "customer_orders_status"
[0m17:59:17.118201 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m17:59:17.122201 [debug] [Thread-1 (]: On model.dbt_idx.customer_orders_status: COMMIT
[0m17:59:17.123199 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.customer_orders_status"
[0m17:59:17.124219 [debug] [Thread-1 (]: On model.dbt_idx.customer_orders_status: COMMIT
[0m17:59:17.129289 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m17:59:17.134636 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.customer_orders_status"
[0m17:59:17.136207 [debug] [Thread-1 (]: On model.dbt_idx.customer_orders_status: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.customer_orders_status"} */
drop view if exists "IDX-Stock"."warehouse"."customer_orders_status__dbt_backup" cascade
[0m17:59:17.139185 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m17:59:17.142176 [debug] [Thread-1 (]: Timing info for model.dbt_idx.customer_orders_status (execute): 17:59:17.054240 => 17:59:17.142176
[0m17:59:17.144177 [debug] [Thread-1 (]: On model.dbt_idx.customer_orders_status: Close
[0m17:59:17.146696 [info ] [Thread-1 (]: 6 of 6 OK created sql view model warehouse.customer_orders_status .............. [[32mCREATE VIEW[0m in 0.10s]
[0m17:59:17.149984 [debug] [Thread-1 (]: Finished running node model.dbt_idx.customer_orders_status
[0m17:59:17.153986 [debug] [MainThread]: Using postgres connection "master"
[0m17:59:17.155990 [debug] [MainThread]: On master: BEGIN
[0m17:59:17.157081 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:59:17.189859 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m17:59:17.191858 [debug] [MainThread]: On master: COMMIT
[0m17:59:17.192863 [debug] [MainThread]: Using postgres connection "master"
[0m17:59:17.193875 [debug] [MainThread]: On master: COMMIT
[0m17:59:17.195700 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m17:59:17.196707 [debug] [MainThread]: On master: Close
[0m17:59:17.198708 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:59:17.201266 [debug] [MainThread]: Connection 'list_IDX-Stock' was properly closed.
[0m17:59:17.203265 [debug] [MainThread]: Connection 'list_IDX-Stock_warehouse' was properly closed.
[0m17:59:17.204264 [debug] [MainThread]: Connection 'model.dbt_idx.customer_orders_status' was properly closed.
[0m17:59:17.205831 [info ] [MainThread]: 
[0m17:59:17.207785 [info ] [MainThread]: Finished running 4 view models, 2 table models in 0 hours 0 minutes and 1.13 seconds (1.13s).
[0m17:59:17.209782 [debug] [MainThread]: Command end result
[0m17:59:17.240886 [info ] [MainThread]: 
[0m17:59:17.242899 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:59:17.243894 [info ] [MainThread]: 
[0m17:59:17.246422 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 TOTAL=6
[0m17:59:17.248536 [debug] [MainThread]: Command `dbt run` succeeded at 17:59:17.248536 after 1.66 seconds
[0m17:59:17.250577 [debug] [MainThread]: Flushing usage events


============================== 18:04:14.148088 | d37ed150-dade-42b7-8d9e-ea7f556a911c ==============================
[0m18:04:14.148088 [info ] [MainThread]: Running with dbt=1.6.1
[0m18:04:14.153492 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'D:\\00 Project\\00 My Project\\IdeaProjects\\Py-DBT-IDX', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': 'D:\\00 Project\\00 My Project\\IdeaProjects\\Py-DBT-IDX\\logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'False'}
[0m18:04:14.291041 [info ] [MainThread]: Registered adapter: postgres=1.6.1
[0m18:04:14.300656 [debug] [MainThread]: checksum: efe19d9f5b93d1a98cc804fbfcdb6b3aced98b974af664946fee1cde8837deb7, vars: {}, profile: , target: , version: 1.6.1
[0m18:04:14.330305 [error] [MainThread]: Encountered an error:
Parsing Error
  The schema file at models\staging\stg_eltool.yml is invalid because the value of 'models' is not a list
[0m18:04:14.332313 [debug] [MainThread]: Command `dbt run` failed at 18:04:14.331311 after 0.22 seconds
[0m18:04:14.333309 [debug] [MainThread]: Flushing usage events


============================== 18:04:26.515256 | dc025216-ed3f-4bc1-900b-c81b449d05d0 ==============================
[0m18:04:26.515256 [info ] [MainThread]: Running with dbt=1.6.1
[0m18:04:26.521285 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'D:\\00 Project\\00 My Project\\IdeaProjects\\Py-DBT-IDX\\logs', 'debug': 'False', 'profiles_dir': 'D:\\00 Project\\00 My Project\\IdeaProjects\\Py-DBT-IDX', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'False'}
[0m18:04:26.657828 [info ] [MainThread]: Registered adapter: postgres=1.6.1
[0m18:04:26.668345 [debug] [MainThread]: checksum: efe19d9f5b93d1a98cc804fbfcdb6b3aced98b974af664946fee1cde8837deb7, vars: {}, profile: , target: , version: 1.6.1
[0m18:04:26.813919 [debug] [MainThread]: Partial parsing enabled: 1 files deleted, 1 files added, 2 files changed.
[0m18:04:26.815427 [debug] [MainThread]: Partial parsing: added file: dbt_idx://models\marts\core\fact_orders.sql
[0m18:04:26.815427 [debug] [MainThread]: Partial parsing: updated file: dbt_idx://models\marts\core\core.yml
[0m18:04:26.816433 [debug] [MainThread]: Partial parsing: updated file: dbt_idx://models\staging\stg_eltool.yml
[0m18:04:26.817440 [debug] [MainThread]: Partial parsing: deleted file: dbt_idx://models\marts\core\fct_orders.sql
[0m18:04:26.895136 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.dbt_idx.customer_orders_status' (models\marts\marketing\customer_orders_status.sql) depends on a node named 'fct_orders' which was not found
[0m18:04:26.897139 [debug] [MainThread]: Command `dbt run` failed at 18:04:26.896092 after 0.43 seconds
[0m18:04:26.897139 [debug] [MainThread]: Flushing usage events


============================== 18:04:56.315504 | dec835f7-2566-4566-a7ca-1ca5d2467f06 ==============================
[0m18:04:56.315504 [info ] [MainThread]: Running with dbt=1.6.1
[0m18:04:56.321504 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'D:\\00 Project\\00 My Project\\IdeaProjects\\Py-DBT-IDX', 'version_check': 'True', 'debug': 'False', 'log_path': 'D:\\00 Project\\00 My Project\\IdeaProjects\\Py-DBT-IDX\\logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'False'}
[0m18:04:56.475799 [info ] [MainThread]: Registered adapter: postgres=1.6.1
[0m18:04:56.492458 [debug] [MainThread]: checksum: efe19d9f5b93d1a98cc804fbfcdb6b3aced98b974af664946fee1cde8837deb7, vars: {}, profile: , target: , version: 1.6.1
[0m18:04:56.677143 [debug] [MainThread]: Partial parsing enabled: 1 files deleted, 1 files added, 3 files changed.
[0m18:04:56.678112 [debug] [MainThread]: Partial parsing: added file: dbt_idx://models\marts\core\fact_orders.sql
[0m18:04:56.679161 [debug] [MainThread]: Partial parsing: updated file: dbt_idx://models\marts\core\core.yml
[0m18:04:56.680113 [debug] [MainThread]: Partial parsing: updated file: dbt_idx://models\staging\stg_eltool.yml
[0m18:04:56.681112 [debug] [MainThread]: Partial parsing: deleted file: dbt_idx://models\marts\core\fct_orders.sql
[0m18:04:56.682127 [debug] [MainThread]: Partial parsing: updated file: dbt_idx://models\marts\marketing\customer_orders_status.sql
[0m18:04:56.880344 [info ] [MainThread]: Found 1 snapshot, 8 tests, 6 models, 3 sources, 0 exposures, 0 metrics, 349 macros, 0 groups, 0 semantic models
[0m18:04:56.883346 [info ] [MainThread]: 
[0m18:04:56.886400 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m18:04:56.890419 [debug] [ThreadPool]: Acquiring new postgres connection 'list_IDX-Stock'
[0m18:04:56.917135 [debug] [ThreadPool]: Using postgres connection "list_IDX-Stock"
[0m18:04:56.918155 [debug] [ThreadPool]: On list_IDX-Stock: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "connection_name": "list_IDX-Stock"} */

    select distinct nspname from pg_namespace
  
[0m18:04:56.919885 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:04:56.957102 [debug] [ThreadPool]: SQL status: SELECT 13 in 0.0 seconds
[0m18:04:56.960127 [debug] [ThreadPool]: On list_IDX-Stock: Close
[0m18:04:56.964619 [debug] [ThreadPool]: Acquiring new postgres connection 'list_IDX-Stock_warehouse'
[0m18:04:56.974674 [debug] [ThreadPool]: Using postgres connection "list_IDX-Stock_warehouse"
[0m18:04:56.975184 [debug] [ThreadPool]: On list_IDX-Stock_warehouse: BEGIN
[0m18:04:56.976192 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:04:57.000285 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m18:04:57.001281 [debug] [ThreadPool]: Using postgres connection "list_IDX-Stock_warehouse"
[0m18:04:57.002275 [debug] [ThreadPool]: On list_IDX-Stock_warehouse: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "connection_name": "list_IDX-Stock_warehouse"} */
select
      'IDX-Stock' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'warehouse'
    union all
    select
      'IDX-Stock' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'warehouse'
    union all
    select
      'IDX-Stock' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'warehouse'
  
[0m18:04:57.007798 [debug] [ThreadPool]: SQL status: SELECT 9 in 0.0 seconds
[0m18:04:57.009797 [debug] [ThreadPool]: On list_IDX-Stock_warehouse: ROLLBACK
[0m18:04:57.012324 [debug] [ThreadPool]: On list_IDX-Stock_warehouse: Close
[0m18:04:57.014924 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_IDX-Stock_warehouse, now list_IDX-Stock_snapshots)
[0m18:04:57.020872 [debug] [ThreadPool]: Using postgres connection "list_IDX-Stock_snapshots"
[0m18:04:57.021872 [debug] [ThreadPool]: On list_IDX-Stock_snapshots: BEGIN
[0m18:04:57.022872 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:04:57.046084 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m18:04:57.048073 [debug] [ThreadPool]: Using postgres connection "list_IDX-Stock_snapshots"
[0m18:04:57.048073 [debug] [ThreadPool]: On list_IDX-Stock_snapshots: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "connection_name": "list_IDX-Stock_snapshots"} */
select
      'IDX-Stock' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'snapshots'
    union all
    select
      'IDX-Stock' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'snapshots'
    union all
    select
      'IDX-Stock' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'snapshots'
  
[0m18:04:57.053088 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.0 seconds
[0m18:04:57.054646 [debug] [ThreadPool]: On list_IDX-Stock_snapshots: ROLLBACK
[0m18:04:57.057176 [debug] [ThreadPool]: On list_IDX-Stock_snapshots: Close
[0m18:04:57.069697 [debug] [MainThread]: Using postgres connection "master"
[0m18:04:57.070695 [debug] [MainThread]: On master: BEGIN
[0m18:04:57.071697 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:04:57.096791 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m18:04:57.097796 [debug] [MainThread]: Using postgres connection "master"
[0m18:04:57.098855 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m18:04:57.107573 [debug] [MainThread]: SQL status: SELECT 5 in 0.0 seconds
[0m18:04:57.111606 [debug] [MainThread]: On master: ROLLBACK
[0m18:04:57.113578 [debug] [MainThread]: Using postgres connection "master"
[0m18:04:57.114603 [debug] [MainThread]: On master: BEGIN
[0m18:04:57.117662 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m18:04:57.118703 [debug] [MainThread]: On master: COMMIT
[0m18:04:57.119673 [debug] [MainThread]: Using postgres connection "master"
[0m18:04:57.120675 [debug] [MainThread]: On master: COMMIT
[0m18:04:57.123678 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m18:04:57.124731 [debug] [MainThread]: On master: Close
[0m18:04:57.128008 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:04:57.129008 [info ] [MainThread]: 
[0m18:04:57.136705 [debug] [Thread-1 (]: Began running node model.dbt_idx.stg_eltool__customers
[0m18:04:57.137733 [info ] [Thread-1 (]: 1 of 6 START sql view model warehouse.stg_eltool__customers .................... [RUN]
[0m18:04:57.139702 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.dbt_idx.stg_eltool__customers'
[0m18:04:57.140719 [debug] [Thread-1 (]: Began compiling node model.dbt_idx.stg_eltool__customers
[0m18:04:57.148319 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_idx.stg_eltool__customers"
[0m18:04:57.156359 [debug] [Thread-1 (]: Timing info for model.dbt_idx.stg_eltool__customers (compile): 18:04:57.141712 => 18:04:57.156359
[0m18:04:57.157368 [debug] [Thread-1 (]: Began executing node model.dbt_idx.stg_eltool__customers
[0m18:04:57.206211 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_idx.stg_eltool__customers"
[0m18:04:57.213245 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__customers"
[0m18:04:57.214821 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__customers: BEGIN
[0m18:04:57.215761 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m18:04:57.244618 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m18:04:57.246762 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__customers"
[0m18:04:57.247763 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__customers: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__customers"} */

  create view "IDX-Stock"."warehouse"."stg_eltool__customers__dbt_tmp"
    
    
  as (
    with source as (select *
                from "IDX-Stock"."snapshots"."customers_snapshot"),
     renamed as (select customer_id,
                        zipcode,
                        city,
                        state_code,
                        datetime_created::TIMESTAMP AS datetime_created,
                        datetime_updated::TIMESTAMP AS datetime_updated,
                        dbt_valid_from,
                        dbt_valid_to
                 from source)
select *
from renamed
  );
[0m18:04:57.259313 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m18:04:57.271890 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__customers"
[0m18:04:57.272906 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__customers: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__customers"} */
alter table "IDX-Stock"."warehouse"."stg_eltool__customers" rename to "stg_eltool__customers__dbt_backup"
[0m18:04:57.276057 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:04:57.281053 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__customers"
[0m18:04:57.282559 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__customers: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__customers"} */
alter table "IDX-Stock"."warehouse"."stg_eltool__customers__dbt_tmp" rename to "stg_eltool__customers"
[0m18:04:57.286094 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:04:57.307103 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__customers: COMMIT
[0m18:04:57.308132 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__customers"
[0m18:04:57.309111 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__customers: COMMIT
[0m18:04:57.313133 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m18:04:57.326776 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__customers"
[0m18:04:57.327743 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__customers: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__customers"} */
drop view if exists "IDX-Stock"."warehouse"."stg_eltool__customers__dbt_backup" cascade
[0m18:04:57.331779 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m18:04:57.334778 [debug] [Thread-1 (]: Timing info for model.dbt_idx.stg_eltool__customers (execute): 18:04:57.158565 => 18:04:57.333754
[0m18:04:57.335332 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__customers: Close
[0m18:04:57.337341 [info ] [Thread-1 (]: 1 of 6 OK created sql view model warehouse.stg_eltool__customers ............... [[32mCREATE VIEW[0m in 0.20s]
[0m18:04:57.339854 [debug] [Thread-1 (]: Finished running node model.dbt_idx.stg_eltool__customers
[0m18:04:57.341896 [debug] [Thread-1 (]: Began running node model.dbt_idx.stg_eltool__orders
[0m18:04:57.343865 [info ] [Thread-1 (]: 2 of 6 START sql view model warehouse.stg_eltool__orders ....................... [RUN]
[0m18:04:57.346317 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_idx.stg_eltool__customers, now model.dbt_idx.stg_eltool__orders)
[0m18:04:57.347299 [debug] [Thread-1 (]: Began compiling node model.dbt_idx.stg_eltool__orders
[0m18:04:57.351301 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_idx.stg_eltool__orders"
[0m18:04:57.363404 [debug] [Thread-1 (]: Timing info for model.dbt_idx.stg_eltool__orders (compile): 18:04:57.348310 => 18:04:57.363404
[0m18:04:57.365047 [debug] [Thread-1 (]: Began executing node model.dbt_idx.stg_eltool__orders
[0m18:04:57.370989 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_idx.stg_eltool__orders"
[0m18:04:57.385496 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__orders"
[0m18:04:57.386598 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__orders: BEGIN
[0m18:04:57.387268 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:04:57.411098 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m18:04:57.412097 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__orders"
[0m18:04:57.412097 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__orders: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__orders"} */

  create view "IDX-Stock"."warehouse"."stg_eltool__orders__dbt_tmp"
    
    
  as (
    with source as (select *
                from "IDX-Stock"."warehouse"."orders"),
     renamed as (select order_id,
                        cust_id AS customer_id,
                        order_status,
                        order_purchase_timestamp::TIMESTAMP,
                        order_approved_at::TIMESTAMP,
                        order_delivered_carrier_date::TIMESTAMP,
                        order_delivered_customer_date::TIMESTAMP,
                        order_estimated_delivery_date::TIMESTAMP
                 from source)
select *
from renamed
  );
[0m18:04:57.417651 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m18:04:57.423208 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__orders"
[0m18:04:57.423208 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__orders: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__orders"} */
alter table "IDX-Stock"."warehouse"."stg_eltool__orders" rename to "stg_eltool__orders__dbt_backup"
[0m18:04:57.426786 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:04:57.431758 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__orders"
[0m18:04:57.432793 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__orders: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__orders"} */
alter table "IDX-Stock"."warehouse"."stg_eltool__orders__dbt_tmp" rename to "stg_eltool__orders"
[0m18:04:57.436008 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:04:57.439044 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__orders: COMMIT
[0m18:04:57.440050 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__orders"
[0m18:04:57.441325 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__orders: COMMIT
[0m18:04:57.446864 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m18:04:57.450873 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__orders"
[0m18:04:57.450873 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__orders: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__orders"} */
drop view if exists "IDX-Stock"."warehouse"."stg_eltool__orders__dbt_backup" cascade
[0m18:04:57.456450 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m18:04:57.458457 [debug] [Thread-1 (]: Timing info for model.dbt_idx.stg_eltool__orders (execute): 18:04:57.365986 => 18:04:57.458457
[0m18:04:57.459478 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__orders: Close
[0m18:04:57.462009 [info ] [Thread-1 (]: 2 of 6 OK created sql view model warehouse.stg_eltool__orders .................. [[32mCREATE VIEW[0m in 0.12s]
[0m18:04:57.463993 [debug] [Thread-1 (]: Finished running node model.dbt_idx.stg_eltool__orders
[0m18:04:57.465501 [debug] [Thread-1 (]: Began running node model.dbt_idx.stg_eltool__state
[0m18:04:57.467524 [info ] [Thread-1 (]: 3 of 6 START sql view model warehouse.stg_eltool__state ........................ [RUN]
[0m18:04:57.469523 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_idx.stg_eltool__orders, now model.dbt_idx.stg_eltool__state)
[0m18:04:57.470523 [debug] [Thread-1 (]: Began compiling node model.dbt_idx.stg_eltool__state
[0m18:04:57.473522 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_idx.stg_eltool__state"
[0m18:04:57.481962 [debug] [Thread-1 (]: Timing info for model.dbt_idx.stg_eltool__state (compile): 18:04:57.470523 => 18:04:57.480998
[0m18:04:57.482467 [debug] [Thread-1 (]: Began executing node model.dbt_idx.stg_eltool__state
[0m18:04:57.490005 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_idx.stg_eltool__state"
[0m18:04:57.498577 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__state"
[0m18:04:57.499593 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__state: BEGIN
[0m18:04:57.501103 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:04:57.526138 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m18:04:57.527114 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__state"
[0m18:04:57.528117 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__state: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__state"} */

  create view "IDX-Stock"."warehouse"."stg_eltool__state__dbt_tmp"
    
    
  as (
    with source as (select *
                from "IDX-Stock"."warehouse"."state"),
     renamed as (select state_identifier::INT AS state_id,
                         state_code::VARCHAR(2) AS state_code,
                         st_name::VARCHAR(30) AS state_name
                 from source)
select *
from renamed
  );
[0m18:04:57.533115 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m18:04:57.539631 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__state"
[0m18:04:57.540638 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__state: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__state"} */
alter table "IDX-Stock"."warehouse"."stg_eltool__state" rename to "stg_eltool__state__dbt_backup"
[0m18:04:57.543890 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:04:57.548082 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__state"
[0m18:04:57.549042 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__state: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__state"} */
alter table "IDX-Stock"."warehouse"."stg_eltool__state__dbt_tmp" rename to "stg_eltool__state"
[0m18:04:57.552044 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:04:57.555622 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__state: COMMIT
[0m18:04:57.556658 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__state"
[0m18:04:57.556658 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__state: COMMIT
[0m18:04:57.560848 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m18:04:57.565859 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__state"
[0m18:04:57.566851 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__state: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__state"} */
drop view if exists "IDX-Stock"."warehouse"."stg_eltool__state__dbt_backup" cascade
[0m18:04:57.572847 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m18:04:57.574854 [debug] [Thread-1 (]: Timing info for model.dbt_idx.stg_eltool__state (execute): 18:04:57.483480 => 18:04:57.574854
[0m18:04:57.576028 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__state: Close
[0m18:04:57.578988 [info ] [Thread-1 (]: 3 of 6 OK created sql view model warehouse.stg_eltool__state ................... [[32mCREATE VIEW[0m in 0.11s]
[0m18:04:57.581992 [debug] [Thread-1 (]: Finished running node model.dbt_idx.stg_eltool__state
[0m18:04:57.582510 [debug] [Thread-1 (]: Began running node model.dbt_idx.fact_orders
[0m18:04:57.583524 [info ] [Thread-1 (]: 4 of 6 START sql table model warehouse.fact_orders ............................. [RUN]
[0m18:04:57.586048 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_idx.stg_eltool__state, now model.dbt_idx.fact_orders)
[0m18:04:57.587058 [debug] [Thread-1 (]: Began compiling node model.dbt_idx.fact_orders
[0m18:04:57.593068 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_idx.fact_orders"
[0m18:04:57.597585 [debug] [Thread-1 (]: Timing info for model.dbt_idx.fact_orders (compile): 18:04:57.588069 => 18:04:57.597585
[0m18:04:57.598581 [debug] [Thread-1 (]: Began executing node model.dbt_idx.fact_orders
[0m18:04:57.638317 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_idx.fact_orders"
[0m18:04:57.643835 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.fact_orders"
[0m18:04:57.644826 [debug] [Thread-1 (]: On model.dbt_idx.fact_orders: BEGIN
[0m18:04:57.645385 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:04:57.671275 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m18:04:57.672302 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.fact_orders"
[0m18:04:57.673302 [debug] [Thread-1 (]: On model.dbt_idx.fact_orders: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.fact_orders"} */

  
    

  create  table "IDX-Stock"."warehouse"."fact_orders__dbt_tmp"
  
  
    as
  
  (
    with orders as (
    select *
    from "IDX-Stock"."warehouse"."stg_eltool__orders"
)
select * from orders
  );
  
[0m18:04:57.683356 [debug] [Thread-1 (]: SQL status: SELECT 999 in 0.0 seconds
[0m18:04:57.686927 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.fact_orders"
[0m18:04:57.687964 [debug] [Thread-1 (]: On model.dbt_idx.fact_orders: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.fact_orders"} */
alter table "IDX-Stock"."warehouse"."fact_orders__dbt_tmp" rename to "fact_orders"
[0m18:04:57.690927 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:04:57.698555 [debug] [Thread-1 (]: On model.dbt_idx.fact_orders: COMMIT
[0m18:04:57.699522 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.fact_orders"
[0m18:04:57.700523 [debug] [Thread-1 (]: On model.dbt_idx.fact_orders: COMMIT
[0m18:04:57.704672 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m18:04:57.711638 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.fact_orders"
[0m18:04:57.712596 [debug] [Thread-1 (]: On model.dbt_idx.fact_orders: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.fact_orders"} */
drop table if exists "IDX-Stock"."warehouse"."fact_orders__dbt_backup" cascade
[0m18:04:57.715717 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m18:04:57.718713 [debug] [Thread-1 (]: Timing info for model.dbt_idx.fact_orders (execute): 18:04:57.599580 => 18:04:57.717731
[0m18:04:57.718713 [debug] [Thread-1 (]: On model.dbt_idx.fact_orders: Close
[0m18:04:57.721715 [info ] [Thread-1 (]: 4 of 6 OK created sql table model warehouse.fact_orders ........................ [[32mSELECT 999[0m in 0.14s]
[0m18:04:57.723711 [debug] [Thread-1 (]: Finished running node model.dbt_idx.fact_orders
[0m18:04:57.725784 [debug] [Thread-1 (]: Began running node model.dbt_idx.dim_customers
[0m18:04:57.726781 [info ] [Thread-1 (]: 5 of 6 START sql table model warehouse.dim_customers ........................... [RUN]
[0m18:04:57.728787 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_idx.fact_orders, now model.dbt_idx.dim_customers)
[0m18:04:57.729814 [debug] [Thread-1 (]: Began compiling node model.dbt_idx.dim_customers
[0m18:04:57.734782 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_idx.dim_customers"
[0m18:04:57.744532 [debug] [Thread-1 (]: Timing info for model.dbt_idx.dim_customers (compile): 18:04:57.730816 => 18:04:57.744532
[0m18:04:57.746706 [debug] [Thread-1 (]: Began executing node model.dbt_idx.dim_customers
[0m18:04:57.754711 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_idx.dim_customers"
[0m18:04:57.764942 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.dim_customers"
[0m18:04:57.765450 [debug] [Thread-1 (]: On model.dbt_idx.dim_customers: BEGIN
[0m18:04:57.767466 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:04:57.794686 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m18:04:57.795928 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.dim_customers"
[0m18:04:57.796939 [debug] [Thread-1 (]: On model.dbt_idx.dim_customers: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.dim_customers"} */

  
    

  create  table "IDX-Stock"."warehouse"."dim_customers__dbt_tmp"
  
  
    as
  
  (
    -- noinspection SqlDialectInspectionForFile

with customers as (
    select *
    from "IDX-Stock"."warehouse"."stg_eltool__customers"
    ),
     state as (
         select *
         from "IDX-Stock"."warehouse"."stg_eltool__state"
     )
select c.customer_id,
       c.zipcode,
       c.city,
       c.state_code,
       s.state_name,
       c.datetime_created,
       c.datetime_updated,
       c.dbt_valid_from::TIMESTAMP as valid_from,
        CASE WHEN c.dbt_valid_to IS NULL
            THEN '9999-12-31'::TIMESTAMP
            ELSE c.dbt_valid_to::TIMESTAMP
        END as valid_to
from customers c
    join state s on c.state_code = s.state_code
  );
  
[0m18:04:57.804881 [debug] [Thread-1 (]: SQL status: SELECT 105 in 0.0 seconds
[0m18:04:57.808891 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.dim_customers"
[0m18:04:57.809889 [debug] [Thread-1 (]: On model.dbt_idx.dim_customers: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.dim_customers"} */
alter table "IDX-Stock"."warehouse"."dim_customers" rename to "dim_customers__dbt_backup"
[0m18:04:57.812889 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:04:57.817468 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.dim_customers"
[0m18:04:57.817994 [debug] [Thread-1 (]: On model.dbt_idx.dim_customers: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.dim_customers"} */
alter table "IDX-Stock"."warehouse"."dim_customers__dbt_tmp" rename to "dim_customers"
[0m18:04:57.822005 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:04:57.826650 [debug] [Thread-1 (]: On model.dbt_idx.dim_customers: COMMIT
[0m18:04:57.827605 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.dim_customers"
[0m18:04:57.828611 [debug] [Thread-1 (]: On model.dbt_idx.dim_customers: COMMIT
[0m18:04:57.833598 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m18:04:57.838452 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.dim_customers"
[0m18:04:57.839522 [debug] [Thread-1 (]: On model.dbt_idx.dim_customers: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.dim_customers"} */
drop table if exists "IDX-Stock"."warehouse"."dim_customers__dbt_backup" cascade
[0m18:04:57.845993 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m18:04:57.847994 [debug] [Thread-1 (]: Timing info for model.dbt_idx.dim_customers (execute): 18:04:57.746706 => 18:04:57.847994
[0m18:04:57.848995 [debug] [Thread-1 (]: On model.dbt_idx.dim_customers: Close
[0m18:04:57.851996 [info ] [Thread-1 (]: 5 of 6 OK created sql table model warehouse.dim_customers ...................... [[32mSELECT 105[0m in 0.12s]
[0m18:04:57.853000 [debug] [Thread-1 (]: Finished running node model.dbt_idx.dim_customers
[0m18:04:57.856080 [debug] [Thread-1 (]: Began running node model.dbt_idx.customer_orders_status
[0m18:04:57.857105 [info ] [Thread-1 (]: 6 of 6 START sql view model warehouse.customer_orders_status ................... [RUN]
[0m18:04:57.859532 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_idx.dim_customers, now model.dbt_idx.customer_orders_status)
[0m18:04:57.860536 [debug] [Thread-1 (]: Began compiling node model.dbt_idx.customer_orders_status
[0m18:04:57.866061 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_idx.customer_orders_status"
[0m18:04:57.874657 [debug] [Thread-1 (]: Timing info for model.dbt_idx.customer_orders_status (compile): 18:04:57.861541 => 18:04:57.874657
[0m18:04:57.875625 [debug] [Thread-1 (]: Began executing node model.dbt_idx.customer_orders_status
[0m18:04:57.886422 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_idx.customer_orders_status"
[0m18:04:57.896042 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.customer_orders_status"
[0m18:04:57.897228 [debug] [Thread-1 (]: On model.dbt_idx.customer_orders_status: BEGIN
[0m18:04:57.897740 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:04:57.920902 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m18:04:57.921894 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.customer_orders_status"
[0m18:04:57.921894 [debug] [Thread-1 (]: On model.dbt_idx.customer_orders_status: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.customer_orders_status"} */

  create view "IDX-Stock"."warehouse"."customer_orders_status__dbt_tmp"
    
    
  as (
    with orders as (select *
                from "IDX-Stock"."warehouse"."fact_orders"),
     customers as (select *
                   from "IDX-Stock"."warehouse"."dim_customers")
select o.order_id,
       o.customer_id,
       o.order_status,
       o.order_purchase_timestamp,
       o.order_approved_at,
       o.order_delivered_carrier_date,
       o.order_delivered_customer_date,
       o.order_estimated_delivery_date,
       c.zipcode    as customer_zipcode,
       c.city       as customer_city,
       c.state_code as customer_state_code,
       c.state_name as customer_state_name
from orders o
    join customers c on o.customer_id = c.customer_id
    and o.order_purchase_timestamp >= c.valid_from
    and o.order_purchase_timestamp <= c.valid_to
  );
[0m18:04:57.927032 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m18:04:57.931076 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.customer_orders_status"
[0m18:04:57.932032 [debug] [Thread-1 (]: On model.dbt_idx.customer_orders_status: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.customer_orders_status"} */
alter table "IDX-Stock"."warehouse"."customer_orders_status__dbt_tmp" rename to "customer_orders_status"
[0m18:04:57.934579 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:04:57.936622 [debug] [Thread-1 (]: On model.dbt_idx.customer_orders_status: COMMIT
[0m18:04:57.937621 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.customer_orders_status"
[0m18:04:57.938588 [debug] [Thread-1 (]: On model.dbt_idx.customer_orders_status: COMMIT
[0m18:04:57.942585 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m18:04:57.946187 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.customer_orders_status"
[0m18:04:57.947164 [debug] [Thread-1 (]: On model.dbt_idx.customer_orders_status: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.customer_orders_status"} */
drop view if exists "IDX-Stock"."warehouse"."customer_orders_status__dbt_backup" cascade
[0m18:04:57.949160 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m18:04:57.951209 [debug] [Thread-1 (]: Timing info for model.dbt_idx.customer_orders_status (execute): 18:04:57.877589 => 18:04:57.951209
[0m18:04:57.952194 [debug] [Thread-1 (]: On model.dbt_idx.customer_orders_status: Close
[0m18:04:57.953172 [info ] [Thread-1 (]: 6 of 6 OK created sql view model warehouse.customer_orders_status .............. [[32mCREATE VIEW[0m in 0.09s]
[0m18:04:57.955687 [debug] [Thread-1 (]: Finished running node model.dbt_idx.customer_orders_status
[0m18:04:57.958353 [debug] [MainThread]: Using postgres connection "master"
[0m18:04:57.959349 [debug] [MainThread]: On master: BEGIN
[0m18:04:57.960348 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:04:57.983431 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m18:04:57.985087 [debug] [MainThread]: On master: COMMIT
[0m18:04:57.985966 [debug] [MainThread]: Using postgres connection "master"
[0m18:04:57.987014 [debug] [MainThread]: On master: COMMIT
[0m18:04:57.988984 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m18:04:57.990000 [debug] [MainThread]: On master: Close
[0m18:04:57.991968 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:04:57.993001 [debug] [MainThread]: Connection 'list_IDX-Stock' was properly closed.
[0m18:04:57.994554 [debug] [MainThread]: Connection 'list_IDX-Stock_snapshots' was properly closed.
[0m18:04:57.995585 [debug] [MainThread]: Connection 'model.dbt_idx.customer_orders_status' was properly closed.
[0m18:04:57.996583 [info ] [MainThread]: 
[0m18:04:57.997563 [info ] [MainThread]: Finished running 4 view models, 2 table models in 0 hours 0 minutes and 1.11 seconds (1.11s).
[0m18:04:58.000596 [debug] [MainThread]: Command end result
[0m18:04:58.029106 [info ] [MainThread]: 
[0m18:04:58.030133 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:04:58.031140 [info ] [MainThread]: 
[0m18:04:58.032106 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 TOTAL=6
[0m18:04:58.034610 [debug] [MainThread]: Command `dbt run` succeeded at 18:04:58.034610 after 1.77 seconds
[0m18:04:58.035620 [debug] [MainThread]: Flushing usage events


============================== 18:10:58.042689 | de7b4f15-2ae7-4644-8e43-75ec25156bf6 ==============================
[0m18:10:58.042689 [info ] [MainThread]: Running with dbt=1.6.1
[0m18:10:58.049132 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'D:\\00 Project\\00 My Project\\IdeaProjects\\Py-DBT-IDX\\logs', 'version_check': 'True', 'profiles_dir': 'D:\\00 Project\\00 My Project\\IdeaProjects\\Py-DBT-IDX', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'False'}
[0m18:10:58.176565 [info ] [MainThread]: Registered adapter: postgres=1.6.1
[0m18:10:58.188656 [debug] [MainThread]: checksum: efe19d9f5b93d1a98cc804fbfcdb6b3aced98b974af664946fee1cde8837deb7, vars: {}, profile: , target: , version: 1.6.1
[0m18:10:58.341373 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 3 files changed.
[0m18:10:58.342398 [debug] [MainThread]: Partial parsing: added file: dbt_idx://models\staging\stg_eltool__customers_snapshots.sql
[0m18:10:58.343400 [debug] [MainThread]: Partial parsing: updated file: dbt_idx://models\staging\stg_eltool.yml
[0m18:10:58.344646 [debug] [MainThread]: Partial parsing: updated file: dbt_idx://models\marts\core\dim_customers.sql
[0m18:10:58.345629 [debug] [MainThread]: Partial parsing: updated file: dbt_idx://models\staging\stg_eltool__customers.sql
[0m18:10:58.460698 [info ] [MainThread]: Found 1 snapshot, 9 tests, 7 models, 3 sources, 0 exposures, 0 metrics, 349 macros, 0 groups, 0 semantic models
[0m18:10:58.463348 [info ] [MainThread]: 
[0m18:10:58.464802 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m18:10:58.467795 [debug] [ThreadPool]: Acquiring new postgres connection 'list_IDX-Stock'
[0m18:10:58.478342 [debug] [ThreadPool]: Using postgres connection "list_IDX-Stock"
[0m18:10:58.478342 [debug] [ThreadPool]: On list_IDX-Stock: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "connection_name": "list_IDX-Stock"} */

    select distinct nspname from pg_namespace
  
[0m18:10:58.479381 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:10:58.512233 [debug] [ThreadPool]: SQL status: SELECT 13 in 0.0 seconds
[0m18:10:58.513868 [debug] [ThreadPool]: On list_IDX-Stock: Close
[0m18:10:58.517756 [debug] [ThreadPool]: Acquiring new postgres connection 'list_IDX-Stock_warehouse'
[0m18:10:58.525372 [debug] [ThreadPool]: Using postgres connection "list_IDX-Stock_warehouse"
[0m18:10:58.525372 [debug] [ThreadPool]: On list_IDX-Stock_warehouse: BEGIN
[0m18:10:58.526376 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:10:58.549109 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m18:10:58.550093 [debug] [ThreadPool]: Using postgres connection "list_IDX-Stock_warehouse"
[0m18:10:58.551059 [debug] [ThreadPool]: On list_IDX-Stock_warehouse: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "connection_name": "list_IDX-Stock_warehouse"} */
select
      'IDX-Stock' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'warehouse'
    union all
    select
      'IDX-Stock' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'warehouse'
    union all
    select
      'IDX-Stock' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'warehouse'
  
[0m18:10:58.555652 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.0 seconds
[0m18:10:58.557630 [debug] [ThreadPool]: On list_IDX-Stock_warehouse: ROLLBACK
[0m18:10:58.559634 [debug] [ThreadPool]: On list_IDX-Stock_warehouse: Close
[0m18:10:58.562657 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_IDX-Stock_warehouse, now list_IDX-Stock_snapshots)
[0m18:10:58.568169 [debug] [ThreadPool]: Using postgres connection "list_IDX-Stock_snapshots"
[0m18:10:58.569174 [debug] [ThreadPool]: On list_IDX-Stock_snapshots: BEGIN
[0m18:10:58.570180 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:10:58.590883 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m18:10:58.591881 [debug] [ThreadPool]: Using postgres connection "list_IDX-Stock_snapshots"
[0m18:10:58.591881 [debug] [ThreadPool]: On list_IDX-Stock_snapshots: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "connection_name": "list_IDX-Stock_snapshots"} */
select
      'IDX-Stock' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'snapshots'
    union all
    select
      'IDX-Stock' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'snapshots'
    union all
    select
      'IDX-Stock' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'snapshots'
  
[0m18:10:58.596434 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.0 seconds
[0m18:10:58.598401 [debug] [ThreadPool]: On list_IDX-Stock_snapshots: ROLLBACK
[0m18:10:58.601159 [debug] [ThreadPool]: On list_IDX-Stock_snapshots: Close
[0m18:10:58.607692 [debug] [MainThread]: Using postgres connection "master"
[0m18:10:58.608692 [debug] [MainThread]: On master: BEGIN
[0m18:10:58.609693 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:10:58.630485 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m18:10:58.631473 [debug] [MainThread]: Using postgres connection "master"
[0m18:10:58.631473 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m18:10:58.638515 [debug] [MainThread]: SQL status: SELECT 5 in 0.0 seconds
[0m18:10:58.641569 [debug] [MainThread]: On master: ROLLBACK
[0m18:10:58.643519 [debug] [MainThread]: Using postgres connection "master"
[0m18:10:58.644871 [debug] [MainThread]: On master: BEGIN
[0m18:10:58.649822 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m18:10:58.649822 [debug] [MainThread]: On master: COMMIT
[0m18:10:58.650817 [debug] [MainThread]: Using postgres connection "master"
[0m18:10:58.651837 [debug] [MainThread]: On master: COMMIT
[0m18:10:58.654354 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m18:10:58.655395 [debug] [MainThread]: On master: Close
[0m18:10:58.656352 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:10:58.658370 [info ] [MainThread]: 
[0m18:10:58.663353 [debug] [Thread-1 (]: Began running node model.dbt_idx.stg_eltool__customers
[0m18:10:58.663893 [info ] [Thread-1 (]: 1 of 7 START sql view model warehouse.stg_eltool__customers .................... [RUN]
[0m18:10:58.664921 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.dbt_idx.stg_eltool__customers'
[0m18:10:58.665927 [debug] [Thread-1 (]: Began compiling node model.dbt_idx.stg_eltool__customers
[0m18:10:58.674487 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_idx.stg_eltool__customers"
[0m18:10:58.687632 [debug] [Thread-1 (]: Timing info for model.dbt_idx.stg_eltool__customers (compile): 18:10:58.666899 => 18:10:58.687632
[0m18:10:58.688631 [debug] [Thread-1 (]: Began executing node model.dbt_idx.stg_eltool__customers
[0m18:10:58.727002 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_idx.stg_eltool__customers"
[0m18:10:58.733581 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__customers"
[0m18:10:58.733581 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__customers: BEGIN
[0m18:10:58.734524 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m18:10:58.756699 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m18:10:58.757723 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__customers"
[0m18:10:58.758717 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__customers: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__customers"} */

  create view "IDX-Stock"."warehouse"."stg_eltool__customers__dbt_tmp"
    
    
  as (
    with source as (select *
                from "IDX-Stock"."warehouse"."customers"),
     renamed as (select customer_id,
                        'This is Dummy' as dummy
                 from source)
select *
from renamed
  );
[0m18:10:58.763706 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m18:10:58.770033 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__customers"
[0m18:10:58.771032 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__customers: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__customers"} */
alter table "IDX-Stock"."warehouse"."stg_eltool__customers" rename to "stg_eltool__customers__dbt_backup"
[0m18:10:58.773672 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:10:58.777724 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__customers"
[0m18:10:58.777724 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__customers: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__customers"} */
alter table "IDX-Stock"."warehouse"."stg_eltool__customers__dbt_tmp" rename to "stg_eltool__customers"
[0m18:10:58.780688 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:10:58.797728 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__customers: COMMIT
[0m18:10:58.798729 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__customers"
[0m18:10:58.798729 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__customers: COMMIT
[0m18:10:58.802403 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m18:10:58.810915 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__customers"
[0m18:10:58.811915 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__customers: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__customers"} */
drop view if exists "IDX-Stock"."warehouse"."stg_eltool__customers__dbt_backup" cascade
[0m18:10:58.817447 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m18:10:58.819484 [debug] [Thread-1 (]: Timing info for model.dbt_idx.stg_eltool__customers (execute): 18:10:58.689631 => 18:10:58.818482
[0m18:10:58.820457 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__customers: Close
[0m18:10:58.822451 [info ] [Thread-1 (]: 1 of 7 OK created sql view model warehouse.stg_eltool__customers ............... [[32mCREATE VIEW[0m in 0.16s]
[0m18:10:58.824000 [debug] [Thread-1 (]: Finished running node model.dbt_idx.stg_eltool__customers
[0m18:10:58.825014 [debug] [Thread-1 (]: Began running node model.dbt_idx.stg_eltool__customers_snapshots
[0m18:10:58.826011 [info ] [Thread-1 (]: 2 of 7 START sql view model warehouse.stg_eltool__customers_snapshots .......... [RUN]
[0m18:10:58.828012 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_idx.stg_eltool__customers, now model.dbt_idx.stg_eltool__customers_snapshots)
[0m18:10:58.829010 [debug] [Thread-1 (]: Began compiling node model.dbt_idx.stg_eltool__customers_snapshots
[0m18:10:58.832011 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_idx.stg_eltool__customers_snapshots"
[0m18:10:58.837537 [debug] [Thread-1 (]: Timing info for model.dbt_idx.stg_eltool__customers_snapshots (compile): 18:10:58.830011 => 18:10:58.836535
[0m18:10:58.838536 [debug] [Thread-1 (]: Began executing node model.dbt_idx.stg_eltool__customers_snapshots
[0m18:10:58.846685 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_idx.stg_eltool__customers_snapshots"
[0m18:10:58.853680 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__customers_snapshots"
[0m18:10:58.854749 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__customers_snapshots: BEGIN
[0m18:10:58.855743 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:10:58.878131 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m18:10:58.879126 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__customers_snapshots"
[0m18:10:58.880127 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__customers_snapshots: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__customers_snapshots"} */

  create view "IDX-Stock"."warehouse"."stg_eltool__customers_snapshots__dbt_tmp"
    
    
  as (
    with source as (select *
                from "IDX-Stock"."snapshots"."customers_snapshot"),
     renamed as (select customer_id,
                        zipcode,
                        city,
                        state_code,
                        datetime_created::TIMESTAMP AS datetime_created,
                        datetime_updated::TIMESTAMP AS datetime_updated,
                        dbt_valid_from,
                        dbt_valid_to
                 from source)
select *
from renamed
  );
[0m18:10:58.883822 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m18:10:58.887729 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__customers_snapshots"
[0m18:10:58.888729 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__customers_snapshots: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__customers_snapshots"} */
alter table "IDX-Stock"."warehouse"."stg_eltool__customers_snapshots__dbt_tmp" rename to "stg_eltool__customers_snapshots"
[0m18:10:58.891730 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:10:58.894301 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__customers_snapshots: COMMIT
[0m18:10:58.895308 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__customers_snapshots"
[0m18:10:58.895308 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__customers_snapshots: COMMIT
[0m18:10:58.899196 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m18:10:58.902223 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__customers_snapshots"
[0m18:10:58.902223 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__customers_snapshots: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__customers_snapshots"} */
drop view if exists "IDX-Stock"."warehouse"."stg_eltool__customers_snapshots__dbt_backup" cascade
[0m18:10:58.905771 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m18:10:58.907808 [debug] [Thread-1 (]: Timing info for model.dbt_idx.stg_eltool__customers_snapshots (execute): 18:10:58.838536 => 18:10:58.906807
[0m18:10:58.907808 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__customers_snapshots: Close
[0m18:10:58.909785 [info ] [Thread-1 (]: 2 of 7 OK created sql view model warehouse.stg_eltool__customers_snapshots ..... [[32mCREATE VIEW[0m in 0.08s]
[0m18:10:58.911805 [debug] [Thread-1 (]: Finished running node model.dbt_idx.stg_eltool__customers_snapshots
[0m18:10:58.913313 [debug] [Thread-1 (]: Began running node model.dbt_idx.stg_eltool__orders
[0m18:10:58.914349 [info ] [Thread-1 (]: 3 of 7 START sql view model warehouse.stg_eltool__orders ....................... [RUN]
[0m18:10:58.915321 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_idx.stg_eltool__customers_snapshots, now model.dbt_idx.stg_eltool__orders)
[0m18:10:58.916321 [debug] [Thread-1 (]: Began compiling node model.dbt_idx.stg_eltool__orders
[0m18:10:58.920321 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_idx.stg_eltool__orders"
[0m18:10:58.933445 [debug] [Thread-1 (]: Timing info for model.dbt_idx.stg_eltool__orders (compile): 18:10:58.917321 => 18:10:58.932442
[0m18:10:58.933988 [debug] [Thread-1 (]: Began executing node model.dbt_idx.stg_eltool__orders
[0m18:10:58.940029 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_idx.stg_eltool__orders"
[0m18:10:58.951005 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__orders"
[0m18:10:58.952016 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__orders: BEGIN
[0m18:10:58.952016 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:10:58.972036 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m18:10:58.973613 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__orders"
[0m18:10:58.974558 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__orders: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__orders"} */

  create view "IDX-Stock"."warehouse"."stg_eltool__orders__dbt_tmp"
    
    
  as (
    with source as (select *
                from "IDX-Stock"."warehouse"."orders"),
     renamed as (select order_id,
                        cust_id AS customer_id,
                        order_status,
                        order_purchase_timestamp::TIMESTAMP,
                        order_approved_at::TIMESTAMP,
                        order_delivered_carrier_date::TIMESTAMP,
                        order_delivered_customer_date::TIMESTAMP,
                        order_estimated_delivery_date::TIMESTAMP
                 from source)
select *
from renamed
  );
[0m18:10:58.978564 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m18:10:58.981564 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__orders"
[0m18:10:58.982570 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__orders: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__orders"} */
alter table "IDX-Stock"."warehouse"."stg_eltool__orders" rename to "stg_eltool__orders__dbt_backup"
[0m18:10:58.984820 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:10:58.988853 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__orders"
[0m18:10:58.989880 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__orders: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__orders"} */
alter table "IDX-Stock"."warehouse"."stg_eltool__orders__dbt_tmp" rename to "stg_eltool__orders"
[0m18:10:58.991851 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:10:58.994954 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__orders: COMMIT
[0m18:10:58.995981 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__orders"
[0m18:10:58.996960 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__orders: COMMIT
[0m18:10:59.000971 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m18:10:59.004553 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__orders"
[0m18:10:59.005518 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__orders: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__orders"} */
drop view if exists "IDX-Stock"."warehouse"."stg_eltool__orders__dbt_backup" cascade
[0m18:10:59.009516 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m18:10:59.011518 [debug] [Thread-1 (]: Timing info for model.dbt_idx.stg_eltool__orders (execute): 18:10:58.935030 => 18:10:59.010518
[0m18:10:59.011518 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__orders: Close
[0m18:10:59.014027 [info ] [Thread-1 (]: 3 of 7 OK created sql view model warehouse.stg_eltool__orders .................. [[32mCREATE VIEW[0m in 0.10s]
[0m18:10:59.016051 [debug] [Thread-1 (]: Finished running node model.dbt_idx.stg_eltool__orders
[0m18:10:59.017040 [debug] [Thread-1 (]: Began running node model.dbt_idx.stg_eltool__state
[0m18:10:59.018041 [info ] [Thread-1 (]: 4 of 7 START sql view model warehouse.stg_eltool__state ........................ [RUN]
[0m18:10:59.019032 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_idx.stg_eltool__orders, now model.dbt_idx.stg_eltool__state)
[0m18:10:59.020035 [debug] [Thread-1 (]: Began compiling node model.dbt_idx.stg_eltool__state
[0m18:10:59.024547 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_idx.stg_eltool__state"
[0m18:10:59.032553 [debug] [Thread-1 (]: Timing info for model.dbt_idx.stg_eltool__state (compile): 18:10:59.021038 => 18:10:59.031591
[0m18:10:59.032553 [debug] [Thread-1 (]: Began executing node model.dbt_idx.stg_eltool__state
[0m18:10:59.039096 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_idx.stg_eltool__state"
[0m18:10:59.045982 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__state"
[0m18:10:59.045982 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__state: BEGIN
[0m18:10:59.046981 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:10:59.071055 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m18:10:59.072054 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__state"
[0m18:10:59.072054 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__state: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__state"} */

  create view "IDX-Stock"."warehouse"."stg_eltool__state__dbt_tmp"
    
    
  as (
    with source as (select *
                from "IDX-Stock"."warehouse"."state"),
     renamed as (select state_identifier::INT AS state_id,
                         state_code::VARCHAR(2) AS state_code,
                         st_name::VARCHAR(30) AS state_name
                 from source)
select *
from renamed
  );
[0m18:10:59.076588 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m18:10:59.081588 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__state"
[0m18:10:59.082599 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__state: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__state"} */
alter table "IDX-Stock"."warehouse"."stg_eltool__state" rename to "stg_eltool__state__dbt_backup"
[0m18:10:59.084888 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:10:59.090880 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__state"
[0m18:10:59.091881 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__state: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__state"} */
alter table "IDX-Stock"."warehouse"."stg_eltool__state__dbt_tmp" rename to "stg_eltool__state"
[0m18:10:59.095014 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:10:59.097013 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__state: COMMIT
[0m18:10:59.098015 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__state"
[0m18:10:59.099014 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__state: COMMIT
[0m18:10:59.101874 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m18:10:59.105423 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__state"
[0m18:10:59.106408 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__state: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__state"} */
drop view if exists "IDX-Stock"."warehouse"."stg_eltool__state__dbt_backup" cascade
[0m18:10:59.110270 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m18:10:59.112308 [debug] [Thread-1 (]: Timing info for model.dbt_idx.stg_eltool__state (execute): 18:10:59.034059 => 18:10:59.112308
[0m18:10:59.113274 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__state: Close
[0m18:10:59.115401 [info ] [Thread-1 (]: 4 of 7 OK created sql view model warehouse.stg_eltool__state ................... [[32mCREATE VIEW[0m in 0.10s]
[0m18:10:59.117404 [debug] [Thread-1 (]: Finished running node model.dbt_idx.stg_eltool__state
[0m18:10:59.119398 [debug] [Thread-1 (]: Began running node model.dbt_idx.fact_orders
[0m18:10:59.120398 [info ] [Thread-1 (]: 5 of 7 START sql table model warehouse.fact_orders ............................. [RUN]
[0m18:10:59.121402 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_idx.stg_eltool__state, now model.dbt_idx.fact_orders)
[0m18:10:59.122399 [debug] [Thread-1 (]: Began compiling node model.dbt_idx.fact_orders
[0m18:10:59.125921 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_idx.fact_orders"
[0m18:10:59.131922 [debug] [Thread-1 (]: Timing info for model.dbt_idx.fact_orders (compile): 18:10:59.123403 => 18:10:59.131922
[0m18:10:59.133517 [debug] [Thread-1 (]: Began executing node model.dbt_idx.fact_orders
[0m18:10:59.162005 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_idx.fact_orders"
[0m18:10:59.169546 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.fact_orders"
[0m18:10:59.170526 [debug] [Thread-1 (]: On model.dbt_idx.fact_orders: BEGIN
[0m18:10:59.171525 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:10:59.195091 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m18:10:59.195091 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.fact_orders"
[0m18:10:59.196126 [debug] [Thread-1 (]: On model.dbt_idx.fact_orders: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.fact_orders"} */

  
    

  create  table "IDX-Stock"."warehouse"."fact_orders__dbt_tmp"
  
  
    as
  
  (
    with orders as (
    select *
    from "IDX-Stock"."warehouse"."stg_eltool__orders"
)
select * from orders
  );
  
[0m18:10:59.203610 [debug] [Thread-1 (]: SQL status: SELECT 999 in 0.0 seconds
[0m18:10:59.207649 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.fact_orders"
[0m18:10:59.208656 [debug] [Thread-1 (]: On model.dbt_idx.fact_orders: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.fact_orders"} */
alter table "IDX-Stock"."warehouse"."fact_orders" rename to "fact_orders__dbt_backup"
[0m18:10:59.211620 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:10:59.215201 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.fact_orders"
[0m18:10:59.216166 [debug] [Thread-1 (]: On model.dbt_idx.fact_orders: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.fact_orders"} */
alter table "IDX-Stock"."warehouse"."fact_orders__dbt_tmp" rename to "fact_orders"
[0m18:10:59.218181 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:10:59.223822 [debug] [Thread-1 (]: On model.dbt_idx.fact_orders: COMMIT
[0m18:10:59.224783 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.fact_orders"
[0m18:10:59.225750 [debug] [Thread-1 (]: On model.dbt_idx.fact_orders: COMMIT
[0m18:10:59.230155 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m18:10:59.235749 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.fact_orders"
[0m18:10:59.235749 [debug] [Thread-1 (]: On model.dbt_idx.fact_orders: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.fact_orders"} */
drop table if exists "IDX-Stock"."warehouse"."fact_orders__dbt_backup" cascade
[0m18:10:59.240745 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m18:10:59.243304 [debug] [Thread-1 (]: Timing info for model.dbt_idx.fact_orders (execute): 18:10:59.134438 => 18:10:59.243304
[0m18:10:59.243304 [debug] [Thread-1 (]: On model.dbt_idx.fact_orders: Close
[0m18:10:59.245335 [info ] [Thread-1 (]: 5 of 7 OK created sql table model warehouse.fact_orders ........................ [[32mSELECT 999[0m in 0.12s]
[0m18:10:59.248314 [debug] [Thread-1 (]: Finished running node model.dbt_idx.fact_orders
[0m18:10:59.249311 [debug] [Thread-1 (]: Began running node model.dbt_idx.dim_customers
[0m18:10:59.250311 [info ] [Thread-1 (]: 6 of 7 START sql table model warehouse.dim_customers ........................... [RUN]
[0m18:10:59.251313 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_idx.fact_orders, now model.dbt_idx.dim_customers)
[0m18:10:59.252313 [debug] [Thread-1 (]: Began compiling node model.dbt_idx.dim_customers
[0m18:10:59.255914 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_idx.dim_customers"
[0m18:10:59.261325 [debug] [Thread-1 (]: Timing info for model.dbt_idx.dim_customers (compile): 18:10:59.253327 => 18:10:59.261325
[0m18:10:59.262329 [debug] [Thread-1 (]: Began executing node model.dbt_idx.dim_customers
[0m18:10:59.268852 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_idx.dim_customers"
[0m18:10:59.275491 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.dim_customers"
[0m18:10:59.276484 [debug] [Thread-1 (]: On model.dbt_idx.dim_customers: BEGIN
[0m18:10:59.277491 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:10:59.301714 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m18:10:59.302714 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.dim_customers"
[0m18:10:59.303725 [debug] [Thread-1 (]: On model.dbt_idx.dim_customers: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.dim_customers"} */

  
    

  create  table "IDX-Stock"."warehouse"."dim_customers__dbt_tmp"
  
  
    as
  
  (
    -- noinspection SqlDialectInspectionForFile

with customers as (
    select *
    from "IDX-Stock"."warehouse"."stg_eltool__customers_snapshots"
    ),
     state as (
         select *
         from "IDX-Stock"."warehouse"."stg_eltool__state"
     )
select c.customer_id,
       c.zipcode,
       c.city,
       c.state_code,
       s.state_name,
       c.datetime_created,
       c.datetime_updated,
       c.dbt_valid_from::TIMESTAMP as valid_from,
        CASE WHEN c.dbt_valid_to IS NULL
            THEN '9999-12-31'::TIMESTAMP
            ELSE c.dbt_valid_to::TIMESTAMP
        END as valid_to
from customers c
    join state s on c.state_code = s.state_code
  );
  
[0m18:10:59.309079 [debug] [Thread-1 (]: SQL status: SELECT 105 in 0.0 seconds
[0m18:10:59.313599 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.dim_customers"
[0m18:10:59.314615 [debug] [Thread-1 (]: On model.dbt_idx.dim_customers: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.dim_customers"} */
alter table "IDX-Stock"."warehouse"."dim_customers" rename to "dim_customers__dbt_backup"
[0m18:10:59.317622 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:10:59.323645 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.dim_customers"
[0m18:10:59.324188 [debug] [Thread-1 (]: On model.dbt_idx.dim_customers: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.dim_customers"} */
alter table "IDX-Stock"."warehouse"."dim_customers__dbt_tmp" rename to "dim_customers"
[0m18:10:59.327196 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:10:59.329195 [debug] [Thread-1 (]: On model.dbt_idx.dim_customers: COMMIT
[0m18:10:59.330230 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.dim_customers"
[0m18:10:59.331231 [debug] [Thread-1 (]: On model.dbt_idx.dim_customers: COMMIT
[0m18:10:59.334734 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m18:10:59.339747 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.dim_customers"
[0m18:10:59.339747 [debug] [Thread-1 (]: On model.dbt_idx.dim_customers: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.dim_customers"} */
drop table if exists "IDX-Stock"."warehouse"."dim_customers__dbt_backup" cascade
[0m18:10:59.344870 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m18:10:59.347872 [debug] [Thread-1 (]: Timing info for model.dbt_idx.dim_customers (execute): 18:10:59.263329 => 18:10:59.346888
[0m18:10:59.348874 [debug] [Thread-1 (]: On model.dbt_idx.dim_customers: Close
[0m18:10:59.351873 [info ] [Thread-1 (]: 6 of 7 OK created sql table model warehouse.dim_customers ...................... [[32mSELECT 105[0m in 0.10s]
[0m18:10:59.355408 [debug] [Thread-1 (]: Finished running node model.dbt_idx.dim_customers
[0m18:10:59.357402 [debug] [Thread-1 (]: Began running node model.dbt_idx.customer_orders_status
[0m18:10:59.359399 [info ] [Thread-1 (]: 7 of 7 START sql view model warehouse.customer_orders_status ................... [RUN]
[0m18:10:59.360416 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_idx.dim_customers, now model.dbt_idx.customer_orders_status)
[0m18:10:59.361464 [debug] [Thread-1 (]: Began compiling node model.dbt_idx.customer_orders_status
[0m18:10:59.364986 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_idx.customer_orders_status"
[0m18:10:59.371999 [debug] [Thread-1 (]: Timing info for model.dbt_idx.customer_orders_status (compile): 18:10:59.361464 => 18:10:59.371999
[0m18:10:59.374551 [debug] [Thread-1 (]: Began executing node model.dbt_idx.customer_orders_status
[0m18:10:59.384647 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_idx.customer_orders_status"
[0m18:10:59.393588 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.customer_orders_status"
[0m18:10:59.394213 [debug] [Thread-1 (]: On model.dbt_idx.customer_orders_status: BEGIN
[0m18:10:59.395205 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:10:59.416948 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m18:10:59.417949 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.customer_orders_status"
[0m18:10:59.418949 [debug] [Thread-1 (]: On model.dbt_idx.customer_orders_status: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.customer_orders_status"} */

  create view "IDX-Stock"."warehouse"."customer_orders_status__dbt_tmp"
    
    
  as (
    with orders as (select *
                from "IDX-Stock"."warehouse"."fact_orders"),
     customers as (select *
                   from "IDX-Stock"."warehouse"."dim_customers")
select o.order_id,
       o.customer_id,
       o.order_status,
       o.order_purchase_timestamp,
       o.order_approved_at,
       o.order_delivered_carrier_date,
       o.order_delivered_customer_date,
       o.order_estimated_delivery_date,
       c.zipcode    as customer_zipcode,
       c.city       as customer_city,
       c.state_code as customer_state_code,
       c.state_name as customer_state_name
from orders o
    join customers c on o.customer_id = c.customer_id
    and o.order_purchase_timestamp >= c.valid_from
    and o.order_purchase_timestamp <= c.valid_to
  );
[0m18:10:59.421983 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m18:10:59.426570 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.customer_orders_status"
[0m18:10:59.426570 [debug] [Thread-1 (]: On model.dbt_idx.customer_orders_status: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.customer_orders_status"} */
alter table "IDX-Stock"."warehouse"."customer_orders_status__dbt_tmp" rename to "customer_orders_status"
[0m18:10:59.429324 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:10:59.431362 [debug] [Thread-1 (]: On model.dbt_idx.customer_orders_status: COMMIT
[0m18:10:59.432360 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.customer_orders_status"
[0m18:10:59.433344 [debug] [Thread-1 (]: On model.dbt_idx.customer_orders_status: COMMIT
[0m18:10:59.437531 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m18:10:59.440569 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.customer_orders_status"
[0m18:10:59.441532 [debug] [Thread-1 (]: On model.dbt_idx.customer_orders_status: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.customer_orders_status"} */
drop view if exists "IDX-Stock"."warehouse"."customer_orders_status__dbt_backup" cascade
[0m18:10:59.443534 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m18:10:59.445653 [debug] [Thread-1 (]: Timing info for model.dbt_idx.customer_orders_status (execute): 18:10:59.376551 => 18:10:59.445653
[0m18:10:59.446625 [debug] [Thread-1 (]: On model.dbt_idx.customer_orders_status: Close
[0m18:10:59.448631 [info ] [Thread-1 (]: 7 of 7 OK created sql view model warehouse.customer_orders_status .............. [[32mCREATE VIEW[0m in 0.09s]
[0m18:10:59.450627 [debug] [Thread-1 (]: Finished running node model.dbt_idx.customer_orders_status
[0m18:10:59.453626 [debug] [MainThread]: Using postgres connection "master"
[0m18:10:59.454131 [debug] [MainThread]: On master: BEGIN
[0m18:10:59.455137 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:10:59.477550 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m18:10:59.478550 [debug] [MainThread]: On master: COMMIT
[0m18:10:59.478550 [debug] [MainThread]: Using postgres connection "master"
[0m18:10:59.479572 [debug] [MainThread]: On master: COMMIT
[0m18:10:59.483505 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m18:10:59.485244 [debug] [MainThread]: On master: Close
[0m18:10:59.488614 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:10:59.490365 [debug] [MainThread]: Connection 'list_IDX-Stock' was properly closed.
[0m18:10:59.492000 [debug] [MainThread]: Connection 'list_IDX-Stock_snapshots' was properly closed.
[0m18:10:59.493642 [debug] [MainThread]: Connection 'model.dbt_idx.customer_orders_status' was properly closed.
[0m18:10:59.495837 [info ] [MainThread]: 
[0m18:10:59.497476 [info ] [MainThread]: Finished running 5 view models, 2 table models in 0 hours 0 minutes and 1.03 seconds (1.03s).
[0m18:10:59.502877 [debug] [MainThread]: Command end result
[0m18:10:59.526763 [info ] [MainThread]: 
[0m18:10:59.527764 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:10:59.528766 [info ] [MainThread]: 
[0m18:10:59.529769 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=0 SKIP=0 TOTAL=7
[0m18:10:59.530782 [debug] [MainThread]: Command `dbt run` succeeded at 18:10:59.530782 after 1.54 seconds
[0m18:10:59.531791 [debug] [MainThread]: Flushing usage events


============================== 18:25:57.102489 | 81a52cd4-841a-4d80-8315-7516142a97ea ==============================
[0m18:25:57.102489 [info ] [MainThread]: Running with dbt=1.6.1
[0m18:25:57.108488 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': 'D:\\00 Project\\00 My Project\\IdeaProjects\\Py-DBT-IDX\\logs', 'profiles_dir': 'D:\\00 Project\\00 My Project\\IdeaProjects\\Py-DBT-IDX', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt test', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'False'}
[0m18:25:57.285414 [info ] [MainThread]: Registered adapter: postgres=1.6.1
[0m18:25:57.301513 [debug] [MainThread]: checksum: efe19d9f5b93d1a98cc804fbfcdb6b3aced98b974af664946fee1cde8837deb7, vars: {}, profile: , target: , version: 1.6.1
[0m18:25:57.524443 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m18:25:57.525470 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m18:25:57.583893 [info ] [MainThread]: Found 1 snapshot, 9 tests, 7 models, 3 sources, 0 exposures, 0 metrics, 349 macros, 0 groups, 0 semantic models
[0m18:25:57.587546 [info ] [MainThread]: 
[0m18:25:57.588547 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m18:25:57.593099 [debug] [ThreadPool]: Acquiring new postgres connection 'list_IDX-Stock_warehouse'
[0m18:25:57.611474 [debug] [ThreadPool]: Using postgres connection "list_IDX-Stock_warehouse"
[0m18:25:57.612604 [debug] [ThreadPool]: On list_IDX-Stock_warehouse: BEGIN
[0m18:25:57.612604 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:25:57.651896 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m18:25:57.652817 [debug] [ThreadPool]: Using postgres connection "list_IDX-Stock_warehouse"
[0m18:25:57.653764 [debug] [ThreadPool]: On list_IDX-Stock_warehouse: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "connection_name": "list_IDX-Stock_warehouse"} */
select
      'IDX-Stock' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'warehouse'
    union all
    select
      'IDX-Stock' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'warehouse'
    union all
    select
      'IDX-Stock' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'warehouse'
  
[0m18:25:57.660762 [debug] [ThreadPool]: SQL status: SELECT 11 in 0.0 seconds
[0m18:25:57.664063 [debug] [ThreadPool]: On list_IDX-Stock_warehouse: ROLLBACK
[0m18:25:57.667054 [debug] [ThreadPool]: On list_IDX-Stock_warehouse: Close
[0m18:25:57.669587 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_IDX-Stock_warehouse, now list_IDX-Stock_snapshots)
[0m18:25:57.677889 [debug] [ThreadPool]: Using postgres connection "list_IDX-Stock_snapshots"
[0m18:25:57.678924 [debug] [ThreadPool]: On list_IDX-Stock_snapshots: BEGIN
[0m18:25:57.680448 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:25:57.706216 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m18:25:57.707217 [debug] [ThreadPool]: Using postgres connection "list_IDX-Stock_snapshots"
[0m18:25:57.708216 [debug] [ThreadPool]: On list_IDX-Stock_snapshots: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "connection_name": "list_IDX-Stock_snapshots"} */
select
      'IDX-Stock' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'snapshots'
    union all
    select
      'IDX-Stock' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'snapshots'
    union all
    select
      'IDX-Stock' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'snapshots'
  
[0m18:25:57.712764 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.0 seconds
[0m18:25:57.714784 [debug] [ThreadPool]: On list_IDX-Stock_snapshots: ROLLBACK
[0m18:25:57.716771 [debug] [ThreadPool]: On list_IDX-Stock_snapshots: Close
[0m18:25:57.724632 [debug] [MainThread]: Using postgres connection "master"
[0m18:25:57.725621 [debug] [MainThread]: On master: BEGIN
[0m18:25:57.726601 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:25:57.752640 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m18:25:57.753639 [debug] [MainThread]: Using postgres connection "master"
[0m18:25:57.754639 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m18:25:57.761785 [debug] [MainThread]: SQL status: SELECT 6 in 0.0 seconds
[0m18:25:57.766356 [debug] [MainThread]: On master: ROLLBACK
[0m18:25:57.768358 [debug] [MainThread]: Using postgres connection "master"
[0m18:25:57.769320 [debug] [MainThread]: On master: BEGIN
[0m18:25:57.774581 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m18:25:57.775582 [debug] [MainThread]: On master: COMMIT
[0m18:25:57.775582 [debug] [MainThread]: Using postgres connection "master"
[0m18:25:57.776613 [debug] [MainThread]: On master: COMMIT
[0m18:25:57.778596 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m18:25:57.780183 [debug] [MainThread]: On master: Close
[0m18:25:57.781743 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:25:57.783722 [info ] [MainThread]: 
[0m18:25:57.791272 [debug] [Thread-1 (]: Began running node test.dbt_idx.accepted_values_customer_orders_status_order_status__delivered__invoiced__shipped__processing__canceled__unavailable.ea8c296d27
[0m18:25:57.792253 [info ] [Thread-1 (]: 1 of 9 START test accepted_values_customer_orders_status_order_status__delivered__invoiced__shipped__processing__canceled__unavailable  [RUN]
[0m18:25:57.795252 [debug] [Thread-1 (]: Acquiring new postgres connection 'test.dbt_idx.accepted_values_customer_orders_status_order_status__delivered__invoiced__shipped__processing__canceled__unavailable.ea8c296d27'
[0m18:25:57.796764 [debug] [Thread-1 (]: Began compiling node test.dbt_idx.accepted_values_customer_orders_status_order_status__delivered__invoiced__shipped__processing__canceled__unavailable.ea8c296d27
[0m18:25:57.832118 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_idx.accepted_values_customer_orders_status_order_status__delivered__invoiced__shipped__processing__canceled__unavailable.ea8c296d27"
[0m18:25:57.837513 [debug] [Thread-1 (]: Timing info for test.dbt_idx.accepted_values_customer_orders_status_order_status__delivered__invoiced__shipped__processing__canceled__unavailable.ea8c296d27 (compile): 18:25:57.797771 => 18:25:57.836549
[0m18:25:57.838513 [debug] [Thread-1 (]: Began executing node test.dbt_idx.accepted_values_customer_orders_status_order_status__delivered__invoiced__shipped__processing__canceled__unavailable.ea8c296d27
[0m18:25:57.859580 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_idx.accepted_values_customer_orders_status_order_status__delivered__invoiced__shipped__processing__canceled__unavailable.ea8c296d27"
[0m18:25:57.865140 [debug] [Thread-1 (]: Using postgres connection "test.dbt_idx.accepted_values_customer_orders_status_order_status__delivered__invoiced__shipped__processing__canceled__unavailable.ea8c296d27"
[0m18:25:57.866103 [debug] [Thread-1 (]: On test.dbt_idx.accepted_values_customer_orders_status_order_status__delivered__invoiced__shipped__processing__canceled__unavailable.ea8c296d27: BEGIN
[0m18:25:57.867102 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m18:25:57.889387 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m18:25:57.890413 [debug] [Thread-1 (]: Using postgres connection "test.dbt_idx.accepted_values_customer_orders_status_order_status__delivered__invoiced__shipped__processing__canceled__unavailable.ea8c296d27"
[0m18:25:57.891620 [debug] [Thread-1 (]: On test.dbt_idx.accepted_values_customer_orders_status_order_status__delivered__invoiced__shipped__processing__canceled__unavailable.ea8c296d27: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "test.dbt_idx.accepted_values_customer_orders_status_order_status__delivered__invoiced__shipped__processing__canceled__unavailable.ea8c296d27"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        order_status as value_field,
        count(*) as n_records

    from "IDX-Stock"."warehouse"."customer_orders_status"
    group by order_status

)

select *
from all_values
where value_field not in (
    'delivered','invoiced','shipped','processing','canceled','unavailable'
)



      
    ) dbt_internal_test
[0m18:25:57.896176 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m18:25:57.899123 [debug] [Thread-1 (]: Timing info for test.dbt_idx.accepted_values_customer_orders_status_order_status__delivered__invoiced__shipped__processing__canceled__unavailable.ea8c296d27 (execute): 18:25:57.838513 => 18:25:57.899123
[0m18:25:57.899123 [debug] [Thread-1 (]: On test.dbt_idx.accepted_values_customer_orders_status_order_status__delivered__invoiced__shipped__processing__canceled__unavailable.ea8c296d27: ROLLBACK
[0m18:25:57.902644 [debug] [Thread-1 (]: On test.dbt_idx.accepted_values_customer_orders_status_order_status__delivered__invoiced__shipped__processing__canceled__unavailable.ea8c296d27: Close
[0m18:25:57.904639 [info ] [Thread-1 (]: 1 of 9 PASS accepted_values_customer_orders_status_order_status__delivered__invoiced__shipped__processing__canceled__unavailable  [[32mPASS[0m in 0.11s]
[0m18:25:57.907673 [debug] [Thread-1 (]: Finished running node test.dbt_idx.accepted_values_customer_orders_status_order_status__delivered__invoiced__shipped__processing__canceled__unavailable.ea8c296d27
[0m18:25:57.908637 [debug] [Thread-1 (]: Began running node test.dbt_idx.assert_customer_dimension_has_no_row_loss.sql
[0m18:25:57.910647 [info ] [Thread-1 (]: 2 of 9 START test assert_customer_dimension_has_no_row_loss.sql ................ [RUN]
[0m18:25:57.912162 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_idx.accepted_values_customer_orders_status_order_status__delivered__invoiced__shipped__processing__canceled__unavailable.ea8c296d27, now test.dbt_idx.assert_customer_dimension_has_no_row_loss.sql)
[0m18:25:57.914170 [debug] [Thread-1 (]: Began compiling node test.dbt_idx.assert_customer_dimension_has_no_row_loss.sql
[0m18:25:57.918749 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_idx.assert_customer_dimension_has_no_row_loss.sql"
[0m18:25:57.925318 [debug] [Thread-1 (]: Timing info for test.dbt_idx.assert_customer_dimension_has_no_row_loss.sql (compile): 18:25:57.914170 => 18:25:57.925318
[0m18:25:57.926320 [debug] [Thread-1 (]: Began executing node test.dbt_idx.assert_customer_dimension_has_no_row_loss.sql
[0m18:25:57.929320 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_idx.assert_customer_dimension_has_no_row_loss.sql"
[0m18:25:57.935338 [debug] [Thread-1 (]: Using postgres connection "test.dbt_idx.assert_customer_dimension_has_no_row_loss.sql"
[0m18:25:57.936338 [debug] [Thread-1 (]: On test.dbt_idx.assert_customer_dimension_has_no_row_loss.sql: BEGIN
[0m18:25:57.936338 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:25:57.968051 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m18:25:57.969051 [debug] [Thread-1 (]: Using postgres connection "test.dbt_idx.assert_customer_dimension_has_no_row_loss.sql"
[0m18:25:57.969051 [debug] [Thread-1 (]: On test.dbt_idx.assert_customer_dimension_has_no_row_loss.sql: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "test.dbt_idx.assert_customer_dimension_has_no_row_loss.sql"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      -- dim_customers must have the same number of rows as its staging counterpart
-- Therefore return records where this isn't true to make the test fail
select *
from (
         select dim_cust.customer_id
         from "IDX-Stock"."warehouse"."dim_customers" dim_cust
            left join "IDX-Stock"."warehouse"."stg_eltool__customers" stg_cust
         on dim_cust.customer_id = stg_cust.customer_id
         where stg_cust.customer_id is null
         UNION ALL
         select stg_cust.customer_id
         from "IDX-Stock"."warehouse"."stg_eltool__customers" stg_cust
             left join "IDX-Stock"."warehouse"."dim_customers" dim_cust
         on stg_cust.customer_id = dim_cust.customer_id
         where dim_cust.customer_id is null
     ) tmp
      
    ) dbt_internal_test
[0m18:25:57.973621 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m18:25:57.975648 [debug] [Thread-1 (]: Timing info for test.dbt_idx.assert_customer_dimension_has_no_row_loss.sql (execute): 18:25:57.927319 => 18:25:57.975648
[0m18:25:57.976653 [debug] [Thread-1 (]: On test.dbt_idx.assert_customer_dimension_has_no_row_loss.sql: ROLLBACK
[0m18:25:57.979617 [debug] [Thread-1 (]: On test.dbt_idx.assert_customer_dimension_has_no_row_loss.sql: Close
[0m18:25:57.981803 [info ] [Thread-1 (]: 2 of 9 PASS assert_customer_dimension_has_no_row_loss.sql ...................... [[32mPASS[0m in 0.07s]
[0m18:25:57.984825 [debug] [Thread-1 (]: Finished running node test.dbt_idx.assert_customer_dimension_has_no_row_loss.sql
[0m18:25:57.985821 [debug] [Thread-1 (]: Began running node test.dbt_idx.not_null_customer_orders_status_customer_id.3915c814eb
[0m18:25:57.986880 [info ] [Thread-1 (]: 3 of 9 START test not_null_customer_orders_status_customer_id .................. [RUN]
[0m18:25:57.988865 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_idx.assert_customer_dimension_has_no_row_loss.sql, now test.dbt_idx.not_null_customer_orders_status_customer_id.3915c814eb)
[0m18:25:57.988865 [debug] [Thread-1 (]: Began compiling node test.dbt_idx.not_null_customer_orders_status_customer_id.3915c814eb
[0m18:25:58.002922 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_idx.not_null_customer_orders_status_customer_id.3915c814eb"
[0m18:25:58.008103 [debug] [Thread-1 (]: Timing info for test.dbt_idx.not_null_customer_orders_status_customer_id.3915c814eb (compile): 18:25:57.990372 => 18:25:58.007121
[0m18:25:58.009085 [debug] [Thread-1 (]: Began executing node test.dbt_idx.not_null_customer_orders_status_customer_id.3915c814eb
[0m18:25:58.011666 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_idx.not_null_customer_orders_status_customer_id.3915c814eb"
[0m18:25:58.016638 [debug] [Thread-1 (]: Using postgres connection "test.dbt_idx.not_null_customer_orders_status_customer_id.3915c814eb"
[0m18:25:58.017669 [debug] [Thread-1 (]: On test.dbt_idx.not_null_customer_orders_status_customer_id.3915c814eb: BEGIN
[0m18:25:58.018672 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:25:58.045277 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m18:25:58.047285 [debug] [Thread-1 (]: Using postgres connection "test.dbt_idx.not_null_customer_orders_status_customer_id.3915c814eb"
[0m18:25:58.048285 [debug] [Thread-1 (]: On test.dbt_idx.not_null_customer_orders_status_customer_id.3915c814eb: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "test.dbt_idx.not_null_customer_orders_status_customer_id.3915c814eb"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select customer_id
from "IDX-Stock"."warehouse"."customer_orders_status"
where customer_id is null



      
    ) dbt_internal_test
[0m18:25:58.053815 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m18:25:58.057417 [debug] [Thread-1 (]: Timing info for test.dbt_idx.not_null_customer_orders_status_customer_id.3915c814eb (execute): 18:25:58.009085 => 18:25:58.056448
[0m18:25:58.058456 [debug] [Thread-1 (]: On test.dbt_idx.not_null_customer_orders_status_customer_id.3915c814eb: ROLLBACK
[0m18:25:58.060766 [debug] [Thread-1 (]: On test.dbt_idx.not_null_customer_orders_status_customer_id.3915c814eb: Close
[0m18:25:58.062667 [info ] [Thread-1 (]: 3 of 9 PASS not_null_customer_orders_status_customer_id ........................ [[32mPASS[0m in 0.07s]
[0m18:25:58.064666 [debug] [Thread-1 (]: Finished running node test.dbt_idx.not_null_customer_orders_status_customer_id.3915c814eb
[0m18:25:58.065668 [debug] [Thread-1 (]: Began running node test.dbt_idx.not_null_stg_eltool__customers_snapshots_customer_id.ea4fc4ca86
[0m18:25:58.066669 [info ] [Thread-1 (]: 4 of 9 START test not_null_stg_eltool__customers_snapshots_customer_id ......... [RUN]
[0m18:25:58.068669 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_idx.not_null_customer_orders_status_customer_id.3915c814eb, now test.dbt_idx.not_null_stg_eltool__customers_snapshots_customer_id.ea4fc4ca86)
[0m18:25:58.069671 [debug] [Thread-1 (]: Began compiling node test.dbt_idx.not_null_stg_eltool__customers_snapshots_customer_id.ea4fc4ca86
[0m18:25:58.076756 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_idx.not_null_stg_eltool__customers_snapshots_customer_id.ea4fc4ca86"
[0m18:25:58.082267 [debug] [Thread-1 (]: Timing info for test.dbt_idx.not_null_stg_eltool__customers_snapshots_customer_id.ea4fc4ca86 (compile): 18:25:58.069671 => 18:25:58.081301
[0m18:25:58.083270 [debug] [Thread-1 (]: Began executing node test.dbt_idx.not_null_stg_eltool__customers_snapshots_customer_id.ea4fc4ca86
[0m18:25:58.086308 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_idx.not_null_stg_eltool__customers_snapshots_customer_id.ea4fc4ca86"
[0m18:25:58.091835 [debug] [Thread-1 (]: Using postgres connection "test.dbt_idx.not_null_stg_eltool__customers_snapshots_customer_id.ea4fc4ca86"
[0m18:25:58.092823 [debug] [Thread-1 (]: On test.dbt_idx.not_null_stg_eltool__customers_snapshots_customer_id.ea4fc4ca86: BEGIN
[0m18:25:58.093814 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:25:58.117629 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m18:25:58.118629 [debug] [Thread-1 (]: Using postgres connection "test.dbt_idx.not_null_stg_eltool__customers_snapshots_customer_id.ea4fc4ca86"
[0m18:25:58.119630 [debug] [Thread-1 (]: On test.dbt_idx.not_null_stg_eltool__customers_snapshots_customer_id.ea4fc4ca86: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "test.dbt_idx.not_null_stg_eltool__customers_snapshots_customer_id.ea4fc4ca86"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select customer_id
from "IDX-Stock"."warehouse"."stg_eltool__customers_snapshots"
where customer_id is null



      
    ) dbt_internal_test
[0m18:25:58.122844 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m18:25:58.124867 [debug] [Thread-1 (]: Timing info for test.dbt_idx.not_null_stg_eltool__customers_snapshots_customer_id.ea4fc4ca86 (execute): 18:25:58.084327 => 18:25:58.124867
[0m18:25:58.125868 [debug] [Thread-1 (]: On test.dbt_idx.not_null_stg_eltool__customers_snapshots_customer_id.ea4fc4ca86: ROLLBACK
[0m18:25:58.127836 [debug] [Thread-1 (]: On test.dbt_idx.not_null_stg_eltool__customers_snapshots_customer_id.ea4fc4ca86: Close
[0m18:25:58.130357 [info ] [Thread-1 (]: 4 of 9 PASS not_null_stg_eltool__customers_snapshots_customer_id ............... [[32mPASS[0m in 0.06s]
[0m18:25:58.131373 [debug] [Thread-1 (]: Finished running node test.dbt_idx.not_null_stg_eltool__customers_snapshots_customer_id.ea4fc4ca86
[0m18:25:58.132372 [debug] [Thread-1 (]: Began running node test.dbt_idx.source_not_null_warehouse_customers_customer_id.ae7452c4c6
[0m18:25:58.133879 [info ] [Thread-1 (]: 5 of 9 START test source_not_null_warehouse_customers_customer_id .............. [RUN]
[0m18:25:58.135888 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_idx.not_null_stg_eltool__customers_snapshots_customer_id.ea4fc4ca86, now test.dbt_idx.source_not_null_warehouse_customers_customer_id.ae7452c4c6)
[0m18:25:58.136888 [debug] [Thread-1 (]: Began compiling node test.dbt_idx.source_not_null_warehouse_customers_customer_id.ae7452c4c6
[0m18:25:58.143502 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_idx.source_not_null_warehouse_customers_customer_id.ae7452c4c6"
[0m18:25:58.148416 [debug] [Thread-1 (]: Timing info for test.dbt_idx.source_not_null_warehouse_customers_customer_id.ae7452c4c6 (compile): 18:25:58.137887 => 18:25:58.148416
[0m18:25:58.149437 [debug] [Thread-1 (]: Began executing node test.dbt_idx.source_not_null_warehouse_customers_customer_id.ae7452c4c6
[0m18:25:58.154480 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_idx.source_not_null_warehouse_customers_customer_id.ae7452c4c6"
[0m18:25:58.160484 [debug] [Thread-1 (]: Using postgres connection "test.dbt_idx.source_not_null_warehouse_customers_customer_id.ae7452c4c6"
[0m18:25:58.162043 [debug] [Thread-1 (]: On test.dbt_idx.source_not_null_warehouse_customers_customer_id.ae7452c4c6: BEGIN
[0m18:25:58.163050 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:25:58.189629 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m18:25:58.191169 [debug] [Thread-1 (]: Using postgres connection "test.dbt_idx.source_not_null_warehouse_customers_customer_id.ae7452c4c6"
[0m18:25:58.192182 [debug] [Thread-1 (]: On test.dbt_idx.source_not_null_warehouse_customers_customer_id.ae7452c4c6: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "test.dbt_idx.source_not_null_warehouse_customers_customer_id.ae7452c4c6"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select customer_id
from "IDX-Stock"."warehouse"."customers"
where customer_id is null



      
    ) dbt_internal_test
[0m18:25:58.196785 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m18:25:58.198765 [debug] [Thread-1 (]: Timing info for test.dbt_idx.source_not_null_warehouse_customers_customer_id.ae7452c4c6 (execute): 18:25:58.150931 => 18:25:58.198765
[0m18:25:58.201313 [debug] [Thread-1 (]: On test.dbt_idx.source_not_null_warehouse_customers_customer_id.ae7452c4c6: ROLLBACK
[0m18:25:58.204319 [debug] [Thread-1 (]: On test.dbt_idx.source_not_null_warehouse_customers_customer_id.ae7452c4c6: Close
[0m18:25:58.207344 [info ] [Thread-1 (]: 5 of 9 PASS source_not_null_warehouse_customers_customer_id .................... [[32mPASS[0m in 0.07s]
[0m18:25:58.210880 [debug] [Thread-1 (]: Finished running node test.dbt_idx.source_not_null_warehouse_customers_customer_id.ae7452c4c6
[0m18:25:58.211906 [debug] [Thread-1 (]: Began running node test.dbt_idx.source_not_null_warehouse_orders_order_id.c85a1f0b76
[0m18:25:58.213920 [info ] [Thread-1 (]: 6 of 9 START test source_not_null_warehouse_orders_order_id .................... [RUN]
[0m18:25:58.215916 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_idx.source_not_null_warehouse_customers_customer_id.ae7452c4c6, now test.dbt_idx.source_not_null_warehouse_orders_order_id.c85a1f0b76)
[0m18:25:58.216915 [debug] [Thread-1 (]: Began compiling node test.dbt_idx.source_not_null_warehouse_orders_order_id.c85a1f0b76
[0m18:25:58.224146 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_idx.source_not_null_warehouse_orders_order_id.c85a1f0b76"
[0m18:25:58.230361 [debug] [Thread-1 (]: Timing info for test.dbt_idx.source_not_null_warehouse_orders_order_id.c85a1f0b76 (compile): 18:25:58.217932 => 18:25:58.229820
[0m18:25:58.231419 [debug] [Thread-1 (]: Began executing node test.dbt_idx.source_not_null_warehouse_orders_order_id.c85a1f0b76
[0m18:25:58.240514 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_idx.source_not_null_warehouse_orders_order_id.c85a1f0b76"
[0m18:25:58.248050 [debug] [Thread-1 (]: Using postgres connection "test.dbt_idx.source_not_null_warehouse_orders_order_id.c85a1f0b76"
[0m18:25:58.249050 [debug] [Thread-1 (]: On test.dbt_idx.source_not_null_warehouse_orders_order_id.c85a1f0b76: BEGIN
[0m18:25:58.251357 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:25:58.277592 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m18:25:58.278571 [debug] [Thread-1 (]: Using postgres connection "test.dbt_idx.source_not_null_warehouse_orders_order_id.c85a1f0b76"
[0m18:25:58.279571 [debug] [Thread-1 (]: On test.dbt_idx.source_not_null_warehouse_orders_order_id.c85a1f0b76: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "test.dbt_idx.source_not_null_warehouse_orders_order_id.c85a1f0b76"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select order_id
from "IDX-Stock"."warehouse"."orders"
where order_id is null



      
    ) dbt_internal_test
[0m18:25:58.283728 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m18:25:58.285731 [debug] [Thread-1 (]: Timing info for test.dbt_idx.source_not_null_warehouse_orders_order_id.c85a1f0b76 (execute): 18:25:58.233977 => 18:25:58.285731
[0m18:25:58.287242 [debug] [Thread-1 (]: On test.dbt_idx.source_not_null_warehouse_orders_order_id.c85a1f0b76: ROLLBACK
[0m18:25:58.289777 [debug] [Thread-1 (]: On test.dbt_idx.source_not_null_warehouse_orders_order_id.c85a1f0b76: Close
[0m18:25:58.293314 [info ] [Thread-1 (]: 6 of 9 PASS source_not_null_warehouse_orders_order_id .......................... [[32mPASS[0m in 0.08s]
[0m18:25:58.295310 [debug] [Thread-1 (]: Finished running node test.dbt_idx.source_not_null_warehouse_orders_order_id.c85a1f0b76
[0m18:25:58.296824 [debug] [Thread-1 (]: Began running node test.dbt_idx.source_relationships_warehouse_orders_cust_id__customer_id__source_warehouse_customers_.d3f9188fc2
[0m18:25:58.297835 [info ] [Thread-1 (]: 7 of 9 START test source_relationships_warehouse_orders_cust_id__customer_id__source_warehouse_customers_  [RUN]
[0m18:25:58.300353 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_idx.source_not_null_warehouse_orders_order_id.c85a1f0b76, now test.dbt_idx.source_relationships_warehouse_orders_cust_id__customer_id__source_warehouse_customers_.d3f9188fc2)
[0m18:25:58.301367 [debug] [Thread-1 (]: Began compiling node test.dbt_idx.source_relationships_warehouse_orders_cust_id__customer_id__source_warehouse_customers_.d3f9188fc2
[0m18:25:58.315085 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_idx.source_relationships_warehouse_orders_cust_id__customer_id__source_warehouse_customers_.d3f9188fc2"
[0m18:25:58.321167 [debug] [Thread-1 (]: Timing info for test.dbt_idx.source_relationships_warehouse_orders_cust_id__customer_id__source_warehouse_customers_.d3f9188fc2 (compile): 18:25:58.302363 => 18:25:58.321167
[0m18:25:58.322181 [debug] [Thread-1 (]: Began executing node test.dbt_idx.source_relationships_warehouse_orders_cust_id__customer_id__source_warehouse_customers_.d3f9188fc2
[0m18:25:58.327716 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_idx.source_relationships_warehouse_orders_cust_id__customer_id__source_warehouse_customers_.d3f9188fc2"
[0m18:25:58.333281 [debug] [Thread-1 (]: Using postgres connection "test.dbt_idx.source_relationships_warehouse_orders_cust_id__customer_id__source_warehouse_customers_.d3f9188fc2"
[0m18:25:58.335247 [debug] [Thread-1 (]: On test.dbt_idx.source_relationships_warehouse_orders_cust_id__customer_id__source_warehouse_customers_.d3f9188fc2: BEGIN
[0m18:25:58.336245 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:25:58.361989 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m18:25:58.363503 [debug] [Thread-1 (]: Using postgres connection "test.dbt_idx.source_relationships_warehouse_orders_cust_id__customer_id__source_warehouse_customers_.d3f9188fc2"
[0m18:25:58.364516 [debug] [Thread-1 (]: On test.dbt_idx.source_relationships_warehouse_orders_cust_id__customer_id__source_warehouse_customers_.d3f9188fc2: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "test.dbt_idx.source_relationships_warehouse_orders_cust_id__customer_id__source_warehouse_customers_.d3f9188fc2"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select cust_id as from_field
    from "IDX-Stock"."warehouse"."orders"
    where cust_id is not null
),

parent as (
    select customer_id as to_field
    from "IDX-Stock"."warehouse"."customers"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m18:25:58.369542 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m18:25:58.373675 [debug] [Thread-1 (]: Timing info for test.dbt_idx.source_relationships_warehouse_orders_cust_id__customer_id__source_warehouse_customers_.d3f9188fc2 (execute): 18:25:58.324208 => 18:25:58.373675
[0m18:25:58.374674 [debug] [Thread-1 (]: On test.dbt_idx.source_relationships_warehouse_orders_cust_id__customer_id__source_warehouse_customers_.d3f9188fc2: ROLLBACK
[0m18:25:58.378437 [debug] [Thread-1 (]: On test.dbt_idx.source_relationships_warehouse_orders_cust_id__customer_id__source_warehouse_customers_.d3f9188fc2: Close
[0m18:25:58.381171 [info ] [Thread-1 (]: 7 of 9 PASS source_relationships_warehouse_orders_cust_id__customer_id__source_warehouse_customers_  [[32mPASS[0m in 0.08s]
[0m18:25:58.384408 [debug] [Thread-1 (]: Finished running node test.dbt_idx.source_relationships_warehouse_orders_cust_id__customer_id__source_warehouse_customers_.d3f9188fc2
[0m18:25:58.386688 [debug] [Thread-1 (]: Began running node test.dbt_idx.source_unique_warehouse_orders_order_id.839fb43d0f
[0m18:25:58.387740 [info ] [Thread-1 (]: 8 of 9 START test source_unique_warehouse_orders_order_id ...................... [RUN]
[0m18:25:58.391277 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_idx.source_relationships_warehouse_orders_cust_id__customer_id__source_warehouse_customers_.d3f9188fc2, now test.dbt_idx.source_unique_warehouse_orders_order_id.839fb43d0f)
[0m18:25:58.392275 [debug] [Thread-1 (]: Began compiling node test.dbt_idx.source_unique_warehouse_orders_order_id.839fb43d0f
[0m18:25:58.403895 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_idx.source_unique_warehouse_orders_order_id.839fb43d0f"
[0m18:25:58.410402 [debug] [Thread-1 (]: Timing info for test.dbt_idx.source_unique_warehouse_orders_order_id.839fb43d0f (compile): 18:25:58.393284 => 18:25:58.408892
[0m18:25:58.411414 [debug] [Thread-1 (]: Began executing node test.dbt_idx.source_unique_warehouse_orders_order_id.839fb43d0f
[0m18:25:58.418491 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_idx.source_unique_warehouse_orders_order_id.839fb43d0f"
[0m18:25:58.425530 [debug] [Thread-1 (]: Using postgres connection "test.dbt_idx.source_unique_warehouse_orders_order_id.839fb43d0f"
[0m18:25:58.426551 [debug] [Thread-1 (]: On test.dbt_idx.source_unique_warehouse_orders_order_id.839fb43d0f: BEGIN
[0m18:25:58.427531 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:25:58.454453 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m18:25:58.454453 [debug] [Thread-1 (]: Using postgres connection "test.dbt_idx.source_unique_warehouse_orders_order_id.839fb43d0f"
[0m18:25:58.455996 [debug] [Thread-1 (]: On test.dbt_idx.source_unique_warehouse_orders_order_id.839fb43d0f: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "test.dbt_idx.source_unique_warehouse_orders_order_id.839fb43d0f"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    order_id as unique_field,
    count(*) as n_records

from "IDX-Stock"."warehouse"."orders"
where order_id is not null
group by order_id
having count(*) > 1



      
    ) dbt_internal_test
[0m18:25:58.460559 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m18:25:58.462749 [debug] [Thread-1 (]: Timing info for test.dbt_idx.source_unique_warehouse_orders_order_id.839fb43d0f (execute): 18:25:58.412413 => 18:25:58.462749
[0m18:25:58.463748 [debug] [Thread-1 (]: On test.dbt_idx.source_unique_warehouse_orders_order_id.839fb43d0f: ROLLBACK
[0m18:25:58.466264 [debug] [Thread-1 (]: On test.dbt_idx.source_unique_warehouse_orders_order_id.839fb43d0f: Close
[0m18:25:58.469271 [info ] [Thread-1 (]: 8 of 9 PASS source_unique_warehouse_orders_order_id ............................ [[32mPASS[0m in 0.08s]
[0m18:25:58.471808 [debug] [Thread-1 (]: Finished running node test.dbt_idx.source_unique_warehouse_orders_order_id.839fb43d0f
[0m18:25:58.473798 [debug] [Thread-1 (]: Began running node test.dbt_idx.unique_customer_orders_status_order_id.b7a45e83ee
[0m18:25:58.474798 [info ] [Thread-1 (]: 9 of 9 START test unique_customer_orders_status_order_id ....................... [RUN]
[0m18:25:58.475799 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_idx.source_unique_warehouse_orders_order_id.839fb43d0f, now test.dbt_idx.unique_customer_orders_status_order_id.b7a45e83ee)
[0m18:25:58.477329 [debug] [Thread-1 (]: Began compiling node test.dbt_idx.unique_customer_orders_status_order_id.b7a45e83ee
[0m18:25:58.484877 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_idx.unique_customer_orders_status_order_id.b7a45e83ee"
[0m18:25:58.490411 [debug] [Thread-1 (]: Timing info for test.dbt_idx.unique_customer_orders_status_order_id.b7a45e83ee (compile): 18:25:58.478367 => 18:25:58.489401
[0m18:25:58.491681 [debug] [Thread-1 (]: Began executing node test.dbt_idx.unique_customer_orders_status_order_id.b7a45e83ee
[0m18:25:58.498201 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_idx.unique_customer_orders_status_order_id.b7a45e83ee"
[0m18:25:58.505255 [debug] [Thread-1 (]: Using postgres connection "test.dbt_idx.unique_customer_orders_status_order_id.b7a45e83ee"
[0m18:25:58.506256 [debug] [Thread-1 (]: On test.dbt_idx.unique_customer_orders_status_order_id.b7a45e83ee: BEGIN
[0m18:25:58.507436 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:25:58.535295 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m18:25:58.537308 [debug] [Thread-1 (]: Using postgres connection "test.dbt_idx.unique_customer_orders_status_order_id.b7a45e83ee"
[0m18:25:58.538331 [debug] [Thread-1 (]: On test.dbt_idx.unique_customer_orders_status_order_id.b7a45e83ee: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "test.dbt_idx.unique_customer_orders_status_order_id.b7a45e83ee"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    order_id as unique_field,
    count(*) as n_records

from "IDX-Stock"."warehouse"."customer_orders_status"
where order_id is not null
group by order_id
having count(*) > 1



      
    ) dbt_internal_test
[0m18:25:58.544845 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m18:25:58.548362 [debug] [Thread-1 (]: Timing info for test.dbt_idx.unique_customer_orders_status_order_id.b7a45e83ee (execute): 18:25:58.492682 => 18:25:58.547363
[0m18:25:58.549366 [debug] [Thread-1 (]: On test.dbt_idx.unique_customer_orders_status_order_id.b7a45e83ee: ROLLBACK
[0m18:25:58.551445 [debug] [Thread-1 (]: On test.dbt_idx.unique_customer_orders_status_order_id.b7a45e83ee: Close
[0m18:25:58.554424 [info ] [Thread-1 (]: 9 of 9 PASS unique_customer_orders_status_order_id ............................. [[32mPASS[0m in 0.08s]
[0m18:25:58.559479 [debug] [Thread-1 (]: Finished running node test.dbt_idx.unique_customer_orders_status_order_id.b7a45e83ee
[0m18:25:58.562271 [debug] [MainThread]: Using postgres connection "master"
[0m18:25:58.564278 [debug] [MainThread]: On master: BEGIN
[0m18:25:58.565278 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:25:58.593499 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m18:25:58.593499 [debug] [MainThread]: On master: COMMIT
[0m18:25:58.595547 [debug] [MainThread]: Using postgres connection "master"
[0m18:25:58.596558 [debug] [MainThread]: On master: COMMIT
[0m18:25:58.599083 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m18:25:58.599083 [debug] [MainThread]: On master: Close
[0m18:25:58.601620 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:25:58.603630 [debug] [MainThread]: Connection 'list_IDX-Stock_snapshots' was properly closed.
[0m18:25:58.604633 [debug] [MainThread]: Connection 'test.dbt_idx.unique_customer_orders_status_order_id.b7a45e83ee' was properly closed.
[0m18:25:58.606629 [info ] [MainThread]: 
[0m18:25:58.608636 [info ] [MainThread]: Finished running 9 tests in 0 hours 0 minutes and 1.02 seconds (1.02s).
[0m18:25:58.614264 [debug] [MainThread]: Command end result
[0m18:25:58.642404 [info ] [MainThread]: 
[0m18:25:58.643400 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:25:58.644410 [info ] [MainThread]: 
[0m18:25:58.645403 [info ] [MainThread]: Done. PASS=9 WARN=0 ERROR=0 SKIP=0 TOTAL=9
[0m18:25:58.647402 [debug] [MainThread]: Command `dbt test` succeeded at 18:25:58.647402 after 1.59 seconds
[0m18:25:58.648403 [debug] [MainThread]: Flushing usage events


============================== 18:26:46.024418 | c9613df2-2c24-4a46-b238-641f2428e11b ==============================
[0m18:26:46.024418 [info ] [MainThread]: Running with dbt=1.6.1
[0m18:26:46.029478 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': 'D:\\00 Project\\00 My Project\\IdeaProjects\\Py-DBT-IDX', 'log_path': 'D:\\00 Project\\00 My Project\\IdeaProjects\\Py-DBT-IDX\\logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt test', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'False'}
[0m18:26:46.164540 [info ] [MainThread]: Registered adapter: postgres=1.6.1
[0m18:26:46.177128 [debug] [MainThread]: checksum: efe19d9f5b93d1a98cc804fbfcdb6b3aced98b974af664946fee1cde8837deb7, vars: {}, profile: , target: , version: 1.6.1
[0m18:26:46.348826 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m18:26:46.350332 [debug] [MainThread]: Partial parsing: updated file: dbt_idx://tests\assert_customer_dimension_has_no_row_loss.sql.sql
[0m18:26:46.389194 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_idx.assert_customer_dimension_has_no_row_loss.sql' (tests\assert_customer_dimension_has_no_row_loss.sql.sql) depends on a node named 'stg_eltool__customers_snapshot' in package '' which was not found
[0m18:26:46.391445 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_idx.assert_customer_dimension_has_no_row_loss.sql' (tests\assert_customer_dimension_has_no_row_loss.sql.sql) depends on a node named 'stg_eltool__customers_snapshot' in package '' which was not found
[0m18:26:46.455245 [info ] [MainThread]: Found 1 snapshot, 8 tests, 7 models, 3 sources, 0 exposures, 0 metrics, 349 macros, 0 groups, 0 semantic models
[0m18:26:46.458211 [info ] [MainThread]: 
[0m18:26:46.460717 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m18:26:46.466733 [debug] [ThreadPool]: Acquiring new postgres connection 'list_IDX-Stock_warehouse'
[0m18:26:46.481342 [debug] [ThreadPool]: Using postgres connection "list_IDX-Stock_warehouse"
[0m18:26:46.482360 [debug] [ThreadPool]: On list_IDX-Stock_warehouse: BEGIN
[0m18:26:46.483390 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:26:46.521366 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m18:26:46.523323 [debug] [ThreadPool]: Using postgres connection "list_IDX-Stock_warehouse"
[0m18:26:46.523323 [debug] [ThreadPool]: On list_IDX-Stock_warehouse: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "connection_name": "list_IDX-Stock_warehouse"} */
select
      'IDX-Stock' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'warehouse'
    union all
    select
      'IDX-Stock' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'warehouse'
    union all
    select
      'IDX-Stock' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'warehouse'
  
[0m18:26:46.528326 [debug] [ThreadPool]: SQL status: SELECT 11 in 0.0 seconds
[0m18:26:46.531553 [debug] [ThreadPool]: On list_IDX-Stock_warehouse: ROLLBACK
[0m18:26:46.534496 [debug] [ThreadPool]: On list_IDX-Stock_warehouse: Close
[0m18:26:46.537012 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_IDX-Stock_warehouse, now list_IDX-Stock_snapshots)
[0m18:26:46.546570 [debug] [ThreadPool]: Using postgres connection "list_IDX-Stock_snapshots"
[0m18:26:46.547536 [debug] [ThreadPool]: On list_IDX-Stock_snapshots: BEGIN
[0m18:26:46.548537 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:26:46.574855 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m18:26:46.575881 [debug] [ThreadPool]: Using postgres connection "list_IDX-Stock_snapshots"
[0m18:26:46.576851 [debug] [ThreadPool]: On list_IDX-Stock_snapshots: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "connection_name": "list_IDX-Stock_snapshots"} */
select
      'IDX-Stock' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'snapshots'
    union all
    select
      'IDX-Stock' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'snapshots'
    union all
    select
      'IDX-Stock' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'snapshots'
  
[0m18:26:46.583454 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.0 seconds
[0m18:26:46.585415 [debug] [ThreadPool]: On list_IDX-Stock_snapshots: ROLLBACK
[0m18:26:46.588438 [debug] [ThreadPool]: On list_IDX-Stock_snapshots: Close
[0m18:26:46.595963 [debug] [MainThread]: Using postgres connection "master"
[0m18:26:46.597004 [debug] [MainThread]: On master: BEGIN
[0m18:26:46.598006 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:26:46.620035 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m18:26:46.621143 [debug] [MainThread]: Using postgres connection "master"
[0m18:26:46.622143 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m18:26:46.629138 [debug] [MainThread]: SQL status: SELECT 6 in 0.0 seconds
[0m18:26:46.631665 [debug] [MainThread]: On master: ROLLBACK
[0m18:26:46.634661 [debug] [MainThread]: Using postgres connection "master"
[0m18:26:46.634661 [debug] [MainThread]: On master: BEGIN
[0m18:26:46.638700 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m18:26:46.640213 [debug] [MainThread]: On master: COMMIT
[0m18:26:46.640312 [debug] [MainThread]: Using postgres connection "master"
[0m18:26:46.641256 [debug] [MainThread]: On master: COMMIT
[0m18:26:46.643273 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m18:26:46.644223 [debug] [MainThread]: On master: Close
[0m18:26:46.646251 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:26:46.647221 [info ] [MainThread]: 
[0m18:26:46.654683 [debug] [Thread-1 (]: Began running node test.dbt_idx.accepted_values_customer_orders_status_order_status__delivered__invoiced__shipped__processing__canceled__unavailable.ea8c296d27
[0m18:26:46.655708 [info ] [Thread-1 (]: 1 of 8 START test accepted_values_customer_orders_status_order_status__delivered__invoiced__shipped__processing__canceled__unavailable  [RUN]
[0m18:26:46.656710 [debug] [Thread-1 (]: Acquiring new postgres connection 'test.dbt_idx.accepted_values_customer_orders_status_order_status__delivered__invoiced__shipped__processing__canceled__unavailable.ea8c296d27'
[0m18:26:46.657708 [debug] [Thread-1 (]: Began compiling node test.dbt_idx.accepted_values_customer_orders_status_order_status__delivered__invoiced__shipped__processing__canceled__unavailable.ea8c296d27
[0m18:26:46.683399 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_idx.accepted_values_customer_orders_status_order_status__delivered__invoiced__shipped__processing__canceled__unavailable.ea8c296d27"
[0m18:26:46.690362 [debug] [Thread-1 (]: Timing info for test.dbt_idx.accepted_values_customer_orders_status_order_status__delivered__invoiced__shipped__processing__canceled__unavailable.ea8c296d27 (compile): 18:26:46.658683 => 18:26:46.690362
[0m18:26:46.691483 [debug] [Thread-1 (]: Began executing node test.dbt_idx.accepted_values_customer_orders_status_order_status__delivered__invoiced__shipped__processing__canceled__unavailable.ea8c296d27
[0m18:26:46.707685 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_idx.accepted_values_customer_orders_status_order_status__delivered__invoiced__shipped__processing__canceled__unavailable.ea8c296d27"
[0m18:26:46.715262 [debug] [Thread-1 (]: Using postgres connection "test.dbt_idx.accepted_values_customer_orders_status_order_status__delivered__invoiced__shipped__processing__canceled__unavailable.ea8c296d27"
[0m18:26:46.716292 [debug] [Thread-1 (]: On test.dbt_idx.accepted_values_customer_orders_status_order_status__delivered__invoiced__shipped__processing__canceled__unavailable.ea8c296d27: BEGIN
[0m18:26:46.717274 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m18:26:46.738875 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m18:26:46.740381 [debug] [Thread-1 (]: Using postgres connection "test.dbt_idx.accepted_values_customer_orders_status_order_status__delivered__invoiced__shipped__processing__canceled__unavailable.ea8c296d27"
[0m18:26:46.740381 [debug] [Thread-1 (]: On test.dbt_idx.accepted_values_customer_orders_status_order_status__delivered__invoiced__shipped__processing__canceled__unavailable.ea8c296d27: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "test.dbt_idx.accepted_values_customer_orders_status_order_status__delivered__invoiced__shipped__processing__canceled__unavailable.ea8c296d27"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        order_status as value_field,
        count(*) as n_records

    from "IDX-Stock"."warehouse"."customer_orders_status"
    group by order_status

)

select *
from all_values
where value_field not in (
    'delivered','invoiced','shipped','processing','canceled','unavailable'
)



      
    ) dbt_internal_test
[0m18:26:46.746389 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m18:26:46.749389 [debug] [Thread-1 (]: Timing info for test.dbt_idx.accepted_values_customer_orders_status_order_status__delivered__invoiced__shipped__processing__canceled__unavailable.ea8c296d27 (execute): 18:26:46.692479 => 18:26:46.748388
[0m18:26:46.749389 [debug] [Thread-1 (]: On test.dbt_idx.accepted_values_customer_orders_status_order_status__delivered__invoiced__shipped__processing__canceled__unavailable.ea8c296d27: ROLLBACK
[0m18:26:46.751906 [debug] [Thread-1 (]: On test.dbt_idx.accepted_values_customer_orders_status_order_status__delivered__invoiced__shipped__processing__canceled__unavailable.ea8c296d27: Close
[0m18:26:46.753904 [info ] [Thread-1 (]: 1 of 8 PASS accepted_values_customer_orders_status_order_status__delivered__invoiced__shipped__processing__canceled__unavailable  [[32mPASS[0m in 0.10s]
[0m18:26:46.755917 [debug] [Thread-1 (]: Finished running node test.dbt_idx.accepted_values_customer_orders_status_order_status__delivered__invoiced__shipped__processing__canceled__unavailable.ea8c296d27
[0m18:26:46.757913 [debug] [Thread-1 (]: Began running node test.dbt_idx.not_null_customer_orders_status_customer_id.3915c814eb
[0m18:26:46.757913 [info ] [Thread-1 (]: 2 of 8 START test not_null_customer_orders_status_customer_id .................. [RUN]
[0m18:26:46.758939 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_idx.accepted_values_customer_orders_status_order_status__delivered__invoiced__shipped__processing__canceled__unavailable.ea8c296d27, now test.dbt_idx.not_null_customer_orders_status_customer_id.3915c814eb)
[0m18:26:46.760471 [debug] [Thread-1 (]: Began compiling node test.dbt_idx.not_null_customer_orders_status_customer_id.3915c814eb
[0m18:26:46.767513 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_idx.not_null_customer_orders_status_customer_id.3915c814eb"
[0m18:26:46.774679 [debug] [Thread-1 (]: Timing info for test.dbt_idx.not_null_customer_orders_status_customer_id.3915c814eb (compile): 18:26:46.760471 => 18:26:46.773683
[0m18:26:46.774679 [debug] [Thread-1 (]: Began executing node test.dbt_idx.not_null_customer_orders_status_customer_id.3915c814eb
[0m18:26:46.778703 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_idx.not_null_customer_orders_status_customer_id.3915c814eb"
[0m18:26:46.786529 [debug] [Thread-1 (]: Using postgres connection "test.dbt_idx.not_null_customer_orders_status_customer_id.3915c814eb"
[0m18:26:46.787562 [debug] [Thread-1 (]: On test.dbt_idx.not_null_customer_orders_status_customer_id.3915c814eb: BEGIN
[0m18:26:46.788564 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:26:46.812581 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m18:26:46.813592 [debug] [Thread-1 (]: Using postgres connection "test.dbt_idx.not_null_customer_orders_status_customer_id.3915c814eb"
[0m18:26:46.814592 [debug] [Thread-1 (]: On test.dbt_idx.not_null_customer_orders_status_customer_id.3915c814eb: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "test.dbt_idx.not_null_customer_orders_status_customer_id.3915c814eb"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select customer_id
from "IDX-Stock"."warehouse"."customer_orders_status"
where customer_id is null



      
    ) dbt_internal_test
[0m18:26:46.818593 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m18:26:46.820136 [debug] [Thread-1 (]: Timing info for test.dbt_idx.not_null_customer_orders_status_customer_id.3915c814eb (execute): 18:26:46.775681 => 18:26:46.820136
[0m18:26:46.821209 [debug] [Thread-1 (]: On test.dbt_idx.not_null_customer_orders_status_customer_id.3915c814eb: ROLLBACK
[0m18:26:46.824039 [debug] [Thread-1 (]: On test.dbt_idx.not_null_customer_orders_status_customer_id.3915c814eb: Close
[0m18:26:46.826054 [info ] [Thread-1 (]: 2 of 8 PASS not_null_customer_orders_status_customer_id ........................ [[32mPASS[0m in 0.07s]
[0m18:26:46.828051 [debug] [Thread-1 (]: Finished running node test.dbt_idx.not_null_customer_orders_status_customer_id.3915c814eb
[0m18:26:46.829072 [debug] [Thread-1 (]: Began running node test.dbt_idx.not_null_stg_eltool__customers_snapshots_customer_id.ea4fc4ca86
[0m18:26:46.830056 [info ] [Thread-1 (]: 3 of 8 START test not_null_stg_eltool__customers_snapshots_customer_id ......... [RUN]
[0m18:26:46.831605 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_idx.not_null_customer_orders_status_customer_id.3915c814eb, now test.dbt_idx.not_null_stg_eltool__customers_snapshots_customer_id.ea4fc4ca86)
[0m18:26:46.832624 [debug] [Thread-1 (]: Began compiling node test.dbt_idx.not_null_stg_eltool__customers_snapshots_customer_id.ea4fc4ca86
[0m18:26:46.836640 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_idx.not_null_stg_eltool__customers_snapshots_customer_id.ea4fc4ca86"
[0m18:26:46.844565 [debug] [Thread-1 (]: Timing info for test.dbt_idx.not_null_stg_eltool__customers_snapshots_customer_id.ea4fc4ca86 (compile): 18:26:46.833625 => 18:26:46.844565
[0m18:26:46.845576 [debug] [Thread-1 (]: Began executing node test.dbt_idx.not_null_stg_eltool__customers_snapshots_customer_id.ea4fc4ca86
[0m18:26:46.848576 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_idx.not_null_stg_eltool__customers_snapshots_customer_id.ea4fc4ca86"
[0m18:26:46.855090 [debug] [Thread-1 (]: Using postgres connection "test.dbt_idx.not_null_stg_eltool__customers_snapshots_customer_id.ea4fc4ca86"
[0m18:26:46.856124 [debug] [Thread-1 (]: On test.dbt_idx.not_null_stg_eltool__customers_snapshots_customer_id.ea4fc4ca86: BEGIN
[0m18:26:46.857126 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:26:46.885195 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m18:26:46.886196 [debug] [Thread-1 (]: Using postgres connection "test.dbt_idx.not_null_stg_eltool__customers_snapshots_customer_id.ea4fc4ca86"
[0m18:26:46.887227 [debug] [Thread-1 (]: On test.dbt_idx.not_null_stg_eltool__customers_snapshots_customer_id.ea4fc4ca86: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "test.dbt_idx.not_null_stg_eltool__customers_snapshots_customer_id.ea4fc4ca86"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select customer_id
from "IDX-Stock"."warehouse"."stg_eltool__customers_snapshots"
where customer_id is null



      
    ) dbt_internal_test
[0m18:26:46.890228 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m18:26:46.893746 [debug] [Thread-1 (]: Timing info for test.dbt_idx.not_null_stg_eltool__customers_snapshots_customer_id.ea4fc4ca86 (execute): 18:26:46.846577 => 18:26:46.893746
[0m18:26:46.894770 [debug] [Thread-1 (]: On test.dbt_idx.not_null_stg_eltool__customers_snapshots_customer_id.ea4fc4ca86: ROLLBACK
[0m18:26:46.896844 [debug] [Thread-1 (]: On test.dbt_idx.not_null_stg_eltool__customers_snapshots_customer_id.ea4fc4ca86: Close
[0m18:26:46.898864 [info ] [Thread-1 (]: 3 of 8 PASS not_null_stg_eltool__customers_snapshots_customer_id ............... [[32mPASS[0m in 0.07s]
[0m18:26:46.901385 [debug] [Thread-1 (]: Finished running node test.dbt_idx.not_null_stg_eltool__customers_snapshots_customer_id.ea4fc4ca86
[0m18:26:46.903386 [debug] [Thread-1 (]: Began running node test.dbt_idx.source_not_null_warehouse_customers_customer_id.ae7452c4c6
[0m18:26:46.904379 [info ] [Thread-1 (]: 4 of 8 START test source_not_null_warehouse_customers_customer_id .............. [RUN]
[0m18:26:46.906380 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_idx.not_null_stg_eltool__customers_snapshots_customer_id.ea4fc4ca86, now test.dbt_idx.source_not_null_warehouse_customers_customer_id.ae7452c4c6)
[0m18:26:46.907414 [debug] [Thread-1 (]: Began compiling node test.dbt_idx.source_not_null_warehouse_customers_customer_id.ae7452c4c6
[0m18:26:46.912011 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_idx.source_not_null_warehouse_customers_customer_id.ae7452c4c6"
[0m18:26:46.918936 [debug] [Thread-1 (]: Timing info for test.dbt_idx.source_not_null_warehouse_customers_customer_id.ae7452c4c6 (compile): 18:26:46.907414 => 18:26:46.918936
[0m18:26:46.920444 [debug] [Thread-1 (]: Began executing node test.dbt_idx.source_not_null_warehouse_customers_customer_id.ae7452c4c6
[0m18:26:46.924453 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_idx.source_not_null_warehouse_customers_customer_id.ae7452c4c6"
[0m18:26:46.930993 [debug] [Thread-1 (]: Using postgres connection "test.dbt_idx.source_not_null_warehouse_customers_customer_id.ae7452c4c6"
[0m18:26:46.932000 [debug] [Thread-1 (]: On test.dbt_idx.source_not_null_warehouse_customers_customer_id.ae7452c4c6: BEGIN
[0m18:26:46.933013 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:26:46.956603 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m18:26:46.957613 [debug] [Thread-1 (]: Using postgres connection "test.dbt_idx.source_not_null_warehouse_customers_customer_id.ae7452c4c6"
[0m18:26:46.958613 [debug] [Thread-1 (]: On test.dbt_idx.source_not_null_warehouse_customers_customer_id.ae7452c4c6: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "test.dbt_idx.source_not_null_warehouse_customers_customer_id.ae7452c4c6"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select customer_id
from "IDX-Stock"."warehouse"."customers"
where customer_id is null



      
    ) dbt_internal_test
[0m18:26:46.961161 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m18:26:46.963167 [debug] [Thread-1 (]: Timing info for test.dbt_idx.source_not_null_warehouse_customers_customer_id.ae7452c4c6 (execute): 18:26:46.921469 => 18:26:46.963167
[0m18:26:46.964196 [debug] [Thread-1 (]: On test.dbt_idx.source_not_null_warehouse_customers_customer_id.ae7452c4c6: ROLLBACK
[0m18:26:46.966199 [debug] [Thread-1 (]: On test.dbt_idx.source_not_null_warehouse_customers_customer_id.ae7452c4c6: Close
[0m18:26:46.968166 [info ] [Thread-1 (]: 4 of 8 PASS source_not_null_warehouse_customers_customer_id .................... [[32mPASS[0m in 0.06s]
[0m18:26:46.970172 [debug] [Thread-1 (]: Finished running node test.dbt_idx.source_not_null_warehouse_customers_customer_id.ae7452c4c6
[0m18:26:46.971647 [debug] [Thread-1 (]: Began running node test.dbt_idx.source_not_null_warehouse_orders_order_id.c85a1f0b76
[0m18:26:46.972652 [info ] [Thread-1 (]: 5 of 8 START test source_not_null_warehouse_orders_order_id .................... [RUN]
[0m18:26:46.973659 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_idx.source_not_null_warehouse_customers_customer_id.ae7452c4c6, now test.dbt_idx.source_not_null_warehouse_orders_order_id.c85a1f0b76)
[0m18:26:46.974689 [debug] [Thread-1 (]: Began compiling node test.dbt_idx.source_not_null_warehouse_orders_order_id.c85a1f0b76
[0m18:26:46.978689 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_idx.source_not_null_warehouse_orders_order_id.c85a1f0b76"
[0m18:26:46.987287 [debug] [Thread-1 (]: Timing info for test.dbt_idx.source_not_null_warehouse_orders_order_id.c85a1f0b76 (compile): 18:26:46.975688 => 18:26:46.987287
[0m18:26:46.988250 [debug] [Thread-1 (]: Began executing node test.dbt_idx.source_not_null_warehouse_orders_order_id.c85a1f0b76
[0m18:26:46.991762 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_idx.source_not_null_warehouse_orders_order_id.c85a1f0b76"
[0m18:26:46.998082 [debug] [Thread-1 (]: Using postgres connection "test.dbt_idx.source_not_null_warehouse_orders_order_id.c85a1f0b76"
[0m18:26:46.999083 [debug] [Thread-1 (]: On test.dbt_idx.source_not_null_warehouse_orders_order_id.c85a1f0b76: BEGIN
[0m18:26:47.000084 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:26:47.024392 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m18:26:47.025396 [debug] [Thread-1 (]: Using postgres connection "test.dbt_idx.source_not_null_warehouse_orders_order_id.c85a1f0b76"
[0m18:26:47.026389 [debug] [Thread-1 (]: On test.dbt_idx.source_not_null_warehouse_orders_order_id.c85a1f0b76: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "test.dbt_idx.source_not_null_warehouse_orders_order_id.c85a1f0b76"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select order_id
from "IDX-Stock"."warehouse"."orders"
where order_id is null



      
    ) dbt_internal_test
[0m18:26:47.028415 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m18:26:47.030904 [debug] [Thread-1 (]: Timing info for test.dbt_idx.source_not_null_warehouse_orders_order_id.c85a1f0b76 (execute): 18:26:46.989249 => 18:26:47.030904
[0m18:26:47.031916 [debug] [Thread-1 (]: On test.dbt_idx.source_not_null_warehouse_orders_order_id.c85a1f0b76: ROLLBACK
[0m18:26:47.033871 [debug] [Thread-1 (]: On test.dbt_idx.source_not_null_warehouse_orders_order_id.c85a1f0b76: Close
[0m18:26:47.035912 [info ] [Thread-1 (]: 5 of 8 PASS source_not_null_warehouse_orders_order_id .......................... [[32mPASS[0m in 0.06s]
[0m18:26:47.037888 [debug] [Thread-1 (]: Finished running node test.dbt_idx.source_not_null_warehouse_orders_order_id.c85a1f0b76
[0m18:26:47.038888 [debug] [Thread-1 (]: Began running node test.dbt_idx.source_relationships_warehouse_orders_cust_id__customer_id__source_warehouse_customers_.d3f9188fc2
[0m18:26:47.038888 [info ] [Thread-1 (]: 6 of 8 START test source_relationships_warehouse_orders_cust_id__customer_id__source_warehouse_customers_  [RUN]
[0m18:26:47.040394 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_idx.source_not_null_warehouse_orders_order_id.c85a1f0b76, now test.dbt_idx.source_relationships_warehouse_orders_cust_id__customer_id__source_warehouse_customers_.d3f9188fc2)
[0m18:26:47.041406 [debug] [Thread-1 (]: Began compiling node test.dbt_idx.source_relationships_warehouse_orders_cust_id__customer_id__source_warehouse_customers_.d3f9188fc2
[0m18:26:47.054919 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_idx.source_relationships_warehouse_orders_cust_id__customer_id__source_warehouse_customers_.d3f9188fc2"
[0m18:26:47.063439 [debug] [Thread-1 (]: Timing info for test.dbt_idx.source_relationships_warehouse_orders_cust_id__customer_id__source_warehouse_customers_.d3f9188fc2 (compile): 18:26:47.042405 => 18:26:47.063439
[0m18:26:47.064469 [debug] [Thread-1 (]: Began executing node test.dbt_idx.source_relationships_warehouse_orders_cust_id__customer_id__source_warehouse_customers_.d3f9188fc2
[0m18:26:47.067439 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_idx.source_relationships_warehouse_orders_cust_id__customer_id__source_warehouse_customers_.d3f9188fc2"
[0m18:26:47.075354 [debug] [Thread-1 (]: Using postgres connection "test.dbt_idx.source_relationships_warehouse_orders_cust_id__customer_id__source_warehouse_customers_.d3f9188fc2"
[0m18:26:47.075354 [debug] [Thread-1 (]: On test.dbt_idx.source_relationships_warehouse_orders_cust_id__customer_id__source_warehouse_customers_.d3f9188fc2: BEGIN
[0m18:26:47.076354 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:26:47.099026 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m18:26:47.099026 [debug] [Thread-1 (]: Using postgres connection "test.dbt_idx.source_relationships_warehouse_orders_cust_id__customer_id__source_warehouse_customers_.d3f9188fc2"
[0m18:26:47.100611 [debug] [Thread-1 (]: On test.dbt_idx.source_relationships_warehouse_orders_cust_id__customer_id__source_warehouse_customers_.d3f9188fc2: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "test.dbt_idx.source_relationships_warehouse_orders_cust_id__customer_id__source_warehouse_customers_.d3f9188fc2"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select cust_id as from_field
    from "IDX-Stock"."warehouse"."orders"
    where cust_id is not null
),

parent as (
    select customer_id as to_field
    from "IDX-Stock"."warehouse"."customers"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m18:26:47.103578 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m18:26:47.106548 [debug] [Thread-1 (]: Timing info for test.dbt_idx.source_relationships_warehouse_orders_cust_id__customer_id__source_warehouse_customers_.d3f9188fc2 (execute): 18:26:47.065472 => 18:26:47.105547
[0m18:26:47.106548 [debug] [Thread-1 (]: On test.dbt_idx.source_relationships_warehouse_orders_cust_id__customer_id__source_warehouse_customers_.d3f9188fc2: ROLLBACK
[0m18:26:47.109556 [debug] [Thread-1 (]: On test.dbt_idx.source_relationships_warehouse_orders_cust_id__customer_id__source_warehouse_customers_.d3f9188fc2: Close
[0m18:26:47.111076 [info ] [Thread-1 (]: 6 of 8 PASS source_relationships_warehouse_orders_cust_id__customer_id__source_warehouse_customers_  [[32mPASS[0m in 0.07s]
[0m18:26:47.113073 [debug] [Thread-1 (]: Finished running node test.dbt_idx.source_relationships_warehouse_orders_cust_id__customer_id__source_warehouse_customers_.d3f9188fc2
[0m18:26:47.115075 [debug] [Thread-1 (]: Began running node test.dbt_idx.source_unique_warehouse_orders_order_id.839fb43d0f
[0m18:26:47.116071 [info ] [Thread-1 (]: 7 of 8 START test source_unique_warehouse_orders_order_id ...................... [RUN]
[0m18:26:47.119073 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_idx.source_relationships_warehouse_orders_cust_id__customer_id__source_warehouse_customers_.d3f9188fc2, now test.dbt_idx.source_unique_warehouse_orders_order_id.839fb43d0f)
[0m18:26:47.120098 [debug] [Thread-1 (]: Began compiling node test.dbt_idx.source_unique_warehouse_orders_order_id.839fb43d0f
[0m18:26:47.129276 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_idx.source_unique_warehouse_orders_order_id.839fb43d0f"
[0m18:26:47.137763 [debug] [Thread-1 (]: Timing info for test.dbt_idx.source_unique_warehouse_orders_order_id.839fb43d0f (compile): 18:26:47.120098 => 18:26:47.136779
[0m18:26:47.138748 [debug] [Thread-1 (]: Began executing node test.dbt_idx.source_unique_warehouse_orders_order_id.839fb43d0f
[0m18:26:47.141271 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_idx.source_unique_warehouse_orders_order_id.839fb43d0f"
[0m18:26:47.149278 [debug] [Thread-1 (]: Using postgres connection "test.dbt_idx.source_unique_warehouse_orders_order_id.839fb43d0f"
[0m18:26:47.150219 [debug] [Thread-1 (]: On test.dbt_idx.source_unique_warehouse_orders_order_id.839fb43d0f: BEGIN
[0m18:26:47.150219 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:26:47.174194 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m18:26:47.175212 [debug] [Thread-1 (]: Using postgres connection "test.dbt_idx.source_unique_warehouse_orders_order_id.839fb43d0f"
[0m18:26:47.176173 [debug] [Thread-1 (]: On test.dbt_idx.source_unique_warehouse_orders_order_id.839fb43d0f: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "test.dbt_idx.source_unique_warehouse_orders_order_id.839fb43d0f"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    order_id as unique_field,
    count(*) as n_records

from "IDX-Stock"."warehouse"."orders"
where order_id is not null
group by order_id
having count(*) > 1



      
    ) dbt_internal_test
[0m18:26:47.180171 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m18:26:47.182367 [debug] [Thread-1 (]: Timing info for test.dbt_idx.source_unique_warehouse_orders_order_id.839fb43d0f (execute): 18:26:47.138748 => 18:26:47.182367
[0m18:26:47.183365 [debug] [Thread-1 (]: On test.dbt_idx.source_unique_warehouse_orders_order_id.839fb43d0f: ROLLBACK
[0m18:26:47.185339 [debug] [Thread-1 (]: On test.dbt_idx.source_unique_warehouse_orders_order_id.839fb43d0f: Close
[0m18:26:47.187367 [info ] [Thread-1 (]: 7 of 8 PASS source_unique_warehouse_orders_order_id ............................ [[32mPASS[0m in 0.07s]
[0m18:26:47.189346 [debug] [Thread-1 (]: Finished running node test.dbt_idx.source_unique_warehouse_orders_order_id.839fb43d0f
[0m18:26:47.190346 [debug] [Thread-1 (]: Began running node test.dbt_idx.unique_customer_orders_status_order_id.b7a45e83ee
[0m18:26:47.191380 [info ] [Thread-1 (]: 8 of 8 START test unique_customer_orders_status_order_id ....................... [RUN]
[0m18:26:47.193398 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_idx.source_unique_warehouse_orders_order_id.839fb43d0f, now test.dbt_idx.unique_customer_orders_status_order_id.b7a45e83ee)
[0m18:26:47.194382 [debug] [Thread-1 (]: Began compiling node test.dbt_idx.unique_customer_orders_status_order_id.b7a45e83ee
[0m18:26:47.198939 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_idx.unique_customer_orders_status_order_id.b7a45e83ee"
[0m18:26:47.207810 [debug] [Thread-1 (]: Timing info for test.dbt_idx.unique_customer_orders_status_order_id.b7a45e83ee (compile): 18:26:47.195893 => 18:26:47.206811
[0m18:26:47.208811 [debug] [Thread-1 (]: Began executing node test.dbt_idx.unique_customer_orders_status_order_id.b7a45e83ee
[0m18:26:47.211397 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_idx.unique_customer_orders_status_order_id.b7a45e83ee"
[0m18:26:47.219382 [debug] [Thread-1 (]: Using postgres connection "test.dbt_idx.unique_customer_orders_status_order_id.b7a45e83ee"
[0m18:26:47.220395 [debug] [Thread-1 (]: On test.dbt_idx.unique_customer_orders_status_order_id.b7a45e83ee: BEGIN
[0m18:26:47.220395 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:26:47.245736 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m18:26:47.246740 [debug] [Thread-1 (]: Using postgres connection "test.dbt_idx.unique_customer_orders_status_order_id.b7a45e83ee"
[0m18:26:47.247765 [debug] [Thread-1 (]: On test.dbt_idx.unique_customer_orders_status_order_id.b7a45e83ee: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "test.dbt_idx.unique_customer_orders_status_order_id.b7a45e83ee"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    order_id as unique_field,
    count(*) as n_records

from "IDX-Stock"."warehouse"."customer_orders_status"
where order_id is not null
group by order_id
having count(*) > 1



      
    ) dbt_internal_test
[0m18:26:47.252272 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m18:26:47.255270 [debug] [Thread-1 (]: Timing info for test.dbt_idx.unique_customer_orders_status_order_id.b7a45e83ee (execute): 18:26:47.208811 => 18:26:47.254272
[0m18:26:47.256271 [debug] [Thread-1 (]: On test.dbt_idx.unique_customer_orders_status_order_id.b7a45e83ee: ROLLBACK
[0m18:26:47.258315 [debug] [Thread-1 (]: On test.dbt_idx.unique_customer_orders_status_order_id.b7a45e83ee: Close
[0m18:26:47.260284 [info ] [Thread-1 (]: 8 of 8 PASS unique_customer_orders_status_order_id ............................. [[32mPASS[0m in 0.07s]
[0m18:26:47.262519 [debug] [Thread-1 (]: Finished running node test.dbt_idx.unique_customer_orders_status_order_id.b7a45e83ee
[0m18:26:47.266948 [debug] [MainThread]: Using postgres connection "master"
[0m18:26:47.266948 [debug] [MainThread]: On master: BEGIN
[0m18:26:47.267964 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:26:47.292535 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m18:26:47.293535 [debug] [MainThread]: On master: COMMIT
[0m18:26:47.293535 [debug] [MainThread]: Using postgres connection "master"
[0m18:26:47.294535 [debug] [MainThread]: On master: COMMIT
[0m18:26:47.297086 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m18:26:47.298119 [debug] [MainThread]: On master: Close
[0m18:26:47.299090 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:26:47.301613 [debug] [MainThread]: Connection 'list_IDX-Stock_snapshots' was properly closed.
[0m18:26:47.301613 [debug] [MainThread]: Connection 'test.dbt_idx.unique_customer_orders_status_order_id.b7a45e83ee' was properly closed.
[0m18:26:47.303625 [info ] [MainThread]: 
[0m18:26:47.304619 [info ] [MainThread]: Finished running 8 tests in 0 hours 0 minutes and 0.84 seconds (0.84s).
[0m18:26:47.306654 [debug] [MainThread]: Command end result
[0m18:26:47.330348 [info ] [MainThread]: 
[0m18:26:47.331641 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:26:47.332649 [info ] [MainThread]: 
[0m18:26:47.334649 [info ] [MainThread]: Done. PASS=8 WARN=0 ERROR=0 SKIP=0 TOTAL=8
[0m18:26:47.335649 [debug] [MainThread]: Command `dbt test` succeeded at 18:26:47.335649 after 1.35 seconds
[0m18:26:47.336658 [debug] [MainThread]: Flushing usage events


============================== 18:27:53.909075 | 04dd2799-ef36-42d7-a29b-ea7fdbb98787 ==============================
[0m18:27:53.909075 [info ] [MainThread]: Running with dbt=1.6.1
[0m18:27:53.915510 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': 'D:\\00 Project\\00 My Project\\IdeaProjects\\Py-DBT-IDX', 'log_path': 'D:\\00 Project\\00 My Project\\IdeaProjects\\Py-DBT-IDX\\logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt test', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'False'}
[0m18:27:54.092853 [info ] [MainThread]: Registered adapter: postgres=1.6.1
[0m18:27:54.104353 [debug] [MainThread]: checksum: efe19d9f5b93d1a98cc804fbfcdb6b3aced98b974af664946fee1cde8837deb7, vars: {}, profile: , target: , version: 1.6.1
[0m18:27:54.292808 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m18:27:54.293808 [debug] [MainThread]: Partial parsing: updated file: dbt_idx://tests\assert_customer_dimension_has_no_row_loss.sql.sql
[0m18:27:54.320357 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_idx.assert_customer_dimension_has_no_row_loss.sql' (tests\assert_customer_dimension_has_no_row_loss.sql.sql) depends on a node named 'stg_eltool__customers_snapshot' in package '' which was not found
[0m18:27:54.322387 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_idx.assert_customer_dimension_has_no_row_loss.sql' (tests\assert_customer_dimension_has_no_row_loss.sql.sql) depends on a node named 'stg_eltool__customers_snapshot' in package '' which was not found
[0m18:27:54.371217 [info ] [MainThread]: Found 1 snapshot, 8 tests, 7 models, 3 sources, 0 exposures, 0 metrics, 349 macros, 0 groups, 0 semantic models
[0m18:27:54.374300 [info ] [MainThread]: 
[0m18:27:54.375320 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m18:27:54.378563 [debug] [ThreadPool]: Acquiring new postgres connection 'list_IDX-Stock_snapshots'
[0m18:27:54.389115 [debug] [ThreadPool]: Using postgres connection "list_IDX-Stock_snapshots"
[0m18:27:54.390149 [debug] [ThreadPool]: On list_IDX-Stock_snapshots: BEGIN
[0m18:27:54.391264 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:27:54.426412 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m18:27:54.428413 [debug] [ThreadPool]: Using postgres connection "list_IDX-Stock_snapshots"
[0m18:27:54.428413 [debug] [ThreadPool]: On list_IDX-Stock_snapshots: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "connection_name": "list_IDX-Stock_snapshots"} */
select
      'IDX-Stock' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'snapshots'
    union all
    select
      'IDX-Stock' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'snapshots'
    union all
    select
      'IDX-Stock' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'snapshots'
  
[0m18:27:54.433932 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.0 seconds
[0m18:27:54.435928 [debug] [ThreadPool]: On list_IDX-Stock_snapshots: ROLLBACK
[0m18:27:54.437939 [debug] [ThreadPool]: On list_IDX-Stock_snapshots: Close
[0m18:27:54.440436 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_IDX-Stock_snapshots, now list_IDX-Stock_warehouse)
[0m18:27:54.444445 [debug] [ThreadPool]: Using postgres connection "list_IDX-Stock_warehouse"
[0m18:27:54.445444 [debug] [ThreadPool]: On list_IDX-Stock_warehouse: BEGIN
[0m18:27:54.446454 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:27:54.467522 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m18:27:54.468538 [debug] [ThreadPool]: Using postgres connection "list_IDX-Stock_warehouse"
[0m18:27:54.468538 [debug] [ThreadPool]: On list_IDX-Stock_warehouse: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "connection_name": "list_IDX-Stock_warehouse"} */
select
      'IDX-Stock' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'warehouse'
    union all
    select
      'IDX-Stock' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'warehouse'
    union all
    select
      'IDX-Stock' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'warehouse'
  
[0m18:27:54.474062 [debug] [ThreadPool]: SQL status: SELECT 11 in 0.0 seconds
[0m18:27:54.476096 [debug] [ThreadPool]: On list_IDX-Stock_warehouse: ROLLBACK
[0m18:27:54.478056 [debug] [ThreadPool]: On list_IDX-Stock_warehouse: Close
[0m18:27:54.489845 [debug] [MainThread]: Using postgres connection "master"
[0m18:27:54.490893 [debug] [MainThread]: On master: BEGIN
[0m18:27:54.491852 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:27:54.517661 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m18:27:54.518629 [debug] [MainThread]: Using postgres connection "master"
[0m18:27:54.518629 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m18:27:54.529170 [debug] [MainThread]: SQL status: SELECT 6 in 0.0 seconds
[0m18:27:54.532682 [debug] [MainThread]: On master: ROLLBACK
[0m18:27:54.535684 [debug] [MainThread]: Using postgres connection "master"
[0m18:27:54.536707 [debug] [MainThread]: On master: BEGIN
[0m18:27:54.541208 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m18:27:54.542212 [debug] [MainThread]: On master: COMMIT
[0m18:27:54.543234 [debug] [MainThread]: Using postgres connection "master"
[0m18:27:54.544226 [debug] [MainThread]: On master: COMMIT
[0m18:27:54.546209 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m18:27:54.547223 [debug] [MainThread]: On master: Close
[0m18:27:54.548229 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:27:54.550215 [info ] [MainThread]: 
[0m18:27:54.556621 [debug] [Thread-1 (]: Began running node test.dbt_idx.accepted_values_customer_orders_status_order_status__delivered__invoiced__shipped__processing__canceled__unavailable.ea8c296d27
[0m18:27:54.556621 [info ] [Thread-1 (]: 1 of 8 START test accepted_values_customer_orders_status_order_status__delivered__invoiced__shipped__processing__canceled__unavailable  [RUN]
[0m18:27:54.559243 [debug] [Thread-1 (]: Acquiring new postgres connection 'test.dbt_idx.accepted_values_customer_orders_status_order_status__delivered__invoiced__shipped__processing__canceled__unavailable.ea8c296d27'
[0m18:27:54.560147 [debug] [Thread-1 (]: Began compiling node test.dbt_idx.accepted_values_customer_orders_status_order_status__delivered__invoiced__shipped__processing__canceled__unavailable.ea8c296d27
[0m18:27:54.580722 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_idx.accepted_values_customer_orders_status_order_status__delivered__invoiced__shipped__processing__canceled__unavailable.ea8c296d27"
[0m18:27:54.590249 [debug] [Thread-1 (]: Timing info for test.dbt_idx.accepted_values_customer_orders_status_order_status__delivered__invoiced__shipped__processing__canceled__unavailable.ea8c296d27 (compile): 18:27:54.560660 => 18:27:54.590249
[0m18:27:54.591176 [debug] [Thread-1 (]: Began executing node test.dbt_idx.accepted_values_customer_orders_status_order_status__delivered__invoiced__shipped__processing__canceled__unavailable.ea8c296d27
[0m18:27:54.606627 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_idx.accepted_values_customer_orders_status_order_status__delivered__invoiced__shipped__processing__canceled__unavailable.ea8c296d27"
[0m18:27:54.613156 [debug] [Thread-1 (]: Using postgres connection "test.dbt_idx.accepted_values_customer_orders_status_order_status__delivered__invoiced__shipped__processing__canceled__unavailable.ea8c296d27"
[0m18:27:54.614168 [debug] [Thread-1 (]: On test.dbt_idx.accepted_values_customer_orders_status_order_status__delivered__invoiced__shipped__processing__canceled__unavailable.ea8c296d27: BEGIN
[0m18:27:54.615167 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m18:27:54.637134 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m18:27:54.638150 [debug] [Thread-1 (]: Using postgres connection "test.dbt_idx.accepted_values_customer_orders_status_order_status__delivered__invoiced__shipped__processing__canceled__unavailable.ea8c296d27"
[0m18:27:54.639114 [debug] [Thread-1 (]: On test.dbt_idx.accepted_values_customer_orders_status_order_status__delivered__invoiced__shipped__processing__canceled__unavailable.ea8c296d27: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "test.dbt_idx.accepted_values_customer_orders_status_order_status__delivered__invoiced__shipped__processing__canceled__unavailable.ea8c296d27"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        order_status as value_field,
        count(*) as n_records

    from "IDX-Stock"."warehouse"."customer_orders_status"
    group by order_status

)

select *
from all_values
where value_field not in (
    'delivered','invoiced','shipped','processing','canceled','unavailable'
)



      
    ) dbt_internal_test
[0m18:27:54.642487 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m18:27:54.645481 [debug] [Thread-1 (]: Timing info for test.dbt_idx.accepted_values_customer_orders_status_order_status__delivered__invoiced__shipped__processing__canceled__unavailable.ea8c296d27 (execute): 18:27:54.592151 => 18:27:54.645481
[0m18:27:54.646481 [debug] [Thread-1 (]: On test.dbt_idx.accepted_values_customer_orders_status_order_status__delivered__invoiced__shipped__processing__canceled__unavailable.ea8c296d27: ROLLBACK
[0m18:27:54.648482 [debug] [Thread-1 (]: On test.dbt_idx.accepted_values_customer_orders_status_order_status__delivered__invoiced__shipped__processing__canceled__unavailable.ea8c296d27: Close
[0m18:27:54.650998 [info ] [Thread-1 (]: 1 of 8 PASS accepted_values_customer_orders_status_order_status__delivered__invoiced__shipped__processing__canceled__unavailable  [[32mPASS[0m in 0.09s]
[0m18:27:54.654044 [debug] [Thread-1 (]: Finished running node test.dbt_idx.accepted_values_customer_orders_status_order_status__delivered__invoiced__shipped__processing__canceled__unavailable.ea8c296d27
[0m18:27:54.656033 [debug] [Thread-1 (]: Began running node test.dbt_idx.not_null_customer_orders_status_customer_id.3915c814eb
[0m18:27:54.657013 [info ] [Thread-1 (]: 2 of 8 START test not_null_customer_orders_status_customer_id .................. [RUN]
[0m18:27:54.659521 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_idx.accepted_values_customer_orders_status_order_status__delivered__invoiced__shipped__processing__canceled__unavailable.ea8c296d27, now test.dbt_idx.not_null_customer_orders_status_customer_id.3915c814eb)
[0m18:27:54.660031 [debug] [Thread-1 (]: Began compiling node test.dbt_idx.not_null_customer_orders_status_customer_id.3915c814eb
[0m18:27:54.672562 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_idx.not_null_customer_orders_status_customer_id.3915c814eb"
[0m18:27:54.681167 [debug] [Thread-1 (]: Timing info for test.dbt_idx.not_null_customer_orders_status_customer_id.3915c814eb (compile): 18:27:54.661043 => 18:27:54.681167
[0m18:27:54.682145 [debug] [Thread-1 (]: Began executing node test.dbt_idx.not_null_customer_orders_status_customer_id.3915c814eb
[0m18:27:54.686151 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_idx.not_null_customer_orders_status_customer_id.3915c814eb"
[0m18:27:54.693172 [debug] [Thread-1 (]: Using postgres connection "test.dbt_idx.not_null_customer_orders_status_customer_id.3915c814eb"
[0m18:27:54.694183 [debug] [Thread-1 (]: On test.dbt_idx.not_null_customer_orders_status_customer_id.3915c814eb: BEGIN
[0m18:27:54.695183 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:27:54.719815 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m18:27:54.720998 [debug] [Thread-1 (]: Using postgres connection "test.dbt_idx.not_null_customer_orders_status_customer_id.3915c814eb"
[0m18:27:54.720998 [debug] [Thread-1 (]: On test.dbt_idx.not_null_customer_orders_status_customer_id.3915c814eb: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "test.dbt_idx.not_null_customer_orders_status_customer_id.3915c814eb"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select customer_id
from "IDX-Stock"."warehouse"."customer_orders_status"
where customer_id is null



      
    ) dbt_internal_test
[0m18:27:54.725027 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m18:27:54.727004 [debug] [Thread-1 (]: Timing info for test.dbt_idx.not_null_customer_orders_status_customer_id.3915c814eb (execute): 18:27:54.683151 => 18:27:54.727004
[0m18:27:54.728004 [debug] [Thread-1 (]: On test.dbt_idx.not_null_customer_orders_status_customer_id.3915c814eb: ROLLBACK
[0m18:27:54.730007 [debug] [Thread-1 (]: On test.dbt_idx.not_null_customer_orders_status_customer_id.3915c814eb: Close
[0m18:27:54.733316 [info ] [Thread-1 (]: 2 of 8 PASS not_null_customer_orders_status_customer_id ........................ [[32mPASS[0m in 0.07s]
[0m18:27:54.735351 [debug] [Thread-1 (]: Finished running node test.dbt_idx.not_null_customer_orders_status_customer_id.3915c814eb
[0m18:27:54.736319 [debug] [Thread-1 (]: Began running node test.dbt_idx.not_null_stg_eltool__customers_snapshots_customer_id.ea4fc4ca86
[0m18:27:54.738311 [info ] [Thread-1 (]: 3 of 8 START test not_null_stg_eltool__customers_snapshots_customer_id ......... [RUN]
[0m18:27:54.739882 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_idx.not_null_customer_orders_status_customer_id.3915c814eb, now test.dbt_idx.not_null_stg_eltool__customers_snapshots_customer_id.ea4fc4ca86)
[0m18:27:54.741890 [debug] [Thread-1 (]: Began compiling node test.dbt_idx.not_null_stg_eltool__customers_snapshots_customer_id.ea4fc4ca86
[0m18:27:54.747891 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_idx.not_null_stg_eltool__customers_snapshots_customer_id.ea4fc4ca86"
[0m18:27:54.754471 [debug] [Thread-1 (]: Timing info for test.dbt_idx.not_null_stg_eltool__customers_snapshots_customer_id.ea4fc4ca86 (compile): 18:27:54.742890 => 18:27:54.754471
[0m18:27:54.755438 [debug] [Thread-1 (]: Began executing node test.dbt_idx.not_null_stg_eltool__customers_snapshots_customer_id.ea4fc4ca86
[0m18:27:54.757472 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_idx.not_null_stg_eltool__customers_snapshots_customer_id.ea4fc4ca86"
[0m18:27:54.764272 [debug] [Thread-1 (]: Using postgres connection "test.dbt_idx.not_null_stg_eltool__customers_snapshots_customer_id.ea4fc4ca86"
[0m18:27:54.765236 [debug] [Thread-1 (]: On test.dbt_idx.not_null_stg_eltool__customers_snapshots_customer_id.ea4fc4ca86: BEGIN
[0m18:27:54.766238 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:27:54.790219 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m18:27:54.791351 [debug] [Thread-1 (]: Using postgres connection "test.dbt_idx.not_null_stg_eltool__customers_snapshots_customer_id.ea4fc4ca86"
[0m18:27:54.792358 [debug] [Thread-1 (]: On test.dbt_idx.not_null_stg_eltool__customers_snapshots_customer_id.ea4fc4ca86: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "test.dbt_idx.not_null_stg_eltool__customers_snapshots_customer_id.ea4fc4ca86"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select customer_id
from "IDX-Stock"."warehouse"."stg_eltool__customers_snapshots"
where customer_id is null



      
    ) dbt_internal_test
[0m18:27:54.795365 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m18:27:54.797357 [debug] [Thread-1 (]: Timing info for test.dbt_idx.not_null_stg_eltool__customers_snapshots_customer_id.ea4fc4ca86 (execute): 18:27:54.756436 => 18:27:54.797357
[0m18:27:54.798372 [debug] [Thread-1 (]: On test.dbt_idx.not_null_stg_eltool__customers_snapshots_customer_id.ea4fc4ca86: ROLLBACK
[0m18:27:54.800917 [debug] [Thread-1 (]: On test.dbt_idx.not_null_stg_eltool__customers_snapshots_customer_id.ea4fc4ca86: Close
[0m18:27:54.802945 [info ] [Thread-1 (]: 3 of 8 PASS not_null_stg_eltool__customers_snapshots_customer_id ............... [[32mPASS[0m in 0.06s]
[0m18:27:54.805947 [debug] [Thread-1 (]: Finished running node test.dbt_idx.not_null_stg_eltool__customers_snapshots_customer_id.ea4fc4ca86
[0m18:27:54.807945 [debug] [Thread-1 (]: Began running node test.dbt_idx.source_not_null_warehouse_customers_customer_id.ae7452c4c6
[0m18:27:54.808946 [info ] [Thread-1 (]: 4 of 8 START test source_not_null_warehouse_customers_customer_id .............. [RUN]
[0m18:27:54.811411 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_idx.not_null_stg_eltool__customers_snapshots_customer_id.ea4fc4ca86, now test.dbt_idx.source_not_null_warehouse_customers_customer_id.ae7452c4c6)
[0m18:27:54.812409 [debug] [Thread-1 (]: Began compiling node test.dbt_idx.source_not_null_warehouse_customers_customer_id.ae7452c4c6
[0m18:27:54.818452 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_idx.source_not_null_warehouse_customers_customer_id.ae7452c4c6"
[0m18:27:54.824957 [debug] [Thread-1 (]: Timing info for test.dbt_idx.source_not_null_warehouse_customers_customer_id.ae7452c4c6 (compile): 18:27:54.813419 => 18:27:54.824957
[0m18:27:54.825946 [debug] [Thread-1 (]: Began executing node test.dbt_idx.source_not_null_warehouse_customers_customer_id.ae7452c4c6
[0m18:27:54.828958 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_idx.source_not_null_warehouse_customers_customer_id.ae7452c4c6"
[0m18:27:54.837035 [debug] [Thread-1 (]: Using postgres connection "test.dbt_idx.source_not_null_warehouse_customers_customer_id.ae7452c4c6"
[0m18:27:54.837035 [debug] [Thread-1 (]: On test.dbt_idx.source_not_null_warehouse_customers_customer_id.ae7452c4c6: BEGIN
[0m18:27:54.838071 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:27:54.859741 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m18:27:54.860245 [debug] [Thread-1 (]: Using postgres connection "test.dbt_idx.source_not_null_warehouse_customers_customer_id.ae7452c4c6"
[0m18:27:54.861255 [debug] [Thread-1 (]: On test.dbt_idx.source_not_null_warehouse_customers_customer_id.ae7452c4c6: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "test.dbt_idx.source_not_null_warehouse_customers_customer_id.ae7452c4c6"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select customer_id
from "IDX-Stock"."warehouse"."customers"
where customer_id is null



      
    ) dbt_internal_test
[0m18:27:54.864298 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m18:27:54.866288 [debug] [Thread-1 (]: Timing info for test.dbt_idx.source_not_null_warehouse_customers_customer_id.ae7452c4c6 (execute): 18:27:54.826959 => 18:27:54.866288
[0m18:27:54.867254 [debug] [Thread-1 (]: On test.dbt_idx.source_not_null_warehouse_customers_customer_id.ae7452c4c6: ROLLBACK
[0m18:27:54.869480 [debug] [Thread-1 (]: On test.dbt_idx.source_not_null_warehouse_customers_customer_id.ae7452c4c6: Close
[0m18:27:54.871018 [info ] [Thread-1 (]: 4 of 8 PASS source_not_null_warehouse_customers_customer_id .................... [[32mPASS[0m in 0.06s]
[0m18:27:54.873022 [debug] [Thread-1 (]: Finished running node test.dbt_idx.source_not_null_warehouse_customers_customer_id.ae7452c4c6
[0m18:27:54.874021 [debug] [Thread-1 (]: Began running node test.dbt_idx.source_not_null_warehouse_orders_order_id.c85a1f0b76
[0m18:27:54.875021 [info ] [Thread-1 (]: 5 of 8 START test source_not_null_warehouse_orders_order_id .................... [RUN]
[0m18:27:54.876019 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_idx.source_not_null_warehouse_customers_customer_id.ae7452c4c6, now test.dbt_idx.source_not_null_warehouse_orders_order_id.c85a1f0b76)
[0m18:27:54.877029 [debug] [Thread-1 (]: Began compiling node test.dbt_idx.source_not_null_warehouse_orders_order_id.c85a1f0b76
[0m18:27:54.881570 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_idx.source_not_null_warehouse_orders_order_id.c85a1f0b76"
[0m18:27:54.887769 [debug] [Thread-1 (]: Timing info for test.dbt_idx.source_not_null_warehouse_orders_order_id.c85a1f0b76 (compile): 18:27:54.878014 => 18:27:54.887769
[0m18:27:54.888769 [debug] [Thread-1 (]: Began executing node test.dbt_idx.source_not_null_warehouse_orders_order_id.c85a1f0b76
[0m18:27:54.893282 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_idx.source_not_null_warehouse_orders_order_id.c85a1f0b76"
[0m18:27:54.901804 [debug] [Thread-1 (]: Using postgres connection "test.dbt_idx.source_not_null_warehouse_orders_order_id.c85a1f0b76"
[0m18:27:54.902798 [debug] [Thread-1 (]: On test.dbt_idx.source_not_null_warehouse_orders_order_id.c85a1f0b76: BEGIN
[0m18:27:54.903813 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:27:54.927065 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m18:27:54.928006 [debug] [Thread-1 (]: Using postgres connection "test.dbt_idx.source_not_null_warehouse_orders_order_id.c85a1f0b76"
[0m18:27:54.929006 [debug] [Thread-1 (]: On test.dbt_idx.source_not_null_warehouse_orders_order_id.c85a1f0b76: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "test.dbt_idx.source_not_null_warehouse_orders_order_id.c85a1f0b76"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select order_id
from "IDX-Stock"."warehouse"."orders"
where order_id is null



      
    ) dbt_internal_test
[0m18:27:54.931200 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m18:27:54.933196 [debug] [Thread-1 (]: Timing info for test.dbt_idx.source_not_null_warehouse_orders_order_id.c85a1f0b76 (execute): 18:27:54.888769 => 18:27:54.933196
[0m18:27:54.934196 [debug] [Thread-1 (]: On test.dbt_idx.source_not_null_warehouse_orders_order_id.c85a1f0b76: ROLLBACK
[0m18:27:54.936208 [debug] [Thread-1 (]: On test.dbt_idx.source_not_null_warehouse_orders_order_id.c85a1f0b76: Close
[0m18:27:54.938216 [info ] [Thread-1 (]: 5 of 8 PASS source_not_null_warehouse_orders_order_id .......................... [[32mPASS[0m in 0.06s]
[0m18:27:54.940700 [debug] [Thread-1 (]: Finished running node test.dbt_idx.source_not_null_warehouse_orders_order_id.c85a1f0b76
[0m18:27:54.941730 [debug] [Thread-1 (]: Began running node test.dbt_idx.source_relationships_warehouse_orders_cust_id__customer_id__source_warehouse_customers_.d3f9188fc2
[0m18:27:54.942736 [info ] [Thread-1 (]: 6 of 8 START test source_relationships_warehouse_orders_cust_id__customer_id__source_warehouse_customers_  [RUN]
[0m18:27:54.944744 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_idx.source_not_null_warehouse_orders_order_id.c85a1f0b76, now test.dbt_idx.source_relationships_warehouse_orders_cust_id__customer_id__source_warehouse_customers_.d3f9188fc2)
[0m18:27:54.945737 [debug] [Thread-1 (]: Began compiling node test.dbt_idx.source_relationships_warehouse_orders_cust_id__customer_id__source_warehouse_customers_.d3f9188fc2
[0m18:27:54.956302 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_idx.source_relationships_warehouse_orders_cust_id__customer_id__source_warehouse_customers_.d3f9188fc2"
[0m18:27:54.963852 [debug] [Thread-1 (]: Timing info for test.dbt_idx.source_relationships_warehouse_orders_cust_id__customer_id__source_warehouse_customers_.d3f9188fc2 (compile): 18:27:54.945737 => 18:27:54.962884
[0m18:27:54.963852 [debug] [Thread-1 (]: Began executing node test.dbt_idx.source_relationships_warehouse_orders_cust_id__customer_id__source_warehouse_customers_.d3f9188fc2
[0m18:27:54.966851 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_idx.source_relationships_warehouse_orders_cust_id__customer_id__source_warehouse_customers_.d3f9188fc2"
[0m18:27:54.972839 [debug] [Thread-1 (]: Using postgres connection "test.dbt_idx.source_relationships_warehouse_orders_cust_id__customer_id__source_warehouse_customers_.d3f9188fc2"
[0m18:27:54.973896 [debug] [Thread-1 (]: On test.dbt_idx.source_relationships_warehouse_orders_cust_id__customer_id__source_warehouse_customers_.d3f9188fc2: BEGIN
[0m18:27:54.974905 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:27:54.999173 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m18:27:55.000214 [debug] [Thread-1 (]: Using postgres connection "test.dbt_idx.source_relationships_warehouse_orders_cust_id__customer_id__source_warehouse_customers_.d3f9188fc2"
[0m18:27:55.001565 [debug] [Thread-1 (]: On test.dbt_idx.source_relationships_warehouse_orders_cust_id__customer_id__source_warehouse_customers_.d3f9188fc2: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "test.dbt_idx.source_relationships_warehouse_orders_cust_id__customer_id__source_warehouse_customers_.d3f9188fc2"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select cust_id as from_field
    from "IDX-Stock"."warehouse"."orders"
    where cust_id is not null
),

parent as (
    select customer_id as to_field
    from "IDX-Stock"."warehouse"."customers"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m18:27:55.004563 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m18:27:55.006518 [debug] [Thread-1 (]: Timing info for test.dbt_idx.source_relationships_warehouse_orders_cust_id__customer_id__source_warehouse_customers_.d3f9188fc2 (execute): 18:27:54.964852 => 18:27:55.006518
[0m18:27:55.007554 [debug] [Thread-1 (]: On test.dbt_idx.source_relationships_warehouse_orders_cust_id__customer_id__source_warehouse_customers_.d3f9188fc2: ROLLBACK
[0m18:27:55.010166 [debug] [Thread-1 (]: On test.dbt_idx.source_relationships_warehouse_orders_cust_id__customer_id__source_warehouse_customers_.d3f9188fc2: Close
[0m18:27:55.012057 [info ] [Thread-1 (]: 6 of 8 PASS source_relationships_warehouse_orders_cust_id__customer_id__source_warehouse_customers_  [[32mPASS[0m in 0.07s]
[0m18:27:55.015052 [debug] [Thread-1 (]: Finished running node test.dbt_idx.source_relationships_warehouse_orders_cust_id__customer_id__source_warehouse_customers_.d3f9188fc2
[0m18:27:55.016050 [debug] [Thread-1 (]: Began running node test.dbt_idx.source_unique_warehouse_orders_order_id.839fb43d0f
[0m18:27:55.017056 [info ] [Thread-1 (]: 7 of 8 START test source_unique_warehouse_orders_order_id ...................... [RUN]
[0m18:27:55.018858 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_idx.source_relationships_warehouse_orders_cust_id__customer_id__source_warehouse_customers_.d3f9188fc2, now test.dbt_idx.source_unique_warehouse_orders_order_id.839fb43d0f)
[0m18:27:55.019919 [debug] [Thread-1 (]: Began compiling node test.dbt_idx.source_unique_warehouse_orders_order_id.839fb43d0f
[0m18:27:55.027908 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_idx.source_unique_warehouse_orders_order_id.839fb43d0f"
[0m18:27:55.035164 [debug] [Thread-1 (]: Timing info for test.dbt_idx.source_unique_warehouse_orders_order_id.839fb43d0f (compile): 18:27:55.019919 => 18:27:55.035164
[0m18:27:55.036219 [debug] [Thread-1 (]: Began executing node test.dbt_idx.source_unique_warehouse_orders_order_id.839fb43d0f
[0m18:27:55.040200 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_idx.source_unique_warehouse_orders_order_id.839fb43d0f"
[0m18:27:55.047454 [debug] [Thread-1 (]: Using postgres connection "test.dbt_idx.source_unique_warehouse_orders_order_id.839fb43d0f"
[0m18:27:55.048453 [debug] [Thread-1 (]: On test.dbt_idx.source_unique_warehouse_orders_order_id.839fb43d0f: BEGIN
[0m18:27:55.050090 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:27:55.076215 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m18:27:55.078213 [debug] [Thread-1 (]: Using postgres connection "test.dbt_idx.source_unique_warehouse_orders_order_id.839fb43d0f"
[0m18:27:55.079212 [debug] [Thread-1 (]: On test.dbt_idx.source_unique_warehouse_orders_order_id.839fb43d0f: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "test.dbt_idx.source_unique_warehouse_orders_order_id.839fb43d0f"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    order_id as unique_field,
    count(*) as n_records

from "IDX-Stock"."warehouse"."orders"
where order_id is not null
group by order_id
having count(*) > 1



      
    ) dbt_internal_test
[0m18:27:55.086464 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m18:27:55.088463 [debug] [Thread-1 (]: Timing info for test.dbt_idx.source_unique_warehouse_orders_order_id.839fb43d0f (execute): 18:27:55.037201 => 18:27:55.088463
[0m18:27:55.088463 [debug] [Thread-1 (]: On test.dbt_idx.source_unique_warehouse_orders_order_id.839fb43d0f: ROLLBACK
[0m18:27:55.091986 [debug] [Thread-1 (]: On test.dbt_idx.source_unique_warehouse_orders_order_id.839fb43d0f: Close
[0m18:27:55.096001 [info ] [Thread-1 (]: 7 of 8 PASS source_unique_warehouse_orders_order_id ............................ [[32mPASS[0m in 0.08s]
[0m18:27:55.099008 [debug] [Thread-1 (]: Finished running node test.dbt_idx.source_unique_warehouse_orders_order_id.839fb43d0f
[0m18:27:55.100005 [debug] [Thread-1 (]: Began running node test.dbt_idx.unique_customer_orders_status_order_id.b7a45e83ee
[0m18:27:55.102155 [info ] [Thread-1 (]: 8 of 8 START test unique_customer_orders_status_order_id ....................... [RUN]
[0m18:27:55.104147 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_idx.source_unique_warehouse_orders_order_id.839fb43d0f, now test.dbt_idx.unique_customer_orders_status_order_id.b7a45e83ee)
[0m18:27:55.105149 [debug] [Thread-1 (]: Began compiling node test.dbt_idx.unique_customer_orders_status_order_id.b7a45e83ee
[0m18:27:55.113987 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_idx.unique_customer_orders_status_order_id.b7a45e83ee"
[0m18:27:55.123996 [debug] [Thread-1 (]: Timing info for test.dbt_idx.unique_customer_orders_status_order_id.b7a45e83ee (compile): 18:27:55.107147 => 18:27:55.123996
[0m18:27:55.125996 [debug] [Thread-1 (]: Began executing node test.dbt_idx.unique_customer_orders_status_order_id.b7a45e83ee
[0m18:27:55.130515 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_idx.unique_customer_orders_status_order_id.b7a45e83ee"
[0m18:27:55.140047 [debug] [Thread-1 (]: Using postgres connection "test.dbt_idx.unique_customer_orders_status_order_id.b7a45e83ee"
[0m18:27:55.142062 [debug] [Thread-1 (]: On test.dbt_idx.unique_customer_orders_status_order_id.b7a45e83ee: BEGIN
[0m18:27:55.143063 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:27:55.173825 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m18:27:55.175823 [debug] [Thread-1 (]: Using postgres connection "test.dbt_idx.unique_customer_orders_status_order_id.b7a45e83ee"
[0m18:27:55.177320 [debug] [Thread-1 (]: On test.dbt_idx.unique_customer_orders_status_order_id.b7a45e83ee: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "test.dbt_idx.unique_customer_orders_status_order_id.b7a45e83ee"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    order_id as unique_field,
    count(*) as n_records

from "IDX-Stock"."warehouse"."customer_orders_status"
where order_id is not null
group by order_id
having count(*) > 1



      
    ) dbt_internal_test
[0m18:27:55.184864 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m18:27:55.188864 [debug] [Thread-1 (]: Timing info for test.dbt_idx.unique_customer_orders_status_order_id.b7a45e83ee (execute): 18:27:55.126997 => 18:27:55.187880
[0m18:27:55.189867 [debug] [Thread-1 (]: On test.dbt_idx.unique_customer_orders_status_order_id.b7a45e83ee: ROLLBACK
[0m18:27:55.193452 [debug] [Thread-1 (]: On test.dbt_idx.unique_customer_orders_status_order_id.b7a45e83ee: Close
[0m18:27:55.195459 [info ] [Thread-1 (]: 8 of 8 PASS unique_customer_orders_status_order_id ............................. [[32mPASS[0m in 0.09s]
[0m18:27:55.198459 [debug] [Thread-1 (]: Finished running node test.dbt_idx.unique_customer_orders_status_order_id.b7a45e83ee
[0m18:27:55.203986 [debug] [MainThread]: Using postgres connection "master"
[0m18:27:55.204997 [debug] [MainThread]: On master: BEGIN
[0m18:27:55.206988 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:27:55.235517 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m18:27:55.236517 [debug] [MainThread]: On master: COMMIT
[0m18:27:55.237522 [debug] [MainThread]: Using postgres connection "master"
[0m18:27:55.238519 [debug] [MainThread]: On master: COMMIT
[0m18:27:55.242044 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m18:27:55.244041 [debug] [MainThread]: On master: Close
[0m18:27:55.245050 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:27:55.247080 [debug] [MainThread]: Connection 'list_IDX-Stock_warehouse' was properly closed.
[0m18:27:55.248063 [debug] [MainThread]: Connection 'test.dbt_idx.unique_customer_orders_status_order_id.b7a45e83ee' was properly closed.
[0m18:27:55.250038 [info ] [MainThread]: 
[0m18:27:55.251352 [info ] [MainThread]: Finished running 8 tests in 0 hours 0 minutes and 0.87 seconds (0.87s).
[0m18:27:55.255394 [debug] [MainThread]: Command end result
[0m18:27:55.281707 [info ] [MainThread]: 
[0m18:27:55.283674 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:27:55.285674 [info ] [MainThread]: 
[0m18:27:55.286672 [info ] [MainThread]: Done. PASS=8 WARN=0 ERROR=0 SKIP=0 TOTAL=8
[0m18:27:55.288343 [debug] [MainThread]: Command `dbt test` succeeded at 18:27:55.287303 after 1.44 seconds
[0m18:27:55.288343 [debug] [MainThread]: Flushing usage events


============================== 18:28:26.931223 | bcabaad3-2f5a-49ee-8ccb-d66e00d247c0 ==============================
[0m18:28:26.931223 [info ] [MainThread]: Running with dbt=1.6.1
[0m18:28:26.936193 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': 'D:\\00 Project\\00 My Project\\IdeaProjects\\Py-DBT-IDX', 'log_path': 'D:\\00 Project\\00 My Project\\IdeaProjects\\Py-DBT-IDX\\logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt test', 'send_anonymous_usage_stats': 'False'}
[0m18:28:27.067813 [info ] [MainThread]: Registered adapter: postgres=1.6.1
[0m18:28:27.078428 [debug] [MainThread]: checksum: efe19d9f5b93d1a98cc804fbfcdb6b3aced98b974af664946fee1cde8837deb7, vars: {}, profile: , target: , version: 1.6.1
[0m18:28:27.227844 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m18:28:27.228817 [debug] [MainThread]: Partial parsing: updated file: dbt_idx://tests\assert_customer_dimension_has_no_row_loss.sql.sql
[0m18:28:27.298996 [info ] [MainThread]: Found 1 snapshot, 9 tests, 7 models, 3 sources, 0 exposures, 0 metrics, 349 macros, 0 groups, 0 semantic models
[0m18:28:27.302380 [info ] [MainThread]: 
[0m18:28:27.304380 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m18:28:27.307381 [debug] [ThreadPool]: Acquiring new postgres connection 'list_IDX-Stock_warehouse'
[0m18:28:27.324426 [debug] [ThreadPool]: Using postgres connection "list_IDX-Stock_warehouse"
[0m18:28:27.324426 [debug] [ThreadPool]: On list_IDX-Stock_warehouse: BEGIN
[0m18:28:27.325425 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:28:27.358826 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m18:28:27.359827 [debug] [ThreadPool]: Using postgres connection "list_IDX-Stock_warehouse"
[0m18:28:27.360332 [debug] [ThreadPool]: On list_IDX-Stock_warehouse: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "connection_name": "list_IDX-Stock_warehouse"} */
select
      'IDX-Stock' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'warehouse'
    union all
    select
      'IDX-Stock' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'warehouse'
    union all
    select
      'IDX-Stock' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'warehouse'
  
[0m18:28:27.366716 [debug] [ThreadPool]: SQL status: SELECT 11 in 0.0 seconds
[0m18:28:27.369388 [debug] [ThreadPool]: On list_IDX-Stock_warehouse: ROLLBACK
[0m18:28:27.372186 [debug] [ThreadPool]: On list_IDX-Stock_warehouse: Close
[0m18:28:27.375093 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_IDX-Stock_warehouse, now list_IDX-Stock_snapshots)
[0m18:28:27.383323 [debug] [ThreadPool]: Using postgres connection "list_IDX-Stock_snapshots"
[0m18:28:27.384326 [debug] [ThreadPool]: On list_IDX-Stock_snapshots: BEGIN
[0m18:28:27.385350 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:28:27.407464 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m18:28:27.408510 [debug] [ThreadPool]: Using postgres connection "list_IDX-Stock_snapshots"
[0m18:28:27.408510 [debug] [ThreadPool]: On list_IDX-Stock_snapshots: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "connection_name": "list_IDX-Stock_snapshots"} */
select
      'IDX-Stock' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'snapshots'
    union all
    select
      'IDX-Stock' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'snapshots'
    union all
    select
      'IDX-Stock' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'snapshots'
  
[0m18:28:27.414069 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.0 seconds
[0m18:28:27.416096 [debug] [ThreadPool]: On list_IDX-Stock_snapshots: ROLLBACK
[0m18:28:27.419083 [debug] [ThreadPool]: On list_IDX-Stock_snapshots: Close
[0m18:28:27.427492 [debug] [MainThread]: Using postgres connection "master"
[0m18:28:27.428545 [debug] [MainThread]: On master: BEGIN
[0m18:28:27.428545 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:28:27.451181 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m18:28:27.452159 [debug] [MainThread]: Using postgres connection "master"
[0m18:28:27.453173 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m18:28:27.459753 [debug] [MainThread]: SQL status: SELECT 6 in 0.0 seconds
[0m18:28:27.463978 [debug] [MainThread]: On master: ROLLBACK
[0m18:28:27.465951 [debug] [MainThread]: Using postgres connection "master"
[0m18:28:27.466962 [debug] [MainThread]: On master: BEGIN
[0m18:28:27.470050 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m18:28:27.471010 [debug] [MainThread]: On master: COMMIT
[0m18:28:27.471997 [debug] [MainThread]: Using postgres connection "master"
[0m18:28:27.472976 [debug] [MainThread]: On master: COMMIT
[0m18:28:27.474994 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m18:28:27.476006 [debug] [MainThread]: On master: Close
[0m18:28:27.477050 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:28:27.478993 [info ] [MainThread]: 
[0m18:28:27.485109 [debug] [Thread-1 (]: Began running node test.dbt_idx.accepted_values_customer_orders_status_order_status__delivered__invoiced__shipped__processing__canceled__unavailable.ea8c296d27
[0m18:28:27.487111 [info ] [Thread-1 (]: 1 of 9 START test accepted_values_customer_orders_status_order_status__delivered__invoiced__shipped__processing__canceled__unavailable  [RUN]
[0m18:28:27.488103 [debug] [Thread-1 (]: Acquiring new postgres connection 'test.dbt_idx.accepted_values_customer_orders_status_order_status__delivered__invoiced__shipped__processing__canceled__unavailable.ea8c296d27'
[0m18:28:27.489644 [debug] [Thread-1 (]: Began compiling node test.dbt_idx.accepted_values_customer_orders_status_order_status__delivered__invoiced__shipped__processing__canceled__unavailable.ea8c296d27
[0m18:28:27.508361 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_idx.accepted_values_customer_orders_status_order_status__delivered__invoiced__shipped__processing__canceled__unavailable.ea8c296d27"
[0m18:28:27.518147 [debug] [Thread-1 (]: Timing info for test.dbt_idx.accepted_values_customer_orders_status_order_status__delivered__invoiced__shipped__processing__canceled__unavailable.ea8c296d27 (compile): 18:28:27.489816 => 18:28:27.518147
[0m18:28:27.519147 [debug] [Thread-1 (]: Began executing node test.dbt_idx.accepted_values_customer_orders_status_order_status__delivered__invoiced__shipped__processing__canceled__unavailable.ea8c296d27
[0m18:28:27.547103 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_idx.accepted_values_customer_orders_status_order_status__delivered__invoiced__shipped__processing__canceled__unavailable.ea8c296d27"
[0m18:28:27.557815 [debug] [Thread-1 (]: Using postgres connection "test.dbt_idx.accepted_values_customer_orders_status_order_status__delivered__invoiced__shipped__processing__canceled__unavailable.ea8c296d27"
[0m18:28:27.560097 [debug] [Thread-1 (]: On test.dbt_idx.accepted_values_customer_orders_status_order_status__delivered__invoiced__shipped__processing__canceled__unavailable.ea8c296d27: BEGIN
[0m18:28:27.561188 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m18:28:27.590847 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m18:28:27.592839 [debug] [Thread-1 (]: Using postgres connection "test.dbt_idx.accepted_values_customer_orders_status_order_status__delivered__invoiced__shipped__processing__canceled__unavailable.ea8c296d27"
[0m18:28:27.594847 [debug] [Thread-1 (]: On test.dbt_idx.accepted_values_customer_orders_status_order_status__delivered__invoiced__shipped__processing__canceled__unavailable.ea8c296d27: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "test.dbt_idx.accepted_values_customer_orders_status_order_status__delivered__invoiced__shipped__processing__canceled__unavailable.ea8c296d27"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        order_status as value_field,
        count(*) as n_records

    from "IDX-Stock"."warehouse"."customer_orders_status"
    group by order_status

)

select *
from all_values
where value_field not in (
    'delivered','invoiced','shipped','processing','canceled','unavailable'
)



      
    ) dbt_internal_test
[0m18:28:27.602079 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m18:28:27.606083 [debug] [Thread-1 (]: Timing info for test.dbt_idx.accepted_values_customer_orders_status_order_status__delivered__invoiced__shipped__processing__canceled__unavailable.ea8c296d27 (execute): 18:28:27.520183 => 18:28:27.606083
[0m18:28:27.608083 [debug] [Thread-1 (]: On test.dbt_idx.accepted_values_customer_orders_status_order_status__delivered__invoiced__shipped__processing__canceled__unavailable.ea8c296d27: ROLLBACK
[0m18:28:27.610082 [debug] [Thread-1 (]: On test.dbt_idx.accepted_values_customer_orders_status_order_status__delivered__invoiced__shipped__processing__canceled__unavailable.ea8c296d27: Close
[0m18:28:27.613468 [info ] [Thread-1 (]: 1 of 9 PASS accepted_values_customer_orders_status_order_status__delivered__invoiced__shipped__processing__canceled__unavailable  [[32mPASS[0m in 0.12s]
[0m18:28:27.615473 [debug] [Thread-1 (]: Finished running node test.dbt_idx.accepted_values_customer_orders_status_order_status__delivered__invoiced__shipped__processing__canceled__unavailable.ea8c296d27
[0m18:28:27.616473 [debug] [Thread-1 (]: Began running node test.dbt_idx.assert_customer_dimension_has_no_row_loss.sql
[0m18:28:27.617506 [info ] [Thread-1 (]: 2 of 9 START test assert_customer_dimension_has_no_row_loss.sql ................ [RUN]
[0m18:28:27.618466 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_idx.accepted_values_customer_orders_status_order_status__delivered__invoiced__shipped__processing__canceled__unavailable.ea8c296d27, now test.dbt_idx.assert_customer_dimension_has_no_row_loss.sql)
[0m18:28:27.620996 [debug] [Thread-1 (]: Began compiling node test.dbt_idx.assert_customer_dimension_has_no_row_loss.sql
[0m18:28:27.626019 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_idx.assert_customer_dimension_has_no_row_loss.sql"
[0m18:28:27.636135 [debug] [Thread-1 (]: Timing info for test.dbt_idx.assert_customer_dimension_has_no_row_loss.sql (compile): 18:28:27.621992 => 18:28:27.635138
[0m18:28:27.637177 [debug] [Thread-1 (]: Began executing node test.dbt_idx.assert_customer_dimension_has_no_row_loss.sql
[0m18:28:27.643667 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_idx.assert_customer_dimension_has_no_row_loss.sql"
[0m18:28:27.654762 [debug] [Thread-1 (]: Using postgres connection "test.dbt_idx.assert_customer_dimension_has_no_row_loss.sql"
[0m18:28:27.655778 [debug] [Thread-1 (]: On test.dbt_idx.assert_customer_dimension_has_no_row_loss.sql: BEGIN
[0m18:28:27.658187 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:28:27.693850 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m18:28:27.694852 [debug] [Thread-1 (]: Using postgres connection "test.dbt_idx.assert_customer_dimension_has_no_row_loss.sql"
[0m18:28:27.695847 [debug] [Thread-1 (]: On test.dbt_idx.assert_customer_dimension_has_no_row_loss.sql: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "test.dbt_idx.assert_customer_dimension_has_no_row_loss.sql"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      -- dim_customers must have the same number of rows as its staging counterpart
-- Therefore return records where this isn't true to make the test fail
select *
from (
         select dim_cust.customer_id
         from "IDX-Stock"."warehouse"."dim_customers" dim_cust
            inner join "IDX-Stock"."warehouse"."stg_eltool__customers_snapshots" stg_cust
         on dim_cust.customer_id = stg_cust.customer_id
         where stg_cust.customer_id is null
         UNION ALL
         select stg_cust.customer_id
         from "IDX-Stock"."warehouse"."stg_eltool__customers_snapshots" stg_cust
             inner join "IDX-Stock"."warehouse"."dim_customers" dim_cust
         on stg_cust.customer_id = dim_cust.customer_id
         where dim_cust.customer_id is null
     ) tmp
      
    ) dbt_internal_test
[0m18:28:27.701454 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m18:28:27.705981 [debug] [Thread-1 (]: Timing info for test.dbt_idx.assert_customer_dimension_has_no_row_loss.sql (execute): 18:28:27.639148 => 18:28:27.704993
[0m18:28:27.707693 [debug] [Thread-1 (]: On test.dbt_idx.assert_customer_dimension_has_no_row_loss.sql: ROLLBACK
[0m18:28:27.712098 [debug] [Thread-1 (]: On test.dbt_idx.assert_customer_dimension_has_no_row_loss.sql: Close
[0m18:28:27.716036 [info ] [Thread-1 (]: 2 of 9 PASS assert_customer_dimension_has_no_row_loss.sql ...................... [[32mPASS[0m in 0.10s]
[0m18:28:27.718923 [debug] [Thread-1 (]: Finished running node test.dbt_idx.assert_customer_dimension_has_no_row_loss.sql
[0m18:28:27.721261 [debug] [Thread-1 (]: Began running node test.dbt_idx.not_null_customer_orders_status_customer_id.3915c814eb
[0m18:28:27.723396 [info ] [Thread-1 (]: 3 of 9 START test not_null_customer_orders_status_customer_id .................. [RUN]
[0m18:28:27.725797 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_idx.assert_customer_dimension_has_no_row_loss.sql, now test.dbt_idx.not_null_customer_orders_status_customer_id.3915c814eb)
[0m18:28:27.726827 [debug] [Thread-1 (]: Began compiling node test.dbt_idx.not_null_customer_orders_status_customer_id.3915c814eb
[0m18:28:27.737328 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_idx.not_null_customer_orders_status_customer_id.3915c814eb"
[0m18:28:27.745901 [debug] [Thread-1 (]: Timing info for test.dbt_idx.not_null_customer_orders_status_customer_id.3915c814eb (compile): 18:28:27.727912 => 18:28:27.744891
[0m18:28:27.746893 [debug] [Thread-1 (]: Began executing node test.dbt_idx.not_null_customer_orders_status_customer_id.3915c814eb
[0m18:28:27.749974 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_idx.not_null_customer_orders_status_customer_id.3915c814eb"
[0m18:28:27.756923 [debug] [Thread-1 (]: Using postgres connection "test.dbt_idx.not_null_customer_orders_status_customer_id.3915c814eb"
[0m18:28:27.758437 [debug] [Thread-1 (]: On test.dbt_idx.not_null_customer_orders_status_customer_id.3915c814eb: BEGIN
[0m18:28:27.759957 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:28:27.784288 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m18:28:27.785313 [debug] [Thread-1 (]: Using postgres connection "test.dbt_idx.not_null_customer_orders_status_customer_id.3915c814eb"
[0m18:28:27.786287 [debug] [Thread-1 (]: On test.dbt_idx.not_null_customer_orders_status_customer_id.3915c814eb: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "test.dbt_idx.not_null_customer_orders_status_customer_id.3915c814eb"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select customer_id
from "IDX-Stock"."warehouse"."customer_orders_status"
where customer_id is null



      
    ) dbt_internal_test
[0m18:28:27.791837 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m18:28:27.794408 [debug] [Thread-1 (]: Timing info for test.dbt_idx.not_null_customer_orders_status_customer_id.3915c814eb (execute): 18:28:27.747892 => 18:28:27.794408
[0m18:28:27.796379 [debug] [Thread-1 (]: On test.dbt_idx.not_null_customer_orders_status_customer_id.3915c814eb: ROLLBACK
[0m18:28:27.798378 [debug] [Thread-1 (]: On test.dbt_idx.not_null_customer_orders_status_customer_id.3915c814eb: Close
[0m18:28:27.801903 [info ] [Thread-1 (]: 3 of 9 PASS not_null_customer_orders_status_customer_id ........................ [[32mPASS[0m in 0.08s]
[0m18:28:27.803912 [debug] [Thread-1 (]: Finished running node test.dbt_idx.not_null_customer_orders_status_customer_id.3915c814eb
[0m18:28:27.805929 [debug] [Thread-1 (]: Began running node test.dbt_idx.not_null_stg_eltool__customers_snapshots_customer_id.ea4fc4ca86
[0m18:28:27.806916 [info ] [Thread-1 (]: 4 of 9 START test not_null_stg_eltool__customers_snapshots_customer_id ......... [RUN]
[0m18:28:27.808916 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_idx.not_null_customer_orders_status_customer_id.3915c814eb, now test.dbt_idx.not_null_stg_eltool__customers_snapshots_customer_id.ea4fc4ca86)
[0m18:28:27.809916 [debug] [Thread-1 (]: Began compiling node test.dbt_idx.not_null_stg_eltool__customers_snapshots_customer_id.ea4fc4ca86
[0m18:28:27.822669 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_idx.not_null_stg_eltool__customers_snapshots_customer_id.ea4fc4ca86"
[0m18:28:27.832697 [debug] [Thread-1 (]: Timing info for test.dbt_idx.not_null_stg_eltool__customers_snapshots_customer_id.ea4fc4ca86 (compile): 18:28:27.811281 => 18:28:27.831688
[0m18:28:27.833702 [debug] [Thread-1 (]: Began executing node test.dbt_idx.not_null_stg_eltool__customers_snapshots_customer_id.ea4fc4ca86
[0m18:28:27.837206 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_idx.not_null_stg_eltool__customers_snapshots_customer_id.ea4fc4ca86"
[0m18:28:27.845747 [debug] [Thread-1 (]: Using postgres connection "test.dbt_idx.not_null_stg_eltool__customers_snapshots_customer_id.ea4fc4ca86"
[0m18:28:27.846735 [debug] [Thread-1 (]: On test.dbt_idx.not_null_stg_eltool__customers_snapshots_customer_id.ea4fc4ca86: BEGIN
[0m18:28:27.847734 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:28:27.871074 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m18:28:27.873074 [debug] [Thread-1 (]: Using postgres connection "test.dbt_idx.not_null_stg_eltool__customers_snapshots_customer_id.ea4fc4ca86"
[0m18:28:27.874072 [debug] [Thread-1 (]: On test.dbt_idx.not_null_stg_eltool__customers_snapshots_customer_id.ea4fc4ca86: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "test.dbt_idx.not_null_stg_eltool__customers_snapshots_customer_id.ea4fc4ca86"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select customer_id
from "IDX-Stock"."warehouse"."stg_eltool__customers_snapshots"
where customer_id is null



      
    ) dbt_internal_test
[0m18:28:27.878078 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m18:28:27.880579 [debug] [Thread-1 (]: Timing info for test.dbt_idx.not_null_stg_eltool__customers_snapshots_customer_id.ea4fc4ca86 (execute): 18:28:27.834700 => 18:28:27.880579
[0m18:28:27.881585 [debug] [Thread-1 (]: On test.dbt_idx.not_null_stg_eltool__customers_snapshots_customer_id.ea4fc4ca86: ROLLBACK
[0m18:28:27.883587 [debug] [Thread-1 (]: On test.dbt_idx.not_null_stg_eltool__customers_snapshots_customer_id.ea4fc4ca86: Close
[0m18:28:27.885590 [info ] [Thread-1 (]: 4 of 9 PASS not_null_stg_eltool__customers_snapshots_customer_id ............... [[32mPASS[0m in 0.08s]
[0m18:28:27.887587 [debug] [Thread-1 (]: Finished running node test.dbt_idx.not_null_stg_eltool__customers_snapshots_customer_id.ea4fc4ca86
[0m18:28:27.888584 [debug] [Thread-1 (]: Began running node test.dbt_idx.source_not_null_warehouse_customers_customer_id.ae7452c4c6
[0m18:28:27.888584 [info ] [Thread-1 (]: 5 of 9 START test source_not_null_warehouse_customers_customer_id .............. [RUN]
[0m18:28:27.890091 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_idx.not_null_stg_eltool__customers_snapshots_customer_id.ea4fc4ca86, now test.dbt_idx.source_not_null_warehouse_customers_customer_id.ae7452c4c6)
[0m18:28:27.891097 [debug] [Thread-1 (]: Began compiling node test.dbt_idx.source_not_null_warehouse_customers_customer_id.ae7452c4c6
[0m18:28:27.896098 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_idx.source_not_null_warehouse_customers_customer_id.ae7452c4c6"
[0m18:28:27.903311 [debug] [Thread-1 (]: Timing info for test.dbt_idx.source_not_null_warehouse_customers_customer_id.ae7452c4c6 (compile): 18:28:27.892096 => 18:28:27.903311
[0m18:28:27.904309 [debug] [Thread-1 (]: Began executing node test.dbt_idx.source_not_null_warehouse_customers_customer_id.ae7452c4c6
[0m18:28:27.908307 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_idx.source_not_null_warehouse_customers_customer_id.ae7452c4c6"
[0m18:28:27.915820 [debug] [Thread-1 (]: Using postgres connection "test.dbt_idx.source_not_null_warehouse_customers_customer_id.ae7452c4c6"
[0m18:28:27.916820 [debug] [Thread-1 (]: On test.dbt_idx.source_not_null_warehouse_customers_customer_id.ae7452c4c6: BEGIN
[0m18:28:27.917821 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:28:27.939931 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m18:28:27.941158 [debug] [Thread-1 (]: Using postgres connection "test.dbt_idx.source_not_null_warehouse_customers_customer_id.ae7452c4c6"
[0m18:28:27.942183 [debug] [Thread-1 (]: On test.dbt_idx.source_not_null_warehouse_customers_customer_id.ae7452c4c6: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "test.dbt_idx.source_not_null_warehouse_customers_customer_id.ae7452c4c6"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select customer_id
from "IDX-Stock"."warehouse"."customers"
where customer_id is null



      
    ) dbt_internal_test
[0m18:28:27.945166 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m18:28:27.947229 [debug] [Thread-1 (]: Timing info for test.dbt_idx.source_not_null_warehouse_customers_customer_id.ae7452c4c6 (execute): 18:28:27.905307 => 18:28:27.946201
[0m18:28:27.947229 [debug] [Thread-1 (]: On test.dbt_idx.source_not_null_warehouse_customers_customer_id.ae7452c4c6: ROLLBACK
[0m18:28:27.949707 [debug] [Thread-1 (]: On test.dbt_idx.source_not_null_warehouse_customers_customer_id.ae7452c4c6: Close
[0m18:28:27.951718 [info ] [Thread-1 (]: 5 of 9 PASS source_not_null_warehouse_customers_customer_id .................... [[32mPASS[0m in 0.06s]
[0m18:28:27.953732 [debug] [Thread-1 (]: Finished running node test.dbt_idx.source_not_null_warehouse_customers_customer_id.ae7452c4c6
[0m18:28:27.954742 [debug] [Thread-1 (]: Began running node test.dbt_idx.source_not_null_warehouse_orders_order_id.c85a1f0b76
[0m18:28:27.955712 [info ] [Thread-1 (]: 6 of 9 START test source_not_null_warehouse_orders_order_id .................... [RUN]
[0m18:28:27.956716 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_idx.source_not_null_warehouse_customers_customer_id.ae7452c4c6, now test.dbt_idx.source_not_null_warehouse_orders_order_id.c85a1f0b76)
[0m18:28:27.957715 [debug] [Thread-1 (]: Began compiling node test.dbt_idx.source_not_null_warehouse_orders_order_id.c85a1f0b76
[0m18:28:27.964334 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_idx.source_not_null_warehouse_orders_order_id.c85a1f0b76"
[0m18:28:27.972838 [debug] [Thread-1 (]: Timing info for test.dbt_idx.source_not_null_warehouse_orders_order_id.c85a1f0b76 (compile): 18:28:27.957715 => 18:28:27.971832
[0m18:28:27.973837 [debug] [Thread-1 (]: Began executing node test.dbt_idx.source_not_null_warehouse_orders_order_id.c85a1f0b76
[0m18:28:27.976838 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_idx.source_not_null_warehouse_orders_order_id.c85a1f0b76"
[0m18:28:27.982933 [debug] [Thread-1 (]: Using postgres connection "test.dbt_idx.source_not_null_warehouse_orders_order_id.c85a1f0b76"
[0m18:28:27.983932 [debug] [Thread-1 (]: On test.dbt_idx.source_not_null_warehouse_orders_order_id.c85a1f0b76: BEGIN
[0m18:28:27.984942 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:28:28.007297 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m18:28:28.008329 [debug] [Thread-1 (]: Using postgres connection "test.dbt_idx.source_not_null_warehouse_orders_order_id.c85a1f0b76"
[0m18:28:28.008329 [debug] [Thread-1 (]: On test.dbt_idx.source_not_null_warehouse_orders_order_id.c85a1f0b76: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "test.dbt_idx.source_not_null_warehouse_orders_order_id.c85a1f0b76"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select order_id
from "IDX-Stock"."warehouse"."orders"
where order_id is null



      
    ) dbt_internal_test
[0m18:28:28.011937 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m18:28:28.013943 [debug] [Thread-1 (]: Timing info for test.dbt_idx.source_not_null_warehouse_orders_order_id.c85a1f0b76 (execute): 18:28:27.973837 => 18:28:28.013943
[0m18:28:28.014924 [debug] [Thread-1 (]: On test.dbt_idx.source_not_null_warehouse_orders_order_id.c85a1f0b76: ROLLBACK
[0m18:28:28.017921 [debug] [Thread-1 (]: On test.dbt_idx.source_not_null_warehouse_orders_order_id.c85a1f0b76: Close
[0m18:28:28.019942 [info ] [Thread-1 (]: 6 of 9 PASS source_not_null_warehouse_orders_order_id .......................... [[32mPASS[0m in 0.06s]
[0m18:28:28.022145 [debug] [Thread-1 (]: Finished running node test.dbt_idx.source_not_null_warehouse_orders_order_id.c85a1f0b76
[0m18:28:28.024148 [debug] [Thread-1 (]: Began running node test.dbt_idx.source_relationships_warehouse_orders_cust_id__customer_id__source_warehouse_customers_.d3f9188fc2
[0m18:28:28.025141 [info ] [Thread-1 (]: 7 of 9 START test source_relationships_warehouse_orders_cust_id__customer_id__source_warehouse_customers_  [RUN]
[0m18:28:28.027157 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_idx.source_not_null_warehouse_orders_order_id.c85a1f0b76, now test.dbt_idx.source_relationships_warehouse_orders_cust_id__customer_id__source_warehouse_customers_.d3f9188fc2)
[0m18:28:28.028143 [debug] [Thread-1 (]: Began compiling node test.dbt_idx.source_relationships_warehouse_orders_cust_id__customer_id__source_warehouse_customers_.d3f9188fc2
[0m18:28:28.040281 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_idx.source_relationships_warehouse_orders_cust_id__customer_id__source_warehouse_customers_.d3f9188fc2"
[0m18:28:28.047708 [debug] [Thread-1 (]: Timing info for test.dbt_idx.source_relationships_warehouse_orders_cust_id__customer_id__source_warehouse_customers_.d3f9188fc2 (compile): 18:28:28.029696 => 18:28:28.046740
[0m18:28:28.048739 [debug] [Thread-1 (]: Began executing node test.dbt_idx.source_relationships_warehouse_orders_cust_id__customer_id__source_warehouse_customers_.d3f9188fc2
[0m18:28:28.051940 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_idx.source_relationships_warehouse_orders_cust_id__customer_id__source_warehouse_customers_.d3f9188fc2"
[0m18:28:28.058921 [debug] [Thread-1 (]: Using postgres connection "test.dbt_idx.source_relationships_warehouse_orders_cust_id__customer_id__source_warehouse_customers_.d3f9188fc2"
[0m18:28:28.058921 [debug] [Thread-1 (]: On test.dbt_idx.source_relationships_warehouse_orders_cust_id__customer_id__source_warehouse_customers_.d3f9188fc2: BEGIN
[0m18:28:28.059941 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:28:28.083038 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m18:28:28.084041 [debug] [Thread-1 (]: Using postgres connection "test.dbt_idx.source_relationships_warehouse_orders_cust_id__customer_id__source_warehouse_customers_.d3f9188fc2"
[0m18:28:28.085039 [debug] [Thread-1 (]: On test.dbt_idx.source_relationships_warehouse_orders_cust_id__customer_id__source_warehouse_customers_.d3f9188fc2: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "test.dbt_idx.source_relationships_warehouse_orders_cust_id__customer_id__source_warehouse_customers_.d3f9188fc2"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select cust_id as from_field
    from "IDX-Stock"."warehouse"."orders"
    where cust_id is not null
),

parent as (
    select customer_id as to_field
    from "IDX-Stock"."warehouse"."customers"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m18:28:28.088040 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m18:28:28.090072 [debug] [Thread-1 (]: Timing info for test.dbt_idx.source_relationships_warehouse_orders_cust_id__customer_id__source_warehouse_customers_.d3f9188fc2 (execute): 18:28:28.049770 => 18:28:28.089073
[0m18:28:28.090608 [debug] [Thread-1 (]: On test.dbt_idx.source_relationships_warehouse_orders_cust_id__customer_id__source_warehouse_customers_.d3f9188fc2: ROLLBACK
[0m18:28:28.093083 [debug] [Thread-1 (]: On test.dbt_idx.source_relationships_warehouse_orders_cust_id__customer_id__source_warehouse_customers_.d3f9188fc2: Close
[0m18:28:28.095098 [info ] [Thread-1 (]: 7 of 9 PASS source_relationships_warehouse_orders_cust_id__customer_id__source_warehouse_customers_  [[32mPASS[0m in 0.07s]
[0m18:28:28.097095 [debug] [Thread-1 (]: Finished running node test.dbt_idx.source_relationships_warehouse_orders_cust_id__customer_id__source_warehouse_customers_.d3f9188fc2
[0m18:28:28.098094 [debug] [Thread-1 (]: Began running node test.dbt_idx.source_unique_warehouse_orders_order_id.839fb43d0f
[0m18:28:28.099095 [info ] [Thread-1 (]: 8 of 9 START test source_unique_warehouse_orders_order_id ...................... [RUN]
[0m18:28:28.100098 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_idx.source_relationships_warehouse_orders_cust_id__customer_id__source_warehouse_customers_.d3f9188fc2, now test.dbt_idx.source_unique_warehouse_orders_order_id.839fb43d0f)
[0m18:28:28.101546 [debug] [Thread-1 (]: Began compiling node test.dbt_idx.source_unique_warehouse_orders_order_id.839fb43d0f
[0m18:28:28.108547 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_idx.source_unique_warehouse_orders_order_id.839fb43d0f"
[0m18:28:28.116265 [debug] [Thread-1 (]: Timing info for test.dbt_idx.source_unique_warehouse_orders_order_id.839fb43d0f (compile): 18:28:28.102565 => 18:28:28.116265
[0m18:28:28.117275 [debug] [Thread-1 (]: Began executing node test.dbt_idx.source_unique_warehouse_orders_order_id.839fb43d0f
[0m18:28:28.119857 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_idx.source_unique_warehouse_orders_order_id.839fb43d0f"
[0m18:28:28.127814 [debug] [Thread-1 (]: Using postgres connection "test.dbt_idx.source_unique_warehouse_orders_order_id.839fb43d0f"
[0m18:28:28.129815 [debug] [Thread-1 (]: On test.dbt_idx.source_unique_warehouse_orders_order_id.839fb43d0f: BEGIN
[0m18:28:28.130320 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:28:28.155824 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m18:28:28.156809 [debug] [Thread-1 (]: Using postgres connection "test.dbt_idx.source_unique_warehouse_orders_order_id.839fb43d0f"
[0m18:28:28.157827 [debug] [Thread-1 (]: On test.dbt_idx.source_unique_warehouse_orders_order_id.839fb43d0f: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "test.dbt_idx.source_unique_warehouse_orders_order_id.839fb43d0f"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    order_id as unique_field,
    count(*) as n_records

from "IDX-Stock"."warehouse"."orders"
where order_id is not null
group by order_id
having count(*) > 1



      
    ) dbt_internal_test
[0m18:28:28.163114 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m18:28:28.165113 [debug] [Thread-1 (]: Timing info for test.dbt_idx.source_unique_warehouse_orders_order_id.839fb43d0f (execute): 18:28:28.117275 => 18:28:28.164113
[0m18:28:28.165113 [debug] [Thread-1 (]: On test.dbt_idx.source_unique_warehouse_orders_order_id.839fb43d0f: ROLLBACK
[0m18:28:28.169127 [debug] [Thread-1 (]: On test.dbt_idx.source_unique_warehouse_orders_order_id.839fb43d0f: Close
[0m18:28:28.172321 [info ] [Thread-1 (]: 8 of 9 PASS source_unique_warehouse_orders_order_id ............................ [[32mPASS[0m in 0.07s]
[0m18:28:28.174327 [debug] [Thread-1 (]: Finished running node test.dbt_idx.source_unique_warehouse_orders_order_id.839fb43d0f
[0m18:28:28.175352 [debug] [Thread-1 (]: Began running node test.dbt_idx.unique_customer_orders_status_order_id.b7a45e83ee
[0m18:28:28.176320 [info ] [Thread-1 (]: 9 of 9 START test unique_customer_orders_status_order_id ....................... [RUN]
[0m18:28:28.177320 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_idx.source_unique_warehouse_orders_order_id.839fb43d0f, now test.dbt_idx.unique_customer_orders_status_order_id.b7a45e83ee)
[0m18:28:28.178355 [debug] [Thread-1 (]: Began compiling node test.dbt_idx.unique_customer_orders_status_order_id.b7a45e83ee
[0m18:28:28.183916 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_idx.unique_customer_orders_status_order_id.b7a45e83ee"
[0m18:28:28.191414 [debug] [Thread-1 (]: Timing info for test.dbt_idx.unique_customer_orders_status_order_id.b7a45e83ee (compile): 18:28:28.178355 => 18:28:28.190408
[0m18:28:28.192419 [debug] [Thread-1 (]: Began executing node test.dbt_idx.unique_customer_orders_status_order_id.b7a45e83ee
[0m18:28:28.195421 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_idx.unique_customer_orders_status_order_id.b7a45e83ee"
[0m18:28:28.201878 [debug] [Thread-1 (]: Using postgres connection "test.dbt_idx.unique_customer_orders_status_order_id.b7a45e83ee"
[0m18:28:28.202882 [debug] [Thread-1 (]: On test.dbt_idx.unique_customer_orders_status_order_id.b7a45e83ee: BEGIN
[0m18:28:28.203878 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:28:28.227750 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m18:28:28.227750 [debug] [Thread-1 (]: Using postgres connection "test.dbt_idx.unique_customer_orders_status_order_id.b7a45e83ee"
[0m18:28:28.228782 [debug] [Thread-1 (]: On test.dbt_idx.unique_customer_orders_status_order_id.b7a45e83ee: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "test.dbt_idx.unique_customer_orders_status_order_id.b7a45e83ee"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    order_id as unique_field,
    count(*) as n_records

from "IDX-Stock"."warehouse"."customer_orders_status"
where order_id is not null
group by order_id
having count(*) > 1



      
    ) dbt_internal_test
[0m18:28:28.233891 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m18:28:28.235917 [debug] [Thread-1 (]: Timing info for test.dbt_idx.unique_customer_orders_status_order_id.b7a45e83ee (execute): 18:28:28.192419 => 18:28:28.235917
[0m18:28:28.236933 [debug] [Thread-1 (]: On test.dbt_idx.unique_customer_orders_status_order_id.b7a45e83ee: ROLLBACK
[0m18:28:28.238891 [debug] [Thread-1 (]: On test.dbt_idx.unique_customer_orders_status_order_id.b7a45e83ee: Close
[0m18:28:28.239901 [info ] [Thread-1 (]: 9 of 9 PASS unique_customer_orders_status_order_id ............................. [[32mPASS[0m in 0.06s]
[0m18:28:28.243315 [debug] [Thread-1 (]: Finished running node test.dbt_idx.unique_customer_orders_status_order_id.b7a45e83ee
[0m18:28:28.245317 [debug] [MainThread]: Using postgres connection "master"
[0m18:28:28.246338 [debug] [MainThread]: On master: BEGIN
[0m18:28:28.247320 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:28:28.269985 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m18:28:28.270936 [debug] [MainThread]: On master: COMMIT
[0m18:28:28.271935 [debug] [MainThread]: Using postgres connection "master"
[0m18:28:28.272934 [debug] [MainThread]: On master: COMMIT
[0m18:28:28.274935 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m18:28:28.274935 [debug] [MainThread]: On master: Close
[0m18:28:28.276941 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:28:28.277937 [debug] [MainThread]: Connection 'list_IDX-Stock_snapshots' was properly closed.
[0m18:28:28.278959 [debug] [MainThread]: Connection 'test.dbt_idx.unique_customer_orders_status_order_id.b7a45e83ee' was properly closed.
[0m18:28:28.279938 [info ] [MainThread]: 
[0m18:28:28.281118 [info ] [MainThread]: Finished running 9 tests in 0 hours 0 minutes and 0.98 seconds (0.98s).
[0m18:28:28.283913 [debug] [MainThread]: Command end result
[0m18:28:28.306981 [info ] [MainThread]: 
[0m18:28:28.307883 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:28:28.308898 [info ] [MainThread]: 
[0m18:28:28.309895 [info ] [MainThread]: Done. PASS=9 WARN=0 ERROR=0 SKIP=0 TOTAL=9
[0m18:28:28.311001 [debug] [MainThread]: Command `dbt test` succeeded at 18:28:28.311001 after 1.42 seconds
[0m18:28:28.312026 [debug] [MainThread]: Flushing usage events


============================== 18:31:12.386344 | 8fc5f248-5d5a-45bf-9211-4dc6a07ea9cc ==============================
[0m18:31:12.386344 [info ] [MainThread]: Running with dbt=1.6.1
[0m18:31:12.392779 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': 'D:\\00 Project\\00 My Project\\IdeaProjects\\Py-DBT-IDX', 'log_path': 'D:\\00 Project\\00 My Project\\IdeaProjects\\Py-DBT-IDX\\logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'False'}
[0m18:31:12.521382 [info ] [MainThread]: Registered adapter: postgres=1.6.1
[0m18:31:12.531900 [debug] [MainThread]: checksum: efe19d9f5b93d1a98cc804fbfcdb6b3aced98b974af664946fee1cde8837deb7, vars: {}, profile: , target: , version: 1.6.1
[0m18:31:12.687067 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m18:31:12.688069 [debug] [MainThread]: Partial parsing: updated file: dbt_idx://tests\assert_customer_dimension_has_no_row_loss.sql.sql
[0m18:31:12.688069 [debug] [MainThread]: Partial parsing: updated file: dbt_idx://models\staging\stg_eltool__customers.sql
[0m18:31:12.791509 [info ] [MainThread]: Found 1 snapshot, 9 tests, 7 models, 3 sources, 0 exposures, 0 metrics, 349 macros, 0 groups, 0 semantic models
[0m18:31:12.794471 [info ] [MainThread]: 
[0m18:31:12.795471 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m18:31:12.798506 [debug] [ThreadPool]: Acquiring new postgres connection 'list_IDX-Stock'
[0m18:31:12.808042 [debug] [ThreadPool]: Using postgres connection "list_IDX-Stock"
[0m18:31:12.809675 [debug] [ThreadPool]: On list_IDX-Stock: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "connection_name": "list_IDX-Stock"} */

    select distinct nspname from pg_namespace
  
[0m18:31:12.810593 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:31:12.840991 [debug] [ThreadPool]: SQL status: SELECT 13 in 0.0 seconds
[0m18:31:12.841999 [debug] [ThreadPool]: On list_IDX-Stock: Close
[0m18:31:12.846005 [debug] [ThreadPool]: Acquiring new postgres connection 'list_IDX-Stock_warehouse'
[0m18:31:12.853525 [debug] [ThreadPool]: Using postgres connection "list_IDX-Stock_warehouse"
[0m18:31:12.854523 [debug] [ThreadPool]: On list_IDX-Stock_warehouse: BEGIN
[0m18:31:12.854523 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:31:12.877504 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m18:31:12.878518 [debug] [ThreadPool]: Using postgres connection "list_IDX-Stock_warehouse"
[0m18:31:12.879495 [debug] [ThreadPool]: On list_IDX-Stock_warehouse: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "connection_name": "list_IDX-Stock_warehouse"} */
select
      'IDX-Stock' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'warehouse'
    union all
    select
      'IDX-Stock' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'warehouse'
    union all
    select
      'IDX-Stock' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'warehouse'
  
[0m18:31:12.883677 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.0 seconds
[0m18:31:12.885677 [debug] [ThreadPool]: On list_IDX-Stock_warehouse: ROLLBACK
[0m18:31:12.887674 [debug] [ThreadPool]: On list_IDX-Stock_warehouse: Close
[0m18:31:12.889182 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_IDX-Stock_warehouse, now list_IDX-Stock_snapshots)
[0m18:31:12.894225 [debug] [ThreadPool]: Using postgres connection "list_IDX-Stock_snapshots"
[0m18:31:12.895227 [debug] [ThreadPool]: On list_IDX-Stock_snapshots: BEGIN
[0m18:31:12.896191 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:31:12.916528 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m18:31:12.917492 [debug] [ThreadPool]: Using postgres connection "list_IDX-Stock_snapshots"
[0m18:31:12.918492 [debug] [ThreadPool]: On list_IDX-Stock_snapshots: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "connection_name": "list_IDX-Stock_snapshots"} */
select
      'IDX-Stock' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'snapshots'
    union all
    select
      'IDX-Stock' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'snapshots'
    union all
    select
      'IDX-Stock' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'snapshots'
  
[0m18:31:12.923236 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.0 seconds
[0m18:31:12.924285 [debug] [ThreadPool]: On list_IDX-Stock_snapshots: ROLLBACK
[0m18:31:12.927193 [debug] [ThreadPool]: On list_IDX-Stock_snapshots: Close
[0m18:31:12.934570 [debug] [MainThread]: Using postgres connection "master"
[0m18:31:12.935571 [debug] [MainThread]: On master: BEGIN
[0m18:31:12.936572 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:31:12.960259 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m18:31:12.960259 [debug] [MainThread]: Using postgres connection "master"
[0m18:31:12.961284 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m18:31:12.971816 [debug] [MainThread]: SQL status: SELECT 6 in 0.0 seconds
[0m18:31:12.975815 [debug] [MainThread]: On master: ROLLBACK
[0m18:31:12.977823 [debug] [MainThread]: Using postgres connection "master"
[0m18:31:12.979489 [debug] [MainThread]: On master: BEGIN
[0m18:31:12.983339 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m18:31:12.984341 [debug] [MainThread]: On master: COMMIT
[0m18:31:12.985341 [debug] [MainThread]: Using postgres connection "master"
[0m18:31:12.986341 [debug] [MainThread]: On master: COMMIT
[0m18:31:12.988000 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m18:31:12.988000 [debug] [MainThread]: On master: Close
[0m18:31:12.990552 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:31:12.991558 [info ] [MainThread]: 
[0m18:31:12.997028 [debug] [Thread-1 (]: Began running node model.dbt_idx.stg_eltool__customers
[0m18:31:12.998042 [info ] [Thread-1 (]: 1 of 7 START sql view model warehouse.stg_eltool__customers .................... [RUN]
[0m18:31:12.999550 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.dbt_idx.stg_eltool__customers'
[0m18:31:13.000569 [debug] [Thread-1 (]: Began compiling node model.dbt_idx.stg_eltool__customers
[0m18:31:13.008556 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_idx.stg_eltool__customers"
[0m18:31:13.017618 [debug] [Thread-1 (]: Timing info for model.dbt_idx.stg_eltool__customers (compile): 18:31:13.001570 => 18:31:13.017618
[0m18:31:13.019214 [debug] [Thread-1 (]: Began executing node model.dbt_idx.stg_eltool__customers
[0m18:31:13.059734 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_idx.stg_eltool__customers"
[0m18:31:13.065776 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__customers"
[0m18:31:13.066745 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__customers: BEGIN
[0m18:31:13.067744 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m18:31:13.087855 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m18:31:13.089453 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__customers"
[0m18:31:13.090374 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__customers: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__customers"} */

  create view "IDX-Stock"."warehouse"."stg_eltool__customers__dbt_tmp"
    
    
  as (
    with source as (select *
                from "IDX-Stock"."warehouse"."customers"),
     renamed as (select
--                      customer_id,
                        'This is Dummy' as dummy
                 from source)
select *
from renamed
  );
[0m18:31:13.095010 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m18:31:13.101545 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__customers"
[0m18:31:13.102545 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__customers: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__customers"} */
alter table "IDX-Stock"."warehouse"."stg_eltool__customers" rename to "stg_eltool__customers__dbt_backup"
[0m18:31:13.104546 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:31:13.108545 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__customers"
[0m18:31:13.110049 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__customers: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__customers"} */
alter table "IDX-Stock"."warehouse"."stg_eltool__customers__dbt_tmp" rename to "stg_eltool__customers"
[0m18:31:13.112059 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:31:13.130080 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__customers: COMMIT
[0m18:31:13.131092 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__customers"
[0m18:31:13.132099 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__customers: COMMIT
[0m18:31:13.135714 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m18:31:13.143918 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__customers"
[0m18:31:13.144919 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__customers: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__customers"} */
drop view if exists "IDX-Stock"."warehouse"."stg_eltool__customers__dbt_backup" cascade
[0m18:31:13.147883 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m18:31:13.151473 [debug] [Thread-1 (]: Timing info for model.dbt_idx.stg_eltool__customers (execute): 18:31:13.020133 => 18:31:13.151473
[0m18:31:13.152436 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__customers: Close
[0m18:31:13.154454 [info ] [Thread-1 (]: 1 of 7 OK created sql view model warehouse.stg_eltool__customers ............... [[32mCREATE VIEW[0m in 0.15s]
[0m18:31:13.156440 [debug] [Thread-1 (]: Finished running node model.dbt_idx.stg_eltool__customers
[0m18:31:13.157435 [debug] [Thread-1 (]: Began running node model.dbt_idx.stg_eltool__customers_snapshots
[0m18:31:13.158435 [info ] [Thread-1 (]: 2 of 7 START sql view model warehouse.stg_eltool__customers_snapshots .......... [RUN]
[0m18:31:13.159471 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_idx.stg_eltool__customers, now model.dbt_idx.stg_eltool__customers_snapshots)
[0m18:31:13.160673 [debug] [Thread-1 (]: Began compiling node model.dbt_idx.stg_eltool__customers_snapshots
[0m18:31:13.163708 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_idx.stg_eltool__customers_snapshots"
[0m18:31:13.171223 [debug] [Thread-1 (]: Timing info for model.dbt_idx.stg_eltool__customers_snapshots (compile): 18:31:13.161686 => 18:31:13.171223
[0m18:31:13.172246 [debug] [Thread-1 (]: Began executing node model.dbt_idx.stg_eltool__customers_snapshots
[0m18:31:13.178245 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_idx.stg_eltool__customers_snapshots"
[0m18:31:13.185473 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__customers_snapshots"
[0m18:31:13.186498 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__customers_snapshots: BEGIN
[0m18:31:13.187442 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:31:13.207334 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m18:31:13.208344 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__customers_snapshots"
[0m18:31:13.209330 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__customers_snapshots: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__customers_snapshots"} */

  create view "IDX-Stock"."warehouse"."stg_eltool__customers_snapshots__dbt_tmp"
    
    
  as (
    with source as (select *
                from "IDX-Stock"."snapshots"."customers_snapshot"),
     renamed as (select customer_id,
                        zipcode,
                        city,
                        state_code,
                        datetime_created::TIMESTAMP AS datetime_created,
                        datetime_updated::TIMESTAMP AS datetime_updated,
                        dbt_valid_from,
                        dbt_valid_to
                 from source)
select *
from renamed
  );
[0m18:31:13.212884 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m18:31:13.216921 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__customers_snapshots"
[0m18:31:13.217921 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__customers_snapshots: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__customers_snapshots"} */
alter table "IDX-Stock"."warehouse"."stg_eltool__customers_snapshots" rename to "stg_eltool__customers_snapshots__dbt_backup"
[0m18:31:13.220436 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:31:13.223469 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__customers_snapshots"
[0m18:31:13.224472 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__customers_snapshots: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__customers_snapshots"} */
alter table "IDX-Stock"."warehouse"."stg_eltool__customers_snapshots__dbt_tmp" rename to "stg_eltool__customers_snapshots"
[0m18:31:13.227436 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:31:13.230012 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__customers_snapshots: COMMIT
[0m18:31:13.230012 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__customers_snapshots"
[0m18:31:13.231021 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__customers_snapshots: COMMIT
[0m18:31:13.235022 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m18:31:13.238053 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__customers_snapshots"
[0m18:31:13.239558 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__customers_snapshots: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__customers_snapshots"} */
drop view if exists "IDX-Stock"."warehouse"."stg_eltool__customers_snapshots__dbt_backup" cascade
[0m18:31:13.243460 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m18:31:13.245496 [debug] [Thread-1 (]: Timing info for model.dbt_idx.stg_eltool__customers_snapshots (execute): 18:31:13.173242 => 18:31:13.245496
[0m18:31:13.246496 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__customers_snapshots: Close
[0m18:31:13.248474 [info ] [Thread-1 (]: 2 of 7 OK created sql view model warehouse.stg_eltool__customers_snapshots ..... [[32mCREATE VIEW[0m in 0.09s]
[0m18:31:13.251017 [debug] [Thread-1 (]: Finished running node model.dbt_idx.stg_eltool__customers_snapshots
[0m18:31:13.252015 [debug] [Thread-1 (]: Began running node model.dbt_idx.stg_eltool__orders
[0m18:31:13.253009 [info ] [Thread-1 (]: 3 of 7 START sql view model warehouse.stg_eltool__orders ....................... [RUN]
[0m18:31:13.254025 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_idx.stg_eltool__customers_snapshots, now model.dbt_idx.stg_eltool__orders)
[0m18:31:13.255041 [debug] [Thread-1 (]: Began compiling node model.dbt_idx.stg_eltool__orders
[0m18:31:13.258040 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_idx.stg_eltool__orders"
[0m18:31:13.269358 [debug] [Thread-1 (]: Timing info for model.dbt_idx.stg_eltool__orders (compile): 18:31:13.255041 => 18:31:13.269358
[0m18:31:13.270497 [debug] [Thread-1 (]: Began executing node model.dbt_idx.stg_eltool__orders
[0m18:31:13.277513 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_idx.stg_eltool__orders"
[0m18:31:13.290389 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__orders"
[0m18:31:13.291402 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__orders: BEGIN
[0m18:31:13.292408 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:31:13.314254 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m18:31:13.315238 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__orders"
[0m18:31:13.316237 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__orders: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__orders"} */

  create view "IDX-Stock"."warehouse"."stg_eltool__orders__dbt_tmp"
    
    
  as (
    with source as (select *
                from "IDX-Stock"."warehouse"."orders"),
     renamed as (select order_id,
                        cust_id AS customer_id,
                        order_status,
                        order_purchase_timestamp::TIMESTAMP,
                        order_approved_at::TIMESTAMP,
                        order_delivered_carrier_date::TIMESTAMP,
                        order_delivered_customer_date::TIMESTAMP,
                        order_estimated_delivery_date::TIMESTAMP
                 from source)
select *
from renamed
  );
[0m18:31:13.320396 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m18:31:13.324385 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__orders"
[0m18:31:13.325403 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__orders: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__orders"} */
alter table "IDX-Stock"."warehouse"."stg_eltool__orders" rename to "stg_eltool__orders__dbt_backup"
[0m18:31:13.327655 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:31:13.331176 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__orders"
[0m18:31:13.332178 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__orders: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__orders"} */
alter table "IDX-Stock"."warehouse"."stg_eltool__orders__dbt_tmp" rename to "stg_eltool__orders"
[0m18:31:13.335178 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:31:13.338179 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__orders: COMMIT
[0m18:31:13.339179 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__orders"
[0m18:31:13.339691 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__orders: COMMIT
[0m18:31:13.344232 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m18:31:13.347235 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__orders"
[0m18:31:13.348235 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__orders: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__orders"} */
drop view if exists "IDX-Stock"."warehouse"."stg_eltool__orders__dbt_backup" cascade
[0m18:31:13.352537 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m18:31:13.354548 [debug] [Thread-1 (]: Timing info for model.dbt_idx.stg_eltool__orders (execute): 18:31:13.271531 => 18:31:13.354548
[0m18:31:13.355547 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__orders: Close
[0m18:31:13.356570 [info ] [Thread-1 (]: 3 of 7 OK created sql view model warehouse.stg_eltool__orders .................. [[32mCREATE VIEW[0m in 0.10s]
[0m18:31:13.358547 [debug] [Thread-1 (]: Finished running node model.dbt_idx.stg_eltool__orders
[0m18:31:13.360743 [debug] [Thread-1 (]: Began running node model.dbt_idx.stg_eltool__state
[0m18:31:13.361750 [info ] [Thread-1 (]: 4 of 7 START sql view model warehouse.stg_eltool__state ........................ [RUN]
[0m18:31:13.363753 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_idx.stg_eltool__orders, now model.dbt_idx.stg_eltool__state)
[0m18:31:13.365752 [debug] [Thread-1 (]: Began compiling node model.dbt_idx.stg_eltool__state
[0m18:31:13.369377 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_idx.stg_eltool__state"
[0m18:31:13.380030 [debug] [Thread-1 (]: Timing info for model.dbt_idx.stg_eltool__state (compile): 18:31:13.366755 => 18:31:13.379405
[0m18:31:13.382579 [debug] [Thread-1 (]: Began executing node model.dbt_idx.stg_eltool__state
[0m18:31:13.388225 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_idx.stg_eltool__state"
[0m18:31:13.394515 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__state"
[0m18:31:13.395514 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__state: BEGIN
[0m18:31:13.397478 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:31:13.420552 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m18:31:13.421588 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__state"
[0m18:31:13.422588 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__state: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__state"} */

  create view "IDX-Stock"."warehouse"."stg_eltool__state__dbt_tmp"
    
    
  as (
    with source as (select *
                from "IDX-Stock"."warehouse"."state"),
     renamed as (select state_identifier::INT AS state_id,
                         state_code::VARCHAR(2) AS state_code,
                         st_name::VARCHAR(30) AS state_name
                 from source)
select *
from renamed
  );
[0m18:31:13.426043 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m18:31:13.429702 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__state"
[0m18:31:13.430607 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__state: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__state"} */
alter table "IDX-Stock"."warehouse"."stg_eltool__state" rename to "stg_eltool__state__dbt_backup"
[0m18:31:13.433507 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:31:13.436554 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__state"
[0m18:31:13.437518 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__state: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__state"} */
alter table "IDX-Stock"."warehouse"."stg_eltool__state__dbt_tmp" rename to "stg_eltool__state"
[0m18:31:13.439520 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:31:13.442300 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__state: COMMIT
[0m18:31:13.446325 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__state"
[0m18:31:13.447309 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__state: COMMIT
[0m18:31:13.451691 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m18:31:13.455735 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__state"
[0m18:31:13.456751 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__state: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__state"} */
drop view if exists "IDX-Stock"."warehouse"."stg_eltool__state__dbt_backup" cascade
[0m18:31:13.461287 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m18:31:13.463340 [debug] [Thread-1 (]: Timing info for model.dbt_idx.stg_eltool__state (execute): 18:31:13.383512 => 18:31:13.463340
[0m18:31:13.464286 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__state: Close
[0m18:31:13.466304 [info ] [Thread-1 (]: 4 of 7 OK created sql view model warehouse.stg_eltool__state ................... [[32mCREATE VIEW[0m in 0.10s]
[0m18:31:13.468287 [debug] [Thread-1 (]: Finished running node model.dbt_idx.stg_eltool__state
[0m18:31:13.469833 [debug] [Thread-1 (]: Began running node model.dbt_idx.fact_orders
[0m18:31:13.470877 [info ] [Thread-1 (]: 5 of 7 START sql table model warehouse.fact_orders ............................. [RUN]
[0m18:31:13.471905 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_idx.stg_eltool__state, now model.dbt_idx.fact_orders)
[0m18:31:13.472878 [debug] [Thread-1 (]: Began compiling node model.dbt_idx.fact_orders
[0m18:31:13.476869 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_idx.fact_orders"
[0m18:31:13.483360 [debug] [Thread-1 (]: Timing info for model.dbt_idx.fact_orders (compile): 18:31:13.473876 => 18:31:13.482355
[0m18:31:13.483360 [debug] [Thread-1 (]: Began executing node model.dbt_idx.fact_orders
[0m18:31:13.510067 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_idx.fact_orders"
[0m18:31:13.516515 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.fact_orders"
[0m18:31:13.517571 [debug] [Thread-1 (]: On model.dbt_idx.fact_orders: BEGIN
[0m18:31:13.518530 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:31:13.540175 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m18:31:13.541681 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.fact_orders"
[0m18:31:13.541774 [debug] [Thread-1 (]: On model.dbt_idx.fact_orders: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.fact_orders"} */

  
    

  create  table "IDX-Stock"."warehouse"."fact_orders__dbt_tmp"
  
  
    as
  
  (
    with orders as (
    select *
    from "IDX-Stock"."warehouse"."stg_eltool__orders"
)
select * from orders
  );
  
[0m18:31:13.549323 [debug] [Thread-1 (]: SQL status: SELECT 999 in 0.0 seconds
[0m18:31:13.553252 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.fact_orders"
[0m18:31:13.554253 [debug] [Thread-1 (]: On model.dbt_idx.fact_orders: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.fact_orders"} */
alter table "IDX-Stock"."warehouse"."fact_orders" rename to "fact_orders__dbt_backup"
[0m18:31:13.557237 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:31:13.561768 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.fact_orders"
[0m18:31:13.562774 [debug] [Thread-1 (]: On model.dbt_idx.fact_orders: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.fact_orders"} */
alter table "IDX-Stock"."warehouse"."fact_orders__dbt_tmp" rename to "fact_orders"
[0m18:31:13.564798 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:31:13.573387 [debug] [Thread-1 (]: On model.dbt_idx.fact_orders: COMMIT
[0m18:31:13.574342 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.fact_orders"
[0m18:31:13.575345 [debug] [Thread-1 (]: On model.dbt_idx.fact_orders: COMMIT
[0m18:31:13.578422 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m18:31:13.585979 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.fact_orders"
[0m18:31:13.586950 [debug] [Thread-1 (]: On model.dbt_idx.fact_orders: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.fact_orders"} */
drop table if exists "IDX-Stock"."warehouse"."fact_orders__dbt_backup" cascade
[0m18:31:13.592465 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m18:31:13.594466 [debug] [Thread-1 (]: Timing info for model.dbt_idx.fact_orders (execute): 18:31:13.484351 => 18:31:13.594466
[0m18:31:13.595466 [debug] [Thread-1 (]: On model.dbt_idx.fact_orders: Close
[0m18:31:13.596490 [info ] [Thread-1 (]: 5 of 7 OK created sql table model warehouse.fact_orders ........................ [[32mSELECT 999[0m in 0.12s]
[0m18:31:13.598474 [debug] [Thread-1 (]: Finished running node model.dbt_idx.fact_orders
[0m18:31:13.599473 [debug] [Thread-1 (]: Began running node model.dbt_idx.dim_customers
[0m18:31:13.600941 [info ] [Thread-1 (]: 6 of 7 START sql table model warehouse.dim_customers ........................... [RUN]
[0m18:31:13.601935 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_idx.fact_orders, now model.dbt_idx.dim_customers)
[0m18:31:13.602975 [debug] [Thread-1 (]: Began compiling node model.dbt_idx.dim_customers
[0m18:31:13.606971 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_idx.dim_customers"
[0m18:31:13.613487 [debug] [Thread-1 (]: Timing info for model.dbt_idx.dim_customers (compile): 18:31:13.603971 => 18:31:13.612487
[0m18:31:13.614472 [debug] [Thread-1 (]: Began executing node model.dbt_idx.dim_customers
[0m18:31:13.619964 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_idx.dim_customers"
[0m18:31:13.628005 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.dim_customers"
[0m18:31:13.628005 [debug] [Thread-1 (]: On model.dbt_idx.dim_customers: BEGIN
[0m18:31:13.629598 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:31:13.653515 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m18:31:13.654487 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.dim_customers"
[0m18:31:13.654487 [debug] [Thread-1 (]: On model.dbt_idx.dim_customers: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.dim_customers"} */

  
    

  create  table "IDX-Stock"."warehouse"."dim_customers__dbt_tmp"
  
  
    as
  
  (
    -- noinspection SqlDialectInspectionForFile

with customers as (
    select *
    from "IDX-Stock"."warehouse"."stg_eltool__customers_snapshots"
    ),
     state as (
         select *
         from "IDX-Stock"."warehouse"."stg_eltool__state"
     )
select c.customer_id,
       c.zipcode,
       c.city,
       c.state_code,
       s.state_name,
       c.datetime_created,
       c.datetime_updated,
       c.dbt_valid_from::TIMESTAMP as valid_from,
        CASE WHEN c.dbt_valid_to IS NULL
            THEN '9999-12-31'::TIMESTAMP
            ELSE c.dbt_valid_to::TIMESTAMP
        END as valid_to
from customers c
    join state s on c.state_code = s.state_code
  );
  
[0m18:31:13.660061 [debug] [Thread-1 (]: SQL status: SELECT 105 in 0.0 seconds
[0m18:31:13.663070 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.dim_customers"
[0m18:31:13.664082 [debug] [Thread-1 (]: On model.dbt_idx.dim_customers: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.dim_customers"} */
alter table "IDX-Stock"."warehouse"."dim_customers" rename to "dim_customers__dbt_backup"
[0m18:31:13.667082 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:31:13.670594 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.dim_customers"
[0m18:31:13.671594 [debug] [Thread-1 (]: On model.dbt_idx.dim_customers: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.dim_customers"} */
alter table "IDX-Stock"."warehouse"."dim_customers__dbt_tmp" rename to "dim_customers"
[0m18:31:13.674594 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:31:13.676595 [debug] [Thread-1 (]: On model.dbt_idx.dim_customers: COMMIT
[0m18:31:13.677606 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.dim_customers"
[0m18:31:13.678594 [debug] [Thread-1 (]: On model.dbt_idx.dim_customers: COMMIT
[0m18:31:13.681364 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m18:31:13.685411 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.dim_customers"
[0m18:31:13.686375 [debug] [Thread-1 (]: On model.dbt_idx.dim_customers: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.dim_customers"} */
drop table if exists "IDX-Stock"."warehouse"."dim_customers__dbt_backup" cascade
[0m18:31:13.690464 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m18:31:13.692484 [debug] [Thread-1 (]: Timing info for model.dbt_idx.dim_customers (execute): 18:31:13.615454 => 18:31:13.692484
[0m18:31:13.693482 [debug] [Thread-1 (]: On model.dbt_idx.dim_customers: Close
[0m18:31:13.696467 [info ] [Thread-1 (]: 6 of 7 OK created sql table model warehouse.dim_customers ...................... [[32mSELECT 105[0m in 0.09s]
[0m18:31:13.698462 [debug] [Thread-1 (]: Finished running node model.dbt_idx.dim_customers
[0m18:31:13.700974 [debug] [Thread-1 (]: Began running node model.dbt_idx.customer_orders_status
[0m18:31:13.701985 [info ] [Thread-1 (]: 7 of 7 START sql view model warehouse.customer_orders_status ................... [RUN]
[0m18:31:13.704019 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_idx.dim_customers, now model.dbt_idx.customer_orders_status)
[0m18:31:13.704997 [debug] [Thread-1 (]: Began compiling node model.dbt_idx.customer_orders_status
[0m18:31:13.708024 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_idx.customer_orders_status"
[0m18:31:13.716551 [debug] [Thread-1 (]: Timing info for model.dbt_idx.customer_orders_status (compile): 18:31:13.704997 => 18:31:13.716551
[0m18:31:13.717551 [debug] [Thread-1 (]: Began executing node model.dbt_idx.customer_orders_status
[0m18:31:13.722175 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_idx.customer_orders_status"
[0m18:31:13.728180 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.customer_orders_status"
[0m18:31:13.729176 [debug] [Thread-1 (]: On model.dbt_idx.customer_orders_status: BEGIN
[0m18:31:13.730380 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:31:13.752389 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m18:31:13.753394 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.customer_orders_status"
[0m18:31:13.754400 [debug] [Thread-1 (]: On model.dbt_idx.customer_orders_status: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.customer_orders_status"} */

  create view "IDX-Stock"."warehouse"."customer_orders_status__dbt_tmp"
    
    
  as (
    with orders as (select *
                from "IDX-Stock"."warehouse"."fact_orders"),
     customers as (select *
                   from "IDX-Stock"."warehouse"."dim_customers")
select o.order_id,
       o.customer_id,
       o.order_status,
       o.order_purchase_timestamp,
       o.order_approved_at,
       o.order_delivered_carrier_date,
       o.order_delivered_customer_date,
       o.order_estimated_delivery_date,
       c.zipcode    as customer_zipcode,
       c.city       as customer_city,
       c.state_code as customer_state_code,
       c.state_name as customer_state_name
from orders o
    join customers c on o.customer_id = c.customer_id
    and o.order_purchase_timestamp >= c.valid_from
    and o.order_purchase_timestamp <= c.valid_to
  );
[0m18:31:13.758418 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m18:31:13.762863 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.customer_orders_status"
[0m18:31:13.763866 [debug] [Thread-1 (]: On model.dbt_idx.customer_orders_status: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.customer_orders_status"} */
alter table "IDX-Stock"."warehouse"."customer_orders_status__dbt_tmp" rename to "customer_orders_status"
[0m18:31:13.766839 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:31:13.770359 [debug] [Thread-1 (]: On model.dbt_idx.customer_orders_status: COMMIT
[0m18:31:13.771363 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.customer_orders_status"
[0m18:31:13.772367 [debug] [Thread-1 (]: On model.dbt_idx.customer_orders_status: COMMIT
[0m18:31:13.776361 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m18:31:13.779361 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.customer_orders_status"
[0m18:31:13.780836 [debug] [Thread-1 (]: On model.dbt_idx.customer_orders_status: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.customer_orders_status"} */
drop view if exists "IDX-Stock"."warehouse"."customer_orders_status__dbt_backup" cascade
[0m18:31:13.783863 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m18:31:13.785373 [debug] [Thread-1 (]: Timing info for model.dbt_idx.customer_orders_status (execute): 18:31:13.717551 => 18:31:13.785373
[0m18:31:13.786385 [debug] [Thread-1 (]: On model.dbt_idx.customer_orders_status: Close
[0m18:31:13.788387 [info ] [Thread-1 (]: 7 of 7 OK created sql view model warehouse.customer_orders_status .............. [[32mCREATE VIEW[0m in 0.08s]
[0m18:31:13.790925 [debug] [Thread-1 (]: Finished running node model.dbt_idx.customer_orders_status
[0m18:31:13.794926 [debug] [MainThread]: Using postgres connection "master"
[0m18:31:13.795917 [debug] [MainThread]: On master: BEGIN
[0m18:31:13.796934 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:31:13.819395 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m18:31:13.820402 [debug] [MainThread]: On master: COMMIT
[0m18:31:13.821403 [debug] [MainThread]: Using postgres connection "master"
[0m18:31:13.822418 [debug] [MainThread]: On master: COMMIT
[0m18:31:13.823404 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m18:31:13.824402 [debug] [MainThread]: On master: Close
[0m18:31:13.826420 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:31:13.827402 [debug] [MainThread]: Connection 'list_IDX-Stock' was properly closed.
[0m18:31:13.828429 [debug] [MainThread]: Connection 'list_IDX-Stock_snapshots' was properly closed.
[0m18:31:13.829404 [debug] [MainThread]: Connection 'model.dbt_idx.customer_orders_status' was properly closed.
[0m18:31:13.830519 [info ] [MainThread]: 
[0m18:31:13.832527 [info ] [MainThread]: Finished running 5 view models, 2 table models in 0 hours 0 minutes and 1.04 seconds (1.04s).
[0m18:31:13.834546 [debug] [MainThread]: Command end result
[0m18:31:13.853762 [info ] [MainThread]: 
[0m18:31:13.854779 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:31:13.855778 [info ] [MainThread]: 
[0m18:31:13.856761 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=0 SKIP=0 TOTAL=7
[0m18:31:13.857762 [debug] [MainThread]: Command `dbt run` succeeded at 18:31:13.857762 after 1.52 seconds
[0m18:31:13.859288 [debug] [MainThread]: Flushing usage events


============================== 18:33:30.437884 | 7f8a3324-c082-41d3-b8e6-46ece989a707 ==============================
[0m18:33:30.437884 [info ] [MainThread]: Running with dbt=1.6.1
[0m18:33:30.443048 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'D:\\00 Project\\00 My Project\\IdeaProjects\\Py-DBT-IDX', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'D:\\00 Project\\00 My Project\\IdeaProjects\\Py-DBT-IDX\\logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt test', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'False'}
[0m18:33:30.574887 [info ] [MainThread]: Registered adapter: postgres=1.6.1
[0m18:33:30.586445 [debug] [MainThread]: checksum: efe19d9f5b93d1a98cc804fbfcdb6b3aced98b974af664946fee1cde8837deb7, vars: {}, profile: , target: , version: 1.6.1
[0m18:33:30.736854 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m18:33:30.737855 [debug] [MainThread]: Partial parsing: updated file: dbt_idx://tests\assert_customer_dimension_has_no_row_loss.sql.sql
[0m18:33:30.805501 [info ] [MainThread]: Found 1 snapshot, 9 tests, 7 models, 3 sources, 0 exposures, 0 metrics, 349 macros, 0 groups, 0 semantic models
[0m18:33:30.807503 [info ] [MainThread]: 
[0m18:33:30.810017 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m18:33:30.817025 [debug] [ThreadPool]: Acquiring new postgres connection 'list_IDX-Stock_warehouse'
[0m18:33:30.827253 [debug] [ThreadPool]: Using postgres connection "list_IDX-Stock_warehouse"
[0m18:33:30.827253 [debug] [ThreadPool]: On list_IDX-Stock_warehouse: BEGIN
[0m18:33:30.829850 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:33:30.864060 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m18:33:30.865076 [debug] [ThreadPool]: Using postgres connection "list_IDX-Stock_warehouse"
[0m18:33:30.866040 [debug] [ThreadPool]: On list_IDX-Stock_warehouse: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "connection_name": "list_IDX-Stock_warehouse"} */
select
      'IDX-Stock' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'warehouse'
    union all
    select
      'IDX-Stock' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'warehouse'
    union all
    select
      'IDX-Stock' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'warehouse'
  
[0m18:33:30.871099 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.0 seconds
[0m18:33:30.873135 [debug] [ThreadPool]: On list_IDX-Stock_warehouse: ROLLBACK
[0m18:33:30.874100 [debug] [ThreadPool]: On list_IDX-Stock_warehouse: Close
[0m18:33:30.877101 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_IDX-Stock_warehouse, now list_IDX-Stock_snapshots)
[0m18:33:30.882344 [debug] [ThreadPool]: Using postgres connection "list_IDX-Stock_snapshots"
[0m18:33:30.883344 [debug] [ThreadPool]: On list_IDX-Stock_snapshots: BEGIN
[0m18:33:30.884311 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:33:30.905700 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m18:33:30.906690 [debug] [ThreadPool]: Using postgres connection "list_IDX-Stock_snapshots"
[0m18:33:30.907710 [debug] [ThreadPool]: On list_IDX-Stock_snapshots: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "connection_name": "list_IDX-Stock_snapshots"} */
select
      'IDX-Stock' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'snapshots'
    union all
    select
      'IDX-Stock' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'snapshots'
    union all
    select
      'IDX-Stock' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'snapshots'
  
[0m18:33:30.912162 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.0 seconds
[0m18:33:30.914180 [debug] [ThreadPool]: On list_IDX-Stock_snapshots: ROLLBACK
[0m18:33:30.916146 [debug] [ThreadPool]: On list_IDX-Stock_snapshots: Close
[0m18:33:30.924721 [debug] [MainThread]: Using postgres connection "master"
[0m18:33:30.925722 [debug] [MainThread]: On master: BEGIN
[0m18:33:30.926686 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:33:30.947235 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m18:33:30.948748 [debug] [MainThread]: Using postgres connection "master"
[0m18:33:30.949755 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m18:33:30.959800 [debug] [MainThread]: SQL status: SELECT 6 in 0.0 seconds
[0m18:33:30.962844 [debug] [MainThread]: On master: ROLLBACK
[0m18:33:30.964807 [debug] [MainThread]: Using postgres connection "master"
[0m18:33:30.965858 [debug] [MainThread]: On master: BEGIN
[0m18:33:30.968807 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m18:33:30.969926 [debug] [MainThread]: On master: COMMIT
[0m18:33:30.970896 [debug] [MainThread]: Using postgres connection "master"
[0m18:33:30.971934 [debug] [MainThread]: On master: COMMIT
[0m18:33:30.973917 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m18:33:30.974909 [debug] [MainThread]: On master: Close
[0m18:33:30.975922 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:33:30.977922 [info ] [MainThread]: 
[0m18:33:30.985048 [debug] [Thread-1 (]: Began running node test.dbt_idx.accepted_values_customer_orders_status_order_status__delivered__invoiced__shipped__processing__canceled__unavailable.ea8c296d27
[0m18:33:30.986048 [info ] [Thread-1 (]: 1 of 9 START test accepted_values_customer_orders_status_order_status__delivered__invoiced__shipped__processing__canceled__unavailable  [RUN]
[0m18:33:30.988081 [debug] [Thread-1 (]: Acquiring new postgres connection 'test.dbt_idx.accepted_values_customer_orders_status_order_status__delivered__invoiced__shipped__processing__canceled__unavailable.ea8c296d27'
[0m18:33:30.988081 [debug] [Thread-1 (]: Began compiling node test.dbt_idx.accepted_values_customer_orders_status_order_status__delivered__invoiced__shipped__processing__canceled__unavailable.ea8c296d27
[0m18:33:31.009710 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_idx.accepted_values_customer_orders_status_order_status__delivered__invoiced__shipped__processing__canceled__unavailable.ea8c296d27"
[0m18:33:31.016969 [debug] [Thread-1 (]: Timing info for test.dbt_idx.accepted_values_customer_orders_status_order_status__delivered__invoiced__shipped__processing__canceled__unavailable.ea8c296d27 (compile): 18:33:30.989076 => 18:33:31.016969
[0m18:33:31.017980 [debug] [Thread-1 (]: Began executing node test.dbt_idx.accepted_values_customer_orders_status_order_status__delivered__invoiced__shipped__processing__canceled__unavailable.ea8c296d27
[0m18:33:31.034017 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_idx.accepted_values_customer_orders_status_order_status__delivered__invoiced__shipped__processing__canceled__unavailable.ea8c296d27"
[0m18:33:31.041679 [debug] [Thread-1 (]: Using postgres connection "test.dbt_idx.accepted_values_customer_orders_status_order_status__delivered__invoiced__shipped__processing__canceled__unavailable.ea8c296d27"
[0m18:33:31.043680 [debug] [Thread-1 (]: On test.dbt_idx.accepted_values_customer_orders_status_order_status__delivered__invoiced__shipped__processing__canceled__unavailable.ea8c296d27: BEGIN
[0m18:33:31.044715 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m18:33:31.066218 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m18:33:31.067249 [debug] [Thread-1 (]: Using postgres connection "test.dbt_idx.accepted_values_customer_orders_status_order_status__delivered__invoiced__shipped__processing__canceled__unavailable.ea8c296d27"
[0m18:33:31.067249 [debug] [Thread-1 (]: On test.dbt_idx.accepted_values_customer_orders_status_order_status__delivered__invoiced__shipped__processing__canceled__unavailable.ea8c296d27: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "test.dbt_idx.accepted_values_customer_orders_status_order_status__delivered__invoiced__shipped__processing__canceled__unavailable.ea8c296d27"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        order_status as value_field,
        count(*) as n_records

    from "IDX-Stock"."warehouse"."customer_orders_status"
    group by order_status

)

select *
from all_values
where value_field not in (
    'delivered','invoiced','shipped','processing','canceled','unavailable'
)



      
    ) dbt_internal_test
[0m18:33:31.072568 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m18:33:31.074597 [debug] [Thread-1 (]: Timing info for test.dbt_idx.accepted_values_customer_orders_status_order_status__delivered__invoiced__shipped__processing__canceled__unavailable.ea8c296d27 (execute): 18:33:31.018980 => 18:33:31.074597
[0m18:33:31.075598 [debug] [Thread-1 (]: On test.dbt_idx.accepted_values_customer_orders_status_order_status__delivered__invoiced__shipped__processing__canceled__unavailable.ea8c296d27: ROLLBACK
[0m18:33:31.077571 [debug] [Thread-1 (]: On test.dbt_idx.accepted_values_customer_orders_status_order_status__delivered__invoiced__shipped__processing__canceled__unavailable.ea8c296d27: Close
[0m18:33:31.080082 [info ] [Thread-1 (]: 1 of 9 PASS accepted_values_customer_orders_status_order_status__delivered__invoiced__shipped__processing__canceled__unavailable  [[32mPASS[0m in 0.09s]
[0m18:33:31.082083 [debug] [Thread-1 (]: Finished running node test.dbt_idx.accepted_values_customer_orders_status_order_status__delivered__invoiced__shipped__processing__canceled__unavailable.ea8c296d27
[0m18:33:31.083084 [debug] [Thread-1 (]: Began running node test.dbt_idx.assert_customer_dimension_has_no_row_loss.sql
[0m18:33:31.084083 [info ] [Thread-1 (]: 2 of 9 START test assert_customer_dimension_has_no_row_loss.sql ................ [RUN]
[0m18:33:31.085084 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_idx.accepted_values_customer_orders_status_order_status__delivered__invoiced__shipped__processing__canceled__unavailable.ea8c296d27, now test.dbt_idx.assert_customer_dimension_has_no_row_loss.sql)
[0m18:33:31.086119 [debug] [Thread-1 (]: Began compiling node test.dbt_idx.assert_customer_dimension_has_no_row_loss.sql
[0m18:33:31.089088 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_idx.assert_customer_dimension_has_no_row_loss.sql"
[0m18:33:31.097422 [debug] [Thread-1 (]: Timing info for test.dbt_idx.assert_customer_dimension_has_no_row_loss.sql (compile): 18:33:31.087084 => 18:33:31.096418
[0m18:33:31.099033 [debug] [Thread-1 (]: Began executing node test.dbt_idx.assert_customer_dimension_has_no_row_loss.sql
[0m18:33:31.101975 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_idx.assert_customer_dimension_has_no_row_loss.sql"
[0m18:33:31.109579 [debug] [Thread-1 (]: Using postgres connection "test.dbt_idx.assert_customer_dimension_has_no_row_loss.sql"
[0m18:33:31.112614 [debug] [Thread-1 (]: On test.dbt_idx.assert_customer_dimension_has_no_row_loss.sql: BEGIN
[0m18:33:31.113625 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:33:31.137735 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m18:33:31.138736 [debug] [Thread-1 (]: Using postgres connection "test.dbt_idx.assert_customer_dimension_has_no_row_loss.sql"
[0m18:33:31.139866 [debug] [Thread-1 (]: On test.dbt_idx.assert_customer_dimension_has_no_row_loss.sql: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "test.dbt_idx.assert_customer_dimension_has_no_row_loss.sql"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      -- dim_customers must have the same number of rows as its staging counterpart
-- Therefore return records where this isn't true to make the test fail
select *
from (
         select stg_cust.customer_id
         from "IDX-Stock"."warehouse"."stg_eltool__customers" stg_cust
             inner join "IDX-Stock"."warehouse"."dim_customers" dim_cust
         on stg_cust.customer_id = dim_cust.customer_id
         where dim_cust.customer_id is null
     ) tmp
      
    ) dbt_internal_test
[0m18:33:31.142871 [debug] [Thread-1 (]: Postgres adapter: Postgres error: column stg_cust.customer_id does not exist
LINE 14:          on stg_cust.customer_id = dim_cust.customer_id
                     ^
HINT:  Perhaps you meant to reference the column "dim_cust.customer_id".

[0m18:33:31.143900 [debug] [Thread-1 (]: On test.dbt_idx.assert_customer_dimension_has_no_row_loss.sql: ROLLBACK
[0m18:33:31.146878 [debug] [Thread-1 (]: Timing info for test.dbt_idx.assert_customer_dimension_has_no_row_loss.sql (execute): 18:33:31.099937 => 18:33:31.146878
[0m18:33:31.147889 [debug] [Thread-1 (]: On test.dbt_idx.assert_customer_dimension_has_no_row_loss.sql: Close
[0m18:33:31.167981 [debug] [Thread-1 (]: Database Error in test assert_customer_dimension_has_no_row_loss.sql (tests\assert_customer_dimension_has_no_row_loss.sql.sql)
  column stg_cust.customer_id does not exist
  LINE 14:          on stg_cust.customer_id = dim_cust.customer_id
                       ^
  HINT:  Perhaps you meant to reference the column "dim_cust.customer_id".
  compiled Code at target\run\dbt_idx\tests\assert_customer_dimension_has_no_row_loss.sql.sql
[0m18:33:31.168982 [error] [Thread-1 (]: 2 of 9 ERROR assert_customer_dimension_has_no_row_loss.sql ..................... [[31mERROR[0m in 0.08s]
[0m18:33:31.170498 [debug] [Thread-1 (]: Finished running node test.dbt_idx.assert_customer_dimension_has_no_row_loss.sql
[0m18:33:31.171535 [debug] [Thread-1 (]: Began running node test.dbt_idx.not_null_customer_orders_status_customer_id.3915c814eb
[0m18:33:31.172534 [info ] [Thread-1 (]: 3 of 9 START test not_null_customer_orders_status_customer_id .................. [RUN]
[0m18:33:31.173500 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_idx.assert_customer_dimension_has_no_row_loss.sql, now test.dbt_idx.not_null_customer_orders_status_customer_id.3915c814eb)
[0m18:33:31.174548 [debug] [Thread-1 (]: Began compiling node test.dbt_idx.not_null_customer_orders_status_customer_id.3915c814eb
[0m18:33:31.183558 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_idx.not_null_customer_orders_status_customer_id.3915c814eb"
[0m18:33:31.194094 [debug] [Thread-1 (]: Timing info for test.dbt_idx.not_null_customer_orders_status_customer_id.3915c814eb (compile): 18:33:31.174548 => 18:33:31.193106
[0m18:33:31.195087 [debug] [Thread-1 (]: Began executing node test.dbt_idx.not_null_customer_orders_status_customer_id.3915c814eb
[0m18:33:31.201090 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_idx.not_null_customer_orders_status_customer_id.3915c814eb"
[0m18:33:31.209089 [debug] [Thread-1 (]: Using postgres connection "test.dbt_idx.not_null_customer_orders_status_customer_id.3915c814eb"
[0m18:33:31.211298 [debug] [Thread-1 (]: On test.dbt_idx.not_null_customer_orders_status_customer_id.3915c814eb: BEGIN
[0m18:33:31.213298 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:33:31.236902 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m18:33:31.237901 [debug] [Thread-1 (]: Using postgres connection "test.dbt_idx.not_null_customer_orders_status_customer_id.3915c814eb"
[0m18:33:31.238912 [debug] [Thread-1 (]: On test.dbt_idx.not_null_customer_orders_status_customer_id.3915c814eb: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "test.dbt_idx.not_null_customer_orders_status_customer_id.3915c814eb"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select customer_id
from "IDX-Stock"."warehouse"."customer_orders_status"
where customer_id is null



      
    ) dbt_internal_test
[0m18:33:31.242576 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m18:33:31.245552 [debug] [Thread-1 (]: Timing info for test.dbt_idx.not_null_customer_orders_status_customer_id.3915c814eb (execute): 18:33:31.196121 => 18:33:31.244553
[0m18:33:31.246561 [debug] [Thread-1 (]: On test.dbt_idx.not_null_customer_orders_status_customer_id.3915c814eb: ROLLBACK
[0m18:33:31.249074 [debug] [Thread-1 (]: On test.dbt_idx.not_null_customer_orders_status_customer_id.3915c814eb: Close
[0m18:33:31.251090 [info ] [Thread-1 (]: 3 of 9 PASS not_null_customer_orders_status_customer_id ........................ [[32mPASS[0m in 0.08s]
[0m18:33:31.254094 [debug] [Thread-1 (]: Finished running node test.dbt_idx.not_null_customer_orders_status_customer_id.3915c814eb
[0m18:33:31.255087 [debug] [Thread-1 (]: Began running node test.dbt_idx.not_null_stg_eltool__customers_snapshots_customer_id.ea4fc4ca86
[0m18:33:31.256107 [info ] [Thread-1 (]: 4 of 9 START test not_null_stg_eltool__customers_snapshots_customer_id ......... [RUN]
[0m18:33:31.257128 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_idx.not_null_customer_orders_status_customer_id.3915c814eb, now test.dbt_idx.not_null_stg_eltool__customers_snapshots_customer_id.ea4fc4ca86)
[0m18:33:31.258134 [debug] [Thread-1 (]: Began compiling node test.dbt_idx.not_null_stg_eltool__customers_snapshots_customer_id.ea4fc4ca86
[0m18:33:31.263470 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_idx.not_null_stg_eltool__customers_snapshots_customer_id.ea4fc4ca86"
[0m18:33:31.273039 [debug] [Thread-1 (]: Timing info for test.dbt_idx.not_null_stg_eltool__customers_snapshots_customer_id.ea4fc4ca86 (compile): 18:33:31.259097 => 18:33:31.273039
[0m18:33:31.274038 [debug] [Thread-1 (]: Began executing node test.dbt_idx.not_null_stg_eltool__customers_snapshots_customer_id.ea4fc4ca86
[0m18:33:31.277036 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_idx.not_null_stg_eltool__customers_snapshots_customer_id.ea4fc4ca86"
[0m18:33:31.283314 [debug] [Thread-1 (]: Using postgres connection "test.dbt_idx.not_null_stg_eltool__customers_snapshots_customer_id.ea4fc4ca86"
[0m18:33:31.284821 [debug] [Thread-1 (]: On test.dbt_idx.not_null_stg_eltool__customers_snapshots_customer_id.ea4fc4ca86: BEGIN
[0m18:33:31.285832 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:33:31.312307 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m18:33:31.314330 [debug] [Thread-1 (]: Using postgres connection "test.dbt_idx.not_null_stg_eltool__customers_snapshots_customer_id.ea4fc4ca86"
[0m18:33:31.316309 [debug] [Thread-1 (]: On test.dbt_idx.not_null_stg_eltool__customers_snapshots_customer_id.ea4fc4ca86: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "test.dbt_idx.not_null_stg_eltool__customers_snapshots_customer_id.ea4fc4ca86"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select customer_id
from "IDX-Stock"."warehouse"."stg_eltool__customers_snapshots"
where customer_id is null



      
    ) dbt_internal_test
[0m18:33:31.320944 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m18:33:31.323957 [debug] [Thread-1 (]: Timing info for test.dbt_idx.not_null_stg_eltool__customers_snapshots_customer_id.ea4fc4ca86 (execute): 18:33:31.275037 => 18:33:31.322921
[0m18:33:31.324925 [debug] [Thread-1 (]: On test.dbt_idx.not_null_stg_eltool__customers_snapshots_customer_id.ea4fc4ca86: ROLLBACK
[0m18:33:31.327919 [debug] [Thread-1 (]: On test.dbt_idx.not_null_stg_eltool__customers_snapshots_customer_id.ea4fc4ca86: Close
[0m18:33:31.328919 [info ] [Thread-1 (]: 4 of 9 PASS not_null_stg_eltool__customers_snapshots_customer_id ............... [[32mPASS[0m in 0.07s]
[0m18:33:31.331369 [debug] [Thread-1 (]: Finished running node test.dbt_idx.not_null_stg_eltool__customers_snapshots_customer_id.ea4fc4ca86
[0m18:33:31.333407 [debug] [Thread-1 (]: Began running node test.dbt_idx.source_not_null_warehouse_customers_customer_id.ae7452c4c6
[0m18:33:31.334413 [info ] [Thread-1 (]: 5 of 9 START test source_not_null_warehouse_customers_customer_id .............. [RUN]
[0m18:33:31.335370 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_idx.not_null_stg_eltool__customers_snapshots_customer_id.ea4fc4ca86, now test.dbt_idx.source_not_null_warehouse_customers_customer_id.ae7452c4c6)
[0m18:33:31.336366 [debug] [Thread-1 (]: Began compiling node test.dbt_idx.source_not_null_warehouse_customers_customer_id.ae7452c4c6
[0m18:33:31.340958 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_idx.source_not_null_warehouse_customers_customer_id.ae7452c4c6"
[0m18:33:31.349006 [debug] [Thread-1 (]: Timing info for test.dbt_idx.source_not_null_warehouse_customers_customer_id.ae7452c4c6 (compile): 18:33:31.336366 => 18:33:31.348041
[0m18:33:31.349551 [debug] [Thread-1 (]: Began executing node test.dbt_idx.source_not_null_warehouse_customers_customer_id.ae7452c4c6
[0m18:33:31.353594 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_idx.source_not_null_warehouse_customers_customer_id.ae7452c4c6"
[0m18:33:31.360138 [debug] [Thread-1 (]: Using postgres connection "test.dbt_idx.source_not_null_warehouse_customers_customer_id.ae7452c4c6"
[0m18:33:31.361705 [debug] [Thread-1 (]: On test.dbt_idx.source_not_null_warehouse_customers_customer_id.ae7452c4c6: BEGIN
[0m18:33:31.362701 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:33:31.384531 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m18:33:31.385562 [debug] [Thread-1 (]: Using postgres connection "test.dbt_idx.source_not_null_warehouse_customers_customer_id.ae7452c4c6"
[0m18:33:31.386529 [debug] [Thread-1 (]: On test.dbt_idx.source_not_null_warehouse_customers_customer_id.ae7452c4c6: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "test.dbt_idx.source_not_null_warehouse_customers_customer_id.ae7452c4c6"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select customer_id
from "IDX-Stock"."warehouse"."customers"
where customer_id is null



      
    ) dbt_internal_test
[0m18:33:31.389142 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m18:33:31.391047 [debug] [Thread-1 (]: Timing info for test.dbt_idx.source_not_null_warehouse_customers_customer_id.ae7452c4c6 (execute): 18:33:31.351587 => 18:33:31.391047
[0m18:33:31.392049 [debug] [Thread-1 (]: On test.dbt_idx.source_not_null_warehouse_customers_customer_id.ae7452c4c6: ROLLBACK
[0m18:33:31.394048 [debug] [Thread-1 (]: On test.dbt_idx.source_not_null_warehouse_customers_customer_id.ae7452c4c6: Close
[0m18:33:31.396065 [info ] [Thread-1 (]: 5 of 9 PASS source_not_null_warehouse_customers_customer_id .................... [[32mPASS[0m in 0.06s]
[0m18:33:31.398044 [debug] [Thread-1 (]: Finished running node test.dbt_idx.source_not_null_warehouse_customers_customer_id.ae7452c4c6
[0m18:33:31.400139 [debug] [Thread-1 (]: Began running node test.dbt_idx.source_not_null_warehouse_orders_order_id.c85a1f0b76
[0m18:33:31.402174 [info ] [Thread-1 (]: 6 of 9 START test source_not_null_warehouse_orders_order_id .................... [RUN]
[0m18:33:31.403138 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_idx.source_not_null_warehouse_customers_customer_id.ae7452c4c6, now test.dbt_idx.source_not_null_warehouse_orders_order_id.c85a1f0b76)
[0m18:33:31.404175 [debug] [Thread-1 (]: Began compiling node test.dbt_idx.source_not_null_warehouse_orders_order_id.c85a1f0b76
[0m18:33:31.410507 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_idx.source_not_null_warehouse_orders_order_id.c85a1f0b76"
[0m18:33:31.417530 [debug] [Thread-1 (]: Timing info for test.dbt_idx.source_not_null_warehouse_orders_order_id.c85a1f0b76 (compile): 18:33:31.404175 => 18:33:31.417530
[0m18:33:31.420045 [debug] [Thread-1 (]: Began executing node test.dbt_idx.source_not_null_warehouse_orders_order_id.c85a1f0b76
[0m18:33:31.423052 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_idx.source_not_null_warehouse_orders_order_id.c85a1f0b76"
[0m18:33:31.429599 [debug] [Thread-1 (]: Using postgres connection "test.dbt_idx.source_not_null_warehouse_orders_order_id.c85a1f0b76"
[0m18:33:31.431641 [debug] [Thread-1 (]: On test.dbt_idx.source_not_null_warehouse_orders_order_id.c85a1f0b76: BEGIN
[0m18:33:31.431641 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:33:31.453828 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m18:33:31.454860 [debug] [Thread-1 (]: Using postgres connection "test.dbt_idx.source_not_null_warehouse_orders_order_id.c85a1f0b76"
[0m18:33:31.455889 [debug] [Thread-1 (]: On test.dbt_idx.source_not_null_warehouse_orders_order_id.c85a1f0b76: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "test.dbt_idx.source_not_null_warehouse_orders_order_id.c85a1f0b76"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select order_id
from "IDX-Stock"."warehouse"."orders"
where order_id is null



      
    ) dbt_internal_test
[0m18:33:31.458825 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m18:33:31.461424 [debug] [Thread-1 (]: Timing info for test.dbt_idx.source_not_null_warehouse_orders_order_id.c85a1f0b76 (execute): 18:33:31.421051 => 18:33:31.460531
[0m18:33:31.462390 [debug] [Thread-1 (]: On test.dbt_idx.source_not_null_warehouse_orders_order_id.c85a1f0b76: ROLLBACK
[0m18:33:31.464393 [debug] [Thread-1 (]: On test.dbt_idx.source_not_null_warehouse_orders_order_id.c85a1f0b76: Close
[0m18:33:31.466392 [info ] [Thread-1 (]: 6 of 9 PASS source_not_null_warehouse_orders_order_id .......................... [[32mPASS[0m in 0.06s]
[0m18:33:31.467394 [debug] [Thread-1 (]: Finished running node test.dbt_idx.source_not_null_warehouse_orders_order_id.c85a1f0b76
[0m18:33:31.469946 [debug] [Thread-1 (]: Began running node test.dbt_idx.source_relationships_warehouse_orders_cust_id__customer_id__source_warehouse_customers_.d3f9188fc2
[0m18:33:31.470956 [info ] [Thread-1 (]: 7 of 9 START test source_relationships_warehouse_orders_cust_id__customer_id__source_warehouse_customers_  [RUN]
[0m18:33:31.472924 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_idx.source_not_null_warehouse_orders_order_id.c85a1f0b76, now test.dbt_idx.source_relationships_warehouse_orders_cust_id__customer_id__source_warehouse_customers_.d3f9188fc2)
[0m18:33:31.473917 [debug] [Thread-1 (]: Began compiling node test.dbt_idx.source_relationships_warehouse_orders_cust_id__customer_id__source_warehouse_customers_.d3f9188fc2
[0m18:33:31.483557 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_idx.source_relationships_warehouse_orders_cust_id__customer_id__source_warehouse_customers_.d3f9188fc2"
[0m18:33:31.489948 [debug] [Thread-1 (]: Timing info for test.dbt_idx.source_relationships_warehouse_orders_cust_id__customer_id__source_warehouse_customers_.d3f9188fc2 (compile): 18:33:31.474936 => 18:33:31.489948
[0m18:33:31.490985 [debug] [Thread-1 (]: Began executing node test.dbt_idx.source_relationships_warehouse_orders_cust_id__customer_id__source_warehouse_customers_.d3f9188fc2
[0m18:33:31.494949 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_idx.source_relationships_warehouse_orders_cust_id__customer_id__source_warehouse_customers_.d3f9188fc2"
[0m18:33:31.501682 [debug] [Thread-1 (]: Using postgres connection "test.dbt_idx.source_relationships_warehouse_orders_cust_id__customer_id__source_warehouse_customers_.d3f9188fc2"
[0m18:33:31.502720 [debug] [Thread-1 (]: On test.dbt_idx.source_relationships_warehouse_orders_cust_id__customer_id__source_warehouse_customers_.d3f9188fc2: BEGIN
[0m18:33:31.503719 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:33:31.526319 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m18:33:31.527331 [debug] [Thread-1 (]: Using postgres connection "test.dbt_idx.source_relationships_warehouse_orders_cust_id__customer_id__source_warehouse_customers_.d3f9188fc2"
[0m18:33:31.528849 [debug] [Thread-1 (]: On test.dbt_idx.source_relationships_warehouse_orders_cust_id__customer_id__source_warehouse_customers_.d3f9188fc2: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "test.dbt_idx.source_relationships_warehouse_orders_cust_id__customer_id__source_warehouse_customers_.d3f9188fc2"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select cust_id as from_field
    from "IDX-Stock"."warehouse"."orders"
    where cust_id is not null
),

parent as (
    select customer_id as to_field
    from "IDX-Stock"."warehouse"."customers"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m18:33:31.532422 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m18:33:31.534452 [debug] [Thread-1 (]: Timing info for test.dbt_idx.source_relationships_warehouse_orders_cust_id__customer_id__source_warehouse_customers_.d3f9188fc2 (execute): 18:33:31.491954 => 18:33:31.534452
[0m18:33:31.535452 [debug] [Thread-1 (]: On test.dbt_idx.source_relationships_warehouse_orders_cust_id__customer_id__source_warehouse_customers_.d3f9188fc2: ROLLBACK
[0m18:33:31.537422 [debug] [Thread-1 (]: On test.dbt_idx.source_relationships_warehouse_orders_cust_id__customer_id__source_warehouse_customers_.d3f9188fc2: Close
[0m18:33:31.540976 [info ] [Thread-1 (]: 7 of 9 PASS source_relationships_warehouse_orders_cust_id__customer_id__source_warehouse_customers_  [[32mPASS[0m in 0.07s]
[0m18:33:31.542983 [debug] [Thread-1 (]: Finished running node test.dbt_idx.source_relationships_warehouse_orders_cust_id__customer_id__source_warehouse_customers_.d3f9188fc2
[0m18:33:31.543971 [debug] [Thread-1 (]: Began running node test.dbt_idx.source_unique_warehouse_orders_order_id.839fb43d0f
[0m18:33:31.545973 [info ] [Thread-1 (]: 8 of 9 START test source_unique_warehouse_orders_order_id ...................... [RUN]
[0m18:33:31.547975 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_idx.source_relationships_warehouse_orders_cust_id__customer_id__source_warehouse_customers_.d3f9188fc2, now test.dbt_idx.source_unique_warehouse_orders_order_id.839fb43d0f)
[0m18:33:31.548978 [debug] [Thread-1 (]: Began compiling node test.dbt_idx.source_unique_warehouse_orders_order_id.839fb43d0f
[0m18:33:31.557625 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_idx.source_unique_warehouse_orders_order_id.839fb43d0f"
[0m18:33:31.564813 [debug] [Thread-1 (]: Timing info for test.dbt_idx.source_unique_warehouse_orders_order_id.839fb43d0f (compile): 18:33:31.550584 => 18:33:31.564813
[0m18:33:31.565813 [debug] [Thread-1 (]: Began executing node test.dbt_idx.source_unique_warehouse_orders_order_id.839fb43d0f
[0m18:33:31.568810 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_idx.source_unique_warehouse_orders_order_id.839fb43d0f"
[0m18:33:31.576258 [debug] [Thread-1 (]: Using postgres connection "test.dbt_idx.source_unique_warehouse_orders_order_id.839fb43d0f"
[0m18:33:31.577298 [debug] [Thread-1 (]: On test.dbt_idx.source_unique_warehouse_orders_order_id.839fb43d0f: BEGIN
[0m18:33:31.577298 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:33:31.602905 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m18:33:31.603904 [debug] [Thread-1 (]: Using postgres connection "test.dbt_idx.source_unique_warehouse_orders_order_id.839fb43d0f"
[0m18:33:31.604908 [debug] [Thread-1 (]: On test.dbt_idx.source_unique_warehouse_orders_order_id.839fb43d0f: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "test.dbt_idx.source_unique_warehouse_orders_order_id.839fb43d0f"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    order_id as unique_field,
    count(*) as n_records

from "IDX-Stock"."warehouse"."orders"
where order_id is not null
group by order_id
having count(*) > 1



      
    ) dbt_internal_test
[0m18:33:31.608903 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m18:33:31.612296 [debug] [Thread-1 (]: Timing info for test.dbt_idx.source_unique_warehouse_orders_order_id.839fb43d0f (execute): 18:33:31.566810 => 18:33:31.611325
[0m18:33:31.613258 [debug] [Thread-1 (]: On test.dbt_idx.source_unique_warehouse_orders_order_id.839fb43d0f: ROLLBACK
[0m18:33:31.615256 [debug] [Thread-1 (]: On test.dbt_idx.source_unique_warehouse_orders_order_id.839fb43d0f: Close
[0m18:33:31.617272 [info ] [Thread-1 (]: 8 of 9 PASS source_unique_warehouse_orders_order_id ............................ [[32mPASS[0m in 0.07s]
[0m18:33:31.619790 [debug] [Thread-1 (]: Finished running node test.dbt_idx.source_unique_warehouse_orders_order_id.839fb43d0f
[0m18:33:31.620790 [debug] [Thread-1 (]: Began running node test.dbt_idx.unique_customer_orders_status_order_id.b7a45e83ee
[0m18:33:31.621788 [info ] [Thread-1 (]: 9 of 9 START test unique_customer_orders_status_order_id ....................... [RUN]
[0m18:33:31.623825 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_idx.source_unique_warehouse_orders_order_id.839fb43d0f, now test.dbt_idx.unique_customer_orders_status_order_id.b7a45e83ee)
[0m18:33:31.623825 [debug] [Thread-1 (]: Began compiling node test.dbt_idx.unique_customer_orders_status_order_id.b7a45e83ee
[0m18:33:31.628826 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_idx.unique_customer_orders_status_order_id.b7a45e83ee"
[0m18:33:31.636380 [debug] [Thread-1 (]: Timing info for test.dbt_idx.unique_customer_orders_status_order_id.b7a45e83ee (compile): 18:33:31.624823 => 18:33:31.635396
[0m18:33:31.637382 [debug] [Thread-1 (]: Began executing node test.dbt_idx.unique_customer_orders_status_order_id.b7a45e83ee
[0m18:33:31.639932 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_idx.unique_customer_orders_status_order_id.b7a45e83ee"
[0m18:33:31.648924 [debug] [Thread-1 (]: Using postgres connection "test.dbt_idx.unique_customer_orders_status_order_id.b7a45e83ee"
[0m18:33:31.650251 [debug] [Thread-1 (]: On test.dbt_idx.unique_customer_orders_status_order_id.b7a45e83ee: BEGIN
[0m18:33:31.651267 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:33:31.677145 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m18:33:31.678146 [debug] [Thread-1 (]: Using postgres connection "test.dbt_idx.unique_customer_orders_status_order_id.b7a45e83ee"
[0m18:33:31.679147 [debug] [Thread-1 (]: On test.dbt_idx.unique_customer_orders_status_order_id.b7a45e83ee: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "test.dbt_idx.unique_customer_orders_status_order_id.b7a45e83ee"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    order_id as unique_field,
    count(*) as n_records

from "IDX-Stock"."warehouse"."customer_orders_status"
where order_id is not null
group by order_id
having count(*) > 1



      
    ) dbt_internal_test
[0m18:33:31.683706 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m18:33:31.685704 [debug] [Thread-1 (]: Timing info for test.dbt_idx.unique_customer_orders_status_order_id.b7a45e83ee (execute): 18:33:31.637382 => 18:33:31.685704
[0m18:33:31.686700 [debug] [Thread-1 (]: On test.dbt_idx.unique_customer_orders_status_order_id.b7a45e83ee: ROLLBACK
[0m18:33:31.689179 [debug] [Thread-1 (]: On test.dbt_idx.unique_customer_orders_status_order_id.b7a45e83ee: Close
[0m18:33:31.692190 [info ] [Thread-1 (]: 9 of 9 PASS unique_customer_orders_status_order_id ............................. [[32mPASS[0m in 0.07s]
[0m18:33:31.694186 [debug] [Thread-1 (]: Finished running node test.dbt_idx.unique_customer_orders_status_order_id.b7a45e83ee
[0m18:33:31.697185 [debug] [MainThread]: Using postgres connection "master"
[0m18:33:31.697185 [debug] [MainThread]: On master: BEGIN
[0m18:33:31.698744 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:33:31.727750 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m18:33:31.728764 [debug] [MainThread]: On master: COMMIT
[0m18:33:31.729270 [debug] [MainThread]: Using postgres connection "master"
[0m18:33:31.730276 [debug] [MainThread]: On master: COMMIT
[0m18:33:31.733283 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m18:33:31.734283 [debug] [MainThread]: On master: Close
[0m18:33:31.736286 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:33:31.737288 [debug] [MainThread]: Connection 'list_IDX-Stock_snapshots' was properly closed.
[0m18:33:31.738795 [debug] [MainThread]: Connection 'test.dbt_idx.unique_customer_orders_status_order_id.b7a45e83ee' was properly closed.
[0m18:33:31.739803 [info ] [MainThread]: 
[0m18:33:31.740802 [info ] [MainThread]: Finished running 9 tests in 0 hours 0 minutes and 0.93 seconds (0.93s).
[0m18:33:31.743807 [debug] [MainThread]: Command end result
[0m18:33:31.764898 [info ] [MainThread]: 
[0m18:33:31.766876 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m18:33:31.767857 [info ] [MainThread]: 
[0m18:33:31.768889 [error] [MainThread]: [33mDatabase Error in test assert_customer_dimension_has_no_row_loss.sql (tests\assert_customer_dimension_has_no_row_loss.sql.sql)[0m
[0m18:33:31.771242 [error] [MainThread]:   column stg_cust.customer_id does not exist
[0m18:33:31.773263 [error] [MainThread]:   LINE 14:          on stg_cust.customer_id = dim_cust.customer_id
[0m18:33:31.774256 [error] [MainThread]:                        ^
[0m18:33:31.775241 [error] [MainThread]:   HINT:  Perhaps you meant to reference the column "dim_cust.customer_id".
[0m18:33:31.776241 [error] [MainThread]:   compiled Code at target\run\dbt_idx\tests\assert_customer_dimension_has_no_row_loss.sql.sql
[0m18:33:31.777240 [info ] [MainThread]: 
[0m18:33:31.778809 [info ] [MainThread]: Done. PASS=8 WARN=0 ERROR=1 SKIP=0 TOTAL=9
[0m18:33:31.779756 [debug] [MainThread]: Command `dbt test` failed at 18:33:31.779756 after 1.39 seconds
[0m18:33:31.780760 [debug] [MainThread]: Flushing usage events


============================== 18:34:28.435726 | e00a6d94-8be6-43e7-897a-ca04684ef5db ==============================
[0m18:34:28.435726 [info ] [MainThread]: Running with dbt=1.6.1
[0m18:34:28.442822 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'D:\\00 Project\\00 My Project\\IdeaProjects\\Py-DBT-IDX', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'D:\\00 Project\\00 My Project\\IdeaProjects\\Py-DBT-IDX\\logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'False'}
[0m18:34:28.668599 [info ] [MainThread]: Registered adapter: postgres=1.6.1
[0m18:34:28.708772 [debug] [MainThread]: checksum: efe19d9f5b93d1a98cc804fbfcdb6b3aced98b974af664946fee1cde8837deb7, vars: {}, profile: , target: , version: 1.6.1
[0m18:34:28.972938 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m18:34:28.974934 [debug] [MainThread]: Partial parsing: updated file: dbt_idx://models\staging\stg_eltool__customers.sql
[0m18:34:29.103229 [info ] [MainThread]: Found 1 snapshot, 9 tests, 7 models, 3 sources, 0 exposures, 0 metrics, 349 macros, 0 groups, 0 semantic models
[0m18:34:29.107261 [info ] [MainThread]: 
[0m18:34:29.109821 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m18:34:29.114342 [debug] [ThreadPool]: Acquiring new postgres connection 'list_IDX-Stock'
[0m18:34:29.138919 [debug] [ThreadPool]: Using postgres connection "list_IDX-Stock"
[0m18:34:29.139930 [debug] [ThreadPool]: On list_IDX-Stock: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "connection_name": "list_IDX-Stock"} */

    select distinct nspname from pg_namespace
  
[0m18:34:29.142351 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:34:29.186843 [debug] [ThreadPool]: SQL status: SELECT 13 in 0.0 seconds
[0m18:34:29.188845 [debug] [ThreadPool]: On list_IDX-Stock: Close
[0m18:34:29.193128 [debug] [ThreadPool]: Acquiring new postgres connection 'list_IDX-Stock_warehouse'
[0m18:34:29.202282 [debug] [ThreadPool]: Using postgres connection "list_IDX-Stock_warehouse"
[0m18:34:29.202282 [debug] [ThreadPool]: On list_IDX-Stock_warehouse: BEGIN
[0m18:34:29.203306 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:34:29.224520 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m18:34:29.225549 [debug] [ThreadPool]: Using postgres connection "list_IDX-Stock_warehouse"
[0m18:34:29.226548 [debug] [ThreadPool]: On list_IDX-Stock_warehouse: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "connection_name": "list_IDX-Stock_warehouse"} */
select
      'IDX-Stock' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'warehouse'
    union all
    select
      'IDX-Stock' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'warehouse'
    union all
    select
      'IDX-Stock' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'warehouse'
  
[0m18:34:29.232113 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.0 seconds
[0m18:34:29.234087 [debug] [ThreadPool]: On list_IDX-Stock_warehouse: ROLLBACK
[0m18:34:29.236081 [debug] [ThreadPool]: On list_IDX-Stock_warehouse: Close
[0m18:34:29.239109 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_IDX-Stock_warehouse, now list_IDX-Stock_snapshots)
[0m18:34:29.245129 [debug] [ThreadPool]: Using postgres connection "list_IDX-Stock_snapshots"
[0m18:34:29.246128 [debug] [ThreadPool]: On list_IDX-Stock_snapshots: BEGIN
[0m18:34:29.247129 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:34:29.269929 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m18:34:29.270926 [debug] [ThreadPool]: Using postgres connection "list_IDX-Stock_snapshots"
[0m18:34:29.270926 [debug] [ThreadPool]: On list_IDX-Stock_snapshots: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "connection_name": "list_IDX-Stock_snapshots"} */
select
      'IDX-Stock' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'snapshots'
    union all
    select
      'IDX-Stock' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'snapshots'
    union all
    select
      'IDX-Stock' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'snapshots'
  
[0m18:34:29.275982 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.0 seconds
[0m18:34:29.276933 [debug] [ThreadPool]: On list_IDX-Stock_snapshots: ROLLBACK
[0m18:34:29.280466 [debug] [ThreadPool]: On list_IDX-Stock_snapshots: Close
[0m18:34:29.287485 [debug] [MainThread]: Using postgres connection "master"
[0m18:34:29.288487 [debug] [MainThread]: On master: BEGIN
[0m18:34:29.289897 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:34:29.313112 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m18:34:29.314793 [debug] [MainThread]: Using postgres connection "master"
[0m18:34:29.315367 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m18:34:29.325898 [debug] [MainThread]: SQL status: SELECT 6 in 0.0 seconds
[0m18:34:29.332934 [debug] [MainThread]: On master: ROLLBACK
[0m18:34:29.335939 [debug] [MainThread]: Using postgres connection "master"
[0m18:34:29.336934 [debug] [MainThread]: On master: BEGIN
[0m18:34:29.342448 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m18:34:29.342448 [debug] [MainThread]: On master: COMMIT
[0m18:34:29.343959 [debug] [MainThread]: Using postgres connection "master"
[0m18:34:29.344984 [debug] [MainThread]: On master: COMMIT
[0m18:34:29.346994 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m18:34:29.348500 [debug] [MainThread]: On master: Close
[0m18:34:29.350513 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:34:29.352511 [info ] [MainThread]: 
[0m18:34:29.358558 [debug] [Thread-1 (]: Began running node model.dbt_idx.stg_eltool__customers
[0m18:34:29.360113 [info ] [Thread-1 (]: 1 of 7 START sql view model warehouse.stg_eltool__customers .................... [RUN]
[0m18:34:29.361084 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.dbt_idx.stg_eltool__customers'
[0m18:34:29.362116 [debug] [Thread-1 (]: Began compiling node model.dbt_idx.stg_eltool__customers
[0m18:34:29.370949 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_idx.stg_eltool__customers"
[0m18:34:29.380445 [debug] [Thread-1 (]: Timing info for model.dbt_idx.stg_eltool__customers (compile): 18:34:29.363139 => 18:34:29.379458
[0m18:34:29.380445 [debug] [Thread-1 (]: Began executing node model.dbt_idx.stg_eltool__customers
[0m18:34:29.421417 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_idx.stg_eltool__customers"
[0m18:34:29.428569 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__customers"
[0m18:34:29.429522 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__customers: BEGIN
[0m18:34:29.430597 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m18:34:29.457824 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m18:34:29.458841 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__customers"
[0m18:34:29.459393 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__customers: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__customers"} */

  create view "IDX-Stock"."warehouse"."stg_eltool__customers__dbt_tmp"
    
    
  as (
    with source as (select *
                from "IDX-Stock"."warehouse"."customers"),
     renamed as (select
                     customer_id,
                    'This is Dummy' as dummy
                 from source
                 where customer_id = 'dummy')
select *
from renamed
  );
[0m18:34:29.463442 [debug] [Thread-1 (]: Postgres adapter: Postgres error: invalid input syntax for type integer: "dummy"
LINE 13:                  where customer_id = 'dummy')
                                              ^

[0m18:34:29.464436 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__customers: ROLLBACK
[0m18:34:29.466985 [debug] [Thread-1 (]: Timing info for model.dbt_idx.stg_eltool__customers (execute): 18:34:29.381966 => 18:34:29.466985
[0m18:34:29.466985 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__customers: Close
[0m18:34:29.484466 [debug] [Thread-1 (]: Database Error in model stg_eltool__customers (models\staging\stg_eltool__customers.sql)
  invalid input syntax for type integer: "dummy"
  LINE 13:                  where customer_id = 'dummy')
                                                ^
  compiled Code at target\run\dbt_idx\models\staging\stg_eltool__customers.sql
[0m18:34:29.485467 [error] [Thread-1 (]: 1 of 7 ERROR creating sql view model warehouse.stg_eltool__customers ........... [[31mERROR[0m in 0.12s]
[0m18:34:29.487468 [debug] [Thread-1 (]: Finished running node model.dbt_idx.stg_eltool__customers
[0m18:34:29.488477 [debug] [Thread-1 (]: Began running node model.dbt_idx.stg_eltool__customers_snapshots
[0m18:34:29.488989 [info ] [Thread-1 (]: 2 of 7 START sql view model warehouse.stg_eltool__customers_snapshots .......... [RUN]
[0m18:34:29.491002 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_idx.stg_eltool__customers, now model.dbt_idx.stg_eltool__customers_snapshots)
[0m18:34:29.492018 [debug] [Thread-1 (]: Began compiling node model.dbt_idx.stg_eltool__customers_snapshots
[0m18:34:29.498562 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_idx.stg_eltool__customers_snapshots"
[0m18:34:29.507538 [debug] [Thread-1 (]: Timing info for model.dbt_idx.stg_eltool__customers_snapshots (compile): 18:34:29.492997 => 18:34:29.507538
[0m18:34:29.508602 [debug] [Thread-1 (]: Began executing node model.dbt_idx.stg_eltool__customers_snapshots
[0m18:34:29.517720 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_idx.stg_eltool__customers_snapshots"
[0m18:34:29.525335 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__customers_snapshots"
[0m18:34:29.527333 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__customers_snapshots: BEGIN
[0m18:34:29.527333 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:34:29.551790 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m18:34:29.552843 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__customers_snapshots"
[0m18:34:29.553822 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__customers_snapshots: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__customers_snapshots"} */

  create view "IDX-Stock"."warehouse"."stg_eltool__customers_snapshots__dbt_tmp"
    
    
  as (
    with source as (select *
                from "IDX-Stock"."snapshots"."customers_snapshot"),
     renamed as (select customer_id,
                        zipcode,
                        city,
                        state_code,
                        datetime_created::TIMESTAMP AS datetime_created,
                        datetime_updated::TIMESTAMP AS datetime_updated,
                        dbt_valid_from,
                        dbt_valid_to
                 from source)
select *
from renamed
  );
[0m18:34:29.560596 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m18:34:29.580106 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__customers_snapshots"
[0m18:34:29.581834 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__customers_snapshots: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__customers_snapshots"} */
alter table "IDX-Stock"."warehouse"."stg_eltool__customers_snapshots" rename to "stg_eltool__customers_snapshots__dbt_backup"
[0m18:34:29.586001 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:34:29.591853 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__customers_snapshots"
[0m18:34:29.592870 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__customers_snapshots: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__customers_snapshots"} */
alter table "IDX-Stock"."warehouse"."stg_eltool__customers_snapshots__dbt_tmp" rename to "stg_eltool__customers_snapshots"
[0m18:34:29.595864 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:34:29.615045 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__customers_snapshots: COMMIT
[0m18:34:29.616031 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__customers_snapshots"
[0m18:34:29.617010 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__customers_snapshots: COMMIT
[0m18:34:29.620581 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m18:34:29.631162 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__customers_snapshots"
[0m18:34:29.632161 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__customers_snapshots: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__customers_snapshots"} */
drop view if exists "IDX-Stock"."warehouse"."stg_eltool__customers_snapshots__dbt_backup" cascade
[0m18:34:29.637170 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m18:34:29.640697 [debug] [Thread-1 (]: Timing info for model.dbt_idx.stg_eltool__customers_snapshots (execute): 18:34:29.509144 => 18:34:29.640697
[0m18:34:29.642227 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__customers_snapshots: Close
[0m18:34:29.645239 [info ] [Thread-1 (]: 2 of 7 OK created sql view model warehouse.stg_eltool__customers_snapshots ..... [[32mCREATE VIEW[0m in 0.15s]
[0m18:34:29.647242 [debug] [Thread-1 (]: Finished running node model.dbt_idx.stg_eltool__customers_snapshots
[0m18:34:29.648832 [debug] [Thread-1 (]: Began running node model.dbt_idx.stg_eltool__orders
[0m18:34:29.649759 [info ] [Thread-1 (]: 3 of 7 START sql view model warehouse.stg_eltool__orders ....................... [RUN]
[0m18:34:29.650730 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_idx.stg_eltool__customers_snapshots, now model.dbt_idx.stg_eltool__orders)
[0m18:34:29.651782 [debug] [Thread-1 (]: Began compiling node model.dbt_idx.stg_eltool__orders
[0m18:34:29.654780 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_idx.stg_eltool__orders"
[0m18:34:29.666330 [debug] [Thread-1 (]: Timing info for model.dbt_idx.stg_eltool__orders (compile): 18:34:29.652755 => 18:34:29.666330
[0m18:34:29.667332 [debug] [Thread-1 (]: Began executing node model.dbt_idx.stg_eltool__orders
[0m18:34:29.676887 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_idx.stg_eltool__orders"
[0m18:34:29.692156 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__orders"
[0m18:34:29.694185 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__orders: BEGIN
[0m18:34:29.695164 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:34:29.725599 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m18:34:29.727166 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__orders"
[0m18:34:29.729342 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__orders: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__orders"} */

  create view "IDX-Stock"."warehouse"."stg_eltool__orders__dbt_tmp"
    
    
  as (
    with source as (select *
                from "IDX-Stock"."warehouse"."orders"),
     renamed as (select order_id,
                        cust_id AS customer_id,
                        order_status,
                        order_purchase_timestamp::TIMESTAMP,
                        order_approved_at::TIMESTAMP,
                        order_delivered_carrier_date::TIMESTAMP,
                        order_delivered_customer_date::TIMESTAMP,
                        order_estimated_delivery_date::TIMESTAMP
                 from source)
select *
from renamed
  );
[0m18:34:29.736580 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m18:34:29.744685 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__orders"
[0m18:34:29.745284 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__orders: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__orders"} */
alter table "IDX-Stock"."warehouse"."stg_eltool__orders" rename to "stg_eltool__orders__dbt_backup"
[0m18:34:29.747559 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:34:29.752773 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__orders"
[0m18:34:29.753452 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__orders: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__orders"} */
alter table "IDX-Stock"."warehouse"."stg_eltool__orders__dbt_tmp" rename to "stg_eltool__orders"
[0m18:34:29.755974 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:34:29.758658 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__orders: COMMIT
[0m18:34:29.760549 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__orders"
[0m18:34:29.761561 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__orders: COMMIT
[0m18:34:29.765545 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m18:34:29.768584 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__orders"
[0m18:34:29.769127 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__orders: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__orders"} */
drop view if exists "IDX-Stock"."warehouse"."stg_eltool__orders__dbt_backup" cascade
[0m18:34:29.774468 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m18:34:29.776482 [debug] [Thread-1 (]: Timing info for model.dbt_idx.stg_eltool__orders (execute): 18:34:29.667332 => 18:34:29.776482
[0m18:34:29.777465 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__orders: Close
[0m18:34:29.778975 [info ] [Thread-1 (]: 3 of 7 OK created sql view model warehouse.stg_eltool__orders .................. [[32mCREATE VIEW[0m in 0.13s]
[0m18:34:29.781989 [debug] [Thread-1 (]: Finished running node model.dbt_idx.stg_eltool__orders
[0m18:34:29.782998 [debug] [Thread-1 (]: Began running node model.dbt_idx.stg_eltool__state
[0m18:34:29.784985 [info ] [Thread-1 (]: 4 of 7 START sql view model warehouse.stg_eltool__state ........................ [RUN]
[0m18:34:29.786983 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_idx.stg_eltool__orders, now model.dbt_idx.stg_eltool__state)
[0m18:34:29.786983 [debug] [Thread-1 (]: Began compiling node model.dbt_idx.stg_eltool__state
[0m18:34:29.790496 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_idx.stg_eltool__state"
[0m18:34:29.797510 [debug] [Thread-1 (]: Timing info for model.dbt_idx.stg_eltool__state (compile): 18:34:29.786983 => 18:34:29.797510
[0m18:34:29.798536 [debug] [Thread-1 (]: Began executing node model.dbt_idx.stg_eltool__state
[0m18:34:29.804674 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_idx.stg_eltool__state"
[0m18:34:29.813916 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__state"
[0m18:34:29.815022 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__state: BEGIN
[0m18:34:29.816019 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:34:29.845832 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m18:34:29.846831 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__state"
[0m18:34:29.847831 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__state: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__state"} */

  create view "IDX-Stock"."warehouse"."stg_eltool__state__dbt_tmp"
    
    
  as (
    with source as (select *
                from "IDX-Stock"."warehouse"."state"),
     renamed as (select state_identifier::INT AS state_id,
                         state_code::VARCHAR(2) AS state_code,
                         st_name::VARCHAR(30) AS state_name
                 from source)
select *
from renamed
  );
[0m18:34:29.851909 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m18:34:29.855940 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__state"
[0m18:34:29.856909 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__state: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__state"} */
alter table "IDX-Stock"."warehouse"."stg_eltool__state" rename to "stg_eltool__state__dbt_backup"
[0m18:34:29.860009 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:34:29.865046 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__state"
[0m18:34:29.866026 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__state: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__state"} */
alter table "IDX-Stock"."warehouse"."stg_eltool__state__dbt_tmp" rename to "stg_eltool__state"
[0m18:34:29.868938 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:34:29.871985 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__state: COMMIT
[0m18:34:29.872973 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__state"
[0m18:34:29.874990 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__state: COMMIT
[0m18:34:29.876950 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m18:34:29.881488 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__state"
[0m18:34:29.882491 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__state: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__state"} */
drop view if exists "IDX-Stock"."warehouse"."stg_eltool__state__dbt_backup" cascade
[0m18:34:29.885857 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m18:34:29.887890 [debug] [Thread-1 (]: Timing info for model.dbt_idx.stg_eltool__state (execute): 18:34:29.799666 => 18:34:29.887890
[0m18:34:29.888901 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__state: Close
[0m18:34:29.891457 [info ] [Thread-1 (]: 4 of 7 OK created sql view model warehouse.stg_eltool__state ................... [[32mCREATE VIEW[0m in 0.10s]
[0m18:34:29.893453 [debug] [Thread-1 (]: Finished running node model.dbt_idx.stg_eltool__state
[0m18:34:29.895454 [debug] [Thread-1 (]: Began running node model.dbt_idx.fact_orders
[0m18:34:29.896453 [info ] [Thread-1 (]: 5 of 7 START sql table model warehouse.fact_orders ............................. [RUN]
[0m18:34:29.898453 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_idx.stg_eltool__state, now model.dbt_idx.fact_orders)
[0m18:34:29.898986 [debug] [Thread-1 (]: Began compiling node model.dbt_idx.fact_orders
[0m18:34:29.901997 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_idx.fact_orders"
[0m18:34:29.909537 [debug] [Thread-1 (]: Timing info for model.dbt_idx.fact_orders (compile): 18:34:29.899998 => 18:34:29.908526
[0m18:34:29.910537 [debug] [Thread-1 (]: Began executing node model.dbt_idx.fact_orders
[0m18:34:29.939690 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_idx.fact_orders"
[0m18:34:29.947203 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.fact_orders"
[0m18:34:29.947203 [debug] [Thread-1 (]: On model.dbt_idx.fact_orders: BEGIN
[0m18:34:29.948802 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:34:29.970809 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m18:34:29.971826 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.fact_orders"
[0m18:34:29.972805 [debug] [Thread-1 (]: On model.dbt_idx.fact_orders: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.fact_orders"} */

  
    

  create  table "IDX-Stock"."warehouse"."fact_orders__dbt_tmp"
  
  
    as
  
  (
    with orders as (
    select *
    from "IDX-Stock"."warehouse"."stg_eltool__orders"
)
select * from orders
  );
  
[0m18:34:29.979335 [debug] [Thread-1 (]: SQL status: SELECT 999 in 0.0 seconds
[0m18:34:29.984378 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.fact_orders"
[0m18:34:29.985348 [debug] [Thread-1 (]: On model.dbt_idx.fact_orders: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.fact_orders"} */
alter table "IDX-Stock"."warehouse"."fact_orders" rename to "fact_orders__dbt_backup"
[0m18:34:29.987362 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:34:29.991910 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.fact_orders"
[0m18:34:29.991910 [debug] [Thread-1 (]: On model.dbt_idx.fact_orders: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.fact_orders"} */
alter table "IDX-Stock"."warehouse"."fact_orders__dbt_tmp" rename to "fact_orders"
[0m18:34:29.994877 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:34:30.000377 [debug] [Thread-1 (]: On model.dbt_idx.fact_orders: COMMIT
[0m18:34:30.001409 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.fact_orders"
[0m18:34:30.002419 [debug] [Thread-1 (]: On model.dbt_idx.fact_orders: COMMIT
[0m18:34:30.006372 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m18:34:30.011981 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.fact_orders"
[0m18:34:30.012945 [debug] [Thread-1 (]: On model.dbt_idx.fact_orders: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.fact_orders"} */
drop table if exists "IDX-Stock"."warehouse"."fact_orders__dbt_backup" cascade
[0m18:34:30.017764 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m18:34:30.020240 [debug] [Thread-1 (]: Timing info for model.dbt_idx.fact_orders (execute): 18:34:29.911562 => 18:34:30.020240
[0m18:34:30.021242 [debug] [Thread-1 (]: On model.dbt_idx.fact_orders: Close
[0m18:34:30.023243 [info ] [Thread-1 (]: 5 of 7 OK created sql table model warehouse.fact_orders ........................ [[32mSELECT 999[0m in 0.13s]
[0m18:34:30.025249 [debug] [Thread-1 (]: Finished running node model.dbt_idx.fact_orders
[0m18:34:30.026262 [debug] [Thread-1 (]: Began running node model.dbt_idx.dim_customers
[0m18:34:30.027267 [info ] [Thread-1 (]: 6 of 7 START sql table model warehouse.dim_customers ........................... [RUN]
[0m18:34:30.028774 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_idx.fact_orders, now model.dbt_idx.dim_customers)
[0m18:34:30.029792 [debug] [Thread-1 (]: Began compiling node model.dbt_idx.dim_customers
[0m18:34:30.033781 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_idx.dim_customers"
[0m18:34:30.040936 [debug] [Thread-1 (]: Timing info for model.dbt_idx.dim_customers (compile): 18:34:30.030782 => 18:34:30.040936
[0m18:34:30.041952 [debug] [Thread-1 (]: Began executing node model.dbt_idx.dim_customers
[0m18:34:30.046971 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_idx.dim_customers"
[0m18:34:30.054530 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.dim_customers"
[0m18:34:30.055524 [debug] [Thread-1 (]: On model.dbt_idx.dim_customers: BEGIN
[0m18:34:30.055524 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:34:30.078594 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m18:34:30.080115 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.dim_customers"
[0m18:34:30.081124 [debug] [Thread-1 (]: On model.dbt_idx.dim_customers: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.dim_customers"} */

  
    

  create  table "IDX-Stock"."warehouse"."dim_customers__dbt_tmp"
  
  
    as
  
  (
    -- noinspection SqlDialectInspectionForFile

with customers as (
    select *
    from "IDX-Stock"."warehouse"."stg_eltool__customers_snapshots"
    ),
     state as (
         select *
         from "IDX-Stock"."warehouse"."stg_eltool__state"
     )
select c.customer_id,
       c.zipcode,
       c.city,
       c.state_code,
       s.state_name,
       c.datetime_created,
       c.datetime_updated,
       c.dbt_valid_from::TIMESTAMP as valid_from,
        CASE WHEN c.dbt_valid_to IS NULL
            THEN '9999-12-31'::TIMESTAMP
            ELSE c.dbt_valid_to::TIMESTAMP
        END as valid_to
from customers c
    join state s on c.state_code = s.state_code
  );
  
[0m18:34:30.087163 [debug] [Thread-1 (]: SQL status: SELECT 105 in 0.0 seconds
[0m18:34:30.092683 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.dim_customers"
[0m18:34:30.093678 [debug] [Thread-1 (]: On model.dbt_idx.dim_customers: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.dim_customers"} */
alter table "IDX-Stock"."warehouse"."dim_customers" rename to "dim_customers__dbt_backup"
[0m18:34:30.096679 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:34:30.102264 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.dim_customers"
[0m18:34:30.103300 [debug] [Thread-1 (]: On model.dbt_idx.dim_customers: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.dim_customers"} */
alter table "IDX-Stock"."warehouse"."dim_customers__dbt_tmp" rename to "dim_customers"
[0m18:34:30.106288 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:34:30.109810 [debug] [Thread-1 (]: On model.dbt_idx.dim_customers: COMMIT
[0m18:34:30.110778 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.dim_customers"
[0m18:34:30.111783 [debug] [Thread-1 (]: On model.dbt_idx.dim_customers: COMMIT
[0m18:34:30.116399 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m18:34:30.119931 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.dim_customers"
[0m18:34:30.121937 [debug] [Thread-1 (]: On model.dbt_idx.dim_customers: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.dim_customers"} */
drop table if exists "IDX-Stock"."warehouse"."dim_customers__dbt_backup" cascade
[0m18:34:30.126932 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m18:34:30.129445 [debug] [Thread-1 (]: Timing info for model.dbt_idx.dim_customers (execute): 18:34:30.041952 => 18:34:30.129445
[0m18:34:30.130478 [debug] [Thread-1 (]: On model.dbt_idx.dim_customers: Close
[0m18:34:30.132459 [info ] [Thread-1 (]: 6 of 7 OK created sql table model warehouse.dim_customers ...................... [[32mSELECT 105[0m in 0.11s]
[0m18:34:30.135489 [debug] [Thread-1 (]: Finished running node model.dbt_idx.dim_customers
[0m18:34:30.136460 [debug] [Thread-1 (]: Began running node model.dbt_idx.customer_orders_status
[0m18:34:30.138981 [info ] [Thread-1 (]: 7 of 7 START sql view model warehouse.customer_orders_status ................... [RUN]
[0m18:34:30.142523 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_idx.dim_customers, now model.dbt_idx.customer_orders_status)
[0m18:34:30.143549 [debug] [Thread-1 (]: Began compiling node model.dbt_idx.customer_orders_status
[0m18:34:30.151671 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_idx.customer_orders_status"
[0m18:34:30.160222 [debug] [Thread-1 (]: Timing info for model.dbt_idx.customer_orders_status (compile): 18:34:30.145538 => 18:34:30.160222
[0m18:34:30.161202 [debug] [Thread-1 (]: Began executing node model.dbt_idx.customer_orders_status
[0m18:34:30.167188 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_idx.customer_orders_status"
[0m18:34:30.174707 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.customer_orders_status"
[0m18:34:30.175708 [debug] [Thread-1 (]: On model.dbt_idx.customer_orders_status: BEGIN
[0m18:34:30.176711 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:34:30.202342 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m18:34:30.203371 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.customer_orders_status"
[0m18:34:30.204376 [debug] [Thread-1 (]: On model.dbt_idx.customer_orders_status: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.customer_orders_status"} */

  create view "IDX-Stock"."warehouse"."customer_orders_status__dbt_tmp"
    
    
  as (
    with orders as (select *
                from "IDX-Stock"."warehouse"."fact_orders"),
     customers as (select *
                   from "IDX-Stock"."warehouse"."dim_customers")
select o.order_id,
       o.customer_id,
       o.order_status,
       o.order_purchase_timestamp,
       o.order_approved_at,
       o.order_delivered_carrier_date,
       o.order_delivered_customer_date,
       o.order_estimated_delivery_date,
       c.zipcode    as customer_zipcode,
       c.city       as customer_city,
       c.state_code as customer_state_code,
       c.state_name as customer_state_name
from orders o
    join customers c on o.customer_id = c.customer_id
    and o.order_purchase_timestamp >= c.valid_from
    and o.order_purchase_timestamp <= c.valid_to
  );
[0m18:34:30.208940 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m18:34:30.212910 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.customer_orders_status"
[0m18:34:30.214429 [debug] [Thread-1 (]: On model.dbt_idx.customer_orders_status: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.customer_orders_status"} */
alter table "IDX-Stock"."warehouse"."customer_orders_status__dbt_tmp" rename to "customer_orders_status"
[0m18:34:30.216458 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:34:30.219018 [debug] [Thread-1 (]: On model.dbt_idx.customer_orders_status: COMMIT
[0m18:34:30.220032 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.customer_orders_status"
[0m18:34:30.221061 [debug] [Thread-1 (]: On model.dbt_idx.customer_orders_status: COMMIT
[0m18:34:30.224414 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m18:34:30.227427 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.customer_orders_status"
[0m18:34:30.229034 [debug] [Thread-1 (]: On model.dbt_idx.customer_orders_status: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.customer_orders_status"} */
drop view if exists "IDX-Stock"."warehouse"."customer_orders_status__dbt_backup" cascade
[0m18:34:30.231990 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m18:34:30.234993 [debug] [Thread-1 (]: Timing info for model.dbt_idx.customer_orders_status (execute): 18:34:30.162194 => 18:34:30.233980
[0m18:34:30.235981 [debug] [Thread-1 (]: On model.dbt_idx.customer_orders_status: Close
[0m18:34:30.236979 [info ] [Thread-1 (]: 7 of 7 OK created sql view model warehouse.customer_orders_status .............. [[32mCREATE VIEW[0m in 0.10s]
[0m18:34:30.240519 [debug] [Thread-1 (]: Finished running node model.dbt_idx.customer_orders_status
[0m18:34:30.243503 [debug] [MainThread]: Using postgres connection "master"
[0m18:34:30.243503 [debug] [MainThread]: On master: BEGIN
[0m18:34:30.244502 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:34:30.267753 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m18:34:30.269233 [debug] [MainThread]: On master: COMMIT
[0m18:34:30.270280 [debug] [MainThread]: Using postgres connection "master"
[0m18:34:30.270280 [debug] [MainThread]: On master: COMMIT
[0m18:34:30.273258 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m18:34:30.274257 [debug] [MainThread]: On master: Close
[0m18:34:30.275262 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:34:30.277261 [debug] [MainThread]: Connection 'list_IDX-Stock' was properly closed.
[0m18:34:30.277261 [debug] [MainThread]: Connection 'list_IDX-Stock_snapshots' was properly closed.
[0m18:34:30.278873 [debug] [MainThread]: Connection 'model.dbt_idx.customer_orders_status' was properly closed.
[0m18:34:30.280780 [info ] [MainThread]: 
[0m18:34:30.281345 [info ] [MainThread]: Finished running 5 view models, 2 table models in 0 hours 0 minutes and 1.17 seconds (1.17s).
[0m18:34:30.284356 [debug] [MainThread]: Command end result
[0m18:34:30.306605 [info ] [MainThread]: 
[0m18:34:30.308573 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m18:34:30.309997 [info ] [MainThread]: 
[0m18:34:30.311000 [error] [MainThread]: [33mDatabase Error in model stg_eltool__customers (models\staging\stg_eltool__customers.sql)[0m
[0m18:34:30.311994 [error] [MainThread]:   invalid input syntax for type integer: "dummy"
[0m18:34:30.312984 [error] [MainThread]:   LINE 13:                  where customer_id = 'dummy')
[0m18:34:30.314497 [error] [MainThread]:                                                 ^
[0m18:34:30.314497 [error] [MainThread]:   compiled Code at target\run\dbt_idx\models\staging\stg_eltool__customers.sql
[0m18:34:30.317052 [info ] [MainThread]: 
[0m18:34:30.317052 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=1 SKIP=0 TOTAL=7
[0m18:34:30.319584 [debug] [MainThread]: Command `dbt run` failed at 18:34:30.318564 after 1.92 seconds
[0m18:34:30.320108 [debug] [MainThread]: Flushing usage events


============================== 18:35:02.999893 | a1a0c423-78f5-41b5-8074-071948cb5248 ==============================
[0m18:35:02.999893 [info ] [MainThread]: Running with dbt=1.6.1
[0m18:35:03.004344 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': 'D:\\00 Project\\00 My Project\\IdeaProjects\\Py-DBT-IDX', 'log_path': 'D:\\00 Project\\00 My Project\\IdeaProjects\\Py-DBT-IDX\\logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'False'}
[0m18:35:03.151616 [info ] [MainThread]: Registered adapter: postgres=1.6.1
[0m18:35:03.164629 [debug] [MainThread]: checksum: efe19d9f5b93d1a98cc804fbfcdb6b3aced98b974af664946fee1cde8837deb7, vars: {}, profile: , target: , version: 1.6.1
[0m18:35:03.328614 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m18:35:03.330772 [debug] [MainThread]: Partial parsing: updated file: dbt_idx://models\staging\stg_eltool__customers.sql
[0m18:35:03.419087 [info ] [MainThread]: Found 1 snapshot, 9 tests, 7 models, 3 sources, 0 exposures, 0 metrics, 349 macros, 0 groups, 0 semantic models
[0m18:35:03.422131 [info ] [MainThread]: 
[0m18:35:03.423094 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m18:35:03.427131 [debug] [ThreadPool]: Acquiring new postgres connection 'list_IDX-Stock'
[0m18:35:03.437704 [debug] [ThreadPool]: Using postgres connection "list_IDX-Stock"
[0m18:35:03.438722 [debug] [ThreadPool]: On list_IDX-Stock: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "connection_name": "list_IDX-Stock"} */

    select distinct nspname from pg_namespace
  
[0m18:35:03.439946 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:35:03.473916 [debug] [ThreadPool]: SQL status: SELECT 13 in 0.0 seconds
[0m18:35:03.476913 [debug] [ThreadPool]: On list_IDX-Stock: Close
[0m18:35:03.480444 [debug] [ThreadPool]: Acquiring new postgres connection 'list_IDX-Stock_warehouse'
[0m18:35:03.487468 [debug] [ThreadPool]: Using postgres connection "list_IDX-Stock_warehouse"
[0m18:35:03.487468 [debug] [ThreadPool]: On list_IDX-Stock_warehouse: BEGIN
[0m18:35:03.488997 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:35:03.509715 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m18:35:03.510729 [debug] [ThreadPool]: Using postgres connection "list_IDX-Stock_warehouse"
[0m18:35:03.511720 [debug] [ThreadPool]: On list_IDX-Stock_warehouse: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "connection_name": "list_IDX-Stock_warehouse"} */
select
      'IDX-Stock' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'warehouse'
    union all
    select
      'IDX-Stock' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'warehouse'
    union all
    select
      'IDX-Stock' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'warehouse'
  
[0m18:35:03.516302 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.0 seconds
[0m18:35:03.517314 [debug] [ThreadPool]: On list_IDX-Stock_warehouse: ROLLBACK
[0m18:35:03.520838 [debug] [ThreadPool]: On list_IDX-Stock_warehouse: Close
[0m18:35:03.522839 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_IDX-Stock_warehouse, now list_IDX-Stock_snapshots)
[0m18:35:03.527838 [debug] [ThreadPool]: Using postgres connection "list_IDX-Stock_snapshots"
[0m18:35:03.529369 [debug] [ThreadPool]: On list_IDX-Stock_snapshots: BEGIN
[0m18:35:03.529369 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:35:03.550837 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m18:35:03.551837 [debug] [ThreadPool]: Using postgres connection "list_IDX-Stock_snapshots"
[0m18:35:03.551837 [debug] [ThreadPool]: On list_IDX-Stock_snapshots: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "connection_name": "list_IDX-Stock_snapshots"} */
select
      'IDX-Stock' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'snapshots'
    union all
    select
      'IDX-Stock' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'snapshots'
    union all
    select
      'IDX-Stock' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'snapshots'
  
[0m18:35:03.556848 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.0 seconds
[0m18:35:03.558446 [debug] [ThreadPool]: On list_IDX-Stock_snapshots: ROLLBACK
[0m18:35:03.560362 [debug] [ThreadPool]: On list_IDX-Stock_snapshots: Close
[0m18:35:03.568363 [debug] [MainThread]: Using postgres connection "master"
[0m18:35:03.569809 [debug] [MainThread]: On master: BEGIN
[0m18:35:03.570800 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:35:03.593099 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m18:35:03.594095 [debug] [MainThread]: Using postgres connection "master"
[0m18:35:03.595096 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m18:35:03.601628 [debug] [MainThread]: SQL status: SELECT 6 in 0.0 seconds
[0m18:35:03.604650 [debug] [MainThread]: On master: ROLLBACK
[0m18:35:03.606614 [debug] [MainThread]: Using postgres connection "master"
[0m18:35:03.607644 [debug] [MainThread]: On master: BEGIN
[0m18:35:03.611800 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m18:35:03.612785 [debug] [MainThread]: On master: COMMIT
[0m18:35:03.613800 [debug] [MainThread]: Using postgres connection "master"
[0m18:35:03.614796 [debug] [MainThread]: On master: COMMIT
[0m18:35:03.616804 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m18:35:03.617799 [debug] [MainThread]: On master: Close
[0m18:35:03.618792 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:35:03.620329 [info ] [MainThread]: 
[0m18:35:03.625320 [debug] [Thread-1 (]: Began running node model.dbt_idx.stg_eltool__customers
[0m18:35:03.626345 [info ] [Thread-1 (]: 1 of 7 START sql view model warehouse.stg_eltool__customers .................... [RUN]
[0m18:35:03.628345 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.dbt_idx.stg_eltool__customers'
[0m18:35:03.628899 [debug] [Thread-1 (]: Began compiling node model.dbt_idx.stg_eltool__customers
[0m18:35:03.636910 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_idx.stg_eltool__customers"
[0m18:35:03.644551 [debug] [Thread-1 (]: Timing info for model.dbt_idx.stg_eltool__customers (compile): 18:35:03.629915 => 18:35:03.644551
[0m18:35:03.645531 [debug] [Thread-1 (]: Began executing node model.dbt_idx.stg_eltool__customers
[0m18:35:03.682053 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_idx.stg_eltool__customers"
[0m18:35:03.688616 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__customers"
[0m18:35:03.689666 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__customers: BEGIN
[0m18:35:03.690624 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m18:35:03.713236 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m18:35:03.714259 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__customers"
[0m18:35:03.715217 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__customers: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__customers"} */

  create view "IDX-Stock"."warehouse"."stg_eltool__customers__dbt_tmp"
    
    
  as (
    with source as (select *
                from "IDX-Stock"."warehouse"."customers"),
     renamed as (select
                     customer_id,
                    'This is Dummy' as dummy
                 from source
                 where dummy = 'not found')
select *
from renamed
  );
[0m18:35:03.717220 [debug] [Thread-1 (]: Postgres adapter: Postgres error: column "dummy" does not exist
LINE 13:                  where dummy = 'not found')
                                ^

[0m18:35:03.717220 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__customers: ROLLBACK
[0m18:35:03.719778 [debug] [Thread-1 (]: Timing info for model.dbt_idx.stg_eltool__customers (execute): 18:35:03.645531 => 18:35:03.719778
[0m18:35:03.721793 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__customers: Close
[0m18:35:03.736033 [debug] [Thread-1 (]: Database Error in model stg_eltool__customers (models\staging\stg_eltool__customers.sql)
  column "dummy" does not exist
  LINE 13:                  where dummy = 'not found')
                                  ^
  compiled Code at target\run\dbt_idx\models\staging\stg_eltool__customers.sql
[0m18:35:03.737032 [error] [Thread-1 (]: 1 of 7 ERROR creating sql view model warehouse.stg_eltool__customers ........... [[31mERROR[0m in 0.11s]
[0m18:35:03.738636 [debug] [Thread-1 (]: Finished running node model.dbt_idx.stg_eltool__customers
[0m18:35:03.739551 [debug] [Thread-1 (]: Began running node model.dbt_idx.stg_eltool__customers_snapshots
[0m18:35:03.740976 [info ] [Thread-1 (]: 2 of 7 START sql view model warehouse.stg_eltool__customers_snapshots .......... [RUN]
[0m18:35:03.741986 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_idx.stg_eltool__customers, now model.dbt_idx.stg_eltool__customers_snapshots)
[0m18:35:03.741986 [debug] [Thread-1 (]: Began compiling node model.dbt_idx.stg_eltool__customers_snapshots
[0m18:35:03.745591 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_idx.stg_eltool__customers_snapshots"
[0m18:35:03.751924 [debug] [Thread-1 (]: Timing info for model.dbt_idx.stg_eltool__customers_snapshots (compile): 18:35:03.743658 => 18:35:03.751924
[0m18:35:03.752926 [debug] [Thread-1 (]: Began executing node model.dbt_idx.stg_eltool__customers_snapshots
[0m18:35:03.759440 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_idx.stg_eltool__customers_snapshots"
[0m18:35:03.766464 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__customers_snapshots"
[0m18:35:03.767438 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__customers_snapshots: BEGIN
[0m18:35:03.768438 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:35:03.792485 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m18:35:03.793501 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__customers_snapshots"
[0m18:35:03.794500 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__customers_snapshots: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__customers_snapshots"} */

  create view "IDX-Stock"."warehouse"."stg_eltool__customers_snapshots__dbt_tmp"
    
    
  as (
    with source as (select *
                from "IDX-Stock"."snapshots"."customers_snapshot"),
     renamed as (select customer_id,
                        zipcode,
                        city,
                        state_code,
                        datetime_created::TIMESTAMP AS datetime_created,
                        datetime_updated::TIMESTAMP AS datetime_updated,
                        dbt_valid_from,
                        dbt_valid_to
                 from source)
select *
from renamed
  );
[0m18:35:03.798998 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m18:35:03.806038 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__customers_snapshots"
[0m18:35:03.807027 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__customers_snapshots: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__customers_snapshots"} */
alter table "IDX-Stock"."warehouse"."stg_eltool__customers_snapshots" rename to "stg_eltool__customers_snapshots__dbt_backup"
[0m18:35:03.809876 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:35:03.813874 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__customers_snapshots"
[0m18:35:03.813874 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__customers_snapshots: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__customers_snapshots"} */
alter table "IDX-Stock"."warehouse"."stg_eltool__customers_snapshots__dbt_tmp" rename to "stg_eltool__customers_snapshots"
[0m18:35:03.816941 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:35:03.836841 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__customers_snapshots: COMMIT
[0m18:35:03.836841 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__customers_snapshots"
[0m18:35:03.838417 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__customers_snapshots: COMMIT
[0m18:35:03.843366 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m18:35:03.856040 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__customers_snapshots"
[0m18:35:03.857037 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__customers_snapshots: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__customers_snapshots"} */
drop view if exists "IDX-Stock"."warehouse"."stg_eltool__customers_snapshots__dbt_backup" cascade
[0m18:35:03.861548 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m18:35:03.863585 [debug] [Thread-1 (]: Timing info for model.dbt_idx.stg_eltool__customers_snapshots (execute): 18:35:03.753921 => 18:35:03.863585
[0m18:35:03.864553 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__customers_snapshots: Close
[0m18:35:03.866561 [info ] [Thread-1 (]: 2 of 7 OK created sql view model warehouse.stg_eltool__customers_snapshots ..... [[32mCREATE VIEW[0m in 0.12s]
[0m18:35:03.868556 [debug] [Thread-1 (]: Finished running node model.dbt_idx.stg_eltool__customers_snapshots
[0m18:35:03.869886 [debug] [Thread-1 (]: Began running node model.dbt_idx.stg_eltool__orders
[0m18:35:03.870914 [info ] [Thread-1 (]: 3 of 7 START sql view model warehouse.stg_eltool__orders ....................... [RUN]
[0m18:35:03.872879 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_idx.stg_eltool__customers_snapshots, now model.dbt_idx.stg_eltool__orders)
[0m18:35:03.873897 [debug] [Thread-1 (]: Began compiling node model.dbt_idx.stg_eltool__orders
[0m18:35:03.876915 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_idx.stg_eltool__orders"
[0m18:35:03.888947 [debug] [Thread-1 (]: Timing info for model.dbt_idx.stg_eltool__orders (compile): 18:35:03.873897 => 18:35:03.888947
[0m18:35:03.890954 [debug] [Thread-1 (]: Began executing node model.dbt_idx.stg_eltool__orders
[0m18:35:03.896989 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_idx.stg_eltool__orders"
[0m18:35:03.908587 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__orders"
[0m18:35:03.908587 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__orders: BEGIN
[0m18:35:03.909592 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:35:03.932326 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m18:35:03.933363 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__orders"
[0m18:35:03.935334 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__orders: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__orders"} */

  create view "IDX-Stock"."warehouse"."stg_eltool__orders__dbt_tmp"
    
    
  as (
    with source as (select *
                from "IDX-Stock"."warehouse"."orders"),
     renamed as (select order_id,
                        cust_id AS customer_id,
                        order_status,
                        order_purchase_timestamp::TIMESTAMP,
                        order_approved_at::TIMESTAMP,
                        order_delivered_carrier_date::TIMESTAMP,
                        order_delivered_customer_date::TIMESTAMP,
                        order_estimated_delivery_date::TIMESTAMP
                 from source)
select *
from renamed
  );
[0m18:35:03.939886 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m18:35:03.944484 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__orders"
[0m18:35:03.944484 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__orders: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__orders"} */
alter table "IDX-Stock"."warehouse"."stg_eltool__orders" rename to "stg_eltool__orders__dbt_backup"
[0m18:35:03.947414 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:35:03.951708 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__orders"
[0m18:35:03.951708 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__orders: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__orders"} */
alter table "IDX-Stock"."warehouse"."stg_eltool__orders__dbt_tmp" rename to "stg_eltool__orders"
[0m18:35:03.954698 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:35:03.957707 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__orders: COMMIT
[0m18:35:03.957707 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__orders"
[0m18:35:03.958709 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__orders: COMMIT
[0m18:35:03.962354 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m18:35:03.966371 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__orders"
[0m18:35:03.966371 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__orders: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__orders"} */
drop view if exists "IDX-Stock"."warehouse"."stg_eltool__orders__dbt_backup" cascade
[0m18:35:03.970910 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m18:35:03.972938 [debug] [Thread-1 (]: Timing info for model.dbt_idx.stg_eltool__orders (execute): 18:35:03.890954 => 18:35:03.972938
[0m18:35:03.973921 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__orders: Close
[0m18:35:03.976909 [info ] [Thread-1 (]: 3 of 7 OK created sql view model warehouse.stg_eltool__orders .................. [[32mCREATE VIEW[0m in 0.10s]
[0m18:35:03.980440 [debug] [Thread-1 (]: Finished running node model.dbt_idx.stg_eltool__orders
[0m18:35:03.981442 [debug] [Thread-1 (]: Began running node model.dbt_idx.stg_eltool__state
[0m18:35:03.982448 [info ] [Thread-1 (]: 4 of 7 START sql view model warehouse.stg_eltool__state ........................ [RUN]
[0m18:35:03.983437 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_idx.stg_eltool__orders, now model.dbt_idx.stg_eltool__state)
[0m18:35:03.984468 [debug] [Thread-1 (]: Began compiling node model.dbt_idx.stg_eltool__state
[0m18:35:03.988442 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_idx.stg_eltool__state"
[0m18:35:03.993980 [debug] [Thread-1 (]: Timing info for model.dbt_idx.stg_eltool__state (compile): 18:35:03.985439 => 18:35:03.993980
[0m18:35:03.994981 [debug] [Thread-1 (]: Began executing node model.dbt_idx.stg_eltool__state
[0m18:35:04.001522 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_idx.stg_eltool__state"
[0m18:35:04.008512 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__state"
[0m18:35:04.010048 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__state: BEGIN
[0m18:35:04.011050 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:35:04.032023 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m18:35:04.033035 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__state"
[0m18:35:04.034052 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__state: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__state"} */

  create view "IDX-Stock"."warehouse"."stg_eltool__state__dbt_tmp"
    
    
  as (
    with source as (select *
                from "IDX-Stock"."warehouse"."state"),
     renamed as (select state_identifier::INT AS state_id,
                         state_code::VARCHAR(2) AS state_code,
                         st_name::VARCHAR(30) AS state_name
                 from source)
select *
from renamed
  );
[0m18:35:04.039602 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m18:35:04.045162 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__state"
[0m18:35:04.047146 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__state: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__state"} */
alter table "IDX-Stock"."warehouse"."stg_eltool__state" rename to "stg_eltool__state__dbt_backup"
[0m18:35:04.050669 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:35:04.056671 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__state"
[0m18:35:04.057678 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__state: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__state"} */
alter table "IDX-Stock"."warehouse"."stg_eltool__state__dbt_tmp" rename to "stg_eltool__state"
[0m18:35:04.060720 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:35:04.063759 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__state: COMMIT
[0m18:35:04.064753 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__state"
[0m18:35:04.065764 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__state: COMMIT
[0m18:35:04.070355 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m18:35:04.074368 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__state"
[0m18:35:04.076366 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__state: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__state"} */
drop view if exists "IDX-Stock"."warehouse"."stg_eltool__state__dbt_backup" cascade
[0m18:35:04.082462 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m18:35:04.084488 [debug] [Thread-1 (]: Timing info for model.dbt_idx.stg_eltool__state (execute): 18:35:03.996006 => 18:35:04.084488
[0m18:35:04.085467 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__state: Close
[0m18:35:04.087456 [info ] [Thread-1 (]: 4 of 7 OK created sql view model warehouse.stg_eltool__state ................... [[32mCREATE VIEW[0m in 0.10s]
[0m18:35:04.090572 [debug] [Thread-1 (]: Finished running node model.dbt_idx.stg_eltool__state
[0m18:35:04.092594 [debug] [Thread-1 (]: Began running node model.dbt_idx.fact_orders
[0m18:35:04.093578 [info ] [Thread-1 (]: 5 of 7 START sql table model warehouse.fact_orders ............................. [RUN]
[0m18:35:04.095575 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_idx.stg_eltool__state, now model.dbt_idx.fact_orders)
[0m18:35:04.096086 [debug] [Thread-1 (]: Began compiling node model.dbt_idx.fact_orders
[0m18:35:04.101171 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_idx.fact_orders"
[0m18:35:04.109825 [debug] [Thread-1 (]: Timing info for model.dbt_idx.fact_orders (compile): 18:35:04.097101 => 18:35:04.109825
[0m18:35:04.110804 [debug] [Thread-1 (]: Began executing node model.dbt_idx.fact_orders
[0m18:35:04.136986 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_idx.fact_orders"
[0m18:35:04.146104 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.fact_orders"
[0m18:35:04.147078 [debug] [Thread-1 (]: On model.dbt_idx.fact_orders: BEGIN
[0m18:35:04.148589 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:35:04.171957 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m18:35:04.173834 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.fact_orders"
[0m18:35:04.174845 [debug] [Thread-1 (]: On model.dbt_idx.fact_orders: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.fact_orders"} */

  
    

  create  table "IDX-Stock"."warehouse"."fact_orders__dbt_tmp"
  
  
    as
  
  (
    with orders as (
    select *
    from "IDX-Stock"."warehouse"."stg_eltool__orders"
)
select * from orders
  );
  
[0m18:35:04.183414 [debug] [Thread-1 (]: SQL status: SELECT 999 in 0.0 seconds
[0m18:35:04.187410 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.fact_orders"
[0m18:35:04.188414 [debug] [Thread-1 (]: On model.dbt_idx.fact_orders: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.fact_orders"} */
alter table "IDX-Stock"."warehouse"."fact_orders" rename to "fact_orders__dbt_backup"
[0m18:35:04.192669 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:35:04.197781 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.fact_orders"
[0m18:35:04.199265 [debug] [Thread-1 (]: On model.dbt_idx.fact_orders: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.fact_orders"} */
alter table "IDX-Stock"."warehouse"."fact_orders__dbt_tmp" rename to "fact_orders"
[0m18:35:04.204286 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:35:04.216936 [debug] [Thread-1 (]: On model.dbt_idx.fact_orders: COMMIT
[0m18:35:04.218488 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.fact_orders"
[0m18:35:04.219503 [debug] [Thread-1 (]: On model.dbt_idx.fact_orders: COMMIT
[0m18:35:04.224526 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m18:35:04.232967 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.fact_orders"
[0m18:35:04.233974 [debug] [Thread-1 (]: On model.dbt_idx.fact_orders: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.fact_orders"} */
drop table if exists "IDX-Stock"."warehouse"."fact_orders__dbt_backup" cascade
[0m18:35:04.238522 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m18:35:04.240995 [debug] [Thread-1 (]: Timing info for model.dbt_idx.fact_orders (execute): 18:35:04.111808 => 18:35:04.240995
[0m18:35:04.241994 [debug] [Thread-1 (]: On model.dbt_idx.fact_orders: Close
[0m18:35:04.244513 [info ] [Thread-1 (]: 5 of 7 OK created sql table model warehouse.fact_orders ........................ [[32mSELECT 999[0m in 0.15s]
[0m18:35:04.246526 [debug] [Thread-1 (]: Finished running node model.dbt_idx.fact_orders
[0m18:35:04.247536 [debug] [Thread-1 (]: Began running node model.dbt_idx.dim_customers
[0m18:35:04.248574 [info ] [Thread-1 (]: 6 of 7 START sql table model warehouse.dim_customers ........................... [RUN]
[0m18:35:04.251018 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_idx.fact_orders, now model.dbt_idx.dim_customers)
[0m18:35:04.252031 [debug] [Thread-1 (]: Began compiling node model.dbt_idx.dim_customers
[0m18:35:04.255049 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_idx.dim_customers"
[0m18:35:04.262617 [debug] [Thread-1 (]: Timing info for model.dbt_idx.dim_customers (compile): 18:35:04.252031 => 18:35:04.261651
[0m18:35:04.263616 [debug] [Thread-1 (]: Began executing node model.dbt_idx.dim_customers
[0m18:35:04.269126 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_idx.dim_customers"
[0m18:35:04.277171 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.dim_customers"
[0m18:35:04.278774 [debug] [Thread-1 (]: On model.dbt_idx.dim_customers: BEGIN
[0m18:35:04.278774 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:35:04.301838 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m18:35:04.302849 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.dim_customers"
[0m18:35:04.302849 [debug] [Thread-1 (]: On model.dbt_idx.dim_customers: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.dim_customers"} */

  
    

  create  table "IDX-Stock"."warehouse"."dim_customers__dbt_tmp"
  
  
    as
  
  (
    -- noinspection SqlDialectInspectionForFile

with customers as (
    select *
    from "IDX-Stock"."warehouse"."stg_eltool__customers_snapshots"
    ),
     state as (
         select *
         from "IDX-Stock"."warehouse"."stg_eltool__state"
     )
select c.customer_id,
       c.zipcode,
       c.city,
       c.state_code,
       s.state_name,
       c.datetime_created,
       c.datetime_updated,
       c.dbt_valid_from::TIMESTAMP as valid_from,
        CASE WHEN c.dbt_valid_to IS NULL
            THEN '9999-12-31'::TIMESTAMP
            ELSE c.dbt_valid_to::TIMESTAMP
        END as valid_to
from customers c
    join state s on c.state_code = s.state_code
  );
  
[0m18:35:04.308378 [debug] [Thread-1 (]: SQL status: SELECT 105 in 0.0 seconds
[0m18:35:04.312390 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.dim_customers"
[0m18:35:04.313389 [debug] [Thread-1 (]: On model.dbt_idx.dim_customers: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.dim_customers"} */
alter table "IDX-Stock"."warehouse"."dim_customers" rename to "dim_customers__dbt_backup"
[0m18:35:04.315393 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:35:04.319905 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.dim_customers"
[0m18:35:04.320911 [debug] [Thread-1 (]: On model.dbt_idx.dim_customers: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.dim_customers"} */
alter table "IDX-Stock"."warehouse"."dim_customers__dbt_tmp" rename to "dim_customers"
[0m18:35:04.322998 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:35:04.326001 [debug] [Thread-1 (]: On model.dbt_idx.dim_customers: COMMIT
[0m18:35:04.327028 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.dim_customers"
[0m18:35:04.327028 [debug] [Thread-1 (]: On model.dbt_idx.dim_customers: COMMIT
[0m18:35:04.331578 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m18:35:04.335612 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.dim_customers"
[0m18:35:04.335612 [debug] [Thread-1 (]: On model.dbt_idx.dim_customers: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.dim_customers"} */
drop table if exists "IDX-Stock"."warehouse"."dim_customers__dbt_backup" cascade
[0m18:35:04.340849 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m18:35:04.344363 [debug] [Thread-1 (]: Timing info for model.dbt_idx.dim_customers (execute): 18:35:04.263616 => 18:35:04.342830
[0m18:35:04.345391 [debug] [Thread-1 (]: On model.dbt_idx.dim_customers: Close
[0m18:35:04.347393 [info ] [Thread-1 (]: 6 of 7 OK created sql table model warehouse.dim_customers ...................... [[32mSELECT 105[0m in 0.10s]
[0m18:35:04.350922 [debug] [Thread-1 (]: Finished running node model.dbt_idx.dim_customers
[0m18:35:04.352916 [debug] [Thread-1 (]: Began running node model.dbt_idx.customer_orders_status
[0m18:35:04.353922 [info ] [Thread-1 (]: 7 of 7 START sql view model warehouse.customer_orders_status ................... [RUN]
[0m18:35:04.354920 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_idx.dim_customers, now model.dbt_idx.customer_orders_status)
[0m18:35:04.355920 [debug] [Thread-1 (]: Began compiling node model.dbt_idx.customer_orders_status
[0m18:35:04.361439 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_idx.customer_orders_status"
[0m18:35:04.367456 [debug] [Thread-1 (]: Timing info for model.dbt_idx.customer_orders_status (compile): 18:35:04.356919 => 18:35:04.367456
[0m18:35:04.368978 [debug] [Thread-1 (]: Began executing node model.dbt_idx.customer_orders_status
[0m18:35:04.374024 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_idx.customer_orders_status"
[0m18:35:04.380527 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.customer_orders_status"
[0m18:35:04.381563 [debug] [Thread-1 (]: On model.dbt_idx.customer_orders_status: BEGIN
[0m18:35:04.382562 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:35:04.403892 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m18:35:04.404923 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.customer_orders_status"
[0m18:35:04.405909 [debug] [Thread-1 (]: On model.dbt_idx.customer_orders_status: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.customer_orders_status"} */

  create view "IDX-Stock"."warehouse"."customer_orders_status__dbt_tmp"
    
    
  as (
    with orders as (select *
                from "IDX-Stock"."warehouse"."fact_orders"),
     customers as (select *
                   from "IDX-Stock"."warehouse"."dim_customers")
select o.order_id,
       o.customer_id,
       o.order_status,
       o.order_purchase_timestamp,
       o.order_approved_at,
       o.order_delivered_carrier_date,
       o.order_delivered_customer_date,
       o.order_estimated_delivery_date,
       c.zipcode    as customer_zipcode,
       c.city       as customer_city,
       c.state_code as customer_state_code,
       c.state_name as customer_state_name
from orders o
    join customers c on o.customer_id = c.customer_id
    and o.order_purchase_timestamp >= c.valid_from
    and o.order_purchase_timestamp <= c.valid_to
  );
[0m18:35:04.410471 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m18:35:04.413470 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.customer_orders_status"
[0m18:35:04.414472 [debug] [Thread-1 (]: On model.dbt_idx.customer_orders_status: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.customer_orders_status"} */
alter table "IDX-Stock"."warehouse"."customer_orders_status__dbt_tmp" rename to "customer_orders_status"
[0m18:35:04.417439 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:35:04.419988 [debug] [Thread-1 (]: On model.dbt_idx.customer_orders_status: COMMIT
[0m18:35:04.420984 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.customer_orders_status"
[0m18:35:04.421997 [debug] [Thread-1 (]: On model.dbt_idx.customer_orders_status: COMMIT
[0m18:35:04.425192 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m18:35:04.429818 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.customer_orders_status"
[0m18:35:04.430868 [debug] [Thread-1 (]: On model.dbt_idx.customer_orders_status: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.customer_orders_status"} */
drop view if exists "IDX-Stock"."warehouse"."customer_orders_status__dbt_backup" cascade
[0m18:35:04.434083 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m18:35:04.436075 [debug] [Thread-1 (]: Timing info for model.dbt_idx.customer_orders_status (execute): 18:35:04.368978 => 18:35:04.435075
[0m18:35:04.436075 [debug] [Thread-1 (]: On model.dbt_idx.customer_orders_status: Close
[0m18:35:04.438765 [info ] [Thread-1 (]: 7 of 7 OK created sql view model warehouse.customer_orders_status .............. [[32mCREATE VIEW[0m in 0.08s]
[0m18:35:04.441657 [debug] [Thread-1 (]: Finished running node model.dbt_idx.customer_orders_status
[0m18:35:04.443658 [debug] [MainThread]: Using postgres connection "master"
[0m18:35:04.444936 [debug] [MainThread]: On master: BEGIN
[0m18:35:04.444936 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:35:04.469793 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m18:35:04.470836 [debug] [MainThread]: On master: COMMIT
[0m18:35:04.471787 [debug] [MainThread]: Using postgres connection "master"
[0m18:35:04.472790 [debug] [MainThread]: On master: COMMIT
[0m18:35:04.475790 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m18:35:04.476790 [debug] [MainThread]: On master: Close
[0m18:35:04.477804 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:35:04.478789 [debug] [MainThread]: Connection 'list_IDX-Stock' was properly closed.
[0m18:35:04.479980 [debug] [MainThread]: Connection 'list_IDX-Stock_snapshots' was properly closed.
[0m18:35:04.481009 [debug] [MainThread]: Connection 'model.dbt_idx.customer_orders_status' was properly closed.
[0m18:35:04.481990 [info ] [MainThread]: 
[0m18:35:04.482983 [info ] [MainThread]: Finished running 5 view models, 2 table models in 0 hours 0 minutes and 1.06 seconds (1.06s).
[0m18:35:04.485985 [debug] [MainThread]: Command end result
[0m18:35:04.511348 [info ] [MainThread]: 
[0m18:35:04.512345 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m18:35:04.513344 [info ] [MainThread]: 
[0m18:35:04.515348 [error] [MainThread]: [33mDatabase Error in model stg_eltool__customers (models\staging\stg_eltool__customers.sql)[0m
[0m18:35:04.517351 [error] [MainThread]:   column "dummy" does not exist
[0m18:35:04.519535 [error] [MainThread]:   LINE 13:                  where dummy = 'not found')
[0m18:35:04.520538 [error] [MainThread]:                                   ^
[0m18:35:04.521533 [error] [MainThread]:   compiled Code at target\run\dbt_idx\models\staging\stg_eltool__customers.sql
[0m18:35:04.523533 [info ] [MainThread]: 
[0m18:35:04.525536 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=1 SKIP=0 TOTAL=7
[0m18:35:04.527538 [debug] [MainThread]: Command `dbt run` failed at 18:35:04.526533 after 1.57 seconds
[0m18:35:04.528536 [debug] [MainThread]: Flushing usage events


============================== 18:35:29.012228 | c85f4319-555b-42d7-967e-62b5462754de ==============================
[0m18:35:29.012228 [info ] [MainThread]: Running with dbt=1.6.1
[0m18:35:29.018720 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'D:\\00 Project\\00 My Project\\IdeaProjects\\Py-DBT-IDX', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'D:\\00 Project\\00 My Project\\IdeaProjects\\Py-DBT-IDX\\logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'False'}
[0m18:35:29.148770 [info ] [MainThread]: Registered adapter: postgres=1.6.1
[0m18:35:29.159590 [debug] [MainThread]: checksum: efe19d9f5b93d1a98cc804fbfcdb6b3aced98b974af664946fee1cde8837deb7, vars: {}, profile: , target: , version: 1.6.1
[0m18:35:29.333287 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m18:35:29.334287 [debug] [MainThread]: Partial parsing: updated file: dbt_idx://models\staging\stg_eltool__customers.sql
[0m18:35:29.429436 [info ] [MainThread]: Found 1 snapshot, 9 tests, 7 models, 3 sources, 0 exposures, 0 metrics, 349 macros, 0 groups, 0 semantic models
[0m18:35:29.433429 [info ] [MainThread]: 
[0m18:35:29.435429 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m18:35:29.438434 [debug] [ThreadPool]: Acquiring new postgres connection 'list_IDX-Stock'
[0m18:35:29.450450 [debug] [ThreadPool]: Using postgres connection "list_IDX-Stock"
[0m18:35:29.451415 [debug] [ThreadPool]: On list_IDX-Stock: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "connection_name": "list_IDX-Stock"} */

    select distinct nspname from pg_namespace
  
[0m18:35:29.452416 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:35:29.500962 [debug] [ThreadPool]: SQL status: SELECT 13 in 0.0 seconds
[0m18:35:29.502960 [debug] [ThreadPool]: On list_IDX-Stock: Close
[0m18:35:29.506960 [debug] [ThreadPool]: Acquiring new postgres connection 'list_IDX-Stock_warehouse'
[0m18:35:29.513500 [debug] [ThreadPool]: Using postgres connection "list_IDX-Stock_warehouse"
[0m18:35:29.514523 [debug] [ThreadPool]: On list_IDX-Stock_warehouse: BEGIN
[0m18:35:29.514523 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:35:29.539611 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m18:35:29.540634 [debug] [ThreadPool]: Using postgres connection "list_IDX-Stock_warehouse"
[0m18:35:29.541623 [debug] [ThreadPool]: On list_IDX-Stock_warehouse: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "connection_name": "list_IDX-Stock_warehouse"} */
select
      'IDX-Stock' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'warehouse'
    union all
    select
      'IDX-Stock' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'warehouse'
    union all
    select
      'IDX-Stock' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'warehouse'
  
[0m18:35:29.546621 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.0 seconds
[0m18:35:29.548652 [debug] [ThreadPool]: On list_IDX-Stock_warehouse: ROLLBACK
[0m18:35:29.551713 [debug] [ThreadPool]: On list_IDX-Stock_warehouse: Close
[0m18:35:29.554713 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_IDX-Stock_warehouse, now list_IDX-Stock_snapshots)
[0m18:35:29.560242 [debug] [ThreadPool]: Using postgres connection "list_IDX-Stock_snapshots"
[0m18:35:29.561249 [debug] [ThreadPool]: On list_IDX-Stock_snapshots: BEGIN
[0m18:35:29.562254 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:35:29.582339 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m18:35:29.583337 [debug] [ThreadPool]: Using postgres connection "list_IDX-Stock_snapshots"
[0m18:35:29.584313 [debug] [ThreadPool]: On list_IDX-Stock_snapshots: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "connection_name": "list_IDX-Stock_snapshots"} */
select
      'IDX-Stock' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'snapshots'
    union all
    select
      'IDX-Stock' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'snapshots'
    union all
    select
      'IDX-Stock' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'snapshots'
  
[0m18:35:29.588297 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.0 seconds
[0m18:35:29.590419 [debug] [ThreadPool]: On list_IDX-Stock_snapshots: ROLLBACK
[0m18:35:29.592389 [debug] [ThreadPool]: On list_IDX-Stock_snapshots: Close
[0m18:35:29.599983 [debug] [MainThread]: Using postgres connection "master"
[0m18:35:29.600983 [debug] [MainThread]: On master: BEGIN
[0m18:35:29.601993 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:35:29.621916 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m18:35:29.622887 [debug] [MainThread]: Using postgres connection "master"
[0m18:35:29.622887 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m18:35:29.630400 [debug] [MainThread]: SQL status: SELECT 6 in 0.0 seconds
[0m18:35:29.633435 [debug] [MainThread]: On master: ROLLBACK
[0m18:35:29.635404 [debug] [MainThread]: Using postgres connection "master"
[0m18:35:29.636434 [debug] [MainThread]: On master: BEGIN
[0m18:35:29.639582 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m18:35:29.640588 [debug] [MainThread]: On master: COMMIT
[0m18:35:29.641581 [debug] [MainThread]: Using postgres connection "master"
[0m18:35:29.641581 [debug] [MainThread]: On master: COMMIT
[0m18:35:29.643564 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m18:35:29.644581 [debug] [MainThread]: On master: Close
[0m18:35:29.646595 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:35:29.647569 [info ] [MainThread]: 
[0m18:35:29.653105 [debug] [Thread-1 (]: Began running node model.dbt_idx.stg_eltool__customers
[0m18:35:29.654089 [info ] [Thread-1 (]: 1 of 7 START sql view model warehouse.stg_eltool__customers .................... [RUN]
[0m18:35:29.655090 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.dbt_idx.stg_eltool__customers'
[0m18:35:29.656124 [debug] [Thread-1 (]: Began compiling node model.dbt_idx.stg_eltool__customers
[0m18:35:29.665289 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_idx.stg_eltool__customers"
[0m18:35:29.672158 [debug] [Thread-1 (]: Timing info for model.dbt_idx.stg_eltool__customers (compile): 18:35:29.657102 => 18:35:29.672158
[0m18:35:29.673156 [debug] [Thread-1 (]: Began executing node model.dbt_idx.stg_eltool__customers
[0m18:35:29.710291 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_idx.stg_eltool__customers"
[0m18:35:29.717043 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__customers"
[0m18:35:29.717043 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__customers: BEGIN
[0m18:35:29.718640 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m18:35:29.738647 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m18:35:29.740156 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__customers"
[0m18:35:29.741137 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__customers: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__customers"} */

  create view "IDX-Stock"."warehouse"."stg_eltool__customers__dbt_tmp"
    
    
  as (
    with source as (select *
                from "IDX-Stock"."warehouse"."customers"),
     renamed as (select
                     customer_id,
                    'This is Dummy' as dummy
                 from source
                 where customer_id = 1234567890)
select *
from renamed
  );
[0m18:35:29.745128 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m18:35:29.753659 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__customers"
[0m18:35:29.754663 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__customers: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__customers"} */
alter table "IDX-Stock"."warehouse"."stg_eltool__customers" rename to "stg_eltool__customers__dbt_backup"
[0m18:35:29.757124 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:35:29.762350 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__customers"
[0m18:35:29.763387 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__customers: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__customers"} */
alter table "IDX-Stock"."warehouse"."stg_eltool__customers__dbt_tmp" rename to "stg_eltool__customers"
[0m18:35:29.765688 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:35:29.783736 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__customers: COMMIT
[0m18:35:29.784736 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__customers"
[0m18:35:29.784736 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__customers: COMMIT
[0m18:35:29.788740 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m18:35:29.797022 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__customers"
[0m18:35:29.798583 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__customers: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__customers"} */
drop view if exists "IDX-Stock"."warehouse"."stg_eltool__customers__dbt_backup" cascade
[0m18:35:29.803534 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m18:35:29.805534 [debug] [Thread-1 (]: Timing info for model.dbt_idx.stg_eltool__customers (execute): 18:35:29.674203 => 18:35:29.804534
[0m18:35:29.805534 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__customers: Close
[0m18:35:29.808551 [info ] [Thread-1 (]: 1 of 7 OK created sql view model warehouse.stg_eltool__customers ............... [[32mCREATE VIEW[0m in 0.15s]
[0m18:35:29.810076 [debug] [Thread-1 (]: Finished running node model.dbt_idx.stg_eltool__customers
[0m18:35:29.811104 [debug] [Thread-1 (]: Began running node model.dbt_idx.stg_eltool__customers_snapshots
[0m18:35:29.812104 [info ] [Thread-1 (]: 2 of 7 START sql view model warehouse.stg_eltool__customers_snapshots .......... [RUN]
[0m18:35:29.814113 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_idx.stg_eltool__customers, now model.dbt_idx.stg_eltool__customers_snapshots)
[0m18:35:29.815067 [debug] [Thread-1 (]: Began compiling node model.dbt_idx.stg_eltool__customers_snapshots
[0m18:35:29.817104 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_idx.stg_eltool__customers_snapshots"
[0m18:35:29.825652 [debug] [Thread-1 (]: Timing info for model.dbt_idx.stg_eltool__customers_snapshots (compile): 18:35:29.815067 => 18:35:29.824690
[0m18:35:29.826651 [debug] [Thread-1 (]: Began executing node model.dbt_idx.stg_eltool__customers_snapshots
[0m18:35:29.832209 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_idx.stg_eltool__customers_snapshots"
[0m18:35:29.838700 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__customers_snapshots"
[0m18:35:29.839711 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__customers_snapshots: BEGIN
[0m18:35:29.840748 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:35:29.862650 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m18:35:29.863649 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__customers_snapshots"
[0m18:35:29.864686 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__customers_snapshots: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__customers_snapshots"} */

  create view "IDX-Stock"."warehouse"."stg_eltool__customers_snapshots__dbt_tmp"
    
    
  as (
    with source as (select *
                from "IDX-Stock"."snapshots"."customers_snapshot"),
     renamed as (select customer_id,
                        zipcode,
                        city,
                        state_code,
                        datetime_created::TIMESTAMP AS datetime_created,
                        datetime_updated::TIMESTAMP AS datetime_updated,
                        dbt_valid_from,
                        dbt_valid_to
                 from source)
select *
from renamed
  );
[0m18:35:29.869563 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m18:35:29.873572 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__customers_snapshots"
[0m18:35:29.874588 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__customers_snapshots: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__customers_snapshots"} */
alter table "IDX-Stock"."warehouse"."stg_eltool__customers_snapshots" rename to "stg_eltool__customers_snapshots__dbt_backup"
[0m18:35:29.876484 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:35:29.881039 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__customers_snapshots"
[0m18:35:29.882043 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__customers_snapshots: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__customers_snapshots"} */
alter table "IDX-Stock"."warehouse"."stg_eltool__customers_snapshots__dbt_tmp" rename to "stg_eltool__customers_snapshots"
[0m18:35:29.884007 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:35:29.886040 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__customers_snapshots: COMMIT
[0m18:35:29.887040 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__customers_snapshots"
[0m18:35:29.887040 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__customers_snapshots: COMMIT
[0m18:35:29.890575 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m18:35:29.894598 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__customers_snapshots"
[0m18:35:29.895575 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__customers_snapshots: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__customers_snapshots"} */
drop view if exists "IDX-Stock"."warehouse"."stg_eltool__customers_snapshots__dbt_backup" cascade
[0m18:35:29.899834 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m18:35:29.901851 [debug] [Thread-1 (]: Timing info for model.dbt_idx.stg_eltool__customers_snapshots (execute): 18:35:29.826651 => 18:35:29.900827
[0m18:35:29.901851 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__customers_snapshots: Close
[0m18:35:29.903826 [info ] [Thread-1 (]: 2 of 7 OK created sql view model warehouse.stg_eltool__customers_snapshots ..... [[32mCREATE VIEW[0m in 0.09s]
[0m18:35:29.905853 [debug] [Thread-1 (]: Finished running node model.dbt_idx.stg_eltool__customers_snapshots
[0m18:35:29.906829 [debug] [Thread-1 (]: Began running node model.dbt_idx.stg_eltool__orders
[0m18:35:29.906829 [info ] [Thread-1 (]: 3 of 7 START sql view model warehouse.stg_eltool__orders ....................... [RUN]
[0m18:35:29.909369 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_idx.stg_eltool__customers_snapshots, now model.dbt_idx.stg_eltool__orders)
[0m18:35:29.910434 [debug] [Thread-1 (]: Began compiling node model.dbt_idx.stg_eltool__orders
[0m18:35:29.914395 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_idx.stg_eltool__orders"
[0m18:35:29.924734 [debug] [Thread-1 (]: Timing info for model.dbt_idx.stg_eltool__orders (compile): 18:35:29.911394 => 18:35:29.924734
[0m18:35:29.926568 [debug] [Thread-1 (]: Began executing node model.dbt_idx.stg_eltool__orders
[0m18:35:29.942959 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_idx.stg_eltool__orders"
[0m18:35:29.956243 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__orders"
[0m18:35:29.957272 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__orders: BEGIN
[0m18:35:29.958240 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:35:30.019598 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m18:35:30.021876 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__orders"
[0m18:35:30.022892 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__orders: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__orders"} */

  create view "IDX-Stock"."warehouse"."stg_eltool__orders__dbt_tmp"
    
    
  as (
    with source as (select *
                from "IDX-Stock"."warehouse"."orders"),
     renamed as (select order_id,
                        cust_id AS customer_id,
                        order_status,
                        order_purchase_timestamp::TIMESTAMP,
                        order_approved_at::TIMESTAMP,
                        order_delivered_carrier_date::TIMESTAMP,
                        order_delivered_customer_date::TIMESTAMP,
                        order_estimated_delivery_date::TIMESTAMP
                 from source)
select *
from renamed
  );
[0m18:35:30.029820 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m18:35:30.038343 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__orders"
[0m18:35:30.040359 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__orders: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__orders"} */
alter table "IDX-Stock"."warehouse"."stg_eltool__orders" rename to "stg_eltool__orders__dbt_backup"
[0m18:35:30.043397 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:35:30.048584 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__orders"
[0m18:35:30.049463 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__orders: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__orders"} */
alter table "IDX-Stock"."warehouse"."stg_eltool__orders__dbt_tmp" rename to "stg_eltool__orders"
[0m18:35:30.054394 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:35:30.060435 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__orders: COMMIT
[0m18:35:30.061568 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__orders"
[0m18:35:30.063353 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__orders: COMMIT
[0m18:35:30.068458 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m18:35:30.072461 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__orders"
[0m18:35:30.073733 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__orders: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__orders"} */
drop view if exists "IDX-Stock"."warehouse"."stg_eltool__orders__dbt_backup" cascade
[0m18:35:30.078332 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m18:35:30.080152 [debug] [Thread-1 (]: Timing info for model.dbt_idx.stg_eltool__orders (execute): 18:35:29.928311 => 18:35:30.080152
[0m18:35:30.081694 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__orders: Close
[0m18:35:30.084707 [info ] [Thread-1 (]: 3 of 7 OK created sql view model warehouse.stg_eltool__orders .................. [[32mCREATE VIEW[0m in 0.18s]
[0m18:35:30.086707 [debug] [Thread-1 (]: Finished running node model.dbt_idx.stg_eltool__orders
[0m18:35:30.087718 [debug] [Thread-1 (]: Began running node model.dbt_idx.stg_eltool__state
[0m18:35:30.089218 [info ] [Thread-1 (]: 4 of 7 START sql view model warehouse.stg_eltool__state ........................ [RUN]
[0m18:35:30.091258 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_idx.stg_eltool__orders, now model.dbt_idx.stg_eltool__state)
[0m18:35:30.092227 [debug] [Thread-1 (]: Began compiling node model.dbt_idx.stg_eltool__state
[0m18:35:30.098256 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_idx.stg_eltool__state"
[0m18:35:30.107207 [debug] [Thread-1 (]: Timing info for model.dbt_idx.stg_eltool__state (compile): 18:35:30.093236 => 18:35:30.107207
[0m18:35:30.108749 [debug] [Thread-1 (]: Began executing node model.dbt_idx.stg_eltool__state
[0m18:35:30.114792 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_idx.stg_eltool__state"
[0m18:35:30.123289 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__state"
[0m18:35:30.124288 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__state: BEGIN
[0m18:35:30.125297 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:35:30.147172 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m18:35:30.148744 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__state"
[0m18:35:30.149709 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__state: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__state"} */

  create view "IDX-Stock"."warehouse"."stg_eltool__state__dbt_tmp"
    
    
  as (
    with source as (select *
                from "IDX-Stock"."warehouse"."state"),
     renamed as (select state_identifier::INT AS state_id,
                         state_code::VARCHAR(2) AS state_code,
                         st_name::VARCHAR(30) AS state_name
                 from source)
select *
from renamed
  );
[0m18:35:30.152720 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m18:35:30.156717 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__state"
[0m18:35:30.157716 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__state: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__state"} */
alter table "IDX-Stock"."warehouse"."stg_eltool__state" rename to "stg_eltool__state__dbt_backup"
[0m18:35:30.160762 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:35:30.164750 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__state"
[0m18:35:30.165750 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__state: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__state"} */
alter table "IDX-Stock"."warehouse"."stg_eltool__state__dbt_tmp" rename to "stg_eltool__state"
[0m18:35:30.168751 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:35:30.171936 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__state: COMMIT
[0m18:35:30.172906 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__state"
[0m18:35:30.173931 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__state: COMMIT
[0m18:35:30.178410 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m18:35:30.181425 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.stg_eltool__state"
[0m18:35:30.182425 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__state: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.stg_eltool__state"} */
drop view if exists "IDX-Stock"."warehouse"."stg_eltool__state__dbt_backup" cascade
[0m18:35:30.186427 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m18:35:30.188931 [debug] [Thread-1 (]: Timing info for model.dbt_idx.stg_eltool__state (execute): 18:35:30.108749 => 18:35:30.188931
[0m18:35:30.189936 [debug] [Thread-1 (]: On model.dbt_idx.stg_eltool__state: Close
[0m18:35:30.191954 [info ] [Thread-1 (]: 4 of 7 OK created sql view model warehouse.stg_eltool__state ................... [[32mCREATE VIEW[0m in 0.10s]
[0m18:35:30.193947 [debug] [Thread-1 (]: Finished running node model.dbt_idx.stg_eltool__state
[0m18:35:30.194945 [debug] [Thread-1 (]: Began running node model.dbt_idx.fact_orders
[0m18:35:30.195956 [info ] [Thread-1 (]: 5 of 7 START sql table model warehouse.fact_orders ............................. [RUN]
[0m18:35:30.196943 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_idx.stg_eltool__state, now model.dbt_idx.fact_orders)
[0m18:35:30.196943 [debug] [Thread-1 (]: Began compiling node model.dbt_idx.fact_orders
[0m18:35:30.202497 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_idx.fact_orders"
[0m18:35:30.208533 [debug] [Thread-1 (]: Timing info for model.dbt_idx.fact_orders (compile): 18:35:30.198585 => 18:35:30.208533
[0m18:35:30.209971 [debug] [Thread-1 (]: Began executing node model.dbt_idx.fact_orders
[0m18:35:30.233870 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_idx.fact_orders"
[0m18:35:30.241611 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.fact_orders"
[0m18:35:30.241611 [debug] [Thread-1 (]: On model.dbt_idx.fact_orders: BEGIN
[0m18:35:30.242647 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:35:30.269562 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m18:35:30.270555 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.fact_orders"
[0m18:35:30.271589 [debug] [Thread-1 (]: On model.dbt_idx.fact_orders: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.fact_orders"} */

  
    

  create  table "IDX-Stock"."warehouse"."fact_orders__dbt_tmp"
  
  
    as
  
  (
    with orders as (
    select *
    from "IDX-Stock"."warehouse"."stg_eltool__orders"
)
select * from orders
  );
  
[0m18:35:30.280436 [debug] [Thread-1 (]: SQL status: SELECT 999 in 0.0 seconds
[0m18:35:30.285465 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.fact_orders"
[0m18:35:30.285465 [debug] [Thread-1 (]: On model.dbt_idx.fact_orders: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.fact_orders"} */
alter table "IDX-Stock"."warehouse"."fact_orders" rename to "fact_orders__dbt_backup"
[0m18:35:30.288427 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:35:30.292711 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.fact_orders"
[0m18:35:30.293693 [debug] [Thread-1 (]: On model.dbt_idx.fact_orders: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.fact_orders"} */
alter table "IDX-Stock"."warehouse"."fact_orders__dbt_tmp" rename to "fact_orders"
[0m18:35:30.296661 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:35:30.303245 [debug] [Thread-1 (]: On model.dbt_idx.fact_orders: COMMIT
[0m18:35:30.304282 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.fact_orders"
[0m18:35:30.305281 [debug] [Thread-1 (]: On model.dbt_idx.fact_orders: COMMIT
[0m18:35:30.310801 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m18:35:30.316838 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.fact_orders"
[0m18:35:30.316838 [debug] [Thread-1 (]: On model.dbt_idx.fact_orders: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.fact_orders"} */
drop table if exists "IDX-Stock"."warehouse"."fact_orders__dbt_backup" cascade
[0m18:35:30.323404 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m18:35:30.325896 [debug] [Thread-1 (]: Timing info for model.dbt_idx.fact_orders (execute): 18:35:30.210993 => 18:35:30.325896
[0m18:35:30.326905 [debug] [Thread-1 (]: On model.dbt_idx.fact_orders: Close
[0m18:35:30.329432 [info ] [Thread-1 (]: 5 of 7 OK created sql table model warehouse.fact_orders ........................ [[32mSELECT 999[0m in 0.13s]
[0m18:35:30.332437 [debug] [Thread-1 (]: Finished running node model.dbt_idx.fact_orders
[0m18:35:30.333436 [debug] [Thread-1 (]: Began running node model.dbt_idx.dim_customers
[0m18:35:30.334450 [info ] [Thread-1 (]: 6 of 7 START sql table model warehouse.dim_customers ........................... [RUN]
[0m18:35:30.335435 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_idx.fact_orders, now model.dbt_idx.dim_customers)
[0m18:35:30.336434 [debug] [Thread-1 (]: Began compiling node model.dbt_idx.dim_customers
[0m18:35:30.339996 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_idx.dim_customers"
[0m18:35:30.346998 [debug] [Thread-1 (]: Timing info for model.dbt_idx.dim_customers (compile): 18:35:30.337433 => 18:35:30.346998
[0m18:35:30.348517 [debug] [Thread-1 (]: Began executing node model.dbt_idx.dim_customers
[0m18:35:30.354138 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_idx.dim_customers"
[0m18:35:30.363250 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.dim_customers"
[0m18:35:30.365236 [debug] [Thread-1 (]: On model.dbt_idx.dim_customers: BEGIN
[0m18:35:30.366230 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:35:30.396854 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m18:35:30.396854 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.dim_customers"
[0m18:35:30.398482 [debug] [Thread-1 (]: On model.dbt_idx.dim_customers: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.dim_customers"} */

  
    

  create  table "IDX-Stock"."warehouse"."dim_customers__dbt_tmp"
  
  
    as
  
  (
    -- noinspection SqlDialectInspectionForFile

with customers as (
    select *
    from "IDX-Stock"."warehouse"."stg_eltool__customers_snapshots"
    ),
     state as (
         select *
         from "IDX-Stock"."warehouse"."stg_eltool__state"
     )
select c.customer_id,
       c.zipcode,
       c.city,
       c.state_code,
       s.state_name,
       c.datetime_created,
       c.datetime_updated,
       c.dbt_valid_from::TIMESTAMP as valid_from,
        CASE WHEN c.dbt_valid_to IS NULL
            THEN '9999-12-31'::TIMESTAMP
            ELSE c.dbt_valid_to::TIMESTAMP
        END as valid_to
from customers c
    join state s on c.state_code = s.state_code
  );
  
[0m18:35:30.403393 [debug] [Thread-1 (]: SQL status: SELECT 105 in 0.0 seconds
[0m18:35:30.409826 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.dim_customers"
[0m18:35:30.410815 [debug] [Thread-1 (]: On model.dbt_idx.dim_customers: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.dim_customers"} */
alter table "IDX-Stock"."warehouse"."dim_customers" rename to "dim_customers__dbt_backup"
[0m18:35:30.414396 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:35:30.421508 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.dim_customers"
[0m18:35:30.422525 [debug] [Thread-1 (]: On model.dbt_idx.dim_customers: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.dim_customers"} */
alter table "IDX-Stock"."warehouse"."dim_customers__dbt_tmp" rename to "dim_customers"
[0m18:35:30.425515 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:35:30.430573 [debug] [Thread-1 (]: On model.dbt_idx.dim_customers: COMMIT
[0m18:35:30.431580 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.dim_customers"
[0m18:35:30.431580 [debug] [Thread-1 (]: On model.dbt_idx.dim_customers: COMMIT
[0m18:35:30.436130 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m18:35:30.440690 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.dim_customers"
[0m18:35:30.441689 [debug] [Thread-1 (]: On model.dbt_idx.dim_customers: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.dim_customers"} */
drop table if exists "IDX-Stock"."warehouse"."dim_customers__dbt_backup" cascade
[0m18:35:30.447705 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m18:35:30.451538 [debug] [Thread-1 (]: Timing info for model.dbt_idx.dim_customers (execute): 18:35:30.349543 => 18:35:30.451538
[0m18:35:30.453523 [debug] [Thread-1 (]: On model.dbt_idx.dim_customers: Close
[0m18:35:30.455530 [info ] [Thread-1 (]: 6 of 7 OK created sql table model warehouse.dim_customers ...................... [[32mSELECT 105[0m in 0.12s]
[0m18:35:30.457537 [debug] [Thread-1 (]: Finished running node model.dbt_idx.dim_customers
[0m18:35:30.459847 [debug] [Thread-1 (]: Began running node model.dbt_idx.customer_orders_status
[0m18:35:30.460494 [info ] [Thread-1 (]: 7 of 7 START sql view model warehouse.customer_orders_status ................... [RUN]
[0m18:35:30.461395 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_idx.dim_customers, now model.dbt_idx.customer_orders_status)
[0m18:35:30.462392 [debug] [Thread-1 (]: Began compiling node model.dbt_idx.customer_orders_status
[0m18:35:30.465423 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_idx.customer_orders_status"
[0m18:35:30.471601 [debug] [Thread-1 (]: Timing info for model.dbt_idx.customer_orders_status (compile): 18:35:30.463389 => 18:35:30.471601
[0m18:35:30.472596 [debug] [Thread-1 (]: Began executing node model.dbt_idx.customer_orders_status
[0m18:35:30.477598 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_idx.customer_orders_status"
[0m18:35:30.485332 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.customer_orders_status"
[0m18:35:30.486330 [debug] [Thread-1 (]: On model.dbt_idx.customer_orders_status: BEGIN
[0m18:35:30.486330 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:35:30.508577 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m18:35:30.508577 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.customer_orders_status"
[0m18:35:30.510496 [debug] [Thread-1 (]: On model.dbt_idx.customer_orders_status: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.customer_orders_status"} */

  create view "IDX-Stock"."warehouse"."customer_orders_status__dbt_tmp"
    
    
  as (
    with orders as (select *
                from "IDX-Stock"."warehouse"."fact_orders"),
     customers as (select *
                   from "IDX-Stock"."warehouse"."dim_customers")
select o.order_id,
       o.customer_id,
       o.order_status,
       o.order_purchase_timestamp,
       o.order_approved_at,
       o.order_delivered_carrier_date,
       o.order_delivered_customer_date,
       o.order_estimated_delivery_date,
       c.zipcode    as customer_zipcode,
       c.city       as customer_city,
       c.state_code as customer_state_code,
       c.state_name as customer_state_name
from orders o
    join customers c on o.customer_id = c.customer_id
    and o.order_purchase_timestamp >= c.valid_from
    and o.order_purchase_timestamp <= c.valid_to
  );
[0m18:35:30.514493 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m18:35:30.517527 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.customer_orders_status"
[0m18:35:30.518528 [debug] [Thread-1 (]: On model.dbt_idx.customer_orders_status: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.customer_orders_status"} */
alter table "IDX-Stock"."warehouse"."customer_orders_status__dbt_tmp" rename to "customer_orders_status"
[0m18:35:30.521414 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:35:30.523424 [debug] [Thread-1 (]: On model.dbt_idx.customer_orders_status: COMMIT
[0m18:35:30.524424 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.customer_orders_status"
[0m18:35:30.524424 [debug] [Thread-1 (]: On model.dbt_idx.customer_orders_status: COMMIT
[0m18:35:30.528487 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m18:35:30.532531 [debug] [Thread-1 (]: Using postgres connection "model.dbt_idx.customer_orders_status"
[0m18:35:30.532531 [debug] [Thread-1 (]: On model.dbt_idx.customer_orders_status: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "model.dbt_idx.customer_orders_status"} */
drop view if exists "IDX-Stock"."warehouse"."customer_orders_status__dbt_backup" cascade
[0m18:35:30.535515 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m18:35:30.537530 [debug] [Thread-1 (]: Timing info for model.dbt_idx.customer_orders_status (execute): 18:35:30.473567 => 18:35:30.536499
[0m18:35:30.537530 [debug] [Thread-1 (]: On model.dbt_idx.customer_orders_status: Close
[0m18:35:30.540083 [info ] [Thread-1 (]: 7 of 7 OK created sql view model warehouse.customer_orders_status .............. [[32mCREATE VIEW[0m in 0.08s]
[0m18:35:30.542118 [debug] [Thread-1 (]: Finished running node model.dbt_idx.customer_orders_status
[0m18:35:30.544079 [debug] [MainThread]: Using postgres connection "master"
[0m18:35:30.545079 [debug] [MainThread]: On master: BEGIN
[0m18:35:30.546093 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:35:30.570278 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m18:35:30.571253 [debug] [MainThread]: On master: COMMIT
[0m18:35:30.572252 [debug] [MainThread]: Using postgres connection "master"
[0m18:35:30.572252 [debug] [MainThread]: On master: COMMIT
[0m18:35:30.574273 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m18:35:30.575320 [debug] [MainThread]: On master: Close
[0m18:35:30.577291 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:35:30.579393 [debug] [MainThread]: Connection 'list_IDX-Stock' was properly closed.
[0m18:35:30.580415 [debug] [MainThread]: Connection 'list_IDX-Stock_snapshots' was properly closed.
[0m18:35:30.581395 [debug] [MainThread]: Connection 'model.dbt_idx.customer_orders_status' was properly closed.
[0m18:35:30.582389 [info ] [MainThread]: 
[0m18:35:30.583414 [info ] [MainThread]: Finished running 5 view models, 2 table models in 0 hours 0 minutes and 1.15 seconds (1.15s).
[0m18:35:30.585396 [debug] [MainThread]: Command end result
[0m18:35:30.606037 [info ] [MainThread]: 
[0m18:35:30.606876 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:35:30.607887 [info ] [MainThread]: 
[0m18:35:30.609400 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=0 SKIP=0 TOTAL=7
[0m18:35:30.610402 [debug] [MainThread]: Command `dbt run` succeeded at 18:35:30.610402 after 1.64 seconds
[0m18:35:30.611423 [debug] [MainThread]: Flushing usage events


============================== 18:36:02.566662 | 2b1a0c7e-1296-45f6-9d0d-318350efcf46 ==============================
[0m18:36:02.566662 [info ] [MainThread]: Running with dbt=1.6.1
[0m18:36:02.571179 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': 'D:\\00 Project\\00 My Project\\IdeaProjects\\Py-DBT-IDX\\logs', 'profiles_dir': 'D:\\00 Project\\00 My Project\\IdeaProjects\\Py-DBT-IDX', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt test', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'False'}
[0m18:36:02.712354 [info ] [MainThread]: Registered adapter: postgres=1.6.1
[0m18:36:02.721856 [debug] [MainThread]: checksum: efe19d9f5b93d1a98cc804fbfcdb6b3aced98b974af664946fee1cde8837deb7, vars: {}, profile: , target: , version: 1.6.1
[0m18:36:02.888245 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m18:36:02.890191 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m18:36:02.936223 [info ] [MainThread]: Found 1 snapshot, 9 tests, 7 models, 3 sources, 0 exposures, 0 metrics, 349 macros, 0 groups, 0 semantic models
[0m18:36:02.938740 [info ] [MainThread]: 
[0m18:36:02.940752 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m18:36:02.946764 [debug] [ThreadPool]: Acquiring new postgres connection 'list_IDX-Stock_snapshots'
[0m18:36:02.957346 [debug] [ThreadPool]: Using postgres connection "list_IDX-Stock_snapshots"
[0m18:36:02.957346 [debug] [ThreadPool]: On list_IDX-Stock_snapshots: BEGIN
[0m18:36:02.958345 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:36:02.992049 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m18:36:02.993051 [debug] [ThreadPool]: Using postgres connection "list_IDX-Stock_snapshots"
[0m18:36:02.993587 [debug] [ThreadPool]: On list_IDX-Stock_snapshots: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "connection_name": "list_IDX-Stock_snapshots"} */
select
      'IDX-Stock' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'snapshots'
    union all
    select
      'IDX-Stock' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'snapshots'
    union all
    select
      'IDX-Stock' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'snapshots'
  
[0m18:36:02.997600 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.0 seconds
[0m18:36:02.999137 [debug] [ThreadPool]: On list_IDX-Stock_snapshots: ROLLBACK
[0m18:36:03.002144 [debug] [ThreadPool]: On list_IDX-Stock_snapshots: Close
[0m18:36:03.004143 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_IDX-Stock_snapshots, now list_IDX-Stock_warehouse)
[0m18:36:03.009654 [debug] [ThreadPool]: Using postgres connection "list_IDX-Stock_warehouse"
[0m18:36:03.011663 [debug] [ThreadPool]: On list_IDX-Stock_warehouse: BEGIN
[0m18:36:03.012675 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:36:03.034770 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m18:36:03.035770 [debug] [ThreadPool]: Using postgres connection "list_IDX-Stock_warehouse"
[0m18:36:03.036768 [debug] [ThreadPool]: On list_IDX-Stock_warehouse: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "connection_name": "list_IDX-Stock_warehouse"} */
select
      'IDX-Stock' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'warehouse'
    union all
    select
      'IDX-Stock' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'warehouse'
    union all
    select
      'IDX-Stock' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'warehouse'
  
[0m18:36:03.041292 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.0 seconds
[0m18:36:03.043311 [debug] [ThreadPool]: On list_IDX-Stock_warehouse: ROLLBACK
[0m18:36:03.045282 [debug] [ThreadPool]: On list_IDX-Stock_warehouse: Close
[0m18:36:03.056837 [debug] [MainThread]: Using postgres connection "master"
[0m18:36:03.056837 [debug] [MainThread]: On master: BEGIN
[0m18:36:03.058342 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:36:03.081321 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m18:36:03.082318 [debug] [MainThread]: Using postgres connection "master"
[0m18:36:03.083318 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m18:36:03.090574 [debug] [MainThread]: SQL status: SELECT 6 in 0.0 seconds
[0m18:36:03.093150 [debug] [MainThread]: On master: ROLLBACK
[0m18:36:03.096087 [debug] [MainThread]: Using postgres connection "master"
[0m18:36:03.096087 [debug] [MainThread]: On master: BEGIN
[0m18:36:03.100635 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m18:36:03.101635 [debug] [MainThread]: On master: COMMIT
[0m18:36:03.101635 [debug] [MainThread]: Using postgres connection "master"
[0m18:36:03.102636 [debug] [MainThread]: On master: COMMIT
[0m18:36:03.104938 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m18:36:03.105926 [debug] [MainThread]: On master: Close
[0m18:36:03.106926 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:36:03.109444 [info ] [MainThread]: 
[0m18:36:03.116441 [debug] [Thread-1 (]: Began running node test.dbt_idx.accepted_values_customer_orders_status_order_status__delivered__invoiced__shipped__processing__canceled__unavailable.ea8c296d27
[0m18:36:03.117444 [info ] [Thread-1 (]: 1 of 9 START test accepted_values_customer_orders_status_order_status__delivered__invoiced__shipped__processing__canceled__unavailable  [RUN]
[0m18:36:03.119571 [debug] [Thread-1 (]: Acquiring new postgres connection 'test.dbt_idx.accepted_values_customer_orders_status_order_status__delivered__invoiced__shipped__processing__canceled__unavailable.ea8c296d27'
[0m18:36:03.120566 [debug] [Thread-1 (]: Began compiling node test.dbt_idx.accepted_values_customer_orders_status_order_status__delivered__invoiced__shipped__processing__canceled__unavailable.ea8c296d27
[0m18:36:03.149722 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_idx.accepted_values_customer_orders_status_order_status__delivered__invoiced__shipped__processing__canceled__unavailable.ea8c296d27"
[0m18:36:03.159291 [debug] [Thread-1 (]: Timing info for test.dbt_idx.accepted_values_customer_orders_status_order_status__delivered__invoiced__shipped__processing__canceled__unavailable.ea8c296d27 (compile): 18:36:03.122581 => 18:36:03.159291
[0m18:36:03.161328 [debug] [Thread-1 (]: Began executing node test.dbt_idx.accepted_values_customer_orders_status_order_status__delivered__invoiced__shipped__processing__canceled__unavailable.ea8c296d27
[0m18:36:03.180883 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_idx.accepted_values_customer_orders_status_order_status__delivered__invoiced__shipped__processing__canceled__unavailable.ea8c296d27"
[0m18:36:03.189406 [debug] [Thread-1 (]: Using postgres connection "test.dbt_idx.accepted_values_customer_orders_status_order_status__delivered__invoiced__shipped__processing__canceled__unavailable.ea8c296d27"
[0m18:36:03.190406 [debug] [Thread-1 (]: On test.dbt_idx.accepted_values_customer_orders_status_order_status__delivered__invoiced__shipped__processing__canceled__unavailable.ea8c296d27: BEGIN
[0m18:36:03.191402 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m18:36:03.221706 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m18:36:03.223669 [debug] [Thread-1 (]: Using postgres connection "test.dbt_idx.accepted_values_customer_orders_status_order_status__delivered__invoiced__shipped__processing__canceled__unavailable.ea8c296d27"
[0m18:36:03.224669 [debug] [Thread-1 (]: On test.dbt_idx.accepted_values_customer_orders_status_order_status__delivered__invoiced__shipped__processing__canceled__unavailable.ea8c296d27: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "test.dbt_idx.accepted_values_customer_orders_status_order_status__delivered__invoiced__shipped__processing__canceled__unavailable.ea8c296d27"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        order_status as value_field,
        count(*) as n_records

    from "IDX-Stock"."warehouse"."customer_orders_status"
    group by order_status

)

select *
from all_values
where value_field not in (
    'delivered','invoiced','shipped','processing','canceled','unavailable'
)



      
    ) dbt_internal_test
[0m18:36:03.229213 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m18:36:03.232244 [debug] [Thread-1 (]: Timing info for test.dbt_idx.accepted_values_customer_orders_status_order_status__delivered__invoiced__shipped__processing__canceled__unavailable.ea8c296d27 (execute): 18:36:03.162298 => 18:36:03.232244
[0m18:36:03.233240 [debug] [Thread-1 (]: On test.dbt_idx.accepted_values_customer_orders_status_order_status__delivered__invoiced__shipped__processing__canceled__unavailable.ea8c296d27: ROLLBACK
[0m18:36:03.236220 [debug] [Thread-1 (]: On test.dbt_idx.accepted_values_customer_orders_status_order_status__delivered__invoiced__shipped__processing__canceled__unavailable.ea8c296d27: Close
[0m18:36:03.238206 [info ] [Thread-1 (]: 1 of 9 PASS accepted_values_customer_orders_status_order_status__delivered__invoiced__shipped__processing__canceled__unavailable  [[32mPASS[0m in 0.12s]
[0m18:36:03.241344 [debug] [Thread-1 (]: Finished running node test.dbt_idx.accepted_values_customer_orders_status_order_status__delivered__invoiced__shipped__processing__canceled__unavailable.ea8c296d27
[0m18:36:03.242310 [debug] [Thread-1 (]: Began running node test.dbt_idx.assert_customer_dimension_has_no_row_loss.sql
[0m18:36:03.243344 [info ] [Thread-1 (]: 2 of 9 START test assert_customer_dimension_has_no_row_loss.sql ................ [RUN]
[0m18:36:03.245308 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_idx.accepted_values_customer_orders_status_order_status__delivered__invoiced__shipped__processing__canceled__unavailable.ea8c296d27, now test.dbt_idx.assert_customer_dimension_has_no_row_loss.sql)
[0m18:36:03.246317 [debug] [Thread-1 (]: Began compiling node test.dbt_idx.assert_customer_dimension_has_no_row_loss.sql
[0m18:36:03.250937 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_idx.assert_customer_dimension_has_no_row_loss.sql"
[0m18:36:03.260461 [debug] [Thread-1 (]: Timing info for test.dbt_idx.assert_customer_dimension_has_no_row_loss.sql (compile): 18:36:03.247307 => 18:36:03.260461
[0m18:36:03.261493 [debug] [Thread-1 (]: Began executing node test.dbt_idx.assert_customer_dimension_has_no_row_loss.sql
[0m18:36:03.264467 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_idx.assert_customer_dimension_has_no_row_loss.sql"
[0m18:36:03.272026 [debug] [Thread-1 (]: Using postgres connection "test.dbt_idx.assert_customer_dimension_has_no_row_loss.sql"
[0m18:36:03.273017 [debug] [Thread-1 (]: On test.dbt_idx.assert_customer_dimension_has_no_row_loss.sql: BEGIN
[0m18:36:03.274016 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:36:03.312495 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m18:36:03.314495 [debug] [Thread-1 (]: Using postgres connection "test.dbt_idx.assert_customer_dimension_has_no_row_loss.sql"
[0m18:36:03.316574 [debug] [Thread-1 (]: On test.dbt_idx.assert_customer_dimension_has_no_row_loss.sql: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "test.dbt_idx.assert_customer_dimension_has_no_row_loss.sql"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      -- dim_customers must have the same number of rows as its staging counterpart
-- Therefore return records where this isn't true to make the test fail
select *
from (
         select stg_cust.customer_id
         from "IDX-Stock"."warehouse"."stg_eltool__customers" stg_cust
             inner join "IDX-Stock"."warehouse"."dim_customers" dim_cust
         on stg_cust.customer_id = dim_cust.customer_id
         where dim_cust.customer_id is null
     ) tmp
      
    ) dbt_internal_test
[0m18:36:03.323696 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m18:36:03.328234 [debug] [Thread-1 (]: Timing info for test.dbt_idx.assert_customer_dimension_has_no_row_loss.sql (execute): 18:36:03.262486 => 18:36:03.327222
[0m18:36:03.330264 [debug] [Thread-1 (]: On test.dbt_idx.assert_customer_dimension_has_no_row_loss.sql: ROLLBACK
[0m18:36:03.332774 [debug] [Thread-1 (]: On test.dbt_idx.assert_customer_dimension_has_no_row_loss.sql: Close
[0m18:36:03.335870 [info ] [Thread-1 (]: 2 of 9 PASS assert_customer_dimension_has_no_row_loss.sql ...................... [[32mPASS[0m in 0.09s]
[0m18:36:03.344021 [debug] [Thread-1 (]: Finished running node test.dbt_idx.assert_customer_dimension_has_no_row_loss.sql
[0m18:36:03.346038 [debug] [Thread-1 (]: Began running node test.dbt_idx.not_null_customer_orders_status_customer_id.3915c814eb
[0m18:36:03.347036 [info ] [Thread-1 (]: 3 of 9 START test not_null_customer_orders_status_customer_id .................. [RUN]
[0m18:36:03.349564 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_idx.assert_customer_dimension_has_no_row_loss.sql, now test.dbt_idx.not_null_customer_orders_status_customer_id.3915c814eb)
[0m18:36:03.352080 [debug] [Thread-1 (]: Began compiling node test.dbt_idx.not_null_customer_orders_status_customer_id.3915c814eb
[0m18:36:03.371908 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_idx.not_null_customer_orders_status_customer_id.3915c814eb"
[0m18:36:03.384367 [debug] [Thread-1 (]: Timing info for test.dbt_idx.not_null_customer_orders_status_customer_id.3915c814eb (compile): 18:36:03.352618 => 18:36:03.383853
[0m18:36:03.385993 [debug] [Thread-1 (]: Began executing node test.dbt_idx.not_null_customer_orders_status_customer_id.3915c814eb
[0m18:36:03.394944 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_idx.not_null_customer_orders_status_customer_id.3915c814eb"
[0m18:36:03.405595 [debug] [Thread-1 (]: Using postgres connection "test.dbt_idx.not_null_customer_orders_status_customer_id.3915c814eb"
[0m18:36:03.406898 [debug] [Thread-1 (]: On test.dbt_idx.not_null_customer_orders_status_customer_id.3915c814eb: BEGIN
[0m18:36:03.409416 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:36:03.431399 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m18:36:03.432434 [debug] [Thread-1 (]: Using postgres connection "test.dbt_idx.not_null_customer_orders_status_customer_id.3915c814eb"
[0m18:36:03.433396 [debug] [Thread-1 (]: On test.dbt_idx.not_null_customer_orders_status_customer_id.3915c814eb: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "test.dbt_idx.not_null_customer_orders_status_customer_id.3915c814eb"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select customer_id
from "IDX-Stock"."warehouse"."customer_orders_status"
where customer_id is null



      
    ) dbt_internal_test
[0m18:36:03.437931 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m18:36:03.440475 [debug] [Thread-1 (]: Timing info for test.dbt_idx.not_null_customer_orders_status_customer_id.3915c814eb (execute): 18:36:03.387615 => 18:36:03.440475
[0m18:36:03.441486 [debug] [Thread-1 (]: On test.dbt_idx.not_null_customer_orders_status_customer_id.3915c814eb: ROLLBACK
[0m18:36:03.444488 [debug] [Thread-1 (]: On test.dbt_idx.not_null_customer_orders_status_customer_id.3915c814eb: Close
[0m18:36:03.446487 [info ] [Thread-1 (]: 3 of 9 PASS not_null_customer_orders_status_customer_id ........................ [[32mPASS[0m in 0.10s]
[0m18:36:03.448987 [debug] [Thread-1 (]: Finished running node test.dbt_idx.not_null_customer_orders_status_customer_id.3915c814eb
[0m18:36:03.449995 [debug] [Thread-1 (]: Began running node test.dbt_idx.not_null_stg_eltool__customers_snapshots_customer_id.ea4fc4ca86
[0m18:36:03.450997 [info ] [Thread-1 (]: 4 of 9 START test not_null_stg_eltool__customers_snapshots_customer_id ......... [RUN]
[0m18:36:03.453009 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_idx.not_null_customer_orders_status_customer_id.3915c814eb, now test.dbt_idx.not_null_stg_eltool__customers_snapshots_customer_id.ea4fc4ca86)
[0m18:36:03.454019 [debug] [Thread-1 (]: Began compiling node test.dbt_idx.not_null_stg_eltool__customers_snapshots_customer_id.ea4fc4ca86
[0m18:36:03.463065 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_idx.not_null_stg_eltool__customers_snapshots_customer_id.ea4fc4ca86"
[0m18:36:03.470627 [debug] [Thread-1 (]: Timing info for test.dbt_idx.not_null_stg_eltool__customers_snapshots_customer_id.ea4fc4ca86 (compile): 18:36:03.455005 => 18:36:03.470627
[0m18:36:03.471624 [debug] [Thread-1 (]: Began executing node test.dbt_idx.not_null_stg_eltool__customers_snapshots_customer_id.ea4fc4ca86
[0m18:36:03.475657 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_idx.not_null_stg_eltool__customers_snapshots_customer_id.ea4fc4ca86"
[0m18:36:03.483680 [debug] [Thread-1 (]: Using postgres connection "test.dbt_idx.not_null_stg_eltool__customers_snapshots_customer_id.ea4fc4ca86"
[0m18:36:03.484715 [debug] [Thread-1 (]: On test.dbt_idx.not_null_stg_eltool__customers_snapshots_customer_id.ea4fc4ca86: BEGIN
[0m18:36:03.485676 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:36:03.509646 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m18:36:03.511658 [debug] [Thread-1 (]: Using postgres connection "test.dbt_idx.not_null_stg_eltool__customers_snapshots_customer_id.ea4fc4ca86"
[0m18:36:03.511658 [debug] [Thread-1 (]: On test.dbt_idx.not_null_stg_eltool__customers_snapshots_customer_id.ea4fc4ca86: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "test.dbt_idx.not_null_stg_eltool__customers_snapshots_customer_id.ea4fc4ca86"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select customer_id
from "IDX-Stock"."warehouse"."stg_eltool__customers_snapshots"
where customer_id is null



      
    ) dbt_internal_test
[0m18:36:03.515649 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m18:36:03.518199 [debug] [Thread-1 (]: Timing info for test.dbt_idx.not_null_stg_eltool__customers_snapshots_customer_id.ea4fc4ca86 (execute): 18:36:03.472679 => 18:36:03.518199
[0m18:36:03.520207 [debug] [Thread-1 (]: On test.dbt_idx.not_null_stg_eltool__customers_snapshots_customer_id.ea4fc4ca86: ROLLBACK
[0m18:36:03.522256 [debug] [Thread-1 (]: On test.dbt_idx.not_null_stg_eltool__customers_snapshots_customer_id.ea4fc4ca86: Close
[0m18:36:03.525772 [info ] [Thread-1 (]: 4 of 9 PASS not_null_stg_eltool__customers_snapshots_customer_id ............... [[32mPASS[0m in 0.07s]
[0m18:36:03.526780 [debug] [Thread-1 (]: Finished running node test.dbt_idx.not_null_stg_eltool__customers_snapshots_customer_id.ea4fc4ca86
[0m18:36:03.528371 [debug] [Thread-1 (]: Began running node test.dbt_idx.source_not_null_warehouse_customers_customer_id.ae7452c4c6
[0m18:36:03.530297 [info ] [Thread-1 (]: 5 of 9 START test source_not_null_warehouse_customers_customer_id .............. [RUN]
[0m18:36:03.531329 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_idx.not_null_stg_eltool__customers_snapshots_customer_id.ea4fc4ca86, now test.dbt_idx.source_not_null_warehouse_customers_customer_id.ae7452c4c6)
[0m18:36:03.532334 [debug] [Thread-1 (]: Began compiling node test.dbt_idx.source_not_null_warehouse_customers_customer_id.ae7452c4c6
[0m18:36:03.537332 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_idx.source_not_null_warehouse_customers_customer_id.ae7452c4c6"
[0m18:36:03.544311 [debug] [Thread-1 (]: Timing info for test.dbt_idx.source_not_null_warehouse_customers_customer_id.ae7452c4c6 (compile): 18:36:03.533335 => 18:36:03.544311
[0m18:36:03.545335 [debug] [Thread-1 (]: Began executing node test.dbt_idx.source_not_null_warehouse_customers_customer_id.ae7452c4c6
[0m18:36:03.549988 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_idx.source_not_null_warehouse_customers_customer_id.ae7452c4c6"
[0m18:36:03.556954 [debug] [Thread-1 (]: Using postgres connection "test.dbt_idx.source_not_null_warehouse_customers_customer_id.ae7452c4c6"
[0m18:36:03.556954 [debug] [Thread-1 (]: On test.dbt_idx.source_not_null_warehouse_customers_customer_id.ae7452c4c6: BEGIN
[0m18:36:03.558548 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:36:03.582253 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m18:36:03.583217 [debug] [Thread-1 (]: Using postgres connection "test.dbt_idx.source_not_null_warehouse_customers_customer_id.ae7452c4c6"
[0m18:36:03.584219 [debug] [Thread-1 (]: On test.dbt_idx.source_not_null_warehouse_customers_customer_id.ae7452c4c6: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "test.dbt_idx.source_not_null_warehouse_customers_customer_id.ae7452c4c6"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select customer_id
from "IDX-Stock"."warehouse"."customers"
where customer_id is null



      
    ) dbt_internal_test
[0m18:36:03.587232 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m18:36:03.589681 [debug] [Thread-1 (]: Timing info for test.dbt_idx.source_not_null_warehouse_customers_customer_id.ae7452c4c6 (execute): 18:36:03.546351 => 18:36:03.589681
[0m18:36:03.590636 [debug] [Thread-1 (]: On test.dbt_idx.source_not_null_warehouse_customers_customer_id.ae7452c4c6: ROLLBACK
[0m18:36:03.593233 [debug] [Thread-1 (]: On test.dbt_idx.source_not_null_warehouse_customers_customer_id.ae7452c4c6: Close
[0m18:36:03.595265 [info ] [Thread-1 (]: 5 of 9 PASS source_not_null_warehouse_customers_customer_id .................... [[32mPASS[0m in 0.06s]
[0m18:36:03.598243 [debug] [Thread-1 (]: Finished running node test.dbt_idx.source_not_null_warehouse_customers_customer_id.ae7452c4c6
[0m18:36:03.599790 [debug] [Thread-1 (]: Began running node test.dbt_idx.source_not_null_warehouse_orders_order_id.c85a1f0b76
[0m18:36:03.600759 [info ] [Thread-1 (]: 6 of 9 START test source_not_null_warehouse_orders_order_id .................... [RUN]
[0m18:36:03.602758 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_idx.source_not_null_warehouse_customers_customer_id.ae7452c4c6, now test.dbt_idx.source_not_null_warehouse_orders_order_id.c85a1f0b76)
[0m18:36:03.603773 [debug] [Thread-1 (]: Began compiling node test.dbt_idx.source_not_null_warehouse_orders_order_id.c85a1f0b76
[0m18:36:03.609275 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_idx.source_not_null_warehouse_orders_order_id.c85a1f0b76"
[0m18:36:03.616860 [debug] [Thread-1 (]: Timing info for test.dbt_idx.source_not_null_warehouse_orders_order_id.c85a1f0b76 (compile): 18:36:03.603773 => 18:36:03.615803
[0m18:36:03.616860 [debug] [Thread-1 (]: Began executing node test.dbt_idx.source_not_null_warehouse_orders_order_id.c85a1f0b76
[0m18:36:03.621406 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_idx.source_not_null_warehouse_orders_order_id.c85a1f0b76"
[0m18:36:03.627452 [debug] [Thread-1 (]: Using postgres connection "test.dbt_idx.source_not_null_warehouse_orders_order_id.c85a1f0b76"
[0m18:36:03.628912 [debug] [Thread-1 (]: On test.dbt_idx.source_not_null_warehouse_orders_order_id.c85a1f0b76: BEGIN
[0m18:36:03.629922 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:36:03.652538 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m18:36:03.653539 [debug] [Thread-1 (]: Using postgres connection "test.dbt_idx.source_not_null_warehouse_orders_order_id.c85a1f0b76"
[0m18:36:03.655058 [debug] [Thread-1 (]: On test.dbt_idx.source_not_null_warehouse_orders_order_id.c85a1f0b76: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "test.dbt_idx.source_not_null_warehouse_orders_order_id.c85a1f0b76"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select order_id
from "IDX-Stock"."warehouse"."orders"
where order_id is null



      
    ) dbt_internal_test
[0m18:36:03.657100 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m18:36:03.660663 [debug] [Thread-1 (]: Timing info for test.dbt_idx.source_not_null_warehouse_orders_order_id.c85a1f0b76 (execute): 18:36:03.618457 => 18:36:03.659623
[0m18:36:03.661624 [debug] [Thread-1 (]: On test.dbt_idx.source_not_null_warehouse_orders_order_id.c85a1f0b76: ROLLBACK
[0m18:36:03.663625 [debug] [Thread-1 (]: On test.dbt_idx.source_not_null_warehouse_orders_order_id.c85a1f0b76: Close
[0m18:36:03.665626 [info ] [Thread-1 (]: 6 of 9 PASS source_not_null_warehouse_orders_order_id .......................... [[32mPASS[0m in 0.06s]
[0m18:36:03.668151 [debug] [Thread-1 (]: Finished running node test.dbt_idx.source_not_null_warehouse_orders_order_id.c85a1f0b76
[0m18:36:03.669158 [debug] [Thread-1 (]: Began running node test.dbt_idx.source_relationships_warehouse_orders_cust_id__customer_id__source_warehouse_customers_.d3f9188fc2
[0m18:36:03.670167 [info ] [Thread-1 (]: 7 of 9 START test source_relationships_warehouse_orders_cust_id__customer_id__source_warehouse_customers_  [RUN]
[0m18:36:03.672206 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_idx.source_not_null_warehouse_orders_order_id.c85a1f0b76, now test.dbt_idx.source_relationships_warehouse_orders_cust_id__customer_id__source_warehouse_customers_.d3f9188fc2)
[0m18:36:03.672206 [debug] [Thread-1 (]: Began compiling node test.dbt_idx.source_relationships_warehouse_orders_cust_id__customer_id__source_warehouse_customers_.d3f9188fc2
[0m18:36:03.684070 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_idx.source_relationships_warehouse_orders_cust_id__customer_id__source_warehouse_customers_.d3f9188fc2"
[0m18:36:03.691612 [debug] [Thread-1 (]: Timing info for test.dbt_idx.source_relationships_warehouse_orders_cust_id__customer_id__source_warehouse_customers_.d3f9188fc2 (compile): 18:36:03.673218 => 18:36:03.690634
[0m18:36:03.691612 [debug] [Thread-1 (]: Began executing node test.dbt_idx.source_relationships_warehouse_orders_cust_id__customer_id__source_warehouse_customers_.d3f9188fc2
[0m18:36:03.696163 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_idx.source_relationships_warehouse_orders_cust_id__customer_id__source_warehouse_customers_.d3f9188fc2"
[0m18:36:03.704718 [debug] [Thread-1 (]: Using postgres connection "test.dbt_idx.source_relationships_warehouse_orders_cust_id__customer_id__source_warehouse_customers_.d3f9188fc2"
[0m18:36:03.705721 [debug] [Thread-1 (]: On test.dbt_idx.source_relationships_warehouse_orders_cust_id__customer_id__source_warehouse_customers_.d3f9188fc2: BEGIN
[0m18:36:03.706719 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:36:03.733257 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m18:36:03.733257 [debug] [Thread-1 (]: Using postgres connection "test.dbt_idx.source_relationships_warehouse_orders_cust_id__customer_id__source_warehouse_customers_.d3f9188fc2"
[0m18:36:03.734762 [debug] [Thread-1 (]: On test.dbt_idx.source_relationships_warehouse_orders_cust_id__customer_id__source_warehouse_customers_.d3f9188fc2: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "test.dbt_idx.source_relationships_warehouse_orders_cust_id__customer_id__source_warehouse_customers_.d3f9188fc2"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select cust_id as from_field
    from "IDX-Stock"."warehouse"."orders"
    where cust_id is not null
),

parent as (
    select customer_id as to_field
    from "IDX-Stock"."warehouse"."customers"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m18:36:03.738343 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m18:36:03.741381 [debug] [Thread-1 (]: Timing info for test.dbt_idx.source_relationships_warehouse_orders_cust_id__customer_id__source_warehouse_customers_.d3f9188fc2 (execute): 18:36:03.693235 => 18:36:03.740350
[0m18:36:03.742349 [debug] [Thread-1 (]: On test.dbt_idx.source_relationships_warehouse_orders_cust_id__customer_id__source_warehouse_customers_.d3f9188fc2: ROLLBACK
[0m18:36:03.744349 [debug] [Thread-1 (]: On test.dbt_idx.source_relationships_warehouse_orders_cust_id__customer_id__source_warehouse_customers_.d3f9188fc2: Close
[0m18:36:03.746348 [info ] [Thread-1 (]: 7 of 9 PASS source_relationships_warehouse_orders_cust_id__customer_id__source_warehouse_customers_  [[32mPASS[0m in 0.08s]
[0m18:36:03.748351 [debug] [Thread-1 (]: Finished running node test.dbt_idx.source_relationships_warehouse_orders_cust_id__customer_id__source_warehouse_customers_.d3f9188fc2
[0m18:36:03.749599 [debug] [Thread-1 (]: Began running node test.dbt_idx.source_unique_warehouse_orders_order_id.839fb43d0f
[0m18:36:03.750570 [info ] [Thread-1 (]: 8 of 9 START test source_unique_warehouse_orders_order_id ...................... [RUN]
[0m18:36:03.751570 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_idx.source_relationships_warehouse_orders_cust_id__customer_id__source_warehouse_customers_.d3f9188fc2, now test.dbt_idx.source_unique_warehouse_orders_order_id.839fb43d0f)
[0m18:36:03.753096 [debug] [Thread-1 (]: Began compiling node test.dbt_idx.source_unique_warehouse_orders_order_id.839fb43d0f
[0m18:36:03.763299 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_idx.source_unique_warehouse_orders_order_id.839fb43d0f"
[0m18:36:03.771546 [debug] [Thread-1 (]: Timing info for test.dbt_idx.source_unique_warehouse_orders_order_id.839fb43d0f (compile): 18:36:03.754122 => 18:36:03.771546
[0m18:36:03.772545 [debug] [Thread-1 (]: Began executing node test.dbt_idx.source_unique_warehouse_orders_order_id.839fb43d0f
[0m18:36:03.776100 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_idx.source_unique_warehouse_orders_order_id.839fb43d0f"
[0m18:36:03.784671 [debug] [Thread-1 (]: Using postgres connection "test.dbt_idx.source_unique_warehouse_orders_order_id.839fb43d0f"
[0m18:36:03.788174 [debug] [Thread-1 (]: On test.dbt_idx.source_unique_warehouse_orders_order_id.839fb43d0f: BEGIN
[0m18:36:03.789183 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:36:03.812397 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m18:36:03.813381 [debug] [Thread-1 (]: Using postgres connection "test.dbt_idx.source_unique_warehouse_orders_order_id.839fb43d0f"
[0m18:36:03.814382 [debug] [Thread-1 (]: On test.dbt_idx.source_unique_warehouse_orders_order_id.839fb43d0f: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "test.dbt_idx.source_unique_warehouse_orders_order_id.839fb43d0f"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    order_id as unique_field,
    count(*) as n_records

from "IDX-Stock"."warehouse"."orders"
where order_id is not null
group by order_id
having count(*) > 1



      
    ) dbt_internal_test
[0m18:36:03.818383 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m18:36:03.819905 [debug] [Thread-1 (]: Timing info for test.dbt_idx.source_unique_warehouse_orders_order_id.839fb43d0f (execute): 18:36:03.772545 => 18:36:03.819905
[0m18:36:03.820915 [debug] [Thread-1 (]: On test.dbt_idx.source_unique_warehouse_orders_order_id.839fb43d0f: ROLLBACK
[0m18:36:03.822917 [debug] [Thread-1 (]: On test.dbt_idx.source_unique_warehouse_orders_order_id.839fb43d0f: Close
[0m18:36:03.825916 [info ] [Thread-1 (]: 8 of 9 PASS source_unique_warehouse_orders_order_id ............................ [[32mPASS[0m in 0.07s]
[0m18:36:03.826913 [debug] [Thread-1 (]: Finished running node test.dbt_idx.source_unique_warehouse_orders_order_id.839fb43d0f
[0m18:36:03.828439 [debug] [Thread-1 (]: Began running node test.dbt_idx.unique_customer_orders_status_order_id.b7a45e83ee
[0m18:36:03.829446 [info ] [Thread-1 (]: 9 of 9 START test unique_customer_orders_status_order_id ....................... [RUN]
[0m18:36:03.831447 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_idx.source_unique_warehouse_orders_order_id.839fb43d0f, now test.dbt_idx.unique_customer_orders_status_order_id.b7a45e83ee)
[0m18:36:03.831447 [debug] [Thread-1 (]: Began compiling node test.dbt_idx.unique_customer_orders_status_order_id.b7a45e83ee
[0m18:36:03.837616 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_idx.unique_customer_orders_status_order_id.b7a45e83ee"
[0m18:36:03.845131 [debug] [Thread-1 (]: Timing info for test.dbt_idx.unique_customer_orders_status_order_id.b7a45e83ee (compile): 18:36:03.832562 => 18:36:03.845131
[0m18:36:03.846174 [debug] [Thread-1 (]: Began executing node test.dbt_idx.unique_customer_orders_status_order_id.b7a45e83ee
[0m18:36:03.851248 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_idx.unique_customer_orders_status_order_id.b7a45e83ee"
[0m18:36:03.858777 [debug] [Thread-1 (]: Using postgres connection "test.dbt_idx.unique_customer_orders_status_order_id.b7a45e83ee"
[0m18:36:03.860786 [debug] [Thread-1 (]: On test.dbt_idx.unique_customer_orders_status_order_id.b7a45e83ee: BEGIN
[0m18:36:03.861791 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:36:03.889501 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m18:36:03.891034 [debug] [Thread-1 (]: Using postgres connection "test.dbt_idx.unique_customer_orders_status_order_id.b7a45e83ee"
[0m18:36:03.892580 [debug] [Thread-1 (]: On test.dbt_idx.unique_customer_orders_status_order_id.b7a45e83ee: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "test.dbt_idx.unique_customer_orders_status_order_id.b7a45e83ee"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    order_id as unique_field,
    count(*) as n_records

from "IDX-Stock"."warehouse"."customer_orders_status"
where order_id is not null
group by order_id
having count(*) > 1



      
    ) dbt_internal_test
[0m18:36:03.897124 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m18:36:03.900650 [debug] [Thread-1 (]: Timing info for test.dbt_idx.unique_customer_orders_status_order_id.b7a45e83ee (execute): 18:36:03.847166 => 18:36:03.900650
[0m18:36:03.901662 [debug] [Thread-1 (]: On test.dbt_idx.unique_customer_orders_status_order_id.b7a45e83ee: ROLLBACK
[0m18:36:03.904665 [debug] [Thread-1 (]: On test.dbt_idx.unique_customer_orders_status_order_id.b7a45e83ee: Close
[0m18:36:03.906665 [info ] [Thread-1 (]: 9 of 9 PASS unique_customer_orders_status_order_id ............................. [[32mPASS[0m in 0.08s]
[0m18:36:03.909196 [debug] [Thread-1 (]: Finished running node test.dbt_idx.unique_customer_orders_status_order_id.b7a45e83ee
[0m18:36:03.913227 [debug] [MainThread]: Using postgres connection "master"
[0m18:36:03.914251 [debug] [MainThread]: On master: BEGIN
[0m18:36:03.915226 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:36:03.937430 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m18:36:03.938431 [debug] [MainThread]: On master: COMMIT
[0m18:36:03.939598 [debug] [MainThread]: Using postgres connection "master"
[0m18:36:03.940618 [debug] [MainThread]: On master: COMMIT
[0m18:36:03.942610 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m18:36:03.943607 [debug] [MainThread]: On master: Close
[0m18:36:03.945608 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:36:03.947606 [debug] [MainThread]: Connection 'list_IDX-Stock_warehouse' was properly closed.
[0m18:36:03.948606 [debug] [MainThread]: Connection 'test.dbt_idx.unique_customer_orders_status_order_id.b7a45e83ee' was properly closed.
[0m18:36:03.950130 [info ] [MainThread]: 
[0m18:36:03.951138 [info ] [MainThread]: Finished running 9 tests in 0 hours 0 minutes and 1.01 seconds (1.01s).
[0m18:36:03.954136 [debug] [MainThread]: Command end result
[0m18:36:03.978297 [info ] [MainThread]: 
[0m18:36:03.980247 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:36:03.982254 [info ] [MainThread]: 
[0m18:36:03.984255 [info ] [MainThread]: Done. PASS=9 WARN=0 ERROR=0 SKIP=0 TOTAL=9
[0m18:36:03.985253 [debug] [MainThread]: Command `dbt test` succeeded at 18:36:03.985253 after 1.47 seconds
[0m18:36:03.987262 [debug] [MainThread]: Flushing usage events


============================== 18:39:15.367768 | d5610f05-9243-47d0-a2bf-a577785a1f20 ==============================
[0m18:39:15.367768 [info ] [MainThread]: Running with dbt=1.6.1
[0m18:39:15.376345 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': 'D:\\00 Project\\00 My Project\\IdeaProjects\\Py-DBT-IDX', 'log_path': 'D:\\00 Project\\00 My Project\\IdeaProjects\\Py-DBT-IDX\\logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt test', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'False'}
[0m18:39:15.577980 [info ] [MainThread]: Registered adapter: postgres=1.6.1
[0m18:39:15.593019 [debug] [MainThread]: checksum: efe19d9f5b93d1a98cc804fbfcdb6b3aced98b974af664946fee1cde8837deb7, vars: {}, profile: , target: , version: 1.6.1
[0m18:39:15.793838 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m18:39:15.794839 [debug] [MainThread]: Partial parsing: updated file: dbt_idx://tests\assert_customer_dimension_has_no_row_loss.sql.sql
[0m18:39:15.893024 [info ] [MainThread]: Found 1 snapshot, 9 tests, 7 models, 3 sources, 0 exposures, 0 metrics, 349 macros, 0 groups, 0 semantic models
[0m18:39:15.899056 [info ] [MainThread]: 
[0m18:39:15.901058 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m18:39:15.905056 [debug] [ThreadPool]: Acquiring new postgres connection 'list_IDX-Stock_warehouse'
[0m18:39:15.925943 [debug] [ThreadPool]: Using postgres connection "list_IDX-Stock_warehouse"
[0m18:39:15.926938 [debug] [ThreadPool]: On list_IDX-Stock_warehouse: BEGIN
[0m18:39:15.927940 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:39:15.973425 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m18:39:15.974454 [debug] [ThreadPool]: Using postgres connection "list_IDX-Stock_warehouse"
[0m18:39:15.975423 [debug] [ThreadPool]: On list_IDX-Stock_warehouse: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "connection_name": "list_IDX-Stock_warehouse"} */
select
      'IDX-Stock' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'warehouse'
    union all
    select
      'IDX-Stock' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'warehouse'
    union all
    select
      'IDX-Stock' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'warehouse'
  
[0m18:39:15.982953 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.0 seconds
[0m18:39:15.985471 [debug] [ThreadPool]: On list_IDX-Stock_warehouse: ROLLBACK
[0m18:39:15.989005 [debug] [ThreadPool]: On list_IDX-Stock_warehouse: Close
[0m18:39:15.992007 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_IDX-Stock_warehouse, now list_IDX-Stock_snapshots)
[0m18:39:16.001521 [debug] [ThreadPool]: Using postgres connection "list_IDX-Stock_snapshots"
[0m18:39:16.002528 [debug] [ThreadPool]: On list_IDX-Stock_snapshots: BEGIN
[0m18:39:16.003531 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:39:16.026156 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m18:39:16.027776 [debug] [ThreadPool]: Using postgres connection "list_IDX-Stock_snapshots"
[0m18:39:16.028685 [debug] [ThreadPool]: On list_IDX-Stock_snapshots: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "connection_name": "list_IDX-Stock_snapshots"} */
select
      'IDX-Stock' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'snapshots'
    union all
    select
      'IDX-Stock' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'snapshots'
    union all
    select
      'IDX-Stock' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'snapshots'
  
[0m18:39:16.033704 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.0 seconds
[0m18:39:16.035697 [debug] [ThreadPool]: On list_IDX-Stock_snapshots: ROLLBACK
[0m18:39:16.038210 [debug] [ThreadPool]: On list_IDX-Stock_snapshots: Close
[0m18:39:16.045750 [debug] [MainThread]: Using postgres connection "master"
[0m18:39:16.045750 [debug] [MainThread]: On master: BEGIN
[0m18:39:16.046751 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:39:16.071886 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m18:39:16.072887 [debug] [MainThread]: Using postgres connection "master"
[0m18:39:16.072887 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m18:39:16.081477 [debug] [MainThread]: SQL status: SELECT 6 in 0.0 seconds
[0m18:39:16.086521 [debug] [MainThread]: On master: ROLLBACK
[0m18:39:16.088052 [debug] [MainThread]: Using postgres connection "master"
[0m18:39:16.090067 [debug] [MainThread]: On master: BEGIN
[0m18:39:16.093064 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m18:39:16.094063 [debug] [MainThread]: On master: COMMIT
[0m18:39:16.095068 [debug] [MainThread]: Using postgres connection "master"
[0m18:39:16.096581 [debug] [MainThread]: On master: COMMIT
[0m18:39:16.098108 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m18:39:16.099123 [debug] [MainThread]: On master: Close
[0m18:39:16.101115 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:39:16.102126 [info ] [MainThread]: 
[0m18:39:16.107628 [debug] [Thread-1 (]: Began running node test.dbt_idx.accepted_values_customer_orders_status_order_status__delivered__invoiced__shipped__processing__canceled__unavailable.ea8c296d27
[0m18:39:16.109639 [info ] [Thread-1 (]: 1 of 9 START test accepted_values_customer_orders_status_order_status__delivered__invoiced__shipped__processing__canceled__unavailable  [RUN]
[0m18:39:16.110635 [debug] [Thread-1 (]: Acquiring new postgres connection 'test.dbt_idx.accepted_values_customer_orders_status_order_status__delivered__invoiced__shipped__processing__canceled__unavailable.ea8c296d27'
[0m18:39:16.111636 [debug] [Thread-1 (]: Began compiling node test.dbt_idx.accepted_values_customer_orders_status_order_status__delivered__invoiced__shipped__processing__canceled__unavailable.ea8c296d27
[0m18:39:16.136242 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_idx.accepted_values_customer_orders_status_order_status__delivered__invoiced__shipped__processing__canceled__unavailable.ea8c296d27"
[0m18:39:16.142797 [debug] [Thread-1 (]: Timing info for test.dbt_idx.accepted_values_customer_orders_status_order_status__delivered__invoiced__shipped__processing__canceled__unavailable.ea8c296d27 (compile): 18:39:16.112634 => 18:39:16.142797
[0m18:39:16.143768 [debug] [Thread-1 (]: Began executing node test.dbt_idx.accepted_values_customer_orders_status_order_status__delivered__invoiced__shipped__processing__canceled__unavailable.ea8c296d27
[0m18:39:16.163859 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_idx.accepted_values_customer_orders_status_order_status__delivered__invoiced__shipped__processing__canceled__unavailable.ea8c296d27"
[0m18:39:16.174079 [debug] [Thread-1 (]: Using postgres connection "test.dbt_idx.accepted_values_customer_orders_status_order_status__delivered__invoiced__shipped__processing__canceled__unavailable.ea8c296d27"
[0m18:39:16.175593 [debug] [Thread-1 (]: On test.dbt_idx.accepted_values_customer_orders_status_order_status__delivered__invoiced__shipped__processing__canceled__unavailable.ea8c296d27: BEGIN
[0m18:39:16.176595 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m18:39:16.199205 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m18:39:16.201203 [debug] [Thread-1 (]: Using postgres connection "test.dbt_idx.accepted_values_customer_orders_status_order_status__delivered__invoiced__shipped__processing__canceled__unavailable.ea8c296d27"
[0m18:39:16.201203 [debug] [Thread-1 (]: On test.dbt_idx.accepted_values_customer_orders_status_order_status__delivered__invoiced__shipped__processing__canceled__unavailable.ea8c296d27: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "test.dbt_idx.accepted_values_customer_orders_status_order_status__delivered__invoiced__shipped__processing__canceled__unavailable.ea8c296d27"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        order_status as value_field,
        count(*) as n_records

    from "IDX-Stock"."warehouse"."customer_orders_status"
    group by order_status

)

select *
from all_values
where value_field not in (
    'delivered','invoiced','shipped','processing','canceled','unavailable'
)



      
    ) dbt_internal_test
[0m18:39:16.206206 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m18:39:16.209245 [debug] [Thread-1 (]: Timing info for test.dbt_idx.accepted_values_customer_orders_status_order_status__delivered__invoiced__shipped__processing__canceled__unavailable.ea8c296d27 (execute): 18:39:16.144768 => 18:39:16.209245
[0m18:39:16.210283 [debug] [Thread-1 (]: On test.dbt_idx.accepted_values_customer_orders_status_order_status__delivered__invoiced__shipped__processing__canceled__unavailable.ea8c296d27: ROLLBACK
[0m18:39:16.212249 [debug] [Thread-1 (]: On test.dbt_idx.accepted_values_customer_orders_status_order_status__delivered__invoiced__shipped__processing__canceled__unavailable.ea8c296d27: Close
[0m18:39:16.214774 [info ] [Thread-1 (]: 1 of 9 PASS accepted_values_customer_orders_status_order_status__delivered__invoiced__shipped__processing__canceled__unavailable  [[32mPASS[0m in 0.10s]
[0m18:39:16.217775 [debug] [Thread-1 (]: Finished running node test.dbt_idx.accepted_values_customer_orders_status_order_status__delivered__invoiced__shipped__processing__canceled__unavailable.ea8c296d27
[0m18:39:16.220987 [debug] [Thread-1 (]: Began running node test.dbt_idx.assert_customer_dimension_has_no_row_loss.sql
[0m18:39:16.222989 [info ] [Thread-1 (]: 2 of 9 START test assert_customer_dimension_has_no_row_loss.sql ................ [RUN]
[0m18:39:16.224011 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_idx.accepted_values_customer_orders_status_order_status__delivered__invoiced__shipped__processing__canceled__unavailable.ea8c296d27, now test.dbt_idx.assert_customer_dimension_has_no_row_loss.sql)
[0m18:39:16.225531 [debug] [Thread-1 (]: Began compiling node test.dbt_idx.assert_customer_dimension_has_no_row_loss.sql
[0m18:39:16.230071 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_idx.assert_customer_dimension_has_no_row_loss.sql"
[0m18:39:16.238121 [debug] [Thread-1 (]: Timing info for test.dbt_idx.assert_customer_dimension_has_no_row_loss.sql (compile): 18:39:16.225531 => 18:39:16.237610
[0m18:39:16.239135 [debug] [Thread-1 (]: Began executing node test.dbt_idx.assert_customer_dimension_has_no_row_loss.sql
[0m18:39:16.242150 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_idx.assert_customer_dimension_has_no_row_loss.sql"
[0m18:39:16.250262 [debug] [Thread-1 (]: Using postgres connection "test.dbt_idx.assert_customer_dimension_has_no_row_loss.sql"
[0m18:39:16.251263 [debug] [Thread-1 (]: On test.dbt_idx.assert_customer_dimension_has_no_row_loss.sql: BEGIN
[0m18:39:16.252289 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:39:16.278427 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m18:39:16.279440 [debug] [Thread-1 (]: Using postgres connection "test.dbt_idx.assert_customer_dimension_has_no_row_loss.sql"
[0m18:39:16.281451 [debug] [Thread-1 (]: On test.dbt_idx.assert_customer_dimension_has_no_row_loss.sql: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "test.dbt_idx.assert_customer_dimension_has_no_row_loss.sql"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      -- dim_customers must have the same number of rows as its staging counterpart
-- Therefore return records where this isn't true to make the test fail
select *
from (
         select dim_cust.customer_id
         from "IDX-Stock"."warehouse"."dim_customers" dim_cust
            left join "IDX-Stock"."warehouse"."stg_eltool__customers" stg_cust on dim_cust.customer_id = stg_cust.customer_id
         where stg_cust.customer_id is null
         UNION ALL
         select stg_cust.customer_id
         from "IDX-Stock"."warehouse"."stg_eltool__customers" stg_cust
             left join "IDX-Stock"."warehouse"."dim_customers" dim_cust on stg_cust.customer_id = dim_cust.customer_id
         where dim_cust.customer_id is null
     ) tmp
      
    ) dbt_internal_test
[0m18:39:16.285995 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m18:39:16.288518 [debug] [Thread-1 (]: Timing info for test.dbt_idx.assert_customer_dimension_has_no_row_loss.sql (execute): 18:39:16.240151 => 18:39:16.288518
[0m18:39:16.290528 [debug] [Thread-1 (]: On test.dbt_idx.assert_customer_dimension_has_no_row_loss.sql: ROLLBACK
[0m18:39:16.293517 [debug] [Thread-1 (]: On test.dbt_idx.assert_customer_dimension_has_no_row_loss.sql: Close
[0m18:39:16.295564 [error] [Thread-1 (]: 2 of 9 FAIL 105 assert_customer_dimension_has_no_row_loss.sql .................. [[31mFAIL 105[0m in 0.07s]
[0m18:39:16.298802 [debug] [Thread-1 (]: Finished running node test.dbt_idx.assert_customer_dimension_has_no_row_loss.sql
[0m18:39:16.300864 [debug] [Thread-1 (]: Began running node test.dbt_idx.not_null_customer_orders_status_customer_id.3915c814eb
[0m18:39:16.301874 [info ] [Thread-1 (]: 3 of 9 START test not_null_customer_orders_status_customer_id .................. [RUN]
[0m18:39:16.304872 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_idx.assert_customer_dimension_has_no_row_loss.sql, now test.dbt_idx.not_null_customer_orders_status_customer_id.3915c814eb)
[0m18:39:16.305887 [debug] [Thread-1 (]: Began compiling node test.dbt_idx.not_null_customer_orders_status_customer_id.3915c814eb
[0m18:39:16.323173 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_idx.not_null_customer_orders_status_customer_id.3915c814eb"
[0m18:39:16.333715 [debug] [Thread-1 (]: Timing info for test.dbt_idx.not_null_customer_orders_status_customer_id.3915c814eb (compile): 18:39:16.306872 => 18:39:16.333715
[0m18:39:16.335230 [debug] [Thread-1 (]: Began executing node test.dbt_idx.not_null_customer_orders_status_customer_id.3915c814eb
[0m18:39:16.341352 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_idx.not_null_customer_orders_status_customer_id.3915c814eb"
[0m18:39:16.350889 [debug] [Thread-1 (]: Using postgres connection "test.dbt_idx.not_null_customer_orders_status_customer_id.3915c814eb"
[0m18:39:16.351894 [debug] [Thread-1 (]: On test.dbt_idx.not_null_customer_orders_status_customer_id.3915c814eb: BEGIN
[0m18:39:16.353409 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:39:16.379193 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m18:39:16.380690 [debug] [Thread-1 (]: Using postgres connection "test.dbt_idx.not_null_customer_orders_status_customer_id.3915c814eb"
[0m18:39:16.381710 [debug] [Thread-1 (]: On test.dbt_idx.not_null_customer_orders_status_customer_id.3915c814eb: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "test.dbt_idx.not_null_customer_orders_status_customer_id.3915c814eb"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select customer_id
from "IDX-Stock"."warehouse"."customer_orders_status"
where customer_id is null



      
    ) dbt_internal_test
[0m18:39:16.385708 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m18:39:16.389253 [debug] [Thread-1 (]: Timing info for test.dbt_idx.not_null_customer_orders_status_customer_id.3915c814eb (execute): 18:39:16.336240 => 18:39:16.389253
[0m18:39:16.390272 [debug] [Thread-1 (]: On test.dbt_idx.not_null_customer_orders_status_customer_id.3915c814eb: ROLLBACK
[0m18:39:16.392833 [debug] [Thread-1 (]: On test.dbt_idx.not_null_customer_orders_status_customer_id.3915c814eb: Close
[0m18:39:16.395350 [info ] [Thread-1 (]: 3 of 9 PASS not_null_customer_orders_status_customer_id ........................ [[32mPASS[0m in 0.09s]
[0m18:39:16.397887 [debug] [Thread-1 (]: Finished running node test.dbt_idx.not_null_customer_orders_status_customer_id.3915c814eb
[0m18:39:16.399934 [debug] [Thread-1 (]: Began running node test.dbt_idx.not_null_stg_eltool__customers_snapshots_customer_id.ea4fc4ca86
[0m18:39:16.401917 [info ] [Thread-1 (]: 4 of 9 START test not_null_stg_eltool__customers_snapshots_customer_id ......... [RUN]
[0m18:39:16.404917 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_idx.not_null_customer_orders_status_customer_id.3915c814eb, now test.dbt_idx.not_null_stg_eltool__customers_snapshots_customer_id.ea4fc4ca86)
[0m18:39:16.406918 [debug] [Thread-1 (]: Began compiling node test.dbt_idx.not_null_stg_eltool__customers_snapshots_customer_id.ea4fc4ca86
[0m18:39:16.413212 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_idx.not_null_stg_eltool__customers_snapshots_customer_id.ea4fc4ca86"
[0m18:39:16.422222 [debug] [Thread-1 (]: Timing info for test.dbt_idx.not_null_stg_eltool__customers_snapshots_customer_id.ea4fc4ca86 (compile): 18:39:16.408201 => 18:39:16.421218
[0m18:39:16.424222 [debug] [Thread-1 (]: Began executing node test.dbt_idx.not_null_stg_eltool__customers_snapshots_customer_id.ea4fc4ca86
[0m18:39:16.435328 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_idx.not_null_stg_eltool__customers_snapshots_customer_id.ea4fc4ca86"
[0m18:39:16.446889 [debug] [Thread-1 (]: Using postgres connection "test.dbt_idx.not_null_stg_eltool__customers_snapshots_customer_id.ea4fc4ca86"
[0m18:39:16.447902 [debug] [Thread-1 (]: On test.dbt_idx.not_null_stg_eltool__customers_snapshots_customer_id.ea4fc4ca86: BEGIN
[0m18:39:16.450440 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:39:16.478798 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m18:39:16.480815 [debug] [Thread-1 (]: Using postgres connection "test.dbt_idx.not_null_stg_eltool__customers_snapshots_customer_id.ea4fc4ca86"
[0m18:39:16.481814 [debug] [Thread-1 (]: On test.dbt_idx.not_null_stg_eltool__customers_snapshots_customer_id.ea4fc4ca86: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "test.dbt_idx.not_null_stg_eltool__customers_snapshots_customer_id.ea4fc4ca86"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select customer_id
from "IDX-Stock"."warehouse"."stg_eltool__customers_snapshots"
where customer_id is null



      
    ) dbt_internal_test
[0m18:39:16.485811 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m18:39:16.488327 [debug] [Thread-1 (]: Timing info for test.dbt_idx.not_null_stg_eltool__customers_snapshots_customer_id.ea4fc4ca86 (execute): 18:39:16.425760 => 18:39:16.488327
[0m18:39:16.490351 [debug] [Thread-1 (]: On test.dbt_idx.not_null_stg_eltool__customers_snapshots_customer_id.ea4fc4ca86: ROLLBACK
[0m18:39:16.492354 [debug] [Thread-1 (]: On test.dbt_idx.not_null_stg_eltool__customers_snapshots_customer_id.ea4fc4ca86: Close
[0m18:39:16.495577 [info ] [Thread-1 (]: 4 of 9 PASS not_null_stg_eltool__customers_snapshots_customer_id ............... [[32mPASS[0m in 0.09s]
[0m18:39:16.498084 [debug] [Thread-1 (]: Finished running node test.dbt_idx.not_null_stg_eltool__customers_snapshots_customer_id.ea4fc4ca86
[0m18:39:16.499097 [debug] [Thread-1 (]: Began running node test.dbt_idx.source_not_null_warehouse_customers_customer_id.ae7452c4c6
[0m18:39:16.501118 [info ] [Thread-1 (]: 5 of 9 START test source_not_null_warehouse_customers_customer_id .............. [RUN]
[0m18:39:16.502108 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_idx.not_null_stg_eltool__customers_snapshots_customer_id.ea4fc4ca86, now test.dbt_idx.source_not_null_warehouse_customers_customer_id.ae7452c4c6)
[0m18:39:16.503621 [debug] [Thread-1 (]: Began compiling node test.dbt_idx.source_not_null_warehouse_customers_customer_id.ae7452c4c6
[0m18:39:16.513232 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_idx.source_not_null_warehouse_customers_customer_id.ae7452c4c6"
[0m18:39:16.522423 [debug] [Thread-1 (]: Timing info for test.dbt_idx.source_not_null_warehouse_customers_customer_id.ae7452c4c6 (compile): 18:39:16.505146 => 18:39:16.520909
[0m18:39:16.523441 [debug] [Thread-1 (]: Began executing node test.dbt_idx.source_not_null_warehouse_customers_customer_id.ae7452c4c6
[0m18:39:16.527468 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_idx.source_not_null_warehouse_customers_customer_id.ae7452c4c6"
[0m18:39:16.536052 [debug] [Thread-1 (]: Using postgres connection "test.dbt_idx.source_not_null_warehouse_customers_customer_id.ae7452c4c6"
[0m18:39:16.538962 [debug] [Thread-1 (]: On test.dbt_idx.source_not_null_warehouse_customers_customer_id.ae7452c4c6: BEGIN
[0m18:39:16.541498 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:39:16.565421 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m18:39:16.566437 [debug] [Thread-1 (]: Using postgres connection "test.dbt_idx.source_not_null_warehouse_customers_customer_id.ae7452c4c6"
[0m18:39:16.568966 [debug] [Thread-1 (]: On test.dbt_idx.source_not_null_warehouse_customers_customer_id.ae7452c4c6: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "test.dbt_idx.source_not_null_warehouse_customers_customer_id.ae7452c4c6"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select customer_id
from "IDX-Stock"."warehouse"."customers"
where customer_id is null



      
    ) dbt_internal_test
[0m18:39:16.571487 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m18:39:16.574501 [debug] [Thread-1 (]: Timing info for test.dbt_idx.source_not_null_warehouse_customers_customer_id.ae7452c4c6 (execute): 18:39:16.523441 => 18:39:16.574501
[0m18:39:16.575503 [debug] [Thread-1 (]: On test.dbt_idx.source_not_null_warehouse_customers_customer_id.ae7452c4c6: ROLLBACK
[0m18:39:16.578010 [debug] [Thread-1 (]: On test.dbt_idx.source_not_null_warehouse_customers_customer_id.ae7452c4c6: Close
[0m18:39:16.579533 [info ] [Thread-1 (]: 5 of 9 PASS source_not_null_warehouse_customers_customer_id .................... [[32mPASS[0m in 0.08s]
[0m18:39:16.583065 [debug] [Thread-1 (]: Finished running node test.dbt_idx.source_not_null_warehouse_customers_customer_id.ae7452c4c6
[0m18:39:16.584064 [debug] [Thread-1 (]: Began running node test.dbt_idx.source_not_null_warehouse_orders_order_id.c85a1f0b76
[0m18:39:16.585181 [info ] [Thread-1 (]: 6 of 9 START test source_not_null_warehouse_orders_order_id .................... [RUN]
[0m18:39:16.586186 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_idx.source_not_null_warehouse_customers_customer_id.ae7452c4c6, now test.dbt_idx.source_not_null_warehouse_orders_order_id.c85a1f0b76)
[0m18:39:16.587695 [debug] [Thread-1 (]: Began compiling node test.dbt_idx.source_not_null_warehouse_orders_order_id.c85a1f0b76
[0m18:39:16.599256 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_idx.source_not_null_warehouse_orders_order_id.c85a1f0b76"
[0m18:39:16.607814 [debug] [Thread-1 (]: Timing info for test.dbt_idx.source_not_null_warehouse_orders_order_id.c85a1f0b76 (compile): 18:39:16.588705 => 18:39:16.606815
[0m18:39:16.608328 [debug] [Thread-1 (]: Began executing node test.dbt_idx.source_not_null_warehouse_orders_order_id.c85a1f0b76
[0m18:39:16.613879 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_idx.source_not_null_warehouse_orders_order_id.c85a1f0b76"
[0m18:39:16.623996 [debug] [Thread-1 (]: Using postgres connection "test.dbt_idx.source_not_null_warehouse_orders_order_id.c85a1f0b76"
[0m18:39:16.625008 [debug] [Thread-1 (]: On test.dbt_idx.source_not_null_warehouse_orders_order_id.c85a1f0b76: BEGIN
[0m18:39:16.626006 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:39:16.647967 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m18:39:16.648893 [debug] [Thread-1 (]: Using postgres connection "test.dbt_idx.source_not_null_warehouse_orders_order_id.c85a1f0b76"
[0m18:39:16.649909 [debug] [Thread-1 (]: On test.dbt_idx.source_not_null_warehouse_orders_order_id.c85a1f0b76: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "test.dbt_idx.source_not_null_warehouse_orders_order_id.c85a1f0b76"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select order_id
from "IDX-Stock"."warehouse"."orders"
where order_id is null



      
    ) dbt_internal_test
[0m18:39:16.653906 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m18:39:16.656433 [debug] [Thread-1 (]: Timing info for test.dbt_idx.source_not_null_warehouse_orders_order_id.c85a1f0b76 (execute): 18:39:16.609345 => 18:39:16.654906
[0m18:39:16.657455 [debug] [Thread-1 (]: On test.dbt_idx.source_not_null_warehouse_orders_order_id.c85a1f0b76: ROLLBACK
[0m18:39:16.659470 [debug] [Thread-1 (]: On test.dbt_idx.source_not_null_warehouse_orders_order_id.c85a1f0b76: Close
[0m18:39:16.661992 [info ] [Thread-1 (]: 6 of 9 PASS source_not_null_warehouse_orders_order_id .......................... [[32mPASS[0m in 0.07s]
[0m18:39:16.664006 [debug] [Thread-1 (]: Finished running node test.dbt_idx.source_not_null_warehouse_orders_order_id.c85a1f0b76
[0m18:39:16.666536 [debug] [Thread-1 (]: Began running node test.dbt_idx.source_relationships_warehouse_orders_cust_id__customer_id__source_warehouse_customers_.d3f9188fc2
[0m18:39:16.668051 [info ] [Thread-1 (]: 7 of 9 START test source_relationships_warehouse_orders_cust_id__customer_id__source_warehouse_customers_  [RUN]
[0m18:39:16.670094 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_idx.source_not_null_warehouse_orders_order_id.c85a1f0b76, now test.dbt_idx.source_relationships_warehouse_orders_cust_id__customer_id__source_warehouse_customers_.d3f9188fc2)
[0m18:39:16.671101 [debug] [Thread-1 (]: Began compiling node test.dbt_idx.source_relationships_warehouse_orders_cust_id__customer_id__source_warehouse_customers_.d3f9188fc2
[0m18:39:16.682658 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_idx.source_relationships_warehouse_orders_cust_id__customer_id__source_warehouse_customers_.d3f9188fc2"
[0m18:39:16.689147 [debug] [Thread-1 (]: Timing info for test.dbt_idx.source_relationships_warehouse_orders_cust_id__customer_id__source_warehouse_customers_.d3f9188fc2 (compile): 18:39:16.672100 => 18:39:16.689147
[0m18:39:16.691136 [debug] [Thread-1 (]: Began executing node test.dbt_idx.source_relationships_warehouse_orders_cust_id__customer_id__source_warehouse_customers_.d3f9188fc2
[0m18:39:16.699677 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_idx.source_relationships_warehouse_orders_cust_id__customer_id__source_warehouse_customers_.d3f9188fc2"
[0m18:39:16.706688 [debug] [Thread-1 (]: Using postgres connection "test.dbt_idx.source_relationships_warehouse_orders_cust_id__customer_id__source_warehouse_customers_.d3f9188fc2"
[0m18:39:16.708209 [debug] [Thread-1 (]: On test.dbt_idx.source_relationships_warehouse_orders_cust_id__customer_id__source_warehouse_customers_.d3f9188fc2: BEGIN
[0m18:39:16.708209 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:39:16.730328 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m18:39:16.731850 [debug] [Thread-1 (]: Using postgres connection "test.dbt_idx.source_relationships_warehouse_orders_cust_id__customer_id__source_warehouse_customers_.d3f9188fc2"
[0m18:39:16.731850 [debug] [Thread-1 (]: On test.dbt_idx.source_relationships_warehouse_orders_cust_id__customer_id__source_warehouse_customers_.d3f9188fc2: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "test.dbt_idx.source_relationships_warehouse_orders_cust_id__customer_id__source_warehouse_customers_.d3f9188fc2"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select cust_id as from_field
    from "IDX-Stock"."warehouse"."orders"
    where cust_id is not null
),

parent as (
    select customer_id as to_field
    from "IDX-Stock"."warehouse"."customers"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m18:39:16.736391 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m18:39:16.738930 [debug] [Thread-1 (]: Timing info for test.dbt_idx.source_relationships_warehouse_orders_cust_id__customer_id__source_warehouse_customers_.d3f9188fc2 (execute): 18:39:16.692131 => 18:39:16.737959
[0m18:39:16.739940 [debug] [Thread-1 (]: On test.dbt_idx.source_relationships_warehouse_orders_cust_id__customer_id__source_warehouse_customers_.d3f9188fc2: ROLLBACK
[0m18:39:16.741957 [debug] [Thread-1 (]: On test.dbt_idx.source_relationships_warehouse_orders_cust_id__customer_id__source_warehouse_customers_.d3f9188fc2: Close
[0m18:39:16.743948 [info ] [Thread-1 (]: 7 of 9 PASS source_relationships_warehouse_orders_cust_id__customer_id__source_warehouse_customers_  [[32mPASS[0m in 0.07s]
[0m18:39:16.746944 [debug] [Thread-1 (]: Finished running node test.dbt_idx.source_relationships_warehouse_orders_cust_id__customer_id__source_warehouse_customers_.d3f9188fc2
[0m18:39:16.748458 [debug] [Thread-1 (]: Began running node test.dbt_idx.source_unique_warehouse_orders_order_id.839fb43d0f
[0m18:39:16.750483 [info ] [Thread-1 (]: 8 of 9 START test source_unique_warehouse_orders_order_id ...................... [RUN]
[0m18:39:16.751507 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_idx.source_relationships_warehouse_orders_cust_id__customer_id__source_warehouse_customers_.d3f9188fc2, now test.dbt_idx.source_unique_warehouse_orders_order_id.839fb43d0f)
[0m18:39:16.752479 [debug] [Thread-1 (]: Began compiling node test.dbt_idx.source_unique_warehouse_orders_order_id.839fb43d0f
[0m18:39:16.760508 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_idx.source_unique_warehouse_orders_order_id.839fb43d0f"
[0m18:39:16.768093 [debug] [Thread-1 (]: Timing info for test.dbt_idx.source_unique_warehouse_orders_order_id.839fb43d0f (compile): 18:39:16.753478 => 18:39:16.768093
[0m18:39:16.769108 [debug] [Thread-1 (]: Began executing node test.dbt_idx.source_unique_warehouse_orders_order_id.839fb43d0f
[0m18:39:16.772120 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_idx.source_unique_warehouse_orders_order_id.839fb43d0f"
[0m18:39:16.780189 [debug] [Thread-1 (]: Using postgres connection "test.dbt_idx.source_unique_warehouse_orders_order_id.839fb43d0f"
[0m18:39:16.781827 [debug] [Thread-1 (]: On test.dbt_idx.source_unique_warehouse_orders_order_id.839fb43d0f: BEGIN
[0m18:39:16.782752 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:39:16.808419 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m18:39:16.809934 [debug] [Thread-1 (]: Using postgres connection "test.dbt_idx.source_unique_warehouse_orders_order_id.839fb43d0f"
[0m18:39:16.811967 [debug] [Thread-1 (]: On test.dbt_idx.source_unique_warehouse_orders_order_id.839fb43d0f: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "test.dbt_idx.source_unique_warehouse_orders_order_id.839fb43d0f"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    order_id as unique_field,
    count(*) as n_records

from "IDX-Stock"."warehouse"."orders"
where order_id is not null
group by order_id
having count(*) > 1



      
    ) dbt_internal_test
[0m18:39:16.817546 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m18:39:16.819485 [debug] [Thread-1 (]: Timing info for test.dbt_idx.source_unique_warehouse_orders_order_id.839fb43d0f (execute): 18:39:16.770123 => 18:39:16.819485
[0m18:39:16.820483 [debug] [Thread-1 (]: On test.dbt_idx.source_unique_warehouse_orders_order_id.839fb43d0f: ROLLBACK
[0m18:39:16.823487 [debug] [Thread-1 (]: On test.dbt_idx.source_unique_warehouse_orders_order_id.839fb43d0f: Close
[0m18:39:16.826488 [info ] [Thread-1 (]: 8 of 9 PASS source_unique_warehouse_orders_order_id ............................ [[32mPASS[0m in 0.07s]
[0m18:39:16.828006 [debug] [Thread-1 (]: Finished running node test.dbt_idx.source_unique_warehouse_orders_order_id.839fb43d0f
[0m18:39:16.830014 [debug] [Thread-1 (]: Began running node test.dbt_idx.unique_customer_orders_status_order_id.b7a45e83ee
[0m18:39:16.831542 [info ] [Thread-1 (]: 9 of 9 START test unique_customer_orders_status_order_id ....................... [RUN]
[0m18:39:16.833550 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_idx.source_unique_warehouse_orders_order_id.839fb43d0f, now test.dbt_idx.unique_customer_orders_status_order_id.b7a45e83ee)
[0m18:39:16.834549 [debug] [Thread-1 (]: Began compiling node test.dbt_idx.unique_customer_orders_status_order_id.b7a45e83ee
[0m18:39:16.842097 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_idx.unique_customer_orders_status_order_id.b7a45e83ee"
[0m18:39:16.851080 [debug] [Thread-1 (]: Timing info for test.dbt_idx.unique_customer_orders_status_order_id.b7a45e83ee (compile): 18:39:16.834549 => 18:39:16.850083
[0m18:39:16.852096 [debug] [Thread-1 (]: Began executing node test.dbt_idx.unique_customer_orders_status_order_id.b7a45e83ee
[0m18:39:16.855605 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_idx.unique_customer_orders_status_order_id.b7a45e83ee"
[0m18:39:16.864147 [debug] [Thread-1 (]: Using postgres connection "test.dbt_idx.unique_customer_orders_status_order_id.b7a45e83ee"
[0m18:39:16.866667 [debug] [Thread-1 (]: On test.dbt_idx.unique_customer_orders_status_order_id.b7a45e83ee: BEGIN
[0m18:39:16.867672 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:39:16.897928 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m18:39:16.899822 [debug] [Thread-1 (]: Using postgres connection "test.dbt_idx.unique_customer_orders_status_order_id.b7a45e83ee"
[0m18:39:16.900827 [debug] [Thread-1 (]: On test.dbt_idx.unique_customer_orders_status_order_id.b7a45e83ee: /* {"app": "dbt", "dbt_version": "1.6.1", "profile_name": "dbt_idx", "target_name": "dev", "node_id": "test.dbt_idx.unique_customer_orders_status_order_id.b7a45e83ee"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    order_id as unique_field,
    count(*) as n_records

from "IDX-Stock"."warehouse"."customer_orders_status"
where order_id is not null
group by order_id
having count(*) > 1



      
    ) dbt_internal_test
[0m18:39:16.906808 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m18:39:16.910990 [debug] [Thread-1 (]: Timing info for test.dbt_idx.unique_customer_orders_status_order_id.b7a45e83ee (execute): 18:39:16.852096 => 18:39:16.909981
[0m18:39:16.912005 [debug] [Thread-1 (]: On test.dbt_idx.unique_customer_orders_status_order_id.b7a45e83ee: ROLLBACK
[0m18:39:16.914580 [debug] [Thread-1 (]: On test.dbt_idx.unique_customer_orders_status_order_id.b7a45e83ee: Close
[0m18:39:16.917446 [info ] [Thread-1 (]: 9 of 9 PASS unique_customer_orders_status_order_id ............................. [[32mPASS[0m in 0.08s]
[0m18:39:16.920256 [debug] [Thread-1 (]: Finished running node test.dbt_idx.unique_customer_orders_status_order_id.b7a45e83ee
[0m18:39:16.924845 [debug] [MainThread]: Using postgres connection "master"
[0m18:39:16.926439 [debug] [MainThread]: On master: BEGIN
[0m18:39:16.926439 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:39:16.955788 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m18:39:16.956785 [debug] [MainThread]: On master: COMMIT
[0m18:39:16.958306 [debug] [MainThread]: Using postgres connection "master"
[0m18:39:16.958306 [debug] [MainThread]: On master: COMMIT
[0m18:39:16.961322 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m18:39:16.962340 [debug] [MainThread]: On master: Close
[0m18:39:16.963327 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:39:16.966378 [debug] [MainThread]: Connection 'list_IDX-Stock_snapshots' was properly closed.
[0m18:39:16.967954 [debug] [MainThread]: Connection 'test.dbt_idx.unique_customer_orders_status_order_id.b7a45e83ee' was properly closed.
[0m18:39:16.969662 [info ] [MainThread]: 
[0m18:39:16.971171 [info ] [MainThread]: Finished running 9 tests in 0 hours 0 minutes and 1.07 seconds (1.07s).
[0m18:39:16.975214 [debug] [MainThread]: Command end result
[0m18:39:17.000228 [info ] [MainThread]: 
[0m18:39:17.002741 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m18:39:17.004755 [info ] [MainThread]: 
[0m18:39:17.006781 [error] [MainThread]: [31mFailure in test assert_customer_dimension_has_no_row_loss.sql (tests\assert_customer_dimension_has_no_row_loss.sql.sql)[0m
[0m18:39:17.008281 [error] [MainThread]:   Got 105 results, configured to fail if != 0
[0m18:39:17.010296 [info ] [MainThread]: 
[0m18:39:17.011314 [info ] [MainThread]:   compiled Code at target\compiled\dbt_idx\tests\assert_customer_dimension_has_no_row_loss.sql.sql
[0m18:39:17.013849 [info ] [MainThread]: 
[0m18:39:17.016395 [info ] [MainThread]: Done. PASS=8 WARN=0 ERROR=1 SKIP=0 TOTAL=9
[0m18:39:17.018491 [debug] [MainThread]: Command `dbt test` failed at 18:39:17.018491 after 1.72 seconds
[0m18:39:17.019500 [debug] [MainThread]: Flushing usage events
